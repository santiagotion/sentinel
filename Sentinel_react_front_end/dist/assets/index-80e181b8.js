var gee=Object.defineProperty;var yee=(t,e,r)=>e in t?gee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Vl=(t,e,r)=>(yee(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var $c=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Q9={exports:{}},gT={},eV={exports:{}},Jr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J_=Symbol.for("react.element"),xee=Symbol.for("react.portal"),vee=Symbol.for("react.fragment"),_ee=Symbol.for("react.strict_mode"),bee=Symbol.for("react.profiler"),wee=Symbol.for("react.provider"),kee=Symbol.for("react.context"),Tee=Symbol.for("react.forward_ref"),See=Symbol.for("react.suspense"),Eee=Symbol.for("react.memo"),jee=Symbol.for("react.lazy"),bR=Symbol.iterator;function Aee(t){return t===null||typeof t!="object"?null:(t=bR&&t[bR]||t["@@iterator"],typeof t=="function"?t:null)}var tV={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rV=Object.assign,nV={};function R0(t,e,r){this.props=t,this.context=e,this.refs=nV,this.updater=r||tV}R0.prototype.isReactComponent={};R0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};R0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iV(){}iV.prototype=R0.prototype;function W4(t,e,r){this.props=t,this.context=e,this.refs=nV,this.updater=r||tV}var H4=W4.prototype=new iV;H4.constructor=W4;rV(H4,R0.prototype);H4.isPureReactComponent=!0;var wR=Array.isArray,aV=Object.prototype.hasOwnProperty,K4={current:null},sV={key:!0,ref:!0,__self:!0,__source:!0};function oV(t,e,r){var n,i={},o=null,u=null;if(e!=null)for(n in e.ref!==void 0&&(u=e.ref),e.key!==void 0&&(o=""+e.key),e)aV.call(e,n)&&!sV.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var p=Array(a),g=0;g<a;g++)p[g]=arguments[g+2];i.children=p}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:J_,type:t,key:o,ref:u,props:i,_owner:K4.current}}function Nee(t,e){return{$$typeof:J_,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Z4(t){return typeof t=="object"&&t!==null&&t.$$typeof===J_}function Cee(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var kR=/\/+/g;function $j(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Cee(""+t.key):e.toString(36)}function Lw(t,e,r,n,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var u=!1;if(t===null)u=!0;else switch(o){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case J_:case xee:u=!0}}if(u)return u=t,i=i(u),t=n===""?"."+$j(u,0):n,wR(i)?(r="",t!=null&&(r=t.replace(kR,"$&/")+"/"),Lw(i,e,r,"",function(g){return g})):i!=null&&(Z4(i)&&(i=Nee(i,r+(!i.key||u&&u.key===i.key?"":(""+i.key).replace(kR,"$&/")+"/")+t)),e.push(i)),1;if(u=0,n=n===""?".":n+":",wR(t))for(var a=0;a<t.length;a++){o=t[a];var p=n+$j(o,a);u+=Lw(o,e,r,p,i)}else if(p=Aee(t),typeof p=="function")for(t=p.call(t),a=0;!(o=t.next()).done;)o=o.value,p=n+$j(o,a++),u+=Lw(o,e,r,p,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return u}function V1(t,e,r){if(t==null)return t;var n=[],i=0;return Lw(t,n,"","",function(o){return e.call(r,o,i++)}),n}function Pee(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Is={current:null},zw={transition:null},Iee={ReactCurrentDispatcher:Is,ReactCurrentBatchConfig:zw,ReactCurrentOwner:K4};function lV(){throw Error("act(...) is not supported in production builds of React.")}Jr.Children={map:V1,forEach:function(t,e,r){V1(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return V1(t,function(){e++}),e},toArray:function(t){return V1(t,function(e){return e})||[]},only:function(t){if(!Z4(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Jr.Component=R0;Jr.Fragment=vee;Jr.Profiler=bee;Jr.PureComponent=W4;Jr.StrictMode=_ee;Jr.Suspense=See;Jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Iee;Jr.act=lV;Jr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=rV({},t.props),i=t.key,o=t.ref,u=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,u=K4.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(p in e)aV.call(e,p)&&!sV.hasOwnProperty(p)&&(n[p]=e[p]===void 0&&a!==void 0?a[p]:e[p])}var p=arguments.length-2;if(p===1)n.children=r;else if(1<p){a=Array(p);for(var g=0;g<p;g++)a[g]=arguments[g+2];n.children=a}return{$$typeof:J_,type:t.type,key:i,ref:o,props:n,_owner:u}};Jr.createContext=function(t){return t={$$typeof:kee,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:wee,_context:t},t.Consumer=t};Jr.createElement=oV;Jr.createFactory=function(t){var e=oV.bind(null,t);return e.type=t,e};Jr.createRef=function(){return{current:null}};Jr.forwardRef=function(t){return{$$typeof:Tee,render:t}};Jr.isValidElement=Z4;Jr.lazy=function(t){return{$$typeof:jee,_payload:{_status:-1,_result:t},_init:Pee}};Jr.memo=function(t,e){return{$$typeof:Eee,type:t,compare:e===void 0?null:e}};Jr.startTransition=function(t){var e=zw.transition;zw.transition={};try{t()}finally{zw.transition=e}};Jr.unstable_act=lV;Jr.useCallback=function(t,e){return Is.current.useCallback(t,e)};Jr.useContext=function(t){return Is.current.useContext(t)};Jr.useDebugValue=function(){};Jr.useDeferredValue=function(t){return Is.current.useDeferredValue(t)};Jr.useEffect=function(t,e){return Is.current.useEffect(t,e)};Jr.useId=function(){return Is.current.useId()};Jr.useImperativeHandle=function(t,e,r){return Is.current.useImperativeHandle(t,e,r)};Jr.useInsertionEffect=function(t,e){return Is.current.useInsertionEffect(t,e)};Jr.useLayoutEffect=function(t,e){return Is.current.useLayoutEffect(t,e)};Jr.useMemo=function(t,e){return Is.current.useMemo(t,e)};Jr.useReducer=function(t,e,r){return Is.current.useReducer(t,e,r)};Jr.useRef=function(t){return Is.current.useRef(t)};Jr.useState=function(t){return Is.current.useState(t)};Jr.useSyncExternalStore=function(t,e,r){return Is.current.useSyncExternalStore(t,e,r)};Jr.useTransition=function(){return Is.current.useTransition()};Jr.version="18.3.1";eV.exports=Jr;var Y=eV.exports;const Le=Pn(Y);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mee=Y,Dee=Symbol.for("react.element"),Oee=Symbol.for("react.fragment"),Ree=Object.prototype.hasOwnProperty,Lee=Mee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zee={key:!0,ref:!0,__self:!0,__source:!0};function cV(t,e,r){var n,i={},o=null,u=null;r!==void 0&&(o=""+r),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(u=e.ref);for(n in e)Ree.call(e,n)&&!zee.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Dee,type:t,key:o,ref:u,props:i,_owner:Lee.current}}gT.Fragment=Oee;gT.jsx=cV;gT.jsxs=cV;Q9.exports=gT;var l=Q9.exports,pN={},uV={exports:{}},Io={},dV={exports:{}},hV={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ye,Se){var be=ye.length;ye.push(Se);e:for(;0<be;){var Ce=be-1>>>1,$e=ye[Ce];if(0<i($e,Se))ye[Ce]=Se,ye[be]=$e,be=Ce;else break e}}function r(ye){return ye.length===0?null:ye[0]}function n(ye){if(ye.length===0)return null;var Se=ye[0],be=ye.pop();if(be!==Se){ye[0]=be;e:for(var Ce=0,$e=ye.length,Ye=$e>>>1;Ce<Ye;){var jt=2*(Ce+1)-1,Me=ye[jt],St=jt+1,Ct=ye[St];if(0>i(Me,be))St<$e&&0>i(Ct,Me)?(ye[Ce]=Ct,ye[St]=be,Ce=St):(ye[Ce]=Me,ye[jt]=be,Ce=jt);else if(St<$e&&0>i(Ct,be))ye[Ce]=Ct,ye[St]=be,Ce=St;else break e}}return Se}function i(ye,Se){var be=ye.sortIndex-Se.sortIndex;return be!==0?be:ye.id-Se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,a=u.now();t.unstable_now=function(){return u.now()-a}}var p=[],g=[],v=1,w=null,T=3,A=!1,I=!1,P=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function $(ye){for(var Se=r(g);Se!==null;){if(Se.callback===null)n(g);else if(Se.startTime<=ye)n(g),Se.sortIndex=Se.expirationTime,e(p,Se);else break;Se=r(g)}}function G(ye){if(P=!1,$(ye),!I)if(r(p)!==null)I=!0,ae(B);else{var Se=r(g);Se!==null&&xe(G,Se.startTime-ye)}}function B(ye,Se){I=!1,P&&(P=!1,L(H),H=-1),A=!0;var be=T;try{for($(Se),w=r(p);w!==null&&(!(w.expirationTime>Se)||ye&&!K());){var Ce=w.callback;if(typeof Ce=="function"){w.callback=null,T=w.priorityLevel;var $e=Ce(w.expirationTime<=Se);Se=t.unstable_now(),typeof $e=="function"?w.callback=$e:w===r(p)&&n(p),$(Se)}else n(p);w=r(p)}if(w!==null)var Ye=!0;else{var jt=r(g);jt!==null&&xe(G,jt.startTime-Se),Ye=!1}return Ye}finally{w=null,T=be,A=!1}}var J=!1,W=null,H=-1,V=5,se=-1;function K(){return!(t.unstable_now()-se<V)}function ce(){if(W!==null){var ye=t.unstable_now();se=ye;var Se=!0;try{Se=W(!0,ye)}finally{Se?ne():(J=!1,W=null)}}else J=!1}var ne;if(typeof O=="function")ne=function(){O(ce)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,oe=re.port2;re.port1.onmessage=ce,ne=function(){oe.postMessage(null)}}else ne=function(){D(ce,0)};function ae(ye){W=ye,J||(J=!0,ne())}function xe(ye,Se){H=D(function(){ye(t.unstable_now())},Se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ye){ye.callback=null},t.unstable_continueExecution=function(){I||A||(I=!0,ae(B))},t.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<ye?Math.floor(1e3/ye):5},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_getFirstCallbackNode=function(){return r(p)},t.unstable_next=function(ye){switch(T){case 1:case 2:case 3:var Se=3;break;default:Se=T}var be=T;T=Se;try{return ye()}finally{T=be}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ye,Se){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var be=T;T=ye;try{return Se()}finally{T=be}},t.unstable_scheduleCallback=function(ye,Se,be){var Ce=t.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?Ce+be:Ce):be=Ce,ye){case 1:var $e=-1;break;case 2:$e=250;break;case 5:$e=1073741823;break;case 4:$e=1e4;break;default:$e=5e3}return $e=be+$e,ye={id:v++,callback:Se,priorityLevel:ye,startTime:be,expirationTime:$e,sortIndex:-1},be>Ce?(ye.sortIndex=be,e(g,ye),r(p)===null&&ye===r(g)&&(P?(L(H),H=-1):P=!0,xe(G,be-Ce))):(ye.sortIndex=$e,e(p,ye),I||A||(I=!0,ae(B))),ye},t.unstable_shouldYield=K,t.unstable_wrapCallback=function(ye){var Se=T;return function(){var be=T;T=Se;try{return ye.apply(this,arguments)}finally{T=be}}}})(hV);dV.exports=hV;var $ee=dV.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fee=Y,Ao=$ee;function Vt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fV=new Set,Dv={};function Vp(t,e){Rg(t,e),Rg(t+"Capture",e)}function Rg(t,e){for(Dv[t]=e,t=0;t<e.length;t++)fV.add(e[t])}var rd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mN=Object.prototype.hasOwnProperty,Bee=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,TR={},SR={};function Vee(t){return mN.call(SR,t)?!0:mN.call(TR,t)?!1:Bee.test(t)?SR[t]=!0:(TR[t]=!0,!1)}function Uee(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function qee(t,e,r,n){if(e===null||typeof e>"u"||Uee(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ms(t,e,r,n,i,o,u){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=u}var Va={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Va[t]=new Ms(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Va[e]=new Ms(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Va[t]=new Ms(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Va[t]=new Ms(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Va[t]=new Ms(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Va[t]=new Ms(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Va[t]=new Ms(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Va[t]=new Ms(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Va[t]=new Ms(t,5,!1,t.toLowerCase(),null,!1,!1)});var X4=/[\-:]([a-z])/g;function Y4(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(X4,Y4);Va[e]=new Ms(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(X4,Y4);Va[e]=new Ms(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(X4,Y4);Va[e]=new Ms(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Va[t]=new Ms(t,1,!1,t.toLowerCase(),null,!1,!1)});Va.xlinkHref=new Ms("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Va[t]=new Ms(t,1,!1,t.toLowerCase(),null,!0,!0)});function J4(t,e,r,n){var i=Va.hasOwnProperty(e)?Va[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(qee(e,r,i,n)&&(r=null),n||i===null?Vee(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var _d=Fee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,U1=Symbol.for("react.element"),tg=Symbol.for("react.portal"),rg=Symbol.for("react.fragment"),Q4=Symbol.for("react.strict_mode"),gN=Symbol.for("react.profiler"),pV=Symbol.for("react.provider"),mV=Symbol.for("react.context"),eI=Symbol.for("react.forward_ref"),yN=Symbol.for("react.suspense"),xN=Symbol.for("react.suspense_list"),tI=Symbol.for("react.memo"),ch=Symbol.for("react.lazy"),gV=Symbol.for("react.offscreen"),ER=Symbol.iterator;function yx(t){return t===null||typeof t!="object"?null:(t=ER&&t[ER]||t["@@iterator"],typeof t=="function"?t:null)}var Ni=Object.assign,Fj;function Fx(t){if(Fj===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Fj=e&&e[1]||""}return`
`+Fj+t}var Bj=!1;function Vj(t,e){if(!t||Bj)return"";Bj=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(g){var n=g}Reflect.construct(t,[],e)}else{try{e.call()}catch(g){n=g}t.call(e.prototype)}else{try{throw Error()}catch(g){n=g}t()}}catch(g){if(g&&n&&typeof g.stack=="string"){for(var i=g.stack.split(`
`),o=n.stack.split(`
`),u=i.length-1,a=o.length-1;1<=u&&0<=a&&i[u]!==o[a];)a--;for(;1<=u&&0<=a;u--,a--)if(i[u]!==o[a]){if(u!==1||a!==1)do if(u--,a--,0>a||i[u]!==o[a]){var p=`
`+i[u].replace(" at new "," at ");return t.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",t.displayName)),p}while(1<=u&&0<=a);break}}}finally{Bj=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Fx(t):""}function Gee(t){switch(t.tag){case 5:return Fx(t.type);case 16:return Fx("Lazy");case 13:return Fx("Suspense");case 19:return Fx("SuspenseList");case 0:case 2:case 15:return t=Vj(t.type,!1),t;case 11:return t=Vj(t.type.render,!1),t;case 1:return t=Vj(t.type,!0),t;default:return""}}function vN(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case rg:return"Fragment";case tg:return"Portal";case gN:return"Profiler";case Q4:return"StrictMode";case yN:return"Suspense";case xN:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mV:return(t.displayName||"Context")+".Consumer";case pV:return(t._context.displayName||"Context")+".Provider";case eI:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case tI:return e=t.displayName||null,e!==null?e:vN(t.type)||"Memo";case ch:e=t._payload,t=t._init;try{return vN(t(e))}catch{}}return null}function Wee(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vN(e);case 8:return e===Q4?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Bh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function yV(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Hee(t){var e=yV(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(u){n=""+u,o.call(this,u)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(u){n=""+u},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function q1(t){t._valueTracker||(t._valueTracker=Hee(t))}function xV(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=yV(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function p2(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _N(t,e){var r=e.checked;return Ni({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function jR(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Bh(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vV(t,e){e=e.checked,e!=null&&J4(t,"checked",e,!1)}function bN(t,e){vV(t,e);var r=Bh(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?wN(t,e.type,r):e.hasOwnProperty("defaultValue")&&wN(t,e.type,Bh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function AR(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function wN(t,e,r){(e!=="number"||p2(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Bx=Array.isArray;function kg(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Bh(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function kN(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Vt(91));return Ni({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function NR(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Vt(92));if(Bx(r)){if(1<r.length)throw Error(Vt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Bh(r)}}function _V(t,e){var r=Bh(e.value),n=Bh(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function CR(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function bV(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function TN(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?bV(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var G1,wV=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(G1=G1||document.createElement("div"),G1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=G1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ov(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var iv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kee=["Webkit","ms","Moz","O"];Object.keys(iv).forEach(function(t){Kee.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),iv[e]=iv[t]})});function kV(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||iv.hasOwnProperty(t)&&iv[t]?(""+e).trim():e+"px"}function TV(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=kV(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Zee=Ni({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function SN(t,e){if(e){if(Zee[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Vt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Vt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Vt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Vt(62))}}function EN(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jN=null;function rI(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var AN=null,Tg=null,Sg=null;function PR(t){if(t=tb(t)){if(typeof AN!="function")throw Error(Vt(280));var e=t.stateNode;e&&(e=bT(e),AN(t.stateNode,t.type,e))}}function SV(t){Tg?Sg?Sg.push(t):Sg=[t]:Tg=t}function EV(){if(Tg){var t=Tg,e=Sg;if(Sg=Tg=null,PR(t),e)for(t=0;t<e.length;t++)PR(e[t])}}function jV(t,e){return t(e)}function AV(){}var Uj=!1;function NV(t,e,r){if(Uj)return t(e,r);Uj=!0;try{return jV(t,e,r)}finally{Uj=!1,(Tg!==null||Sg!==null)&&(AV(),EV())}}function Rv(t,e){var r=t.stateNode;if(r===null)return null;var n=bT(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Vt(231,e,typeof r));return r}var NN=!1;if(rd)try{var xx={};Object.defineProperty(xx,"passive",{get:function(){NN=!0}}),window.addEventListener("test",xx,xx),window.removeEventListener("test",xx,xx)}catch{NN=!1}function Xee(t,e,r,n,i,o,u,a,p){var g=Array.prototype.slice.call(arguments,3);try{e.apply(r,g)}catch(v){this.onError(v)}}var av=!1,m2=null,g2=!1,CN=null,Yee={onError:function(t){av=!0,m2=t}};function Jee(t,e,r,n,i,o,u,a,p){av=!1,m2=null,Xee.apply(Yee,arguments)}function Qee(t,e,r,n,i,o,u,a,p){if(Jee.apply(this,arguments),av){if(av){var g=m2;av=!1,m2=null}else throw Error(Vt(198));g2||(g2=!0,CN=g)}}function Up(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function CV(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function IR(t){if(Up(t)!==t)throw Error(Vt(188))}function ete(t){var e=t.alternate;if(!e){if(e=Up(t),e===null)throw Error(Vt(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return IR(i),t;if(o===n)return IR(i),e;o=o.sibling}throw Error(Vt(188))}if(r.return!==n.return)r=i,n=o;else{for(var u=!1,a=i.child;a;){if(a===r){u=!0,r=i,n=o;break}if(a===n){u=!0,n=i,r=o;break}a=a.sibling}if(!u){for(a=o.child;a;){if(a===r){u=!0,r=o,n=i;break}if(a===n){u=!0,n=o,r=i;break}a=a.sibling}if(!u)throw Error(Vt(189))}}if(r.alternate!==n)throw Error(Vt(190))}if(r.tag!==3)throw Error(Vt(188));return r.stateNode.current===r?t:e}function PV(t){return t=ete(t),t!==null?IV(t):null}function IV(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=IV(t);if(e!==null)return e;t=t.sibling}return null}var MV=Ao.unstable_scheduleCallback,MR=Ao.unstable_cancelCallback,tte=Ao.unstable_shouldYield,rte=Ao.unstable_requestPaint,Vi=Ao.unstable_now,nte=Ao.unstable_getCurrentPriorityLevel,nI=Ao.unstable_ImmediatePriority,DV=Ao.unstable_UserBlockingPriority,y2=Ao.unstable_NormalPriority,ite=Ao.unstable_LowPriority,OV=Ao.unstable_IdlePriority,yT=null,Uc=null;function ate(t){if(Uc&&typeof Uc.onCommitFiberRoot=="function")try{Uc.onCommitFiberRoot(yT,t,void 0,(t.current.flags&128)===128)}catch{}}var nc=Math.clz32?Math.clz32:lte,ste=Math.log,ote=Math.LN2;function lte(t){return t>>>=0,t===0?32:31-(ste(t)/ote|0)|0}var W1=64,H1=4194304;function Vx(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function x2(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,o=t.pingedLanes,u=r&268435455;if(u!==0){var a=u&~i;a!==0?n=Vx(a):(o&=u,o!==0&&(n=Vx(o)))}else u=r&~i,u!==0?n=Vx(u):o!==0&&(n=Vx(o));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-nc(e),i=1<<r,n|=t[r],e&=~i;return n}function cte(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ute(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var u=31-nc(o),a=1<<u,p=i[u];p===-1?(!(a&r)||a&n)&&(i[u]=cte(a,e)):p<=e&&(t.expiredLanes|=a),o&=~a}}function PN(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function RV(){var t=W1;return W1<<=1,!(W1&4194240)&&(W1=64),t}function qj(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Q_(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-nc(e),t[e]=r}function dte(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-nc(r),o=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~o}}function iI(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-nc(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Dn=0;function LV(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var zV,aI,$V,FV,BV,IN=!1,K1=[],Sh=null,Eh=null,jh=null,Lv=new Map,zv=new Map,fh=[],hte="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function DR(t,e){switch(t){case"focusin":case"focusout":Sh=null;break;case"dragenter":case"dragleave":Eh=null;break;case"mouseover":case"mouseout":jh=null;break;case"pointerover":case"pointerout":Lv.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zv.delete(e.pointerId)}}function vx(t,e,r,n,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},e!==null&&(e=tb(e),e!==null&&aI(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function fte(t,e,r,n,i){switch(e){case"focusin":return Sh=vx(Sh,t,e,r,n,i),!0;case"dragenter":return Eh=vx(Eh,t,e,r,n,i),!0;case"mouseover":return jh=vx(jh,t,e,r,n,i),!0;case"pointerover":var o=i.pointerId;return Lv.set(o,vx(Lv.get(o)||null,t,e,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,zv.set(o,vx(zv.get(o)||null,t,e,r,n,i)),!0}return!1}function VV(t){var e=cp(t.target);if(e!==null){var r=Up(e);if(r!==null){if(e=r.tag,e===13){if(e=CV(r),e!==null){t.blockedOn=e,BV(t.priority,function(){$V(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $w(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=MN(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);jN=n,r.target.dispatchEvent(n),jN=null}else return e=tb(r),e!==null&&aI(e),t.blockedOn=r,!1;e.shift()}return!0}function OR(t,e,r){$w(t)&&r.delete(e)}function pte(){IN=!1,Sh!==null&&$w(Sh)&&(Sh=null),Eh!==null&&$w(Eh)&&(Eh=null),jh!==null&&$w(jh)&&(jh=null),Lv.forEach(OR),zv.forEach(OR)}function _x(t,e){t.blockedOn===e&&(t.blockedOn=null,IN||(IN=!0,Ao.unstable_scheduleCallback(Ao.unstable_NormalPriority,pte)))}function $v(t){function e(i){return _x(i,t)}if(0<K1.length){_x(K1[0],t);for(var r=1;r<K1.length;r++){var n=K1[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Sh!==null&&_x(Sh,t),Eh!==null&&_x(Eh,t),jh!==null&&_x(jh,t),Lv.forEach(e),zv.forEach(e),r=0;r<fh.length;r++)n=fh[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<fh.length&&(r=fh[0],r.blockedOn===null);)VV(r),r.blockedOn===null&&fh.shift()}var Eg=_d.ReactCurrentBatchConfig,v2=!0;function mte(t,e,r,n){var i=Dn,o=Eg.transition;Eg.transition=null;try{Dn=1,sI(t,e,r,n)}finally{Dn=i,Eg.transition=o}}function gte(t,e,r,n){var i=Dn,o=Eg.transition;Eg.transition=null;try{Dn=4,sI(t,e,r,n)}finally{Dn=i,Eg.transition=o}}function sI(t,e,r,n){if(v2){var i=MN(t,e,r,n);if(i===null)eA(t,e,n,_2,r),DR(t,n);else if(fte(i,t,e,r,n))n.stopPropagation();else if(DR(t,n),e&4&&-1<hte.indexOf(t)){for(;i!==null;){var o=tb(i);if(o!==null&&zV(o),o=MN(t,e,r,n),o===null&&eA(t,e,n,_2,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else eA(t,e,n,null,r)}}var _2=null;function MN(t,e,r,n){if(_2=null,t=rI(n),t=cp(t),t!==null)if(e=Up(t),e===null)t=null;else if(r=e.tag,r===13){if(t=CV(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _2=t,null}function UV(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nte()){case nI:return 1;case DV:return 4;case y2:case ite:return 16;case OV:return 536870912;default:return 16}default:return 16}}var gh=null,oI=null,Fw=null;function qV(){if(Fw)return Fw;var t,e=oI,r=e.length,n,i="value"in gh?gh.value:gh.textContent,o=i.length;for(t=0;t<r&&e[t]===i[t];t++);var u=r-t;for(n=1;n<=u&&e[r-n]===i[o-n];n++);return Fw=i.slice(t,1<n?1-n:void 0)}function Bw(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Z1(){return!0}function RR(){return!1}function Mo(t){function e(r,n,i,o,u){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=u,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Z1:RR,this.isPropagationStopped=RR,this}return Ni(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Z1)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Z1)},persist:function(){},isPersistent:Z1}),e}var L0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lI=Mo(L0),eb=Ni({},L0,{view:0,detail:0}),yte=Mo(eb),Gj,Wj,bx,xT=Ni({},eb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cI,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==bx&&(bx&&t.type==="mousemove"?(Gj=t.screenX-bx.screenX,Wj=t.screenY-bx.screenY):Wj=Gj=0,bx=t),Gj)},movementY:function(t){return"movementY"in t?t.movementY:Wj}}),LR=Mo(xT),xte=Ni({},xT,{dataTransfer:0}),vte=Mo(xte),_te=Ni({},eb,{relatedTarget:0}),Hj=Mo(_te),bte=Ni({},L0,{animationName:0,elapsedTime:0,pseudoElement:0}),wte=Mo(bte),kte=Ni({},L0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Tte=Mo(kte),Ste=Ni({},L0,{data:0}),zR=Mo(Ste),Ete={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jte={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ate={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nte(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Ate[t])?!!e[t]:!1}function cI(){return Nte}var Cte=Ni({},eb,{key:function(t){if(t.key){var e=Ete[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Bw(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jte[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cI,charCode:function(t){return t.type==="keypress"?Bw(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Bw(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Pte=Mo(Cte),Ite=Ni({},xT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$R=Mo(Ite),Mte=Ni({},eb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cI}),Dte=Mo(Mte),Ote=Ni({},L0,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rte=Mo(Ote),Lte=Ni({},xT,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),zte=Mo(Lte),$te=[9,13,27,32],uI=rd&&"CompositionEvent"in window,sv=null;rd&&"documentMode"in document&&(sv=document.documentMode);var Fte=rd&&"TextEvent"in window&&!sv,GV=rd&&(!uI||sv&&8<sv&&11>=sv),FR=String.fromCharCode(32),BR=!1;function WV(t,e){switch(t){case"keyup":return $te.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function HV(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ng=!1;function Bte(t,e){switch(t){case"compositionend":return HV(e);case"keypress":return e.which!==32?null:(BR=!0,FR);case"textInput":return t=e.data,t===FR&&BR?null:t;default:return null}}function Vte(t,e){if(ng)return t==="compositionend"||!uI&&WV(t,e)?(t=qV(),Fw=oI=gh=null,ng=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return GV&&e.locale!=="ko"?null:e.data;default:return null}}var Ute={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function VR(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ute[t.type]:e==="textarea"}function KV(t,e,r,n){SV(n),e=b2(e,"onChange"),0<e.length&&(r=new lI("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var ov=null,Fv=null;function qte(t){a7(t,0)}function vT(t){var e=sg(t);if(xV(e))return t}function Gte(t,e){if(t==="change")return e}var ZV=!1;if(rd){var Kj;if(rd){var Zj="oninput"in document;if(!Zj){var UR=document.createElement("div");UR.setAttribute("oninput","return;"),Zj=typeof UR.oninput=="function"}Kj=Zj}else Kj=!1;ZV=Kj&&(!document.documentMode||9<document.documentMode)}function qR(){ov&&(ov.detachEvent("onpropertychange",XV),Fv=ov=null)}function XV(t){if(t.propertyName==="value"&&vT(Fv)){var e=[];KV(e,Fv,t,rI(t)),NV(qte,e)}}function Wte(t,e,r){t==="focusin"?(qR(),ov=e,Fv=r,ov.attachEvent("onpropertychange",XV)):t==="focusout"&&qR()}function Hte(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return vT(Fv)}function Kte(t,e){if(t==="click")return vT(e)}function Zte(t,e){if(t==="input"||t==="change")return vT(e)}function Xte(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var oc=typeof Object.is=="function"?Object.is:Xte;function Bv(t,e){if(oc(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!mN.call(e,i)||!oc(t[i],e[i]))return!1}return!0}function GR(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function WR(t,e){var r=GR(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=GR(r)}}function YV(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?YV(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function JV(){for(var t=window,e=p2();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=p2(t.document)}return e}function dI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Yte(t){var e=JV(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&YV(r.ownerDocument.documentElement,r)){if(n!==null&&dI(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!t.extend&&o>n&&(i=n,n=o,o=i),i=WR(r,o);var u=WR(r,n);i&&u&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==u.node||t.focusOffset!==u.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>n?(t.addRange(e),t.extend(u.node,u.offset)):(e.setEnd(u.node,u.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Jte=rd&&"documentMode"in document&&11>=document.documentMode,ig=null,DN=null,lv=null,ON=!1;function HR(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ON||ig==null||ig!==p2(n)||(n=ig,"selectionStart"in n&&dI(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),lv&&Bv(lv,n)||(lv=n,n=b2(DN,"onSelect"),0<n.length&&(e=new lI("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=ig)))}function X1(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ag={animationend:X1("Animation","AnimationEnd"),animationiteration:X1("Animation","AnimationIteration"),animationstart:X1("Animation","AnimationStart"),transitionend:X1("Transition","TransitionEnd")},Xj={},QV={};rd&&(QV=document.createElement("div").style,"AnimationEvent"in window||(delete ag.animationend.animation,delete ag.animationiteration.animation,delete ag.animationstart.animation),"TransitionEvent"in window||delete ag.transitionend.transition);function _T(t){if(Xj[t])return Xj[t];if(!ag[t])return t;var e=ag[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in QV)return Xj[t]=e[r];return t}var e7=_T("animationend"),t7=_T("animationiteration"),r7=_T("animationstart"),n7=_T("transitionend"),i7=new Map,KR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function nf(t,e){i7.set(t,e),Vp(e,[t])}for(var Yj=0;Yj<KR.length;Yj++){var Jj=KR[Yj],Qte=Jj.toLowerCase(),ere=Jj[0].toUpperCase()+Jj.slice(1);nf(Qte,"on"+ere)}nf(e7,"onAnimationEnd");nf(t7,"onAnimationIteration");nf(r7,"onAnimationStart");nf("dblclick","onDoubleClick");nf("focusin","onFocus");nf("focusout","onBlur");nf(n7,"onTransitionEnd");Rg("onMouseEnter",["mouseout","mouseover"]);Rg("onMouseLeave",["mouseout","mouseover"]);Rg("onPointerEnter",["pointerout","pointerover"]);Rg("onPointerLeave",["pointerout","pointerover"]);Vp("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vp("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vp("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vp("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vp("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vp("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ux="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tre=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ux));function ZR(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Qee(n,e,void 0,t),t.currentTarget=null}function a7(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var o=void 0;if(e)for(var u=n.length-1;0<=u;u--){var a=n[u],p=a.instance,g=a.currentTarget;if(a=a.listener,p!==o&&i.isPropagationStopped())break e;ZR(i,a,g),o=p}else for(u=0;u<n.length;u++){if(a=n[u],p=a.instance,g=a.currentTarget,a=a.listener,p!==o&&i.isPropagationStopped())break e;ZR(i,a,g),o=p}}}if(g2)throw t=CN,g2=!1,CN=null,t}function ei(t,e){var r=e[FN];r===void 0&&(r=e[FN]=new Set);var n=t+"__bubble";r.has(n)||(s7(e,t,2,!1),r.add(n))}function Qj(t,e,r){var n=0;e&&(n|=4),s7(r,t,n,e)}var Y1="_reactListening"+Math.random().toString(36).slice(2);function Vv(t){if(!t[Y1]){t[Y1]=!0,fV.forEach(function(r){r!=="selectionchange"&&(tre.has(r)||Qj(r,!1,t),Qj(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Y1]||(e[Y1]=!0,Qj("selectionchange",!1,e))}}function s7(t,e,r,n){switch(UV(e)){case 1:var i=mte;break;case 4:i=gte;break;default:i=sI}r=i.bind(null,e,r,t),i=void 0,!NN||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function eA(t,e,r,n,i){var o=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var u=n.tag;if(u===3||u===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(u===4)for(u=n.return;u!==null;){var p=u.tag;if((p===3||p===4)&&(p=u.stateNode.containerInfo,p===i||p.nodeType===8&&p.parentNode===i))return;u=u.return}for(;a!==null;){if(u=cp(a),u===null)return;if(p=u.tag,p===5||p===6){n=o=u;continue e}a=a.parentNode}}n=n.return}NV(function(){var g=o,v=rI(r),w=[];e:{var T=i7.get(t);if(T!==void 0){var A=lI,I=t;switch(t){case"keypress":if(Bw(r)===0)break e;case"keydown":case"keyup":A=Pte;break;case"focusin":I="focus",A=Hj;break;case"focusout":I="blur",A=Hj;break;case"beforeblur":case"afterblur":A=Hj;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=LR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=vte;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=Dte;break;case e7:case t7:case r7:A=wte;break;case n7:A=Rte;break;case"scroll":A=yte;break;case"wheel":A=zte;break;case"copy":case"cut":case"paste":A=Tte;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=$R}var P=(e&4)!==0,D=!P&&t==="scroll",L=P?T!==null?T+"Capture":null:T;P=[];for(var O=g,$;O!==null;){$=O;var G=$.stateNode;if($.tag===5&&G!==null&&($=G,L!==null&&(G=Rv(O,L),G!=null&&P.push(Uv(O,G,$)))),D)break;O=O.return}0<P.length&&(T=new A(T,I,null,r,v),w.push({event:T,listeners:P}))}}if(!(e&7)){e:{if(T=t==="mouseover"||t==="pointerover",A=t==="mouseout"||t==="pointerout",T&&r!==jN&&(I=r.relatedTarget||r.fromElement)&&(cp(I)||I[nd]))break e;if((A||T)&&(T=v.window===v?v:(T=v.ownerDocument)?T.defaultView||T.parentWindow:window,A?(I=r.relatedTarget||r.toElement,A=g,I=I?cp(I):null,I!==null&&(D=Up(I),I!==D||I.tag!==5&&I.tag!==6)&&(I=null)):(A=null,I=g),A!==I)){if(P=LR,G="onMouseLeave",L="onMouseEnter",O="mouse",(t==="pointerout"||t==="pointerover")&&(P=$R,G="onPointerLeave",L="onPointerEnter",O="pointer"),D=A==null?T:sg(A),$=I==null?T:sg(I),T=new P(G,O+"leave",A,r,v),T.target=D,T.relatedTarget=$,G=null,cp(v)===g&&(P=new P(L,O+"enter",I,r,v),P.target=$,P.relatedTarget=D,G=P),D=G,A&&I)t:{for(P=A,L=I,O=0,$=P;$;$=Wm($))O++;for($=0,G=L;G;G=Wm(G))$++;for(;0<O-$;)P=Wm(P),O--;for(;0<$-O;)L=Wm(L),$--;for(;O--;){if(P===L||L!==null&&P===L.alternate)break t;P=Wm(P),L=Wm(L)}P=null}else P=null;A!==null&&XR(w,T,A,P,!1),I!==null&&D!==null&&XR(w,D,I,P,!0)}}e:{if(T=g?sg(g):window,A=T.nodeName&&T.nodeName.toLowerCase(),A==="select"||A==="input"&&T.type==="file")var B=Gte;else if(VR(T))if(ZV)B=Zte;else{B=Hte;var J=Wte}else(A=T.nodeName)&&A.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(B=Kte);if(B&&(B=B(t,g))){KV(w,B,r,v);break e}J&&J(t,T,g),t==="focusout"&&(J=T._wrapperState)&&J.controlled&&T.type==="number"&&wN(T,"number",T.value)}switch(J=g?sg(g):window,t){case"focusin":(VR(J)||J.contentEditable==="true")&&(ig=J,DN=g,lv=null);break;case"focusout":lv=DN=ig=null;break;case"mousedown":ON=!0;break;case"contextmenu":case"mouseup":case"dragend":ON=!1,HR(w,r,v);break;case"selectionchange":if(Jte)break;case"keydown":case"keyup":HR(w,r,v)}var W;if(uI)e:{switch(t){case"compositionstart":var H="onCompositionStart";break e;case"compositionend":H="onCompositionEnd";break e;case"compositionupdate":H="onCompositionUpdate";break e}H=void 0}else ng?WV(t,r)&&(H="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(H="onCompositionStart");H&&(GV&&r.locale!=="ko"&&(ng||H!=="onCompositionStart"?H==="onCompositionEnd"&&ng&&(W=qV()):(gh=v,oI="value"in gh?gh.value:gh.textContent,ng=!0)),J=b2(g,H),0<J.length&&(H=new zR(H,t,null,r,v),w.push({event:H,listeners:J}),W?H.data=W:(W=HV(r),W!==null&&(H.data=W)))),(W=Fte?Bte(t,r):Vte(t,r))&&(g=b2(g,"onBeforeInput"),0<g.length&&(v=new zR("onBeforeInput","beforeinput",null,r,v),w.push({event:v,listeners:g}),v.data=W))}a7(w,e)})}function Uv(t,e,r){return{instance:t,listener:e,currentTarget:r}}function b2(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Rv(t,r),o!=null&&n.unshift(Uv(t,o,i)),o=Rv(t,e),o!=null&&n.push(Uv(t,o,i))),t=t.return}return n}function Wm(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function XR(t,e,r,n,i){for(var o=e._reactName,u=[];r!==null&&r!==n;){var a=r,p=a.alternate,g=a.stateNode;if(p!==null&&p===n)break;a.tag===5&&g!==null&&(a=g,i?(p=Rv(r,o),p!=null&&u.unshift(Uv(r,p,a))):i||(p=Rv(r,o),p!=null&&u.push(Uv(r,p,a)))),r=r.return}u.length!==0&&t.push({event:e,listeners:u})}var rre=/\r\n?/g,nre=/\u0000|\uFFFD/g;function YR(t){return(typeof t=="string"?t:""+t).replace(rre,`
`).replace(nre,"")}function J1(t,e,r){if(e=YR(e),YR(t)!==e&&r)throw Error(Vt(425))}function w2(){}var RN=null,LN=null;function zN(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $N=typeof setTimeout=="function"?setTimeout:void 0,ire=typeof clearTimeout=="function"?clearTimeout:void 0,JR=typeof Promise=="function"?Promise:void 0,are=typeof queueMicrotask=="function"?queueMicrotask:typeof JR<"u"?function(t){return JR.resolve(null).then(t).catch(sre)}:$N;function sre(t){setTimeout(function(){throw t})}function tA(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),$v(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);$v(e)}function Ah(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function QR(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var z0=Math.random().toString(36).slice(2),Fc="__reactFiber$"+z0,qv="__reactProps$"+z0,nd="__reactContainer$"+z0,FN="__reactEvents$"+z0,ore="__reactListeners$"+z0,lre="__reactHandles$"+z0;function cp(t){var e=t[Fc];if(e)return e;for(var r=t.parentNode;r;){if(e=r[nd]||r[Fc]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=QR(t);t!==null;){if(r=t[Fc])return r;t=QR(t)}return e}t=r,r=t.parentNode}return null}function tb(t){return t=t[Fc]||t[nd],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function sg(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Vt(33))}function bT(t){return t[qv]||null}var BN=[],og=-1;function af(t){return{current:t}}function si(t){0>og||(t.current=BN[og],BN[og]=null,og--)}function Zn(t,e){og++,BN[og]=t.current,t.current=e}var Vh={},hs=af(Vh),Qs=af(!1),Np=Vh;function Lg(t,e){var r=t.type.contextTypes;if(!r)return Vh;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=e[o];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function eo(t){return t=t.childContextTypes,t!=null}function k2(){si(Qs),si(hs)}function e6(t,e,r){if(hs.current!==Vh)throw Error(Vt(168));Zn(hs,e),Zn(Qs,r)}function o7(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Vt(108,Wee(t)||"Unknown",i));return Ni({},r,n)}function T2(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vh,Np=hs.current,Zn(hs,t),Zn(Qs,Qs.current),!0}function t6(t,e,r){var n=t.stateNode;if(!n)throw Error(Vt(169));r?(t=o7(t,e,Np),n.__reactInternalMemoizedMergedChildContext=t,si(Qs),si(hs),Zn(hs,t)):si(Qs),Zn(Qs,r)}var qu=null,wT=!1,rA=!1;function l7(t){qu===null?qu=[t]:qu.push(t)}function cre(t){wT=!0,l7(t)}function sf(){if(!rA&&qu!==null){rA=!0;var t=0,e=Dn;try{var r=qu;for(Dn=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}qu=null,wT=!1}catch(i){throw qu!==null&&(qu=qu.slice(t+1)),MV(nI,sf),i}finally{Dn=e,rA=!1}}return null}var lg=[],cg=0,S2=null,E2=0,rl=[],nl=0,Cp=null,Gu=1,Wu="";function tp(t,e){lg[cg++]=E2,lg[cg++]=S2,S2=t,E2=e}function c7(t,e,r){rl[nl++]=Gu,rl[nl++]=Wu,rl[nl++]=Cp,Cp=t;var n=Gu;t=Wu;var i=32-nc(n)-1;n&=~(1<<i),r+=1;var o=32-nc(e)+i;if(30<o){var u=i-i%5;o=(n&(1<<u)-1).toString(32),n>>=u,i-=u,Gu=1<<32-nc(e)+i|r<<i|n,Wu=o+t}else Gu=1<<o|r<<i|n,Wu=t}function hI(t){t.return!==null&&(tp(t,1),c7(t,1,0))}function fI(t){for(;t===S2;)S2=lg[--cg],lg[cg]=null,E2=lg[--cg],lg[cg]=null;for(;t===Cp;)Cp=rl[--nl],rl[nl]=null,Wu=rl[--nl],rl[nl]=null,Gu=rl[--nl],rl[nl]=null}var Eo=null,To=null,di=!1,Ql=null;function u7(t,e){var r=ol(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function r6(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Eo=t,To=Ah(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Eo=t,To=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Cp!==null?{id:Gu,overflow:Wu}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=ol(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Eo=t,To=null,!0):!1;default:return!1}}function VN(t){return(t.mode&1)!==0&&(t.flags&128)===0}function UN(t){if(di){var e=To;if(e){var r=e;if(!r6(t,e)){if(VN(t))throw Error(Vt(418));e=Ah(r.nextSibling);var n=Eo;e&&r6(t,e)?u7(n,r):(t.flags=t.flags&-4097|2,di=!1,Eo=t)}}else{if(VN(t))throw Error(Vt(418));t.flags=t.flags&-4097|2,di=!1,Eo=t}}}function n6(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Eo=t}function Q1(t){if(t!==Eo)return!1;if(!di)return n6(t),di=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!zN(t.type,t.memoizedProps)),e&&(e=To)){if(VN(t))throw d7(),Error(Vt(418));for(;e;)u7(t,e),e=Ah(e.nextSibling)}if(n6(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Vt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){To=Ah(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}To=null}}else To=Eo?Ah(t.stateNode.nextSibling):null;return!0}function d7(){for(var t=To;t;)t=Ah(t.nextSibling)}function zg(){To=Eo=null,di=!1}function pI(t){Ql===null?Ql=[t]:Ql.push(t)}var ure=_d.ReactCurrentBatchConfig;function wx(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Vt(309));var n=r.stateNode}if(!n)throw Error(Vt(147,t));var i=n,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(u){var a=i.refs;u===null?delete a[o]:a[o]=u},e._stringRef=o,e)}if(typeof t!="string")throw Error(Vt(284));if(!r._owner)throw Error(Vt(290,t))}return t}function ew(t,e){throw t=Object.prototype.toString.call(e),Error(Vt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function i6(t){var e=t._init;return e(t._payload)}function h7(t){function e(L,O){if(t){var $=L.deletions;$===null?(L.deletions=[O],L.flags|=16):$.push(O)}}function r(L,O){if(!t)return null;for(;O!==null;)e(L,O),O=O.sibling;return null}function n(L,O){for(L=new Map;O!==null;)O.key!==null?L.set(O.key,O):L.set(O.index,O),O=O.sibling;return L}function i(L,O){return L=Ih(L,O),L.index=0,L.sibling=null,L}function o(L,O,$){return L.index=$,t?($=L.alternate,$!==null?($=$.index,$<O?(L.flags|=2,O):$):(L.flags|=2,O)):(L.flags|=1048576,O)}function u(L){return t&&L.alternate===null&&(L.flags|=2),L}function a(L,O,$,G){return O===null||O.tag!==6?(O=cA($,L.mode,G),O.return=L,O):(O=i(O,$),O.return=L,O)}function p(L,O,$,G){var B=$.type;return B===rg?v(L,O,$.props.children,G,$.key):O!==null&&(O.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===ch&&i6(B)===O.type)?(G=i(O,$.props),G.ref=wx(L,O,$),G.return=L,G):(G=Kw($.type,$.key,$.props,null,L.mode,G),G.ref=wx(L,O,$),G.return=L,G)}function g(L,O,$,G){return O===null||O.tag!==4||O.stateNode.containerInfo!==$.containerInfo||O.stateNode.implementation!==$.implementation?(O=uA($,L.mode,G),O.return=L,O):(O=i(O,$.children||[]),O.return=L,O)}function v(L,O,$,G,B){return O===null||O.tag!==7?(O=bp($,L.mode,G,B),O.return=L,O):(O=i(O,$),O.return=L,O)}function w(L,O,$){if(typeof O=="string"&&O!==""||typeof O=="number")return O=cA(""+O,L.mode,$),O.return=L,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case U1:return $=Kw(O.type,O.key,O.props,null,L.mode,$),$.ref=wx(L,null,O),$.return=L,$;case tg:return O=uA(O,L.mode,$),O.return=L,O;case ch:var G=O._init;return w(L,G(O._payload),$)}if(Bx(O)||yx(O))return O=bp(O,L.mode,$,null),O.return=L,O;ew(L,O)}return null}function T(L,O,$,G){var B=O!==null?O.key:null;if(typeof $=="string"&&$!==""||typeof $=="number")return B!==null?null:a(L,O,""+$,G);if(typeof $=="object"&&$!==null){switch($.$$typeof){case U1:return $.key===B?p(L,O,$,G):null;case tg:return $.key===B?g(L,O,$,G):null;case ch:return B=$._init,T(L,O,B($._payload),G)}if(Bx($)||yx($))return B!==null?null:v(L,O,$,G,null);ew(L,$)}return null}function A(L,O,$,G,B){if(typeof G=="string"&&G!==""||typeof G=="number")return L=L.get($)||null,a(O,L,""+G,B);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case U1:return L=L.get(G.key===null?$:G.key)||null,p(O,L,G,B);case tg:return L=L.get(G.key===null?$:G.key)||null,g(O,L,G,B);case ch:var J=G._init;return A(L,O,$,J(G._payload),B)}if(Bx(G)||yx(G))return L=L.get($)||null,v(O,L,G,B,null);ew(O,G)}return null}function I(L,O,$,G){for(var B=null,J=null,W=O,H=O=0,V=null;W!==null&&H<$.length;H++){W.index>H?(V=W,W=null):V=W.sibling;var se=T(L,W,$[H],G);if(se===null){W===null&&(W=V);break}t&&W&&se.alternate===null&&e(L,W),O=o(se,O,H),J===null?B=se:J.sibling=se,J=se,W=V}if(H===$.length)return r(L,W),di&&tp(L,H),B;if(W===null){for(;H<$.length;H++)W=w(L,$[H],G),W!==null&&(O=o(W,O,H),J===null?B=W:J.sibling=W,J=W);return di&&tp(L,H),B}for(W=n(L,W);H<$.length;H++)V=A(W,L,H,$[H],G),V!==null&&(t&&V.alternate!==null&&W.delete(V.key===null?H:V.key),O=o(V,O,H),J===null?B=V:J.sibling=V,J=V);return t&&W.forEach(function(K){return e(L,K)}),di&&tp(L,H),B}function P(L,O,$,G){var B=yx($);if(typeof B!="function")throw Error(Vt(150));if($=B.call($),$==null)throw Error(Vt(151));for(var J=B=null,W=O,H=O=0,V=null,se=$.next();W!==null&&!se.done;H++,se=$.next()){W.index>H?(V=W,W=null):V=W.sibling;var K=T(L,W,se.value,G);if(K===null){W===null&&(W=V);break}t&&W&&K.alternate===null&&e(L,W),O=o(K,O,H),J===null?B=K:J.sibling=K,J=K,W=V}if(se.done)return r(L,W),di&&tp(L,H),B;if(W===null){for(;!se.done;H++,se=$.next())se=w(L,se.value,G),se!==null&&(O=o(se,O,H),J===null?B=se:J.sibling=se,J=se);return di&&tp(L,H),B}for(W=n(L,W);!se.done;H++,se=$.next())se=A(W,L,H,se.value,G),se!==null&&(t&&se.alternate!==null&&W.delete(se.key===null?H:se.key),O=o(se,O,H),J===null?B=se:J.sibling=se,J=se);return t&&W.forEach(function(ce){return e(L,ce)}),di&&tp(L,H),B}function D(L,O,$,G){if(typeof $=="object"&&$!==null&&$.type===rg&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case U1:e:{for(var B=$.key,J=O;J!==null;){if(J.key===B){if(B=$.type,B===rg){if(J.tag===7){r(L,J.sibling),O=i(J,$.props.children),O.return=L,L=O;break e}}else if(J.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===ch&&i6(B)===J.type){r(L,J.sibling),O=i(J,$.props),O.ref=wx(L,J,$),O.return=L,L=O;break e}r(L,J);break}else e(L,J);J=J.sibling}$.type===rg?(O=bp($.props.children,L.mode,G,$.key),O.return=L,L=O):(G=Kw($.type,$.key,$.props,null,L.mode,G),G.ref=wx(L,O,$),G.return=L,L=G)}return u(L);case tg:e:{for(J=$.key;O!==null;){if(O.key===J)if(O.tag===4&&O.stateNode.containerInfo===$.containerInfo&&O.stateNode.implementation===$.implementation){r(L,O.sibling),O=i(O,$.children||[]),O.return=L,L=O;break e}else{r(L,O);break}else e(L,O);O=O.sibling}O=uA($,L.mode,G),O.return=L,L=O}return u(L);case ch:return J=$._init,D(L,O,J($._payload),G)}if(Bx($))return I(L,O,$,G);if(yx($))return P(L,O,$,G);ew(L,$)}return typeof $=="string"&&$!==""||typeof $=="number"?($=""+$,O!==null&&O.tag===6?(r(L,O.sibling),O=i(O,$),O.return=L,L=O):(r(L,O),O=cA($,L.mode,G),O.return=L,L=O),u(L)):r(L,O)}return D}var $g=h7(!0),f7=h7(!1),j2=af(null),A2=null,ug=null,mI=null;function gI(){mI=ug=A2=null}function yI(t){var e=j2.current;si(j2),t._currentValue=e}function qN(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function jg(t,e){A2=t,mI=ug=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Zs=!0),t.firstContext=null)}function pl(t){var e=t._currentValue;if(mI!==t)if(t={context:t,memoizedValue:e,next:null},ug===null){if(A2===null)throw Error(Vt(308));ug=t,A2.dependencies={lanes:0,firstContext:t}}else ug=ug.next=t;return e}var up=null;function xI(t){up===null?up=[t]:up.push(t)}function p7(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,xI(e)):(r.next=i.next,i.next=r),e.interleaved=r,id(t,n)}function id(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var uh=!1;function vI(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function m7(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yu(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Nh(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,dn&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,id(t,r)}return i=n.interleaved,i===null?(e.next=e,xI(n)):(e.next=i.next,i.next=e),n.interleaved=e,id(t,r)}function Vw(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,iI(t,r)}}function a6(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var u={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=u:o=o.next=u,r=r.next}while(r!==null);o===null?i=o=e:o=o.next=e}else i=o=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function N2(t,e,r,n){var i=t.updateQueue;uh=!1;var o=i.firstBaseUpdate,u=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var p=a,g=p.next;p.next=null,u===null?o=g:u.next=g,u=p;var v=t.alternate;v!==null&&(v=v.updateQueue,a=v.lastBaseUpdate,a!==u&&(a===null?v.firstBaseUpdate=g:a.next=g,v.lastBaseUpdate=p))}if(o!==null){var w=i.baseState;u=0,v=g=p=null,a=o;do{var T=a.lane,A=a.eventTime;if((n&T)===T){v!==null&&(v=v.next={eventTime:A,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var I=t,P=a;switch(T=e,A=r,P.tag){case 1:if(I=P.payload,typeof I=="function"){w=I.call(A,w,T);break e}w=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=P.payload,T=typeof I=="function"?I.call(A,w,T):I,T==null)break e;w=Ni({},w,T);break e;case 2:uh=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,T=i.effects,T===null?i.effects=[a]:T.push(a))}else A={eventTime:A,lane:T,tag:a.tag,payload:a.payload,callback:a.callback,next:null},v===null?(g=v=A,p=w):v=v.next=A,u|=T;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;T=a,a=T.next,T.next=null,i.lastBaseUpdate=T,i.shared.pending=null}}while(1);if(v===null&&(p=w),i.baseState=p,i.firstBaseUpdate=g,i.lastBaseUpdate=v,e=i.shared.interleaved,e!==null){i=e;do u|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Ip|=u,t.lanes=u,t.memoizedState=w}}function s6(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Vt(191,i));i.call(n)}}}var rb={},qc=af(rb),Gv=af(rb),Wv=af(rb);function dp(t){if(t===rb)throw Error(Vt(174));return t}function _I(t,e){switch(Zn(Wv,e),Zn(Gv,t),Zn(qc,rb),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:TN(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=TN(e,t)}si(qc),Zn(qc,e)}function Fg(){si(qc),si(Gv),si(Wv)}function g7(t){dp(Wv.current);var e=dp(qc.current),r=TN(e,t.type);e!==r&&(Zn(Gv,t),Zn(qc,r))}function bI(t){Gv.current===t&&(si(qc),si(Gv))}var Si=af(0);function C2(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var nA=[];function wI(){for(var t=0;t<nA.length;t++)nA[t]._workInProgressVersionPrimary=null;nA.length=0}var Uw=_d.ReactCurrentDispatcher,iA=_d.ReactCurrentBatchConfig,Pp=0,Ai=null,ha=null,ja=null,P2=!1,cv=!1,Hv=0,dre=0;function es(){throw Error(Vt(321))}function kI(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!oc(t[r],e[r]))return!1;return!0}function TI(t,e,r,n,i,o){if(Pp=o,Ai=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Uw.current=t===null||t.memoizedState===null?mre:gre,t=r(n,i),cv){o=0;do{if(cv=!1,Hv=0,25<=o)throw Error(Vt(301));o+=1,ja=ha=null,e.updateQueue=null,Uw.current=yre,t=r(n,i)}while(cv)}if(Uw.current=I2,e=ha!==null&&ha.next!==null,Pp=0,ja=ha=Ai=null,P2=!1,e)throw Error(Vt(300));return t}function SI(){var t=Hv!==0;return Hv=0,t}function Rc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ja===null?Ai.memoizedState=ja=t:ja=ja.next=t,ja}function ml(){if(ha===null){var t=Ai.alternate;t=t!==null?t.memoizedState:null}else t=ha.next;var e=ja===null?Ai.memoizedState:ja.next;if(e!==null)ja=e,ha=t;else{if(t===null)throw Error(Vt(310));ha=t,t={memoizedState:ha.memoizedState,baseState:ha.baseState,baseQueue:ha.baseQueue,queue:ha.queue,next:null},ja===null?Ai.memoizedState=ja=t:ja=ja.next=t}return ja}function Kv(t,e){return typeof e=="function"?e(t):e}function aA(t){var e=ml(),r=e.queue;if(r===null)throw Error(Vt(311));r.lastRenderedReducer=t;var n=ha,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var u=i.next;i.next=o.next,o.next=u}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var a=u=null,p=null,g=o;do{var v=g.lane;if((Pp&v)===v)p!==null&&(p=p.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),n=g.hasEagerState?g.eagerState:t(n,g.action);else{var w={lane:v,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};p===null?(a=p=w,u=n):p=p.next=w,Ai.lanes|=v,Ip|=v}g=g.next}while(g!==null&&g!==o);p===null?u=n:p.next=a,oc(n,e.memoizedState)||(Zs=!0),e.memoizedState=n,e.baseState=u,e.baseQueue=p,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do o=i.lane,Ai.lanes|=o,Ip|=o,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function sA(t){var e=ml(),r=e.queue;if(r===null)throw Error(Vt(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,o=e.memoizedState;if(i!==null){r.pending=null;var u=i=i.next;do o=t(o,u.action),u=u.next;while(u!==i);oc(o,e.memoizedState)||(Zs=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),r.lastRenderedState=o}return[o,n]}function y7(){}function x7(t,e){var r=Ai,n=ml(),i=e(),o=!oc(n.memoizedState,i);if(o&&(n.memoizedState=i,Zs=!0),n=n.queue,EI(b7.bind(null,r,n,t),[t]),n.getSnapshot!==e||o||ja!==null&&ja.memoizedState.tag&1){if(r.flags|=2048,Zv(9,_7.bind(null,r,n,i,e),void 0,null),Na===null)throw Error(Vt(349));Pp&30||v7(r,e,i)}return i}function v7(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ai.updateQueue,e===null?(e={lastEffect:null,stores:null},Ai.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function _7(t,e,r,n){e.value=r,e.getSnapshot=n,w7(e)&&k7(t)}function b7(t,e,r){return r(function(){w7(e)&&k7(t)})}function w7(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!oc(t,r)}catch{return!0}}function k7(t){var e=id(t,1);e!==null&&ic(e,t,1,-1)}function o6(t){var e=Rc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kv,lastRenderedState:t},e.queue=t,t=t.dispatch=pre.bind(null,Ai,t),[e.memoizedState,t]}function Zv(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ai.updateQueue,e===null?(e={lastEffect:null,stores:null},Ai.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function T7(){return ml().memoizedState}function qw(t,e,r,n){var i=Rc();Ai.flags|=t,i.memoizedState=Zv(1|e,r,void 0,n===void 0?null:n)}function kT(t,e,r,n){var i=ml();n=n===void 0?null:n;var o=void 0;if(ha!==null){var u=ha.memoizedState;if(o=u.destroy,n!==null&&kI(n,u.deps)){i.memoizedState=Zv(e,r,o,n);return}}Ai.flags|=t,i.memoizedState=Zv(1|e,r,o,n)}function l6(t,e){return qw(8390656,8,t,e)}function EI(t,e){return kT(2048,8,t,e)}function S7(t,e){return kT(4,2,t,e)}function E7(t,e){return kT(4,4,t,e)}function j7(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function A7(t,e,r){return r=r!=null?r.concat([t]):null,kT(4,4,j7.bind(null,e,t),r)}function jI(){}function N7(t,e){var r=ml();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&kI(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function C7(t,e){var r=ml();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&kI(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function P7(t,e,r){return Pp&21?(oc(r,e)||(r=RV(),Ai.lanes|=r,Ip|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Zs=!0),t.memoizedState=r)}function hre(t,e){var r=Dn;Dn=r!==0&&4>r?r:4,t(!0);var n=iA.transition;iA.transition={};try{t(!1),e()}finally{Dn=r,iA.transition=n}}function I7(){return ml().memoizedState}function fre(t,e,r){var n=Ph(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},M7(t))D7(e,r);else if(r=p7(t,e,r,n),r!==null){var i=Cs();ic(r,t,n,i),O7(r,e,n)}}function pre(t,e,r){var n=Ph(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(M7(t))D7(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var u=e.lastRenderedState,a=o(u,r);if(i.hasEagerState=!0,i.eagerState=a,oc(a,u)){var p=e.interleaved;p===null?(i.next=i,xI(e)):(i.next=p.next,p.next=i),e.interleaved=i;return}}catch{}finally{}r=p7(t,e,i,n),r!==null&&(i=Cs(),ic(r,t,n,i),O7(r,e,n))}}function M7(t){var e=t.alternate;return t===Ai||e!==null&&e===Ai}function D7(t,e){cv=P2=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function O7(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,iI(t,r)}}var I2={readContext:pl,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},mre={readContext:pl,useCallback:function(t,e){return Rc().memoizedState=[t,e===void 0?null:e],t},useContext:pl,useEffect:l6,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,qw(4194308,4,j7.bind(null,e,t),r)},useLayoutEffect:function(t,e){return qw(4194308,4,t,e)},useInsertionEffect:function(t,e){return qw(4,2,t,e)},useMemo:function(t,e){var r=Rc();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Rc();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=fre.bind(null,Ai,t),[n.memoizedState,t]},useRef:function(t){var e=Rc();return t={current:t},e.memoizedState=t},useState:o6,useDebugValue:jI,useDeferredValue:function(t){return Rc().memoizedState=t},useTransition:function(){var t=o6(!1),e=t[0];return t=hre.bind(null,t[1]),Rc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ai,i=Rc();if(di){if(r===void 0)throw Error(Vt(407));r=r()}else{if(r=e(),Na===null)throw Error(Vt(349));Pp&30||v7(n,e,r)}i.memoizedState=r;var o={value:r,getSnapshot:e};return i.queue=o,l6(b7.bind(null,n,o,t),[t]),n.flags|=2048,Zv(9,_7.bind(null,n,o,r,e),void 0,null),r},useId:function(){var t=Rc(),e=Na.identifierPrefix;if(di){var r=Wu,n=Gu;r=(n&~(1<<32-nc(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Hv++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=dre++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gre={readContext:pl,useCallback:N7,useContext:pl,useEffect:EI,useImperativeHandle:A7,useInsertionEffect:S7,useLayoutEffect:E7,useMemo:C7,useReducer:aA,useRef:T7,useState:function(){return aA(Kv)},useDebugValue:jI,useDeferredValue:function(t){var e=ml();return P7(e,ha.memoizedState,t)},useTransition:function(){var t=aA(Kv)[0],e=ml().memoizedState;return[t,e]},useMutableSource:y7,useSyncExternalStore:x7,useId:I7,unstable_isNewReconciler:!1},yre={readContext:pl,useCallback:N7,useContext:pl,useEffect:EI,useImperativeHandle:A7,useInsertionEffect:S7,useLayoutEffect:E7,useMemo:C7,useReducer:sA,useRef:T7,useState:function(){return sA(Kv)},useDebugValue:jI,useDeferredValue:function(t){var e=ml();return ha===null?e.memoizedState=t:P7(e,ha.memoizedState,t)},useTransition:function(){var t=sA(Kv)[0],e=ml().memoizedState;return[t,e]},useMutableSource:y7,useSyncExternalStore:x7,useId:I7,unstable_isNewReconciler:!1};function Kl(t,e){if(t&&t.defaultProps){e=Ni({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function GN(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ni({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var TT={isMounted:function(t){return(t=t._reactInternals)?Up(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Cs(),i=Ph(t),o=Yu(n,i);o.payload=e,r!=null&&(o.callback=r),e=Nh(t,o,i),e!==null&&(ic(e,t,i,n),Vw(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Cs(),i=Ph(t),o=Yu(n,i);o.tag=1,o.payload=e,r!=null&&(o.callback=r),e=Nh(t,o,i),e!==null&&(ic(e,t,i,n),Vw(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Cs(),n=Ph(t),i=Yu(r,n);i.tag=2,e!=null&&(i.callback=e),e=Nh(t,i,n),e!==null&&(ic(e,t,n,r),Vw(e,t,n))}};function c6(t,e,r,n,i,o,u){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,o,u):e.prototype&&e.prototype.isPureReactComponent?!Bv(r,n)||!Bv(i,o):!0}function R7(t,e,r){var n=!1,i=Vh,o=e.contextType;return typeof o=="object"&&o!==null?o=pl(o):(i=eo(e)?Np:hs.current,n=e.contextTypes,o=(n=n!=null)?Lg(t,i):Vh),e=new e(r,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=TT,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function u6(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&TT.enqueueReplaceState(e,e.state,null)}function WN(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},vI(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=pl(o):(o=eo(e)?Np:hs.current,i.context=Lg(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(GN(t,e,o,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&TT.enqueueReplaceState(i,i.state,null),N2(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Bg(t,e){try{var r="",n=e;do r+=Gee(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function oA(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function HN(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var xre=typeof WeakMap=="function"?WeakMap:Map;function L7(t,e,r){r=Yu(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){D2||(D2=!0,nC=n),HN(t,e)},r}function z7(t,e,r){r=Yu(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){HN(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){HN(t,e),typeof n!="function"&&(Ch===null?Ch=new Set([this]):Ch.add(this));var u=e.stack;this.componentDidCatch(e.value,{componentStack:u!==null?u:""})}),r}function d6(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new xre;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=Ire.bind(null,t,e,r),e.then(t,t))}function h6(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function f6(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Yu(-1,1),e.tag=2,Nh(r,e,1))),r.lanes|=1),t)}var vre=_d.ReactCurrentOwner,Zs=!1;function Ts(t,e,r,n){e.child=t===null?f7(e,null,r,n):$g(e,t.child,r,n)}function p6(t,e,r,n,i){r=r.render;var o=e.ref;return jg(e,i),n=TI(t,e,r,n,o,i),r=SI(),t!==null&&!Zs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ad(t,e,i)):(di&&r&&hI(e),e.flags|=1,Ts(t,e,n,i),e.child)}function m6(t,e,r,n,i){if(t===null){var o=r.type;return typeof o=="function"&&!OI(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=o,$7(t,e,o,n,i)):(t=Kw(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var u=o.memoizedProps;if(r=r.compare,r=r!==null?r:Bv,r(u,n)&&t.ref===e.ref)return ad(t,e,i)}return e.flags|=1,t=Ih(o,n),t.ref=e.ref,t.return=e,e.child=t}function $7(t,e,r,n,i){if(t!==null){var o=t.memoizedProps;if(Bv(o,n)&&t.ref===e.ref)if(Zs=!1,e.pendingProps=n=o,(t.lanes&i)!==0)t.flags&131072&&(Zs=!0);else return e.lanes=t.lanes,ad(t,e,i)}return KN(t,e,r,n,i)}function F7(t,e,r){var n=e.pendingProps,i=n.children,o=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zn(hg,bo),bo|=r;else{if(!(r&1073741824))return t=o!==null?o.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Zn(hg,bo),bo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Zn(hg,bo),bo|=n}else o!==null?(n=o.baseLanes|r,e.memoizedState=null):n=r,Zn(hg,bo),bo|=n;return Ts(t,e,i,r),e.child}function B7(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function KN(t,e,r,n,i){var o=eo(r)?Np:hs.current;return o=Lg(e,o),jg(e,i),r=TI(t,e,r,n,o,i),n=SI(),t!==null&&!Zs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ad(t,e,i)):(di&&n&&hI(e),e.flags|=1,Ts(t,e,r,i),e.child)}function g6(t,e,r,n,i){if(eo(r)){var o=!0;T2(e)}else o=!1;if(jg(e,i),e.stateNode===null)Gw(t,e),R7(e,r,n),WN(e,r,n,i),n=!0;else if(t===null){var u=e.stateNode,a=e.memoizedProps;u.props=a;var p=u.context,g=r.contextType;typeof g=="object"&&g!==null?g=pl(g):(g=eo(r)?Np:hs.current,g=Lg(e,g));var v=r.getDerivedStateFromProps,w=typeof v=="function"||typeof u.getSnapshotBeforeUpdate=="function";w||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==n||p!==g)&&u6(e,u,n,g),uh=!1;var T=e.memoizedState;u.state=T,N2(e,n,u,i),p=e.memoizedState,a!==n||T!==p||Qs.current||uh?(typeof v=="function"&&(GN(e,r,v,n),p=e.memoizedState),(a=uh||c6(e,r,a,n,T,p,g))?(w||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(e.flags|=4194308)):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=p),u.props=n,u.state=p,u.context=g,n=a):(typeof u.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{u=e.stateNode,m7(t,e),a=e.memoizedProps,g=e.type===e.elementType?a:Kl(e.type,a),u.props=g,w=e.pendingProps,T=u.context,p=r.contextType,typeof p=="object"&&p!==null?p=pl(p):(p=eo(r)?Np:hs.current,p=Lg(e,p));var A=r.getDerivedStateFromProps;(v=typeof A=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(a!==w||T!==p)&&u6(e,u,n,p),uh=!1,T=e.memoizedState,u.state=T,N2(e,n,u,i);var I=e.memoizedState;a!==w||T!==I||Qs.current||uh?(typeof A=="function"&&(GN(e,r,A,n),I=e.memoizedState),(g=uh||c6(e,r,g,n,T,I,p)||!1)?(v||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(n,I,p),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(n,I,p)),typeof u.componentDidUpdate=="function"&&(e.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof u.componentDidUpdate!="function"||a===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=I),u.props=n,u.state=I,u.context=p,n=g):(typeof u.componentDidUpdate!="function"||a===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),n=!1)}return ZN(t,e,r,n,o,i)}function ZN(t,e,r,n,i,o){B7(t,e);var u=(e.flags&128)!==0;if(!n&&!u)return i&&t6(e,r,!1),ad(t,e,o);n=e.stateNode,vre.current=e;var a=u&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&u?(e.child=$g(e,t.child,null,o),e.child=$g(e,null,a,o)):Ts(t,e,a,o),e.memoizedState=n.state,i&&t6(e,r,!0),e.child}function V7(t){var e=t.stateNode;e.pendingContext?e6(t,e.pendingContext,e.pendingContext!==e.context):e.context&&e6(t,e.context,!1),_I(t,e.containerInfo)}function y6(t,e,r,n,i){return zg(),pI(i),e.flags|=256,Ts(t,e,r,n),e.child}var XN={dehydrated:null,treeContext:null,retryLane:0};function YN(t){return{baseLanes:t,cachePool:null,transitions:null}}function U7(t,e,r){var n=e.pendingProps,i=Si.current,o=!1,u=(e.flags&128)!==0,a;if((a=u)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Zn(Si,i&1),t===null)return UN(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(u=n.children,t=n.fallback,o?(n=e.mode,o=e.child,u={mode:"hidden",children:u},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=u):o=jT(u,n,0,null),t=bp(t,n,r,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=YN(r),e.memoizedState=XN,t):AI(e,u));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return _re(t,e,u,n,a,i,r);if(o){o=n.fallback,u=e.mode,i=t.child,a=i.sibling;var p={mode:"hidden",children:n.children};return!(u&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=p,e.deletions=null):(n=Ih(i,p),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Ih(a,o):(o=bp(o,u,r,null),o.flags|=2),o.return=e,n.return=e,n.sibling=o,e.child=n,n=o,o=e.child,u=t.child.memoizedState,u=u===null?YN(r):{baseLanes:u.baseLanes|r,cachePool:null,transitions:u.transitions},o.memoizedState=u,o.childLanes=t.childLanes&~r,e.memoizedState=XN,n}return o=t.child,t=o.sibling,n=Ih(o,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function AI(t,e){return e=jT({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function tw(t,e,r,n){return n!==null&&pI(n),$g(e,t.child,null,r),t=AI(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _re(t,e,r,n,i,o,u){if(r)return e.flags&256?(e.flags&=-257,n=oA(Error(Vt(422))),tw(t,e,u,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=n.fallback,i=e.mode,n=jT({mode:"visible",children:n.children},i,0,null),o=bp(o,i,u,null),o.flags|=2,n.return=e,o.return=e,n.sibling=o,e.child=n,e.mode&1&&$g(e,t.child,null,u),e.child.memoizedState=YN(u),e.memoizedState=XN,o);if(!(e.mode&1))return tw(t,e,u,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,o=Error(Vt(419)),n=oA(o,n,void 0),tw(t,e,u,n)}if(a=(u&t.childLanes)!==0,Zs||a){if(n=Na,n!==null){switch(u&-u){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|u)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,id(t,i),ic(n,t,i,-1))}return DI(),n=oA(Error(Vt(421))),tw(t,e,u,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Mre.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,To=Ah(i.nextSibling),Eo=e,di=!0,Ql=null,t!==null&&(rl[nl++]=Gu,rl[nl++]=Wu,rl[nl++]=Cp,Gu=t.id,Wu=t.overflow,Cp=e),e=AI(e,n.children),e.flags|=4096,e)}function x6(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),qN(t.return,e,r)}function lA(t,e,r,n,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function q7(t,e,r){var n=e.pendingProps,i=n.revealOrder,o=n.tail;if(Ts(t,e,n.children,r),n=Si.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&x6(t,r,e);else if(t.tag===19)x6(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Zn(Si,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&C2(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),lA(e,!1,i,r,o);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&C2(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}lA(e,!0,r,null,o);break;case"together":lA(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Gw(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ad(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ip|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Vt(153));if(e.child!==null){for(t=e.child,r=Ih(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ih(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function bre(t,e,r){switch(e.tag){case 3:V7(e),zg();break;case 5:g7(e);break;case 1:eo(e.type)&&T2(e);break;case 4:_I(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Zn(j2,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Zn(Si,Si.current&1),e.flags|=128,null):r&e.child.childLanes?U7(t,e,r):(Zn(Si,Si.current&1),t=ad(t,e,r),t!==null?t.sibling:null);Zn(Si,Si.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return q7(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Zn(Si,Si.current),n)break;return null;case 22:case 23:return e.lanes=0,F7(t,e,r)}return ad(t,e,r)}var G7,JN,W7,H7;G7=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};JN=function(){};W7=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,dp(qc.current);var o=null;switch(r){case"input":i=_N(t,i),n=_N(t,n),o=[];break;case"select":i=Ni({},i,{value:void 0}),n=Ni({},n,{value:void 0}),o=[];break;case"textarea":i=kN(t,i),n=kN(t,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=w2)}SN(r,n);var u;r=null;for(g in i)if(!n.hasOwnProperty(g)&&i.hasOwnProperty(g)&&i[g]!=null)if(g==="style"){var a=i[g];for(u in a)a.hasOwnProperty(u)&&(r||(r={}),r[u]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Dv.hasOwnProperty(g)?o||(o=[]):(o=o||[]).push(g,null));for(g in n){var p=n[g];if(a=i!=null?i[g]:void 0,n.hasOwnProperty(g)&&p!==a&&(p!=null||a!=null))if(g==="style")if(a){for(u in a)!a.hasOwnProperty(u)||p&&p.hasOwnProperty(u)||(r||(r={}),r[u]="");for(u in p)p.hasOwnProperty(u)&&a[u]!==p[u]&&(r||(r={}),r[u]=p[u])}else r||(o||(o=[]),o.push(g,r)),r=p;else g==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,a=a?a.__html:void 0,p!=null&&a!==p&&(o=o||[]).push(g,p)):g==="children"?typeof p!="string"&&typeof p!="number"||(o=o||[]).push(g,""+p):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(Dv.hasOwnProperty(g)?(p!=null&&g==="onScroll"&&ei("scroll",t),o||a===p||(o=[])):(o=o||[]).push(g,p))}r&&(o=o||[]).push("style",r);var g=o;(e.updateQueue=g)&&(e.flags|=4)}};H7=function(t,e,r,n){r!==n&&(e.flags|=4)};function kx(t,e){if(!di)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function wre(t,e,r){var n=e.pendingProps;switch(fI(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(e),null;case 1:return eo(e.type)&&k2(),ts(e),null;case 3:return n=e.stateNode,Fg(),si(Qs),si(hs),wI(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Q1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ql!==null&&(sC(Ql),Ql=null))),JN(t,e),ts(e),null;case 5:bI(e);var i=dp(Wv.current);if(r=e.type,t!==null&&e.stateNode!=null)W7(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Vt(166));return ts(e),null}if(t=dp(qc.current),Q1(e)){n=e.stateNode,r=e.type;var o=e.memoizedProps;switch(n[Fc]=e,n[qv]=o,t=(e.mode&1)!==0,r){case"dialog":ei("cancel",n),ei("close",n);break;case"iframe":case"object":case"embed":ei("load",n);break;case"video":case"audio":for(i=0;i<Ux.length;i++)ei(Ux[i],n);break;case"source":ei("error",n);break;case"img":case"image":case"link":ei("error",n),ei("load",n);break;case"details":ei("toggle",n);break;case"input":jR(n,o),ei("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},ei("invalid",n);break;case"textarea":NR(n,o),ei("invalid",n)}SN(r,o),i=null;for(var u in o)if(o.hasOwnProperty(u)){var a=o[u];u==="children"?typeof a=="string"?n.textContent!==a&&(o.suppressHydrationWarning!==!0&&J1(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&J1(n.textContent,a,t),i=["children",""+a]):Dv.hasOwnProperty(u)&&a!=null&&u==="onScroll"&&ei("scroll",n)}switch(r){case"input":q1(n),AR(n,o,!0);break;case"textarea":q1(n),CR(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=w2)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{u=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=bV(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=u.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=u.createElement(r,{is:n.is}):(t=u.createElement(r),r==="select"&&(u=t,n.multiple?u.multiple=!0:n.size&&(u.size=n.size))):t=u.createElementNS(t,r),t[Fc]=e,t[qv]=n,G7(t,e,!1,!1),e.stateNode=t;e:{switch(u=EN(r,n),r){case"dialog":ei("cancel",t),ei("close",t),i=n;break;case"iframe":case"object":case"embed":ei("load",t),i=n;break;case"video":case"audio":for(i=0;i<Ux.length;i++)ei(Ux[i],t);i=n;break;case"source":ei("error",t),i=n;break;case"img":case"image":case"link":ei("error",t),ei("load",t),i=n;break;case"details":ei("toggle",t),i=n;break;case"input":jR(t,n),i=_N(t,n),ei("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Ni({},n,{value:void 0}),ei("invalid",t);break;case"textarea":NR(t,n),i=kN(t,n),ei("invalid",t);break;default:i=n}SN(r,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var p=a[o];o==="style"?TV(t,p):o==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&wV(t,p)):o==="children"?typeof p=="string"?(r!=="textarea"||p!=="")&&Ov(t,p):typeof p=="number"&&Ov(t,""+p):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Dv.hasOwnProperty(o)?p!=null&&o==="onScroll"&&ei("scroll",t):p!=null&&J4(t,o,p,u))}switch(r){case"input":q1(t),AR(t,n,!1);break;case"textarea":q1(t),CR(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Bh(n.value));break;case"select":t.multiple=!!n.multiple,o=n.value,o!=null?kg(t,!!n.multiple,o,!1):n.defaultValue!=null&&kg(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=w2)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ts(e),null;case 6:if(t&&e.stateNode!=null)H7(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Vt(166));if(r=dp(Wv.current),dp(qc.current),Q1(e)){if(n=e.stateNode,r=e.memoizedProps,n[Fc]=e,(o=n.nodeValue!==r)&&(t=Eo,t!==null))switch(t.tag){case 3:J1(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&J1(n.nodeValue,r,(t.mode&1)!==0)}o&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Fc]=e,e.stateNode=n}return ts(e),null;case 13:if(si(Si),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(di&&To!==null&&e.mode&1&&!(e.flags&128))d7(),zg(),e.flags|=98560,o=!1;else if(o=Q1(e),n!==null&&n.dehydrated!==null){if(t===null){if(!o)throw Error(Vt(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Vt(317));o[Fc]=e}else zg(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ts(e),o=!1}else Ql!==null&&(sC(Ql),Ql=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Si.current&1?fa===0&&(fa=3):DI())),e.updateQueue!==null&&(e.flags|=4),ts(e),null);case 4:return Fg(),JN(t,e),t===null&&Vv(e.stateNode.containerInfo),ts(e),null;case 10:return yI(e.type._context),ts(e),null;case 17:return eo(e.type)&&k2(),ts(e),null;case 19:if(si(Si),o=e.memoizedState,o===null)return ts(e),null;if(n=(e.flags&128)!==0,u=o.rendering,u===null)if(n)kx(o,!1);else{if(fa!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(u=C2(t),u!==null){for(e.flags|=128,kx(o,!1),n=u.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)o=r,t=n,o.flags&=14680066,u=o.alternate,u===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,t=u.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Zn(Si,Si.current&1|2),e.child}t=t.sibling}o.tail!==null&&Vi()>Vg&&(e.flags|=128,n=!0,kx(o,!1),e.lanes=4194304)}else{if(!n)if(t=C2(u),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),kx(o,!0),o.tail===null&&o.tailMode==="hidden"&&!u.alternate&&!di)return ts(e),null}else 2*Vi()-o.renderingStartTime>Vg&&r!==1073741824&&(e.flags|=128,n=!0,kx(o,!1),e.lanes=4194304);o.isBackwards?(u.sibling=e.child,e.child=u):(r=o.last,r!==null?r.sibling=u:e.child=u,o.last=u)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Vi(),e.sibling=null,r=Si.current,Zn(Si,n?r&1|2:r&1),e):(ts(e),null);case 22:case 23:return MI(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?bo&1073741824&&(ts(e),e.subtreeFlags&6&&(e.flags|=8192)):ts(e),null;case 24:return null;case 25:return null}throw Error(Vt(156,e.tag))}function kre(t,e){switch(fI(e),e.tag){case 1:return eo(e.type)&&k2(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Fg(),si(Qs),si(hs),wI(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bI(e),null;case 13:if(si(Si),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Vt(340));zg()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return si(Si),null;case 4:return Fg(),null;case 10:return yI(e.type._context),null;case 22:case 23:return MI(),null;case 24:return null;default:return null}}var rw=!1,ss=!1,Tre=typeof WeakSet=="function"?WeakSet:Set,or=null;function dg(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Oi(t,e,n)}else r.current=null}function QN(t,e,r){try{r()}catch(n){Oi(t,e,n)}}var v6=!1;function Sre(t,e){if(RN=v2,t=JV(),dI(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var u=0,a=-1,p=-1,g=0,v=0,w=t,T=null;t:for(;;){for(var A;w!==r||i!==0&&w.nodeType!==3||(a=u+i),w!==o||n!==0&&w.nodeType!==3||(p=u+n),w.nodeType===3&&(u+=w.nodeValue.length),(A=w.firstChild)!==null;)T=w,w=A;for(;;){if(w===t)break t;if(T===r&&++g===i&&(a=u),T===o&&++v===n&&(p=u),(A=w.nextSibling)!==null)break;w=T,T=w.parentNode}w=A}r=a===-1||p===-1?null:{start:a,end:p}}else r=null}r=r||{start:0,end:0}}else r=null;for(LN={focusedElem:t,selectionRange:r},v2=!1,or=e;or!==null;)if(e=or,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,or=t;else for(;or!==null;){e=or;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var P=I.memoizedProps,D=I.memoizedState,L=e.stateNode,O=L.getSnapshotBeforeUpdate(e.elementType===e.type?P:Kl(e.type,P),D);L.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var $=e.stateNode.containerInfo;$.nodeType===1?$.textContent="":$.nodeType===9&&$.documentElement&&$.removeChild($.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Vt(163))}}catch(G){Oi(e,e.return,G)}if(t=e.sibling,t!==null){t.return=e.return,or=t;break}or=e.return}return I=v6,v6=!1,I}function uv(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&QN(e,r,o)}i=i.next}while(i!==n)}}function ST(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function eC(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function K7(t){var e=t.alternate;e!==null&&(t.alternate=null,K7(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Fc],delete e[qv],delete e[FN],delete e[ore],delete e[lre])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Z7(t){return t.tag===5||t.tag===3||t.tag===4}function _6(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Z7(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function tC(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=w2));else if(n!==4&&(t=t.child,t!==null))for(tC(t,e,r),t=t.sibling;t!==null;)tC(t,e,r),t=t.sibling}function rC(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(rC(t,e,r),t=t.sibling;t!==null;)rC(t,e,r),t=t.sibling}var La=null,Zl=!1;function ih(t,e,r){for(r=r.child;r!==null;)X7(t,e,r),r=r.sibling}function X7(t,e,r){if(Uc&&typeof Uc.onCommitFiberUnmount=="function")try{Uc.onCommitFiberUnmount(yT,r)}catch{}switch(r.tag){case 5:ss||dg(r,e);case 6:var n=La,i=Zl;La=null,ih(t,e,r),La=n,Zl=i,La!==null&&(Zl?(t=La,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):La.removeChild(r.stateNode));break;case 18:La!==null&&(Zl?(t=La,r=r.stateNode,t.nodeType===8?tA(t.parentNode,r):t.nodeType===1&&tA(t,r),$v(t)):tA(La,r.stateNode));break;case 4:n=La,i=Zl,La=r.stateNode.containerInfo,Zl=!0,ih(t,e,r),La=n,Zl=i;break;case 0:case 11:case 14:case 15:if(!ss&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,u=o.destroy;o=o.tag,u!==void 0&&(o&2||o&4)&&QN(r,e,u),i=i.next}while(i!==n)}ih(t,e,r);break;case 1:if(!ss&&(dg(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Oi(r,e,a)}ih(t,e,r);break;case 21:ih(t,e,r);break;case 22:r.mode&1?(ss=(n=ss)||r.memoizedState!==null,ih(t,e,r),ss=n):ih(t,e,r);break;default:ih(t,e,r)}}function b6(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Tre),e.forEach(function(n){var i=Dre.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ul(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=t,u=e,a=u;e:for(;a!==null;){switch(a.tag){case 5:La=a.stateNode,Zl=!1;break e;case 3:La=a.stateNode.containerInfo,Zl=!0;break e;case 4:La=a.stateNode.containerInfo,Zl=!0;break e}a=a.return}if(La===null)throw Error(Vt(160));X7(o,u,i),La=null,Zl=!1;var p=i.alternate;p!==null&&(p.return=null),i.return=null}catch(g){Oi(i,e,g)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Y7(e,t),e=e.sibling}function Y7(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ul(e,t),Oc(t),n&4){try{uv(3,t,t.return),ST(3,t)}catch(P){Oi(t,t.return,P)}try{uv(5,t,t.return)}catch(P){Oi(t,t.return,P)}}break;case 1:Ul(e,t),Oc(t),n&512&&r!==null&&dg(r,r.return);break;case 5:if(Ul(e,t),Oc(t),n&512&&r!==null&&dg(r,r.return),t.flags&32){var i=t.stateNode;try{Ov(i,"")}catch(P){Oi(t,t.return,P)}}if(n&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,u=r!==null?r.memoizedProps:o,a=t.type,p=t.updateQueue;if(t.updateQueue=null,p!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&vV(i,o),EN(a,u);var g=EN(a,o);for(u=0;u<p.length;u+=2){var v=p[u],w=p[u+1];v==="style"?TV(i,w):v==="dangerouslySetInnerHTML"?wV(i,w):v==="children"?Ov(i,w):J4(i,v,w,g)}switch(a){case"input":bN(i,o);break;case"textarea":_V(i,o);break;case"select":var T=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var A=o.value;A!=null?kg(i,!!o.multiple,A,!1):T!==!!o.multiple&&(o.defaultValue!=null?kg(i,!!o.multiple,o.defaultValue,!0):kg(i,!!o.multiple,o.multiple?[]:"",!1))}i[qv]=o}catch(P){Oi(t,t.return,P)}}break;case 6:if(Ul(e,t),Oc(t),n&4){if(t.stateNode===null)throw Error(Vt(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(P){Oi(t,t.return,P)}}break;case 3:if(Ul(e,t),Oc(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$v(e.containerInfo)}catch(P){Oi(t,t.return,P)}break;case 4:Ul(e,t),Oc(t);break;case 13:Ul(e,t),Oc(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(PI=Vi())),n&4&&b6(t);break;case 22:if(v=r!==null&&r.memoizedState!==null,t.mode&1?(ss=(g=ss)||v,Ul(e,t),ss=g):Ul(e,t),Oc(t),n&8192){if(g=t.memoizedState!==null,(t.stateNode.isHidden=g)&&!v&&t.mode&1)for(or=t,v=t.child;v!==null;){for(w=or=v;or!==null;){switch(T=or,A=T.child,T.tag){case 0:case 11:case 14:case 15:uv(4,T,T.return);break;case 1:dg(T,T.return);var I=T.stateNode;if(typeof I.componentWillUnmount=="function"){n=T,r=T.return;try{e=n,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(P){Oi(n,r,P)}}break;case 5:dg(T,T.return);break;case 22:if(T.memoizedState!==null){k6(w);continue}}A!==null?(A.return=T,or=A):k6(w)}v=v.sibling}e:for(v=null,w=t;;){if(w.tag===5){if(v===null){v=w;try{i=w.stateNode,g?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=w.stateNode,p=w.memoizedProps.style,u=p!=null&&p.hasOwnProperty("display")?p.display:null,a.style.display=kV("display",u))}catch(P){Oi(t,t.return,P)}}}else if(w.tag===6){if(v===null)try{w.stateNode.nodeValue=g?"":w.memoizedProps}catch(P){Oi(t,t.return,P)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===t)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===t)break e;for(;w.sibling===null;){if(w.return===null||w.return===t)break e;v===w&&(v=null),w=w.return}v===w&&(v=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:Ul(e,t),Oc(t),n&4&&b6(t);break;case 21:break;default:Ul(e,t),Oc(t)}}function Oc(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Z7(r)){var n=r;break e}r=r.return}throw Error(Vt(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ov(i,""),n.flags&=-33);var o=_6(t);rC(t,o,i);break;case 3:case 4:var u=n.stateNode.containerInfo,a=_6(t);tC(t,a,u);break;default:throw Error(Vt(161))}}catch(p){Oi(t,t.return,p)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Ere(t,e,r){or=t,J7(t)}function J7(t,e,r){for(var n=(t.mode&1)!==0;or!==null;){var i=or,o=i.child;if(i.tag===22&&n){var u=i.memoizedState!==null||rw;if(!u){var a=i.alternate,p=a!==null&&a.memoizedState!==null||ss;a=rw;var g=ss;if(rw=u,(ss=p)&&!g)for(or=i;or!==null;)u=or,p=u.child,u.tag===22&&u.memoizedState!==null?T6(i):p!==null?(p.return=u,or=p):T6(i);for(;o!==null;)or=o,J7(o),o=o.sibling;or=i,rw=a,ss=g}w6(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,or=o):w6(t)}}function w6(t){for(;or!==null;){var e=or;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ss||ST(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!ss)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Kl(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&s6(e,o,n);break;case 3:var u=e.updateQueue;if(u!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}s6(e,u,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var p=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&r.focus();break;case"img":p.src&&(r.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var g=e.alternate;if(g!==null){var v=g.memoizedState;if(v!==null){var w=v.dehydrated;w!==null&&$v(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Vt(163))}ss||e.flags&512&&eC(e)}catch(T){Oi(e,e.return,T)}}if(e===t){or=null;break}if(r=e.sibling,r!==null){r.return=e.return,or=r;break}or=e.return}}function k6(t){for(;or!==null;){var e=or;if(e===t){or=null;break}var r=e.sibling;if(r!==null){r.return=e.return,or=r;break}or=e.return}}function T6(t){for(;or!==null;){var e=or;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{ST(4,e)}catch(p){Oi(e,r,p)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(p){Oi(e,i,p)}}var o=e.return;try{eC(e)}catch(p){Oi(e,o,p)}break;case 5:var u=e.return;try{eC(e)}catch(p){Oi(e,u,p)}}}catch(p){Oi(e,e.return,p)}if(e===t){or=null;break}var a=e.sibling;if(a!==null){a.return=e.return,or=a;break}or=e.return}}var jre=Math.ceil,M2=_d.ReactCurrentDispatcher,NI=_d.ReactCurrentOwner,cl=_d.ReactCurrentBatchConfig,dn=0,Na=null,ta=null,Ba=0,bo=0,hg=af(0),fa=0,Xv=null,Ip=0,ET=0,CI=0,dv=null,Hs=null,PI=0,Vg=1/0,Bu=null,D2=!1,nC=null,Ch=null,nw=!1,yh=null,O2=0,hv=0,iC=null,Ww=-1,Hw=0;function Cs(){return dn&6?Vi():Ww!==-1?Ww:Ww=Vi()}function Ph(t){return t.mode&1?dn&2&&Ba!==0?Ba&-Ba:ure.transition!==null?(Hw===0&&(Hw=RV()),Hw):(t=Dn,t!==0||(t=window.event,t=t===void 0?16:UV(t.type)),t):1}function ic(t,e,r,n){if(50<hv)throw hv=0,iC=null,Error(Vt(185));Q_(t,r,n),(!(dn&2)||t!==Na)&&(t===Na&&(!(dn&2)&&(ET|=r),fa===4&&ph(t,Ba)),to(t,n),r===1&&dn===0&&!(e.mode&1)&&(Vg=Vi()+500,wT&&sf()))}function to(t,e){var r=t.callbackNode;ute(t,e);var n=x2(t,t===Na?Ba:0);if(n===0)r!==null&&MR(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&MR(r),e===1)t.tag===0?cre(S6.bind(null,t)):l7(S6.bind(null,t)),are(function(){!(dn&6)&&sf()}),r=null;else{switch(LV(n)){case 1:r=nI;break;case 4:r=DV;break;case 16:r=y2;break;case 536870912:r=OV;break;default:r=y2}r=sU(r,Q7.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Q7(t,e){if(Ww=-1,Hw=0,dn&6)throw Error(Vt(327));var r=t.callbackNode;if(Ag()&&t.callbackNode!==r)return null;var n=x2(t,t===Na?Ba:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=R2(t,n);else{e=n;var i=dn;dn|=2;var o=tU();(Na!==t||Ba!==e)&&(Bu=null,Vg=Vi()+500,_p(t,e));do try{Cre();break}catch(a){eU(t,a)}while(1);gI(),M2.current=o,dn=i,ta!==null?e=0:(Na=null,Ba=0,e=fa)}if(e!==0){if(e===2&&(i=PN(t),i!==0&&(n=i,e=aC(t,i))),e===1)throw r=Xv,_p(t,0),ph(t,n),to(t,Vi()),r;if(e===6)ph(t,n);else{if(i=t.current.alternate,!(n&30)&&!Are(i)&&(e=R2(t,n),e===2&&(o=PN(t),o!==0&&(n=o,e=aC(t,o))),e===1))throw r=Xv,_p(t,0),ph(t,n),to(t,Vi()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Vt(345));case 2:rp(t,Hs,Bu);break;case 3:if(ph(t,n),(n&130023424)===n&&(e=PI+500-Vi(),10<e)){if(x2(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Cs(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=$N(rp.bind(null,t,Hs,Bu),e);break}rp(t,Hs,Bu);break;case 4:if(ph(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var u=31-nc(n);o=1<<u,u=e[u],u>i&&(i=u),n&=~o}if(n=i,n=Vi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*jre(n/1960))-n,10<n){t.timeoutHandle=$N(rp.bind(null,t,Hs,Bu),n);break}rp(t,Hs,Bu);break;case 5:rp(t,Hs,Bu);break;default:throw Error(Vt(329))}}}return to(t,Vi()),t.callbackNode===r?Q7.bind(null,t):null}function aC(t,e){var r=dv;return t.current.memoizedState.isDehydrated&&(_p(t,e).flags|=256),t=R2(t,e),t!==2&&(e=Hs,Hs=r,e!==null&&sC(e)),t}function sC(t){Hs===null?Hs=t:Hs.push.apply(Hs,t)}function Are(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!oc(o(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ph(t,e){for(e&=~CI,e&=~ET,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-nc(e),n=1<<r;t[r]=-1,e&=~n}}function S6(t){if(dn&6)throw Error(Vt(327));Ag();var e=x2(t,0);if(!(e&1))return to(t,Vi()),null;var r=R2(t,e);if(t.tag!==0&&r===2){var n=PN(t);n!==0&&(e=n,r=aC(t,n))}if(r===1)throw r=Xv,_p(t,0),ph(t,e),to(t,Vi()),r;if(r===6)throw Error(Vt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,rp(t,Hs,Bu),to(t,Vi()),null}function II(t,e){var r=dn;dn|=1;try{return t(e)}finally{dn=r,dn===0&&(Vg=Vi()+500,wT&&sf())}}function Mp(t){yh!==null&&yh.tag===0&&!(dn&6)&&Ag();var e=dn;dn|=1;var r=cl.transition,n=Dn;try{if(cl.transition=null,Dn=1,t)return t()}finally{Dn=n,cl.transition=r,dn=e,!(dn&6)&&sf()}}function MI(){bo=hg.current,si(hg)}function _p(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,ire(r)),ta!==null)for(r=ta.return;r!==null;){var n=r;switch(fI(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&k2();break;case 3:Fg(),si(Qs),si(hs),wI();break;case 5:bI(n);break;case 4:Fg();break;case 13:si(Si);break;case 19:si(Si);break;case 10:yI(n.type._context);break;case 22:case 23:MI()}r=r.return}if(Na=t,ta=t=Ih(t.current,null),Ba=bo=e,fa=0,Xv=null,CI=ET=Ip=0,Hs=dv=null,up!==null){for(e=0;e<up.length;e++)if(r=up[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var u=o.next;o.next=i,n.next=u}r.pending=n}up=null}return t}function eU(t,e){do{var r=ta;try{if(gI(),Uw.current=I2,P2){for(var n=Ai.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}P2=!1}if(Pp=0,ja=ha=Ai=null,cv=!1,Hv=0,NI.current=null,r===null||r.return===null){fa=1,Xv=e,ta=null;break}e:{var o=t,u=r.return,a=r,p=e;if(e=Ba,a.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var g=p,v=a,w=v.tag;if(!(v.mode&1)&&(w===0||w===11||w===15)){var T=v.alternate;T?(v.updateQueue=T.updateQueue,v.memoizedState=T.memoizedState,v.lanes=T.lanes):(v.updateQueue=null,v.memoizedState=null)}var A=h6(u);if(A!==null){A.flags&=-257,f6(A,u,a,o,e),A.mode&1&&d6(o,g,e),e=A,p=g;var I=e.updateQueue;if(I===null){var P=new Set;P.add(p),e.updateQueue=P}else I.add(p);break e}else{if(!(e&1)){d6(o,g,e),DI();break e}p=Error(Vt(426))}}else if(di&&a.mode&1){var D=h6(u);if(D!==null){!(D.flags&65536)&&(D.flags|=256),f6(D,u,a,o,e),pI(Bg(p,a));break e}}o=p=Bg(p,a),fa!==4&&(fa=2),dv===null?dv=[o]:dv.push(o),o=u;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var L=L7(o,p,e);a6(o,L);break e;case 1:a=p;var O=o.type,$=o.stateNode;if(!(o.flags&128)&&(typeof O.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(Ch===null||!Ch.has($)))){o.flags|=65536,e&=-e,o.lanes|=e;var G=z7(o,a,e);a6(o,G);break e}}o=o.return}while(o!==null)}nU(r)}catch(B){e=B,ta===r&&r!==null&&(ta=r=r.return);continue}break}while(1)}function tU(){var t=M2.current;return M2.current=I2,t===null?I2:t}function DI(){(fa===0||fa===3||fa===2)&&(fa=4),Na===null||!(Ip&268435455)&&!(ET&268435455)||ph(Na,Ba)}function R2(t,e){var r=dn;dn|=2;var n=tU();(Na!==t||Ba!==e)&&(Bu=null,_p(t,e));do try{Nre();break}catch(i){eU(t,i)}while(1);if(gI(),dn=r,M2.current=n,ta!==null)throw Error(Vt(261));return Na=null,Ba=0,fa}function Nre(){for(;ta!==null;)rU(ta)}function Cre(){for(;ta!==null&&!tte();)rU(ta)}function rU(t){var e=aU(t.alternate,t,bo);t.memoizedProps=t.pendingProps,e===null?nU(t):ta=e,NI.current=null}function nU(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=kre(r,e),r!==null){r.flags&=32767,ta=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{fa=6,ta=null;return}}else if(r=wre(r,e,bo),r!==null){ta=r;return}if(e=e.sibling,e!==null){ta=e;return}ta=e=t}while(e!==null);fa===0&&(fa=5)}function rp(t,e,r){var n=Dn,i=cl.transition;try{cl.transition=null,Dn=1,Pre(t,e,r,n)}finally{cl.transition=i,Dn=n}return null}function Pre(t,e,r,n){do Ag();while(yh!==null);if(dn&6)throw Error(Vt(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Vt(177));t.callbackNode=null,t.callbackPriority=0;var o=r.lanes|r.childLanes;if(dte(t,o),t===Na&&(ta=Na=null,Ba=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||nw||(nw=!0,sU(y2,function(){return Ag(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=cl.transition,cl.transition=null;var u=Dn;Dn=1;var a=dn;dn|=4,NI.current=null,Sre(t,r),Y7(r,t),Yte(LN),v2=!!RN,LN=RN=null,t.current=r,Ere(r),rte(),dn=a,Dn=u,cl.transition=o}else t.current=r;if(nw&&(nw=!1,yh=t,O2=i),o=t.pendingLanes,o===0&&(Ch=null),ate(r.stateNode),to(t,Vi()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(D2)throw D2=!1,t=nC,nC=null,t;return O2&1&&t.tag!==0&&Ag(),o=t.pendingLanes,o&1?t===iC?hv++:(hv=0,iC=t):hv=0,sf(),null}function Ag(){if(yh!==null){var t=LV(O2),e=cl.transition,r=Dn;try{if(cl.transition=null,Dn=16>t?16:t,yh===null)var n=!1;else{if(t=yh,yh=null,O2=0,dn&6)throw Error(Vt(331));var i=dn;for(dn|=4,or=t.current;or!==null;){var o=or,u=o.child;if(or.flags&16){var a=o.deletions;if(a!==null){for(var p=0;p<a.length;p++){var g=a[p];for(or=g;or!==null;){var v=or;switch(v.tag){case 0:case 11:case 15:uv(8,v,o)}var w=v.child;if(w!==null)w.return=v,or=w;else for(;or!==null;){v=or;var T=v.sibling,A=v.return;if(K7(v),v===g){or=null;break}if(T!==null){T.return=A,or=T;break}or=A}}}var I=o.alternate;if(I!==null){var P=I.child;if(P!==null){I.child=null;do{var D=P.sibling;P.sibling=null,P=D}while(P!==null)}}or=o}}if(o.subtreeFlags&2064&&u!==null)u.return=o,or=u;else e:for(;or!==null;){if(o=or,o.flags&2048)switch(o.tag){case 0:case 11:case 15:uv(9,o,o.return)}var L=o.sibling;if(L!==null){L.return=o.return,or=L;break e}or=o.return}}var O=t.current;for(or=O;or!==null;){u=or;var $=u.child;if(u.subtreeFlags&2064&&$!==null)$.return=u,or=$;else e:for(u=O;or!==null;){if(a=or,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ST(9,a)}}catch(B){Oi(a,a.return,B)}if(a===u){or=null;break e}var G=a.sibling;if(G!==null){G.return=a.return,or=G;break e}or=a.return}}if(dn=i,sf(),Uc&&typeof Uc.onPostCommitFiberRoot=="function")try{Uc.onPostCommitFiberRoot(yT,t)}catch{}n=!0}return n}finally{Dn=r,cl.transition=e}}return!1}function E6(t,e,r){e=Bg(r,e),e=L7(t,e,1),t=Nh(t,e,1),e=Cs(),t!==null&&(Q_(t,1,e),to(t,e))}function Oi(t,e,r){if(t.tag===3)E6(t,t,r);else for(;e!==null;){if(e.tag===3){E6(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ch===null||!Ch.has(n))){t=Bg(r,t),t=z7(e,t,1),e=Nh(e,t,1),t=Cs(),e!==null&&(Q_(e,1,t),to(e,t));break}}e=e.return}}function Ire(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Cs(),t.pingedLanes|=t.suspendedLanes&r,Na===t&&(Ba&r)===r&&(fa===4||fa===3&&(Ba&130023424)===Ba&&500>Vi()-PI?_p(t,0):CI|=r),to(t,e)}function iU(t,e){e===0&&(t.mode&1?(e=H1,H1<<=1,!(H1&130023424)&&(H1=4194304)):e=1);var r=Cs();t=id(t,e),t!==null&&(Q_(t,e,r),to(t,r))}function Mre(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),iU(t,r)}function Dre(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Vt(314))}n!==null&&n.delete(e),iU(t,r)}var aU;aU=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qs.current)Zs=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Zs=!1,bre(t,e,r);Zs=!!(t.flags&131072)}else Zs=!1,di&&e.flags&1048576&&c7(e,E2,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Gw(t,e),t=e.pendingProps;var i=Lg(e,hs.current);jg(e,r),i=TI(null,e,n,t,i,r);var o=SI();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,eo(n)?(o=!0,T2(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,vI(e),i.updater=TT,e.stateNode=i,i._reactInternals=e,WN(e,n,t,r),e=ZN(null,e,n,!0,o,r)):(e.tag=0,di&&o&&hI(e),Ts(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Gw(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=Rre(n),t=Kl(n,t),i){case 0:e=KN(null,e,n,t,r);break e;case 1:e=g6(null,e,n,t,r);break e;case 11:e=p6(null,e,n,t,r);break e;case 14:e=m6(null,e,n,Kl(n.type,t),r);break e}throw Error(Vt(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Kl(n,i),KN(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Kl(n,i),g6(t,e,n,i,r);case 3:e:{if(V7(e),t===null)throw Error(Vt(387));n=e.pendingProps,o=e.memoizedState,i=o.element,m7(t,e),N2(e,n,null,r);var u=e.memoizedState;if(n=u.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Bg(Error(Vt(423)),e),e=y6(t,e,n,r,i);break e}else if(n!==i){i=Bg(Error(Vt(424)),e),e=y6(t,e,n,r,i);break e}else for(To=Ah(e.stateNode.containerInfo.firstChild),Eo=e,di=!0,Ql=null,r=f7(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(zg(),n===i){e=ad(t,e,r);break e}Ts(t,e,n,r)}e=e.child}return e;case 5:return g7(e),t===null&&UN(e),n=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,u=i.children,zN(n,i)?u=null:o!==null&&zN(n,o)&&(e.flags|=32),B7(t,e),Ts(t,e,u,r),e.child;case 6:return t===null&&UN(e),null;case 13:return U7(t,e,r);case 4:return _I(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=$g(e,null,n,r):Ts(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Kl(n,i),p6(t,e,n,i,r);case 7:return Ts(t,e,e.pendingProps,r),e.child;case 8:return Ts(t,e,e.pendingProps.children,r),e.child;case 12:return Ts(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,o=e.memoizedProps,u=i.value,Zn(j2,n._currentValue),n._currentValue=u,o!==null)if(oc(o.value,u)){if(o.children===i.children&&!Qs.current){e=ad(t,e,r);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){u=o.child;for(var p=a.firstContext;p!==null;){if(p.context===n){if(o.tag===1){p=Yu(-1,r&-r),p.tag=2;var g=o.updateQueue;if(g!==null){g=g.shared;var v=g.pending;v===null?p.next=p:(p.next=v.next,v.next=p),g.pending=p}}o.lanes|=r,p=o.alternate,p!==null&&(p.lanes|=r),qN(o.return,r,e),a.lanes|=r;break}p=p.next}}else if(o.tag===10)u=o.type===e.type?null:o.child;else if(o.tag===18){if(u=o.return,u===null)throw Error(Vt(341));u.lanes|=r,a=u.alternate,a!==null&&(a.lanes|=r),qN(u,r,e),u=o.sibling}else u=o.child;if(u!==null)u.return=o;else for(u=o;u!==null;){if(u===e){u=null;break}if(o=u.sibling,o!==null){o.return=u.return,u=o;break}u=u.return}o=u}Ts(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,jg(e,r),i=pl(i),n=n(i),e.flags|=1,Ts(t,e,n,r),e.child;case 14:return n=e.type,i=Kl(n,e.pendingProps),i=Kl(n.type,i),m6(t,e,n,i,r);case 15:return $7(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Kl(n,i),Gw(t,e),e.tag=1,eo(n)?(t=!0,T2(e)):t=!1,jg(e,r),R7(e,n,i),WN(e,n,i,r),ZN(null,e,n,!0,t,r);case 19:return q7(t,e,r);case 22:return F7(t,e,r)}throw Error(Vt(156,e.tag))};function sU(t,e){return MV(t,e)}function Ore(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ol(t,e,r,n){return new Ore(t,e,r,n)}function OI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Rre(t){if(typeof t=="function")return OI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===eI)return 11;if(t===tI)return 14}return 2}function Ih(t,e){var r=t.alternate;return r===null?(r=ol(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Kw(t,e,r,n,i,o){var u=2;if(n=t,typeof t=="function")OI(t)&&(u=1);else if(typeof t=="string")u=5;else e:switch(t){case rg:return bp(r.children,i,o,e);case Q4:u=8,i|=8;break;case gN:return t=ol(12,r,e,i|2),t.elementType=gN,t.lanes=o,t;case yN:return t=ol(13,r,e,i),t.elementType=yN,t.lanes=o,t;case xN:return t=ol(19,r,e,i),t.elementType=xN,t.lanes=o,t;case gV:return jT(r,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pV:u=10;break e;case mV:u=9;break e;case eI:u=11;break e;case tI:u=14;break e;case ch:u=16,n=null;break e}throw Error(Vt(130,t==null?t:typeof t,""))}return e=ol(u,r,e,i),e.elementType=t,e.type=n,e.lanes=o,e}function bp(t,e,r,n){return t=ol(7,t,n,e),t.lanes=r,t}function jT(t,e,r,n){return t=ol(22,t,n,e),t.elementType=gV,t.lanes=r,t.stateNode={isHidden:!1},t}function cA(t,e,r){return t=ol(6,t,null,e),t.lanes=r,t}function uA(t,e,r){return e=ol(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Lre(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qj(0),this.expirationTimes=qj(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qj(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function RI(t,e,r,n,i,o,u,a,p){return t=new Lre(t,e,r,a,p),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ol(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},vI(o),t}function zre(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:tg,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function oU(t){if(!t)return Vh;t=t._reactInternals;e:{if(Up(t)!==t||t.tag!==1)throw Error(Vt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(eo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Vt(171))}if(t.tag===1){var r=t.type;if(eo(r))return o7(t,r,e)}return e}function lU(t,e,r,n,i,o,u,a,p){return t=RI(r,n,!0,t,i,o,u,a,p),t.context=oU(null),r=t.current,n=Cs(),i=Ph(r),o=Yu(n,i),o.callback=e??null,Nh(r,o,i),t.current.lanes=i,Q_(t,i,n),to(t,n),t}function AT(t,e,r,n){var i=e.current,o=Cs(),u=Ph(i);return r=oU(r),e.context===null?e.context=r:e.pendingContext=r,e=Yu(o,u),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Nh(i,e,u),t!==null&&(ic(t,i,u,o),Vw(t,i,u)),u}function L2(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function j6(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function LI(t,e){j6(t,e),(t=t.alternate)&&j6(t,e)}function $re(){return null}var cU=typeof reportError=="function"?reportError:function(t){console.error(t)};function zI(t){this._internalRoot=t}NT.prototype.render=zI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Vt(409));AT(t,e,null,null)};NT.prototype.unmount=zI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Mp(function(){AT(null,t,null,null)}),e[nd]=null}};function NT(t){this._internalRoot=t}NT.prototype.unstable_scheduleHydration=function(t){if(t){var e=FV();t={blockedOn:null,target:t,priority:e};for(var r=0;r<fh.length&&e!==0&&e<fh[r].priority;r++);fh.splice(r,0,t),r===0&&VV(t)}};function $I(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function CT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function A6(){}function Fre(t,e,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var g=L2(u);o.call(g)}}var u=lU(e,n,t,0,null,!1,!1,"",A6);return t._reactRootContainer=u,t[nd]=u.current,Vv(t.nodeType===8?t.parentNode:t),Mp(),u}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var g=L2(p);a.call(g)}}var p=RI(t,0,!1,null,null,!1,!1,"",A6);return t._reactRootContainer=p,t[nd]=p.current,Vv(t.nodeType===8?t.parentNode:t),Mp(function(){AT(e,p,r,n)}),p}function PT(t,e,r,n,i){var o=r._reactRootContainer;if(o){var u=o;if(typeof i=="function"){var a=i;i=function(){var p=L2(u);a.call(p)}}AT(e,u,t,i)}else u=Fre(r,e,t,i,n);return L2(u)}zV=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Vx(e.pendingLanes);r!==0&&(iI(e,r|1),to(e,Vi()),!(dn&6)&&(Vg=Vi()+500,sf()))}break;case 13:Mp(function(){var n=id(t,1);if(n!==null){var i=Cs();ic(n,t,1,i)}}),LI(t,1)}};aI=function(t){if(t.tag===13){var e=id(t,134217728);if(e!==null){var r=Cs();ic(e,t,134217728,r)}LI(t,134217728)}};$V=function(t){if(t.tag===13){var e=Ph(t),r=id(t,e);if(r!==null){var n=Cs();ic(r,t,e,n)}LI(t,e)}};FV=function(){return Dn};BV=function(t,e){var r=Dn;try{return Dn=t,e()}finally{Dn=r}};AN=function(t,e,r){switch(e){case"input":if(bN(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=bT(n);if(!i)throw Error(Vt(90));xV(n),bN(n,i)}}}break;case"textarea":_V(t,r);break;case"select":e=r.value,e!=null&&kg(t,!!r.multiple,e,!1)}};jV=II;AV=Mp;var Bre={usingClientEntryPoint:!1,Events:[tb,sg,bT,SV,EV,II]},Tx={findFiberByHostInstance:cp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Vre={bundleType:Tx.bundleType,version:Tx.version,rendererPackageName:Tx.rendererPackageName,rendererConfig:Tx.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_d.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=PV(t),t===null?null:t.stateNode},findFiberByHostInstance:Tx.findFiberByHostInstance||$re,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iw.isDisabled&&iw.supportsFiber)try{yT=iw.inject(Vre),Uc=iw}catch{}}Io.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bre;Io.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$I(e))throw Error(Vt(200));return zre(t,e,null,r)};Io.createRoot=function(t,e){if(!$I(t))throw Error(Vt(299));var r=!1,n="",i=cU;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=RI(t,1,!1,null,null,r,!1,n,i),t[nd]=e.current,Vv(t.nodeType===8?t.parentNode:t),new zI(e)};Io.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Vt(188)):(t=Object.keys(t).join(","),Error(Vt(268,t)));return t=PV(e),t=t===null?null:t.stateNode,t};Io.flushSync=function(t){return Mp(t)};Io.hydrate=function(t,e,r){if(!CT(e))throw Error(Vt(200));return PT(null,t,e,!0,r)};Io.hydrateRoot=function(t,e,r){if(!$I(t))throw Error(Vt(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",u=cU;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(u=r.onRecoverableError)),e=lU(e,null,t,1,r??null,i,!1,o,u),t[nd]=e.current,Vv(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new NT(e)};Io.render=function(t,e,r){if(!CT(e))throw Error(Vt(200));return PT(null,t,e,!1,r)};Io.unmountComponentAtNode=function(t){if(!CT(t))throw Error(Vt(40));return t._reactRootContainer?(Mp(function(){PT(null,null,t,!1,function(){t._reactRootContainer=null,t[nd]=null})}),!0):!1};Io.unstable_batchedUpdates=II;Io.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!CT(r))throw Error(Vt(200));if(t==null||t._reactInternals===void 0)throw Error(Vt(38));return PT(t,e,r,!1,n)};Io.version="18.3.1-next-f1338f8080-20240426";function uU(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uU)}catch(t){console.error(t)}}uU(),uV.exports=Io;var Ure=uV.exports,N6=Ure;pN.createRoot=N6.createRoot,pN.hydrateRoot=N6.hydrateRoot;const aw={theme:"dark",language:"fr",notifications:{enabled:!0,sound:!0,desktop:!0,email:!1,severity:["medium","high","critical"]},dashboard:{autoRefresh:!0,refreshInterval:300,defaultView:"strategic",compactMode:!1,showMetrics:!0},map:{defaultZoom:6,defaultCenter:[-15.3,23.2],basemap:"streets",showLabels:!0,clusterMarkers:!0},data:{retentionPeriod:30,maxResults:1e3,autoExportEnabled:!1,exportFormat:"csv"},privacy:{anonymizeData:!1,shareAnalytics:!0,localStorageEnabled:!0},advanced:{debugMode:!1,performanceMode:!1,experimentalFeatures:!1,apiTimeout:3e4}},dU=Y.createContext(void 0);function FI(){const t=Y.useContext(dU);if(!t)throw new Error("useSettings must be used within a SettingsProvider");return t}const C6="sentinel_settings";function qre({children:t}){const[e,r]=Y.useState(aw),[n,i]=Y.useState(!0);Y.useEffect(()=>{try{const g=localStorage.getItem(C6);if(g){const v=JSON.parse(g);r({...aw,...v})}}catch(g){console.warn("Failed to load settings from localStorage:",g)}finally{i(!1)}},[]),Y.useEffect(()=>{if(!n)try{localStorage.setItem(C6,JSON.stringify(e))}catch(g){console.warn("Failed to save settings to localStorage:",g)}},[e,n]),Y.useEffect(()=>{const g=()=>{const v=document.documentElement;e.theme==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?v.classList.add("dark"):v.classList.remove("dark"):e.theme==="dark"?v.classList.add("dark"):v.classList.remove("dark")};if(g(),e.theme==="system"){const v=window.matchMedia("(prefers-color-scheme: dark)");return v.addEventListener("change",g),()=>v.removeEventListener("change",g)}},[e.theme]);const o=(g,v)=>{r(w=>({...w,[g]:{...w[g],...v}}))},u=()=>{r(aw)},a=()=>JSON.stringify(e,null,2),p=g=>{try{const v=JSON.parse(g);if(["theme","language","notifications","dashboard","map","data","privacy","advanced"].every(A=>A in v))return r({...aw,...v}),!0;throw new Error("Invalid settings structure")}catch(v){return console.error("Failed to import settings:",v),!1}};return l.jsx(dU.Provider,{value:{settings:e,updateSettings:o,resetSettings:u,exportSettings:a,importSettings:p,isLoading:n},children:t})}function hU(){const{settings:t,updateSettings:e}=FI();return{settings:t.dashboard,updateSettings:r=>e("dashboard",r)}}const Gre="modulepreload",Wre=function(t){return"/"+t},P6={},IT=function(e,r,n){if(!r||r.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=Wre(o),o in P6)return;P6[o]=!0;const u=o.endsWith(".css"),a=u?'[rel="stylesheet"]':"";if(!!n)for(let v=i.length-1;v>=0;v--){const w=i[v];if(w.href===o&&(!u||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${a}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":Gre,u||(g.as="script",g.crossOrigin=""),g.href=o,document.head.appendChild(g),u)return new Promise((v,w)=>{g.addEventListener("load",v),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o})};var BI={};Object.defineProperty(BI,"__esModule",{value:!0});BI.parse=Qre;BI.serialize=ene;const Hre=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,Kre=/^[\u0021-\u003A\u003C-\u007E]*$/,Zre=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,Xre=/^[\u0020-\u003A\u003D-\u007E]*$/,Yre=Object.prototype.toString,Jre=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function Qre(t,e){const r=new Jre,n=t.length;if(n<2)return r;const i=(e==null?void 0:e.decode)||tne;let o=0;do{const u=t.indexOf("=",o);if(u===-1)break;const a=t.indexOf(";",o),p=a===-1?n:a;if(u>p){o=t.lastIndexOf(";",u-1)+1;continue}const g=I6(t,o,u),v=M6(t,u,g),w=t.slice(g,v);if(r[w]===void 0){let T=I6(t,u+1,p),A=M6(t,p,T);const I=i(t.slice(T,A));r[w]=I}o=p+1}while(o<n);return r}function I6(t,e,r){do{const n=t.charCodeAt(e);if(n!==32&&n!==9)return e}while(++e<r);return r}function M6(t,e,r){for(;e>r;){const n=t.charCodeAt(--e);if(n!==32&&n!==9)return e+1}return r}function ene(t,e,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!Hre.test(t))throw new TypeError(`argument name is invalid: ${t}`);const i=n(e);if(!Kre.test(i))throw new TypeError(`argument val is invalid: ${e}`);let o=t+"="+i;if(!r)return o;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);o+="; Max-Age="+r.maxAge}if(r.domain){if(!Zre.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);o+="; Domain="+r.domain}if(r.path){if(!Xre.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);o+="; Path="+r.path}if(r.expires){if(!rne(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);o+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(o+="; HttpOnly"),r.secure&&(o+="; Secure"),r.partitioned&&(o+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"none":o+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return o}function tne(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function rne(t){return Yre.call(t)==="[object Date]"}var D6="popstate";function nne(t={}){function e(n,i){let{pathname:o,search:u,hash:a}=n.location;return oC("",{pathname:o,search:u,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Yv(i)}return ane(e,r,null,t)}function mi(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function lc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ine(){return Math.random().toString(36).substring(2,10)}function O6(t,e){return{usr:t.state,key:t.key,idx:e}}function oC(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?$0(e):e,state:r,key:e&&e.key||n||ine()}}function Yv({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function $0(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function ane(t,e,r,n={}){let{window:i=document.defaultView,v5Compat:o=!1}=n,u=i.history,a="POP",p=null,g=v();g==null&&(g=0,u.replaceState({...u.state,idx:g},""));function v(){return(u.state||{idx:null}).idx}function w(){a="POP";let D=v(),L=D==null?null:D-g;g=D,p&&p({action:a,location:P.location,delta:L})}function T(D,L){a="PUSH";let O=oC(P.location,D,L);r&&r(O,D),g=v()+1;let $=O6(O,g),G=P.createHref(O);try{u.pushState($,"",G)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;i.location.assign(G)}o&&p&&p({action:a,location:P.location,delta:1})}function A(D,L){a="REPLACE";let O=oC(P.location,D,L);r&&r(O,D),g=v();let $=O6(O,g),G=P.createHref(O);u.replaceState($,"",G),o&&p&&p({action:a,location:P.location,delta:0})}function I(D){return sne(D)}let P={get action(){return a},get location(){return t(i,u)},listen(D){if(p)throw new Error("A history only accepts one active listener");return i.addEventListener(D6,w),p=D,()=>{i.removeEventListener(D6,w),p=null}},createHref(D){return e(i,D)},createURL:I,encodeLocation(D){let L=I(D);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:T,replace:A,go(D){return u.go(D)}};return P}function sne(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),mi(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:Yv(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function fU(t,e,r="/"){return one(t,e,r,!1)}function one(t,e,r,n){let i=typeof e=="string"?$0(e):e,o=sd(i.pathname||"/",r);if(o==null)return null;let u=pU(t);lne(u);let a=null;for(let p=0;a==null&&p<u.length;++p){let g=vne(o);a=yne(u[p],g,n)}return a}function pU(t,e=[],r=[],n=""){let i=(o,u,a)=>{let p={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};p.relativePath.startsWith("/")&&(mi(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length));let g=Ju([n,p.relativePath]),v=r.concat(p);o.children&&o.children.length>0&&(mi(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),pU(o.children,e,v,g)),!(o.path==null&&!o.index)&&e.push({path:g,score:mne(g,o.index),routesMeta:v})};return t.forEach((o,u)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))i(o,u);else for(let p of mU(o.path))i(o,u,p)}),e}function mU(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let u=mU(n.join("/")),a=[];return a.push(...u.map(p=>p===""?o:[o,p].join("/"))),i&&a.push(...u),a.map(p=>t.startsWith("/")&&p===""?"/":p)}function lne(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:gne(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var cne=/^:[\w-]+$/,une=3,dne=2,hne=1,fne=10,pne=-2,R6=t=>t==="*";function mne(t,e){let r=t.split("/"),n=r.length;return r.some(R6)&&(n+=pne),e&&(n+=dne),r.filter(i=>!R6(i)).reduce((i,o)=>i+(cne.test(o)?une:o===""?hne:fne),n)}function gne(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function yne(t,e,r=!1){let{routesMeta:n}=t,i={},o="/",u=[];for(let a=0;a<n.length;++a){let p=n[a],g=a===n.length-1,v=o==="/"?e:e.slice(o.length)||"/",w=z2({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},v),T=p.route;if(!w&&g&&r&&!n[n.length-1].route.index&&(w=z2({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},v)),!w)return null;Object.assign(i,w.params),u.push({params:i,pathname:Ju([o,w.pathname]),pathnameBase:kne(Ju([o,w.pathnameBase])),route:T}),w.pathnameBase!=="/"&&(o=Ju([o,w.pathnameBase]))}return u}function z2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=xne(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let o=i[0],u=o.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:n.reduce((g,{paramName:v,isOptional:w},T)=>{if(v==="*"){let I=a[T]||"";u=o.slice(0,o.length-I.length).replace(/(.)\/+$/,"$1")}const A=a[T];return w&&!A?g[v]=void 0:g[v]=(A||"").replace(/%2F/g,"/"),g},{}),pathname:o,pathnameBase:u,pattern:t}}function xne(t,e=!1,r=!0){lc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,a,p)=>(n.push({paramName:a,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function vne(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return lc(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function sd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function _ne(t,e="/"){let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?$0(t):t;return{pathname:r?r.startsWith("/")?r:bne(r,e):e,search:Tne(n),hash:Sne(i)}}function bne(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function dA(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wne(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function VI(t){let e=wne(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function UI(t,e,r,n=!1){let i;typeof t=="string"?i=$0(t):(i={...t},mi(!i.pathname||!i.pathname.includes("?"),dA("?","pathname","search",i)),mi(!i.pathname||!i.pathname.includes("#"),dA("#","pathname","hash",i)),mi(!i.search||!i.search.includes("#"),dA("#","search","hash",i)));let o=t===""||i.pathname==="",u=o?"/":i.pathname,a;if(u==null)a=r;else{let w=e.length-1;if(!n&&u.startsWith("..")){let T=u.split("/");for(;T[0]==="..";)T.shift(),w-=1;i.pathname=T.join("/")}a=w>=0?e[w]:"/"}let p=_ne(i,a),g=u&&u!=="/"&&u.endsWith("/"),v=(o||u===".")&&r.endsWith("/");return!p.pathname.endsWith("/")&&(g||v)&&(p.pathname+="/"),p}var Ju=t=>t.join("/").replace(/\/\/+/g,"/"),kne=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Tne=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Sne=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Ene(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var gU=["POST","PUT","PATCH","DELETE"];new Set(gU);var jne=["GET",...gU];new Set(jne);var F0=Y.createContext(null);F0.displayName="DataRouter";var MT=Y.createContext(null);MT.displayName="DataRouterState";var yU=Y.createContext({isTransitioning:!1});yU.displayName="ViewTransition";var Ane=Y.createContext(new Map);Ane.displayName="Fetchers";var Nne=Y.createContext(null);Nne.displayName="Await";var dc=Y.createContext(null);dc.displayName="Navigation";var nb=Y.createContext(null);nb.displayName="Location";var uu=Y.createContext({outlet:null,matches:[],isDataRoute:!1});uu.displayName="Route";var qI=Y.createContext(null);qI.displayName="RouteError";function Cne(t,{relative:e}={}){mi(B0(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=Y.useContext(dc),{hash:i,pathname:o,search:u}=ib(t,{relative:e}),a=o;return r!=="/"&&(a=o==="/"?r:Ju([r,o])),n.createHref({pathname:a,search:u,hash:i})}function B0(){return Y.useContext(nb)!=null}function of(){return mi(B0(),"useLocation() may be used only in the context of a <Router> component."),Y.useContext(nb).location}var xU="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function vU(t){Y.useContext(dc).static||Y.useLayoutEffect(t)}function _U(){let{isDataRoute:t}=Y.useContext(uu);return t?Une():Pne()}function Pne(){mi(B0(),"useNavigate() may be used only in the context of a <Router> component.");let t=Y.useContext(F0),{basename:e,navigator:r}=Y.useContext(dc),{matches:n}=Y.useContext(uu),{pathname:i}=of(),o=JSON.stringify(VI(n)),u=Y.useRef(!1);return vU(()=>{u.current=!0}),Y.useCallback((p,g={})=>{if(lc(u.current,xU),!u.current)return;if(typeof p=="number"){r.go(p);return}let v=UI(p,JSON.parse(o),i,g.relative==="path");t==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:Ju([e,v.pathname])),(g.replace?r.replace:r.push)(v,g.state,g)},[e,r,o,i,t])}Y.createContext(null);function ib(t,{relative:e}={}){let{matches:r}=Y.useContext(uu),{pathname:n}=of(),i=JSON.stringify(VI(r));return Y.useMemo(()=>UI(t,JSON.parse(i),n,e==="path"),[t,i,n,e])}function Ine(t,e){return bU(t,e)}function bU(t,e,r,n){var L;mi(B0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=Y.useContext(dc),{matches:o}=Y.useContext(uu),u=o[o.length-1],a=u?u.params:{},p=u?u.pathname:"/",g=u?u.pathnameBase:"/",v=u&&u.route;{let O=v&&v.path||"";wU(p,!v||O.endsWith("*")||O.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${O}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${O}"> to <Route path="${O==="/"?"*":`${O}/*`}">.`)}let w=of(),T;if(e){let O=typeof e=="string"?$0(e):e;mi(g==="/"||((L=O.pathname)==null?void 0:L.startsWith(g)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${O.pathname}" was given in the \`location\` prop.`),T=O}else T=w;let A=T.pathname||"/",I=A;if(g!=="/"){let O=g.replace(/^\//,"").split("/");I="/"+A.replace(/^\//,"").split("/").slice(O.length).join("/")}let P=fU(t,{pathname:I});lc(v||P!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),lc(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let D=Lne(P&&P.map(O=>Object.assign({},O,{params:Object.assign({},a,O.params),pathname:Ju([g,i.encodeLocation?i.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?g:Ju([g,i.encodeLocation?i.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),o,r,n);return e&&D?Y.createElement(nb.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},D):D}function Mne(){let t=Vne(),e=Ene(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=Y.createElement(Y.Fragment,null,Y.createElement("p",null,"💿 Hey developer 👋"),Y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Y.createElement("code",{style:o},"ErrorBoundary")," or"," ",Y.createElement("code",{style:o},"errorElement")," prop on your route.")),Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},e),r?Y.createElement("pre",{style:i},r):null,u)}var Dne=Y.createElement(Mne,null),One=class extends Y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?Y.createElement(uu.Provider,{value:this.props.routeContext},Y.createElement(qI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Rne({routeContext:t,match:e,children:r}){let n=Y.useContext(F0);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),Y.createElement(uu.Provider,{value:t},r)}function Lne(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=r==null?void 0:r.errors;if(o!=null){let p=i.findIndex(g=>g.route.id&&(o==null?void 0:o[g.route.id])!==void 0);mi(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,p+1))}let u=!1,a=-1;if(r)for(let p=0;p<i.length;p++){let g=i[p];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(a=p),g.route.id){let{loaderData:v,errors:w}=r,T=g.route.loader&&!v.hasOwnProperty(g.route.id)&&(!w||w[g.route.id]===void 0);if(g.route.lazy||T){u=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((p,g,v)=>{let w,T=!1,A=null,I=null;r&&(w=o&&g.route.id?o[g.route.id]:void 0,A=g.route.errorElement||Dne,u&&(a<0&&v===0?(wU("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),T=!0,I=null):a===v&&(T=!0,I=g.route.hydrateFallbackElement||null)));let P=e.concat(i.slice(0,v+1)),D=()=>{let L;return w?L=A:T?L=I:g.route.Component?L=Y.createElement(g.route.Component,null):g.route.element?L=g.route.element:L=p,Y.createElement(Rne,{match:g,routeContext:{outlet:p,matches:P,isDataRoute:r!=null},children:L})};return r&&(g.route.ErrorBoundary||g.route.errorElement||v===0)?Y.createElement(One,{location:r.location,revalidation:r.revalidation,component:A,error:w,children:D(),routeContext:{outlet:null,matches:P,isDataRoute:!0}}):D()},null)}function GI(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zne(t){let e=Y.useContext(F0);return mi(e,GI(t)),e}function $ne(t){let e=Y.useContext(MT);return mi(e,GI(t)),e}function Fne(t){let e=Y.useContext(uu);return mi(e,GI(t)),e}function WI(t){let e=Fne(t),r=e.matches[e.matches.length-1];return mi(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function Bne(){return WI("useRouteId")}function Vne(){var n;let t=Y.useContext(qI),e=$ne("useRouteError"),r=WI("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function Une(){let{router:t}=zne("useNavigate"),e=WI("useNavigate"),r=Y.useRef(!1);return vU(()=>{r.current=!0}),Y.useCallback(async(i,o={})=>{lc(r.current,xU),r.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...o}))},[t,e])}var L6={};function wU(t,e,r){!e&&!L6[t]&&(L6[t]=!0,lc(!1,r))}Y.memo(qne);function qne({routes:t,future:e,state:r}){return bU(t,void 0,r,e)}function Gne({to:t,replace:e,state:r,relative:n}){mi(B0(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=Y.useContext(dc);lc(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=Y.useContext(uu),{pathname:u}=of(),a=_U(),p=UI(t,VI(o),u,n==="path"),g=JSON.stringify(p);return Y.useEffect(()=>{a(JSON.parse(g),{replace:e,state:r,relative:n})},[a,g,n,e,r]),null}function Zw(t){mi(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Wne({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:i,static:o=!1}){mi(!B0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),a=Y.useMemo(()=>({basename:u,navigator:i,static:o,future:{}}),[u,i,o]);typeof r=="string"&&(r=$0(r));let{pathname:p="/",search:g="",hash:v="",state:w=null,key:T="default"}=r,A=Y.useMemo(()=>{let I=sd(p,u);return I==null?null:{location:{pathname:I,search:g,hash:v,state:w,key:T},navigationType:n}},[u,p,g,v,w,T,n]);return lc(A!=null,`<Router basename="${u}"> is not able to match the URL "${p}${g}${v}" because it does not start with the basename, so the <Router> won't render anything.`),A==null?null:Y.createElement(dc.Provider,{value:a},Y.createElement(nb.Provider,{children:e,value:A}))}function Hne({children:t,location:e}){return Ine(lC(t),e)}function lC(t,e=[]){let r=[];return Y.Children.forEach(t,(n,i)=>{if(!Y.isValidElement(n))return;let o=[...e,i];if(n.type===Y.Fragment){r.push.apply(r,lC(n.props.children,o));return}mi(n.type===Zw,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),mi(!n.props.index||!n.props.children,"An index route cannot have child routes.");let u={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(u.children=lC(n.props.children,o)),r.push(u)}),r}var Xw="get",Yw="application/x-www-form-urlencoded";function DT(t){return t!=null&&typeof t.tagName=="string"}function Kne(t){return DT(t)&&t.tagName.toLowerCase()==="button"}function Zne(t){return DT(t)&&t.tagName.toLowerCase()==="form"}function Xne(t){return DT(t)&&t.tagName.toLowerCase()==="input"}function Yne(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Jne(t,e){return t.button===0&&(!e||e==="_self")&&!Yne(t)}var sw=null;function Qne(){if(sw===null)try{new FormData(document.createElement("form"),0),sw=!1}catch{sw=!0}return sw}var eie=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function hA(t){return t!=null&&!eie.has(t)?(lc(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Yw}"`),null):t}function tie(t,e){let r,n,i,o,u;if(Zne(t)){let a=t.getAttribute("action");n=a?sd(a,e):null,r=t.getAttribute("method")||Xw,i=hA(t.getAttribute("enctype"))||Yw,o=new FormData(t)}else if(Kne(t)||Xne(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=t.getAttribute("formaction")||a.getAttribute("action");if(n=p?sd(p,e):null,r=t.getAttribute("formmethod")||a.getAttribute("method")||Xw,i=hA(t.getAttribute("formenctype"))||hA(a.getAttribute("enctype"))||Yw,o=new FormData(a,t),!Qne()){let{name:g,type:v,value:w}=t;if(v==="image"){let T=g?`${g}.`:"";o.append(`${T}x`,"0"),o.append(`${T}y`,"0")}else g&&o.append(g,w)}}else{if(DT(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Xw,n=null,i=Yw,u=t}return o&&i==="text/plain"&&(u=o,o=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:o,body:u}}function HI(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function rie(t,e){if(t.id in e)return e[t.id];try{let r=await IT(()=>import(t.module),[]);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function nie(t){return t!=null&&typeof t.page=="string"}function iie(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function aie(t,e,r){let n=await Promise.all(t.map(async i=>{let o=e.routes[i.route.id];if(o){let u=await rie(o,r);return u.links?u.links():[]}return[]}));return cie(n.flat(1).filter(iie).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function z6(t,e,r,n,i,o){let u=(p,g)=>r[g]?p.route.id!==r[g].route.id:!0,a=(p,g)=>{var v;return r[g].pathname!==p.pathname||((v=r[g].route.path)==null?void 0:v.endsWith("*"))&&r[g].params["*"]!==p.params["*"]};return o==="assets"?e.filter((p,g)=>u(p,g)||a(p,g)):o==="data"?e.filter((p,g)=>{var w;let v=n.routes[p.route.id];if(!v||!v.hasLoader)return!1;if(u(p,g)||a(p,g))return!0;if(p.route.shouldRevalidate){let T=p.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((w=r[0])==null?void 0:w.params)||{},nextUrl:new URL(t,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof T=="boolean")return T}return!0}):[]}function sie(t,e,{includeHydrateFallback:r}={}){return oie(t.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let o=[i.module];return i.clientActionModule&&(o=o.concat(i.clientActionModule)),i.clientLoaderModule&&(o=o.concat(i.clientLoaderModule)),r&&i.hydrateFallbackModule&&(o=o.concat(i.hydrateFallbackModule)),i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function oie(t){return[...new Set(t)]}function lie(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function cie(t,e){let r=new Set,n=new Set(e);return t.reduce((i,o)=>{if(e&&!nie(o)&&o.as==="script"&&o.href&&n.has(o.href))return i;let a=JSON.stringify(lie(o));return r.has(a)||(r.add(a),i.push({key:a,link:o})),i},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var uie=new Set([100,101,204,205]);function die(t,e){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname="_root.data":e&&sd(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function kU(){let t=Y.useContext(F0);return HI(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function hie(){let t=Y.useContext(MT);return HI(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var KI=Y.createContext(void 0);KI.displayName="FrameworkContext";function TU(){let t=Y.useContext(KI);return HI(t,"You must render this element inside a <HydratedRouter> element"),t}function fie(t,e){let r=Y.useContext(KI),[n,i]=Y.useState(!1),[o,u]=Y.useState(!1),{onFocus:a,onBlur:p,onMouseEnter:g,onMouseLeave:v,onTouchStart:w}=e,T=Y.useRef(null);Y.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let P=L=>{L.forEach(O=>{u(O.isIntersecting)})},D=new IntersectionObserver(P,{threshold:.5});return T.current&&D.observe(T.current),()=>{D.disconnect()}}},[t]),Y.useEffect(()=>{if(n){let P=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(P)}}},[n]);let A=()=>{i(!0)},I=()=>{i(!1),u(!1)};return r?t!=="intent"?[o,T,{}]:[o,T,{onFocus:Sx(a,A),onBlur:Sx(p,I),onMouseEnter:Sx(g,A),onMouseLeave:Sx(v,I),onTouchStart:Sx(w,A)}]:[!1,T,{}]}function Sx(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function pie({page:t,...e}){let{router:r}=kU(),n=Y.useMemo(()=>fU(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?Y.createElement(gie,{page:t,matches:n,...e}):null}function mie(t){let{manifest:e,routeModules:r}=TU(),[n,i]=Y.useState([]);return Y.useEffect(()=>{let o=!1;return aie(t,e,r).then(u=>{o||i(u)}),()=>{o=!0}},[t,e,r]),n}function gie({page:t,matches:e,...r}){let n=of(),{manifest:i,routeModules:o}=TU(),{basename:u}=kU(),{loaderData:a,matches:p}=hie(),g=Y.useMemo(()=>z6(t,e,p,i,n,"data"),[t,e,p,i,n]),v=Y.useMemo(()=>z6(t,e,p,i,n,"assets"),[t,e,p,i,n]),w=Y.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let I=new Set,P=!1;if(e.forEach(L=>{var $;let O=i.routes[L.route.id];!O||!O.hasLoader||(!g.some(G=>G.route.id===L.route.id)&&L.route.id in a&&(($=o[L.route.id])!=null&&$.shouldRevalidate)||O.hasClientLoader?P=!0:I.add(L.route.id))}),I.size===0)return[];let D=die(t,u);return P&&I.size>0&&D.searchParams.set("_routes",e.filter(L=>I.has(L.route.id)).map(L=>L.route.id).join(",")),[D.pathname+D.search]},[u,a,n,i,g,e,t,o]),T=Y.useMemo(()=>sie(v,i),[v,i]),A=mie(v);return Y.createElement(Y.Fragment,null,w.map(I=>Y.createElement("link",{key:I,rel:"prefetch",as:"fetch",href:I,...r})),T.map(I=>Y.createElement("link",{key:I,rel:"modulepreload",href:I,...r})),A.map(({key:I,link:P})=>Y.createElement("link",{key:I,...P})))}function yie(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var SU=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{SU&&(window.__reactRouterVersion="7.6.3")}catch{}function xie({basename:t,children:e,window:r}){let n=Y.useRef();n.current==null&&(n.current=nne({window:r,v5Compat:!0}));let i=n.current,[o,u]=Y.useState({action:i.action,location:i.location}),a=Y.useCallback(p=>{Y.startTransition(()=>u(p))},[u]);return Y.useLayoutEffect(()=>i.listen(a),[i,a]),Y.createElement(Wne,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i})}var EU=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jU=Y.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:i,reloadDocument:o,replace:u,state:a,target:p,to:g,preventScrollReset:v,viewTransition:w,...T},A){let{basename:I}=Y.useContext(dc),P=typeof g=="string"&&EU.test(g),D,L=!1;if(typeof g=="string"&&P&&(D=g,SU))try{let V=new URL(window.location.href),se=g.startsWith("//")?new URL(V.protocol+g):new URL(g),K=sd(se.pathname,I);se.origin===V.origin&&K!=null?g=K+se.search+se.hash:L=!0}catch{lc(!1,`<Link to="${g}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let O=Cne(g,{relative:i}),[$,G,B]=fie(n,T),J=wie(g,{replace:u,state:a,target:p,preventScrollReset:v,relative:i,viewTransition:w});function W(V){e&&e(V),V.defaultPrevented||J(V)}let H=Y.createElement("a",{...T,...B,href:D||O,onClick:L||o?e:W,ref:yie(A,G),target:p,"data-discover":!P&&r==="render"?"true":void 0});return $&&!P?Y.createElement(Y.Fragment,null,H,Y.createElement(pie,{page:O})):H});jU.displayName="Link";var vie=Y.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:i=!1,style:o,to:u,viewTransition:a,children:p,...g},v){let w=ib(u,{relative:g.relative}),T=of(),A=Y.useContext(MT),{navigator:I,basename:P}=Y.useContext(dc),D=A!=null&&jie(w)&&a===!0,L=I.encodeLocation?I.encodeLocation(w).pathname:w.pathname,O=T.pathname,$=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;r||(O=O.toLowerCase(),$=$?$.toLowerCase():null,L=L.toLowerCase()),$&&P&&($=sd($,P)||$);const G=L!=="/"&&L.endsWith("/")?L.length-1:L.length;let B=O===L||!i&&O.startsWith(L)&&O.charAt(G)==="/",J=$!=null&&($===L||!i&&$.startsWith(L)&&$.charAt(L.length)==="/"),W={isActive:B,isPending:J,isTransitioning:D},H=B?e:void 0,V;typeof n=="function"?V=n(W):V=[n,B?"active":null,J?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let se=typeof o=="function"?o(W):o;return Y.createElement(jU,{...g,"aria-current":H,className:V,ref:v,style:se,to:u,viewTransition:a},typeof p=="function"?p(W):p)});vie.displayName="NavLink";var _ie=Y.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:i,state:o,method:u=Xw,action:a,onSubmit:p,relative:g,preventScrollReset:v,viewTransition:w,...T},A)=>{let I=Sie(),P=Eie(a,{relative:g}),D=u.toLowerCase()==="get"?"get":"post",L=typeof a=="string"&&EU.test(a),O=$=>{if(p&&p($),$.defaultPrevented)return;$.preventDefault();let G=$.nativeEvent.submitter,B=(G==null?void 0:G.getAttribute("formmethod"))||u;I(G||$.currentTarget,{fetcherKey:e,method:B,navigate:r,replace:i,state:o,relative:g,preventScrollReset:v,viewTransition:w})};return Y.createElement("form",{ref:A,method:D,action:P,onSubmit:n?p:O,...T,"data-discover":!L&&t==="render"?"true":void 0})});_ie.displayName="Form";function bie(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AU(t){let e=Y.useContext(F0);return mi(e,bie(t)),e}function wie(t,{target:e,replace:r,state:n,preventScrollReset:i,relative:o,viewTransition:u}={}){let a=_U(),p=of(),g=ib(t,{relative:o});return Y.useCallback(v=>{if(Jne(v,e)){v.preventDefault();let w=r!==void 0?r:Yv(p)===Yv(g);a(t,{replace:w,state:n,preventScrollReset:i,relative:o,viewTransition:u})}},[p,a,g,r,n,e,t,i,o,u])}var kie=0,Tie=()=>`__${String(++kie)}__`;function Sie(){let{router:t}=AU("useSubmit"),{basename:e}=Y.useContext(dc),r=Bne();return Y.useCallback(async(n,i={})=>{let{action:o,method:u,encType:a,formData:p,body:g}=tie(n,e);if(i.navigate===!1){let v=i.fetcherKey||Tie();await t.fetch(v,r,i.action||o,{preventScrollReset:i.preventScrollReset,formData:p,body:g,formMethod:i.method||u,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:p,body:g,formMethod:i.method||u,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,r])}function Eie(t,{relative:e}={}){let{basename:r}=Y.useContext(dc),n=Y.useContext(uu);mi(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),o={...ib(t||".",{relative:e})},u=of();if(t==null){o.search=u.search;let a=new URLSearchParams(o.search),p=a.getAll("index");if(p.some(v=>v==="")){a.delete("index"),p.filter(w=>w).forEach(w=>a.append("index",w));let v=a.toString();o.search=v?`?${v}`:""}}return(!t||t===".")&&i.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(o.pathname=o.pathname==="/"?r:Ju([r,o.pathname])),Yv(o)}function jie(t,e={}){let r=Y.useContext(yU);mi(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=AU("useViewTransitionState"),i=ib(t,{relative:e.relative});if(!r.isTransitioning)return!1;let o=sd(r.currentLocation.pathname,n)||r.currentLocation.pathname,u=sd(r.nextLocation.pathname,n)||r.nextLocation.pathname;return z2(i.pathname,u)!=null||z2(i.pathname,o)!=null}[...uie];/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aie=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),NU=(...t)=>t.filter((e,r,n)=>!!e&&n.indexOf(e)===r).join(" ");/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Nie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cie=Y.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:o,iconNode:u,...a},p)=>Y.createElement("svg",{ref:p,...Nie,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:NU("lucide",i),...a},[...u.map(([g,v])=>Y.createElement(g,v)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=(t,e)=>{const r=Y.forwardRef(({className:n,...i},o)=>Y.createElement(Cie,{ref:o,iconNode:e,className:NU(`lucide-${Aie(t)}`,n),...i}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=$t("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pie=$t("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CU=$t("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iie=$t("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $6=$t("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PU=$t("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mie=$t("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=$t("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=$t("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IU=$t("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fv=$t("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cc=$t("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=$t("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Die=$t("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oie=$t("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pv=$t("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rie=$t("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=$t("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lie=$t("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=$t("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=$t("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=$t("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zie=$t("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ie=$t("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=$t("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=$t("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MU=$t("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mv=$t("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ul=$t("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=$t("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=$t("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cC=$t("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fie=$t("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uh=$t("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bie=$t("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=$t("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ow=$t("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vie=$t("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nu=$t("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uie=$t("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=$t("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qie=$t("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gie=$t("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wie=$t("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=$t("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OT=$t("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RT=$t("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hie=$t("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=$t("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kie=$t("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uC=$t("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zie=$t("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xie=$t("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yie=$t("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=$t("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jie=$t("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=$t("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qie=$t("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=$t("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=$t("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F6=$t("Radar",[["path",{d:"M19.07 4.93A10 10 0 0 0 6.99 3.34",key:"z3du51"}],["path",{d:"M4 6h.01",key:"oypzma"}],["path",{d:"M2.29 9.62A10 10 0 1 0 21.31 8.35",key:"qzzz0"}],["path",{d:"M16.24 7.76A6 6 0 1 0 8.23 16.67",key:"1yjesh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M17.99 11.66A6 6 0 0 1 15.77 16.67",key:"1u2y91"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"m13.41 10.59 5.66-5.66",key:"mhq4k0"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eae=$t("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=$t("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=$t("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tae=$t("Satellite",[["path",{d:"M13 7 9 3 5 7l4 4",key:"vyckw6"}],["path",{d:"m17 11 4 4-4 4-4-4",key:"rchckc"}],["path",{d:"m8 12 4 4 6-6-4-4Z",key:"1sshf7"}],["path",{d:"m16 8 3-3",key:"x428zp"}],["path",{d:"M9 21a6 6 0 0 0-6-6",key:"1iajcf"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rae=$t("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=$t("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=$t("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=$t("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dC=$t("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=$t("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nae=$t("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iae=$t("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DU=$t("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aae=$t("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OU=$t("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sae=$t("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oae=$t("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=$t("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lae=$t("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cae=$t("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B6=$t("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qv=$t("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=$t("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=$t("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uae=$t("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dae=$t("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RU=$t("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=$t("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hae=$t("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fae=$t("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=$t("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U6=$t("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=$t("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=$t("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=$t("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=$t("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),tM=Y.createContext(void 0);function Gp(){const t=Y.useContext(tM);if(!t)throw new Error("useNotifications must be used within a NotificationProvider");return t}function pae({children:t}){const[e,r]=Y.useState([]),n=v=>{const w=Math.random().toString(36).substring(2,15),T={...v,id:w,duration:v.duration??5e3};return r(A=>[...A,T]),!v.persistent&&T.duration>0&&setTimeout(()=>{i(w)},T.duration),w},i=v=>{r(w=>w.filter(T=>T.id!==v))},o=()=>{r([])},u=(v,w,T)=>n({...T,type:"success",title:v,message:w}),a=(v,w,T)=>n({...T,type:"error",title:v,message:w,persistent:(T==null?void 0:T.persistent)??!0}),p=(v,w,T)=>n({...T,type:"warning",title:v,message:w}),g=(v,w,T)=>n({...T,type:"info",title:v,message:w});return l.jsxs(tM.Provider,{value:{notifications:e,addNotification:n,removeNotification:i,clearAll:o,success:u,error:a,warning:p,info:g},children:[t,l.jsx(mae,{})]})}function mae(){const t=Y.useContext(tM);if(!t)return null;const{notifications:e,removeNotification:r}=t;return l.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(n=>l.jsx(gae,{notification:n,onClose:()=>r(n.id)},n.id))})}function gae({notification:t,onClose:e}){const[r,n]=Y.useState(!1),[i,o]=Y.useState(!1);Y.useEffect(()=>{setTimeout(()=>n(!0),50)},[]);const u=()=>{o(!0),setTimeout(e,300)},a={success:hi,error:ab,warning:oi,info:nu},p={success:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",icon:"text-green-600 dark:text-green-400",text:"text-green-800 dark:text-green-200",button:"text-green-600 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-800/30"},error:{bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-200 dark:border-red-800",icon:"text-red-600 dark:text-red-400",text:"text-red-800 dark:text-red-200",button:"text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-800/30"},warning:{bg:"bg-yellow-50 dark:bg-yellow-900/20",border:"border-yellow-200 dark:border-yellow-800",icon:"text-yellow-600 dark:text-yellow-400",text:"text-yellow-800 dark:text-yellow-200",button:"text-yellow-600 dark:text-yellow-400 hover:bg-yellow-100 dark:hover:bg-yellow-800/30"},info:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",icon:"text-blue-600 dark:text-blue-400",text:"text-blue-800 dark:text-blue-200",button:"text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-800/30"}},g=a[t.type],v=p[t.type];return l.jsx("div",{className:`
        transform transition-all duration-300 ease-out max-w-sm w-full
        ${r&&!i?"translate-x-0 opacity-100 scale-100":"translate-x-full opacity-0 scale-95"}
        ${v.bg} ${v.border} border rounded-lg shadow-lg p-4
      `,children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(g,{className:`w-5 h-5 ${v.icon}`})}),l.jsxs("div",{className:"ml-3 flex-1",children:[l.jsx("h4",{className:`text-sm font-medium ${v.text}`,children:t.title}),l.jsx("p",{className:`text-sm mt-1 ${v.text} opacity-90`,children:t.message}),t.actions&&t.actions.length>0&&l.jsx("div",{className:"mt-3 flex space-x-2",children:t.actions.map((w,T)=>l.jsx("button",{onClick:w.onClick,className:`px-3 py-1 text-xs font-medium rounded transition-colors ${w.style==="primary"?`${v.bg} ${v.text} border ${v.border}`:`${v.button}`}`,children:w.label},T))})]}),l.jsx("div",{className:"ml-4 flex-shrink-0",children:l.jsx("button",{onClick:u,className:`rounded-lg p-1 transition-colors ${v.button}`,children:l.jsx(no,{className:"w-4 h-4"})})})]})})}var LU={exports:{}};(function(t,e){(function(r,n){n()})($c,function(){function r(g,v){return typeof v>"u"?v={autoBom:!1}:typeof v!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),v={autoBom:!v}),v.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(g.type)?new Blob(["\uFEFF",g],{type:g.type}):g}function n(g,v,w){var T=new XMLHttpRequest;T.open("GET",g),T.responseType="blob",T.onload=function(){p(T.response,v,w)},T.onerror=function(){console.error("could not download file")},T.send()}function i(g){var v=new XMLHttpRequest;v.open("HEAD",g,!1);try{v.send()}catch{}return 200<=v.status&&299>=v.status}function o(g){try{g.dispatchEvent(new MouseEvent("click"))}catch{var v=document.createEvent("MouseEvents");v.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),g.dispatchEvent(v)}}var u=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof $c=="object"&&$c.global===$c?$c:void 0,a=u.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),p=u.saveAs||(typeof window!="object"||window!==u?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(g,v,w){var T=u.URL||u.webkitURL,A=document.createElement("a");v=v||g.name||"download",A.download=v,A.rel="noopener",typeof g=="string"?(A.href=g,A.origin===location.origin?o(A):i(A.href)?n(g,v,w):o(A,A.target="_blank")):(A.href=T.createObjectURL(g),setTimeout(function(){T.revokeObjectURL(A.href)},4e4),setTimeout(function(){o(A)},0))}:"msSaveOrOpenBlob"in navigator?function(g,v,w){if(v=v||g.name||"download",typeof g!="string")navigator.msSaveOrOpenBlob(r(g,w),v);else if(i(g))n(g,v,w);else{var T=document.createElement("a");T.href=g,T.target="_blank",setTimeout(function(){o(T)})}}:function(g,v,w,T){if(T=T||open("","_blank"),T&&(T.document.title=T.document.body.innerText="downloading..."),typeof g=="string")return n(g,v,w);var A=g.type==="application/octet-stream",I=/constructor/i.test(u.HTMLElement)||u.safari,P=/CriOS\/[\d]+/.test(navigator.userAgent);if((P||A&&I||a)&&typeof FileReader<"u"){var D=new FileReader;D.onloadend=function(){var $=D.result;$=P?$:$.replace(/^data:[^;]*;/,"data:attachment/file;"),T?T.location.href=$:location=$,T=null},D.readAsDataURL(g)}else{var L=u.URL||u.webkitURL,O=L.createObjectURL(g);T?T.location=O:location.href=O,T=null,setTimeout(function(){L.revokeObjectURL(O)},4e4)}});u.saveAs=p.saveAs=p,t.exports=p})})(LU);var lb=LU.exports;async function Gg(t,e,r={}){const{filename:n=`sentinel_export_${new Date().toISOString().slice(0,10)}`,includeHeaders:i=!0,includeMetadata:o=!0}=r;try{switch(e){case"csv":return await yae(t,n,i);case"json":return await xae(t,n,o,r);case"xlsx":return await vae(t,n,i);case"pdf":return await _ae(t,n,r);default:throw new Error(`Unsupported export format: ${e}`)}}catch(u){throw console.error("Export failed:",u),u}}async function yae(t,e,r){if(!t.length)throw new Error("No data to export");const n=Object.keys(t[0]),i=[];r&&i.push(n.map(a=>`"${a}"`).join(",")),t.forEach(a=>{const p=n.map(g=>{const v=a[g];return v==null?'""':typeof v=="object"?`"${JSON.stringify(v)}"`:`"${String(v).replace(/"/g,'""')}"`});i.push(p.join(","))});const o=i.join(`
`),u=new Blob([o],{type:"text/csv;charset=utf-8;"});lb.saveAs(u,`${e}.csv`)}async function xae(t,e,r,n){const i={data:t,exportedAt:new Date().toISOString(),totalRecords:t.length};r&&(i.metadata={exportOptions:n,dataTypes:bae(t[0]||{}),summary:wae(t)});const o=JSON.stringify(i,null,2),u=new Blob([o],{type:"application/json;charset=utf-8;"});lb.saveAs(u,`${e}.json`)}async function vae(t,e,r){const n=await IT(()=>import("./xlsx-6ed613d4.js"),[]),i=n.utils.json_to_sheet(t,{header:r?void 0:[]}),o=n.utils.book_new();n.utils.book_append_sheet(o,i,"Data");const u=n.utils.json_to_sheet([{Property:"Export Date",Value:new Date().toISOString()},{Property:"Total Records",Value:t.length},{Property:"Columns",Value:Object.keys(t[0]||{}).length}]);n.utils.book_append_sheet(o,u,"Metadata");const a=n.write(o,{bookType:"xlsx",type:"array"}),p=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});lb.saveAs(p,`${e}.xlsx`)}async function _ae(t,e,r){const n=(await IT(()=>import("./jspdf.es.min-867d2580.js").then(a=>a.j),[])).default;require("jspdf-autotable");const i=new n;i.setFontSize(16),i.text("Sentinel Data Export",14,20),i.setFontSize(10),i.text(`Export Date: ${new Date().toLocaleString()}`,14,30),i.text(`Total Records: ${t.length}`,14,35),r.dateRange&&i.text(`Date Range: ${r.dateRange.start.toLocaleDateString()} - ${r.dateRange.end.toLocaleDateString()}`,14,40);const o=Object.keys(t[0]||{}),u=t.map(a=>o.map(p=>{const g=a[p];return typeof g=="object"?JSON.stringify(g):String(g||"")}));i.autoTable({head:[o],body:u,startY:50,styles:{fontSize:8},columnStyles:o.reduce((a,p,g)=>(a[g]={cellWidth:"auto"},a),{})}),i.save(`${e}.pdf`)}function bae(t){const e={};return Object.entries(t).forEach(([r,n])=>{n==null?e[r]="null":Array.isArray(n)?e[r]="array":n instanceof Date?e[r]="date":e[r]=typeof n}),e}function wae(t){if(!t.length)return{};const e={},r=t[0];return Object.keys(r).forEach(n=>{const i=t.map(u=>u[n]).filter(u=>u!=null);e[n]={nonNullCount:i.length,nullCount:t.length-i.length,uniqueCount:new Set(i.map(u=>JSON.stringify(u))).size};const o=i[0];if(typeof o=="number"){const u=i.filter(a=>typeof a=="number");e[n].min=Math.min(...u),e[n].max=Math.max(...u),e[n].average=u.reduce((a,p)=>a+p,0)/u.length}else typeof o=="string"&&(e[n].averageLength=i.reduce((u,a)=>u+String(a).length,0)/i.length)}),e}async function zU(t,e="csv"){const r=t.map(n=>{var i,o,u;return{id:n.id,titre:n.title,description:n.description,priorite:n.priority,statut:n.status,severite:n.severity,source:n.source,localisation:n.location,date_creation:n.createdAt,date_mise_a_jour:n.updatedAt,assigne_a:((i=n.assignedTo)==null?void 0:i.name)||"",tags:((o=n.tags)==null?void 0:o.join(", "))||"",nb_mentions:((u=n.mentions)==null?void 0:u.length)||0}});return Gg(r,e,{filename:`sentinel_alerts_${new Date().toISOString().slice(0,10)}`,includeHeaders:!0,includeMetadata:!0})}async function kae(t,e="json"){const r={summary:{totalNodes:t.nodes.length,totalEdges:t.edges.length,exportDate:new Date().toISOString()},nodes:t.nodes.map(n=>({id:n.id,label:n.label,type:n.type,influence:n.influence,sentiment:n.sentiment,connections:n.connections,verified:n.verified,metadata:n.metadata})),edges:t.edges.map(n=>({id:n.id,source:n.source,target:n.target,type:n.type,weight:n.weight,strength:n.strength,bidirectional:n.bidirectional}))};if(e==="json"){const n=JSON.stringify(r,null,2),i=new Blob([n],{type:"application/json;charset=utf-8;"});lb.saveAs(i,`sentinel_network_${new Date().toISOString().slice(0,10)}.json`)}else await Gg(r.nodes,e,{filename:`sentinel_network_nodes_${new Date().toISOString().slice(0,10)}`}),await Gg(r.edges,e,{filename:`sentinel_network_edges_${new Date().toISOString().slice(0,10)}`})}async function Tae(t,e="csv"){const r=t.map(n=>{var i;return{id:n.id,timestamp:n.timestamp,source:n.source,platform:n.platform,contenu:n.content,auteur:n.author||"",localisation:n.location||"",sentiment:n.sentiment,engagement:n.engagement,portee:n.reach,verifie:n.verified?"Oui":"Non",langue:n.language,mots_cles:((i=n.keywords)==null?void 0:i.join(", "))||"",categorie:n.category,priorite:n.priority}});return Gg(r,e,{filename:`sentinel_raw_data_${new Date().toISOString().slice(0,10)}`,includeHeaders:!0,includeMetadata:!0})}async function $U(t,e="csv"){var n,i,o;const r={summary:t.summary,keywords:((n=t.keywords)==null?void 0:n.map(u=>({mot_cle:u.keyword,mentions:u.mentions,sentiment_positif:u.sentiment.positive,sentiment_negatif:u.sentiment.negative,sentiment_neutre:u.sentiment.neutral,evolution:u.trend})))||[],geographic:((i=t.geographic)==null?void 0:i.map(u=>({region:u.location,mentions:u.mentions,sentiment_moyen:u.averageSentiment})))||[],platforms:((o=t.platforms)==null?void 0:o.map(u=>({plateforme:u.name,mentions:u.mentions,engagement:u.engagement})))||[]};if(e==="json"){const u=JSON.stringify(r,null,2),a=new Blob([u],{type:"application/json;charset=utf-8;"});lb.saveAs(a,`sentinel_opinion_analysis_${new Date().toISOString().slice(0,10)}.json`)}else await Gg(r.keywords,e,{filename:`sentiment_analysis_keywords_${new Date().toISOString().slice(0,10)}`})}const Sae=Object.freeze(Object.defineProperty({__proto__:null,exportAlerts:zU,exportData:Gg,exportNetworkData:kae,exportOpinionAnalysis:$U,exportRawData:Tae},Symbol.toStringTag,{value:"Module"}));function Wg({data:t,onItemSelect:e}){const[r,n]=Y.useState([]),[i,o]=Y.useState(null),[u,a]=Y.useState("table"),[p,g]=Y.useState(!0),[v,w]=Y.useState(""),[T,A]=Y.useState({source:"all",sentiment:"all",priority:"all",verified:"all",timeRange:"all",category:"all",language:"all"}),[I,P]=Y.useState("timestamp"),[D,L]=Y.useState("desc"),[O,$]=Y.useState(1),[G,B]=Y.useState(25);Y.useState(!1),Y.useState(!1),Y.useState(!1),Y.useState("csv"),Y.useState([]),Y.useState(!1),Y.useState(["timestamp","source","content","sentiment","priority"]),Y.useState([]),Y.useState([]),Gp();const J=Y.useMemo(()=>Array.from({length:500},(ae,xe)=>{const ye=["Twitter","Facebook","WhatsApp","Telegram","Instagram","TikTok","Reddit","YouTube"],Se=["@user123","@activist_rdc","@journalist_ksh","@citizen_voice","@political_watch","@news_drc"],be=["Kinshasa","Nord-Kivu","Sud-Kivu","Katanga","Kasaï","Bandundu","Équateur"],Ce=["positive","negative","neutral"],$e=["low","medium","high","critical"],Ye=["Politique","Sécurité","Économie","Social","Santé","Éducation","Infrastructure"],jt=["fr","ln","sw","en"],Me=[["élections","vote","démocratie"],["sécurité","police","armée"],["économie","emploi","business"],["santé","hôpital","médecin"],["éducation","école","université"],["infrastructure","route","électricité"]],St=["Les préparatifs électoraux continuent dans la capitale avec une forte mobilisation des électeurs...","Incident sécuritaire rapporté dans l'est du pays, les forces de l'ordre interviennent...","Nouvelle initiative économique lancée pour soutenir les petites entreprises locales...","Campagne de vaccination étendue dans plusieurs provinces avec le soutien international...","Projet d'infrastructure routière approuvé pour améliorer la connectivité régionale...","Manifestation pacifique organisée par la société civile pour demander plus de transparence...","Découverte de nouveaux gisements miniers dans la région orientale du pays...","Programme d'éducation numérique lancé dans les écoles urbaines et rurales..."],Ct=ye[Math.floor(Math.random()*ye.length)],Ft=Ye[Math.floor(Math.random()*Ye.length)],gt=Me[Math.floor(Math.random()*Me.length)];return{id:`item_${xe+1}`,timestamp:new Date(Date.now()-Math.random()*7*24*60*60*1e3).toISOString(),source:Ct,platform:Ct,content:St[Math.floor(Math.random()*St.length)],author:Math.random()>.3?Se[Math.floor(Math.random()*Se.length)]:void 0,location:be[Math.floor(Math.random()*be.length)],sentiment:Ce[Math.floor(Math.random()*Ce.length)],engagement:Math.floor(Math.random()*1e4),reach:Math.floor(Math.random()*1e5),verified:Math.random()>.6,language:jt[Math.floor(Math.random()*jt.length)],keywords:gt,category:Ft,priority:$e[Math.floor(Math.random()*$e.length)],metadata:{shares:Math.floor(Math.random()*1e3),comments:Math.floor(Math.random()*500),likes:Math.floor(Math.random()*5e3),confidence:Math.round(Math.random()*100),aiAnalyzed:Math.random()>.5,flagged:Math.random()>.9}}}),[]),W=t||J;Y.useEffect(()=>{let ae=W.filter(xe=>{var Ft;const ye=xe.content.toLowerCase().includes(v.toLowerCase())||((Ft=xe.author)==null?void 0:Ft.toLowerCase().includes(v.toLowerCase()))||xe.keywords.some(gt=>gt.toLowerCase().includes(v.toLowerCase())),Se=T.source==="all"||xe.source===T.source,be=T.sentiment==="all"||xe.sentiment===T.sentiment,Ce=T.priority==="all"||xe.priority===T.priority,$e=T.verified==="all"||T.verified==="verified"&&xe.verified||T.verified==="unverified"&&!xe.verified,Ye=T.category==="all"||xe.category===T.category,jt=T.language==="all"||xe.language===T.language,Me=new Date,St=new Date(xe.timestamp);let Ct=!0;switch(T.timeRange){case"1h":Ct=Me.getTime()-St.getTime()<=36e5;break;case"24h":Ct=Me.getTime()-St.getTime()<=864e5;break;case"7d":Ct=Me.getTime()-St.getTime()<=6048e5;break;case"30d":Ct=Me.getTime()-St.getTime()<=2592e6;break;case"all":Ct=!0;break}return ye&&Se&&be&&Ce&&$e&&Ct&&Ye&&jt});ae.sort((xe,ye)=>{let Se=0;switch(I){case"timestamp":Se=new Date(xe.timestamp).getTime()-new Date(ye.timestamp).getTime();break;case"engagement":Se=xe.engagement-ye.engagement;break;case"reach":Se=xe.reach-ye.reach;break}return D==="asc"?Se:-Se}),n(ae),$(1),g(!1)},[W,v,T,I,D]),Y.useEffect(()=>{const ae=setTimeout(()=>g(!1),500);return()=>clearTimeout(ae)},[]);const H=Math.ceil(r.length/G),V=(O-1)*G,se=r.slice(V,V+G),K=ae=>{switch(ae){case"positive":return"text-green-600 bg-green-100 dark:bg-green-900/30 dark:text-green-400";case"negative":return"text-red-600 bg-red-100 dark:bg-red-900/30 dark:text-red-400";default:return"text-gray-600 bg-gray-100 dark:bg-gray-700 dark:text-gray-400"}},ce=ae=>{switch(ae){case"critical":return"text-red-600 bg-red-100 dark:bg-red-900/30 dark:text-red-400";case"high":return"text-orange-600 bg-orange-100 dark:bg-orange-900/30 dark:text-orange-400";case"medium":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/30 dark:text-yellow-400";default:return"text-green-600 bg-green-100 dark:bg-green-900/30 dark:text-green-400"}},ne=()=>l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-800 dark:text-gray-200",children:l.jsxs("button",{onClick:()=>{P("timestamp"),L(I==="timestamp"&&D==="desc"?"asc":"desc")},className:"flex items-center space-x-1 hover:text-blue-600",children:[l.jsx(ga,{className:"w-4 h-4"}),l.jsx("span",{children:"Timestamp"})]})}),l.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-800 dark:text-gray-200",children:"Source"}),l.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-800 dark:text-gray-200",children:"Contenu"}),l.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-800 dark:text-gray-200",children:"Sentiment"}),l.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-800 dark:text-gray-200",children:l.jsxs("button",{onClick:()=>{P("engagement"),L(I==="engagement"&&D==="desc"?"asc":"desc")},className:"flex items-center space-x-1 hover:text-blue-600",children:[l.jsx(ds,{className:"w-4 h-4"}),l.jsx("span",{children:"Engagement"})]})}),l.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-800 dark:text-gray-200",children:"Priorité"}),l.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-800 dark:text-gray-200",children:"Actions"})]})}),l.jsx("tbody",{children:se.map((ae,xe)=>l.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>o(ae),children:[l.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:new Date(ae.timestamp).toLocaleString("fr-FR")}),l.jsx("td",{className:"py-3 px-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200",children:ae.source}),ae.verified&&l.jsx(hi,{className:"w-4 h-4 text-green-500"}),ae.metadata.flagged&&l.jsx(cC,{className:"w-4 h-4 text-red-500"})]})}),l.jsxs("td",{className:"py-3 px-4 max-w-md",children:[l.jsx("p",{className:"truncate text-gray-800 dark:text-gray-200",children:ae.content}),l.jsx("div",{className:"flex items-center space-x-2 mt-1",children:ae.keywords.slice(0,3).map(ye=>l.jsx("span",{className:"px-1 py-0.5 text-xs bg-gray-200 dark:bg-gray-600 rounded",children:ye},ye))})]}),l.jsx("td",{className:"py-3 px-4",children:l.jsx("span",{className:`px-2 py-1 rounded text-xs ${K(ae.sentiment)}`,children:ae.sentiment})}),l.jsx("td",{className:"py-3 px-4",children:l.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:[l.jsx("div",{className:"font-medium",children:ae.engagement.toLocaleString()}),l.jsxs("div",{className:"text-xs",children:["Portée: ",ae.reach.toLocaleString()]})]})}),l.jsx("td",{className:"py-3 px-4",children:l.jsx("span",{className:`px-2 py-1 rounded text-xs ${ce(ae.priority)}`,children:ae.priority})}),l.jsx("td",{className:"py-3 px-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:ye=>{ye.stopPropagation(),o(ae)},className:"text-blue-600 dark:text-blue-400 hover:underline",children:l.jsx(ul,{className:"w-4 h-4"})}),l.jsx("button",{className:"text-green-600 dark:text-green-400 hover:underline",children:l.jsx(MU,{className:"w-4 h-4"})}),l.jsx("button",{className:"text-orange-600 dark:text-orange-400 hover:underline",children:l.jsx(ob,{className:"w-4 h-4"})})]})})]},ae.id))})]})}),re=()=>l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:se.map(ae=>l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>o(ae),children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200",children:ae.source}),l.jsxs("div",{className:"flex items-center space-x-1",children:[ae.verified&&l.jsx(hi,{className:"w-4 h-4 text-green-500"}),ae.metadata.flagged&&l.jsx(cC,{className:"w-4 h-4 text-red-500"})]})]}),l.jsx("p",{className:"text-gray-800 dark:text-gray-200 text-sm mb-3 line-clamp-3",children:ae.content}),l.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mb-2",children:[l.jsx("span",{children:new Date(ae.timestamp).toLocaleTimeString("fr-FR")}),l.jsx("span",{children:ae.location})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:`px-2 py-1 rounded text-xs ${K(ae.sentiment)}`,children:ae.sentiment}),l.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 dark:text-gray-400",children:[l.jsx("span",{children:ae.engagement}),l.jsx(ds,{className:"w-3 h-3"})]})]}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:ae.keywords.slice(0,4).map(xe=>l.jsx("span",{className:"px-1 py-0.5 text-xs bg-gray-200 dark:bg-gray-600 rounded",children:xe},xe))})]},ae.id))}),oe=()=>l.jsx("div",{className:"space-y-4",children:se.map((ae,xe)=>l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`w-3 h-3 rounded-full ${ae.priority==="critical"?"bg-red-500":ae.priority==="high"?"bg-orange-500":ae.priority==="medium"?"bg-yellow-500":"bg-green-500"}`}),xe<se.length-1&&l.jsx("div",{className:"w-0.5 h-16 bg-gray-200 dark:bg-gray-600 mt-2"})]}),l.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200",children:ae.source}),l.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(ae.timestamp).toLocaleString("fr-FR")})]}),l.jsx("span",{className:`px-2 py-1 rounded text-xs ${ce(ae.priority)}`,children:ae.priority})]}),l.jsx("p",{className:"text-gray-800 dark:text-gray-200 mb-2",children:ae.content}),l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("span",{className:`px-2 py-1 rounded text-xs ${K(ae.sentiment)}`,children:ae.sentiment}),l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:ae.location})]}),l.jsxs("div",{className:"flex items-center space-x-2 text-gray-500 dark:text-gray-400",children:[l.jsx(ds,{className:"w-4 h-4"}),l.jsx("span",{children:ae.engagement.toLocaleString()})]})]})]})]},ae.id))});return l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Gc,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Explorateur de Données Brutes"}),l.jsxs("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded text-sm",children:[r.length.toLocaleString()," éléments"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[l.jsxs("button",{onClick:()=>a("table"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${u==="table"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:[l.jsx(No,{className:"w-4 h-4 mr-1 inline"}),"Table"]}),l.jsxs("button",{onClick:()=>a("cards"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${u==="cards"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:[l.jsx(YI,{className:"w-4 h-4 mr-1 inline"}),"Cartes"]}),l.jsxs("button",{onClick:()=>a("timeline"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${u==="timeline"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:[l.jsx(ga,{className:"w-4 h-4 mr-1 inline"}),"Timeline"]})]}),l.jsxs("button",{className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(Co,{className:"w-4 h-4 mr-2 inline"}),"Exporter"]}),l.jsx("button",{className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:l.jsx(RT,{className:"w-4 h-4"})})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{className:"lg:col-span-2 relative",children:[l.jsx(iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Rechercher dans le contenu, auteurs, mots-clés...",value:v,onChange:ae=>w(ae.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),l.jsxs("select",{value:T.source,onChange:ae=>A(xe=>({...xe,source:ae.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"all",children:"Toutes les sources"}),l.jsx("option",{value:"Twitter",children:"Twitter"}),l.jsx("option",{value:"Facebook",children:"Facebook"}),l.jsx("option",{value:"WhatsApp",children:"WhatsApp"}),l.jsx("option",{value:"Telegram",children:"Telegram"}),l.jsx("option",{value:"Instagram",children:"Instagram"})]}),l.jsxs("select",{value:T.timeRange,onChange:ae=>A(xe=>({...xe,timeRange:ae.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"1h",children:"Dernière heure"}),l.jsx("option",{value:"24h",children:"Dernières 24h"}),l.jsx("option",{value:"7d",children:"7 derniers jours"}),l.jsx("option",{value:"30d",children:"30 derniers jours"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-6 gap-4 mb-6",children:[l.jsxs("select",{value:T.sentiment,onChange:ae=>A(xe=>({...xe,sentiment:ae.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"all",children:"Tous sentiments"}),l.jsx("option",{value:"positive",children:"Positif"}),l.jsx("option",{value:"negative",children:"Négatif"}),l.jsx("option",{value:"neutral",children:"Neutre"})]}),l.jsxs("select",{value:T.priority,onChange:ae=>A(xe=>({...xe,priority:ae.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"all",children:"Toutes priorités"}),l.jsx("option",{value:"critical",children:"Critique"}),l.jsx("option",{value:"high",children:"Élevée"}),l.jsx("option",{value:"medium",children:"Moyenne"}),l.jsx("option",{value:"low",children:"Faible"})]}),l.jsxs("select",{value:T.verified,onChange:ae=>A(xe=>({...xe,verified:ae.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"all",children:"Tous statuts"}),l.jsx("option",{value:"verified",children:"Vérifiés"}),l.jsx("option",{value:"unverified",children:"Non vérifiés"})]}),l.jsxs("select",{value:T.category,onChange:ae=>A(xe=>({...xe,category:ae.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"all",children:"Toutes catégories"}),l.jsx("option",{value:"Politique",children:"Politique"}),l.jsx("option",{value:"Sécurité",children:"Sécurité"}),l.jsx("option",{value:"Économie",children:"Économie"}),l.jsx("option",{value:"Social",children:"Social"})]}),l.jsxs("select",{value:T.language,onChange:ae=>A(xe=>({...xe,language:ae.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"all",children:"Toutes langues"}),l.jsx("option",{value:"fr",children:"Français"}),l.jsx("option",{value:"ln",children:"Lingala"}),l.jsx("option",{value:"sw",children:"Swahili"}),l.jsx("option",{value:"en",children:"Anglais"})]}),l.jsxs("select",{value:G,onChange:ae=>B(parseInt(ae.target.value)),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:10,children:"10 par page"}),l.jsx("option",{value:25,children:"25 par page"}),l.jsx("option",{value:50,children:"50 par page"}),l.jsx("option",{value:100,children:"100 par page"})]})]}),l.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden mb-4",children:p?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"text-center",children:[l.jsx(ro,{className:"w-8 h-8 text-blue-600 mx-auto mb-4 animate-spin"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Chargement des données..."})]})}):l.jsxs(l.Fragment,{children:[u==="table"&&ne(),u==="cards"&&l.jsx("div",{className:"p-4",children:re()}),u==="timeline"&&l.jsx("div",{className:"p-4",children:oe()})]})}),!p&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Affichage de ",V+1," à ",Math.min(V+G,r.length)," sur ",r.length," éléments"]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:()=>$(Math.max(1,O-1)),disabled:O===1,className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Précédent"}),l.jsxs("span",{className:"px-3 py-2 text-sm",children:["Page ",O," sur ",H]}),l.jsx("button",{onClick:()=>$(Math.min(H,O+1)),disabled:O===H,className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Suivant"})]})]}),i&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Détails de l'élément"}),l.jsx("button",{onClick:()=>o(null),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200",children:"×"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Contenu"}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:i.content}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Source:"}),l.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:i.source})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Auteur:"}),l.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:i.author||"Anonyme"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Localisation:"}),l.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:i.location})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Langue:"}),l.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:i.language.toUpperCase()})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Métadonnées"}),l.jsxs("div",{className:"space-y-2 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Sentiment:"}),l.jsx("span",{className:`px-2 py-1 rounded text-xs ${K(i.sentiment)}`,children:i.sentiment})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Priorité:"}),l.jsx("span",{className:`px-2 py-1 rounded text-xs ${ce(i.priority)}`,children:i.priority})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Engagement:"}),l.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:i.engagement.toLocaleString()})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Portée:"}),l.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:i.reach.toLocaleString()})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Vérifié:"}),l.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:i.verified?"✓ Oui":"✗ Non"})]})]}),l.jsx("h5",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Mots-clés"}),l.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:i.keywords.map(ae=>l.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded",children:ae},ae))}),l.jsx("h5",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Données supplémentaires"}),l.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(i.metadata).map(([ae,xe])=>l.jsxs("div",{className:"text-sm",children:[l.jsxs("span",{className:"font-medium text-gray-600 dark:text-gray-400 capitalize",children:[ae,":"]}),l.jsx("span",{className:"text-gray-800 dark:text-gray-200 ml-1",children:typeof xe=="boolean"?xe?"Oui":"Non":xe})]},ae))})]})]})]})})]})}function rM({isOpen:t,onClose:e,title:r,children:n,size:i="md",closeOnOverlayClick:o=!0,showHeader:u=!0,className:a=""}){const p=Y.useRef(null);if(Y.useEffect(()=>{var w;return t?(document.body.style.overflow="hidden",(w=p.current)==null||w.focus()):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}},[t]),Y.useEffect(()=>{const w=T=>{T.key==="Escape"&&t&&e()};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[t,e]),!t)return null;const g={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl",full:"max-w-full h-full w-full"},v=w=>{w.target===w.currentTarget&&o&&e()};return l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50 backdrop-blur-sm",children:[l.jsx("div",{className:"fixed inset-0",onClick:v,"aria-hidden":"true"}),l.jsxs("div",{ref:p,tabIndex:-1,className:`relative bg-white dark:bg-gray-800 rounded-xl shadow-2xl ${g[i]} w-full max-h-[90vh] overflow-hidden flex flex-col ${a}`,role:"dialog","aria-modal":"true","aria-labelledby":r?"modal-title":void 0,children:[u&&l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[r&&l.jsx("h2",{id:"modal-title",className:"text-xl font-bold text-gray-900 dark:text-white",children:r}),l.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Close modal",children:l.jsx(no,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:n})]})]})}function au({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:o="Confirmer",cancelText:u="Annuler",type:a="default"}){const p={default:"bg-blue-600 hover:bg-blue-700",danger:"bg-red-600 hover:bg-red-700",warning:"bg-yellow-600 hover:bg-yellow-700",success:"bg-green-600 hover:bg-green-700"},g=()=>{r(),e()};return l.jsx(rM,{isOpen:t,onClose:e,title:n,size:"sm",children:l.jsxs("div",{className:"p-6",children:[l.jsx("div",{className:"text-gray-700 dark:text-gray-300 mb-6",children:i}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:u}),l.jsx("button",{onClick:g,className:`px-4 py-2 text-white rounded-lg transition-colors ${p[a]}`,children:o})]})]})})}function Eae({initialKeyword:t=""}){const[e,r]=Y.useState(t),[n,i]=Y.useState(null),[o,u]=Y.useState("7d"),[a,p]=Y.useState("overview"),[g,v]=Y.useState(["all"]),[w,T]=Y.useState(null),[A,I]=Y.useState(!1),[P,D]=Y.useState(["élections","sécurité","gouvernement","économie","santé"]),[L,O]=Y.useState(!1),[$,G]=Y.useState("csv"),[B,J]=Y.useState(""),[W,H]=Y.useState(!1),[V,se]=Y.useState("all"),[K,ce]=Y.useState(!1),{success:ne,error:re,info:oe}=Gp(),ae=Me=>{const St=["Twitter","Facebook","WhatsApp","Telegram","Instagram","YouTube"],Ct=["Kinshasa","Nord-Kivu","Sud-Kivu","Katanga","Kasaï","Bandundu"],Ft=(Math.random()-.5)*2,gt=Math.max(0,Ft*50+30+Math.random()*20),Zt=Math.max(0,-Ft*50+30+Math.random()*20),Tt=100-gt-Zt;return{keyword:Me,mentions:Math.floor(Math.random()*5e4)+5e3,sentiment:{positive:Math.round(gt),negative:Math.round(Zt),neutral:Math.round(Tt)},trend:Math.random()>.6?"up":Math.random()>.3?"down":"stable",change:Math.floor(Math.random()*40)-20,sources:St.map(ot=>({platform:ot,count:Math.floor(Math.random()*1e4)+500,sentiment:(Math.random()-.5)*2})),geographicData:Ct.map(ot=>({region:ot,sentiment:(Math.random()-.5)*2,volume:Math.floor(Math.random()*5e3)+500})),timelineData:Array.from({length:30},(ot,ar)=>({timestamp:new Date(Date.now()-(29-ar)*24*60*60*1e3),sentiment:(Math.random()-.5)*2,volume:Math.floor(Math.random()*2e3)+100})),influentialVoices:Array.from({length:8},(ot,ar)=>({username:`@influencer_${ar+1}`,platform:St[Math.floor(Math.random()*St.length)],influence:Math.floor(Math.random()*100)+1,sentiment:(Math.random()-.5)*2,verified:Math.random()>.6}))}};Y.useEffect(()=>{let Me;return K&&n&&(Me=setInterval(()=>{xe(n,!1)},3e4)),()=>{Me&&clearInterval(Me)}},[K,n]),Y.useEffect(()=>{t&&t!==n&&xe(t)},[t]);const xe=async(Me,St=!0)=>{if(!Me.trim()){re("Erreur de recherche","Veuillez entrer un mot-clé valide");return}St&&I(!0),i(Me);try{await new Promise(Ft=>setTimeout(Ft,1e3));const Ct=ae(Me);T(Ct),ne("Analyse terminée",`Analyse d'opinion pour "${Me}" terminée avec succès`),P.includes(Me)||D(Ft=>[Me,...Ft].slice(0,10))}catch{re("Erreur d'analyse","Impossible de récupérer les données d'opinion")}finally{I(!1)}},ye=()=>{B.trim()&&!P.includes(B.trim())?(D(Me=>[B.trim(),...Me]),J(""),H(!1),ne("Mot-clé ajouté",`"${B.trim()}" ajouté aux mots-clés sauvegardés`)):re("Erreur","Ce mot-clé existe déjà ou est vide")},Se=Me=>{D(St=>St.filter(Ct=>Ct!==Me)),n===Me&&(i(null),T(null)),oe("Mot-clé supprimé",`"${Me}" supprimé des mots-clés sauvegardés`)},be=async()=>{if(!w){re("Erreur d'exportation","Aucune donnée à exporter");return}try{await $U({summary:{keyword:w.keyword,totalMentions:w.mentions,sentiment:w.sentiment,trend:w.trend,change:w.change},keywords:[{keyword:w.keyword,mentions:w.mentions,sentiment:w.sentiment,trend:w.trend}],geographic:w.geographicData.map(Me=>({location:Me.region,mentions:Me.volume,averageSentiment:Me.sentiment})),platforms:w.sources.map(Me=>({name:Me.platform,mentions:Me.count,engagement:Me.count*Math.random()}))},$),ne("Exportation réussie",`Données exportées au format ${$.toUpperCase()}`),O(!1)}catch{re("Erreur d'exportation","Impossible d'exporter les données")}},Ce=Y.useMemo(()=>{if(!w)return null;let Me={...w};return V!=="all"&&(Me.sources=Me.sources.filter(Ct=>V==="positive"?Ct.sentiment>.3:V==="negative"?Ct.sentiment<-.3:V==="neutral"?Math.abs(Ct.sentiment)<=.3:!0)),g.includes("all")||(Me.sources=Me.sources.filter(St=>g.includes(St.platform))),Me},[w,V,g]);Y.useMemo(()=>{if(!Ce)return null;const Me=Ce.sources.reduce((Ft,gt)=>Ft+gt.count,0),St=Ce.sources.reduce((Ft,gt)=>Ft+gt.sentiment,0)/Ce.sources.length,Ct=Ce.sources.reduce((Ft,gt)=>gt.count>Ft.count?gt:Ft,Ce.sources[0]);return{totalMentions:Me,avgSentiment:St,mostActiveSource:Ct,sourceCount:Ce.sources.length}},[Ce]);const $e=Me=>Me>.2?"text-green-600 bg-green-100 dark:bg-green-900/30 dark:text-green-400":Me<-.2?"text-red-600 bg-red-100 dark:bg-red-900/30 dark:text-red-400":"text-gray-600 bg-gray-100 dark:bg-gray-700 dark:text-gray-400",Ye=Me=>{switch(Me){case"up":return PU;case"down":return CU;default:return uC}},jt=Me=>{switch(Me){case"up":return"text-green-600 dark:text-green-400";case"down":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}};return l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(cc,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Analyse d'Opinion par Mot-clé"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Analysez l'opinion publique sur des sujets spécifiques"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:()=>ce(!K),className:`p-2 rounded-lg transition-colors ${K?"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,title:K?"Désactiver l'actualisation automatique":"Activer l'actualisation automatique",children:l.jsx(ro,{className:`w-4 h-4 ${K?"animate-spin":""}`})}),w&&l.jsx("button",{onClick:()=>O(!0),className:"p-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-800/30 transition-colors",title:"Exporter les données",children:l.jsx(Co,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>H(!0),className:"p-2 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded-lg hover:bg-purple-200 dark:hover:bg-purple-800/30 transition-colors",title:"Ajouter un mot-clé",children:l.jsx(qh,{className:"w-4 h-4"})}),l.jsxs("select",{value:o,onChange:Me=>u(Me.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"24h",children:"Dernières 24h"}),l.jsx("option",{value:"7d",children:"7 derniers jours"}),l.jsx("option",{value:"30d",children:"30 derniers jours"}),l.jsx("option",{value:"90d",children:"3 derniers mois"})]}),l.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[l.jsx("button",{onClick:()=>p("overview"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${a==="overview"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:"Vue d'ensemble"}),l.jsx("button",{onClick:()=>p("detailed"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${a==="detailed"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:"Détaillé"}),l.jsx("button",{onClick:()=>p("comparison"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${a==="comparison"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:"Comparaison"})]})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Rechercher un mot-clé ou sujet (ex: élections, sécurité, santé...)",value:e,onChange:Me=>r(Me.target.value),onKeyPress:Me=>Me.key==="Enter"&&xe(e),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),l.jsx("button",{onClick:()=>xe(e),disabled:A,className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:A?l.jsx(ro,{className:"w-5 h-5 animate-spin"}):"Analyser"})]}),l.jsxs("div",{className:"flex items-center space-x-2 flex-wrap",children:[l.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Mots-clés sauvegardés:"}),P.map(Me=>l.jsxs("div",{className:"flex items-center group",children:[l.jsxs("button",{onClick:()=>{r(Me),xe(Me)},className:`px-3 py-1 rounded-l-full text-sm transition-colors ${n===Me?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:["#",Me]}),l.jsx("button",{onClick:()=>Se(Me),className:"px-2 py-1 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-r-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-200 dark:hover:bg-red-800/30",title:`Supprimer "${Me}"`,children:l.jsx(no,{className:"w-3 h-3"})})]},Me))]})]}),w&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx(lf,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),l.jsxs("div",{className:`flex items-center space-x-1 ${jt(w.trend)}`,children:[Le.createElement(Ye(w.trend),{className:"w-4 h-4"}),l.jsxs("span",{className:"text-sm font-medium",children:[w.change>0?"+":"",w.change,"%"]})]})]}),l.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:w.mentions.toLocaleString()}),l.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Mentions totales"})]}),l.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/30 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx(cae,{className:"w-6 h-6 text-green-600 dark:text-green-400"}),l.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:[w.sentiment.positive,"%"]})]}),l.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:"Positif"}),l.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sentiment général"})]}),l.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900/30 dark:to-red-800/30 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx(lae,{className:"w-6 h-6 text-red-600 dark:text-red-400"}),l.jsxs("span",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:[w.sentiment.negative,"%"]})]}),l.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:"Négatif"}),l.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sentiment critique"})]}),l.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx(uC,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"}),l.jsxs("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:[w.sentiment.neutral,"%"]})]}),l.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:"Neutre"}),l.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sans opinion claire"})]})]}),a==="overview"&&l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Distribution par Plateforme"}),l.jsx("div",{className:"space-y-3",children:w.sources.map((Me,St)=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-3 h-3 rounded-full ${Me.sentiment>.2?"bg-green-500":Me.sentiment<-.2?"bg-red-500":"bg-gray-400"}`}),l.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:Me.platform})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"font-bold text-gray-900 dark:text-white",children:Me.count.toLocaleString()}),l.jsxs("div",{className:`text-xs ${Me.sentiment>.2?"text-green-600":Me.sentiment<-.2?"text-red-600":"text-gray-500"}`,children:[(Me.sentiment*100).toFixed(0),"% sentiment"]})]})]},St))})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Répartition Géographique"}),l.jsx("div",{className:"space-y-3",children:w.geographicData.map((Me,St)=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(od,{className:"w-4 h-4 text-gray-400"}),l.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:Me.region})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"font-bold text-gray-900 dark:text-white",children:Me.volume.toLocaleString()}),l.jsxs("div",{className:`text-xs ${Me.sentiment>.2?"text-green-600":Me.sentiment<-.2?"text-red-600":"text-gray-500"}`,children:[(Me.sentiment*100).toFixed(0),"% sentiment"]})]})]},St))})]})]}),a==="detailed"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Évolution Temporelle du Sentiment"}),l.jsx("div",{className:"h-64 bg-gradient-to-r from-purple-100 to-blue-100 dark:from-purple-900/30 dark:to-blue-800/30 rounded flex items-center justify-center",children:l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Graphique temporel interactif"})})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Voix Influentes"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.influentialVoices.map((Me,St)=>l.jsxs("div",{className:"bg-white dark:bg-gray-600 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:Me.username}),Me.verified&&l.jsx(hi,{className:"w-4 h-4 text-blue-500"})]}),l.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:Me.platform})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Influence: ",Me.influence,"%"]}),l.jsx("span",{className:`px-2 py-1 rounded text-xs ${$e(Me.sentiment)}`,children:Me.sentiment>.2?"Positif":Me.sentiment<-.2?"Négatif":"Neutre"})]}),l.jsx("button",{className:"text-blue-600 dark:text-blue-400 hover:underline text-sm",children:l.jsx(MU,{className:"w-4 h-4"})})]})]},St))})]})]}),l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("button",{onClick:()=>D(Me=>Me.includes(n)?Me:[...Me,n]),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(IU,{className:"w-4 h-4 mr-2 inline"}),"Sauvegarder"]}),l.jsxs("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(Co,{className:"w-4 h-4 mr-2 inline"}),"Exporter"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[l.jsx(oi,{className:"w-4 h-4 mr-2 inline"}),"Créer Alerte"]}),l.jsxs("button",{className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[l.jsx(ob,{className:"w-4 h-4 mr-2 inline"}),"Partager"]})]})]})]}),!w&&!A&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(cc,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Analysez l'Opinion Publique"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Recherchez un mot-clé ou un sujet pour voir ce que les gens en pensent"}),l.jsx("div",{className:"flex justify-center space-x-2",children:["élections","sécurité","économie"].map(Me=>l.jsxs("button",{onClick:()=>{r(Me),xe(Me)},className:"px-4 py-2 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-lg hover:bg-purple-200 dark:hover:bg-purple-800/50 transition-colors",children:['Essayer "',Me,'"']},Me))})]}),A&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(ro,{className:"w-8 h-8 text-purple-600 mx-auto mb-4 animate-spin"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Analyse en cours..."}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:['Collecte et analyse des données pour "',n,'"']})]}),l.jsx(au,{isOpen:L,onClose:()=>O(!1),onConfirm:be,title:"Exporter l'analyse d'opinion",message:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{children:[`Sélectionnez le format d'exportation pour l'analyse de "`,n,'":']}),l.jsx("div",{className:"space-y-2",children:["csv","json","pdf"].map(Me=>l.jsxs("label",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"radio",value:Me,checked:$===Me,onChange:St=>G(St.target.value),className:"w-4 h-4 text-blue-600"}),l.jsx("span",{className:"capitalize",children:Me.toUpperCase()})]},Me))}),w&&l.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Données: ",w.mentions.toLocaleString()," mentions, ",w.sources.length," sources"]})]}),confirmText:"Exporter",cancelText:"Annuler",type:"success"}),l.jsx(au,{isOpen:W,onClose:()=>{H(!1),J("")},onConfirm:ye,title:"Ajouter un mot-clé",message:l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{children:"Entrez un nouveau mot-clé à surveiller:"}),l.jsx("input",{type:"text",value:B,onChange:Me=>J(Me.target.value),onKeyPress:Me=>Me.key==="Enter"&&ye(),placeholder:"Ex: éducation, infrastructure, covid...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",autoFocus:!0}),l.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ce mot-clé sera ajouté à votre liste de mots-clés sauvegardés"})]}),confirmText:"Ajouter",cancelText:"Annuler",type:"success"})]})}function jae({initialTimeRange:t="7d"}){const[e,r]=Y.useState(t),[n,i]=Y.useState("combined"),[o,u]=Y.useState(["mentions","sentiment","alerts"]),[a,p]=Y.useState("1x"),[g,v]=Y.useState(!1),[w,T]=Y.useState(new Date),[A,I]=Y.useState(["all"]);Y.useState(null),Y.useState(!1),Y.useState("csv"),Y.useState(1);const[P,D]=Y.useState(!1);Y.useState(!1),Y.useState([]);const L=Y.useRef(null);Gp();const[O,$]=Y.useState(null),G={"1x":1e3,"2x":500,"4x":250},B=Y.useCallback(()=>{L.current&&clearInterval(L.current),v(!0),L.current=setInterval(()=>{T(oe=>{const ae=new Date(oe.getTime()+(e==="24h"?36e5:864e5));return ae>new Date?(v(!1),new Date):ae})},G[a])},[a,e]),J=Y.useCallback(()=>{L.current&&(clearInterval(L.current),L.current=null),v(!1)},[]);Y.useCallback(()=>{J();const oe=e==="24h"?1:e==="7d"?7:e==="30d"?30:90;T(new Date(Date.now()-oe*24*60*60*1e3))},[e,J]),Y.useCallback(()=>{T(oe=>new Date(oe.getTime()+(e==="24h"?60*60*1e3:24*60*60*1e3)))},[e]),Y.useCallback(()=>{T(oe=>new Date(oe.getTime()-(e==="24h"?60*60*1e3:24*60*60*1e3)))},[e]),Y.useEffect(()=>{P&&!g?B():!P&&g&&J()},[P,g,B,J]),Y.useEffect(()=>()=>{L.current&&clearInterval(L.current)},[]);const W=()=>{const oe=[],ae=["Sécurité","Politique","Social","Économie","Santé"],xe=["Kinshasa","Nord-Kivu","Sud-Kivu","Katanga","Kasaï"],ye=["alert","trend","incident","achievement","milestone"],Se=["low","medium","high","critical"],Ce=e==="24h"?1:e==="7d"?7:e==="30d"?30:90;for(let $e=0;$e<Math.min(50,Ce*3);$e++){const Ye=new Date(Date.now()-Math.random()*Ce*864e5),jt=ye[Math.floor(Math.random()*ye.length)],Me=ae[Math.floor(Math.random()*ae.length)];oe.push({id:`event_${$e}`,timestamp:Ye,type:jt,title:`${jt==="alert"?"Alerte":jt==="trend"?"Tendance":jt==="incident"?"Incident":jt==="achievement"?"Réussite":"Étape"} ${Me}`,description:`Description détaillée de l'événement ${Me.toLowerCase()} survenu à ${Ye.toLocaleTimeString("fr-FR")}`,severity:Se[Math.floor(Math.random()*Se.length)],category:Me,location:Math.random()>.3?xe[Math.floor(Math.random()*xe.length)]:void 0,metrics:{mentions:Math.floor(Math.random()*5e3)+100,sentiment:(Math.random()-.5)*2,reach:Math.floor(Math.random()*5e4)+1e3}})}return oe.sort(($e,Ye)=>Ye.timestamp.getTime()-$e.timestamp.getTime())},H=()=>{const oe=e==="24h"?1:e==="7d"?7:e==="30d"?30:90,ae=oe===1?24:oe,xe=oe===1?60*60*1e3:24*60*60*1e3,ye=[{metric:"mentions",color:"blue",unit:"mentions",values:[]},{metric:"sentiment",color:"green",unit:"score",values:[]},{metric:"alerts",color:"red",unit:"alertes",values:[]},{metric:"reach",color:"purple",unit:"personnes",values:[]}];return ye.forEach(Se=>{var Ce;let be=Se.metric==="mentions"?1e3:Se.metric==="sentiment"?0:Se.metric==="alerts"?10:25e3;for(let $e=0;$e<ae;$e++){const Ye=new Date(Date.now()-(ae-1-$e)*xe),jt=1+(Math.random()-.5)*.4,Me=Math.round(be*jt),St=((Ce=Se.values[$e-1])==null?void 0:Ce.value)||Me,Ct=$e>0?(Me-St)/St*100:0;Se.values.push({timestamp:Ye,value:Me,change:Math.round(Ct*100)/100}),Se.metric==="sentiment"?be=Math.max(-1,Math.min(1,be+(Math.random()-.5)*.1)):be=Math.max(0,be+(Math.random()-.5)*be*.1)}}),ye},[V]=Y.useState(W()),[se]=Y.useState(H()),K=oe=>{switch(oe){case"critical":return"bg-red-500 border-red-600";case"high":return"bg-orange-500 border-orange-600";case"medium":return"bg-yellow-500 border-yellow-600";default:return"bg-green-500 border-green-600"}},ce=oe=>{switch(oe){case"alert":return oi;case"trend":return ii;case"incident":return gl;case"achievement":return hi;default:return nu}},ne=V.filter(oe=>A.includes("all")||A.includes(oe.category)),re=se.filter(oe=>o.includes(oe.metric));return Y.useEffect(()=>{if(g){const oe=setInterval(()=>{T(ae=>new Date(ae.getTime()+6e4*(a==="4x"?4:a==="2x"?2:1)))},1e3);return()=>clearInterval(oe)}},[g,a]),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ga,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Timeline & Analyse de Tendances"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Visualisation temporelle et tendances des événements"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("select",{value:e,onChange:oe=>r(oe.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"24h",children:"Dernières 24h"}),l.jsx("option",{value:"7d",children:"7 derniers jours"}),l.jsx("option",{value:"30d",children:"30 derniers jours"}),l.jsx("option",{value:"90d",children:"3 derniers mois"})]}),l.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[l.jsxs("button",{onClick:()=>i("timeline"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${n==="timeline"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:[l.jsx(ga,{className:"w-4 h-4 mr-1 inline"}),"Timeline"]}),l.jsxs("button",{onClick:()=>i("trends"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${n==="trends"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:[l.jsx(ii,{className:"w-4 h-4 mr-1 inline"}),"Tendances"]}),l.jsxs("button",{onClick:()=>i("combined"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${n==="combined"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:[l.jsx(No,{className:"w-4 h-4 mr-1 inline"}),"Combiné"]})]})]})]}),l.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:()=>T(new Date(w.getTime()-60*60*1e3)),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600 rounded",children:l.jsx(nae,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>v(!g),className:`p-2 rounded ${g?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:g?l.jsx(Ug,{className:"w-4 h-4"}):l.jsx(qg,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>T(new Date(w.getTime()+60*60*1e3)),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600 rounded",children:l.jsx(iae,{className:"w-4 h-4"})}),l.jsxs("select",{value:a,onChange:oe=>p(oe.target.value),className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"1x",children:"1x"}),l.jsx("option",{value:"2x",children:"2x"}),l.jsx("option",{value:"4x",children:"4x"})]})]}),l.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l.jsx(ZI,{className:"w-4 h-4 mr-1 inline"}),w.toLocaleString("fr-FR")]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("button",{className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm",children:[l.jsx(Co,{className:"w-4 h-4 mr-1 inline"}),"Exporter"]}),l.jsxs("button",{className:"px-3 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors text-sm",children:[l.jsx(V0,{className:"w-4 h-4 mr-1 inline"}),"Options"]})]})]}),(n==="trends"||n==="combined")&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Analyse des Tendances"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Métriques:"}),["mentions","sentiment","alerts","reach"].map(oe=>l.jsx("button",{onClick:()=>{u(ae=>ae.includes(oe)?ae.filter(xe=>xe!==oe):[...ae,oe])},className:`px-3 py-1 rounded text-sm transition-colors ${o.includes(oe)?"bg-indigo-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:oe},oe))]})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:re.map((oe,ae)=>{var xe,ye,Se;return l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h5",{className:"font-semibold text-gray-800 dark:text-gray-200 capitalize",children:oe.metric}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-3 h-3 rounded-full bg-${oe.color}-500`}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(xe=oe.values[oe.values.length-1])==null?void 0:xe.value," ",oe.unit]})]})]}),l.jsxs("div",{className:`h-32 bg-gradient-to-r from-${oe.color}-100 to-${oe.color}-200 dark:from-${oe.color}-900/30 dark:to-${oe.color}-800/30 rounded flex items-center justify-center relative overflow-hidden`,children:[l.jsx("div",{className:"absolute inset-0 flex items-end justify-between p-2 space-x-1",children:oe.values.slice(-20).map((be,Ce)=>l.jsx("div",{className:`bg-${oe.color}-500 rounded-t opacity-70`,style:{height:`${Math.max(5,Math.abs(be.value)/Math.max(...oe.values.map($e=>Math.abs($e.value)))*100)}%`,width:"3px"}},Ce))}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 z-10 bg-white dark:bg-gray-800 px-2 py-1 rounded",children:["Graphique ",oe.metric]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4 text-center",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[((Se=(ye=oe.values[oe.values.length-1])==null?void 0:ye.change)==null?void 0:Se.toFixed(1))||0,"%"]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Variation"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:Math.max(...oe.values.map(be=>be.value)).toLocaleString()}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Maximum"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:Math.round(oe.values.reduce((be,Ce)=>be+Ce.value,0)/oe.values.length).toLocaleString()}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Moyenne"})]})]})]},oe.metric)})})]}),(n==="timeline"||n==="combined")&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Timeline des Événements"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(sb,{className:"w-4 h-4 text-gray-400"}),l.jsxs("select",{value:A[0]||"all",onChange:oe=>I([oe.target.value]),className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"all",children:"Toutes catégories"}),l.jsx("option",{value:"Sécurité",children:"Sécurité"}),l.jsx("option",{value:"Politique",children:"Politique"}),l.jsx("option",{value:"Social",children:"Social"}),l.jsx("option",{value:"Économie",children:"Économie"}),l.jsx("option",{value:"Santé",children:"Santé"})]})]})]}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-600"}),l.jsx("div",{className:"space-y-4",children:ne.slice(0,20).map((oe,ae)=>{var Se;const xe=ce(oe.type),ye=O===oe.id;return l.jsxs("div",{className:"relative flex items-start space-x-4",children:[l.jsx("div",{className:`relative z-10 w-12 h-12 rounded-full border-2 ${K(oe.severity)} flex items-center justify-center`,children:l.jsx(xe,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsxs("div",{className:"cursor-pointer",onClick:()=>$(ye?null:oe.id),children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("h5",{className:"font-semibold text-gray-900 dark:text-white",children:oe.title}),l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${oe.severity==="critical"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300":oe.severity==="high"?"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300":oe.severity==="medium"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"}`,children:oe.severity})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:oe.timestamp.toLocaleString("fr-FR")}),ye?l.jsx(Lie,{className:"w-4 h-4"}):l.jsx(pv,{className:"w-4 h-4"})]})]}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:oe.description}),l.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 dark:text-gray-400",children:[l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(qp,{className:"w-3 h-3"}),l.jsx("span",{children:oe.category})]}),oe.location&&l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(od,{className:"w-3 h-3"}),l.jsx("span",{children:oe.location})]}),oe.metrics&&l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(lf,{className:"w-3 h-3"}),l.jsxs("span",{children:[oe.metrics.mentions," mentions"]})]})]})]}),ye&&oe.metrics&&l.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:(Se=oe.metrics.mentions)==null?void 0:Se.toLocaleString()}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Mentions"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-lg font-bold ${(oe.metrics.sentiment||0)>0?"text-green-600":(oe.metrics.sentiment||0)<0?"text-red-600":"text-gray-600"}`,children:[((oe.metrics.sentiment||0)*100).toFixed(0),"%"]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Sentiment"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[((oe.metrics.reach||0)/1e3).toFixed(0),"K"]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Portée"})]})]})})]})]},oe.id)})})]})]})]})}function Aae({initialData:t}){const[e,r]=Y.useState(null),[n,i]=Y.useState(null),[o,u]=Y.useState(null),[a,p]=Y.useState("network"),[g,v]=Y.useState({minInfluence:0,nodeTypes:["all"],edgeTypes:["all"],sentimentFilter:"all",verified:"all",timeRange:"7d"});Y.useState({algorithm:"force-directed",spacing:50,gravity:.1,repulsion:100,attraction:.1});const[w,T]=Y.useState({zoom:1,pan:{x:0,y:0},showLabels:!0,showEdgeLabels:!1,colorBy:"type",sizeBy:"influence",animationSpeed:1});Y.useState(!1);const[A,I]=Y.useState(!1),[P,D]=Y.useState({filters:!0,layout:!1,analysis:!0,selection:!0});Y.useRef(null),Y.useState([]),Y.useState(!1),Y.useState("centrality"),Y.useState(1),Y.useState("radial"),Y.useState(!0),Y.useState([]),Y.useState([]),Y.useState({}),Y.useState(0),Y.useState(0),Y.useState(!1),Y.useState("json");const L=Y.useMemo(()=>()=>{const V=["person","organization","location","event","topic"],se=["communication","influence","collaboration","conflict","mention"],K=["Kinshasa","Nord-Kivu","Sud-Kivu","Katanga","Kasaï"],ce=["Politique","Sécurité","Social","Économie","Média"],ne=Array.from({length:50},(oe,ae)=>{const xe=V[Math.floor(Math.random()*V.length)],ye=Math.floor(Math.random()*100)+1;return{id:`node_${ae}`,label:xe==="person"?`Personne ${ae+1}`:xe==="organization"?`Organisation ${ae+1}`:xe==="location"?K[Math.floor(Math.random()*K.length)]:xe==="event"?`Événement ${ae+1}`:`Sujet ${ae+1}`,type:xe,size:Math.floor(ye/10)+5,influence:ye,sentiment:(Math.random()-.5)*2,connections:Math.floor(Math.random()*20)+1,verified:Math.random()>.7,metadata:{description:`Description détaillée du nœud ${ae+1}`,location:Math.random()>.5?K[Math.floor(Math.random()*K.length)]:void 0,category:ce[Math.floor(Math.random()*ce.length)],lastActivity:new Date(Date.now()-Math.random()*7*24*60*60*1e3),platform:Math.random()>.5?["Twitter","Facebook","WhatsApp"][Math.floor(Math.random()*3)]:void 0}}}),re=[];for(let oe=0;oe<80;oe++){const ae=ne[Math.floor(Math.random()*ne.length)],xe=ne[Math.floor(Math.random()*ne.length)];if(ae.id!==xe.id&&!re.find(ye=>ye.source===ae.id&&ye.target===xe.id||ye.source===xe.id&&ye.target===ae.id)){const ye=se[Math.floor(Math.random()*se.length)],Se=Math.random();re.push({id:`edge_${oe}`,source:ae.id,target:xe.id,weight:Se,type:ye,strength:Se*100,bidirectional:Math.random()>.6})}}return{nodes:ne,edges:re}},[]);Y.useEffect(()=>{r(t||L)},[t,L]);const O=V=>{switch(w.colorBy){case"type":return V.type==="person"?"#3B82F6":V.type==="organization"?"#EF4444":V.type==="location"?"#10B981":V.type==="event"?"#F59E0B":"#8B5CF6";case"influence":return`hsl(${Math.round((1-V.influence/100)*120)}, 70%, 50%)`;case"sentiment":return V.sentiment>.2?"#10B981":V.sentiment<-.2?"#EF4444":"#6B7280";default:return"#6B7280"}},$=V=>{switch(w.sizeBy){case"influence":return Math.max(5,V.influence/5);case"connections":return Math.max(5,V.connections*2);default:return V.size}},G=e?{nodes:e.nodes.filter(V=>!(V.influence<g.minInfluence||!g.nodeTypes.includes("all")&&!g.nodeTypes.includes(V.type)||g.verified!=="all"&&(g.verified==="verified"&&!V.verified||g.verified==="unverified"&&V.verified)||g.sentimentFilter!=="all"&&(g.sentimentFilter==="positive"&&V.sentiment<=.2||g.sentimentFilter==="negative"&&V.sentiment>=-.2||g.sentimentFilter==="neutral"&&Math.abs(V.sentiment)>.2))),edges:e.edges.filter(V=>!(!g.edgeTypes.includes("all")&&!g.edgeTypes.includes(V.type)))}:{nodes:[],edges:[]},B=V=>{D(se=>({...se,[V]:!se[V]}))},J=V=>{const se=G.nodes.find(K=>K.id===V);se&&(i(se),u(null))},W=V=>{const se=G.edges.find(K=>K.id===V);se&&(u(se),i(null))},H=async()=>{try{const{exportNetworkData:V}=await IT(()=>Promise.resolve().then(()=>Sae),void 0);await V({nodes:G.nodes,edges:G.edges},"json"),typeof success=="function"&&success("Export réussi","Données réseau exportées avec succès")}catch(V){console.error("Export failed:",V),typeof error=="function"?error("Erreur d'export","Impossible d'exporter les données réseau"):alert("Erreur lors de l'exportation des données réseau")}};return l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Wc,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Analyse Réseau Avancée"}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[G.nodes.length," nœuds, ",G.edges.length," connexions"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:["network","hierarchy","clusters","timeline"].map(V=>l.jsx("button",{onClick:()=>p(V),className:`px-3 py-1 rounded text-sm font-medium transition-colors capitalize ${a===V?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-400"}`,children:V},V))}),l.jsx("button",{onClick:()=>I(!A),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:l.jsx(V0,{className:"w-5 h-5"})}),l.jsxs("button",{onClick:H,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(Co,{className:"w-4 h-4 mr-2 inline"}),"Exporter"]})]})]}),l.jsxs("div",{className:"flex",children:[l.jsxs("div",{className:"w-80 border-r border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 overflow-y-auto max-h-[600px]",children:[l.jsxs("div",{className:"p-4",children:[l.jsxs("button",{onClick:()=>B("filters"),className:"flex items-center justify-between w-full text-left font-semibold text-gray-800 dark:text-white mb-3",children:[l.jsxs("span",{className:"flex items-center space-x-2",children:[l.jsx(sb,{className:"w-4 h-4"}),l.jsx("span",{children:"Filtres"})]}),P.filters?l.jsx(pv,{className:"w-4 h-4"}):l.jsx(Jw,{className:"w-4 h-4"})]}),P.filters&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Influence minimale: ",g.minInfluence]}),l.jsx("input",{type:"range",min:"0",max:"100",value:g.minInfluence,onChange:V=>v(se=>({...se,minInfluence:Number(V.target.value)})),className:"w-full"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Types de nœuds"}),l.jsx("div",{className:"space-y-1",children:["all","person","organization","location","event","topic"].map(V=>l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",checked:g.nodeTypes.includes(V),onChange:se=>{v(V==="all"?K=>({...K,nodeTypes:se.target.checked?["all"]:[]}):K=>({...K,nodeTypes:K.nodeTypes.includes("all")?[V]:se.target.checked?[...K.nodeTypes.filter(ce=>ce!=="all"),V]:K.nodeTypes.filter(ce=>ce!==V)}))},className:"mr-2"}),l.jsx("span",{className:"text-sm capitalize",children:V==="all"?"Tous":V})]},V))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sentiment"}),l.jsxs("select",{value:g.sentimentFilter,onChange:V=>v(se=>({...se,sentimentFilter:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"all",children:"Tous"}),l.jsx("option",{value:"positive",children:"Positif"}),l.jsx("option",{value:"negative",children:"Négatif"}),l.jsx("option",{value:"neutral",children:"Neutre"})]})]})]})]}),l.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-600",children:[l.jsxs("button",{onClick:()=>B("layout"),className:"flex items-center justify-between w-full text-left font-semibold text-gray-800 dark:text-white mb-3",children:[l.jsxs("span",{className:"flex items-center space-x-2",children:[l.jsx(DU,{className:"w-4 h-4"}),l.jsx("span",{children:"Visualisation"})]}),P.layout?l.jsx(pv,{className:"w-4 h-4"}):l.jsx(Jw,{className:"w-4 h-4"})]}),P.layout&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Colorer par"}),l.jsxs("select",{value:w.colorBy,onChange:V=>T(se=>({...se,colorBy:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"type",children:"Type"}),l.jsx("option",{value:"influence",children:"Influence"}),l.jsx("option",{value:"sentiment",children:"Sentiment"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Taille par"}),l.jsxs("select",{value:w.sizeBy,onChange:V=>T(se=>({...se,sizeBy:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"influence",children:"Influence"}),l.jsx("option",{value:"connections",children:"Connexions"}),l.jsx("option",{value:"default",children:"Par défaut"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Libellés"}),l.jsx("button",{onClick:()=>T(V=>({...V,showLabels:!V.showLabels})),className:`p-1 rounded ${w.showLabels?"text-blue-600":"text-gray-400"}`,children:w.showLabels?l.jsx(ul,{className:"w-4 h-4"}):l.jsx(mv,{className:"w-4 h-4"})})]})]})]}),l.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-600",children:[l.jsxs("button",{onClick:()=>B("analysis"),className:"flex items-center justify-between w-full text-left font-semibold text-gray-800 dark:text-white mb-3",children:[l.jsxs("span",{className:"flex items-center space-x-2",children:[l.jsx(cc,{className:"w-4 h-4"}),l.jsx("span",{children:"Analyse"})]}),P.analysis?l.jsx(pv,{className:"w-4 h-4"}):l.jsx(Jw,{className:"w-4 h-4"})]}),P.analysis&&l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-3",children:[l.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Densité du réseau"}),l.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[(G.edges.length/(G.nodes.length*(G.nodes.length-1)/2)*100).toFixed(1),"%"]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-3",children:[l.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Diamètre"}),l.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:Math.ceil(Math.log(G.nodes.length)/Math.log(2))})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-3",children:[l.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Centralité moyenne"}),l.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:(G.nodes.reduce((V,se)=>V+se.connections,0)/G.nodes.length).toFixed(1)})]})]})]})]}),l.jsx("div",{className:"flex-1 relative",children:l.jsxs("div",{className:"relative h-[600px] bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsxs("div",{className:"relative w-full h-full overflow-hidden",children:[l.jsxs("svg",{className:"w-full h-full",style:{backgroundColor:"transparent"},children:[G.edges.slice(0,25).map((V,se)=>{const K=G.nodes.findIndex(Ct=>Ct.id===V.source),ce=G.nodes.findIndex(Ct=>Ct.id===V.target);if(K===-1||ce===-1)return null;const ne=400,re=280,oe=180,ae=K/Math.max(1,G.nodes.length)*2*Math.PI,xe=ce/Math.max(1,G.nodes.length)*2*Math.PI,ye=V.id.split("").reduce((Ct,Ft)=>Ct+Ft.charCodeAt(0),0),Se=(ye%80-40)*.5,be=(ye*3%80-40)*.5,Ce=(ye*5%80-40)*.5,$e=(ye*7%80-40)*.5,Ye=ne+Math.cos(ae)*oe+Se,jt=re+Math.sin(ae)*oe+be,Me=ne+Math.cos(xe)*oe+Ce,St=re+Math.sin(xe)*oe+$e;return l.jsx("line",{x1:Ye,y1:jt,x2:Me,y2:St,stroke:V.type==="communication"?"#3B82F6":V.type==="influence"?"#EF4444":V.type==="collaboration"?"#10B981":V.type==="conflict"?"#F59E0B":"#8B5CF6",strokeWidth:Math.max(1,V.strength/25),opacity:.4,className:"cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>W(V.id)},V.id)}),G.nodes.slice(0,25).map((V,se)=>{const ne=120+se%3*60,re=se/Math.max(1,G.nodes.slice(0,25).length)*2*Math.PI,oe=V.id.split("").reduce((jt,Me)=>jt+Me.charCodeAt(0),0),ae=(oe%100-50)*.8,xe=(oe*7%100-50)*.8,ye=400+Math.cos(re)*ne+ae,Se=280+Math.sin(re)*ne+xe,be=Math.max(50,Math.min(750,ye)),Ce=Math.max(50,Math.min(520,Se)),$e=Math.max(8,Math.min(20,$(V))),Ye=O(V);return l.jsxs("g",{className:"cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>J(V.id),children:[l.jsx("circle",{cx:be,cy:Ce,r:$e,fill:Ye,stroke:(n==null?void 0:n.id)===V.id?"#FFD700":"white",strokeWidth:(n==null?void 0:n.id)===V.id?3:2,className:"drop-shadow-sm"}),w.showLabels&&l.jsx("text",{x:be,y:Ce+$e+16,textAnchor:"middle",fontSize:"11",fill:"currentColor",className:"font-medium text-gray-700 dark:text-gray-300 pointer-events-none",children:V.label.length>12?V.label.substring(0,12)+"...":V.label}),V.verified&&l.jsx("circle",{cx:be+$e-4,cy:Ce-$e+4,r:"4",fill:"#10B981",stroke:"white",strokeWidth:"1"}),l.jsx("circle",{cx:be,cy:Ce,r:$e+2,fill:"none",stroke:Ye,strokeWidth:"1",opacity:V.influence/200})]},V.id)})]}),l.jsx("div",{className:"absolute top-4 left-4 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 px-3 py-2 rounded-lg text-sm",children:"Visualisation interactive - Vue simplifiée"})]})}),l.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2",children:[l.jsx("button",{onClick:()=>T(V=>({...V,zoom:Math.min(V.zoom*1.2,5)})),className:"p-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded shadow hover:bg-gray-50 dark:hover:bg-gray-700",children:l.jsx(QI,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>T(V=>({...V,zoom:Math.max(V.zoom/1.2,.2)})),className:"p-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded shadow hover:bg-gray-50 dark:hover:bg-gray-700",children:l.jsx(eM,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>T(V=>({...V,zoom:1,pan:{x:0,y:0}})),className:"p-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded shadow hover:bg-gray-50 dark:hover:bg-gray-700",children:l.jsx(il,{className:"w-4 h-4"})})]})]})}),(n||o)&&l.jsxs("div",{className:"w-80 border-l border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 p-4 overflow-y-auto max-h-[600px]",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white",children:n?"Détails du Nœud":"Détails de la Connexion"}),l.jsx("button",{onClick:()=>{i(null),u(null)},className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"×"})]}),n&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[l.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:O(n)}}),l.jsxs("div",{children:[l.jsx("h5",{className:"font-semibold text-gray-800 dark:text-white",children:n.label}),l.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:n.type})]}),n.verified&&l.jsx(OU,{className:"w-4 h-4 text-yellow-500"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Influence:"}),l.jsxs("span",{className:"text-sm font-medium text-gray-800 dark:text-white",children:[n.influence,"/100"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Connexions:"}),l.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-white",children:n.connections})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sentiment:"}),l.jsxs("span",{className:`text-sm font-medium ${n.sentiment>.2?"text-green-600":n.sentiment<-.2?"text-red-600":"text-gray-600"}`,children:[(n.sentiment*100).toFixed(0),"%"]})]})]})]}),n.metadata&&l.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4",children:[l.jsx("h6",{className:"font-medium text-gray-800 dark:text-white mb-2",children:"Métadonnées"}),l.jsxs("div",{className:"space-y-2",children:[n.metadata.location&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(od,{className:"w-3 h-3 text-gray-400"}),l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:n.metadata.location})]}),n.metadata.category&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(qp,{className:"w-3 h-3 text-gray-400"}),l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:n.metadata.category})]}),n.metadata.lastActivity&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ga,{className:"w-3 h-3 text-gray-400"}),l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:n.metadata.lastActivity.toLocaleDateString("fr-FR")})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("button",{className:"w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm",children:"Analyser en détail"}),l.jsx("button",{className:"w-full px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-white rounded hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors text-sm",children:"Voir connexions"})]})]}),o&&l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4",children:[l.jsxs("h5",{className:"font-semibold text-gray-800 dark:text-white mb-3",children:["Connexion ",o.type]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Force:"}),l.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-white",children:o.strength.toFixed(1)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Bidirectionnelle:"}),l.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-white",children:o.bidirectional?"Oui":"Non"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Poids:"}),l.jsxs("span",{className:"text-sm font-medium text-gray-800 dark:text-white",children:[(o.weight*100).toFixed(0),"%"]})]})]})]})})]})]})]})}function Nae({isOpen:t,onClose:e,onConfirm:r,itemName:n,itemType:i="élément",warningMessage:o}){return l.jsx(au,{isOpen:t,onClose:e,onConfirm:r,title:`Supprimer ${i}`,message:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("p",{children:["Êtes-vous sûr de vouloir supprimer ",l.jsxs("strong",{children:['"',n,'"']})," ?"]}),o&&l.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(oi,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:o})]})}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Cette action est irréversible."})]}),confirmText:"Supprimer",cancelText:"Annuler",type:"danger"})}function Cae({isOpen:t,onClose:e,onConfirm:r,count:n,itemType:i="éléments"}){return l.jsx(au,{isOpen:t,onClose:e,onConfirm:r,title:"Suppression en lot",message:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("p",{children:["Êtes-vous sûr de vouloir supprimer ",l.jsxs("strong",{children:[n," ",i]})," ?"]}),l.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(oi,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:"Cette action supprimera définitivement tous les éléments sélectionnés et ne peut pas être annulée."})]})})]}),confirmText:`Supprimer ${n} éléments`,cancelText:"Annuler",type:"danger"})}function Pae({isOpen:t,onClose:e,onConfirm:r,exportFormat:n,itemCount:i,estimatedSize:o}){return l.jsx(au,{isOpen:t,onClose:e,onConfirm:r,title:"Confirmer l'exportation",message:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("p",{children:["Exporter ",l.jsxs("strong",{children:[i.toLocaleString()," éléments"]})," au format ",l.jsx("strong",{children:n.toUpperCase()})," ?"]}),o&&l.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(nu,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),l.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["Taille estimée: ",o]})]})}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Le fichier sera téléchargé automatiquement une fois généré."})]}),confirmText:"Exporter",cancelText:"Annuler",type:"success"})}function Iae({isOpen:t,onClose:e,onConfirm:r,settingsCategory:n="tous les paramètres"}){return l.jsx(au,{isOpen:t,onClose:e,onConfirm:r,title:"Réinitialiser les paramètres",message:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("p",{children:["Êtes-vous sûr de vouloir réinitialiser ",l.jsx("strong",{children:n})," ?"]}),l.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(oi,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Tous vos paramètres personnalisés seront perdus et remplacés par les valeurs par défaut."})]})})]}),confirmText:"Réinitialiser",cancelText:"Annuler",type:"warning"})}function Mae({isOpen:t,onClose:e,onConfirm:r,dataType:n,retentionPeriod:i}){return l.jsx(au,{isOpen:t,onClose:e,onConfirm:r,title:"Effacer les données",message:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("p",{children:["Êtes-vous sûr de vouloir effacer ",l.jsx("strong",{children:n})," ?"]}),i&&l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Données concernées: ",i]}),l.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(oi,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:"Cette action est irréversible. Assurez-vous d'avoir sauvegardé toutes les données importantes."})]})})]}),confirmText:"Effacer les données",cancelText:"Annuler",type:"danger"})}function Dae({isOpen:t,onClose:e,onConfirm:r,onSave:n,changesDescription:i="des modifications non sauvegardées"}){return l.jsx(au,{isOpen:t,onClose:e,onConfirm:r,title:"Modifications non sauvegardées",message:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{children:["Vous avez ",l.jsx("strong",{children:i}),". Que souhaitez-vous faire ?"]}),n&&l.jsxs("div",{className:"flex space-x-3",children:[l.jsxs("button",{onClick:()=>{n(),e()},className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(Oie,{className:"w-4 h-4"}),l.jsx("span",{children:"Sauvegarder"})]}),l.jsxs("button",{onClick:r,className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:[l.jsx(no,{className:"w-4 h-4"}),l.jsx("span",{children:"Ignorer"})]})]}),!n&&l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Si vous continuez, vos modifications seront perdues."})]}),confirmText:n?void 0:"Continuer sans sauvegarder",cancelText:"Annuler",type:"warning"})}function Oae({isOpen:t,onClose:e,onConfirm:r,hasUnsavedWork:n=!1}){return l.jsx(au,{isOpen:t,onClose:e,onConfirm:r,title:"Confirmer la déconnexion",message:l.jsxs("div",{className:"space-y-3",children:[l.jsx("p",{children:"Êtes-vous sûr de vouloir vous déconnecter ?"}),n&&l.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(oi,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Vous avez du travail non sauvegardé qui pourrait être perdu."})]})})]}),confirmText:"Se déconnecter",cancelText:"Annuler",type:"warning"})}function Rae({isOpen:t,onClose:e,onConfirm:r,permissionType:n,reason:i}){return l.jsx(au,{isOpen:t,onClose:e,onConfirm:r,title:"Autorisation requise",message:l.jsxs("div",{className:"space-y-3",children:[l.jsxs("p",{children:["L'application demande l'autorisation d'accéder à ",l.jsx("strong",{children:n}),"."]}),l.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx(nu,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),l.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[l.jsx("strong",{children:"Raison:"})," ",i]})]})}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Vous pouvez révoquer cette autorisation à tout moment dans les paramètres."})]}),confirmText:"Autoriser",cancelText:"Refuser",type:"default"})}function Lae(){const[t,e]=Le.useState({isOpen:!1,type:"",props:{}}),r=(A,I)=>{e({isOpen:!0,type:A,props:{...I,onClose:()=>e(P=>({...P,isOpen:!1}))}})},n=()=>{e(A=>({...A,isOpen:!1}))},i=(A,I,P)=>{r("delete",{itemName:A,onConfirm:()=>{I(),n()},...P})},o=(A,I,P)=>{r("bulkDelete",{count:A,onConfirm:()=>{I(),n()},...P})},u=(A,I,P,D)=>{r("export",{exportFormat:A,itemCount:I,onConfirm:()=>{P(),n()},...D})},a=(A,I)=>{r("resetSettings",{onConfirm:()=>{A(),n()},...I})},p=(A,I,P)=>{r("clearData",{dataType:A,onConfirm:()=>{I(),n()},...P})},g=(A,I)=>{r("unsavedChanges",{onConfirm:()=>{A(),n()},...I})},v=(A,I)=>{r("logout",{onConfirm:()=>{A(),n()},...I})},w=(A,I,P)=>{r("permission",{permissionType:A,reason:I,onConfirm:()=>{P(),n()}})},T=()=>{if(!t.isOpen)return null;switch(t.type){case"delete":return l.jsx(Nae,{...t.props});case"bulkDelete":return l.jsx(Cae,{...t.props});case"export":return l.jsx(Pae,{...t.props});case"resetSettings":return l.jsx(Iae,{...t.props});case"clearData":return l.jsx(Mae,{...t.props});case"unsavedChanges":return l.jsx(Dae,{...t.props});case"logout":return l.jsx(Oae,{...t.props});case"permission":return l.jsx(Rae,{...t.props});default:return null}};return{isOpen:t.isOpen,openDialog:r,closeDialog:n,confirmDelete:i,confirmBulkDelete:o,confirmExport:u,confirmResetSettings:a,confirmClearData:p,confirmUnsavedChanges:g,confirmLogout:v,confirmPermission:w,renderDialog:T}}class LT{constructor(e){Vl(this,"storageKey");this.storageKey=e}saveToStorage(e){localStorage.setItem(this.storageKey,JSON.stringify(e))}loadFromStorage(){const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):null}generateId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}generateTimestamp(){return new Date().toISOString()}simulateDelay(e=100){return new Promise(r=>setTimeout(r,e))}generateMockData(e,r){return Array.from({length:r},e)}}class zae extends LT{constructor(){super("sentinel_alerts")}parseDatesInAlert(e){var r,n;return{...e,time:new Date(e.time),notes:(r=e.notes)==null?void 0:r.map(i=>({...i,timestamp:new Date(i.timestamp)})),timeline:(n=e.timeline)==null?void 0:n.map(i=>({...i,timestamp:new Date(i.timestamp)}))}}generateMockAlerts(){return[{id:1,type:"critical",category:"security",title:"Pic d'activité anormal détecté",description:"Augmentation de 300% des mentions négatives concernant la sécurité dans la province du Nord-Kivu",location:"Nord-Kivu",time:new Date(Date.now()-12e4),status:"active",assignedTo:null,metrics:{mentions:892,sentiment:-.73,reach:234e3,sources:["Facebook","Twitter"]},timeline:[{id:"1-1",action:"created",description:"Alerte créée automatiquement par le système IA",author:"System",timestamp:new Date(Date.now()-12e4)}]},{id:2,type:"warning",category:"misinformation",title:"Campagne de désinformation détectée",description:"Propagation rapide d'informations non vérifiées concernant des événements à Kinshasa",location:"Kinshasa",time:new Date(Date.now()-3e5),status:"investigating",assignedTo:"Équipe Analyse",metrics:{mentions:456,sentiment:-.45,reach:125e3,sources:["WhatsApp","Facebook"]},notes:[{id:"note-1",content:"Investigation en cours - sources multiples identifiées",author:"Analyste Principal",timestamp:new Date(Date.now()-6e4)}],timeline:[{id:"2-1",action:"created",description:"Alerte créée automatiquement",author:"System",timestamp:new Date(Date.now()-3e5)},{id:"2-2",action:"assigned",description:"Assigné à l'Équipe Analyse",author:"Coordinateur",timestamp:new Date(Date.now()-24e4)},{id:"2-3",action:"status_changed",description:'Statut changé à "investigating"',author:"Équipe Analyse",timestamp:new Date(Date.now()-18e4)}]},{id:3,type:"info",category:"trend",title:"Nouveau sujet tendance identifié",description:'Le terme "réforme éducative" connaît une augmentation significative des mentions positives',location:"National",time:new Date(Date.now()-72e4),status:"monitoring",assignedTo:"Équipe Communication",metrics:{mentions:234,sentiment:.67,reach:89e3,sources:["News","Blogs"]}},{id:4,type:"critical",category:"network",title:"Réseau d'influence hostile détecté",description:"Identification d'un groupe coordonné diffusant des messages anti-gouvernementaux",location:"Katanga",time:new Date(Date.now()-108e4),status:"active",assignedTo:null,metrics:{mentions:678,sentiment:-.82,reach:187e3,sources:["Twitter","Forums"]}}]}async getAllAlerts(e){var n,i,o;await this.simulateDelay(200);let r=this.loadFromStorage()||this.generateMockAlerts();return this.loadFromStorage()&&(r=r.map(u=>this.parseDatesInAlert(u))),e&&((n=e.type)!=null&&n.length&&(r=r.filter(u=>e.type.includes(u.type))),(i=e.category)!=null&&i.length&&(r=r.filter(u=>e.category.includes(u.category))),(o=e.status)!=null&&o.length&&(r=r.filter(u=>e.status.includes(u.status))),e.assignedTo&&(r=r.filter(u=>u.assignedTo===e.assignedTo)),e.location&&(r=r.filter(u=>u.location.toLowerCase().includes(e.location.toLowerCase()))),e.dateRange&&(r=r.filter(u=>u.time>=e.dateRange.start&&u.time<=e.dateRange.end))),r.sort((u,a)=>a.time.getTime()-u.time.getTime())}async getAlert(e){await this.simulateDelay(100);let r=this.loadFromStorage()||this.generateMockAlerts();return this.loadFromStorage()&&(r=r.map(n=>this.parseDatesInAlert(n))),r.find(n=>n.id===e)||null}async createAlert(e){await this.simulateDelay(300);const r=this.loadFromStorage()||this.generateMockAlerts(),n={id:Math.max(...r.map(i=>i.id),0)+1,...e,time:new Date,status:"active",assignedTo:null,metrics:{mentions:0,sentiment:0,reach:0,sources:[],...e.metrics},timeline:[{id:this.generateId(),action:"created",description:"Alerte créée manuellement",author:"User",timestamp:new Date}]};return r.push(n),this.saveToStorage(r),n}async updateAlertStatus(e,r,n){await this.simulateDelay(200);let i=this.loadFromStorage()||this.generateMockAlerts();this.loadFromStorage()&&(i=i.map(a=>this.parseDatesInAlert(a)));const o=i.findIndex(a=>a.id===e);if(o===-1)throw new Error("Alert not found");const u=i[o];return u.status=r,u.timeline||(u.timeline=[]),u.timeline.push({id:this.generateId(),action:"status_changed",description:`Statut changé à "${r}"${n?`: ${n}`:""}`,author:"User",timestamp:new Date}),this.saveToStorage(i),u}async assignAlert(e,r){await this.simulateDelay(200);let n=this.loadFromStorage()||this.generateMockAlerts();this.loadFromStorage()&&(n=n.map(u=>this.parseDatesInAlert(u)));const i=n.findIndex(u=>u.id===e);if(i===-1)throw new Error("Alert not found");const o=n[i];return o.assignedTo=r,o.timeline||(o.timeline=[]),o.timeline.push({id:this.generateId(),action:"assigned",description:`Assigné à ${r}`,author:"User",timestamp:new Date}),this.saveToStorage(n),o}async addNote(e,r){await this.simulateDelay(150);let n=this.loadFromStorage()||this.generateMockAlerts();this.loadFromStorage()&&(n=n.map(a=>this.parseDatesInAlert(a)));const i=n.findIndex(a=>a.id===e);if(i===-1)throw new Error("Alert not found");const o=n[i];o.notes||(o.notes=[]);const u={id:this.generateId(),content:r,author:"User",timestamp:new Date};return o.notes.push(u),o.timeline||(o.timeline=[]),o.timeline.push({id:this.generateId(),action:"note_added",description:"Note ajoutée",author:"User",timestamp:new Date}),this.saveToStorage(n),o}async getAlertStats(){await this.simulateDelay(100);let e=this.loadFromStorage()||this.generateMockAlerts();return this.loadFromStorage()&&(e=e.map(r=>this.parseDatesInAlert(r))),{total:e.length,active:e.filter(r=>r.status==="active").length,critical:e.filter(r=>r.type==="critical").length,investigating:e.filter(r=>r.status==="investigating").length,resolved:e.filter(r=>r.status==="resolved").length,byCategory:e.reduce((r,n)=>(r[n.category]=(r[n.category]||0)+1,r),{})}}async deleteAlert(e){await this.simulateDelay(200);let r=this.loadFromStorage()||this.generateMockAlerts();this.loadFromStorage()&&(r=r.map(i=>this.parseDatesInAlert(i)));const n=r.filter(i=>i.id!==e);this.saveToStorage(n)}async getRecentActivity(e=10){return await this.simulateDelay(100),(await this.getAllAlerts()).slice(0,e)}}function $2(){const[t,e]=Y.useState("all"),[r,n]=Y.useState(null),[i,o]=Y.useState([]),[u,a]=Y.useState(!0),p=new zae,[g,v]=Y.useState(!1),[w,T]=Y.useState(!1);Y.useState(!1),Y.useState({details:!0,metrics:!0,timeline:!1,actions:!0});const[A,I]=Y.useState("overview"),[P,D]=Y.useState(""),[L,O]=Y.useState("time"),[$,G]=Y.useState("desc"),[B,J]=Y.useState("all"),[W,H]=Y.useState("all"),[V,se]=Y.useState(!1),[K,ce]=Y.useState([]),[ne,re]=Y.useState(""),[oe,ae]=Y.useState("investigating"),[xe,ye]=Y.useState("");Y.useState(!0);const{success:Se,error:be,info:Ce}=Gp();Lae(),Y.useEffect(()=>{(async()=>{try{a(!0);const Lt=await p.getAllAlerts();o(Lt)}catch(Lt){be("Erreur de chargement","Impossible de charger les alertes"),console.error("Failed to load alerts:",Lt)}finally{a(!1)}})()},[p,be]),Y.useEffect(()=>{const mt=setInterval(async()=>{try{const Lt=await p.getAllAlerts();o(Lt)}catch(Lt){console.error("Failed to refresh alerts:",Lt)}},3e4);return()=>clearInterval(mt)},[p]);const $e=async()=>{if(!r||!ne.trim()){be("Erreur d'assignation","Veuillez sélectionner un utilisateur");return}try{const mt=await p.assignAlert(r.id,ne.trim());n(mt),Se("Alert assignée",`Alerte assignée à ${ne.trim()}`),v(!1),re("");const Lt=await p.getAllAlerts();o(Lt)}catch(mt){be("Erreur d'assignation","Impossible d'assigner l'alerte"),console.error("Assignment error:",mt)}},Ye=async(mt,Lt)=>{if(r)try{const dr=Lt||oe,Gr=await p.updateAlertStatus(r.id,dr,xe||void 0);n(Gr),Se("Statut mis à jour",`Alerte passée au statut "${dr}"`),T(!1),ye("");const qr=await p.getAllAlerts();o(qr)}catch(dr){be("Erreur de statut","Impossible de changer le statut"),console.error("Status change error:",dr)}},jt=async mt=>{try{const Lt=mt?i.filter(dr=>dr.id===mt):K.length>0?i.filter(dr=>K.includes(dr.id)):Me;await zU(Lt,"csv"),Se("Export réussi",`${Lt.length} alerte(s) exportée(s)`),se(!1)}catch{be("Erreur d'export","Impossible d'exporter les alertes")}},Me=Y.useMemo(()=>{let mt=i.filter(Lt=>{const dr=t==="all"||Lt.type===t,Gr=P===""||Lt.title.toLowerCase().includes(P.toLowerCase())||Lt.description.toLowerCase().includes(P.toLowerCase()),qr=B==="all"||Lt.category===B,ln=W==="all"||Lt.status===W;return dr&&Gr&&qr&&ln});return mt.sort((Lt,dr)=>{let Gr=0;switch(L){case"time":Gr=dr.time.getTime()-Lt.time.getTime();break;case"priority":const qr={critical:4,warning:3,info:2,success:1};Gr=qr[dr.type]-qr[Lt.type];break;case"status":Gr=Lt.status.localeCompare(dr.status);break}return $==="asc"?-Gr:Gr}),mt},[i,t,P,B,W,L,$]),St=10;Math.ceil(Me.length/St);const Ct=1;Me.slice((Ct-1)*St,Ct*St);const Ft=mt=>{switch(mt){case"critical":return oi;case"warning":return nu;case"info":return Jv;default:return ds}},gt=mt=>{switch(mt){case"critical":return"from-red-500 to-red-600";case"warning":return"from-yellow-500 to-yellow-600";case"info":return"from-blue-500 to-blue-600";default:return"from-gray-500 to-gray-600"}},Zt=mt=>{switch(mt){case"active":return"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300";case"investigating":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300";case"monitoring":return"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300";case"resolved":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300";default:return"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}},Tt=mt=>{switch(mt){case"security":return gl;case"misinformation":return oi;case"trend":return ii;case"network":return Wc;default:return ds}},ot=r?[{id:1,type:"created",title:"Alerte créée",description:"Détection automatique par le système de surveillance",timestamp:new Date(r.time.getTime()),user:"Système"},{id:2,type:"status_change",title:"Statut modifié",description:'Passé de "nouveau" à "actif"',timestamp:new Date(r.time.getTime()+3e5),user:"Analyste 1"},{id:3,type:"comment",title:"Commentaire ajouté",description:"Analyse préliminaire terminée, escalade recommandée",timestamp:new Date(r.time.getTime()+6e5),user:"Analyste Principal"}]:[],ar=["Équipe Analyse","Équipe Communication","Équipe Sécurité","Analyste Principal","Chef de Service"];return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Centre d'Alertes"}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[i.filter(mt=>mt.status==="active").length," alertes actives nécessitant une attention"]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("select",{value:t,onChange:mt=>e(mt.target.value),className:"px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"all",children:"Toutes les alertes"}),l.jsx("option",{value:"critical",children:"Critiques"}),l.jsx("option",{value:"warning",children:"Avertissements"}),l.jsx("option",{value:"info",children:"Information"})]}),l.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Configurer alertes"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-6 border border-red-200 dark:border-red-800",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx(oi,{className:"w-8 h-8 text-red-600"}),l.jsx("span",{className:"text-3xl font-bold text-red-600",children:i.filter(mt=>mt.type==="critical").length})]}),l.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:"Alertes critiques"})]}),l.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-xl p-6 border border-yellow-200 dark:border-yellow-800",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx(nu,{className:"w-8 h-8 text-yellow-600"}),l.jsx("span",{className:"text-3xl font-bold text-yellow-600",children:i.filter(mt=>mt.type==="warning").length})]}),l.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"Avertissements"})]}),l.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-6 border border-blue-200 dark:border-blue-800",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx(Jv,{className:"w-8 h-8 text-blue-600"}),l.jsx("span",{className:"text-3xl font-bold text-blue-600",children:i.filter(mt=>mt.type==="info").length})]}),l.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Informations"})]}),l.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-6 border border-green-200 dark:border-green-800",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx(hi,{className:"w-8 h-8 text-green-600"}),l.jsx("span",{className:"text-3xl font-bold text-green-600",children:i.filter(mt=>mt.status==="resolved").length})]}),l.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:"Résolues (24h)"})]})]}),l.jsx("div",{className:"space-y-4",children:Me.map(mt=>{const Lt=Ft(mt.type),dr=Tt(mt.category),Gr=Math.floor((Date.now()-mt.time.getTime())/6e4);return l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all p-6 cursor-pointer",onClick:()=>n(mt),children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${gt(mt.type)} flex items-center justify-center`,children:l.jsx(Lt,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[l.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white",children:mt.title}),l.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium ${Zt(mt.status)}`,children:mt.status==="active"?"Active":mt.status==="investigating"?"Investigation":mt.status==="monitoring"?"Surveillance":"Résolue"})]}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:mt.description}),l.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[l.jsxs("span",{className:"flex items-center space-x-1 text-gray-500 dark:text-gray-400",children:[l.jsx(od,{className:"w-4 h-4"}),l.jsx("span",{children:mt.location})]}),l.jsxs("span",{className:"flex items-center space-x-1 text-gray-500 dark:text-gray-400",children:[l.jsx(ga,{className:"w-4 h-4"}),l.jsxs("span",{children:["il y a ",Gr," minutes"]})]}),l.jsxs("span",{className:"flex items-center space-x-1 text-gray-500 dark:text-gray-400",children:[l.jsx(dr,{className:"w-4 h-4"}),l.jsx("span",{className:"capitalize",children:mt.category})]}),mt.assignedTo&&l.jsxs("span",{className:"flex items-center space-x-1 text-gray-500 dark:text-gray-400",children:[l.jsx(ea,{className:"w-4 h-4"}),l.jsx("span",{children:mt.assignedTo})]})]})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:mt.metrics.mentions}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"mentions"})]})]})},mt.id)})}),r&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-6xl w-full max-h-[95vh] overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${gt(r.type)} flex items-center justify-center`,children:Le.createElement(Ft(r.type),{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:r.title}),l.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[l.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium ${Zt(r.status)}`,children:r.status}),l.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID: ",r.id]})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:()=>jt(r==null?void 0:r.id),className:"p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:"Exporter",children:l.jsx(Co,{className:"w-5 h-5"})}),l.jsx("button",{className:"p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:"Partager",children:l.jsx(ob,{className:"w-5 h-5"})}),l.jsx("button",{className:"p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:"Ajouter aux favoris",children:l.jsx(OU,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>n(null),className:"p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:l.jsx(no,{className:"w-5 h-5"})})]})]}),l.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[l.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[l.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:l.jsx("nav",{className:"flex space-x-6",children:[{id:"overview",label:"Vue d'ensemble",icon:ul},{id:"timeline",label:"Chronologie",icon:ga},{id:"analysis",label:"Analyse",icon:No},{id:"related",label:"Liés",icon:qie}].map(mt=>{const Lt=mt.icon;return l.jsx("button",{onClick:()=>I(mt.id),className:`py-3 px-2 border-b-2 font-medium text-sm transition-colors ${A===mt.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Lt,{className:"w-4 h-4"}),l.jsx("span",{children:mt.label})]})},mt.id)})})}),A==="overview"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-3",children:"Description"}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg",children:r.description})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-3",children:"Métriques Clés"}),l.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(lf,{className:"w-4 h-4 text-blue-500"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Mentions"})]}),l.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:r.metrics.mentions})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(ds,{className:"w-4 h-4 text-green-500"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sentiment"})]}),l.jsxs("p",{className:`text-2xl font-bold ${r.metrics.sentiment>0?"text-green-600":"text-red-600"}`,children:[(r.metrics.sentiment*100).toFixed(0),"%"]})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(ii,{className:"w-4 h-4 text-purple-500"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Portée"})]}),l.jsxs("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:[(r.metrics.reach/1e3).toFixed(0),"K"]})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx(Wc,{className:"w-4 h-4 text-orange-500"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sources"})]}),l.jsx("p",{className:"text-sm font-bold text-gray-800 dark:text-white",children:r.metrics.sources.join(", ")})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-3",children:"Informations Géographiques"}),l.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(od,{className:"w-5 h-5 text-red-500"}),l.jsx("span",{className:"font-medium text-gray-800 dark:text-white",children:r.location})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-3",children:"Catégorie"}),l.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[Le.createElement(Tt(r.category),{className:"w-5 h-5 text-blue-500"}),l.jsx("span",{className:"font-medium text-gray-800 dark:text-white capitalize",children:r.category})]})})]})]})]}),A==="timeline"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Chronologie des Événements"}),l.jsx("div",{className:"space-y-4",children:ot.map((mt,Lt)=>l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`w-3 h-3 rounded-full ${mt.type==="created"?"bg-blue-500":mt.type==="status_change"?"bg-yellow-500":"bg-green-500"}`}),Lt<ot.length-1&&l.jsx("div",{className:"w-0.5 h-12 bg-gray-200 dark:bg-gray-600 mt-2"})]}),l.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("h5",{className:"font-medium text-gray-800 dark:text-white",children:mt.title}),l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:mt.timestamp.toLocaleString("fr-FR")})]}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:mt.description}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ea,{className:"w-3 h-3 text-gray-400"}),l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:mt.user})]})]})]},mt.id))})]}),A==="analysis"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Analyse Approfondie"}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsx("h5",{className:"font-medium text-gray-800 dark:text-white mb-3",children:"Évolution Temporelle"}),l.jsx("div",{className:"h-32 bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/30 dark:to-blue-800/30 rounded flex items-center justify-center",children:l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Graphique temporel"})})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsx("h5",{className:"font-medium text-gray-800 dark:text-white mb-3",children:"Distribution Géographique"}),l.jsx("div",{className:"h-32 bg-gradient-to-r from-green-100 to-green-200 dark:from-green-900/30 dark:to-green-800/30 rounded flex items-center justify-center",children:l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Carte de chaleur"})})]})]})]}),A==="related"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Alertes Liées"}),l.jsx("div",{className:"space-y-3",children:i.slice(0,3).filter(mt=>mt.id!==r.id).map(mt=>l.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600/50",onClick:()=>n(mt),children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-8 h-8 rounded-lg bg-gradient-to-br ${gt(mt.type)} flex items-center justify-center`,children:Le.createElement(Ft(mt.type),{className:"w-4 h-4 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h5",{className:"font-medium text-gray-800 dark:text-white",children:mt.title}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:mt.location})]}),l.jsx("span",{className:`px-2 py-1 rounded text-xs ${Zt(mt.status)}`,children:mt.status})]})},mt.id))})]})]}),l.jsxs("div",{className:"w-80 border-l border-gray-200 dark:border-gray-700 p-6 bg-gray-50 dark:bg-gray-800/50",children:[l.jsx("h4",{className:"font-medium text-gray-800 dark:text-white mb-4",children:"Actions Rapides"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Gestion du Statut"}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("button",{onClick:()=>Ye(r.id,"investigating"),className:"px-3 py-2 bg-yellow-600 text-white text-sm rounded hover:bg-yellow-700 transition-colors",children:[l.jsx(ul,{className:"w-4 h-4 mr-1 inline"}),"Enquêter"]}),l.jsxs("button",{onClick:()=>Ye(r.id,"resolved"),className:"px-3 py-2 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors",children:[l.jsx(hi,{className:"w-4 h-4 mr-1 inline"}),"Résoudre"]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Attribution"}),l.jsxs("button",{onClick:()=>v(!0),className:"w-full px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:[l.jsx(dae,{className:"w-4 h-4 mr-2 inline"}),"Assigner à une équipe"]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Analyse"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("button",{className:"w-full px-3 py-2 bg-purple-600 text-white text-sm rounded hover:bg-purple-700 transition-colors",children:[l.jsx(No,{className:"w-4 h-4 mr-2 inline"}),"Analyse approfondie"]}),l.jsxs("button",{className:"w-full px-3 py-2 bg-indigo-600 text-white text-sm rounded hover:bg-indigo-700 transition-colors",children:[l.jsx(Wc,{className:"w-4 h-4 mr-2 inline"}),"Analyse réseau"]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Export & Partage"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("button",{onClick:()=>jt(r==null?void 0:r.id),className:"w-full px-3 py-2 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 transition-colors",children:[l.jsx(XI,{className:"w-4 h-4 mr-2 inline"}),"Générer rapport"]}),l.jsxs("button",{className:"w-full px-3 py-2 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 transition-colors",children:[l.jsx(zie,{className:"w-4 h-4 mr-2 inline"}),"Copier lien"]})]})]}),l.jsxs("div",{className:"space-y-2 pt-4 border-t border-gray-200 dark:border-gray-600",children:[l.jsxs("button",{className:"w-full px-3 py-2 bg-orange-600 text-white text-sm rounded hover:bg-orange-700 transition-colors",children:[l.jsx(cC,{className:"w-4 h-4 mr-2 inline"}),"Escalader"]}),l.jsxs("button",{className:"w-full px-3 py-2 bg-gray-500 text-white text-sm rounded hover:bg-gray-600 transition-colors",children:[l.jsx(Pie,{className:"w-4 h-4 mr-2 inline"}),"Archiver"]})]})]}),l.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-600",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-3",children:"Informations"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Créée:"}),l.jsx("span",{className:"text-gray-800 dark:text-white",children:r.time.toLocaleDateString("fr-FR")})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Assignée à:"}),l.jsx("span",{className:"text-gray-800 dark:text-white",children:r.assignedTo||"Non assignée"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Priorité:"}),l.jsx("span",{className:`px-2 py-1 rounded text-xs ${gt(r.type)}`,children:r.type})]})]})]})]})]})]})}),g&&r&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-full mx-4",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4",children:"Assigner l'alerte"}),l.jsx("div",{className:"space-y-3",children:ar.map(mt=>l.jsx("button",{onClick:()=>{re(mt),$e()},className:"w-full text-left px-4 py-3 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg transition-colors",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(ea,{className:"w-5 h-5 text-gray-400"}),l.jsx("span",{className:"text-gray-800 dark:text-white",children:mt})]})},mt))}),l.jsx("div",{className:"flex space-x-3 mt-6",children:l.jsx("button",{onClick:()=>v(!1),className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Annuler"})})]})})]})}const q6=()=>{const t=["low","medium","high","critical"],e=["new","investigating","confirmed","resolved"],r=["Kinshasa","Nord-Kivu","Sud-Kivu","Katanga","Kasaï"],n=["Twitter","Facebook","WhatsApp","Telegram","News"];return{id:`alert_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:`Incident ${Math.random()>.5?"sécuritaire":"social"} détecté`,description:"Activité suspecte signalée par plusieurs sources dans la région",priority:t[Math.floor(Math.random()*t.length)],status:e[Math.floor(Math.random()*e.length)],severity:Math.floor(Math.random()*10)+1,location:r[Math.floor(Math.random()*r.length)],source:n[Math.floor(Math.random()*n.length)],createdAt:new Date().toISOString(),mentions:Math.floor(Math.random()*50)+1,verified:Math.random()>.7}},G6=()=>{const t=["Twitter","Facebook","WhatsApp","Telegram","Instagram"],e=["positive","negative","neutral"],r=["Kinshasa","Nord-Kivu","Sud-Kivu","Katanga","Kasaï"];return{id:`post_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,content:"Nouveau contenu social détecté avec impact potentiel sur la situation",platform:t[Math.floor(Math.random()*t.length)],author:`@user_${Math.random().toString(36).substr(2,6)}`,sentiment:e[Math.floor(Math.random()*e.length)],engagement:Math.floor(Math.random()*1e3),reach:Math.floor(Math.random()*1e4),location:r[Math.floor(Math.random()*r.length)],timestamp:new Date().toISOString(),verified:Math.random()>.8}},W6=()=>{const t=["new_connection","influence_change","activity_spike","cluster_formation"],e=["person","organization","location","event"];return{id:`network_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:t[Math.floor(Math.random()*t.length)],nodeId:`node_${Math.random().toString(36).substr(2,9)}`,nodeType:e[Math.floor(Math.random()*e.length)],influence:Math.random()*100,change:(Math.random()-.5)*20,timestamp:new Date().toISOString()}};function $ae(t,e={}){const{enabled:r=!0,interval:n=5e3,maxUpdates:i=100,onUpdate:o,onError:u}=e,[a,p]=Y.useState([]),[g,v]=Y.useState(!1),[w,T]=Y.useState(null),[A,I]=Y.useState(0),P=Y.useRef(null),D=Y.useRef(0),{success:L,warning:O,error:$}=Gp(),{settings:G}=hU(),B=Y.useCallback(()=>{!r||!G.autoRefresh||(v(!0),I(0),P.current=setInterval(()=>{try{if(Math.random()<.3){const ce=Math.random()<.7?"create":Math.random()<.9?"update":"delete";let ne,re;switch(t){case"alerts":ne=q6(),re="AlertSystem";break;case"social":ne=G6(),re="SocialMonitor";break;case"network":ne=W6(),re="NetworkAnalyzer";break;case"all":default:const ae=["alerts","social","network"];switch(ae[Math.floor(Math.random()*ae.length)]){case"alerts":ne=q6(),re="AlertSystem";break;case"social":ne=G6(),re="SocialMonitor";break;case"network":ne=W6(),re="NetworkAnalyzer";break}}const oe={id:`update_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:ce,data:ne,timestamp:new Date,source:re};p(ae=>[oe,...ae].slice(0,i)),T(new Date),D.current++,o&&o(oe),ce==="create"&&ne.priority==="critical"&&O("Alerte Critique",`Nouvelle alerte de priorité critique détectée: ${ne.title}`,{duration:1e4})}}catch(ce){const ne=ce;I(re=>re+1),u&&u(ne)}},n))},[r,n,i,o,u,t,G.autoRefresh]),J=Y.useCallback(()=>{P.current&&(clearInterval(P.current),P.current=null),v(!1)},[]);Y.useEffect(()=>(r&&G.autoRefresh?B():J(),()=>{J()}),[r,B,J,G.autoRefresh]);const W=Y.useCallback(()=>{P.current&&clearInterval(P.current),B()},[B]),H=Y.useCallback(()=>{p([]),D.current=0},[]),V=Y.useCallback(ce=>a.filter(ne=>ne.type===ce),[a]),se=Y.useCallback((ce=5)=>{const ne=new Date(Date.now()-ce*60*1e3);return a.filter(re=>re.timestamp>ne)},[a]),K={isConnected:g,lastUpdateTime:w,errorCount:A,updateCount:D.current,averageInterval:w?Date.now()-w.getTime():null};return{updates:a,isConnected:g,lastUpdateTime:w,errorCount:A,updateCount:D.current,connectionHealth:K,connect:B,disconnect:J,refresh:W,clearUpdates:H,getUpdatesByType:V,getRecentUpdates:se,hasRecentUpdates:se(1).length>0,criticalUpdates:a.filter(ce=>{var ne;return((ne=ce.data)==null?void 0:ne.priority)==="critical"}),newUpdatesCount:V("create").length,isHealthy:A<5&&g}}function Fae({isOpen:t,onClose:e}){var $,G,B,J,W,H,V,se,K,ce,ne,re,oe,ae,xe,ye,Se,be,Ce,$e,Ye,jt,Me,St,Ct,Ft,gt,Zt,Tt,ot,ar,mt,Lt,dr,Gr,qr,ln,Ui,ht,Jt,tr,zr,yr,In,Cr,hn,fs,ps,Os,Do,va,qa,ms,Ga,oo,_l,De,pe;const{settings:r,updateSettings:n,resetSettings:i,exportSettings:o,importSettings:u}=FI(),{success:a,error:p}=Gp(),[g,v]=Y.useState("dashboard"),[w,T]=Y.useState(!1),A=[{id:"dashboard",label:"Tableau de Bord",icon:Zie},{id:"notifications",label:"Notifications",icon:Jv},{id:"map",label:"Carte",icon:OT},{id:"data",label:"Données",icon:Gc},{id:"privacy",label:"Confidentialité",icon:gl},{id:"advanced",label:"Avancé",icon:DU}],I=(le,Ne)=>{n(le,Ne),T(!0)},P=()=>{try{const le=o(),Ne=new Blob([le],{type:"application/json"}),ze=URL.createObjectURL(Ne),Ge=document.createElement("a");Ge.href=ze,Ge.download=`sentinel_settings_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(Ge),Ge.click(),document.body.removeChild(Ge),URL.revokeObjectURL(ze),a("Paramètres exportés","Les paramètres ont été exportés avec succès")}catch{p("Erreur d'exportation","Impossible d'exporter les paramètres")}},D=le=>{var Ge;const Ne=(Ge=le.target.files)==null?void 0:Ge[0];if(!Ne)return;const ze=new FileReader;ze.onload=Ze=>{var Xe;try{const We=(Xe=Ze.target)==null?void 0:Xe.result;u(We)?(a("Paramètres importés","Les paramètres ont été importés avec succès"),T(!1)):p("Erreur d'importation","Le fichier de paramètres n'est pas valide")}catch{p("Erreur d'importation","Impossible de lire le fichier de paramètres")}},ze.readAsText(Ne),le.target.value=""},L=()=>{window.confirm("Êtes-vous sûr de vouloir réinitialiser tous les paramètres ?")&&(i(),T(!1),a("Paramètres réinitialisés","Tous les paramètres ont été remis aux valeurs par défaut"))},O=()=>{T(!1),a("Paramètres sauvegardés","Vos modifications ont été sauvegardées")};return l.jsxs(rM,{isOpen:t,onClose:e,title:"Paramètres",size:"xl",children:[l.jsxs("div",{className:"flex h-[70vh]",children:[l.jsxs("div",{className:"w-64 border-r border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[l.jsx("div",{className:"p-4",children:l.jsx("nav",{className:"space-y-1",children:A.map(le=>{const Ne=le.icon;return l.jsxs("button",{onClick:()=>v(le.id),className:`w-full flex items-center space-x-3 px-3 py-2 text-left rounded-lg transition-colors ${g===le.id?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[l.jsx(Ne,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:le.label})]},le.id)})})}),l.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 space-y-2",children:[l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs("button",{onClick:P,className:"flex-1 flex items-center justify-center space-x-2 px-3 py-2 text-sm bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:[l.jsx(Co,{className:"w-4 h-4"}),l.jsx("span",{children:"Exporter"})]}),l.jsxs("label",{className:"flex-1 flex items-center justify-center space-x-2 px-3 py-2 text-sm bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors cursor-pointer",children:[l.jsx(uae,{className:"w-4 h-4"}),l.jsx("span",{children:"Importer"}),l.jsx("input",{type:"file",accept:".json",onChange:D,className:"hidden"})]})]}),l.jsxs("button",{onClick:L,className:"w-full flex items-center justify-center space-x-2 px-3 py-2 text-sm bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded hover:bg-red-200 dark:hover:bg-red-800/30 transition-colors",children:[l.jsx(JI,{className:"w-4 h-4"}),l.jsx("span",{children:"Réinitialiser"})]})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[g==="dashboard"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Tableau de Bord"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Actualisation automatique"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Actualiser les données automatiquement"})]}),l.jsx("button",{onClick:()=>I("dashboard",{autoRefresh:!r.dashboard.autoRefresh}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r.dashboard.autoRefresh?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.dashboard.autoRefresh?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Intervalle d'actualisation (secondes)"}),l.jsxs("select",{value:r.dashboard.refreshInterval,onChange:le=>I("dashboard",{refreshInterval:Number(le.target.value)}),disabled:!r.dashboard.autoRefresh,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white disabled:opacity-50",children:[l.jsx("option",{value:30,children:"30 secondes"}),l.jsx("option",{value:60,children:"1 minute"}),l.jsx("option",{value:300,children:"5 minutes"}),l.jsx("option",{value:600,children:"10 minutes"}),l.jsx("option",{value:1800,children:"30 minutes"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Vue par défaut"}),l.jsxs("select",{value:r.dashboard.defaultView,onChange:le=>I("dashboard",{defaultView:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"strategic",children:"Tableau Stratégique"}),l.jsx("option",{value:"analytics",children:"Analyse Intelligence"}),l.jsx("option",{value:"opinion",children:"Analyse d'Opinion"}),l.jsx("option",{value:"timeline",children:"Timeline & Tendances"}),l.jsx("option",{value:"network",children:"Analyse Réseau"}),l.jsx("option",{value:"rawdata",children:"Données Brutes"}),l.jsx("option",{value:"alerts",children:"Centre d'Alertes"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mode compact"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Interface plus condensée"})]}),l.jsx("button",{onClick:()=>I("dashboard",{compactMode:!r.dashboard.compactMode}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r.dashboard.compactMode?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.dashboard.compactMode?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Afficher les métriques"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Afficher les indicateurs de performance"})]}),l.jsx("button",{onClick:()=>I("dashboard",{showMetrics:!r.dashboard.showMetrics}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r.dashboard.showMetrics?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.dashboard.showMetrics?"translate-x-6":"translate-x-1"}`})})]})]})]})}),g==="notifications"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Notifications"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Activer les notifications"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Recevoir des notifications système"})]}),l.jsx("button",{onClick:()=>I("notifications",{enabled:!r.notifications.enabled}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r.notifications.enabled?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.notifications.enabled?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[r.notifications.sound?l.jsx(hae,{className:"w-4 h-4"}):l.jsx(fae,{className:"w-4 h-4"}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Sons de notification"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Émettre un son pour les notifications"})]})]}),l.jsx("button",{onClick:()=>I("notifications",{sound:!r.notifications.sound}),disabled:!r.notifications.enabled,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors disabled:opacity-50 ${r.notifications.sound?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.notifications.sound?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Notifications bureau"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Afficher les notifications système"})]}),l.jsx("button",{onClick:()=>I("notifications",{desktop:!r.notifications.desktop}),disabled:!r.notifications.enabled,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors disabled:opacity-50 ${r.notifications.desktop?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.notifications.desktop?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Niveaux de sévérité"}),l.jsx("div",{className:"space-y-2",children:["critical","high","medium","low"].map(le=>l.jsxs("label",{className:"flex items-center space-x-3",children:[l.jsx("input",{type:"checkbox",checked:r.notifications.severity.includes(le),onChange:Ne=>{const ze=Ne.target.checked?[...r.notifications.severity,le]:r.notifications.severity.filter(Ge=>Ge!==le);I("notifications",{severity:ze})},disabled:!r.notifications.enabled,className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500 disabled:opacity-50"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 capitalize",children:le==="critical"?"Critique":le==="high"?"Élevé":le==="medium"?"Moyen":"Faible"})]},le))})]})]})]})}),g==="map"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Paramètres de la Carte"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Style de carte"}),l.jsxs("select",{value:(($=r.map)==null?void 0:$.basemap)||"satellite",onChange:le=>I("map",{basemap:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"satellite",children:"Satellite"}),l.jsx("option",{value:"streets",children:"Rues"}),l.jsx("option",{value:"light",children:"Clair"}),l.jsx("option",{value:"dark",children:"Sombre"}),l.jsx("option",{value:"outdoors",children:"Extérieur"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Centre par défaut"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Latitude"}),l.jsx("input",{type:"number",step:"0.000001",value:((B=(G=r.map)==null?void 0:G.defaultCenter)==null?void 0:B[0])||-4.0383,onChange:le=>{var Ne,ze;return I("map",{defaultCenter:[parseFloat(le.target.value)||-4.0383,((ze=(Ne=r.map)==null?void 0:Ne.defaultCenter)==null?void 0:ze[1])||21.7587]})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"-4.0383"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Longitude"}),l.jsx("input",{type:"number",step:"0.000001",value:((W=(J=r.map)==null?void 0:J.defaultCenter)==null?void 0:W[1])||21.7587,onChange:le=>{var Ne,ze;return I("map",{defaultCenter:[((ze=(Ne=r.map)==null?void 0:Ne.defaultCenter)==null?void 0:ze[0])||-4.0383,parseFloat(le.target.value)||21.7587]})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"21.7587"})]})]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Coordonnées par défaut: Kinshasa, RDC"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Zoom par défaut: ",((H=r.map)==null?void 0:H.defaultZoom)||6]}),l.jsx("input",{type:"range",min:"1",max:"18",value:((V=r.map)==null?void 0:V.defaultZoom)||6,onChange:le=>I("map",{defaultZoom:parseInt(le.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"}),l.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[l.jsx("span",{children:"Pays"}),l.jsx("span",{children:"Région"}),l.jsx("span",{children:"Ville"}),l.jsx("span",{children:"Quartier"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Regroupement des marqueurs"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Grouper les marqueurs proches automatiquement"})]}),l.jsx("button",{onClick:()=>{var le;return I("map",{clusterMarkers:!((le=r.map)!=null&&le.clusterMarkers)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(se=r.map)!=null&&se.clusterMarkers?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(K=r.map)!=null&&K.clusterMarkers?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Carte de chaleur"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Afficher la densité d'activité par zones"})]}),l.jsx("button",{onClick:()=>{var le;return I("map",{showLabels:!((le=r.map)!=null&&le.showLabels)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(ce=r.map)!=null&&ce.showLabels?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(ne=r.map)!=null&&ne.showLabels?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mises à jour temps réel"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Actualiser la carte automatiquement"})]}),l.jsx("button",{onClick:()=>{var le;return I("dashboard",{autoRefresh:!((le=r.dashboard)!=null&&le.autoRefresh)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(re=r.dashboard)!=null&&re.autoRefresh?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(oe=r.dashboard)!=null&&oe.autoRefresh?"translate-x-6":"translate-x-1"}`})})]})]})]})}),g==="data"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Gestion des Données"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Rétention des données"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Durée de conservation des alertes"}),l.jsxs("select",{value:((ae=r.data)==null?void 0:ae.retentionPeriod)||365,onChange:le=>I("data",{retentionPeriod:parseInt(le.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:30,children:"30 jours"}),l.jsx("option",{value:90,children:"3 mois"}),l.jsx("option",{value:180,children:"6 mois"}),l.jsx("option",{value:365,children:"1 an"}),l.jsx("option",{value:730,children:"2 ans"}),l.jsx("option",{value:-1,children:"Illimitée"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Durée de conservation des données brutes"}),l.jsxs("select",{value:((xe=r.data)==null?void 0:xe.retentionPeriod)||90,onChange:le=>I("data",{retentionPeriod:parseInt(le.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:7,children:"7 jours"}),l.jsx("option",{value:30,children:"30 jours"}),l.jsx("option",{value:90,children:"3 mois"}),l.jsx("option",{value:180,children:"6 mois"}),l.jsx("option",{value:365,children:"1 an"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Durée de conservation des logs"}),l.jsxs("select",{value:((ye=r.data)==null?void 0:ye.retentionPeriod)||30,onChange:le=>I("data",{retentionPeriod:parseInt(le.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:7,children:"7 jours"}),l.jsx("option",{value:30,children:"30 jours"}),l.jsx("option",{value:90,children:"3 mois"}),l.jsx("option",{value:180,children:"6 mois"})]})]})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nettoyage automatique"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Supprimer automatiquement les anciennes données"})]}),l.jsx("button",{onClick:()=>{var le;return I("data",{autoExportEnabled:!((le=r.data)!=null&&le.autoExportEnabled)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(Se=r.data)!=null&&Se.autoExportEnabled?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(be=r.data)!=null&&be.autoExportEnabled?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Paramètres d'exportation"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Format d'export par défaut"}),l.jsxs("select",{value:((Ce=r.data)==null?void 0:Ce.exportFormat)||"csv",onChange:le=>I("data",{exportFormat:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"csv",children:"CSV"}),l.jsx("option",{value:"json",children:"JSON"}),l.jsx("option",{value:"xlsx",children:"Excel"}),l.jsx("option",{value:"pdf",children:"PDF"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Inclure les métadonnées"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Ajouter timestamp et info système aux exports"})]}),l.jsx("button",{onClick:()=>{var le;return I("data",{includeMetadata:!((le=r.data)!=null&&le.includeMetadata)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${($e=r.data)!=null&&$e.includeMetadata?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(Ye=r.data)!=null&&Ye.includeMetadata?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Compression automatique"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Compresser les gros fichiers d'export"})]}),l.jsx("button",{onClick:()=>{var le;return I("data",{compression:!((le=r.data)!=null&&le.compression)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(jt=r.data)!=null&&jt.compression?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(Me=r.data)!=null&&Me.compression?"translate-x-6":"translate-x-1"}`})})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Cache et performance"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Durée de cache: ",((St=r.data)==null?void 0:St.cacheTimeout)||300,"s"]}),l.jsx("input",{type:"range",min:"60",max:"3600",step:"60",value:((Ct=r.data)==null?void 0:Ct.cacheTimeout)||300,onChange:le=>I("data",{cacheTimeout:parseInt(le.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"}),l.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[l.jsx("span",{children:"1min"}),l.jsx("span",{children:"30min"}),l.jsx("span",{children:"1h"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Préchargement des données"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Charger les données en arrière-plan"})]}),l.jsx("button",{onClick:()=>{var le;return I("data",{preloading:!((le=r.data)!=null&&le.preloading)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(Ft=r.data)!=null&&Ft.preloading?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(gt=r.data)!=null&&gt.preloading?"translate-x-6":"translate-x-1"}`})})]})]})]})]})]})}),g==="privacy"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Confidentialité et Sécurité"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Anonymisation des données"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Anonymiser les données personnelles"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Masquer automatiquement les informations sensibles"})]}),l.jsx("button",{onClick:()=>{var le;return I("privacy",{anonymizePersonalData:!((le=r.privacy)!=null&&le.anonymizePersonalData)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(Zt=r.privacy)!=null&&Zt.anonymizePersonalData?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(Tt=r.privacy)!=null&&Tt.anonymizePersonalData?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Masquer les localisation précises"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Arrondir les coordonnées géographiques"})]}),l.jsx("button",{onClick:()=>{var le;return I("privacy",{obfuscateLocations:!((le=r.privacy)!=null&&le.obfuscateLocations)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(ot=r.privacy)!=null&&ot.obfuscateLocations?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(ar=r.privacy)!=null&&ar.obfuscateLocations?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Chiffrement des exports"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Chiffrer automatiquement les fichiers exportés"})]}),l.jsx("button",{onClick:()=>{var le;return I("privacy",{encryptExports:!((le=r.privacy)!=null&&le.encryptExports)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(mt=r.privacy)!=null&&mt.encryptExports?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(Lt=r.privacy)!=null&&Lt.encryptExports?"translate-x-6":"translate-x-1"}`})})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Contrôle d'accès"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Authentification à deux facteurs"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Activer 2FA pour plus de sécurité"})]}),l.jsx("button",{onClick:()=>{var le;return I("privacy",{twoFactorAuth:!((le=r.privacy)!=null&&le.twoFactorAuth)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(dr=r.privacy)!=null&&dr.twoFactorAuth?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(Gr=r.privacy)!=null&&Gr.twoFactorAuth?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Durée de session (minutes)"}),l.jsxs("select",{value:((qr=r.privacy)==null?void 0:qr.sessionTimeout)||480,onChange:le=>I("privacy",{sessionTimeout:parseInt(le.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:60,children:"1 heure"}),l.jsx("option",{value:240,children:"4 heures"}),l.jsx("option",{value:480,children:"8 heures"}),l.jsx("option",{value:720,children:"12 heures"}),l.jsx("option",{value:1440,children:"24 heures"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Connexions simultanées multiples"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Autoriser plusieurs sessions actives"})]}),l.jsx("button",{onClick:()=>{var le;return I("privacy",{allowMultipleSessions:!((le=r.privacy)!=null&&le.allowMultipleSessions)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(ln=r.privacy)!=null&&ln.allowMultipleSessions?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(Ui=r.privacy)!=null&&Ui.allowMultipleSessions?"translate-x-6":"translate-x-1"}`})})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Audit et traçabilité"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Journal d'audit détaillé"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Enregistrer toutes les actions utilisateur"})]}),l.jsx("button",{onClick:()=>{var le;return I("privacy",{detailedAuditLog:!((le=r.privacy)!=null&&le.detailedAuditLog)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(ht=r.privacy)!=null&&ht.detailedAuditLog?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(Jt=r.privacy)!=null&&Jt.detailedAuditLog?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Alertes de sécurité"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Notifier les activités suspectes"})]}),l.jsx("button",{onClick:()=>{var le;return I("privacy",{securityAlerts:!((le=r.privacy)!=null&&le.securityAlerts)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(tr=r.privacy)!=null&&tr.securityAlerts?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(zr=r.privacy)!=null&&zr.securityAlerts?"translate-x-6":"translate-x-1"}`})})]})]})]})]})]})}),g==="advanced"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Paramètres Avancés"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Performance et optimisation"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Limite de résultats par page"}),l.jsxs("select",{value:((yr=r.advanced)==null?void 0:yr.pageSize)||50,onChange:le=>I("advanced",{pageSize:parseInt(le.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:25,children:"25"}),l.jsx("option",{value:50,children:"50"}),l.jsx("option",{value:100,children:"100"}),l.jsx("option",{value:200,children:"200"}),l.jsx("option",{value:500,children:"500"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Rendu différé"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Optimiser l'affichage des grandes listes"})]}),l.jsx("button",{onClick:()=>{var le;return I("advanced",{lazyLoading:!((le=r.advanced)!=null&&le.lazyLoading)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(In=r.advanced)!=null&&In.lazyLoading?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(Cr=r.advanced)!=null&&Cr.lazyLoading?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mise en cache agressive"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Cache plus long pour de meilleures performances"})]}),l.jsx("button",{onClick:()=>{var le;return I("advanced",{aggressiveCaching:!((le=r.advanced)!=null&&le.aggressiveCaching)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(hn=r.advanced)!=null&&hn.aggressiveCaching?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(fs=r.advanced)!=null&&fs.aggressiveCaching?"translate-x-6":"translate-x-1"}`})})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Options développeur"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mode debug"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Afficher les logs détaillés dans la console"})]}),l.jsx("button",{onClick:()=>{var le;return I("advanced",{debugMode:!((le=r.advanced)!=null&&le.debugMode)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(ps=r.advanced)!=null&&ps.debugMode?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(Os=r.advanced)!=null&&Os.debugMode?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"API de développement"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Activer l'accès aux endpoints de dev"})]}),l.jsx("button",{onClick:()=>{var le;return I("advanced",{developerAPI:!((le=r.advanced)!=null&&le.developerAPI)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(Do=r.advanced)!=null&&Do.developerAPI?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(va=r.advanced)!=null&&va.developerAPI?"translate-x-6":"translate-x-1"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Fonctionnalités expérimentales"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Activer les nouvelles fonctionnalités en test"})]}),l.jsx("button",{onClick:()=>{var le;return I("advanced",{experimentalFeatures:!((le=r.advanced)!=null&&le.experimentalFeatures)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(qa=r.advanced)!=null&&qa.experimentalFeatures?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(ms=r.advanced)!=null&&ms.experimentalFeatures?"translate-x-6":"translate-x-1"}`})})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Configuration API"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Timeout des requêtes (secondes)"}),l.jsx("input",{type:"number",min:"5",max:"300",value:((Ga=r.advanced)==null?void 0:Ga.apiTimeout)||30,onChange:le=>I("advanced",{apiTimeout:parseInt(le.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nombre de tentatives max"}),l.jsxs("select",{value:((oo=r.advanced)==null?void 0:oo.maxRetries)||3,onChange:le=>I("advanced",{maxRetries:parseInt(le.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:1,children:"1"}),l.jsx("option",{value:2,children:"2"}),l.jsx("option",{value:3,children:"3"}),l.jsx("option",{value:5,children:"5"}),l.jsx("option",{value:10,children:"10"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Compression des réponses"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Activer la compression GZIP/Brotli"})]}),l.jsx("button",{onClick:()=>{var le;return I("advanced",{compressionEnabled:!((le=r.advanced)!=null&&le.compressionEnabled)})},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(_l=r.advanced)!=null&&_l.compressionEnabled?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(De=r.advanced)!=null&&De.compressionEnabled?"translate-x-6":"translate-x-1"}`})})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-md font-medium text-gray-900 dark:text-white mb-3",children:"Configuration personnalisée"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Configuration JSON personnalisée"}),l.jsx("textarea",{value:((pe=r.advanced)==null?void 0:pe.customConfig)||"{}",onChange:le=>I("advanced",{customConfig:le.target.value}),rows:6,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm",placeholder:'{\\n  "customSetting": "value",\\n  "anotherSetting": true\\n}'}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Configuration JSON pour des paramètres avancés spécifiques"})]})]})]})]})})]})})]}),w&&l.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 px-6 py-4 bg-gray-50 dark:bg-gray-800/50",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-amber-600 dark:text-amber-400",children:[l.jsx(nu,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm",children:"Vous avez des modifications non sauvegardées"})]}),l.jsxs("button",{onClick:O,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:[l.jsx(rae,{className:"w-4 h-4"}),l.jsx("span",{children:"Sauvegarder"})]})]})})]})}function Bae({isOpen:t,onClose:e,onSearch:r,placeholder:n="Rechercher dans toutes les données...",filters:i=[],recentSearches:o=[],onSaveSearch:u,savedSearches:a=[]}){const[p,g]=Y.useState(""),[v,w]=Y.useState({}),[T,A]=Y.useState([]),[I,P]=Y.useState(!1),[D,L]=Y.useState(!1),[O,$]=Y.useState(!1),[G,B]=Y.useState("");Y.useEffect(()=>{const oe={};i.forEach(ae=>{ae.value!==void 0&&(oe[ae.key]=ae.value)}),w(oe)},[i]),Y.useEffect(()=>{if(p.length>=2){const oe=setTimeout(()=>{J()},300);return()=>clearTimeout(oe)}else A([])},[p,v]);const J=async()=>{if(!(p.length<2)){P(!0);try{const oe=await r(p,v);A(oe)}catch(oe){console.error("Search failed:",oe),A([])}finally{P(!1)}}},W=(oe,ae)=>{w(xe=>({...xe,[oe]:ae}))},H=()=>{w({})},V=()=>{u&&G.trim()&&p.trim()&&(u(p,v,G.trim()),B(""),$(!1))},se=oe=>{g(oe.query),w(oe.filters)},K=Object.values(v).filter(oe=>oe!==void 0&&oe!==""&&(Array.isArray(oe)?oe.length>0:!0)).length,ce=Y.useMemo(()=>{const oe={};return T.forEach(ae=>{oe[ae.type]||(oe[ae.type]=[]),oe[ae.type].push(ae)}),oe},[T]),ne={alert:ga,person:RU,location:od,event:ZI,content:qp,organization:oae},re={alert:"Alertes",person:"Personnes",location:"Lieux",event:"Événements",content:"Contenu",organization:"Organisations"};return l.jsxs(rM,{isOpen:t,onClose:e,title:"Recherche Avancée",size:"xl",children:[l.jsxs("div",{className:"flex flex-col h-[70vh]",children:[l.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),l.jsx("input",{type:"text",value:p,onChange:oe=>g(oe.target.value),placeholder:n,className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0}),I&&l.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]}),l.jsxs("button",{onClick:()=>L(!D),className:`flex items-center space-x-2 px-4 py-3 rounded-lg border transition-colors ${D||K>0?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-600 dark:text-blue-400":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-600"}`,children:[l.jsx(sb,{className:"w-4 h-4"}),l.jsx("span",{children:"Filtres"}),K>0&&l.jsx("span",{className:"bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:K})]}),u&&p&&l.jsx("button",{onClick:()=>$(!0),className:"px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Sauvegarder"})]}),(o.length>0||a.length>0)&&!p&&l.jsxs("div",{className:"mt-4 space-y-3",children:[o.length>0&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Recherches récentes"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:o.slice(0,5).map((oe,ae)=>l.jsx("button",{onClick:()=>g(oe),className:"px-3 py-1 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:oe},ae))})]}),a.length>0&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Recherches sauvegardées"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:a.slice(0,3).map((oe,ae)=>l.jsx("button",{onClick:()=>se(oe),className:"px-3 py-1 text-sm bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800/30 transition-colors",children:oe.name},ae))})]})]})]}),D&&l.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Filtres avancés"}),K>0&&l.jsx("button",{onClick:H,className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300",children:"Effacer tout"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(oe=>l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:oe.label}),oe.type==="text"&&l.jsx("input",{type:"text",value:v[oe.key]||"",onChange:ae=>W(oe.key,ae.target.value),placeholder:oe.placeholder,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}),oe.type==="select"&&oe.options&&l.jsxs("select",{value:v[oe.key]||"",onChange:ae=>W(oe.key,ae.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"",children:"Tous"}),oe.options.map(ae=>l.jsxs("option",{value:ae.value,children:[ae.label," ",ae.count?`(${ae.count})`:""]},ae.value))]}),oe.type==="date"&&l.jsx("input",{type:"date",value:v[oe.key]||"",onChange:ae=>W(oe.key,ae.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"})]},oe.id))})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:p.length<2?l.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400 mt-8",children:[l.jsx(iu,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),l.jsx("p",{children:"Tapez au moins 2 caractères pour commencer la recherche"})]}):I?l.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400 mt-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),l.jsx("p",{children:"Recherche en cours..."})]}):T.length===0?l.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400 mt-8",children:[l.jsx(no,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),l.jsxs("p",{children:['Aucun résultat trouvé pour "',p,'"']})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[T.length," résultat",T.length>1?"s":""," trouvé",T.length>1?"s":""]}),Object.entries(ce).map(([oe,ae])=>{const xe=ne[oe],ye=re[oe];return l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[xe&&l.jsx(xe,{className:"w-4 h-4 text-gray-400"}),l.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:ye}),l.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",ae.length,")"]})]}),l.jsx("div",{className:"space-y-2",children:ae.map(Se=>l.jsx("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer transition-colors",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-1",children:Se.highlighted?l.jsx("span",{dangerouslySetInnerHTML:{__html:Se.title}}):Se.title}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:Se.highlighted?l.jsx("span",{dangerouslySetInnerHTML:{__html:Se.description}}):Se.description}),Object.keys(Se.metadata).length>0&&l.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(Se.metadata).slice(0,3).map(([be,Ce])=>l.jsxs("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 px-2 py-1 rounded",children:[be,": ",String(Ce)]},be))})]}),l.jsxs("div",{className:"text-xs text-gray-400 ml-4",children:[(Se.relevance*100).toFixed(0),"%"]})]})},Se.id))})]},oe)})]})})]}),O&&l.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-96",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Sauvegarder la recherche"}),l.jsx("input",{type:"text",value:G,onChange:oe=>B(oe.target.value),placeholder:"Nom de la recherche...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white mb-4",autoFocus:!0}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx("button",{onClick:()=>$(!1),className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"Annuler"}),l.jsx("button",{onClick:V,disabled:!G.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Sauvegarder"})]})]})})]})}function hC({keywords:t}){const[e,r]=Y.useState("strategic"),[n,i]=Y.useState("24h"),[o,u]=Y.useState(!0),[a,p]=Y.useState(new Date),[g,v]=Y.useState(!1),[w,T]=Y.useState(!1),[A,I]=Y.useState(!1);Y.useState([]);const{success:P,error:D,info:L}=Gp(),{settings:O,updateSettings:$}=hU(),G=$ae("all",{enabled:o}),B=[{id:"strategic",label:"Tableau Stratégique",icon:il,description:"Vue exécutive et KPIs critiques"},{id:"analytics",label:"Analyse Intelligence",icon:cc,description:"Analyses approfondies et insights"},{id:"opinion",label:"Analyse d'Opinion",icon:lf,description:"Analyse d'opinion par mots-clés"},{id:"timeline",label:"Timeline & Tendances",icon:ga,description:"Visualisation temporelle et tendances"},{id:"network",label:"Analyse Réseau",icon:Wc,description:"Relations et connections d'entités"},{id:"rawdata",label:"Données Brutes",icon:Gc,description:"Exploration des données collectées"},{id:"alerts",label:"Centre d'Alertes",icon:Jv,description:"Gestion et workflows des alertes"}],J=async()=>{try{p(new Date),L("Actualisation","Mise à jour des données en cours..."),await new Promise(ne=>setTimeout(ne,1500)),P("Données actualisées","Toutes les données ont été mises à jour avec succès")}catch{D("Erreur d'actualisation","Impossible de mettre à jour les données")}},W=async()=>{try{const ne={exportDate:new Date().toISOString(),activeTab:e,timeRange:n,settings:O,realTimeStats:{totalUpdates:G.updateCount,lastUpdate:G.lastUpdateTime,connectionHealth:G.connectionHealth},summary:{criticalAlerts:G.criticalUpdates.length,newUpdates:G.newUpdatesCount,systemHealth:G.isHealthy}},re=JSON.stringify(ne,null,2),oe=new Blob([re],{type:"application/json"}),ae=URL.createObjectURL(oe),xe=document.createElement("a");xe.href=ae,xe.download=`sentinel_dashboard_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(xe),xe.click(),document.body.removeChild(xe),URL.revokeObjectURL(ae),P("Export réussi","Dashboard exporté avec succès")}catch{D("Erreur d'export","Impossible d'exporter le dashboard")}},H=async(ne,re)=>[{id:"1",type:"alert",title:`Résultat pour "${ne}"`,description:"Description du résultat de recherche",metadata:{source:"system",timestamp:new Date().toISOString()},relevance:.95}],V=ne=>{switch(ne){case"refresh":J();break;case"export":W();break;case"search":T(!0);break;case"settings":v(!0);break;case"fullscreen":I(!A);break;default:L("Action",`Action "${ne}" exécutée`)}};Y.useEffect(()=>{if(o&&O.autoRefresh){const ne=setInterval(()=>{p(new Date),G.refresh()},O.refreshInterval*1e3);return()=>clearInterval(ne)}},[o,O.autoRefresh,O.refreshInterval,G]),Y.useEffect(()=>{G.hasRecentUpdates&&p(new Date)},[G.hasRecentUpdates]);const se=[{title:"Score Sécurité Nationale",value:73,change:-2,trend:"down",critical:!0,description:"Indice composite de sécurité (0-100)"},{title:"Volume Intelligence",value:"127.3K",change:15,trend:"up",critical:!1,description:"Sources analysées (24h)"},{title:"Alertes Critiques",value:23,change:8,trend:"up",critical:!0,description:"Nécessitent une action immédiate"},{title:"Couverture Territoriale",value:"94%",change:0,trend:"stable",critical:!1,description:"Provinces sous surveillance"}],K=()=>l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:se.map((ne,re)=>l.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-xl p-6 border-l-4 ${ne.critical?"border-red-500":"border-blue-500"} shadow-lg hover:shadow-xl transition-shadow`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"font-semibold text-gray-800 dark:text-white text-sm",children:ne.title}),l.jsx("div",{className:`p-2 rounded-lg ${ne.critical?"bg-red-100 dark:bg-red-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:ne.critical?l.jsx(oi,{className:"w-4 h-4 text-red-600 dark:text-red-400"}):l.jsx(ii,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})})]}),l.jsx("div",{className:"flex items-end justify-between",children:l.jsxs("div",{children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-1",children:ne.value}),l.jsxs("div",{className:`flex items-center text-sm ${ne.trend==="up"?"text-green-600":ne.trend==="down"?"text-red-600":"text-gray-500"}`,children:[ne.trend==="up"&&l.jsx(PU,{className:"w-4 h-4 mr-1"}),ne.trend==="down"&&l.jsx(CU,{className:"w-4 h-4 mr-1"}),ne.trend==="stable"&&l.jsx(uC,{className:"w-4 h-4 mr-1"}),ne.change!==0?`${ne.change>0?"+":""}${ne.change}%`:"Stable"]})]})}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3 border-t pt-2",children:ne.description})]},re))}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Flux d'Activité Temps Réel"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"En direct"})]})]}),l.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:Array.from({length:8},(ne,re)=>l.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${re%3===0?"bg-red-100 dark:bg-red-900/30":re%3===1?"bg-blue-100 dark:bg-blue-900/30":"bg-green-100 dark:bg-green-900/30"}`,children:re%3===0?l.jsx(gl,{className:"w-4 h-4 text-red-600 dark:text-red-400"}):re%3===1?l.jsx(ea,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}):l.jsx(Uh,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200",children:re%3===0?"Incident sécuritaire détecté dans le Nord-Kivu":re%3===1?"Pic d'activité sur les réseaux sociaux (élections)":"Nouvelle source d'intelligence activée (Katanga)"}),l.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Il y a ",Math.floor(Math.random()*30)+1," minutes"]})]})]},re))})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Niveau de Menace par Province"}),l.jsx("button",{onClick:()=>r("network"),className:"text-blue-600 dark:text-blue-400 hover:underline text-sm",children:"Voir carte complète"})]}),l.jsx("div",{className:"space-y-3",children:[{province:"Nord-Kivu",level:"critical",score:89},{province:"Sud-Kivu",level:"high",score:76},{province:"Kinshasa",level:"medium",score:54},{province:"Katanga",level:"medium",score:48},{province:"Kasaï",level:"low",score:32}].map((ne,re)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-3 h-3 rounded-full ${ne.level==="critical"?"bg-red-500":ne.level==="high"?"bg-orange-500":ne.level==="medium"?"bg-yellow-500":"bg-green-500"}`}),l.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:ne.province})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-20 bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:l.jsx("div",{className:`h-2 rounded-full ${ne.level==="critical"?"bg-red-500":ne.level==="high"?"bg-orange-500":ne.level==="medium"?"bg-yellow-500":"bg-green-500"}`,style:{width:`${ne.score}%`}})}),l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:ne.score})]})]},re))})]})]})]}),ce=()=>l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Analyse de Sentiment"}),l.jsx("div",{className:"space-y-4",children:[{sentiment:"Positif",value:34,color:"green"},{sentiment:"Neutre",value:48,color:"gray"},{sentiment:"Négatif",value:18,color:"red"}].map((ne,re)=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:ne.sentiment}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-24 bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:l.jsx("div",{className:`h-2 rounded-full bg-${ne.color}-500`,style:{width:`${ne.value}%`}})}),l.jsxs("span",{className:"text-sm font-bold text-gray-800 dark:text-white w-8",children:[ne.value,"%"]})]})]},re))})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Mots-clés Tendances"}),l.jsx("div",{className:"space-y-3",children:t.slice(0,5).map((ne,re)=>l.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded",children:[l.jsx("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:ne.term}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:ne.mentions}),l.jsx("div",{className:`px-2 py-1 rounded text-xs ${ne.status==="critical"?"bg-red-100 text-red-800":ne.status==="warning"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:ne.status})]})]},re))})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Distribution des Sources"}),l.jsx("div",{className:"space-y-3",children:[{source:"Twitter",count:45623,percentage:42},{source:"Facebook",count:31245,percentage:29},{source:"WhatsApp",count:18967,percentage:18},{source:"Telegram",count:7834,percentage:7},{source:"Autres",count:4231,percentage:4}].map((ne,re)=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:ne.source}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:ne.count.toLocaleString()}),l.jsx("div",{className:"w-16 bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:l.jsx("div",{className:"h-2 rounded-full bg-blue-500",style:{width:`${ne.percentage}%`}})}),l.jsxs("span",{className:"text-sm font-bold text-gray-800 dark:text-white w-8",children:[ne.percentage,"%"]})]})]},re))})]})]})});return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Centre de Commandement Intelligence"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Surveillance stratégique et analyse en temps réel"})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${G.isHealthy?"bg-green-500 animate-pulse":"bg-red-500"}`}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:G.isHealthy?"En ligne":"Hors ligne"}),G.newUpdatesCount>0&&l.jsx("span",{className:"bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:G.newUpdatesCount})]}),l.jsx("button",{onClick:()=>V("search"),className:"p-2 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"Recherche globale",children:l.jsx(iu,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>V("export"),className:"p-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-800/30 transition-colors",title:"Exporter le dashboard",children:l.jsx(Co,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>V("settings"),className:"p-2 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"Paramètres",children:l.jsx(V0,{className:"w-4 h-4"})}),l.jsxs("select",{value:n,onChange:ne=>i(ne.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"1h",children:"Dernière heure"}),l.jsx("option",{value:"24h",children:"Dernières 24h"}),l.jsx("option",{value:"7d",children:"7 derniers jours"}),l.jsx("option",{value:"30d",children:"30 derniers jours"})]}),l.jsxs("button",{onClick:()=>u(!o),className:`px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 ${o?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600"}`,title:o?"Désactiver l'actualisation automatique":"Activer l'actualisation automatique",children:[o?l.jsx(Ug,{className:"w-4 h-4"}):l.jsx(qg,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm hidden sm:inline",children:o?"Pause":"Auto"})]}),l.jsx("button",{onClick:()=>V("refresh"),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Actualiser maintenant",children:l.jsx(ro,{className:"w-4 h-4"})}),l.jsxs("button",{onClick:()=>{p(new Date),console.log("Refreshing data...")},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(ro,{className:"w-4 h-4 mr-2 inline"}),"Actualiser"]})]})]}),l.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:l.jsx("nav",{className:"flex space-x-8",children:B.map(ne=>{const re=ne.icon;return l.jsx("button",{onClick:()=>r(ne.id),className:`py-4 px-2 border-b-2 font-medium text-sm transition-colors ${e===ne.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(re,{className:"w-5 h-5"}),l.jsx("span",{children:ne.label})]})},ne.id)})})}),l.jsxs("div",{className:"min-h-96",children:[e==="strategic"&&K(),e==="analytics"&&ce(),e==="opinion"&&l.jsx(Eae,{}),e==="timeline"&&l.jsx(jae,{}),e==="network"&&l.jsx(Aae,{}),e==="rawdata"&&l.jsx(Wg,{}),e==="alerts"&&l.jsx($2,{})]}),l.jsx(Fae,{isOpen:g,onClose:()=>v(!1)}),l.jsx(Bae,{isOpen:w,onClose:()=>T(!1),onSearch:H,placeholder:"Rechercher dans toutes les données du dashboard...",filters:[{id:"type",type:"select",label:"Type",key:"type",options:[{value:"alert",label:"Alertes"},{value:"event",label:"Événements"},{value:"content",label:"Contenu"},{value:"person",label:"Personnes"}]},{id:"timeRange",type:"select",label:"Période",key:"timeRange",options:[{value:"1h",label:"Dernière heure"},{value:"24h",label:"Dernières 24h"},{value:"7d",label:"7 derniers jours"},{value:"30d",label:"30 derniers jours"}]}],recentSearches:["sécurité","élections","gouvernement"]})]})}function Vae({title:t,titleId:e,...r},n){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?Y.createElement("title",{id:e},t):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const Uae=Y.forwardRef(Vae),H6=Uae;function qae({title:t,titleId:e,...r},n){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?Y.createElement("title",{id:e},t):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const Gae=Y.forwardRef(qae),Wae=Gae;function Hae({title:t,titleId:e,...r},n){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":e},r),t?Y.createElement("title",{id:e},t):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Kae=Y.forwardRef(Hae),FU=Kae;function Zae({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:o="Confirmer",cancelText:u="Annuler",type:a="danger"}){if(!t)return null;const p=()=>{r(),e()},g={danger:"bg-red-600 hover:bg-red-700 text-white",warning:"bg-orange-600 hover:bg-orange-700 text-white",info:"bg-blue-600 hover:bg-blue-700 text-white"};return l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[l.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:e}),l.jsxs("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[l.jsxs("div",{className:"sm:flex sm:items-start",children:[l.jsx("div",{className:`mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full ${a==="danger"?"bg-red-100 dark:bg-red-900/30":a==="warning"?"bg-orange-100 dark:bg-orange-900/30":"bg-blue-100 dark:bg-blue-900/30"} sm:mx-0 sm:h-10 sm:w-10`,children:l.jsx(FU,{className:`h-6 w-6 ${a==="danger"?"text-red-600 dark:text-red-400":a==="warning"?"text-orange-600 dark:text-orange-400":"text-blue-600 dark:text-blue-400"}`})}),l.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left flex-1",children:[l.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white",children:n}),l.jsx("div",{className:"mt-2",children:l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i})})]})]}),l.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse space-y-2 sm:space-y-0 sm:space-x-reverse sm:space-x-3",children:[l.jsx("button",{type:"button",onClick:p,className:`w-full sm:w-auto px-4 py-2 text-sm font-medium rounded-md transition-colors ${g[a]} focus:outline-none focus:ring-2 focus:ring-offset-2 ${a==="danger"?"focus:ring-red-500":a==="warning"?"focus:ring-orange-500":"focus:ring-blue-500"}`,children:o}),l.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:u})]})]})]})})}function BU(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=BU(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Fr(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=BU(t))&&(n&&(n+=" "),n+=e);return n}var Xae=Array.isArray,so=Xae,Yae=typeof $c=="object"&&$c&&$c.Object===Object&&$c,VU=Yae,Jae=VU,Qae=typeof self=="object"&&self&&self.Object===Object&&self,ese=Jae||Qae||Function("return this")(),du=ese,tse=du,rse=tse.Symbol,cb=rse,K6=cb,UU=Object.prototype,nse=UU.hasOwnProperty,ise=UU.toString,Ex=K6?K6.toStringTag:void 0;function ase(t){var e=nse.call(t,Ex),r=t[Ex];try{t[Ex]=void 0;var n=!0}catch{}var i=ise.call(t);return n&&(e?t[Ex]=r:delete t[Ex]),i}var sse=ase,ose=Object.prototype,lse=ose.toString;function cse(t){return lse.call(t)}var use=cse,Z6=cb,dse=sse,hse=use,fse="[object Null]",pse="[object Undefined]",X6=Z6?Z6.toStringTag:void 0;function mse(t){return t==null?t===void 0?pse:fse:X6&&X6 in Object(t)?dse(t):hse(t)}var bd=mse;function gse(t){return t!=null&&typeof t=="object"}var wd=gse,yse=bd,xse=wd,vse="[object Symbol]";function _se(t){return typeof t=="symbol"||xse(t)&&yse(t)==vse}var U0=_se,bse=so,wse=U0,kse=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tse=/^\w*$/;function Sse(t,e){if(bse(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||wse(t)?!0:Tse.test(t)||!kse.test(t)||e!=null&&t in Object(e)}var nM=Sse;function Ese(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var cf=Ese;const q0=Pn(cf);var jse=bd,Ase=cf,Nse="[object AsyncFunction]",Cse="[object Function]",Pse="[object GeneratorFunction]",Ise="[object Proxy]";function Mse(t){if(!Ase(t))return!1;var e=jse(t);return e==Cse||e==Pse||e==Nse||e==Ise}var iM=Mse;const Tr=Pn(iM);var Dse=du,Ose=Dse["__core-js_shared__"],Rse=Ose,fA=Rse,Y6=function(){var t=/[^.]+$/.exec(fA&&fA.keys&&fA.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Lse(t){return!!Y6&&Y6 in t}var zse=Lse,$se=Function.prototype,Fse=$se.toString;function Bse(t){if(t!=null){try{return Fse.call(t)}catch{}try{return t+""}catch{}}return""}var qU=Bse,Vse=iM,Use=zse,qse=cf,Gse=qU,Wse=/[\\^$.*+?()[\]{}|]/g,Hse=/^\[object .+?Constructor\]$/,Kse=Function.prototype,Zse=Object.prototype,Xse=Kse.toString,Yse=Zse.hasOwnProperty,Jse=RegExp("^"+Xse.call(Yse).replace(Wse,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Qse(t){if(!qse(t)||Use(t))return!1;var e=Vse(t)?Jse:Hse;return e.test(Gse(t))}var eoe=Qse;function toe(t,e){return t==null?void 0:t[e]}var roe=toe,noe=eoe,ioe=roe;function aoe(t,e){var r=ioe(t,e);return noe(r)?r:void 0}var Wp=aoe,soe=Wp,ooe=soe(Object,"create"),zT=ooe,J6=zT;function loe(){this.__data__=J6?J6(null):{},this.size=0}var coe=loe;function uoe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var doe=uoe,hoe=zT,foe="__lodash_hash_undefined__",poe=Object.prototype,moe=poe.hasOwnProperty;function goe(t){var e=this.__data__;if(hoe){var r=e[t];return r===foe?void 0:r}return moe.call(e,t)?e[t]:void 0}var yoe=goe,xoe=zT,voe=Object.prototype,_oe=voe.hasOwnProperty;function boe(t){var e=this.__data__;return xoe?e[t]!==void 0:_oe.call(e,t)}var woe=boe,koe=zT,Toe="__lodash_hash_undefined__";function Soe(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=koe&&e===void 0?Toe:e,this}var Eoe=Soe,joe=coe,Aoe=doe,Noe=yoe,Coe=woe,Poe=Eoe;function G0(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}G0.prototype.clear=joe;G0.prototype.delete=Aoe;G0.prototype.get=Noe;G0.prototype.has=Coe;G0.prototype.set=Poe;var Ioe=G0;function Moe(){this.__data__=[],this.size=0}var Doe=Moe;function Ooe(t,e){return t===e||t!==t&&e!==e}var aM=Ooe,Roe=aM;function Loe(t,e){for(var r=t.length;r--;)if(Roe(t[r][0],e))return r;return-1}var $T=Loe,zoe=$T,$oe=Array.prototype,Foe=$oe.splice;function Boe(t){var e=this.__data__,r=zoe(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Foe.call(e,r,1),--this.size,!0}var Voe=Boe,Uoe=$T;function qoe(t){var e=this.__data__,r=Uoe(e,t);return r<0?void 0:e[r][1]}var Goe=qoe,Woe=$T;function Hoe(t){return Woe(this.__data__,t)>-1}var Koe=Hoe,Zoe=$T;function Xoe(t,e){var r=this.__data__,n=Zoe(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var Yoe=Xoe,Joe=Doe,Qoe=Voe,ele=Goe,tle=Koe,rle=Yoe;function W0(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}W0.prototype.clear=Joe;W0.prototype.delete=Qoe;W0.prototype.get=ele;W0.prototype.has=tle;W0.prototype.set=rle;var FT=W0,nle=Wp,ile=du,ale=nle(ile,"Map"),sM=ale,Q6=Ioe,sle=FT,ole=sM;function lle(){this.size=0,this.__data__={hash:new Q6,map:new(ole||sle),string:new Q6}}var cle=lle;function ule(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var dle=ule,hle=dle;function fle(t,e){var r=t.__data__;return hle(e)?r[typeof e=="string"?"string":"hash"]:r.map}var BT=fle,ple=BT;function mle(t){var e=ple(this,t).delete(t);return this.size-=e?1:0,e}var gle=mle,yle=BT;function xle(t){return yle(this,t).get(t)}var vle=xle,_le=BT;function ble(t){return _le(this,t).has(t)}var wle=ble,kle=BT;function Tle(t,e){var r=kle(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var Sle=Tle,Ele=cle,jle=gle,Ale=vle,Nle=wle,Cle=Sle;function H0(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}H0.prototype.clear=Ele;H0.prototype.delete=jle;H0.prototype.get=Ale;H0.prototype.has=Nle;H0.prototype.set=Cle;var oM=H0,GU=oM,Ple="Expected a function";function lM(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Ple);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var u=t.apply(this,n);return r.cache=o.set(i,u)||o,u};return r.cache=new(lM.Cache||GU),r}lM.Cache=GU;var WU=lM;const Ile=Pn(WU);var Mle=WU,Dle=500;function Ole(t){var e=Mle(t,function(n){return r.size===Dle&&r.clear(),n}),r=e.cache;return e}var Rle=Ole,Lle=Rle,zle=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$le=/\\(\\)?/g,Fle=Lle(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(zle,function(r,n,i,o){e.push(i?o.replace($le,"$1"):n||r)}),e}),Ble=Fle;function Vle(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var cM=Vle,eL=cb,Ule=cM,qle=so,Gle=U0,Wle=1/0,tL=eL?eL.prototype:void 0,rL=tL?tL.toString:void 0;function HU(t){if(typeof t=="string")return t;if(qle(t))return Ule(t,HU)+"";if(Gle(t))return rL?rL.call(t):"";var e=t+"";return e=="0"&&1/t==-Wle?"-0":e}var Hle=HU,Kle=Hle;function Zle(t){return t==null?"":Kle(t)}var KU=Zle,Xle=so,Yle=nM,Jle=Ble,Qle=KU;function ece(t,e){return Xle(t)?t:Yle(t,e)?[t]:Jle(Qle(t))}var ZU=ece,tce=U0,rce=1/0;function nce(t){if(typeof t=="string"||tce(t))return t;var e=t+"";return e=="0"&&1/t==-rce?"-0":e}var VT=nce,ice=ZU,ace=VT;function sce(t,e){e=ice(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[ace(e[r++])];return r&&r==n?t:void 0}var uM=sce,oce=uM;function lce(t,e,r){var n=t==null?void 0:oce(t,e);return n===void 0?r:n}var XU=lce;const jo=Pn(XU);function cce(t){return t==null}var uce=cce;const _r=Pn(uce);var dce=bd,hce=so,fce=wd,pce="[object String]";function mce(t){return typeof t=="string"||!hce(t)&&fce(t)&&dce(t)==pce}var gce=mce;const Dp=Pn(gce);var YU={exports:{}},On={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dM=Symbol.for("react.element"),hM=Symbol.for("react.portal"),UT=Symbol.for("react.fragment"),qT=Symbol.for("react.strict_mode"),GT=Symbol.for("react.profiler"),WT=Symbol.for("react.provider"),HT=Symbol.for("react.context"),yce=Symbol.for("react.server_context"),KT=Symbol.for("react.forward_ref"),ZT=Symbol.for("react.suspense"),XT=Symbol.for("react.suspense_list"),YT=Symbol.for("react.memo"),JT=Symbol.for("react.lazy"),xce=Symbol.for("react.offscreen"),JU;JU=Symbol.for("react.module.reference");function xl(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case dM:switch(t=t.type,t){case UT:case GT:case qT:case ZT:case XT:return t;default:switch(t=t&&t.$$typeof,t){case yce:case HT:case KT:case JT:case YT:case WT:return t;default:return e}}case hM:return e}}}On.ContextConsumer=HT;On.ContextProvider=WT;On.Element=dM;On.ForwardRef=KT;On.Fragment=UT;On.Lazy=JT;On.Memo=YT;On.Portal=hM;On.Profiler=GT;On.StrictMode=qT;On.Suspense=ZT;On.SuspenseList=XT;On.isAsyncMode=function(){return!1};On.isConcurrentMode=function(){return!1};On.isContextConsumer=function(t){return xl(t)===HT};On.isContextProvider=function(t){return xl(t)===WT};On.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===dM};On.isForwardRef=function(t){return xl(t)===KT};On.isFragment=function(t){return xl(t)===UT};On.isLazy=function(t){return xl(t)===JT};On.isMemo=function(t){return xl(t)===YT};On.isPortal=function(t){return xl(t)===hM};On.isProfiler=function(t){return xl(t)===GT};On.isStrictMode=function(t){return xl(t)===qT};On.isSuspense=function(t){return xl(t)===ZT};On.isSuspenseList=function(t){return xl(t)===XT};On.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===UT||t===GT||t===qT||t===ZT||t===XT||t===xce||typeof t=="object"&&t!==null&&(t.$$typeof===JT||t.$$typeof===YT||t.$$typeof===WT||t.$$typeof===HT||t.$$typeof===KT||t.$$typeof===JU||t.getModuleId!==void 0)};On.typeOf=xl;YU.exports=On;var vce=YU.exports,_ce=bd,bce=wd,wce="[object Number]";function kce(t){return typeof t=="number"||bce(t)&&_ce(t)==wce}var QU=kce;const Tce=Pn(QU);var Sce=QU;function Ece(t){return Sce(t)&&t!=+t}var jce=Ece;const K0=Pn(jce);var Es=function(e){return e===0?0:e>0?1:-1},hp=function(e){return Dp(e)&&e.indexOf("%")===e.length-1},Bt=function(e){return Tce(e)&&!K0(e)},Ace=function(e){return _r(e)},pa=function(e){return Bt(e)||Dp(e)},Nce=0,uf=function(e){var r=++Nce;return"".concat(e||"").concat(r)},js=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Bt(e)&&!Dp(e))return n;var o;if(hp(e)){var u=e.indexOf("%");o=r*parseFloat(e.slice(0,u))/100}else o=+e;return K0(o)&&(o=n),i&&o>r&&(o=r),o},mh=function(e){if(!e)return null;var r=Object.keys(e);return r&&r.length?e[r[0]]:null},Cce=function(e){if(!Array.isArray(e))return!1;for(var r=e.length,n={},i=0;i<r;i++)if(!n[e[i]])n[e[i]]=!0;else return!0;return!1},Ei=function(e,r){return Bt(e)&&Bt(r)?function(n){return e+n*(r-e)}:function(){return r}};function F2(t,e,r){return!t||!t.length?null:t.find(function(n){return n&&(typeof e=="function"?e(n):jo(n,e))===r})}var Pce=function(e){if(!e||!e.length)return null;for(var r=e.length,n=0,i=0,o=0,u=0,a=1/0,p=-1/0,g=0,v=0,w=0;w<r;w++)g=e[w].cx||0,v=e[w].cy||0,n+=g,i+=v,o+=g*v,u+=g*g,a=Math.min(a,g),p=Math.max(p,g);var T=r*u!==n*n?(r*o-n*i)/(r*u-n*n):0;return{xmin:a,xmax:p,a:T,b:(i-T*n)/r}},Ice=function(e,r){return Bt(e)&&Bt(r)?e-r:Dp(e)&&Dp(r)?e.localeCompare(r):e instanceof Date&&r instanceof Date?e.getTime()-r.getTime():String(e).localeCompare(String(r))};function Ng(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function fC(t){"@babel/helpers - typeof";return fC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fC(t)}var Mce=["viewBox","children"],Dce=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],nL=["points","pathLength"],pA={svg:Mce,polygon:nL,polyline:nL},fM=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],B2=function(e,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(Y.isValidElement(e)&&(n=e.props),!q0(n))return null;var i={};return Object.keys(n).forEach(function(o){fM.includes(o)&&(i[o]=r||function(u){return n[o](n,u)})}),i},Oce=function(e,r,n){return function(i){return e(r,n,i),null}},Gh=function(e,r,n){if(!q0(e)||fC(e)!=="object")return null;var i=null;return Object.keys(e).forEach(function(o){var u=e[o];fM.includes(o)&&typeof u=="function"&&(i||(i={}),i[o]=Oce(u,r,n))}),i},Rce=["children"],Lce=["children"];function iL(t,e){if(t==null)return{};var r=zce(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function zce(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function pC(t){"@babel/helpers - typeof";return pC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pC(t)}var aL={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Qu=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},sL=null,mA=null,pM=function t(e){if(e===sL&&Array.isArray(mA))return mA;var r=[];return Y.Children.forEach(e,function(n){_r(n)||(vce.isFragment(n)?r=r.concat(t(n.props.children)):r.push(n))}),mA=r,sL=e,r};function Ps(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(function(i){return Qu(i)}):n=[Qu(e)],pM(t).forEach(function(i){var o=jo(i,"type.displayName")||jo(i,"type.name");n.indexOf(o)!==-1&&r.push(i)}),r}function wo(t,e){var r=Ps(t,e);return r&&r[0]}var oL=function(e){if(!e||!e.props)return!1;var r=e.props,n=r.width,i=r.height;return!(!Bt(n)||n<=0||!Bt(i)||i<=0)},$ce=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Fce=function(e){return e&&e.type&&Dp(e.type)&&$ce.indexOf(e.type)>=0},eq=function(e){return e&&pC(e)==="object"&&"clipDot"in e},Bce=function(e,r,n,i){var o,u=(o=pA==null?void 0:pA[i])!==null&&o!==void 0?o:[];return r.startsWith("data-")||!Tr(e)&&(i&&u.includes(r)||Dce.includes(r))||n&&fM.includes(r)},fr=function(e,r,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(Y.isValidElement(e)&&(i=e.props),!q0(i))return null;var o={};return Object.keys(i).forEach(function(u){var a;Bce((a=i)===null||a===void 0?void 0:a[u],u,r,n)&&(o[u]=i[u])}),o},mC=function t(e,r){if(e===r)return!0;var n=Y.Children.count(e);if(n!==Y.Children.count(r))return!1;if(n===0)return!0;if(n===1)return lL(Array.isArray(e)?e[0]:e,Array.isArray(r)?r[0]:r);for(var i=0;i<n;i++){var o=e[i],u=r[i];if(Array.isArray(o)||Array.isArray(u)){if(!t(o,u))return!1}else if(!lL(o,u))return!1}return!0},lL=function(e,r){if(_r(e)&&_r(r))return!0;if(!_r(e)&&!_r(r)){var n=e.props||{},i=n.children,o=iL(n,Rce),u=r.props||{},a=u.children,p=iL(u,Lce);return i&&a?Ng(o,p)&&mC(i,a):!i&&!a?Ng(o,p):!1}return!1},cL=function(e,r){var n=[],i={};return pM(e).forEach(function(o,u){if(Fce(o))n.push(o);else if(o){var a=Qu(o.type),p=r[a]||{},g=p.handler,v=p.once;if(g&&(!v||!i[a])){var w=g(o,a,u);n.push(w),i[a]=!0}}}),n},Vce=function(e){var r=e&&e.type;return r&&aL[r]?aL[r]:null},Uce=function(e,r){return pM(r).indexOf(e)},qce=["children","width","height","viewBox","className","style","title","desc"];function gC(){return gC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gC.apply(this,arguments)}function Gce(t,e){if(t==null)return{};var r=Wce(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Wce(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function yC(t){var e=t.children,r=t.width,n=t.height,i=t.viewBox,o=t.className,u=t.style,a=t.title,p=t.desc,g=Gce(t,qce),v=i||{width:r,height:n,x:0,y:0},w=Fr("recharts-surface",o);return Le.createElement("svg",gC({},fr(g,!0,"svg"),{className:w,width:r,height:n,style:u,viewBox:"".concat(v.x," ").concat(v.y," ").concat(v.width," ").concat(v.height)}),Le.createElement("title",null,a),Le.createElement("desc",null,p),e)}var Hce=["children","className"];function xC(){return xC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xC.apply(this,arguments)}function Kce(t,e){if(t==null)return{};var r=Zce(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Zce(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var Ur=Le.forwardRef(function(t,e){var r=t.children,n=t.className,i=Kce(t,Hce),o=Fr("recharts-layer",n);return Le.createElement("g",xC({className:o},fr(i,!0),{ref:e}),r)}),ac=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o]};function Xce(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),r=r>i?i:r,r<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var o=Array(i);++n<i;)o[n]=t[n+e];return o}var Yce=Xce,Jce=Yce;function Qce(t,e,r){var n=t.length;return r=r===void 0?n:r,!e&&r>=n?t:Jce(t,e,r)}var eue=Qce,tue="\\ud800-\\udfff",rue="\\u0300-\\u036f",nue="\\ufe20-\\ufe2f",iue="\\u20d0-\\u20ff",aue=rue+nue+iue,sue="\\ufe0e\\ufe0f",oue="\\u200d",lue=RegExp("["+oue+tue+aue+sue+"]");function cue(t){return lue.test(t)}var tq=cue;function uue(t){return t.split("")}var due=uue,rq="\\ud800-\\udfff",hue="\\u0300-\\u036f",fue="\\ufe20-\\ufe2f",pue="\\u20d0-\\u20ff",mue=hue+fue+pue,gue="\\ufe0e\\ufe0f",yue="["+rq+"]",vC="["+mue+"]",_C="\\ud83c[\\udffb-\\udfff]",xue="(?:"+vC+"|"+_C+")",nq="[^"+rq+"]",iq="(?:\\ud83c[\\udde6-\\uddff]){2}",aq="[\\ud800-\\udbff][\\udc00-\\udfff]",vue="\\u200d",sq=xue+"?",oq="["+gue+"]?",_ue="(?:"+vue+"(?:"+[nq,iq,aq].join("|")+")"+oq+sq+")*",bue=oq+sq+_ue,wue="(?:"+[nq+vC+"?",vC,iq,aq,yue].join("|")+")",kue=RegExp(_C+"(?="+_C+")|"+wue+bue,"g");function Tue(t){return t.match(kue)||[]}var Sue=Tue,Eue=due,jue=tq,Aue=Sue;function Nue(t){return jue(t)?Aue(t):Eue(t)}var Cue=Nue,Pue=eue,Iue=tq,Mue=Cue,Due=KU;function Oue(t){return function(e){e=Due(e);var r=Iue(e)?Mue(e):void 0,n=r?r[0]:e.charAt(0),i=r?Pue(r,1).join(""):e.slice(1);return n[t]()+i}}var Rue=Oue,Lue=Rue,zue=Lue("toUpperCase"),$ue=zue;const QT=Pn($ue);function Kn(t){return function(){return t}}const lq=Math.cos,V2=Math.sin,hc=Math.sqrt,U2=Math.PI,eS=2*U2,bC=Math.PI,wC=2*bC,np=1e-6,Fue=wC-np;function cq(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function Bue(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return cq;const r=10**e;return function(n){this._+=n[0];for(let i=1,o=n.length;i<o;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class Vue{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?cq:Bue(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,o,u){this._append`C${+e},${+r},${+n},${+i},${this._x1=+o},${this._y1=+u}`}arcTo(e,r,n,i,o){if(e=+e,r=+r,n=+n,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let u=this._x1,a=this._y1,p=n-e,g=i-r,v=u-e,w=a-r,T=v*v+w*w;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(T>np)if(!(Math.abs(w*p-g*v)>np)||!o)this._append`L${this._x1=e},${this._y1=r}`;else{let A=n-u,I=i-a,P=p*p+g*g,D=A*A+I*I,L=Math.sqrt(P),O=Math.sqrt(T),$=o*Math.tan((bC-Math.acos((P+T-D)/(2*L*O)))/2),G=$/O,B=$/L;Math.abs(G-1)>np&&this._append`L${e+G*v},${r+G*w}`,this._append`A${o},${o},0,0,${+(w*A>v*I)},${this._x1=e+B*p},${this._y1=r+B*g}`}}arc(e,r,n,i,o,u){if(e=+e,r=+r,n=+n,u=!!u,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(i),p=n*Math.sin(i),g=e+a,v=r+p,w=1^u,T=u?i-o:o-i;this._x1===null?this._append`M${g},${v}`:(Math.abs(this._x1-g)>np||Math.abs(this._y1-v)>np)&&this._append`L${g},${v}`,n&&(T<0&&(T=T%wC+wC),T>Fue?this._append`A${n},${n},0,1,${w},${e-a},${r-p}A${n},${n},0,1,${w},${this._x1=g},${this._y1=v}`:T>np&&this._append`A${n},${n},0,${+(T>=bC)},${w},${this._x1=e+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function mM(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new Vue(e)}function gM(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function uq(t){this._context=t}uq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function tS(t){return new uq(t)}function dq(t){return t[0]}function hq(t){return t[1]}function yM(t,e){var r=Kn(!0),n=null,i=tS,o=null,u=mM(a);t=typeof t=="function"?t:t===void 0?dq:Kn(t),e=typeof e=="function"?e:e===void 0?hq:Kn(e);function a(p){var g,v=(p=gM(p)).length,w,T=!1,A;for(n==null&&(o=i(A=u())),g=0;g<=v;++g)!(g<v&&r(w=p[g],g,p))===T&&((T=!T)?o.lineStart():o.lineEnd()),T&&o.point(+t(w,g,p),+e(w,g,p));if(A)return o=null,A+""||null}return a.x=function(p){return arguments.length?(t=typeof p=="function"?p:Kn(+p),a):t},a.y=function(p){return arguments.length?(e=typeof p=="function"?p:Kn(+p),a):e},a.defined=function(p){return arguments.length?(r=typeof p=="function"?p:Kn(!!p),a):r},a.curve=function(p){return arguments.length?(i=p,n!=null&&(o=i(n)),a):i},a.context=function(p){return arguments.length?(p==null?n=o=null:o=i(n=p),a):n},a}function lw(t,e,r){var n=null,i=Kn(!0),o=null,u=tS,a=null,p=mM(g);t=typeof t=="function"?t:t===void 0?dq:Kn(+t),e=typeof e=="function"?e:Kn(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?hq:Kn(+r);function g(w){var T,A,I,P=(w=gM(w)).length,D,L=!1,O,$=new Array(P),G=new Array(P);for(o==null&&(a=u(O=p())),T=0;T<=P;++T){if(!(T<P&&i(D=w[T],T,w))===L)if(L=!L)A=T,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),I=T-1;I>=A;--I)a.point($[I],G[I]);a.lineEnd(),a.areaEnd()}L&&($[T]=+t(D,T,w),G[T]=+e(D,T,w),a.point(n?+n(D,T,w):$[T],r?+r(D,T,w):G[T]))}if(O)return a=null,O+""||null}function v(){return yM().defined(i).curve(u).context(o)}return g.x=function(w){return arguments.length?(t=typeof w=="function"?w:Kn(+w),n=null,g):t},g.x0=function(w){return arguments.length?(t=typeof w=="function"?w:Kn(+w),g):t},g.x1=function(w){return arguments.length?(n=w==null?null:typeof w=="function"?w:Kn(+w),g):n},g.y=function(w){return arguments.length?(e=typeof w=="function"?w:Kn(+w),r=null,g):e},g.y0=function(w){return arguments.length?(e=typeof w=="function"?w:Kn(+w),g):e},g.y1=function(w){return arguments.length?(r=w==null?null:typeof w=="function"?w:Kn(+w),g):r},g.lineX0=g.lineY0=function(){return v().x(t).y(e)},g.lineY1=function(){return v().x(t).y(r)},g.lineX1=function(){return v().x(n).y(e)},g.defined=function(w){return arguments.length?(i=typeof w=="function"?w:Kn(!!w),g):i},g.curve=function(w){return arguments.length?(u=w,o!=null&&(a=u(o)),g):u},g.context=function(w){return arguments.length?(w==null?o=a=null:a=u(o=w),g):o},g}class fq{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function Uue(t){return new fq(t,!0)}function que(t){return new fq(t,!1)}const xM={draw(t,e){const r=hc(e/U2);t.moveTo(r,0),t.arc(0,0,r,0,eS)}},Gue={draw(t,e){const r=hc(e/5)/2;t.moveTo(-3*r,-r),t.lineTo(-r,-r),t.lineTo(-r,-3*r),t.lineTo(r,-3*r),t.lineTo(r,-r),t.lineTo(3*r,-r),t.lineTo(3*r,r),t.lineTo(r,r),t.lineTo(r,3*r),t.lineTo(-r,3*r),t.lineTo(-r,r),t.lineTo(-3*r,r),t.closePath()}},pq=hc(1/3),Wue=pq*2,Hue={draw(t,e){const r=hc(e/Wue),n=r*pq;t.moveTo(0,-r),t.lineTo(n,0),t.lineTo(0,r),t.lineTo(-n,0),t.closePath()}},Kue={draw(t,e){const r=hc(e),n=-r/2;t.rect(n,n,r,r)}},Zue=.8908130915292852,mq=V2(U2/10)/V2(7*U2/10),Xue=V2(eS/10)*mq,Yue=-lq(eS/10)*mq,Jue={draw(t,e){const r=hc(e*Zue),n=Xue*r,i=Yue*r;t.moveTo(0,-r),t.lineTo(n,i);for(let o=1;o<5;++o){const u=eS*o/5,a=lq(u),p=V2(u);t.lineTo(p*r,-a*r),t.lineTo(a*n-p*i,p*n+a*i)}t.closePath()}},gA=hc(3),Que={draw(t,e){const r=-hc(e/(gA*3));t.moveTo(0,r*2),t.lineTo(-gA*r,-r),t.lineTo(gA*r,-r),t.closePath()}},Xo=-.5,Yo=hc(3)/2,kC=1/hc(12),ede=(kC/2+1)*3,tde={draw(t,e){const r=hc(e/ede),n=r/2,i=r*kC,o=n,u=r*kC+r,a=-o,p=u;t.moveTo(n,i),t.lineTo(o,u),t.lineTo(a,p),t.lineTo(Xo*n-Yo*i,Yo*n+Xo*i),t.lineTo(Xo*o-Yo*u,Yo*o+Xo*u),t.lineTo(Xo*a-Yo*p,Yo*a+Xo*p),t.lineTo(Xo*n+Yo*i,Xo*i-Yo*n),t.lineTo(Xo*o+Yo*u,Xo*u-Yo*o),t.lineTo(Xo*a+Yo*p,Xo*p-Yo*a),t.closePath()}};function rde(t,e){let r=null,n=mM(i);t=typeof t=="function"?t:Kn(t||xM),e=typeof e=="function"?e:Kn(e===void 0?64:+e);function i(){let o;if(r||(r=o=n()),t.apply(this,arguments).draw(r,+e.apply(this,arguments)),o)return r=null,o+""||null}return i.type=function(o){return arguments.length?(t=typeof o=="function"?o:Kn(o),i):t},i.size=function(o){return arguments.length?(e=typeof o=="function"?o:Kn(+o),i):e},i.context=function(o){return arguments.length?(r=o??null,i):r},i}function q2(){}function G2(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function gq(t){this._context=t}gq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:G2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:G2(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function nde(t){return new gq(t)}function yq(t){this._context=t}yq.prototype={areaStart:q2,areaEnd:q2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:G2(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function ide(t){return new yq(t)}function xq(t){this._context=t}xq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:G2(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function ade(t){return new xq(t)}function vq(t){this._context=t}vq.prototype={areaStart:q2,areaEnd:q2,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function sde(t){return new vq(t)}function uL(t){return t<0?-1:1}function dL(t,e,r){var n=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(n||i<0&&-0),u=(r-t._y1)/(i||n<0&&-0),a=(o*i+u*n)/(n+i);return(uL(o)+uL(u))*Math.min(Math.abs(o),Math.abs(u),.5*Math.abs(a))||0}function hL(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function yA(t,e,r){var n=t._x0,i=t._y0,o=t._x1,u=t._y1,a=(o-n)/3;t._context.bezierCurveTo(n+a,i+a*e,o-a,u-a*r,o,u)}function W2(t){this._context=t}W2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:yA(this,this._t0,hL(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,yA(this,hL(this,r=dL(this,t,e)),r);break;default:yA(this,this._t0,r=dL(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function _q(t){this._context=new bq(t)}(_q.prototype=Object.create(W2.prototype)).point=function(t,e){W2.prototype.point.call(this,e,t)};function bq(t){this._context=t}bq.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,o){this._context.bezierCurveTo(e,t,n,r,o,i)}};function wq(t){return new W2(t)}function ode(t){return new _q(t)}function kq(t){this._context=t}kq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=fL(t),i=fL(e),o=0,u=1;u<r;++o,++u)this._context.bezierCurveTo(n[0][o],i[0][o],n[1][o],i[1][o],t[u],e[u]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function fL(t){var e,r=t.length-1,n,i=new Array(r),o=new Array(r),u=new Array(r);for(i[0]=0,o[0]=2,u[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,u[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,u[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,u[e]-=n*u[e-1];for(i[r-1]=u[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(u[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function lde(t){return new kq(t)}function rS(t,e){this._context=t,this._t=e}rS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function cde(t){return new rS(t,.5)}function ude(t){return new rS(t,0)}function dde(t){return new rS(t,1)}function Hg(t,e){if((u=t.length)>1)for(var r=1,n,i,o=t[e[0]],u,a=o.length;r<u;++r)for(i=o,o=t[e[r]],n=0;n<a;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function TC(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function hde(t,e){return t[e]}function fde(t){const e=[];return e.key=t,e}function pde(){var t=Kn([]),e=TC,r=Hg,n=hde;function i(o){var u=Array.from(t.apply(this,arguments),fde),a,p=u.length,g=-1,v;for(const w of o)for(a=0,++g;a<p;++a)(u[a][g]=[0,+n(w,u[a].key,g,o)]).data=w;for(a=0,v=gM(e(u));a<p;++a)u[v[a]].index=a;return r(u,v),u}return i.keys=function(o){return arguments.length?(t=typeof o=="function"?o:Kn(Array.from(o)),i):t},i.value=function(o){return arguments.length?(n=typeof o=="function"?o:Kn(+o),i):n},i.order=function(o){return arguments.length?(e=o==null?TC:typeof o=="function"?o:Kn(Array.from(o)),i):e},i.offset=function(o){return arguments.length?(r=o??Hg,i):r},i}function mde(t,e){if((n=t.length)>0){for(var r,n,i=0,o=t[0].length,u;i<o;++i){for(u=r=0;r<n;++r)u+=t[r][i][1]||0;if(u)for(r=0;r<n;++r)t[r][i][1]/=u}Hg(t,e)}}function gde(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,o=n.length;r<o;++r){for(var u=0,a=0;u<i;++u)a+=t[u][r][1]||0;n[r][1]+=n[r][0]=-a/2}Hg(t,e)}}function yde(t,e){if(!(!((u=t.length)>0)||!((o=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,o,u;n<o;++n){for(var a=0,p=0,g=0;a<u;++a){for(var v=t[e[a]],w=v[n][1]||0,T=v[n-1][1]||0,A=(w-T)/2,I=0;I<a;++I){var P=t[e[I]],D=P[n][1]||0,L=P[n-1][1]||0;A+=D-L}p+=w,g+=A*w}i[n-1][1]+=i[n-1][0]=r,p&&(r-=g/p)}i[n-1][1]+=i[n-1][0]=r,Hg(t,e)}}function e_(t){"@babel/helpers - typeof";return e_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e_(t)}var xde=["type","size","sizeType"];function SC(){return SC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},SC.apply(this,arguments)}function pL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pL(Object(r),!0).forEach(function(n){vde(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vde(t,e,r){return e=_de(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _de(t){var e=bde(t,"string");return e_(e)=="symbol"?e:e+""}function bde(t,e){if(e_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(e_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wde(t,e){if(t==null)return{};var r=kde(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function kde(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var Tq={symbolCircle:xM,symbolCross:Gue,symbolDiamond:Hue,symbolSquare:Kue,symbolStar:Jue,symbolTriangle:Que,symbolWye:tde},Tde=Math.PI/180,Sde=function(e){var r="symbol".concat(QT(e));return Tq[r]||xM},Ede=function(e,r,n){if(r==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var i=18*Tde;return 1.25*e*e*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},jde=function(e,r){Tq["symbol".concat(QT(e))]=r},nS=function(e){var r=e.type,n=r===void 0?"circle":r,i=e.size,o=i===void 0?64:i,u=e.sizeType,a=u===void 0?"area":u,p=wde(e,xde),g=mL(mL({},p),{},{type:n,size:o,sizeType:a}),v=function(){var D=Sde(n),L=rde().type(D).size(Ede(o,a,n));return L()},w=g.className,T=g.cx,A=g.cy,I=fr(g,!0);return T===+T&&A===+A&&o===+o?Le.createElement("path",SC({},I,{className:Fr("recharts-symbols",w),transform:"translate(".concat(T,", ").concat(A,")"),d:v()})):null};nS.registerSymbol=jde;function Kg(t){"@babel/helpers - typeof";return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kg(t)}function EC(){return EC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},EC.apply(this,arguments)}function gL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ade(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gL(Object(r),!0).forEach(function(n){t_(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nde(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Eq(n.key),n)}}function Cde(t,e,r){return e&&yL(t.prototype,e),r&&yL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pde(t,e,r){return e=H2(e),Ide(t,Sq()?Reflect.construct(e,r||[],H2(t).constructor):e.apply(t,r))}function Ide(t,e){if(e&&(Kg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mde(t)}function Mde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sq=function(){return!!t})()}function H2(t){return H2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},H2(t)}function Dde(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jC(t,e)}function jC(t,e){return jC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jC(t,e)}function t_(t,e,r){return e=Eq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Eq(t){var e=Ode(t,"string");return Kg(e)=="symbol"?e:e+""}function Ode(t,e){if(Kg(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Jo=32,vM=function(t){function e(){return Nde(this,e),Pde(this,e,arguments)}return Dde(e,t),Cde(e,[{key:"renderIcon",value:function(n){var i=this.props.inactiveColor,o=Jo/2,u=Jo/6,a=Jo/3,p=n.inactive?i:n.color;if(n.type==="plainline")return Le.createElement("line",{strokeWidth:4,fill:"none",stroke:p,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:o,x2:Jo,y2:o,className:"recharts-legend-icon"});if(n.type==="line")return Le.createElement("path",{strokeWidth:4,fill:"none",stroke:p,d:"M0,".concat(o,"h").concat(a,`
            A`).concat(u,",").concat(u,",0,1,1,").concat(2*a,",").concat(o,`
            H`).concat(Jo,"M").concat(2*a,",").concat(o,`
            A`).concat(u,",").concat(u,",0,1,1,").concat(a,",").concat(o),className:"recharts-legend-icon"});if(n.type==="rect")return Le.createElement("path",{stroke:"none",fill:p,d:"M0,".concat(Jo/8,"h").concat(Jo,"v").concat(Jo*3/4,"h").concat(-Jo,"z"),className:"recharts-legend-icon"});if(Le.isValidElement(n.legendIcon)){var g=Ade({},n);return delete g.legendIcon,Le.cloneElement(n.legendIcon,g)}return Le.createElement(nS,{fill:p,cx:o,cy:o,size:Jo,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,i=this.props,o=i.payload,u=i.iconSize,a=i.layout,p=i.formatter,g=i.inactiveColor,v={x:0,y:0,width:Jo,height:Jo},w={display:a==="horizontal"?"inline-block":"block",marginRight:10},T={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(A,I){var P=A.formatter||p,D=Fr(t_(t_({"recharts-legend-item":!0},"legend-item-".concat(I),!0),"inactive",A.inactive));if(A.type==="none")return null;var L=Tr(A.value)?null:A.value;ac(!Tr(A.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var O=A.inactive?g:A.color;return Le.createElement("li",EC({className:D,style:w,key:"legend-item-".concat(I)},Gh(n.props,A,I)),Le.createElement(yC,{width:u,height:u,viewBox:v,style:T},n.renderIcon(A)),Le.createElement("span",{className:"recharts-legend-item-text",style:{color:O}},P?P(L,A,I):L))})}},{key:"render",value:function(){var n=this.props,i=n.payload,o=n.layout,u=n.align;if(!i||!i.length)return null;var a={padding:0,margin:0,textAlign:o==="horizontal"?u:"left"};return Le.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}])}(Y.PureComponent);t_(vM,"displayName","Legend");t_(vM,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Rde=FT;function Lde(){this.__data__=new Rde,this.size=0}var zde=Lde;function $de(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var Fde=$de;function Bde(t){return this.__data__.get(t)}var Vde=Bde;function Ude(t){return this.__data__.has(t)}var qde=Ude,Gde=FT,Wde=sM,Hde=oM,Kde=200;function Zde(t,e){var r=this.__data__;if(r instanceof Gde){var n=r.__data__;if(!Wde||n.length<Kde-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Hde(n)}return r.set(t,e),this.size=r.size,this}var Xde=Zde,Yde=FT,Jde=zde,Qde=Fde,ehe=Vde,the=qde,rhe=Xde;function Z0(t){var e=this.__data__=new Yde(t);this.size=e.size}Z0.prototype.clear=Jde;Z0.prototype.delete=Qde;Z0.prototype.get=ehe;Z0.prototype.has=the;Z0.prototype.set=rhe;var jq=Z0,nhe="__lodash_hash_undefined__";function ihe(t){return this.__data__.set(t,nhe),this}var ahe=ihe;function she(t){return this.__data__.has(t)}var ohe=she,lhe=oM,che=ahe,uhe=ohe;function K2(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new lhe;++e<r;)this.add(t[e])}K2.prototype.add=K2.prototype.push=che;K2.prototype.has=uhe;var Aq=K2;function dhe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var Nq=dhe;function hhe(t,e){return t.has(e)}var Cq=hhe,fhe=Aq,phe=Nq,mhe=Cq,ghe=1,yhe=2;function xhe(t,e,r,n,i,o){var u=r&ghe,a=t.length,p=e.length;if(a!=p&&!(u&&p>a))return!1;var g=o.get(t),v=o.get(e);if(g&&v)return g==e&&v==t;var w=-1,T=!0,A=r&yhe?new fhe:void 0;for(o.set(t,e),o.set(e,t);++w<a;){var I=t[w],P=e[w];if(n)var D=u?n(P,I,w,e,t,o):n(I,P,w,t,e,o);if(D!==void 0){if(D)continue;T=!1;break}if(A){if(!phe(e,function(L,O){if(!mhe(A,O)&&(I===L||i(I,L,r,n,o)))return A.push(O)})){T=!1;break}}else if(!(I===P||i(I,P,r,n,o))){T=!1;break}}return o.delete(t),o.delete(e),T}var Pq=xhe,vhe=du,_he=vhe.Uint8Array,bhe=_he;function whe(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}var khe=whe;function The(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var _M=The,xL=cb,vL=bhe,She=aM,Ehe=Pq,jhe=khe,Ahe=_M,Nhe=1,Che=2,Phe="[object Boolean]",Ihe="[object Date]",Mhe="[object Error]",Dhe="[object Map]",Ohe="[object Number]",Rhe="[object RegExp]",Lhe="[object Set]",zhe="[object String]",$he="[object Symbol]",Fhe="[object ArrayBuffer]",Bhe="[object DataView]",_L=xL?xL.prototype:void 0,xA=_L?_L.valueOf:void 0;function Vhe(t,e,r,n,i,o,u){switch(r){case Bhe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Fhe:return!(t.byteLength!=e.byteLength||!o(new vL(t),new vL(e)));case Phe:case Ihe:case Ohe:return She(+t,+e);case Mhe:return t.name==e.name&&t.message==e.message;case Rhe:case zhe:return t==e+"";case Dhe:var a=jhe;case Lhe:var p=n&Nhe;if(a||(a=Ahe),t.size!=e.size&&!p)return!1;var g=u.get(t);if(g)return g==e;n|=Che,u.set(t,e);var v=Ehe(a(t),a(e),n,i,o,u);return u.delete(t),v;case $he:if(xA)return xA.call(t)==xA.call(e)}return!1}var Uhe=Vhe;function qhe(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var Iq=qhe,Ghe=Iq,Whe=so;function Hhe(t,e,r){var n=e(t);return Whe(t)?n:Ghe(n,r(t))}var Khe=Hhe;function Zhe(t,e){for(var r=-1,n=t==null?0:t.length,i=0,o=[];++r<n;){var u=t[r];e(u,r,t)&&(o[i++]=u)}return o}var Xhe=Zhe;function Yhe(){return[]}var Jhe=Yhe,Qhe=Xhe,efe=Jhe,tfe=Object.prototype,rfe=tfe.propertyIsEnumerable,bL=Object.getOwnPropertySymbols,nfe=bL?function(t){return t==null?[]:(t=Object(t),Qhe(bL(t),function(e){return rfe.call(t,e)}))}:efe,ife=nfe;function afe(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var sfe=afe,ofe=bd,lfe=wd,cfe="[object Arguments]";function ufe(t){return lfe(t)&&ofe(t)==cfe}var dfe=ufe,wL=dfe,hfe=wd,Mq=Object.prototype,ffe=Mq.hasOwnProperty,pfe=Mq.propertyIsEnumerable,mfe=wL(function(){return arguments}())?wL:function(t){return hfe(t)&&ffe.call(t,"callee")&&!pfe.call(t,"callee")},bM=mfe,Z2={exports:{}};function gfe(){return!1}var yfe=gfe;Z2.exports;(function(t,e){var r=du,n=yfe,i=e&&!e.nodeType&&e,o=i&&!0&&t&&!t.nodeType&&t,u=o&&o.exports===i,a=u?r.Buffer:void 0,p=a?a.isBuffer:void 0,g=p||n;t.exports=g})(Z2,Z2.exports);var Dq=Z2.exports,xfe=9007199254740991,vfe=/^(?:0|[1-9]\d*)$/;function _fe(t,e){var r=typeof t;return e=e??xfe,!!e&&(r=="number"||r!="symbol"&&vfe.test(t))&&t>-1&&t%1==0&&t<e}var wM=_fe,bfe=9007199254740991;function wfe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=bfe}var kM=wfe,kfe=bd,Tfe=kM,Sfe=wd,Efe="[object Arguments]",jfe="[object Array]",Afe="[object Boolean]",Nfe="[object Date]",Cfe="[object Error]",Pfe="[object Function]",Ife="[object Map]",Mfe="[object Number]",Dfe="[object Object]",Ofe="[object RegExp]",Rfe="[object Set]",Lfe="[object String]",zfe="[object WeakMap]",$fe="[object ArrayBuffer]",Ffe="[object DataView]",Bfe="[object Float32Array]",Vfe="[object Float64Array]",Ufe="[object Int8Array]",qfe="[object Int16Array]",Gfe="[object Int32Array]",Wfe="[object Uint8Array]",Hfe="[object Uint8ClampedArray]",Kfe="[object Uint16Array]",Zfe="[object Uint32Array]",ti={};ti[Bfe]=ti[Vfe]=ti[Ufe]=ti[qfe]=ti[Gfe]=ti[Wfe]=ti[Hfe]=ti[Kfe]=ti[Zfe]=!0;ti[Efe]=ti[jfe]=ti[$fe]=ti[Afe]=ti[Ffe]=ti[Nfe]=ti[Cfe]=ti[Pfe]=ti[Ife]=ti[Mfe]=ti[Dfe]=ti[Ofe]=ti[Rfe]=ti[Lfe]=ti[zfe]=!1;function Xfe(t){return Sfe(t)&&Tfe(t.length)&&!!ti[kfe(t)]}var Yfe=Xfe;function Jfe(t){return function(e){return t(e)}}var Oq=Jfe,X2={exports:{}};X2.exports;(function(t,e){var r=VU,n=e&&!e.nodeType&&e,i=n&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===n,u=o&&r.process,a=function(){try{var p=i&&i.require&&i.require("util").types;return p||u&&u.binding&&u.binding("util")}catch{}}();t.exports=a})(X2,X2.exports);var Qfe=X2.exports,epe=Yfe,tpe=Oq,kL=Qfe,TL=kL&&kL.isTypedArray,rpe=TL?tpe(TL):epe,Rq=rpe,npe=sfe,ipe=bM,ape=so,spe=Dq,ope=wM,lpe=Rq,cpe=Object.prototype,upe=cpe.hasOwnProperty;function dpe(t,e){var r=ape(t),n=!r&&ipe(t),i=!r&&!n&&spe(t),o=!r&&!n&&!i&&lpe(t),u=r||n||i||o,a=u?npe(t.length,String):[],p=a.length;for(var g in t)(e||upe.call(t,g))&&!(u&&(g=="length"||i&&(g=="offset"||g=="parent")||o&&(g=="buffer"||g=="byteLength"||g=="byteOffset")||ope(g,p)))&&a.push(g);return a}var hpe=dpe,fpe=Object.prototype;function ppe(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||fpe;return t===r}var mpe=ppe;function gpe(t,e){return function(r){return t(e(r))}}var Lq=gpe,ype=Lq,xpe=ype(Object.keys,Object),vpe=xpe,_pe=mpe,bpe=vpe,wpe=Object.prototype,kpe=wpe.hasOwnProperty;function Tpe(t){if(!_pe(t))return bpe(t);var e=[];for(var r in Object(t))kpe.call(t,r)&&r!="constructor"&&e.push(r);return e}var Spe=Tpe,Epe=iM,jpe=kM;function Ape(t){return t!=null&&jpe(t.length)&&!Epe(t)}var ub=Ape,Npe=hpe,Cpe=Spe,Ppe=ub;function Ipe(t){return Ppe(t)?Npe(t):Cpe(t)}var iS=Ipe,Mpe=Khe,Dpe=ife,Ope=iS;function Rpe(t){return Mpe(t,Ope,Dpe)}var Lpe=Rpe,SL=Lpe,zpe=1,$pe=Object.prototype,Fpe=$pe.hasOwnProperty;function Bpe(t,e,r,n,i,o){var u=r&zpe,a=SL(t),p=a.length,g=SL(e),v=g.length;if(p!=v&&!u)return!1;for(var w=p;w--;){var T=a[w];if(!(u?T in e:Fpe.call(e,T)))return!1}var A=o.get(t),I=o.get(e);if(A&&I)return A==e&&I==t;var P=!0;o.set(t,e),o.set(e,t);for(var D=u;++w<p;){T=a[w];var L=t[T],O=e[T];if(n)var $=u?n(O,L,T,e,t,o):n(L,O,T,t,e,o);if(!($===void 0?L===O||i(L,O,r,n,o):$)){P=!1;break}D||(D=T=="constructor")}if(P&&!D){var G=t.constructor,B=e.constructor;G!=B&&"constructor"in t&&"constructor"in e&&!(typeof G=="function"&&G instanceof G&&typeof B=="function"&&B instanceof B)&&(P=!1)}return o.delete(t),o.delete(e),P}var Vpe=Bpe,Upe=Wp,qpe=du,Gpe=Upe(qpe,"DataView"),Wpe=Gpe,Hpe=Wp,Kpe=du,Zpe=Hpe(Kpe,"Promise"),Xpe=Zpe,Ype=Wp,Jpe=du,Qpe=Ype(Jpe,"Set"),zq=Qpe,eme=Wp,tme=du,rme=eme(tme,"WeakMap"),nme=rme,AC=Wpe,NC=sM,CC=Xpe,PC=zq,IC=nme,$q=bd,X0=qU,EL="[object Map]",ime="[object Object]",jL="[object Promise]",AL="[object Set]",NL="[object WeakMap]",CL="[object DataView]",ame=X0(AC),sme=X0(NC),ome=X0(CC),lme=X0(PC),cme=X0(IC),ip=$q;(AC&&ip(new AC(new ArrayBuffer(1)))!=CL||NC&&ip(new NC)!=EL||CC&&ip(CC.resolve())!=jL||PC&&ip(new PC)!=AL||IC&&ip(new IC)!=NL)&&(ip=function(t){var e=$q(t),r=e==ime?t.constructor:void 0,n=r?X0(r):"";if(n)switch(n){case ame:return CL;case sme:return EL;case ome:return jL;case lme:return AL;case cme:return NL}return e});var ume=ip,vA=jq,dme=Pq,hme=Uhe,fme=Vpe,PL=ume,IL=so,ML=Dq,pme=Rq,mme=1,DL="[object Arguments]",OL="[object Array]",cw="[object Object]",gme=Object.prototype,RL=gme.hasOwnProperty;function yme(t,e,r,n,i,o){var u=IL(t),a=IL(e),p=u?OL:PL(t),g=a?OL:PL(e);p=p==DL?cw:p,g=g==DL?cw:g;var v=p==cw,w=g==cw,T=p==g;if(T&&ML(t)){if(!ML(e))return!1;u=!0,v=!1}if(T&&!v)return o||(o=new vA),u||pme(t)?dme(t,e,r,n,i,o):hme(t,e,p,r,n,i,o);if(!(r&mme)){var A=v&&RL.call(t,"__wrapped__"),I=w&&RL.call(e,"__wrapped__");if(A||I){var P=A?t.value():t,D=I?e.value():e;return o||(o=new vA),i(P,D,r,n,o)}}return T?(o||(o=new vA),fme(t,e,r,n,i,o)):!1}var xme=yme,vme=xme,LL=wd;function Fq(t,e,r,n,i){return t===e?!0:t==null||e==null||!LL(t)&&!LL(e)?t!==t&&e!==e:vme(t,e,r,n,Fq,i)}var TM=Fq,_me=jq,bme=TM,wme=1,kme=2;function Tme(t,e,r,n){var i=r.length,o=i,u=!n;if(t==null)return!o;for(t=Object(t);i--;){var a=r[i];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){a=r[i];var p=a[0],g=t[p],v=a[1];if(u&&a[2]){if(g===void 0&&!(p in t))return!1}else{var w=new _me;if(n)var T=n(g,v,p,t,e,w);if(!(T===void 0?bme(v,g,wme|kme,n,w):T))return!1}}return!0}var Sme=Tme,Eme=cf;function jme(t){return t===t&&!Eme(t)}var Bq=jme,Ame=Bq,Nme=iS;function Cme(t){for(var e=Nme(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,Ame(i)]}return e}var Pme=Cme;function Ime(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var Vq=Ime,Mme=Sme,Dme=Pme,Ome=Vq;function Rme(t){var e=Dme(t);return e.length==1&&e[0][2]?Ome(e[0][0],e[0][1]):function(r){return r===t||Mme(r,t,e)}}var Lme=Rme;function zme(t,e){return t!=null&&e in Object(t)}var $me=zme,Fme=ZU,Bme=bM,Vme=so,Ume=wM,qme=kM,Gme=VT;function Wme(t,e,r){e=Fme(e,t);for(var n=-1,i=e.length,o=!1;++n<i;){var u=Gme(e[n]);if(!(o=t!=null&&r(t,u)))break;t=t[u]}return o||++n!=i?o:(i=t==null?0:t.length,!!i&&qme(i)&&Ume(u,i)&&(Vme(t)||Bme(t)))}var Hme=Wme,Kme=$me,Zme=Hme;function Xme(t,e){return t!=null&&Zme(t,e,Kme)}var Yme=Xme,Jme=TM,Qme=XU,ege=Yme,tge=nM,rge=Bq,nge=Vq,ige=VT,age=1,sge=2;function oge(t,e){return tge(t)&&rge(e)?nge(ige(t),e):function(r){var n=Qme(r,t);return n===void 0&&n===e?ege(r,t):Jme(e,n,age|sge)}}var lge=oge;function cge(t){return t}var Y0=cge;function uge(t){return function(e){return e==null?void 0:e[t]}}var dge=uge,hge=uM;function fge(t){return function(e){return hge(e,t)}}var pge=fge,mge=dge,gge=pge,yge=nM,xge=VT;function vge(t){return yge(t)?mge(xge(t)):gge(t)}var _ge=vge,bge=Lme,wge=lge,kge=Y0,Tge=so,Sge=_ge;function Ege(t){return typeof t=="function"?t:t==null?kge:typeof t=="object"?Tge(t)?wge(t[0],t[1]):bge(t):Sge(t)}var hu=Ege;function jge(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1}var Uq=jge;function Age(t){return t!==t}var Nge=Age;function Cge(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}var Pge=Cge,Ige=Uq,Mge=Nge,Dge=Pge;function Oge(t,e,r){return e===e?Dge(t,e,r):Ige(t,Mge,r)}var Rge=Oge,Lge=Rge;function zge(t,e){var r=t==null?0:t.length;return!!r&&Lge(t,e,0)>-1}var $ge=zge;function Fge(t,e,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}var Bge=Fge;function Vge(){}var Uge=Vge,_A=zq,qge=Uge,Gge=_M,Wge=1/0,Hge=_A&&1/Gge(new _A([,-0]))[1]==Wge?function(t){return new _A(t)}:qge,Kge=Hge,Zge=Aq,Xge=$ge,Yge=Bge,Jge=Cq,Qge=Kge,e0e=_M,t0e=200;function r0e(t,e,r){var n=-1,i=Xge,o=t.length,u=!0,a=[],p=a;if(r)u=!1,i=Yge;else if(o>=t0e){var g=e?null:Qge(t);if(g)return e0e(g);u=!1,i=Jge,p=new Zge}else p=e?[]:a;e:for(;++n<o;){var v=t[n],w=e?e(v):v;if(v=r||v!==0?v:0,u&&w===w){for(var T=p.length;T--;)if(p[T]===w)continue e;e&&p.push(w),a.push(v)}else i(p,w,r)||(p!==a&&p.push(w),a.push(v))}return a}var n0e=r0e,i0e=hu,a0e=n0e;function s0e(t,e){return t&&t.length?a0e(t,i0e(e)):[]}var o0e=s0e;const zL=Pn(o0e);function qq(t,e,r){return e===!0?zL(t,r):Tr(e)?zL(t,e):t}function Zg(t){"@babel/helpers - typeof";return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zg(t)}var l0e=["ref"];function $L(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $u(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$L(Object(r),!0).forEach(function(n){aS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$L(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function c0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wq(n.key),n)}}function u0e(t,e,r){return e&&FL(t.prototype,e),r&&FL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function d0e(t,e,r){return e=Y2(e),h0e(t,Gq()?Reflect.construct(e,r||[],Y2(t).constructor):e.apply(t,r))}function h0e(t,e){if(e&&(Zg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f0e(t)}function f0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Gq=function(){return!!t})()}function Y2(t){return Y2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Y2(t)}function p0e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&MC(t,e)}function MC(t,e){return MC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MC(t,e)}function aS(t,e,r){return e=Wq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wq(t){var e=m0e(t,"string");return Zg(e)=="symbol"?e:e+""}function m0e(t,e){if(Zg(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function g0e(t,e){if(t==null)return{};var r=y0e(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function y0e(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function x0e(t){return t.value}function v0e(t,e){if(Le.isValidElement(t))return Le.cloneElement(t,e);if(typeof t=="function")return Le.createElement(t,e);e.ref;var r=g0e(e,l0e);return Le.createElement(vM,r)}var BL=1,Hc=function(t){function e(){var r;c0e(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=d0e(this,e,[].concat(i)),aS(r,"lastBoundingBox",{width:-1,height:-1}),r}return p0e(e,t),u0e(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>BL||Math.abs(i.height-this.lastBoundingBox.height)>BL)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,n&&n(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?$u({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var i=this.props,o=i.layout,u=i.align,a=i.verticalAlign,p=i.margin,g=i.chartWidth,v=i.chartHeight,w,T;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(u==="center"&&o==="vertical"){var A=this.getBBoxSnapshot();w={left:((g||0)-A.width)/2}}else w=u==="right"?{right:p&&p.right||0}:{left:p&&p.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(a==="middle"){var I=this.getBBoxSnapshot();T={top:((v||0)-I.height)/2}}else T=a==="bottom"?{bottom:p&&p.bottom||0}:{top:p&&p.top||0};return $u($u({},w),T)}},{key:"render",value:function(){var n=this,i=this.props,o=i.content,u=i.width,a=i.height,p=i.wrapperStyle,g=i.payloadUniqBy,v=i.payload,w=$u($u({position:"absolute",width:u||"auto",height:a||"auto"},this.getDefaultPosition(p)),p);return Le.createElement("div",{className:"recharts-legend-wrapper",style:w,ref:function(A){n.wrapperNode=A}},v0e(o,$u($u({},this.props),{},{payload:qq(v,g,x0e)})))}}],[{key:"getWithHeight",value:function(n,i){var o=$u($u({},this.defaultProps),n.props),u=o.layout;return u==="vertical"&&Bt(n.props.height)?{height:n.props.height}:u==="horizontal"?{width:n.props.width||i}:null}}])}(Y.PureComponent);aS(Hc,"displayName","Legend");aS(Hc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var VL=cb,_0e=bM,b0e=so,UL=VL?VL.isConcatSpreadable:void 0;function w0e(t){return b0e(t)||_0e(t)||!!(UL&&t&&t[UL])}var k0e=w0e,T0e=Iq,S0e=k0e;function Hq(t,e,r,n,i){var o=-1,u=t.length;for(r||(r=S0e),i||(i=[]);++o<u;){var a=t[o];e>0&&r(a)?e>1?Hq(a,e-1,r,n,i):T0e(i,a):n||(i[i.length]=a)}return i}var Kq=Hq;function E0e(t){return function(e,r,n){for(var i=-1,o=Object(e),u=n(e),a=u.length;a--;){var p=u[t?a:++i];if(r(o[p],p,o)===!1)break}return e}}var j0e=E0e,A0e=j0e,N0e=A0e(),C0e=N0e,P0e=C0e,I0e=iS;function M0e(t,e){return t&&P0e(t,e,I0e)}var Zq=M0e,D0e=ub;function O0e(t,e){return function(r,n){if(r==null)return r;if(!D0e(r))return t(r,n);for(var i=r.length,o=e?i:-1,u=Object(r);(e?o--:++o<i)&&n(u[o],o,u)!==!1;);return r}}var R0e=O0e,L0e=Zq,z0e=R0e,$0e=z0e(L0e),SM=$0e,F0e=SM,B0e=ub;function V0e(t,e){var r=-1,n=B0e(t)?Array(t.length):[];return F0e(t,function(i,o,u){n[++r]=e(i,o,u)}),n}var Xq=V0e;function U0e(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}var q0e=U0e,qL=U0;function G0e(t,e){if(t!==e){var r=t!==void 0,n=t===null,i=t===t,o=qL(t),u=e!==void 0,a=e===null,p=e===e,g=qL(e);if(!a&&!g&&!o&&t>e||o&&u&&p&&!a&&!g||n&&u&&p||!r&&p||!i)return 1;if(!n&&!o&&!g&&t<e||g&&r&&i&&!n&&!o||a&&r&&i||!u&&i||!p)return-1}return 0}var W0e=G0e,H0e=W0e;function K0e(t,e,r){for(var n=-1,i=t.criteria,o=e.criteria,u=i.length,a=r.length;++n<u;){var p=H0e(i[n],o[n]);if(p){if(n>=a)return p;var g=r[n];return p*(g=="desc"?-1:1)}}return t.index-e.index}var Z0e=K0e,bA=cM,X0e=uM,Y0e=hu,J0e=Xq,Q0e=q0e,eye=Oq,tye=Z0e,rye=Y0,nye=so;function iye(t,e,r){e.length?e=bA(e,function(o){return nye(o)?function(u){return X0e(u,o.length===1?o[0]:o)}:o}):e=[rye];var n=-1;e=bA(e,eye(Y0e));var i=J0e(t,function(o,u,a){var p=bA(e,function(g){return g(o)});return{criteria:p,index:++n,value:o}});return Q0e(i,function(o,u){return tye(o,u,r)})}var aye=iye;function sye(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var oye=sye,lye=oye,GL=Math.max;function cye(t,e,r){return e=GL(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=GL(n.length-e,0),u=Array(o);++i<o;)u[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=r(u),lye(t,this,a)}}var uye=cye;function dye(t){return function(){return t}}var hye=dye,fye=Wp,pye=function(){try{var t=fye(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Yq=pye,mye=hye,WL=Yq,gye=Y0,yye=WL?function(t,e){return WL(t,"toString",{configurable:!0,enumerable:!1,value:mye(e),writable:!0})}:gye,xye=yye,vye=800,_ye=16,bye=Date.now;function wye(t){var e=0,r=0;return function(){var n=bye(),i=_ye-(n-r);if(r=n,i>0){if(++e>=vye)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var kye=wye,Tye=xye,Sye=kye,Eye=Sye(Tye),jye=Eye,Aye=Y0,Nye=uye,Cye=jye;function Pye(t,e){return Cye(Nye(t,e,Aye),t+"")}var Iye=Pye,Mye=aM,Dye=ub,Oye=wM,Rye=cf;function Lye(t,e,r){if(!Rye(r))return!1;var n=typeof e;return(n=="number"?Dye(r)&&Oye(e,r.length):n=="string"&&e in r)?Mye(r[e],t):!1}var sS=Lye,zye=Kq,$ye=aye,Fye=Iye,HL=sS,Bye=Fye(function(t,e){if(t==null)return[];var r=e.length;return r>1&&HL(t,e[0],e[1])?e=[]:r>2&&HL(e[0],e[1],e[2])&&(e=[e[0]]),$ye(t,zye(e,1),[])}),Vye=Bye;const EM=Pn(Vye);function r_(t){"@babel/helpers - typeof";return r_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r_(t)}function DC(){return DC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},DC.apply(this,arguments)}function Uye(t,e){return Hye(t)||Wye(t,e)||Gye(t,e)||qye()}function qye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gye(t,e){if(t){if(typeof t=="string")return KL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KL(t,e)}}function KL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Wye(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function Hye(t){if(Array.isArray(t))return t}function ZL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function wA(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZL(Object(r),!0).forEach(function(n){Kye(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Kye(t,e,r){return e=Zye(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zye(t){var e=Xye(t,"string");return r_(e)=="symbol"?e:e+""}function Xye(t,e){if(r_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(r_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yye(t){return Array.isArray(t)&&pa(t[0])&&pa(t[1])?t.join(" ~ "):t}var Jye=function(e){var r=e.separator,n=r===void 0?" : ":r,i=e.contentStyle,o=i===void 0?{}:i,u=e.itemStyle,a=u===void 0?{}:u,p=e.labelStyle,g=p===void 0?{}:p,v=e.payload,w=e.formatter,T=e.itemSorter,A=e.wrapperClassName,I=e.labelClassName,P=e.label,D=e.labelFormatter,L=e.accessibilityLayer,O=L===void 0?!1:L,$=function(){if(v&&v.length){var ce={padding:0,margin:0},ne=(T?EM(v,T):v).map(function(re,oe){if(re.type==="none")return null;var ae=wA({display:"block",paddingTop:4,paddingBottom:4,color:re.color||"#000"},a),xe=re.formatter||w||Yye,ye=re.value,Se=re.name,be=ye,Ce=Se;if(xe&&be!=null&&Ce!=null){var $e=xe(ye,Se,re,oe,v);if(Array.isArray($e)){var Ye=Uye($e,2);be=Ye[0],Ce=Ye[1]}else be=$e}return Le.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(oe),style:ae},pa(Ce)?Le.createElement("span",{className:"recharts-tooltip-item-name"},Ce):null,pa(Ce)?Le.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Le.createElement("span",{className:"recharts-tooltip-item-value"},be),Le.createElement("span",{className:"recharts-tooltip-item-unit"},re.unit||""))});return Le.createElement("ul",{className:"recharts-tooltip-item-list",style:ce},ne)}return null},G=wA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),B=wA({margin:0},g),J=!_r(P),W=J?P:"",H=Fr("recharts-default-tooltip",A),V=Fr("recharts-tooltip-label",I);J&&D&&v!==void 0&&v!==null&&(W=D(P,v));var se=O?{role:"status","aria-live":"assertive"}:{};return Le.createElement("div",DC({className:H,style:G},se),Le.createElement("p",{className:V,style:B},Le.isValidElement(W)?W:"".concat(W)),$())};function n_(t){"@babel/helpers - typeof";return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n_(t)}function uw(t,e,r){return e=Qye(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qye(t){var e=exe(t,"string");return n_(e)=="symbol"?e:e+""}function exe(t,e){if(n_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(n_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jx="recharts-tooltip-wrapper",txe={visibility:"hidden"};function rxe(t){var e=t.coordinate,r=t.translateX,n=t.translateY;return Fr(jx,uw(uw(uw(uw({},"".concat(jx,"-right"),Bt(r)&&e&&Bt(e.x)&&r>=e.x),"".concat(jx,"-left"),Bt(r)&&e&&Bt(e.x)&&r<e.x),"".concat(jx,"-bottom"),Bt(n)&&e&&Bt(e.y)&&n>=e.y),"".concat(jx,"-top"),Bt(n)&&e&&Bt(e.y)&&n<e.y))}function XL(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.key,i=t.offsetTopLeft,o=t.position,u=t.reverseDirection,a=t.tooltipDimension,p=t.viewBox,g=t.viewBoxDimension;if(o&&Bt(o[n]))return o[n];var v=r[n]-a-i,w=r[n]+i;if(e[n])return u[n]?v:w;if(u[n]){var T=v,A=p[n];return T<A?Math.max(w,p[n]):Math.max(v,p[n])}var I=w+a,P=p[n]+g;return I>P?Math.max(v,p[n]):Math.max(w,p[n])}function nxe(t){var e=t.translateX,r=t.translateY,n=t.useTranslate3d;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function ixe(t){var e=t.allowEscapeViewBox,r=t.coordinate,n=t.offsetTopLeft,i=t.position,o=t.reverseDirection,u=t.tooltipBox,a=t.useTranslate3d,p=t.viewBox,g,v,w;return u.height>0&&u.width>0&&r?(v=XL({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:u.width,viewBox:p,viewBoxDimension:p.width}),w=XL({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:u.height,viewBox:p,viewBoxDimension:p.height}),g=nxe({translateX:v,translateY:w,useTranslate3d:a})):g=txe,{cssProperties:g,cssClasses:rxe({translateX:v,translateY:w,coordinate:r})}}function Xg(t){"@babel/helpers - typeof";return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xg(t)}function YL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function JL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YL(Object(r),!0).forEach(function(n){RC(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function axe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qq(n.key),n)}}function sxe(t,e,r){return e&&QL(t.prototype,e),r&&QL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oxe(t,e,r){return e=J2(e),lxe(t,Jq()?Reflect.construct(e,r||[],J2(t).constructor):e.apply(t,r))}function lxe(t,e){if(e&&(Xg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cxe(t)}function cxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jq(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jq=function(){return!!t})()}function J2(t){return J2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},J2(t)}function uxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OC(t,e)}function OC(t,e){return OC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OC(t,e)}function RC(t,e,r){return e=Qq(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qq(t){var e=dxe(t,"string");return Xg(e)=="symbol"?e:e+""}function dxe(t,e){if(Xg(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ez=1,hxe=function(t){function e(){var r;axe(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=oxe(this,e,[].concat(i)),RC(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),RC(r,"handleKeyDown",function(u){if(u.key==="Escape"){var a,p,g,v;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(p=r.props.coordinate)===null||p===void 0?void 0:p.x)!==null&&a!==void 0?a:0,y:(g=(v=r.props.coordinate)===null||v===void 0?void 0:v.y)!==null&&g!==void 0?g:0}})}}),r}return uxe(e,t),sxe(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>ez||Math.abs(n.height-this.state.lastBoundingBox.height)>ez)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,i=this.props,o=i.active,u=i.allowEscapeViewBox,a=i.animationDuration,p=i.animationEasing,g=i.children,v=i.coordinate,w=i.hasPayload,T=i.isAnimationActive,A=i.offset,I=i.position,P=i.reverseDirection,D=i.useTranslate3d,L=i.viewBox,O=i.wrapperStyle,$=ixe({allowEscapeViewBox:u,coordinate:v,offsetTopLeft:A,position:I,reverseDirection:P,tooltipBox:this.state.lastBoundingBox,useTranslate3d:D,viewBox:L}),G=$.cssClasses,B=$.cssProperties,J=JL(JL({transition:T&&o?"transform ".concat(a,"ms ").concat(p):void 0},B),{},{pointerEvents:"none",visibility:!this.state.dismissed&&o&&w?"visible":"hidden",position:"absolute",top:0,left:0},O);return Le.createElement("div",{tabIndex:-1,className:G,style:J,ref:function(H){n.wrapperNode=H}},g)}}])}(Y.PureComponent),fxe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},dl={isSsr:fxe(),get:function(e){return dl[e]},set:function(e,r){if(typeof e=="string")dl[e]=r;else{var n=Object.keys(e);n&&n.length&&n.forEach(function(i){dl[i]=e[i]})}}};function Yg(t){"@babel/helpers - typeof";return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yg(t)}function tz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function rz(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tz(Object(r),!0).forEach(function(n){jM(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nz(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tG(n.key),n)}}function mxe(t,e,r){return e&&nz(t.prototype,e),r&&nz(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gxe(t,e,r){return e=Q2(e),yxe(t,eG()?Reflect.construct(e,r||[],Q2(t).constructor):e.apply(t,r))}function yxe(t,e){if(e&&(Yg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xxe(t)}function xxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eG(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eG=function(){return!!t})()}function Q2(t){return Q2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Q2(t)}function vxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LC(t,e)}function LC(t,e){return LC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LC(t,e)}function jM(t,e,r){return e=tG(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tG(t){var e=_xe(t,"string");return Yg(e)=="symbol"?e:e+""}function _xe(t,e){if(Yg(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bxe(t){return t.dataKey}function wxe(t,e){return Le.isValidElement(t)?Le.cloneElement(t,e):typeof t=="function"?Le.createElement(t,e):Le.createElement(Jye,e)}var as=function(t){function e(){return pxe(this,e),gxe(this,e,arguments)}return vxe(e,t),mxe(e,[{key:"render",value:function(){var n=this,i=this.props,o=i.active,u=i.allowEscapeViewBox,a=i.animationDuration,p=i.animationEasing,g=i.content,v=i.coordinate,w=i.filterNull,T=i.isAnimationActive,A=i.offset,I=i.payload,P=i.payloadUniqBy,D=i.position,L=i.reverseDirection,O=i.useTranslate3d,$=i.viewBox,G=i.wrapperStyle,B=I??[];w&&B.length&&(B=qq(I.filter(function(W){return W.value!=null&&(W.hide!==!0||n.props.includeHidden)}),P,bxe));var J=B.length>0;return Le.createElement(hxe,{allowEscapeViewBox:u,animationDuration:a,animationEasing:p,isAnimationActive:T,active:o,coordinate:v,hasPayload:J,offset:A,position:D,reverseDirection:L,useTranslate3d:O,viewBox:$,wrapperStyle:G},wxe(g,rz(rz({},this.props),{},{payload:B})))}}])}(Y.PureComponent);jM(as,"displayName","Tooltip");jM(as,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!dl.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var kxe=du,Txe=function(){return kxe.Date.now()},Sxe=Txe,Exe=/\s/;function jxe(t){for(var e=t.length;e--&&Exe.test(t.charAt(e)););return e}var Axe=jxe,Nxe=Axe,Cxe=/^\s+/;function Pxe(t){return t&&t.slice(0,Nxe(t)+1).replace(Cxe,"")}var Ixe=Pxe,Mxe=Ixe,iz=cf,Dxe=U0,az=0/0,Oxe=/^[-+]0x[0-9a-f]+$/i,Rxe=/^0b[01]+$/i,Lxe=/^0o[0-7]+$/i,zxe=parseInt;function $xe(t){if(typeof t=="number")return t;if(Dxe(t))return az;if(iz(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=iz(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Mxe(t);var r=Rxe.test(t);return r||Lxe.test(t)?zxe(t.slice(2),r?2:8):Oxe.test(t)?az:+t}var rG=$xe,Fxe=cf,kA=Sxe,sz=rG,Bxe="Expected a function",Vxe=Math.max,Uxe=Math.min;function qxe(t,e,r){var n,i,o,u,a,p,g=0,v=!1,w=!1,T=!0;if(typeof t!="function")throw new TypeError(Bxe);e=sz(e)||0,Fxe(r)&&(v=!!r.leading,w="maxWait"in r,o=w?Vxe(sz(r.maxWait)||0,e):o,T="trailing"in r?!!r.trailing:T);function A(J){var W=n,H=i;return n=i=void 0,g=J,u=t.apply(H,W),u}function I(J){return g=J,a=setTimeout(L,e),v?A(J):u}function P(J){var W=J-p,H=J-g,V=e-W;return w?Uxe(V,o-H):V}function D(J){var W=J-p,H=J-g;return p===void 0||W>=e||W<0||w&&H>=o}function L(){var J=kA();if(D(J))return O(J);a=setTimeout(L,P(J))}function O(J){return a=void 0,T&&n?A(J):(n=i=void 0,u)}function $(){a!==void 0&&clearTimeout(a),g=0,n=p=i=a=void 0}function G(){return a===void 0?u:O(kA())}function B(){var J=kA(),W=D(J);if(n=arguments,i=this,p=J,W){if(a===void 0)return I(p);if(w)return clearTimeout(a),a=setTimeout(L,e),A(p)}return a===void 0&&(a=setTimeout(L,e)),u}return B.cancel=$,B.flush=G,B}var Gxe=qxe,Wxe=Gxe,Hxe=cf,Kxe="Expected a function";function Zxe(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(Kxe);return Hxe(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Wxe(t,e,{leading:n,maxWait:e,trailing:i})}var Xxe=Zxe;const nG=Pn(Xxe);function i_(t){"@babel/helpers - typeof";return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i_(t)}function oz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function dw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oz(Object(r),!0).forEach(function(n){Yxe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Yxe(t,e,r){return e=Jxe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jxe(t){var e=Qxe(t,"string");return i_(e)=="symbol"?e:e+""}function Qxe(t,e){if(i_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(i_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eve(t,e){return ive(t)||nve(t,e)||rve(t,e)||tve()}function tve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rve(t,e){if(t){if(typeof t=="string")return lz(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lz(t,e)}}function lz(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function nve(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function ive(t){if(Array.isArray(t))return t}var Jg=Y.forwardRef(function(t,e){var r=t.aspect,n=t.initialDimension,i=n===void 0?{width:-1,height:-1}:n,o=t.width,u=o===void 0?"100%":o,a=t.height,p=a===void 0?"100%":a,g=t.minWidth,v=g===void 0?0:g,w=t.minHeight,T=t.maxHeight,A=t.children,I=t.debounce,P=I===void 0?0:I,D=t.id,L=t.className,O=t.onResize,$=t.style,G=$===void 0?{}:$,B=Y.useRef(null),J=Y.useRef();J.current=O,Y.useImperativeHandle(e,function(){return Object.defineProperty(B.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),B.current},configurable:!0})});var W=Y.useState({containerWidth:i.width,containerHeight:i.height}),H=eve(W,2),V=H[0],se=H[1],K=Y.useCallback(function(ne,re){se(function(oe){var ae=Math.round(ne),xe=Math.round(re);return oe.containerWidth===ae&&oe.containerHeight===xe?oe:{containerWidth:ae,containerHeight:xe}})},[]);Y.useEffect(function(){var ne=function(Se){var be,Ce=Se[0].contentRect,$e=Ce.width,Ye=Ce.height;K($e,Ye),(be=J.current)===null||be===void 0||be.call(J,$e,Ye)};P>0&&(ne=nG(ne,P,{trailing:!0,leading:!1}));var re=new ResizeObserver(ne),oe=B.current.getBoundingClientRect(),ae=oe.width,xe=oe.height;return K(ae,xe),re.observe(B.current),function(){re.disconnect()}},[K,P]);var ce=Y.useMemo(function(){var ne=V.containerWidth,re=V.containerHeight;if(ne<0||re<0)return null;ac(hp(u)||hp(p),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,u,p),ac(!r||r>0,"The aspect(%s) must be greater than zero.",r);var oe=hp(u)?ne:u,ae=hp(p)?re:p;r&&r>0&&(oe?ae=oe/r:ae&&(oe=ae*r),T&&ae>T&&(ae=T)),ac(oe>0||ae>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,oe,ae,u,p,v,w,r);var xe=!Array.isArray(A)&&Qu(A.type).endsWith("Chart");return Le.Children.map(A,function(ye){return Le.isValidElement(ye)?Y.cloneElement(ye,dw({width:oe,height:ae},xe?{style:dw({height:"100%",width:"100%",maxHeight:ae,maxWidth:oe},ye.props.style)}:{})):ye})},[r,A,p,T,w,v,V,u]);return Le.createElement("div",{id:D?"".concat(D):void 0,className:Fr("recharts-responsive-container",L),style:dw(dw({},G),{},{width:u,height:p,minWidth:v,minHeight:w,maxHeight:T}),ref:B},ce)}),Hp=function(e){return null};Hp.displayName="Cell";function a_(t){"@babel/helpers - typeof";return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a_(t)}function cz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function zC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cz(Object(r),!0).forEach(function(n){ave(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ave(t,e,r){return e=sve(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sve(t){var e=ove(t,"string");return a_(e)=="symbol"?e:e+""}function ove(t,e){if(a_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(a_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hm={widthCache:{},cacheCount:0},lve=2e3,cve={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},uz="recharts_measurement_span";function uve(t){var e=zC({},t);return Object.keys(e).forEach(function(r){e[r]||delete e[r]}),e}var gv=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||dl.isSsr)return{width:0,height:0};var n=uve(r),i=JSON.stringify({text:e,copyStyle:n});if(Hm.widthCache[i])return Hm.widthCache[i];try{var o=document.getElementById(uz);o||(o=document.createElement("span"),o.setAttribute("id",uz),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var u=zC(zC({},cve),n);Object.assign(o.style,u),o.textContent="".concat(e);var a=o.getBoundingClientRect(),p={width:a.width,height:a.height};return Hm.widthCache[i]=p,++Hm.cacheCount>lve&&(Hm.cacheCount=0,Hm.widthCache={}),p}catch{return{width:0,height:0}}},dve=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function s_(t){"@babel/helpers - typeof";return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s_(t)}function ek(t,e){return mve(t)||pve(t,e)||fve(t,e)||hve()}function hve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fve(t,e){if(t){if(typeof t=="string")return dz(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dz(t,e)}}function dz(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pve(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function mve(t){if(Array.isArray(t))return t}function gve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hz(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xve(n.key),n)}}function yve(t,e,r){return e&&hz(t.prototype,e),r&&hz(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xve(t){var e=vve(t,"string");return s_(e)=="symbol"?e:e+""}function vve(t,e){if(s_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(s_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,pz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,_ve=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,bve=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,iG={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},wve=Object.keys(iG),fg="NaN";function kve(t,e){return t*iG[e]}var hw=function(){function t(e,r){gve(this,t),this.num=e,this.unit=r,this.num=e,this.unit=r,Number.isNaN(e)&&(this.unit=""),r!==""&&!_ve.test(r)&&(this.num=NaN,this.unit=""),wve.includes(r)&&(this.num=kve(e,r),this.unit="px")}return yve(t,[{key:"add",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new t(NaN,""):new t(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new t(NaN,""):new t(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,i=(n=bve.exec(r))!==null&&n!==void 0?n:[],o=ek(i,3),u=o[1],a=o[2];return new t(parseFloat(u),a??"")}}])}();function aG(t){if(t.includes(fg))return fg;for(var e=t;e.includes("*")||e.includes("/");){var r,n=(r=fz.exec(e))!==null&&r!==void 0?r:[],i=ek(n,4),o=i[1],u=i[2],a=i[3],p=hw.parse(o??""),g=hw.parse(a??""),v=u==="*"?p.multiply(g):p.divide(g);if(v.isNaN())return fg;e=e.replace(fz,v.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var w,T=(w=pz.exec(e))!==null&&w!==void 0?w:[],A=ek(T,4),I=A[1],P=A[2],D=A[3],L=hw.parse(I??""),O=hw.parse(D??""),$=P==="+"?L.add(O):L.subtract(O);if($.isNaN())return fg;e=e.replace(pz,$.toString())}return e}var mz=/\(([^()]*)\)/;function Tve(t){for(var e=t;e.includes("(");){var r=mz.exec(e),n=ek(r,2),i=n[1];e=e.replace(mz,aG(i))}return e}function Sve(t){var e=t.replace(/\s+/g,"");return e=Tve(e),e=aG(e),e}function Eve(t){try{return Sve(t)}catch{return fg}}function TA(t){var e=Eve(t.slice(5,-1));return e===fg?"":e}var jve=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Ave=["dx","dy","angle","className","breakAll"];function $C(){return $C=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$C.apply(this,arguments)}function gz(t,e){if(t==null)return{};var r=Nve(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Nve(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function yz(t,e){return Mve(t)||Ive(t,e)||Pve(t,e)||Cve()}function Cve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pve(t,e){if(t){if(typeof t=="string")return xz(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xz(t,e)}}function xz(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ive(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function Mve(t){if(Array.isArray(t))return t}var sG=/[ \f\n\r\t\v\u2028\u2029]+/,oG=function(e){var r=e.children,n=e.breakAll,i=e.style;try{var o=[];_r(r)||(n?o=r.toString().split(""):o=r.toString().split(sG));var u=o.map(function(p){return{word:p,width:gv(p,i).width}}),a=n?0:gv(" ",i).width;return{wordsWithComputedWidth:u,spaceWidth:a}}catch{return null}},Dve=function(e,r,n,i,o){var u=e.maxLines,a=e.children,p=e.style,g=e.breakAll,v=Bt(u),w=a,T=function(){var oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return oe.reduce(function(ae,xe){var ye=xe.word,Se=xe.width,be=ae[ae.length-1];if(be&&(i==null||o||be.width+Se+n<Number(i)))be.words.push(ye),be.width+=Se+n;else{var Ce={words:[ye],width:Se};ae.push(Ce)}return ae},[])},A=T(r),I=function(oe){return oe.reduce(function(ae,xe){return ae.width>xe.width?ae:xe})};if(!v)return A;for(var P="…",D=function(oe){var ae=w.slice(0,oe),xe=oG({breakAll:g,style:p,children:ae+P}).wordsWithComputedWidth,ye=T(xe),Se=ye.length>u||I(ye).width>Number(i);return[Se,ye]},L=0,O=w.length-1,$=0,G;L<=O&&$<=w.length-1;){var B=Math.floor((L+O)/2),J=B-1,W=D(J),H=yz(W,2),V=H[0],se=H[1],K=D(B),ce=yz(K,1),ne=ce[0];if(!V&&!ne&&(L=B+1),V&&ne&&(O=B-1),!V&&ne){G=se;break}$++}return G||A},vz=function(e){var r=_r(e)?[]:e.toString().split(sG);return[{words:r}]},Ove=function(e){var r=e.width,n=e.scaleToFit,i=e.children,o=e.style,u=e.breakAll,a=e.maxLines;if((r||n)&&!dl.isSsr){var p,g,v=oG({breakAll:u,children:i,style:o});if(v){var w=v.wordsWithComputedWidth,T=v.spaceWidth;p=w,g=T}else return vz(i);return Dve({breakAll:u,children:i,maxLines:a,style:o},p,g,r,n)}return vz(i)},_z="#808080",Op=function(e){var r=e.x,n=r===void 0?0:r,i=e.y,o=i===void 0?0:i,u=e.lineHeight,a=u===void 0?"1em":u,p=e.capHeight,g=p===void 0?"0.71em":p,v=e.scaleToFit,w=v===void 0?!1:v,T=e.textAnchor,A=T===void 0?"start":T,I=e.verticalAnchor,P=I===void 0?"end":I,D=e.fill,L=D===void 0?_z:D,O=gz(e,jve),$=Y.useMemo(function(){return Ove({breakAll:O.breakAll,children:O.children,maxLines:O.maxLines,scaleToFit:w,style:O.style,width:O.width})},[O.breakAll,O.children,O.maxLines,w,O.style,O.width]),G=O.dx,B=O.dy,J=O.angle,W=O.className,H=O.breakAll,V=gz(O,Ave);if(!pa(n)||!pa(o))return null;var se=n+(Bt(G)?G:0),K=o+(Bt(B)?B:0),ce;switch(P){case"start":ce=TA("calc(".concat(g,")"));break;case"middle":ce=TA("calc(".concat(($.length-1)/2," * -").concat(a," + (").concat(g," / 2))"));break;default:ce=TA("calc(".concat($.length-1," * -").concat(a,")"));break}var ne=[];if(w){var re=$[0].width,oe=O.width;ne.push("scale(".concat((Bt(oe)?oe/re:1)/re,")"))}return J&&ne.push("rotate(".concat(J,", ").concat(se,", ").concat(K,")")),ne.length&&(V.transform=ne.join(" ")),Le.createElement("text",$C({},fr(V,!0),{x:se,y:K,className:Fr("recharts-text",W),textAnchor:A,fill:L.includes("url")?_z:L}),$.map(function(ae,xe){var ye=ae.words.join(H?"":" ");return Le.createElement("tspan",{x:se,dy:xe===0?ce:a,key:"".concat(ye,"-").concat(xe)},ye)}))};function Dh(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Rve(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function AM(t){let e,r,n;t.length!==2?(e=Dh,r=(a,p)=>Dh(t(a),p),n=(a,p)=>t(a)-p):(e=t===Dh||t===Rve?t:Lve,r=t,n=t);function i(a,p,g=0,v=a.length){if(g<v){if(e(p,p)!==0)return v;do{const w=g+v>>>1;r(a[w],p)<0?g=w+1:v=w}while(g<v)}return g}function o(a,p,g=0,v=a.length){if(g<v){if(e(p,p)!==0)return v;do{const w=g+v>>>1;r(a[w],p)<=0?g=w+1:v=w}while(g<v)}return g}function u(a,p,g=0,v=a.length){const w=i(a,p,g,v-1);return w>g&&n(a[w-1],p)>-n(a[w],p)?w-1:w}return{left:i,center:u,right:o}}function Lve(){return 0}function lG(t){return t===null?NaN:+t}function*zve(t,e){if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of t)(n=e(n,++r,t))!=null&&(n=+n)>=n&&(yield n)}}const $ve=AM(Dh),Fve=$ve.right;AM(lG).center;const db=Fve;function cG(t,e){let r,n;if(e===void 0)for(const i of t)i!=null&&(r===void 0?i>=i&&(r=n=i):(r>i&&(r=i),n<i&&(n=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(r===void 0?o>=o&&(r=n=o):(r>o&&(r=o),n<o&&(n=o)))}return[r,n]}class bz extends Map{constructor(e,r=Uve){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(wz(this,e))}has(e){return super.has(wz(this,e))}set(e,r){return super.set(Bve(this,e),r)}delete(e){return super.delete(Vve(this,e))}}function wz({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function Bve({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function Vve({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function Uve(t){return t!==null&&typeof t=="object"?t.valueOf():t}function qve(t=Dh){if(t===Dh)return uG;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function uG(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const Gve=Math.sqrt(50),Wve=Math.sqrt(10),Hve=Math.sqrt(2);function tk(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),o=n/Math.pow(10,i),u=o>=Gve?10:o>=Wve?5:o>=Hve?2:1;let a,p,g;return i<0?(g=Math.pow(10,-i)/u,a=Math.round(t*g),p=Math.round(e*g),a/g<t&&++a,p/g>e&&--p,g=-g):(g=Math.pow(10,i)*u,a=Math.round(t/g),p=Math.round(e/g),a*g<t&&++a,p*g>e&&--p),p<a&&.5<=r&&r<2?tk(t,e,r*2):[a,p,g]}function FC(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,o,u]=n?tk(e,t,r):tk(t,e,r);if(!(o>=i))return[];const a=o-i+1,p=new Array(a);if(n)if(u<0)for(let g=0;g<a;++g)p[g]=(o-g)/-u;else for(let g=0;g<a;++g)p[g]=(o-g)*u;else if(u<0)for(let g=0;g<a;++g)p[g]=(i+g)/-u;else for(let g=0;g<a;++g)p[g]=(i+g)*u;return p}function BC(t,e,r){return e=+e,t=+t,r=+r,tk(t,e,r)[2]}function VC(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?BC(e,t,r):BC(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function UC(t,e){let r;if(e===void 0)for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}function kz(t,e){let r;if(e===void 0)for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}function dG(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?uG:qve(i);n>r;){if(n-r>600){const p=n-r+1,g=e-r+1,v=Math.log(p),w=.5*Math.exp(2*v/3),T=.5*Math.sqrt(v*w*(p-w)/p)*(g-p/2<0?-1:1),A=Math.max(r,Math.floor(e-g*w/p+T)),I=Math.min(n,Math.floor(e+(p-g)*w/p+T));dG(t,e,A,I,i)}const o=t[e];let u=r,a=n;for(Ax(t,r,e),i(t[n],o)>0&&Ax(t,r,n);u<a;){for(Ax(t,u,a),++u,--a;i(t[u],o)<0;)++u;for(;i(t[a],o)>0;)--a}i(t[r],o)===0?Ax(t,r,a):(++a,Ax(t,a,n)),a<=e&&(r=a+1),e<=a&&(n=a-1)}return t}function Ax(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function Kve(t,e,r){if(t=Float64Array.from(zve(t,r)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return kz(t);if(e>=1)return UC(t);var n,i=(n-1)*e,o=Math.floor(i),u=UC(dG(t,o).subarray(0,o+1)),a=kz(t.subarray(o+1));return u+(a-u)*(i-o)}}function Zve(t,e,r=lG){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,o=Math.floor(i),u=+r(t[o],o,t),a=+r(t[o+1],o+1,t);return u+(a-u)*(i-o)}}function Xve(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,o=new Array(i);++n<i;)o[n]=t+n*r;return o}function vl(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function kd(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const qC=Symbol("implicit");function NM(){var t=new bz,e=[],r=[],n=qC;function i(o){let u=t.get(o);if(u===void 0){if(n!==qC)return n;t.set(o,u=e.push(o)-1)}return r[u%r.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new bz;for(const u of o)t.has(u)||t.set(u,e.push(u)-1);return i},i.range=function(o){return arguments.length?(r=Array.from(o),i):r.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return NM(e,r).unknown(n)},vl.apply(i,arguments),i}function o_(){var t=NM().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,o,u,a=!1,p=0,g=0,v=.5;delete t.unknown;function w(){var T=e().length,A=i<n,I=A?i:n,P=A?n:i;o=(P-I)/Math.max(1,T-p+g*2),a&&(o=Math.floor(o)),I+=(P-I-o*(T-p))*v,u=o*(1-p),a&&(I=Math.round(I),u=Math.round(u));var D=Xve(T).map(function(L){return I+o*L});return r(A?D.reverse():D)}return t.domain=function(T){return arguments.length?(e(T),w()):e()},t.range=function(T){return arguments.length?([n,i]=T,n=+n,i=+i,w()):[n,i]},t.rangeRound=function(T){return[n,i]=T,n=+n,i=+i,a=!0,w()},t.bandwidth=function(){return u},t.step=function(){return o},t.round=function(T){return arguments.length?(a=!!T,w()):a},t.padding=function(T){return arguments.length?(p=Math.min(1,g=+T),w()):p},t.paddingInner=function(T){return arguments.length?(p=Math.min(1,T),w()):p},t.paddingOuter=function(T){return arguments.length?(g=+T,w()):g},t.align=function(T){return arguments.length?(v=Math.max(0,Math.min(1,T)),w()):v},t.copy=function(){return o_(e(),[n,i]).round(a).paddingInner(p).paddingOuter(g).align(v)},vl.apply(w(),arguments)}function hG(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return hG(e())},t}function yv(){return hG(o_.apply(null,arguments).paddingInner(1))}function CM(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function fG(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function hb(){}var l_=.7,rk=1/l_,Cg="\\s*([+-]?\\d+)\\s*",c_="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Yve=/^#([0-9a-f]{3,8})$/,Jve=new RegExp(`^rgb\\(${Cg},${Cg},${Cg}\\)$`),Qve=new RegExp(`^rgb\\(${Kc},${Kc},${Kc}\\)$`),e_e=new RegExp(`^rgba\\(${Cg},${Cg},${Cg},${c_}\\)$`),t_e=new RegExp(`^rgba\\(${Kc},${Kc},${Kc},${c_}\\)$`),r_e=new RegExp(`^hsl\\(${c_},${Kc},${Kc}\\)$`),n_e=new RegExp(`^hsla\\(${c_},${Kc},${Kc},${c_}\\)$`),Tz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};CM(hb,ld,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Sz,formatHex:Sz,formatHex8:i_e,formatHsl:a_e,formatRgb:Ez,toString:Ez});function Sz(){return this.rgb().formatHex()}function i_e(){return this.rgb().formatHex8()}function a_e(){return pG(this).formatHsl()}function Ez(){return this.rgb().formatRgb()}function ld(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Yve.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?jz(e):r===3?new Xs(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?fw(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?fw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Jve.exec(t))?new Xs(e[1],e[2],e[3],1):(e=Qve.exec(t))?new Xs(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=e_e.exec(t))?fw(e[1],e[2],e[3],e[4]):(e=t_e.exec(t))?fw(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=r_e.exec(t))?Cz(e[1],e[2]/100,e[3]/100,1):(e=n_e.exec(t))?Cz(e[1],e[2]/100,e[3]/100,e[4]):Tz.hasOwnProperty(t)?jz(Tz[t]):t==="transparent"?new Xs(NaN,NaN,NaN,0):null}function jz(t){return new Xs(t>>16&255,t>>8&255,t&255,1)}function fw(t,e,r,n){return n<=0&&(t=e=r=NaN),new Xs(t,e,r,n)}function s_e(t){return t instanceof hb||(t=ld(t)),t?(t=t.rgb(),new Xs(t.r,t.g,t.b,t.opacity)):new Xs}function GC(t,e,r,n){return arguments.length===1?s_e(t):new Xs(t,e,r,n??1)}function Xs(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}CM(Xs,GC,fG(hb,{brighter(t){return t=t==null?rk:Math.pow(rk,t),new Xs(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?l_:Math.pow(l_,t),new Xs(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Xs(wp(this.r),wp(this.g),wp(this.b),nk(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Az,formatHex:Az,formatHex8:o_e,formatRgb:Nz,toString:Nz}));function Az(){return`#${fp(this.r)}${fp(this.g)}${fp(this.b)}`}function o_e(){return`#${fp(this.r)}${fp(this.g)}${fp(this.b)}${fp((isNaN(this.opacity)?1:this.opacity)*255)}`}function Nz(){const t=nk(this.opacity);return`${t===1?"rgb(":"rgba("}${wp(this.r)}, ${wp(this.g)}, ${wp(this.b)}${t===1?")":`, ${t})`}`}function nk(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function wp(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function fp(t){return t=wp(t),(t<16?"0":"")+t.toString(16)}function Cz(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new rc(t,e,r,n)}function pG(t){if(t instanceof rc)return new rc(t.h,t.s,t.l,t.opacity);if(t instanceof hb||(t=ld(t)),!t)return new rc;if(t instanceof rc)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),o=Math.max(e,r,n),u=NaN,a=o-i,p=(o+i)/2;return a?(e===o?u=(r-n)/a+(r<n)*6:r===o?u=(n-e)/a+2:u=(e-r)/a+4,a/=p<.5?o+i:2-o-i,u*=60):a=p>0&&p<1?0:u,new rc(u,a,p,t.opacity)}function l_e(t,e,r,n){return arguments.length===1?pG(t):new rc(t,e,r,n??1)}function rc(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}CM(rc,l_e,fG(hb,{brighter(t){return t=t==null?rk:Math.pow(rk,t),new rc(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?l_:Math.pow(l_,t),new rc(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Xs(SA(t>=240?t-240:t+120,i,n),SA(t,i,n),SA(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new rc(Pz(this.h),pw(this.s),pw(this.l),nk(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=nk(this.opacity);return`${t===1?"hsl(":"hsla("}${Pz(this.h)}, ${pw(this.s)*100}%, ${pw(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Pz(t){return t=(t||0)%360,t<0?t+360:t}function pw(t){return Math.max(0,Math.min(1,t||0))}function SA(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const PM=t=>()=>t;function c_e(t,e){return function(r){return t+r*e}}function u_e(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function d_e(t){return(t=+t)==1?mG:function(e,r){return r-e?u_e(e,r,t):PM(isNaN(e)?r:e)}}function mG(t,e){var r=e-t;return r?c_e(t,r):PM(isNaN(t)?e:t)}const ik=function t(e){var r=d_e(e);function n(i,o){var u=r((i=GC(i)).r,(o=GC(o)).r),a=r(i.g,o.g),p=r(i.b,o.b),g=mG(i.opacity,o.opacity);return function(v){return i.r=u(v),i.g=a(v),i.b=p(v),i.opacity=g(v),i+""}}return n.gamma=t,n}(1);function h_e(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=t[i]*(1-o)+e[i]*o;return n}}function f_e(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function p_e(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),o=new Array(r),u;for(u=0;u<n;++u)i[u]=J0(t[u],e[u]);for(;u<r;++u)o[u]=e[u];return function(a){for(u=0;u<n;++u)o[u]=i[u](a);return o}}function m_e(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function ec(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function g_e(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=J0(t[i],e[i]):n[i]=e[i];return function(o){for(i in r)n[i]=r[i](o);return n}}var WC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,EA=new RegExp(WC.source,"g");function y_e(t){return function(){return t}}function x_e(t){return function(e){return t(e)+""}}function gG(t,e){var r=WC.lastIndex=EA.lastIndex=0,n,i,o,u=-1,a=[],p=[];for(t=t+"",e=e+"";(n=WC.exec(t))&&(i=EA.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),a[u]?a[u]+=o:a[++u]=o),(n=n[0])===(i=i[0])?a[u]?a[u]+=i:a[++u]=i:(a[++u]=null,p.push({i:u,x:ec(n,i)})),r=EA.lastIndex;return r<e.length&&(o=e.slice(r),a[u]?a[u]+=o:a[++u]=o),a.length<2?p[0]?x_e(p[0].x):y_e(e):(e=p.length,function(g){for(var v=0,w;v<e;++v)a[(w=p[v]).i]=w.x(g);return a.join("")})}function J0(t,e){var r=typeof e,n;return e==null||r==="boolean"?PM(e):(r==="number"?ec:r==="string"?(n=ld(e))?(e=n,ik):gG:e instanceof ld?ik:e instanceof Date?m_e:f_e(e)?h_e:Array.isArray(e)?p_e:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?g_e:ec)(t,e)}function IM(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}var Iz=180/Math.PI,HC={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function yG(t,e,r,n,i,o){var u,a,p;return(u=Math.sqrt(t*t+e*e))&&(t/=u,e/=u),(p=t*r+e*n)&&(r-=t*p,n-=e*p),(a=Math.sqrt(r*r+n*n))&&(r/=a,n/=a,p/=a),t*n<e*r&&(t=-t,e=-e,p=-p,u=-u),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Iz,skewX:Math.atan(p)*Iz,scaleX:u,scaleY:a}}var mw;function v_e(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?HC:yG(e.a,e.b,e.c,e.d,e.e,e.f)}function __e(t){return t==null||(mw||(mw=document.createElementNS("http://www.w3.org/2000/svg","g")),mw.setAttribute("transform",t),!(t=mw.transform.baseVal.consolidate()))?HC:(t=t.matrix,yG(t.a,t.b,t.c,t.d,t.e,t.f))}function xG(t,e,r,n){function i(g){return g.length?g.pop()+" ":""}function o(g,v,w,T,A,I){if(g!==w||v!==T){var P=A.push("translate(",null,e,null,r);I.push({i:P-4,x:ec(g,w)},{i:P-2,x:ec(v,T)})}else(w||T)&&A.push("translate("+w+e+T+r)}function u(g,v,w,T){g!==v?(g-v>180?v+=360:v-g>180&&(g+=360),T.push({i:w.push(i(w)+"rotate(",null,n)-2,x:ec(g,v)})):v&&w.push(i(w)+"rotate("+v+n)}function a(g,v,w,T){g!==v?T.push({i:w.push(i(w)+"skewX(",null,n)-2,x:ec(g,v)}):v&&w.push(i(w)+"skewX("+v+n)}function p(g,v,w,T,A,I){if(g!==w||v!==T){var P=A.push(i(A)+"scale(",null,",",null,")");I.push({i:P-4,x:ec(g,w)},{i:P-2,x:ec(v,T)})}else(w!==1||T!==1)&&A.push(i(A)+"scale("+w+","+T+")")}return function(g,v){var w=[],T=[];return g=t(g),v=t(v),o(g.translateX,g.translateY,v.translateX,v.translateY,w,T),u(g.rotate,v.rotate,w,T),a(g.skewX,v.skewX,w,T),p(g.scaleX,g.scaleY,v.scaleX,v.scaleY,w,T),g=v=null,function(A){for(var I=-1,P=T.length,D;++I<P;)w[(D=T[I]).i]=D.x(A);return w.join("")}}}var b_e=xG(v_e,"px, ","px)","deg)"),w_e=xG(__e,", ",")",")"),k_e=1e-12;function Mz(t){return((t=Math.exp(t))+1/t)/2}function T_e(t){return((t=Math.exp(t))-1/t)/2}function S_e(t){return((t=Math.exp(2*t))-1)/(t+1)}const E_e=function t(e,r,n){function i(o,u){var a=o[0],p=o[1],g=o[2],v=u[0],w=u[1],T=u[2],A=v-a,I=w-p,P=A*A+I*I,D,L;if(P<k_e)L=Math.log(T/g)/e,D=function(W){return[a+W*A,p+W*I,g*Math.exp(e*W*L)]};else{var O=Math.sqrt(P),$=(T*T-g*g+n*P)/(2*g*r*O),G=(T*T-g*g-n*P)/(2*T*r*O),B=Math.log(Math.sqrt($*$+1)-$),J=Math.log(Math.sqrt(G*G+1)-G);L=(J-B)/e,D=function(W){var H=W*L,V=Mz(B),se=g/(r*O)*(V*S_e(e*H+B)-T_e(B));return[a+se*A,p+se*I,g*V/Mz(e*H+B)]}}return D.duration=L*1e3*e/Math.SQRT2,D}return i.rho=function(o){var u=Math.max(.001,+o),a=u*u,p=a*a;return t(u,a,p)},i}(Math.SQRT2,2,4);function j_e(t,e){e===void 0&&(e=t,t=J0);for(var r=0,n=e.length-1,i=e[0],o=new Array(n<0?0:n);r<n;)o[r]=t(i,i=e[++r]);return function(u){var a=Math.max(0,Math.min(n-1,Math.floor(u*=n)));return o[a](u-a)}}function A_e(t){return function(){return t}}function ak(t){return+t}var Dz=[0,1];function As(t){return t}function KC(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:A_e(isNaN(e)?NaN:.5)}function N_e(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function C_e(t,e,r){var n=t[0],i=t[1],o=e[0],u=e[1];return i<n?(n=KC(i,n),o=r(u,o)):(n=KC(n,i),o=r(o,u)),function(a){return o(n(a))}}function P_e(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),o=new Array(n),u=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++u<n;)i[u]=KC(t[u],t[u+1]),o[u]=r(e[u],e[u+1]);return function(a){var p=db(t,a,1,n)-1;return o[p](i[p](a))}}function fb(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function oS(){var t=Dz,e=Dz,r=J0,n,i,o,u=As,a,p,g;function v(){var T=Math.min(t.length,e.length);return u!==As&&(u=N_e(t[0],t[T-1])),a=T>2?P_e:C_e,p=g=null,w}function w(T){return T==null||isNaN(T=+T)?o:(p||(p=a(t.map(n),e,r)))(n(u(T)))}return w.invert=function(T){return u(i((g||(g=a(e,t.map(n),ec)))(T)))},w.domain=function(T){return arguments.length?(t=Array.from(T,ak),v()):t.slice()},w.range=function(T){return arguments.length?(e=Array.from(T),v()):e.slice()},w.rangeRound=function(T){return e=Array.from(T),r=IM,v()},w.clamp=function(T){return arguments.length?(u=T?!0:As,v()):u!==As},w.interpolate=function(T){return arguments.length?(r=T,v()):r},w.unknown=function(T){return arguments.length?(o=T,w):o},function(T,A){return n=T,i=A,v()}}function MM(){return oS()(As,As)}function I_e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function sk(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Qg(t){return t=sk(Math.abs(t)),t?t[1]:NaN}function M_e(t,e){return function(r,n){for(var i=r.length,o=[],u=0,a=t[0],p=0;i>0&&a>0&&(p+a+1>n&&(a=Math.max(1,n-p)),o.push(r.substring(i-=a,i+a)),!((p+=a+1)>n));)a=t[u=(u+1)%t.length];return o.reverse().join(e)}}function D_e(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var O_e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function u_(t){if(!(e=O_e.exec(t)))throw new Error("invalid format: "+t);var e;return new DM({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}u_.prototype=DM.prototype;function DM(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}DM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function R_e(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var vG;function L_e(t,e){var r=sk(t,e);if(!r)return t+"";var n=r[0],i=r[1],o=i-(vG=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,u=n.length;return o===u?n:o>u?n+new Array(o-u+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+sk(t,Math.max(0,e+o-1))[0]}function Oz(t,e){var r=sk(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const Rz={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:I_e,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Oz(t*100,e),r:Oz,s:L_e,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Lz(t){return t}var zz=Array.prototype.map,$z=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function z_e(t){var e=t.grouping===void 0||t.thousands===void 0?Lz:M_e(zz.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Lz:D_e(zz.call(t.numerals,String)),u=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function g(w){w=u_(w);var T=w.fill,A=w.align,I=w.sign,P=w.symbol,D=w.zero,L=w.width,O=w.comma,$=w.precision,G=w.trim,B=w.type;B==="n"?(O=!0,B="g"):Rz[B]||($===void 0&&($=12),G=!0,B="g"),(D||T==="0"&&A==="=")&&(D=!0,T="0",A="=");var J=P==="$"?r:P==="#"&&/[boxX]/.test(B)?"0"+B.toLowerCase():"",W=P==="$"?n:/[%p]/.test(B)?u:"",H=Rz[B],V=/[defgprs%]/.test(B);$=$===void 0?6:/[gprs]/.test(B)?Math.max(1,Math.min(21,$)):Math.max(0,Math.min(20,$));function se(K){var ce=J,ne=W,re,oe,ae;if(B==="c")ne=H(K)+ne,K="";else{K=+K;var xe=K<0||1/K<0;if(K=isNaN(K)?p:H(Math.abs(K),$),G&&(K=R_e(K)),xe&&+K==0&&I!=="+"&&(xe=!1),ce=(xe?I==="("?I:a:I==="-"||I==="("?"":I)+ce,ne=(B==="s"?$z[8+vG/3]:"")+ne+(xe&&I==="("?")":""),V){for(re=-1,oe=K.length;++re<oe;)if(ae=K.charCodeAt(re),48>ae||ae>57){ne=(ae===46?i+K.slice(re+1):K.slice(re))+ne,K=K.slice(0,re);break}}}O&&!D&&(K=e(K,1/0));var ye=ce.length+K.length+ne.length,Se=ye<L?new Array(L-ye+1).join(T):"";switch(O&&D&&(K=e(Se+K,Se.length?L-ne.length:1/0),Se=""),A){case"<":K=ce+K+ne+Se;break;case"=":K=ce+Se+K+ne;break;case"^":K=Se.slice(0,ye=Se.length>>1)+ce+K+ne+Se.slice(ye);break;default:K=Se+ce+K+ne;break}return o(K)}return se.toString=function(){return w+""},se}function v(w,T){var A=g((w=u_(w),w.type="f",w)),I=Math.max(-8,Math.min(8,Math.floor(Qg(T)/3)))*3,P=Math.pow(10,-I),D=$z[8+I/3];return function(L){return A(P*L)+D}}return{format:g,formatPrefix:v}}var gw,OM,_G;$_e({thousands:",",grouping:[3],currency:["$",""]});function $_e(t){return gw=z_e(t),OM=gw.format,_G=gw.formatPrefix,gw}function F_e(t){return Math.max(0,-Qg(Math.abs(t)))}function B_e(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qg(e)/3)))*3-Qg(Math.abs(t)))}function V_e(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Qg(e)-Qg(t))+1}function bG(t,e,r,n){var i=VC(t,e,r),o;switch(n=u_(n??",f"),n.type){case"s":{var u=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(o=B_e(i,u))&&(n.precision=o),_G(n,u)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=V_e(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=F_e(i))&&(n.precision=o-(n.type==="%")*2);break}}return OM(n)}function df(t){var e=t.domain;return t.ticks=function(r){var n=e();return FC(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return bG(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,o=n.length-1,u=n[i],a=n[o],p,g,v=10;for(a<u&&(g=u,u=a,a=g,g=i,i=o,o=g);v-- >0;){if(g=BC(u,a,r),g===p)return n[i]=u,n[o]=a,e(n);if(g>0)u=Math.floor(u/g)*g,a=Math.ceil(a/g)*g;else if(g<0)u=Math.ceil(u*g)/g,a=Math.floor(a*g)/g;else break;p=g}return t},t}function e0(){var t=MM();return t.copy=function(){return fb(t,e0())},vl.apply(t,arguments),df(t)}function wG(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,ak),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return wG(t).unknown(e)},t=arguments.length?Array.from(t,ak):[0,1],df(r)}function kG(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],o=t[n],u;return o<i&&(u=r,r=n,n=u,u=i,i=o,o=u),t[r]=e.floor(i),t[n]=e.ceil(o),t}function Fz(t){return Math.log(t)}function Bz(t){return Math.exp(t)}function U_e(t){return-Math.log(-t)}function q_e(t){return-Math.exp(-t)}function G_e(t){return isFinite(t)?+("1e"+t):t<0?0:t}function W_e(t){return t===10?G_e:t===Math.E?Math.exp:e=>Math.pow(t,e)}function H_e(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Vz(t){return(e,r)=>-t(-e,r)}function RM(t){const e=t(Fz,Bz),r=e.domain;let n=10,i,o;function u(){return i=H_e(n),o=W_e(n),r()[0]<0?(i=Vz(i),o=Vz(o),t(U_e,q_e)):t(Fz,Bz),e}return e.base=function(a){return arguments.length?(n=+a,u()):n},e.domain=function(a){return arguments.length?(r(a),u()):r()},e.ticks=a=>{const p=r();let g=p[0],v=p[p.length-1];const w=v<g;w&&([g,v]=[v,g]);let T=i(g),A=i(v),I,P;const D=a==null?10:+a;let L=[];if(!(n%1)&&A-T<D){if(T=Math.floor(T),A=Math.ceil(A),g>0){for(;T<=A;++T)for(I=1;I<n;++I)if(P=T<0?I/o(-T):I*o(T),!(P<g)){if(P>v)break;L.push(P)}}else for(;T<=A;++T)for(I=n-1;I>=1;--I)if(P=T>0?I/o(-T):I*o(T),!(P<g)){if(P>v)break;L.push(P)}L.length*2<D&&(L=FC(g,v,D))}else L=FC(T,A,Math.min(A-T,D)).map(o);return w?L.reverse():L},e.tickFormat=(a,p)=>{if(a==null&&(a=10),p==null&&(p=n===10?"s":","),typeof p!="function"&&(!(n%1)&&(p=u_(p)).precision==null&&(p.trim=!0),p=OM(p)),a===1/0)return p;const g=Math.max(1,n*a/e.ticks().length);return v=>{let w=v/o(Math.round(i(v)));return w*n<n-.5&&(w*=n),w<=g?p(v):""}},e.nice=()=>r(kG(r(),{floor:a=>o(Math.floor(i(a))),ceil:a=>o(Math.ceil(i(a)))})),e}function TG(){const t=RM(oS()).domain([1,10]);return t.copy=()=>fb(t,TG()).base(t.base()),vl.apply(t,arguments),t}function Uz(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function qz(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function LM(t){var e=1,r=t(Uz(e),qz(e));return r.constant=function(n){return arguments.length?t(Uz(e=+n),qz(e)):e},df(r)}function SG(){var t=LM(oS());return t.copy=function(){return fb(t,SG()).constant(t.constant())},vl.apply(t,arguments)}function Gz(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function K_e(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Z_e(t){return t<0?-t*t:t*t}function zM(t){var e=t(As,As),r=1;function n(){return r===1?t(As,As):r===.5?t(K_e,Z_e):t(Gz(r),Gz(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},df(e)}function $M(){var t=zM(oS());return t.copy=function(){return fb(t,$M()).exponent(t.exponent())},vl.apply(t,arguments),t}function X_e(){return $M.apply(null,arguments).exponent(.5)}function Wz(t){return Math.sign(t)*t*t}function Y_e(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function EG(){var t=MM(),e=[0,1],r=!1,n;function i(o){var u=Y_e(t(o));return isNaN(u)?n:r?Math.round(u):u}return i.invert=function(o){return t.invert(Wz(o))},i.domain=function(o){return arguments.length?(t.domain(o),i):t.domain()},i.range=function(o){return arguments.length?(t.range((e=Array.from(o,ak)).map(Wz)),i):e.slice()},i.rangeRound=function(o){return i.range(o).round(!0)},i.round=function(o){return arguments.length?(r=!!o,i):r},i.clamp=function(o){return arguments.length?(t.clamp(o),i):t.clamp()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return EG(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},vl.apply(i,arguments),df(i)}function jG(){var t=[],e=[],r=[],n;function i(){var u=0,a=Math.max(1,e.length);for(r=new Array(a-1);++u<a;)r[u-1]=Zve(t,u/a);return o}function o(u){return u==null||isNaN(u=+u)?n:e[db(r,u)]}return o.invertExtent=function(u){var a=e.indexOf(u);return a<0?[NaN,NaN]:[a>0?r[a-1]:t[0],a<r.length?r[a]:t[t.length-1]]},o.domain=function(u){if(!arguments.length)return t.slice();t=[];for(let a of u)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(Dh),i()},o.range=function(u){return arguments.length?(e=Array.from(u),i()):e.slice()},o.unknown=function(u){return arguments.length?(n=u,o):n},o.quantiles=function(){return r.slice()},o.copy=function(){return jG().domain(t).range(e).unknown(n)},vl.apply(o,arguments)}function AG(){var t=0,e=1,r=1,n=[.5],i=[0,1],o;function u(p){return p!=null&&p<=p?i[db(n,p,0,r)]:o}function a(){var p=-1;for(n=new Array(r);++p<r;)n[p]=((p+1)*e-(p-r)*t)/(r+1);return u}return u.domain=function(p){return arguments.length?([t,e]=p,t=+t,e=+e,a()):[t,e]},u.range=function(p){return arguments.length?(r=(i=Array.from(p)).length-1,a()):i.slice()},u.invertExtent=function(p){var g=i.indexOf(p);return g<0?[NaN,NaN]:g<1?[t,n[0]]:g>=r?[n[r-1],e]:[n[g-1],n[g]]},u.unknown=function(p){return arguments.length&&(o=p),u},u.thresholds=function(){return n.slice()},u.copy=function(){return AG().domain([t,e]).range(i).unknown(o)},vl.apply(df(u),arguments)}function NG(){var t=[.5],e=[0,1],r,n=1;function i(o){return o!=null&&o<=o?e[db(t,o,0,n)]:r}return i.domain=function(o){return arguments.length?(t=Array.from(o),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(o){return arguments.length?(e=Array.from(o),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(o){var u=e.indexOf(o);return[t[u-1],t[u]]},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return NG().domain(t).range(e).unknown(r)},vl.apply(i,arguments)}const jA=new Date,AA=new Date;function xa(t,e,r,n){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const u=i(o),a=i.ceil(o);return o-u<a-o?u:a},i.offset=(o,u)=>(e(o=new Date(+o),u==null?1:Math.floor(u)),o),i.range=(o,u,a)=>{const p=[];if(o=i.ceil(o),a=a==null?1:Math.floor(a),!(o<u)||!(a>0))return p;let g;do p.push(g=new Date(+o)),e(o,a),t(o);while(g<o&&o<u);return p},i.filter=o=>xa(u=>{if(u>=u)for(;t(u),!o(u);)u.setTime(u-1)},(u,a)=>{if(u>=u)if(a<0)for(;++a<=0;)for(;e(u,-1),!o(u););else for(;--a>=0;)for(;e(u,1),!o(u););}),r&&(i.count=(o,u)=>(jA.setTime(+o),AA.setTime(+u),t(jA),t(AA),Math.floor(r(jA,AA))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(n?u=>n(u)%o===0:u=>i.count(0,u)%o===0):i)),i}const ok=xa(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);ok.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?xa(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):ok);ok.range;const Hu=1e3,ll=Hu*60,Ku=ll*60,cd=Ku*24,FM=cd*7,Hz=cd*30,NA=cd*365,pp=xa(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Hu)},(t,e)=>(e-t)/Hu,t=>t.getUTCSeconds());pp.range;const BM=xa(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Hu)},(t,e)=>{t.setTime(+t+e*ll)},(t,e)=>(e-t)/ll,t=>t.getMinutes());BM.range;const VM=xa(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*ll)},(t,e)=>(e-t)/ll,t=>t.getUTCMinutes());VM.range;const UM=xa(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Hu-t.getMinutes()*ll)},(t,e)=>{t.setTime(+t+e*Ku)},(t,e)=>(e-t)/Ku,t=>t.getHours());UM.range;const qM=xa(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Ku)},(t,e)=>(e-t)/Ku,t=>t.getUTCHours());qM.range;const pb=xa(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ll)/cd,t=>t.getDate()-1);pb.range;const lS=xa(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/cd,t=>t.getUTCDate()-1);lS.range;const CG=xa(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/cd,t=>Math.floor(t/cd));CG.range;function Kp(t){return xa(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*ll)/FM)}const cS=Kp(0),lk=Kp(1),J_e=Kp(2),Q_e=Kp(3),t0=Kp(4),ebe=Kp(5),tbe=Kp(6);cS.range;lk.range;J_e.range;Q_e.range;t0.range;ebe.range;tbe.range;function Zp(t){return xa(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/FM)}const uS=Zp(0),ck=Zp(1),rbe=Zp(2),nbe=Zp(3),r0=Zp(4),ibe=Zp(5),abe=Zp(6);uS.range;ck.range;rbe.range;nbe.range;r0.range;ibe.range;abe.range;const GM=xa(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());GM.range;const WM=xa(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());WM.range;const ud=xa(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ud.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xa(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});ud.range;const dd=xa(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());dd.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:xa(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});dd.range;function PG(t,e,r,n,i,o){const u=[[pp,1,Hu],[pp,5,5*Hu],[pp,15,15*Hu],[pp,30,30*Hu],[o,1,ll],[o,5,5*ll],[o,15,15*ll],[o,30,30*ll],[i,1,Ku],[i,3,3*Ku],[i,6,6*Ku],[i,12,12*Ku],[n,1,cd],[n,2,2*cd],[r,1,FM],[e,1,Hz],[e,3,3*Hz],[t,1,NA]];function a(g,v,w){const T=v<g;T&&([g,v]=[v,g]);const A=w&&typeof w.range=="function"?w:p(g,v,w),I=A?A.range(g,+v+1):[];return T?I.reverse():I}function p(g,v,w){const T=Math.abs(v-g)/w,A=AM(([,,D])=>D).right(u,T);if(A===u.length)return t.every(VC(g/NA,v/NA,w));if(A===0)return ok.every(Math.max(VC(g,v,w),1));const[I,P]=u[T/u[A-1][2]<u[A][2]/T?A-1:A];return I.every(P)}return[a,p]}const[sbe,obe]=PG(dd,WM,uS,CG,qM,VM),[lbe,cbe]=PG(ud,GM,cS,pb,UM,BM);function CA(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function PA(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Nx(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function ube(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,o=t.days,u=t.shortDays,a=t.months,p=t.shortMonths,g=Cx(i),v=Px(i),w=Cx(o),T=Px(o),A=Cx(u),I=Px(u),P=Cx(a),D=Px(a),L=Cx(p),O=Px(p),$={a:xe,A:ye,b:Se,B:be,c:null,d:Qz,e:Qz,f:Mbe,g:Ube,G:Gbe,H:Cbe,I:Pbe,j:Ibe,L:IG,m:Dbe,M:Obe,p:Ce,q:$e,Q:r8,s:n8,S:Rbe,u:Lbe,U:zbe,V:$be,w:Fbe,W:Bbe,x:null,X:null,y:Vbe,Y:qbe,Z:Wbe,"%":t8},G={a:Ye,A:jt,b:Me,B:St,c:null,d:e8,e:e8,f:Xbe,g:s1e,G:l1e,H:Hbe,I:Kbe,j:Zbe,L:DG,m:Ybe,M:Jbe,p:Ct,q:Ft,Q:r8,s:n8,S:Qbe,u:e1e,U:t1e,V:r1e,w:n1e,W:i1e,x:null,X:null,y:a1e,Y:o1e,Z:c1e,"%":t8},B={a:se,A:K,b:ce,B:ne,c:re,d:Yz,e:Yz,f:Ebe,g:Xz,G:Zz,H:Jz,I:Jz,j:wbe,L:Sbe,m:bbe,M:kbe,p:V,q:_be,Q:Abe,s:Nbe,S:Tbe,u:mbe,U:gbe,V:ybe,w:pbe,W:xbe,x:oe,X:ae,y:Xz,Y:Zz,Z:vbe,"%":jbe};$.x=J(r,$),$.X=J(n,$),$.c=J(e,$),G.x=J(r,G),G.X=J(n,G),G.c=J(e,G);function J(gt,Zt){return function(Tt){var ot=[],ar=-1,mt=0,Lt=gt.length,dr,Gr,qr;for(Tt instanceof Date||(Tt=new Date(+Tt));++ar<Lt;)gt.charCodeAt(ar)===37&&(ot.push(gt.slice(mt,ar)),(Gr=Kz[dr=gt.charAt(++ar)])!=null?dr=gt.charAt(++ar):Gr=dr==="e"?" ":"0",(qr=Zt[dr])&&(dr=qr(Tt,Gr)),ot.push(dr),mt=ar+1);return ot.push(gt.slice(mt,ar)),ot.join("")}}function W(gt,Zt){return function(Tt){var ot=Nx(1900,void 0,1),ar=H(ot,gt,Tt+="",0),mt,Lt;if(ar!=Tt.length)return null;if("Q"in ot)return new Date(ot.Q);if("s"in ot)return new Date(ot.s*1e3+("L"in ot?ot.L:0));if(Zt&&!("Z"in ot)&&(ot.Z=0),"p"in ot&&(ot.H=ot.H%12+ot.p*12),ot.m===void 0&&(ot.m="q"in ot?ot.q:0),"V"in ot){if(ot.V<1||ot.V>53)return null;"w"in ot||(ot.w=1),"Z"in ot?(mt=PA(Nx(ot.y,0,1)),Lt=mt.getUTCDay(),mt=Lt>4||Lt===0?ck.ceil(mt):ck(mt),mt=lS.offset(mt,(ot.V-1)*7),ot.y=mt.getUTCFullYear(),ot.m=mt.getUTCMonth(),ot.d=mt.getUTCDate()+(ot.w+6)%7):(mt=CA(Nx(ot.y,0,1)),Lt=mt.getDay(),mt=Lt>4||Lt===0?lk.ceil(mt):lk(mt),mt=pb.offset(mt,(ot.V-1)*7),ot.y=mt.getFullYear(),ot.m=mt.getMonth(),ot.d=mt.getDate()+(ot.w+6)%7)}else("W"in ot||"U"in ot)&&("w"in ot||(ot.w="u"in ot?ot.u%7:"W"in ot?1:0),Lt="Z"in ot?PA(Nx(ot.y,0,1)).getUTCDay():CA(Nx(ot.y,0,1)).getDay(),ot.m=0,ot.d="W"in ot?(ot.w+6)%7+ot.W*7-(Lt+5)%7:ot.w+ot.U*7-(Lt+6)%7);return"Z"in ot?(ot.H+=ot.Z/100|0,ot.M+=ot.Z%100,PA(ot)):CA(ot)}}function H(gt,Zt,Tt,ot){for(var ar=0,mt=Zt.length,Lt=Tt.length,dr,Gr;ar<mt;){if(ot>=Lt)return-1;if(dr=Zt.charCodeAt(ar++),dr===37){if(dr=Zt.charAt(ar++),Gr=B[dr in Kz?Zt.charAt(ar++):dr],!Gr||(ot=Gr(gt,Tt,ot))<0)return-1}else if(dr!=Tt.charCodeAt(ot++))return-1}return ot}function V(gt,Zt,Tt){var ot=g.exec(Zt.slice(Tt));return ot?(gt.p=v.get(ot[0].toLowerCase()),Tt+ot[0].length):-1}function se(gt,Zt,Tt){var ot=A.exec(Zt.slice(Tt));return ot?(gt.w=I.get(ot[0].toLowerCase()),Tt+ot[0].length):-1}function K(gt,Zt,Tt){var ot=w.exec(Zt.slice(Tt));return ot?(gt.w=T.get(ot[0].toLowerCase()),Tt+ot[0].length):-1}function ce(gt,Zt,Tt){var ot=L.exec(Zt.slice(Tt));return ot?(gt.m=O.get(ot[0].toLowerCase()),Tt+ot[0].length):-1}function ne(gt,Zt,Tt){var ot=P.exec(Zt.slice(Tt));return ot?(gt.m=D.get(ot[0].toLowerCase()),Tt+ot[0].length):-1}function re(gt,Zt,Tt){return H(gt,e,Zt,Tt)}function oe(gt,Zt,Tt){return H(gt,r,Zt,Tt)}function ae(gt,Zt,Tt){return H(gt,n,Zt,Tt)}function xe(gt){return u[gt.getDay()]}function ye(gt){return o[gt.getDay()]}function Se(gt){return p[gt.getMonth()]}function be(gt){return a[gt.getMonth()]}function Ce(gt){return i[+(gt.getHours()>=12)]}function $e(gt){return 1+~~(gt.getMonth()/3)}function Ye(gt){return u[gt.getUTCDay()]}function jt(gt){return o[gt.getUTCDay()]}function Me(gt){return p[gt.getUTCMonth()]}function St(gt){return a[gt.getUTCMonth()]}function Ct(gt){return i[+(gt.getUTCHours()>=12)]}function Ft(gt){return 1+~~(gt.getUTCMonth()/3)}return{format:function(gt){var Zt=J(gt+="",$);return Zt.toString=function(){return gt},Zt},parse:function(gt){var Zt=W(gt+="",!1);return Zt.toString=function(){return gt},Zt},utcFormat:function(gt){var Zt=J(gt+="",G);return Zt.toString=function(){return gt},Zt},utcParse:function(gt){var Zt=W(gt+="",!0);return Zt.toString=function(){return gt},Zt}}}var Kz={"-":"",_:" ",0:"0"},Ca=/^\s*\d+/,dbe=/^%/,hbe=/[\\^$*+?|[\]().{}]/g;function wn(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",o=i.length;return n+(o<r?new Array(r-o+1).join(e)+i:i)}function fbe(t){return t.replace(hbe,"\\$&")}function Cx(t){return new RegExp("^(?:"+t.map(fbe).join("|")+")","i")}function Px(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function pbe(t,e,r){var n=Ca.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function mbe(t,e,r){var n=Ca.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function gbe(t,e,r){var n=Ca.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function ybe(t,e,r){var n=Ca.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function xbe(t,e,r){var n=Ca.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function Zz(t,e,r){var n=Ca.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function Xz(t,e,r){var n=Ca.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function vbe(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function _be(t,e,r){var n=Ca.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function bbe(t,e,r){var n=Ca.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Yz(t,e,r){var n=Ca.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function wbe(t,e,r){var n=Ca.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Jz(t,e,r){var n=Ca.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function kbe(t,e,r){var n=Ca.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function Tbe(t,e,r){var n=Ca.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function Sbe(t,e,r){var n=Ca.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function Ebe(t,e,r){var n=Ca.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function jbe(t,e,r){var n=dbe.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function Abe(t,e,r){var n=Ca.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function Nbe(t,e,r){var n=Ca.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Qz(t,e){return wn(t.getDate(),e,2)}function Cbe(t,e){return wn(t.getHours(),e,2)}function Pbe(t,e){return wn(t.getHours()%12||12,e,2)}function Ibe(t,e){return wn(1+pb.count(ud(t),t),e,3)}function IG(t,e){return wn(t.getMilliseconds(),e,3)}function Mbe(t,e){return IG(t,e)+"000"}function Dbe(t,e){return wn(t.getMonth()+1,e,2)}function Obe(t,e){return wn(t.getMinutes(),e,2)}function Rbe(t,e){return wn(t.getSeconds(),e,2)}function Lbe(t){var e=t.getDay();return e===0?7:e}function zbe(t,e){return wn(cS.count(ud(t)-1,t),e,2)}function MG(t){var e=t.getDay();return e>=4||e===0?t0(t):t0.ceil(t)}function $be(t,e){return t=MG(t),wn(t0.count(ud(t),t)+(ud(t).getDay()===4),e,2)}function Fbe(t){return t.getDay()}function Bbe(t,e){return wn(lk.count(ud(t)-1,t),e,2)}function Vbe(t,e){return wn(t.getFullYear()%100,e,2)}function Ube(t,e){return t=MG(t),wn(t.getFullYear()%100,e,2)}function qbe(t,e){return wn(t.getFullYear()%1e4,e,4)}function Gbe(t,e){var r=t.getDay();return t=r>=4||r===0?t0(t):t0.ceil(t),wn(t.getFullYear()%1e4,e,4)}function Wbe(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+wn(e/60|0,"0",2)+wn(e%60,"0",2)}function e8(t,e){return wn(t.getUTCDate(),e,2)}function Hbe(t,e){return wn(t.getUTCHours(),e,2)}function Kbe(t,e){return wn(t.getUTCHours()%12||12,e,2)}function Zbe(t,e){return wn(1+lS.count(dd(t),t),e,3)}function DG(t,e){return wn(t.getUTCMilliseconds(),e,3)}function Xbe(t,e){return DG(t,e)+"000"}function Ybe(t,e){return wn(t.getUTCMonth()+1,e,2)}function Jbe(t,e){return wn(t.getUTCMinutes(),e,2)}function Qbe(t,e){return wn(t.getUTCSeconds(),e,2)}function e1e(t){var e=t.getUTCDay();return e===0?7:e}function t1e(t,e){return wn(uS.count(dd(t)-1,t),e,2)}function OG(t){var e=t.getUTCDay();return e>=4||e===0?r0(t):r0.ceil(t)}function r1e(t,e){return t=OG(t),wn(r0.count(dd(t),t)+(dd(t).getUTCDay()===4),e,2)}function n1e(t){return t.getUTCDay()}function i1e(t,e){return wn(ck.count(dd(t)-1,t),e,2)}function a1e(t,e){return wn(t.getUTCFullYear()%100,e,2)}function s1e(t,e){return t=OG(t),wn(t.getUTCFullYear()%100,e,2)}function o1e(t,e){return wn(t.getUTCFullYear()%1e4,e,4)}function l1e(t,e){var r=t.getUTCDay();return t=r>=4||r===0?r0(t):r0.ceil(t),wn(t.getUTCFullYear()%1e4,e,4)}function c1e(){return"+0000"}function t8(){return"%"}function r8(t){return+t}function n8(t){return Math.floor(+t/1e3)}var Km,HM,RG;u1e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function u1e(t){return Km=ube(t),HM=Km.format,Km.parse,RG=Km.utcFormat,Km.utcParse,Km}function d1e(t){return new Date(t)}function h1e(t){return t instanceof Date?+t:+new Date(+t)}function KM(t,e,r,n,i,o,u,a,p,g){var v=MM(),w=v.invert,T=v.domain,A=g(".%L"),I=g(":%S"),P=g("%I:%M"),D=g("%I %p"),L=g("%a %d"),O=g("%b %d"),$=g("%B"),G=g("%Y");function B(J){return(p(J)<J?A:a(J)<J?I:u(J)<J?P:o(J)<J?D:n(J)<J?i(J)<J?L:O:r(J)<J?$:G)(J)}return v.invert=function(J){return new Date(w(J))},v.domain=function(J){return arguments.length?T(Array.from(J,h1e)):T().map(d1e)},v.ticks=function(J){var W=T();return t(W[0],W[W.length-1],J??10)},v.tickFormat=function(J,W){return W==null?B:g(W)},v.nice=function(J){var W=T();return(!J||typeof J.range!="function")&&(J=e(W[0],W[W.length-1],J??10)),J?T(kG(W,J)):v},v.copy=function(){return fb(v,KM(t,e,r,n,i,o,u,a,p,g))},v}function LG(){return vl.apply(KM(lbe,cbe,ud,GM,cS,pb,UM,BM,pp,HM).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function f1e(){return vl.apply(KM(sbe,obe,dd,WM,uS,lS,qM,VM,pp,RG).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function dS(){var t=0,e=1,r,n,i,o,u=As,a=!1,p;function g(w){return w==null||isNaN(w=+w)?p:u(i===0?.5:(w=(o(w)-r)*i,a?Math.max(0,Math.min(1,w)):w))}g.domain=function(w){return arguments.length?([t,e]=w,r=o(t=+t),n=o(e=+e),i=r===n?0:1/(n-r),g):[t,e]},g.clamp=function(w){return arguments.length?(a=!!w,g):a},g.interpolator=function(w){return arguments.length?(u=w,g):u};function v(w){return function(T){var A,I;return arguments.length?([A,I]=T,u=w(A,I),g):[u(0),u(1)]}}return g.range=v(J0),g.rangeRound=v(IM),g.unknown=function(w){return arguments.length?(p=w,g):p},function(w){return o=w,r=w(t),n=w(e),i=r===n?0:1/(n-r),g}}function hf(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function ZM(){var t=df(dS()(As));return t.copy=function(){return hf(t,ZM())},kd.apply(t,arguments)}function zG(){var t=RM(dS()).domain([1,10]);return t.copy=function(){return hf(t,zG()).base(t.base())},kd.apply(t,arguments)}function $G(){var t=LM(dS());return t.copy=function(){return hf(t,$G()).constant(t.constant())},kd.apply(t,arguments)}function XM(){var t=zM(dS());return t.copy=function(){return hf(t,XM()).exponent(t.exponent())},kd.apply(t,arguments)}function p1e(){return XM.apply(null,arguments).exponent(.5)}function FG(){var t=[],e=As;function r(n){if(n!=null&&!isNaN(n=+n))return e((db(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Dh),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,o)=>Kve(t,o/n))},r.copy=function(){return FG(e).domain(t)},kd.apply(r,arguments)}function hS(){var t=0,e=.5,r=1,n=1,i,o,u,a,p,g=As,v,w=!1,T;function A(P){return isNaN(P=+P)?T:(P=.5+((P=+v(P))-o)*(n*P<n*o?a:p),g(w?Math.max(0,Math.min(1,P)):P))}A.domain=function(P){return arguments.length?([t,e,r]=P,i=v(t=+t),o=v(e=+e),u=v(r=+r),a=i===o?0:.5/(o-i),p=o===u?0:.5/(u-o),n=o<i?-1:1,A):[t,e,r]},A.clamp=function(P){return arguments.length?(w=!!P,A):w},A.interpolator=function(P){return arguments.length?(g=P,A):g};function I(P){return function(D){var L,O,$;return arguments.length?([L,O,$]=D,g=j_e(P,[L,O,$]),A):[g(0),g(.5),g(1)]}}return A.range=I(J0),A.rangeRound=I(IM),A.unknown=function(P){return arguments.length?(T=P,A):T},function(P){return v=P,i=P(t),o=P(e),u=P(r),a=i===o?0:.5/(o-i),p=o===u?0:.5/(u-o),n=o<i?-1:1,A}}function BG(){var t=df(hS()(As));return t.copy=function(){return hf(t,BG())},kd.apply(t,arguments)}function VG(){var t=RM(hS()).domain([.1,1,10]);return t.copy=function(){return hf(t,VG()).base(t.base())},kd.apply(t,arguments)}function UG(){var t=LM(hS());return t.copy=function(){return hf(t,UG()).constant(t.constant())},kd.apply(t,arguments)}function YM(){var t=zM(hS());return t.copy=function(){return hf(t,YM()).exponent(t.exponent())},kd.apply(t,arguments)}function m1e(){return YM.apply(null,arguments).exponent(.5)}const i8=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:o_,scaleDiverging:BG,scaleDivergingLog:VG,scaleDivergingPow:YM,scaleDivergingSqrt:m1e,scaleDivergingSymlog:UG,scaleIdentity:wG,scaleImplicit:qC,scaleLinear:e0,scaleLog:TG,scaleOrdinal:NM,scalePoint:yv,scalePow:$M,scaleQuantile:jG,scaleQuantize:AG,scaleRadial:EG,scaleSequential:ZM,scaleSequentialLog:zG,scaleSequentialPow:XM,scaleSequentialQuantile:FG,scaleSequentialSqrt:p1e,scaleSequentialSymlog:$G,scaleSqrt:X_e,scaleSymlog:SG,scaleThreshold:NG,scaleTime:LG,scaleUtc:f1e,tickFormat:bG},Symbol.toStringTag,{value:"Module"}));var g1e=U0;function y1e(t,e,r){for(var n=-1,i=t.length;++n<i;){var o=t[n],u=e(o);if(u!=null&&(a===void 0?u===u&&!g1e(u):r(u,a)))var a=u,p=o}return p}var fS=y1e;function x1e(t,e){return t>e}var qG=x1e,v1e=fS,_1e=qG,b1e=Y0;function w1e(t){return t&&t.length?v1e(t,b1e,_1e):void 0}var k1e=w1e;const xh=Pn(k1e);function T1e(t,e){return t<e}var GG=T1e,S1e=fS,E1e=GG,j1e=Y0;function A1e(t){return t&&t.length?S1e(t,j1e,E1e):void 0}var N1e=A1e;const pS=Pn(N1e);var C1e=cM,P1e=hu,I1e=Xq,M1e=so;function D1e(t,e){var r=M1e(t)?C1e:I1e;return r(t,P1e(e))}var O1e=D1e,R1e=Kq,L1e=O1e;function z1e(t,e){return R1e(L1e(t,e),1)}var $1e=z1e;const F1e=Pn($1e);var B1e=TM;function V1e(t,e){return B1e(t,e)}var U1e=V1e;const Wh=Pn(U1e);var Q0=1e9,q1e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},QM,fi=!0,yl="[DecimalError] ",kp=yl+"Invalid argument: ",JM=yl+"Exponent out of range: ",ey=Math.floor,ap=Math.pow,G1e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ko,Sa=1e7,ri=7,WG=9007199254740991,uk=ey(WG/ri),lr={};lr.absoluteValue=lr.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};lr.comparedTo=lr.cmp=function(t){var e,r,n,i,o=this;if(t=new o.constructor(t),o.s!==t.s)return o.s||-t.s;if(o.e!==t.e)return o.e>t.e^o.s<0?1:-1;for(n=o.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(o.d[e]!==t.d[e])return o.d[e]>t.d[e]^o.s<0?1:-1;return n===i?0:n>i^o.s<0?1:-1};lr.decimalPlaces=lr.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*ri;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};lr.dividedBy=lr.div=function(t){return ed(this,new this.constructor(t))};lr.dividedToIntegerBy=lr.idiv=function(t){var e=this,r=e.constructor;return Un(ed(e,new r(t),0,1),r.precision)};lr.equals=lr.eq=function(t){return!this.cmp(t)};lr.exponent=function(){return ia(this)};lr.greaterThan=lr.gt=function(t){return this.cmp(t)>0};lr.greaterThanOrEqualTo=lr.gte=function(t){return this.cmp(t)>=0};lr.isInteger=lr.isint=function(){return this.e>this.d.length-2};lr.isNegative=lr.isneg=function(){return this.s<0};lr.isPositive=lr.ispos=function(){return this.s>0};lr.isZero=function(){return this.s===0};lr.lessThan=lr.lt=function(t){return this.cmp(t)<0};lr.lessThanOrEqualTo=lr.lte=function(t){return this.cmp(t)<1};lr.logarithm=lr.log=function(t){var e,r=this,n=r.constructor,i=n.precision,o=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(ko))throw Error(yl+"NaN");if(r.s<1)throw Error(yl+(r.s?"NaN":"-Infinity"));return r.eq(ko)?new n(0):(fi=!1,e=ed(d_(r,o),d_(t,o),o),fi=!0,Un(e,i))};lr.minus=lr.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?ZG(e,t):HG(e,(t.s=-t.s,t))};lr.modulo=lr.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(yl+"NaN");return r.s?(fi=!1,e=ed(r,t,0,1).times(t),fi=!0,r.minus(e)):Un(new n(r),i)};lr.naturalExponential=lr.exp=function(){return KG(this)};lr.naturalLogarithm=lr.ln=function(){return d_(this)};lr.negated=lr.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};lr.plus=lr.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?HG(e,t):ZG(e,(t.s=-t.s,t))};lr.precision=lr.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(kp+t);if(e=ia(i)+1,n=i.d.length-1,r=n*ri+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};lr.squareRoot=lr.sqrt=function(){var t,e,r,n,i,o,u,a=this,p=a.constructor;if(a.s<1){if(!a.s)return new p(0);throw Error(yl+"NaN")}for(t=ia(a),fi=!1,i=Math.sqrt(+a),i==0||i==1/0?(e=Bc(a.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=ey((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new p(e)):n=new p(i.toString()),r=p.precision,i=u=r+3;;)if(o=n,n=o.plus(ed(a,o,u+2)).times(.5),Bc(o.d).slice(0,u)===(e=Bc(n.d)).slice(0,u)){if(e=e.slice(u-3,u+1),i==u&&e=="4999"){if(Un(o,r+1,0),o.times(o).eq(a)){n=o;break}}else if(e!="9999")break;u+=4}return fi=!0,Un(n,r)};lr.times=lr.mul=function(t){var e,r,n,i,o,u,a,p,g,v=this,w=v.constructor,T=v.d,A=(t=new w(t)).d;if(!v.s||!t.s)return new w(0);for(t.s*=v.s,r=v.e+t.e,p=T.length,g=A.length,p<g&&(o=T,T=A,A=o,u=p,p=g,g=u),o=[],u=p+g,n=u;n--;)o.push(0);for(n=g;--n>=0;){for(e=0,i=p+n;i>n;)a=o[i]+A[n]*T[i-n-1]+e,o[i--]=a%Sa|0,e=a/Sa|0;o[i]=(o[i]+e)%Sa|0}for(;!o[--u];)o.pop();return e?++r:o.shift(),t.d=o,t.e=r,fi?Un(t,w.precision):t};lr.toDecimalPlaces=lr.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(su(t,0,Q0),e===void 0?e=n.rounding:su(e,0,8),Un(r,t+ia(r)+1,e))};lr.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=Rp(n,!0):(su(t,0,Q0),e===void 0?e=i.rounding:su(e,0,8),n=Un(new i(n),t+1,e),r=Rp(n,!0,t+1)),r};lr.toFixed=function(t,e){var r,n,i=this,o=i.constructor;return t===void 0?Rp(i):(su(t,0,Q0),e===void 0?e=o.rounding:su(e,0,8),n=Un(new o(i),t+ia(i)+1,e),r=Rp(n.abs(),!1,t+ia(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};lr.toInteger=lr.toint=function(){var t=this,e=t.constructor;return Un(new e(t),ia(t)+1,e.rounding)};lr.toNumber=function(){return+this};lr.toPower=lr.pow=function(t){var e,r,n,i,o,u,a=this,p=a.constructor,g=12,v=+(t=new p(t));if(!t.s)return new p(ko);if(a=new p(a),!a.s){if(t.s<1)throw Error(yl+"Infinity");return a}if(a.eq(ko))return a;if(n=p.precision,t.eq(ko))return Un(a,n);if(e=t.e,r=t.d.length-1,u=e>=r,o=a.s,u){if((r=v<0?-v:v)<=WG){for(i=new p(ko),e=Math.ceil(n/ri+4),fi=!1;r%2&&(i=i.times(a),s8(i.d,e)),r=ey(r/2),r!==0;)a=a.times(a),s8(a.d,e);return fi=!0,t.s<0?new p(ko).div(i):Un(i,n)}}else if(o<0)throw Error(yl+"NaN");return o=o<0&&t.d[Math.max(e,r)]&1?-1:1,a.s=1,fi=!1,i=t.times(d_(a,n+g)),fi=!0,i=KG(i),i.s=o,i};lr.toPrecision=function(t,e){var r,n,i=this,o=i.constructor;return t===void 0?(r=ia(i),n=Rp(i,r<=o.toExpNeg||r>=o.toExpPos)):(su(t,1,Q0),e===void 0?e=o.rounding:su(e,0,8),i=Un(new o(i),t,e),r=ia(i),n=Rp(i,t<=r||r<=o.toExpNeg,t)),n};lr.toSignificantDigits=lr.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(su(t,1,Q0),e===void 0?e=n.rounding:su(e,0,8)),Un(new n(r),t,e)};lr.toString=lr.valueOf=lr.val=lr.toJSON=lr[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=ia(t),r=t.constructor;return Rp(t,e<=r.toExpNeg||e>=r.toExpPos)};function HG(t,e){var r,n,i,o,u,a,p,g,v=t.constructor,w=v.precision;if(!t.s||!e.s)return e.s||(e=new v(t)),fi?Un(e,w):e;if(p=t.d,g=e.d,u=t.e,i=e.e,p=p.slice(),o=u-i,o){for(o<0?(n=p,o=-o,a=g.length):(n=g,i=u,a=p.length),u=Math.ceil(w/ri),a=u>a?u+1:a+1,o>a&&(o=a,n.length=1),n.reverse();o--;)n.push(0);n.reverse()}for(a=p.length,o=g.length,a-o<0&&(o=a,n=g,g=p,p=n),r=0;o;)r=(p[--o]=p[o]+g[o]+r)/Sa|0,p[o]%=Sa;for(r&&(p.unshift(r),++i),a=p.length;p[--a]==0;)p.pop();return e.d=p,e.e=i,fi?Un(e,w):e}function su(t,e,r){if(t!==~~t||t<e||t>r)throw Error(kp+t)}function Bc(t){var e,r,n,i=t.length-1,o="",u=t[0];if(i>0){for(o+=u,e=1;e<i;e++)n=t[e]+"",r=ri-n.length,r&&(o+=dh(r)),o+=n;u=t[e],n=u+"",r=ri-n.length,r&&(o+=dh(r))}else if(u===0)return"0";for(;u%10===0;)u/=10;return o+u}var ed=function(){function t(n,i){var o,u=0,a=n.length;for(n=n.slice();a--;)o=n[a]*i+u,n[a]=o%Sa|0,u=o/Sa|0;return u&&n.unshift(u),n}function e(n,i,o,u){var a,p;if(o!=u)p=o>u?1:-1;else for(a=p=0;a<o;a++)if(n[a]!=i[a]){p=n[a]>i[a]?1:-1;break}return p}function r(n,i,o){for(var u=0;o--;)n[o]-=u,u=n[o]<i[o]?1:0,n[o]=u*Sa+n[o]-i[o];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,o,u){var a,p,g,v,w,T,A,I,P,D,L,O,$,G,B,J,W,H,V=n.constructor,se=n.s==i.s?1:-1,K=n.d,ce=i.d;if(!n.s)return new V(n);if(!i.s)throw Error(yl+"Division by zero");for(p=n.e-i.e,W=ce.length,B=K.length,A=new V(se),I=A.d=[],g=0;ce[g]==(K[g]||0);)++g;if(ce[g]>(K[g]||0)&&--p,o==null?O=o=V.precision:u?O=o+(ia(n)-ia(i))+1:O=o,O<0)return new V(0);if(O=O/ri+2|0,g=0,W==1)for(v=0,ce=ce[0],O++;(g<B||v)&&O--;g++)$=v*Sa+(K[g]||0),I[g]=$/ce|0,v=$%ce|0;else{for(v=Sa/(ce[0]+1)|0,v>1&&(ce=t(ce,v),K=t(K,v),W=ce.length,B=K.length),G=W,P=K.slice(0,W),D=P.length;D<W;)P[D++]=0;H=ce.slice(),H.unshift(0),J=ce[0],ce[1]>=Sa/2&&++J;do v=0,a=e(ce,P,W,D),a<0?(L=P[0],W!=D&&(L=L*Sa+(P[1]||0)),v=L/J|0,v>1?(v>=Sa&&(v=Sa-1),w=t(ce,v),T=w.length,D=P.length,a=e(w,P,T,D),a==1&&(v--,r(w,W<T?H:ce,T))):(v==0&&(a=v=1),w=ce.slice()),T=w.length,T<D&&w.unshift(0),r(P,w,D),a==-1&&(D=P.length,a=e(ce,P,W,D),a<1&&(v++,r(P,W<D?H:ce,D))),D=P.length):a===0&&(v++,P=[0]),I[g++]=v,a&&P[0]?P[D++]=K[G]||0:(P=[K[G]],D=1);while((G++<B||P[0]!==void 0)&&O--)}return I[0]||I.shift(),A.e=p,Un(A,u?o+ia(A)+1:o)}}();function KG(t,e){var r,n,i,o,u,a,p=0,g=0,v=t.constructor,w=v.precision;if(ia(t)>16)throw Error(JM+ia(t));if(!t.s)return new v(ko);for(e==null?(fi=!1,a=w):a=e,u=new v(.03125);t.abs().gte(.1);)t=t.times(u),g+=5;for(n=Math.log(ap(2,g))/Math.LN10*2+5|0,a+=n,r=i=o=new v(ko),v.precision=a;;){if(i=Un(i.times(t),a),r=r.times(++p),u=o.plus(ed(i,r,a)),Bc(u.d).slice(0,a)===Bc(o.d).slice(0,a)){for(;g--;)o=Un(o.times(o),a);return v.precision=w,e==null?(fi=!0,Un(o,w)):o}o=u}}function ia(t){for(var e=t.e*ri,r=t.d[0];r>=10;r/=10)e++;return e}function IA(t,e,r){if(e>t.LN10.sd())throw fi=!0,r&&(t.precision=r),Error(yl+"LN10 precision limit exceeded");return Un(new t(t.LN10),e)}function dh(t){for(var e="";t--;)e+="0";return e}function d_(t,e){var r,n,i,o,u,a,p,g,v,w=1,T=10,A=t,I=A.d,P=A.constructor,D=P.precision;if(A.s<1)throw Error(yl+(A.s?"NaN":"-Infinity"));if(A.eq(ko))return new P(0);if(e==null?(fi=!1,g=D):g=e,A.eq(10))return e==null&&(fi=!0),IA(P,g);if(g+=T,P.precision=g,r=Bc(I),n=r.charAt(0),o=ia(A),Math.abs(o)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)A=A.times(t),r=Bc(A.d),n=r.charAt(0),w++;o=ia(A),n>1?(A=new P("0."+r),o++):A=new P(n+"."+r.slice(1))}else return p=IA(P,g+2,D).times(o+""),A=d_(new P(n+"."+r.slice(1)),g-T).plus(p),P.precision=D,e==null?(fi=!0,Un(A,D)):A;for(a=u=A=ed(A.minus(ko),A.plus(ko),g),v=Un(A.times(A),g),i=3;;){if(u=Un(u.times(v),g),p=a.plus(ed(u,new P(i),g)),Bc(p.d).slice(0,g)===Bc(a.d).slice(0,g))return a=a.times(2),o!==0&&(a=a.plus(IA(P,g+2,D).times(o+""))),a=ed(a,new P(w),g),P.precision=D,e==null?(fi=!0,Un(a,D)):a;a=p,i+=2}}function a8(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=ey(r/ri),t.d=[],n=(r+1)%ri,r<0&&(n+=ri),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=ri;n<i;)t.d.push(+e.slice(n,n+=ri));e=e.slice(n),n=ri-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),fi&&(t.e>uk||t.e<-uk))throw Error(JM+r)}else t.s=0,t.e=0,t.d=[0];return t}function Un(t,e,r){var n,i,o,u,a,p,g,v,w=t.d;for(u=1,o=w[0];o>=10;o/=10)u++;if(n=e-u,n<0)n+=ri,i=e,g=w[v=0];else{if(v=Math.ceil((n+1)/ri),o=w.length,v>=o)return t;for(g=o=w[v],u=1;o>=10;o/=10)u++;n%=ri,i=n-ri+u}if(r!==void 0&&(o=ap(10,u-i-1),a=g/o%10|0,p=e<0||w[v+1]!==void 0||g%o,p=r<4?(a||p)&&(r==0||r==(t.s<0?3:2)):a>5||a==5&&(r==4||p||r==6&&(n>0?i>0?g/ap(10,u-i):0:w[v-1])%10&1||r==(t.s<0?8:7))),e<1||!w[0])return p?(o=ia(t),w.length=1,e=e-o-1,w[0]=ap(10,(ri-e%ri)%ri),t.e=ey(-e/ri)||0):(w.length=1,w[0]=t.e=t.s=0),t;if(n==0?(w.length=v,o=1,v--):(w.length=v+1,o=ap(10,ri-n),w[v]=i>0?(g/ap(10,u-i)%ap(10,i)|0)*o:0),p)for(;;)if(v==0){(w[0]+=o)==Sa&&(w[0]=1,++t.e);break}else{if(w[v]+=o,w[v]!=Sa)break;w[v--]=0,o=1}for(n=w.length;w[--n]===0;)w.pop();if(fi&&(t.e>uk||t.e<-uk))throw Error(JM+ia(t));return t}function ZG(t,e){var r,n,i,o,u,a,p,g,v,w,T=t.constructor,A=T.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new T(t),fi?Un(e,A):e;if(p=t.d,w=e.d,n=e.e,g=t.e,p=p.slice(),u=g-n,u){for(v=u<0,v?(r=p,u=-u,a=w.length):(r=w,n=g,a=p.length),i=Math.max(Math.ceil(A/ri),a)+2,u>i&&(u=i,r.length=1),r.reverse(),i=u;i--;)r.push(0);r.reverse()}else{for(i=p.length,a=w.length,v=i<a,v&&(a=i),i=0;i<a;i++)if(p[i]!=w[i]){v=p[i]<w[i];break}u=0}for(v&&(r=p,p=w,w=r,e.s=-e.s),a=p.length,i=w.length-a;i>0;--i)p[a++]=0;for(i=w.length;i>u;){if(p[--i]<w[i]){for(o=i;o&&p[--o]===0;)p[o]=Sa-1;--p[o],p[i]+=Sa}p[i]-=w[i]}for(;p[--a]===0;)p.pop();for(;p[0]===0;p.shift())--n;return p[0]?(e.d=p,e.e=n,fi?Un(e,A):e):new T(0)}function Rp(t,e,r){var n,i=ia(t),o=Bc(t.d),u=o.length;return e?(r&&(n=r-u)>0?o=o.charAt(0)+"."+o.slice(1)+dh(n):u>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(i<0?"e":"e+")+i):i<0?(o="0."+dh(-i-1)+o,r&&(n=r-u)>0&&(o+=dh(n))):i>=u?(o+=dh(i+1-u),r&&(n=r-i-1)>0&&(o=o+"."+dh(n))):((n=i+1)<u&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-u)>0&&(i+1===u&&(o+="."),o+=dh(n))),t.s<0?"-"+o:o}function s8(t,e){if(t.length>e)return t.length=e,!0}function XG(t){var e,r,n;function i(o){var u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,o instanceof i){u.s=o.s,u.e=o.e,u.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(kp+o);if(o>0)u.s=1;else if(o<0)o=-o,u.s=-1;else{u.s=0,u.e=0,u.d=[0];return}if(o===~~o&&o<1e7){u.e=0,u.d=[o];return}return a8(u,o.toString())}else if(typeof o!="string")throw Error(kp+o);if(o.charCodeAt(0)===45?(o=o.slice(1),u.s=-1):u.s=1,G1e.test(o))a8(u,o);else throw Error(kp+o)}if(i.prototype=lr,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=XG,i.config=i.set=W1e,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function W1e(t){if(!t||typeof t!="object")throw Error(yl+"Object expected");var e,r,n,i=["precision",1,Q0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(ey(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(kp+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(kp+r+": "+n);return this}var QM=XG(q1e);ko=new QM(1);const Ln=QM;function H1e(t){return Y1e(t)||X1e(t)||Z1e(t)||K1e()}function K1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z1e(t,e){if(t){if(typeof t=="string")return ZC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZC(t,e)}}function X1e(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Y1e(t){if(Array.isArray(t))return ZC(t)}function ZC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var J1e=function(e){return e},YG={"@@functional/placeholder":!0},JG=function(e){return e===YG},o8=function(e){return function r(){return arguments.length===0||arguments.length===1&&JG(arguments.length<=0?void 0:arguments[0])?r:e.apply(void 0,arguments)}},Q1e=function t(e,r){return e===1?r:o8(function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var u=i.filter(function(a){return a!==YG}).length;return u>=e?r.apply(void 0,i):t(e-u,o8(function(){for(var a=arguments.length,p=new Array(a),g=0;g<a;g++)p[g]=arguments[g];var v=i.map(function(w){return JG(w)?p.shift():w});return r.apply(void 0,H1e(v).concat(p))}))})},mS=function(e){return Q1e(e.length,e)},XC=function(e,r){for(var n=[],i=e;i<r;++i)n[i-e]=i;return n},ewe=mS(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(r){return e[r]}).map(t)}),twe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return J1e;var i=r.reverse(),o=i[0],u=i.slice(1);return function(){return u.reduce(function(a,p){return p(a)},o.apply(void 0,arguments))}},YC=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},QG=function(e){var r=null,n=null;return function(){for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return r&&o.every(function(a,p){return a===r[p]})||(r=o,n=e.apply(void 0,o)),n}};function rwe(t){var e;return t===0?e=1:e=Math.floor(new Ln(t).abs().log(10).toNumber())+1,e}function nwe(t,e,r){for(var n=new Ln(t),i=0,o=[];n.lt(e)&&i<1e5;)o.push(n.toNumber()),n=n.add(r),i++;return o}var iwe=mS(function(t,e,r){var n=+t,i=+e;return n+r*(i-n)}),awe=mS(function(t,e,r){var n=e-+t;return n=n||1/0,(r-t)/n}),swe=mS(function(t,e,r){var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});const gS={rangeStep:nwe,getDigitCount:rwe,interpolateNumber:iwe,uninterpolateNumber:awe,uninterpolateTruncation:swe};function JC(t){return cwe(t)||lwe(t)||eW(t)||owe()}function owe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lwe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function cwe(t){if(Array.isArray(t))return QC(t)}function h_(t,e){return hwe(t)||dwe(t,e)||eW(t,e)||uwe()}function uwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eW(t,e){if(t){if(typeof t=="string")return QC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QC(t,e)}}function QC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function dwe(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var r=[],n=!0,i=!1,o=void 0;try{for(var u=t[Symbol.iterator](),a;!(n=(a=u.next()).done)&&(r.push(a.value),!(e&&r.length===e));n=!0);}catch(p){i=!0,o=p}finally{try{!n&&u.return!=null&&u.return()}finally{if(i)throw o}}return r}}function hwe(t){if(Array.isArray(t))return t}function tW(t){var e=h_(t,2),r=e[0],n=e[1],i=r,o=n;return r>n&&(i=n,o=r),[i,o]}function rW(t,e,r){if(t.lte(0))return new Ln(0);var n=gS.getDigitCount(t.toNumber()),i=new Ln(10).pow(n),o=t.div(i),u=n!==1?.05:.1,a=new Ln(Math.ceil(o.div(u).toNumber())).add(r).mul(u),p=a.mul(i);return e?p:new Ln(Math.ceil(p))}function fwe(t,e,r){var n=1,i=new Ln(t);if(!i.isint()&&r){var o=Math.abs(t);o<1?(n=new Ln(10).pow(gS.getDigitCount(t)-1),i=new Ln(Math.floor(i.div(n).toNumber())).mul(n)):o>1&&(i=new Ln(Math.floor(t)))}else t===0?i=new Ln(Math.floor((e-1)/2)):r||(i=new Ln(Math.floor(t)));var u=Math.floor((e-1)/2),a=twe(ewe(function(p){return i.add(new Ln(p-u).mul(n)).toNumber()}),XC);return a(0,e)}function nW(t,e,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(r-1)))return{step:new Ln(0),tickMin:new Ln(0),tickMax:new Ln(0)};var o=rW(new Ln(e).sub(t).div(r-1),n,i),u;t<=0&&e>=0?u=new Ln(0):(u=new Ln(t).add(e).div(2),u=u.sub(new Ln(u).mod(o)));var a=Math.ceil(u.sub(t).div(o).toNumber()),p=Math.ceil(new Ln(e).sub(u).div(o).toNumber()),g=a+p+1;return g>r?nW(t,e,r,n,i+1):(g<r&&(p=e>0?p+(r-g):p,a=e>0?a:a+(r-g)),{step:o,tickMin:u.sub(new Ln(a).mul(o)),tickMax:u.add(new Ln(p).mul(o))})}function pwe(t){var e=h_(t,2),r=e[0],n=e[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=Math.max(i,2),a=tW([r,n]),p=h_(a,2),g=p[0],v=p[1];if(g===-1/0||v===1/0){var w=v===1/0?[g].concat(JC(XC(0,i-1).map(function(){return 1/0}))):[].concat(JC(XC(0,i-1).map(function(){return-1/0})),[v]);return r>n?YC(w):w}if(g===v)return fwe(g,i,o);var T=nW(g,v,u,o),A=T.step,I=T.tickMin,P=T.tickMax,D=gS.rangeStep(I,P.add(new Ln(.1).mul(A)),A);return r>n?YC(D):D}function mwe(t,e){var r=h_(t,2),n=r[0],i=r[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=tW([n,i]),a=h_(u,2),p=a[0],g=a[1];if(p===-1/0||g===1/0)return[n,i];if(p===g)return[p];var v=Math.max(e,2),w=rW(new Ln(g).sub(p).div(v-1),o,0),T=[].concat(JC(gS.rangeStep(new Ln(p),new Ln(g).sub(new Ln(.99).mul(w)),w)),[g]);return n>i?YC(T):T}var gwe=QG(pwe),ywe=QG(mwe),xwe=!0,MA="Invariant failed";function Lp(t,e){if(!t){if(xwe)throw new Error(MA);var r=typeof e=="function"?e():e,n=r?"".concat(MA,": ").concat(r):MA;throw new Error(n)}}var vwe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function n0(t){"@babel/helpers - typeof";return n0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n0(t)}function dk(){return dk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dk.apply(this,arguments)}function _we(t,e){return Twe(t)||kwe(t,e)||wwe(t,e)||bwe()}function bwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wwe(t,e){if(t){if(typeof t=="string")return l8(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l8(t,e)}}function l8(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kwe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function Twe(t){if(Array.isArray(t))return t}function Swe(t,e){if(t==null)return{};var r=Ewe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Ewe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function jwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c8(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sW(n.key),n)}}function Awe(t,e,r){return e&&c8(t.prototype,e),r&&c8(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nwe(t,e,r){return e=hk(e),Cwe(t,iW()?Reflect.construct(e,r||[],hk(t).constructor):e.apply(t,r))}function Cwe(t,e){if(e&&(n0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pwe(t)}function Pwe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iW=function(){return!!t})()}function hk(t){return hk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hk(t)}function Iwe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eP(t,e)}function eP(t,e){return eP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},eP(t,e)}function aW(t,e,r){return e=sW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sW(t){var e=Mwe(t,"string");return n0(e)=="symbol"?e:e+""}function Mwe(t,e){if(n0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(n0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ty=function(t){function e(){return jwe(this,e),Nwe(this,e,arguments)}return Iwe(e,t),Awe(e,[{key:"render",value:function(){var n=this.props,i=n.offset,o=n.layout,u=n.width,a=n.dataKey,p=n.data,g=n.dataPointFormatter,v=n.xAxis,w=n.yAxis,T=Swe(n,vwe),A=fr(T,!1);this.props.direction==="x"&&v.type!=="number"&&Lp(!1);var I=p.map(function(P){var D=g(P,a),L=D.x,O=D.y,$=D.value,G=D.errorVal;if(!G)return null;var B=[],J,W;if(Array.isArray(G)){var H=_we(G,2);J=H[0],W=H[1]}else J=W=G;if(o==="vertical"){var V=v.scale,se=O+i,K=se+u,ce=se-u,ne=V($-J),re=V($+W);B.push({x1:re,y1:K,x2:re,y2:ce}),B.push({x1:ne,y1:se,x2:re,y2:se}),B.push({x1:ne,y1:K,x2:ne,y2:ce})}else if(o==="horizontal"){var oe=w.scale,ae=L+i,xe=ae-u,ye=ae+u,Se=oe($-J),be=oe($+W);B.push({x1:xe,y1:be,x2:ye,y2:be}),B.push({x1:ae,y1:Se,x2:ae,y2:be}),B.push({x1:xe,y1:Se,x2:ye,y2:Se})}return Le.createElement(Ur,dk({className:"recharts-errorBar",key:"bar-".concat(B.map(function(Ce){return"".concat(Ce.x1,"-").concat(Ce.x2,"-").concat(Ce.y1,"-").concat(Ce.y2)}))},A),B.map(function(Ce){return Le.createElement("line",dk({},Ce,{key:"line-".concat(Ce.x1,"-").concat(Ce.x2,"-").concat(Ce.y1,"-").concat(Ce.y2)}))}))});return Le.createElement(Ur,{className:"recharts-errorBars"},I)}}])}(Le.Component);aW(ty,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});aW(ty,"displayName","ErrorBar");function f_(t){"@babel/helpers - typeof";return f_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f_(t)}function u8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Yf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?u8(Object(r),!0).forEach(function(n){Dwe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Dwe(t,e,r){return e=Owe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Owe(t){var e=Rwe(t,"string");return f_(e)=="symbol"?e:e+""}function Rwe(t,e){if(f_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(f_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oW=function(e){var r=e.children,n=e.formattedGraphicalItems,i=e.legendWidth,o=e.legendContent,u=wo(r,Hc);if(!u)return null;var a=Hc.defaultProps,p=a!==void 0?Yf(Yf({},a),u.props):{},g;return u.props&&u.props.payload?g=u.props&&u.props.payload:o==="children"?g=(n||[]).reduce(function(v,w){var T=w.item,A=w.props,I=A.sectors||A.data||[];return v.concat(I.map(function(P){return{type:u.props.iconType||T.props.legendType,value:P.name,color:P.fill,payload:P}}))},[]):g=(n||[]).map(function(v){var w=v.item,T=w.type.defaultProps,A=T!==void 0?Yf(Yf({},T),w.props):{},I=A.dataKey,P=A.name,D=A.legendType,L=A.hide;return{inactive:L,dataKey:I,type:p.iconType||D||"square",color:e3(w),value:P||I,payload:A}}),Yf(Yf(Yf({},p),Hc.getWithHeight(u,i)),{},{payload:g,item:u})};function p_(t){"@babel/helpers - typeof";return p_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p_(t)}function d8(t){return Fwe(t)||$we(t)||zwe(t)||Lwe()}function Lwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zwe(t,e){if(t){if(typeof t=="string")return tP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tP(t,e)}}function $we(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Fwe(t){if(Array.isArray(t))return tP(t)}function tP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function h8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ri(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?h8(Object(r),!0).forEach(function(n){Pg(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Pg(t,e,r){return e=Bwe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bwe(t){var e=Vwe(t,"string");return p_(e)=="symbol"?e:e+""}function Vwe(t,e){if(p_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(p_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ai(t,e,r){return _r(t)||_r(e)?r:pa(e)?jo(t,e,r):Tr(e)?e(t):r}function xv(t,e,r,n){var i=F1e(t,function(a){return ai(a,e)});if(r==="number"){var o=i.filter(function(a){return Bt(a)||parseFloat(a)});return o.length?[pS(o),xh(o)]:[1/0,-1/0]}var u=n?i.filter(function(a){return!_r(a)}):i;return u.map(function(a){return pa(a)||a instanceof Date?a:""})}var Uwe=function(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,u=-1,a=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(a<=1)return 0;if(o&&o.axisType==="angleAxis"&&Math.abs(Math.abs(o.range[1]-o.range[0])-360)<=1e-6)for(var p=o.range,g=0;g<a;g++){var v=g>0?i[g-1].coordinate:i[a-1].coordinate,w=i[g].coordinate,T=g>=a-1?i[0].coordinate:i[g+1].coordinate,A=void 0;if(Es(w-v)!==Es(T-w)){var I=[];if(Es(T-w)===Es(p[1]-p[0])){A=T;var P=w+p[1]-p[0];I[0]=Math.min(P,(P+v)/2),I[1]=Math.max(P,(P+v)/2)}else{A=v;var D=T+p[1]-p[0];I[0]=Math.min(w,(D+w)/2),I[1]=Math.max(w,(D+w)/2)}var L=[Math.min(w,(A+w)/2),Math.max(w,(A+w)/2)];if(e>L[0]&&e<=L[1]||e>=I[0]&&e<=I[1]){u=i[g].index;break}}else{var O=Math.min(v,T),$=Math.max(v,T);if(e>(O+w)/2&&e<=($+w)/2){u=i[g].index;break}}}else for(var G=0;G<a;G++)if(G===0&&e<=(n[G].coordinate+n[G+1].coordinate)/2||G>0&&G<a-1&&e>(n[G].coordinate+n[G-1].coordinate)/2&&e<=(n[G].coordinate+n[G+1].coordinate)/2||G===a-1&&e>(n[G].coordinate+n[G-1].coordinate)/2){u=n[G].index;break}return u},e3=function(e){var r,n=e,i=n.type.displayName,o=(r=e.type)!==null&&r!==void 0&&r.defaultProps?Ri(Ri({},e.type.defaultProps),e.props):e.props,u=o.stroke,a=o.fill,p;switch(i){case"Line":p=u;break;case"Area":case"Radar":p=u&&u!=="none"?u:a;break;default:p=a;break}return p},qwe=function(e){var r=e.barSize,n=e.totalSize,i=e.stackGroups,o=i===void 0?{}:i;if(!o)return{};for(var u={},a=Object.keys(o),p=0,g=a.length;p<g;p++)for(var v=o[a[p]].stackGroups,w=Object.keys(v),T=0,A=w.length;T<A;T++){var I=v[w[T]],P=I.items,D=I.cateAxisId,L=P.filter(function(W){return Qu(W.type).indexOf("Bar")>=0});if(L&&L.length){var O=L[0].type.defaultProps,$=O!==void 0?Ri(Ri({},O),L[0].props):L[0].props,G=$.barSize,B=$[D];u[B]||(u[B]=[]);var J=_r(G)?r:G;u[B].push({item:L[0],stackList:L.slice(1),barSize:_r(J)?void 0:js(J,n,0)})}}return u},Gwe=function(e){var r=e.barGap,n=e.barCategoryGap,i=e.bandSize,o=e.sizeList,u=o===void 0?[]:o,a=e.maxBarSize,p=u.length;if(p<1)return null;var g=js(r,i,0,!0),v,w=[];if(u[0].barSize===+u[0].barSize){var T=!1,A=i/p,I=u.reduce(function(G,B){return G+B.barSize||0},0);I+=(p-1)*g,I>=i&&(I-=(p-1)*g,g=0),I>=i&&A>0&&(T=!0,A*=.9,I=p*A);var P=(i-I)/2>>0,D={offset:P-g,size:0};v=u.reduce(function(G,B){var J={item:B.item,position:{offset:D.offset+D.size+g,size:T?A:B.barSize}},W=[].concat(d8(G),[J]);return D=W[W.length-1].position,B.stackList&&B.stackList.length&&B.stackList.forEach(function(H){W.push({item:H,position:D})}),W},w)}else{var L=js(n,i,0,!0);i-2*L-(p-1)*g<=0&&(g=0);var O=(i-2*L-(p-1)*g)/p;O>1&&(O>>=0);var $=a===+a?Math.min(O,a):O;v=u.reduce(function(G,B,J){var W=[].concat(d8(G),[{item:B.item,position:{offset:L+(O+g)*J+(O-$)/2,size:$}}]);return B.stackList&&B.stackList.length&&B.stackList.forEach(function(H){W.push({item:H,position:W[W.length-1].position})}),W},w)}return v},Wwe=function(e,r,n,i){var o=n.children,u=n.width,a=n.margin,p=u-(a.left||0)-(a.right||0),g=oW({children:o,legendWidth:p});if(g){var v=i||{},w=v.width,T=v.height,A=g.align,I=g.verticalAlign,P=g.layout;if((P==="vertical"||P==="horizontal"&&I==="middle")&&A!=="center"&&Bt(e[A]))return Ri(Ri({},e),{},Pg({},A,e[A]+(w||0)));if((P==="horizontal"||P==="vertical"&&A==="center")&&I!=="middle"&&Bt(e[I]))return Ri(Ri({},e),{},Pg({},I,e[I]+(T||0)))}return e},Hwe=function(e,r,n){return _r(r)?!0:e==="horizontal"?r==="yAxis":e==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},lW=function(e,r,n,i,o){var u=r.props.children,a=Ps(u,ty).filter(function(g){return Hwe(i,o,g.props.direction)});if(a&&a.length){var p=a.map(function(g){return g.props.dataKey});return e.reduce(function(g,v){var w=ai(v,n);if(_r(w))return g;var T=Array.isArray(w)?[pS(w),xh(w)]:[w,w],A=p.reduce(function(I,P){var D=ai(v,P,0),L=T[0]-Math.abs(Array.isArray(D)?D[0]:D),O=T[1]+Math.abs(Array.isArray(D)?D[1]:D);return[Math.min(L,I[0]),Math.max(O,I[1])]},[1/0,-1/0]);return[Math.min(A[0],g[0]),Math.max(A[1],g[1])]},[1/0,-1/0])}return null},Kwe=function(e,r,n,i,o){var u=r.map(function(a){return lW(e,a,n,o,i)}).filter(function(a){return!_r(a)});return u&&u.length?u.reduce(function(a,p){return[Math.min(a[0],p[0]),Math.max(a[1],p[1])]},[1/0,-1/0]):null},cW=function(e,r,n,i,o){var u=r.map(function(p){var g=p.props.dataKey;return n==="number"&&g&&lW(e,p,g,i)||xv(e,g,n,o)});if(n==="number")return u.reduce(function(p,g){return[Math.min(p[0],g[0]),Math.max(p[1],g[1])]},[1/0,-1/0]);var a={};return u.reduce(function(p,g){for(var v=0,w=g.length;v<w;v++)a[g[v]]||(a[g[v]]=!0,p.push(g[v]));return p},[])},uW=function(e,r){return e==="horizontal"&&r==="xAxis"||e==="vertical"&&r==="yAxis"||e==="centric"&&r==="angleAxis"||e==="radial"&&r==="radiusAxis"},dW=function(e,r,n,i){if(i)return e.map(function(p){return p.coordinate});var o,u,a=e.map(function(p){return p.coordinate===r&&(o=!0),p.coordinate===n&&(u=!0),p.coordinate});return o||a.push(r),u||a.push(n),a},Zu=function(e,r,n){if(!e)return null;var i=e.scale,o=e.duplicateDomain,u=e.type,a=e.range,p=e.realScaleType==="scaleBand"?i.bandwidth()/2:2,g=(r||n)&&u==="category"&&i.bandwidth?i.bandwidth()/p:0;if(g=e.axisType==="angleAxis"&&(a==null?void 0:a.length)>=2?Es(a[0]-a[1])*2*g:g,r&&(e.ticks||e.niceTicks)){var v=(e.ticks||e.niceTicks).map(function(w){var T=o?o.indexOf(w):w;return{coordinate:i(T)+g,value:w,offset:g}});return v.filter(function(w){return!K0(w.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(w,T){return{coordinate:i(w)+g,value:w,index:T,offset:g}}):i.ticks&&!n?i.ticks(e.tickCount).map(function(w){return{coordinate:i(w)+g,value:w,offset:g}}):i.domain().map(function(w,T){return{coordinate:i(w)+g,value:o?o[w]:w,index:T,offset:g}})},DA=new WeakMap,yw=function(e,r){if(typeof r!="function")return e;DA.has(e)||DA.set(e,new WeakMap);var n=DA.get(e);if(n.has(r))return n.get(r);var i=function(){e.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,i),i},hW=function(e,r,n){var i=e.scale,o=e.type,u=e.layout,a=e.axisType;if(i==="auto")return u==="radial"&&a==="radiusAxis"?{scale:o_(),realScaleType:"band"}:u==="radial"&&a==="angleAxis"?{scale:e0(),realScaleType:"linear"}:o==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:yv(),realScaleType:"point"}:o==="category"?{scale:o_(),realScaleType:"band"}:{scale:e0(),realScaleType:"linear"};if(Dp(i)){var p="scale".concat(QT(i));return{scale:(i8[p]||yv)(),realScaleType:i8[p]?p:"point"}}return Tr(i)?{scale:i}:{scale:yv(),realScaleType:"point"}},f8=1e-4,fW=function(e){var r=e.domain();if(!(!r||r.length<=2)){var n=r.length,i=e.range(),o=Math.min(i[0],i[1])-f8,u=Math.max(i[0],i[1])+f8,a=e(r[0]),p=e(r[n-1]);(a<o||a>u||p<o||p>u)&&e.domain([r[0],r[n-1]])}},Zwe=function(e,r){if(!e)return null;for(var n=0,i=e.length;n<i;n++)if(e[n].item===r)return e[n].position;return null},Xwe=function(e,r){if(!r||r.length!==2||!Bt(r[0])||!Bt(r[1]))return e;var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]),o=[e[0],e[1]];return(!Bt(e[0])||e[0]<n)&&(o[0]=n),(!Bt(e[1])||e[1]>i)&&(o[1]=i),o[0]>i&&(o[0]=i),o[1]<n&&(o[1]=n),o},Ywe=function(e){var r=e.length;if(!(r<=0))for(var n=0,i=e[0].length;n<i;++n)for(var o=0,u=0,a=0;a<r;++a){var p=K0(e[a][n][1])?e[a][n][0]:e[a][n][1];p>=0?(e[a][n][0]=o,e[a][n][1]=o+p,o=e[a][n][1]):(e[a][n][0]=u,e[a][n][1]=u+p,u=e[a][n][1])}},Jwe=function(e){var r=e.length;if(!(r<=0))for(var n=0,i=e[0].length;n<i;++n)for(var o=0,u=0;u<r;++u){var a=K0(e[u][n][1])?e[u][n][0]:e[u][n][1];a>=0?(e[u][n][0]=o,e[u][n][1]=o+a,o=e[u][n][1]):(e[u][n][0]=0,e[u][n][1]=0)}},Qwe={sign:Ywe,expand:mde,none:Hg,silhouette:gde,wiggle:yde,positive:Jwe},e2e=function(e,r,n){var i=r.map(function(a){return a.props.dataKey}),o=Qwe[n],u=pde().keys(i).value(function(a,p){return+ai(a,p,0)}).order(TC).offset(o);return u(e)},t2e=function(e,r,n,i,o,u){if(!e)return null;var a=u?r.reverse():r,p={},g=a.reduce(function(w,T){var A,I=(A=T.type)!==null&&A!==void 0&&A.defaultProps?Ri(Ri({},T.type.defaultProps),T.props):T.props,P=I.stackId,D=I.hide;if(D)return w;var L=I[n],O=w[L]||{hasStack:!1,stackGroups:{}};if(pa(P)){var $=O.stackGroups[P]||{numericAxisId:n,cateAxisId:i,items:[]};$.items.push(T),O.hasStack=!0,O.stackGroups[P]=$}else O.stackGroups[uf("_stackId_")]={numericAxisId:n,cateAxisId:i,items:[T]};return Ri(Ri({},w),{},Pg({},L,O))},p),v={};return Object.keys(g).reduce(function(w,T){var A=g[T];if(A.hasStack){var I={};A.stackGroups=Object.keys(A.stackGroups).reduce(function(P,D){var L=A.stackGroups[D];return Ri(Ri({},P),{},Pg({},D,{numericAxisId:n,cateAxisId:i,items:L.items,stackedData:e2e(e,L.items,o)}))},I)}return Ri(Ri({},w),{},Pg({},T,A))},v)},pW=function(e,r){var n=r.realScaleType,i=r.type,o=r.tickCount,u=r.originalDomain,a=r.allowDecimals,p=n||r.scale;if(p!=="auto"&&p!=="linear")return null;if(o&&i==="number"&&u&&(u[0]==="auto"||u[1]==="auto")){var g=e.domain();if(!g.length)return null;var v=gwe(g,o,a);return e.domain([pS(v),xh(v)]),{niceTicks:v}}if(o&&i==="number"){var w=e.domain(),T=ywe(w,o,a);return{niceTicks:T}}return null};function i0(t){var e=t.axis,r=t.ticks,n=t.bandSize,i=t.entry,o=t.index,u=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!_r(i[e.dataKey])){var a=F2(r,"value",i[e.dataKey]);if(a)return a.coordinate+n/2}return r[o]?r[o].coordinate+n/2:null}var p=ai(i,_r(u)?e.dataKey:u);return _r(p)?null:e.scale(p)}var p8=function(e){var r=e.axis,n=e.ticks,i=e.offset,o=e.bandSize,u=e.entry,a=e.index;if(r.type==="category")return n[a]?n[a].coordinate+i:null;var p=ai(u,r.dataKey,r.domain[a]);return _r(p)?null:r.scale(p)-o/2+i},r2e=function(e){var r=e.numericAxis,n=r.scale.domain();if(r.type==="number"){var i=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]);return i<=0&&o>=0?0:o<0?o:i}return n[0]},n2e=function(e,r){var n,i=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Ri(Ri({},e.type.defaultProps),e.props):e.props,o=i.stackId;if(pa(o)){var u=r[o];if(u){var a=u.items.indexOf(e);return a>=0?u.stackedData[a]:null}}return null},i2e=function(e){return e.reduce(function(r,n){return[pS(n.concat([r[0]]).filter(Bt)),xh(n.concat([r[1]]).filter(Bt))]},[1/0,-1/0])},mW=function(e,r,n){return Object.keys(e).reduce(function(i,o){var u=e[o],a=u.stackedData,p=a.reduce(function(g,v){var w=i2e(v.slice(r,n+1));return[Math.min(g[0],w[0]),Math.max(g[1],w[1])]},[1/0,-1/0]);return[Math.min(p[0],i[0]),Math.max(p[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},m8=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,g8=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,rP=function(e,r,n){if(Tr(e))return e(r,n);if(!Array.isArray(e))return r;var i=[];if(Bt(e[0]))i[0]=n?e[0]:Math.min(e[0],r[0]);else if(m8.test(e[0])){var o=+m8.exec(e[0])[1];i[0]=r[0]-o}else Tr(e[0])?i[0]=e[0](r[0]):i[0]=r[0];if(Bt(e[1]))i[1]=n?e[1]:Math.max(e[1],r[1]);else if(g8.test(e[1])){var u=+g8.exec(e[1])[1];i[1]=r[1]+u}else Tr(e[1])?i[1]=e[1](r[1]):i[1]=r[1];return i},fk=function(e,r,n){if(e&&e.scale&&e.scale.bandwidth){var i=e.scale.bandwidth();if(!n||i>0)return i}if(e&&r&&r.length>=2){for(var o=EM(r,function(w){return w.coordinate}),u=1/0,a=1,p=o.length;a<p;a++){var g=o[a],v=o[a-1];u=Math.min((g.coordinate||0)-(v.coordinate||0),u)}return u===1/0?0:u}return n?void 0:0},y8=function(e,r,n){return!e||!e.length||Wh(e,jo(n,"type.defaultProps.domain"))?r:e},gW=function(e,r){var n=e.type.defaultProps?Ri(Ri({},e.type.defaultProps),e.props):e.props,i=n.dataKey,o=n.name,u=n.unit,a=n.formatter,p=n.tooltipType,g=n.chartType,v=n.hide;return Ri(Ri({},fr(e,!1)),{},{dataKey:i,unit:u,formatter:a,name:o||i,color:e3(e),value:ai(r,i),type:p,payload:r,chartType:g,hide:v})};function m_(t){"@babel/helpers - typeof";return m_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m_(t)}function x8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Vu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?x8(Object(r),!0).forEach(function(n){yW(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yW(t,e,r){return e=a2e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a2e(t){var e=s2e(t,"string");return m_(e)=="symbol"?e:e+""}function s2e(t,e){if(m_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(m_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o2e(t,e){return d2e(t)||u2e(t,e)||c2e(t,e)||l2e()}function l2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c2e(t,e){if(t){if(typeof t=="string")return v8(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v8(t,e)}}function v8(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u2e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function d2e(t){if(Array.isArray(t))return t}var pk=Math.PI/180,h2e=function(e){return e*180/Math.PI},Xn=function(e,r,n,i){return{x:e+Math.cos(-pk*i)*n,y:r+Math.sin(-pk*i)*n}},xW=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},f2e=function(e,r,n,i,o){var u=e.width,a=e.height,p=e.startAngle,g=e.endAngle,v=js(e.cx,u,u/2),w=js(e.cy,a,a/2),T=xW(u,a,n),A=js(e.innerRadius,T,0),I=js(e.outerRadius,T,T*.8),P=Object.keys(r);return P.reduce(function(D,L){var O=r[L],$=O.domain,G=O.reversed,B;if(_r(O.range))i==="angleAxis"?B=[p,g]:i==="radiusAxis"&&(B=[A,I]),G&&(B=[B[1],B[0]]);else{B=O.range;var J=B,W=o2e(J,2);p=W[0],g=W[1]}var H=hW(O,o),V=H.realScaleType,se=H.scale;se.domain($).range(B),fW(se);var K=pW(se,Vu(Vu({},O),{},{realScaleType:V})),ce=Vu(Vu(Vu({},O),K),{},{range:B,radius:I,realScaleType:V,scale:se,cx:v,cy:w,innerRadius:A,outerRadius:I,startAngle:p,endAngle:g});return Vu(Vu({},D),{},yW({},L,ce))},{})},p2e=function(e,r){var n=e.x,i=e.y,o=r.x,u=r.y;return Math.sqrt(Math.pow(n-o,2)+Math.pow(i-u,2))},m2e=function(e,r){var n=e.x,i=e.y,o=r.cx,u=r.cy,a=p2e({x:n,y:i},{x:o,y:u});if(a<=0)return{radius:a};var p=(n-o)/a,g=Math.acos(p);return i>u&&(g=2*Math.PI-g),{radius:a,angle:h2e(g),angleInRadian:g}},g2e=function(e){var r=e.startAngle,n=e.endAngle,i=Math.floor(r/360),o=Math.floor(n/360),u=Math.min(i,o);return{startAngle:r-u*360,endAngle:n-u*360}},y2e=function(e,r){var n=r.startAngle,i=r.endAngle,o=Math.floor(n/360),u=Math.floor(i/360),a=Math.min(o,u);return e+a*360},_8=function(e,r){var n=e.x,i=e.y,o=m2e({x:n,y:i},r),u=o.radius,a=o.angle,p=r.innerRadius,g=r.outerRadius;if(u<p||u>g)return!1;if(u===0)return!0;var v=g2e(r),w=v.startAngle,T=v.endAngle,A=a,I;if(w<=T){for(;A>T;)A-=360;for(;A<w;)A+=360;I=A>=w&&A<=T}else{for(;A>w;)A-=360;for(;A<T;)A+=360;I=A>=T&&A<=w}return I?Vu(Vu({},r),{},{radius:u,angle:y2e(A,r)}):null},vW=function(e){return!Y.isValidElement(e)&&!Tr(e)&&typeof e!="boolean"?e.className:""};function g_(t){"@babel/helpers - typeof";return g_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g_(t)}var x2e=["offset"];function v2e(t){return k2e(t)||w2e(t)||b2e(t)||_2e()}function _2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b2e(t,e){if(t){if(typeof t=="string")return nP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nP(t,e)}}function w2e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function k2e(t){if(Array.isArray(t))return nP(t)}function nP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function T2e(t,e){if(t==null)return{};var r=S2e(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function S2e(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function b8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function da(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?b8(Object(r),!0).forEach(function(n){E2e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function E2e(t,e,r){return e=j2e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j2e(t){var e=A2e(t,"string");return g_(e)=="symbol"?e:e+""}function A2e(t,e){if(g_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(g_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function y_(){return y_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},y_.apply(this,arguments)}var N2e=function(e){var r=e.value,n=e.formatter,i=_r(e.children)?r:e.children;return Tr(n)?n(i):i},C2e=function(e,r){var n=Es(r-e),i=Math.min(Math.abs(r-e),360);return n*i},P2e=function(e,r,n){var i=e.position,o=e.viewBox,u=e.offset,a=e.className,p=o,g=p.cx,v=p.cy,w=p.innerRadius,T=p.outerRadius,A=p.startAngle,I=p.endAngle,P=p.clockWise,D=(w+T)/2,L=C2e(A,I),O=L>=0?1:-1,$,G;i==="insideStart"?($=A+O*u,G=P):i==="insideEnd"?($=I-O*u,G=!P):i==="end"&&($=I+O*u,G=P),G=L<=0?G:!G;var B=Xn(g,v,D,$),J=Xn(g,v,D,$+(G?1:-1)*359),W="M".concat(B.x,",").concat(B.y,`
    A`).concat(D,",").concat(D,",0,1,").concat(G?0:1,`,
    `).concat(J.x,",").concat(J.y),H=_r(e.id)?uf("recharts-radial-line-"):e.id;return Le.createElement("text",y_({},n,{dominantBaseline:"central",className:Fr("recharts-radial-bar-label",a)}),Le.createElement("defs",null,Le.createElement("path",{id:H,d:W})),Le.createElement("textPath",{xlinkHref:"#".concat(H)},r))},I2e=function(e){var r=e.viewBox,n=e.offset,i=e.position,o=r,u=o.cx,a=o.cy,p=o.innerRadius,g=o.outerRadius,v=o.startAngle,w=o.endAngle,T=(v+w)/2;if(i==="outside"){var A=Xn(u,a,g+n,T),I=A.x,P=A.y;return{x:I,y:P,textAnchor:I>=u?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:u,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:u,y:a,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:u,y:a,textAnchor:"middle",verticalAnchor:"end"};var D=(p+g)/2,L=Xn(u,a,D,T),O=L.x,$=L.y;return{x:O,y:$,textAnchor:"middle",verticalAnchor:"middle"}},M2e=function(e){var r=e.viewBox,n=e.parentViewBox,i=e.offset,o=e.position,u=r,a=u.x,p=u.y,g=u.width,v=u.height,w=v>=0?1:-1,T=w*i,A=w>0?"end":"start",I=w>0?"start":"end",P=g>=0?1:-1,D=P*i,L=P>0?"end":"start",O=P>0?"start":"end";if(o==="top"){var $={x:a+g/2,y:p-w*i,textAnchor:"middle",verticalAnchor:A};return da(da({},$),n?{height:Math.max(p-n.y,0),width:g}:{})}if(o==="bottom"){var G={x:a+g/2,y:p+v+T,textAnchor:"middle",verticalAnchor:I};return da(da({},G),n?{height:Math.max(n.y+n.height-(p+v),0),width:g}:{})}if(o==="left"){var B={x:a-D,y:p+v/2,textAnchor:L,verticalAnchor:"middle"};return da(da({},B),n?{width:Math.max(B.x-n.x,0),height:v}:{})}if(o==="right"){var J={x:a+g+D,y:p+v/2,textAnchor:O,verticalAnchor:"middle"};return da(da({},J),n?{width:Math.max(n.x+n.width-J.x,0),height:v}:{})}var W=n?{width:g,height:v}:{};return o==="insideLeft"?da({x:a+D,y:p+v/2,textAnchor:O,verticalAnchor:"middle"},W):o==="insideRight"?da({x:a+g-D,y:p+v/2,textAnchor:L,verticalAnchor:"middle"},W):o==="insideTop"?da({x:a+g/2,y:p+T,textAnchor:"middle",verticalAnchor:I},W):o==="insideBottom"?da({x:a+g/2,y:p+v-T,textAnchor:"middle",verticalAnchor:A},W):o==="insideTopLeft"?da({x:a+D,y:p+T,textAnchor:O,verticalAnchor:I},W):o==="insideTopRight"?da({x:a+g-D,y:p+T,textAnchor:L,verticalAnchor:I},W):o==="insideBottomLeft"?da({x:a+D,y:p+v-T,textAnchor:O,verticalAnchor:A},W):o==="insideBottomRight"?da({x:a+g-D,y:p+v-T,textAnchor:L,verticalAnchor:A},W):q0(o)&&(Bt(o.x)||hp(o.x))&&(Bt(o.y)||hp(o.y))?da({x:a+js(o.x,g),y:p+js(o.y,v),textAnchor:"end",verticalAnchor:"end"},W):da({x:a+g/2,y:p+v/2,textAnchor:"middle",verticalAnchor:"middle"},W)},D2e=function(e){return"cx"in e&&Bt(e.cx)};function Aa(t){var e=t.offset,r=e===void 0?5:e,n=T2e(t,x2e),i=da({offset:r},n),o=i.viewBox,u=i.position,a=i.value,p=i.children,g=i.content,v=i.className,w=v===void 0?"":v,T=i.textBreakAll;if(!o||_r(a)&&_r(p)&&!Y.isValidElement(g)&&!Tr(g))return null;if(Y.isValidElement(g))return Y.cloneElement(g,i);var A;if(Tr(g)){if(A=Y.createElement(g,i),Y.isValidElement(A))return A}else A=N2e(i);var I=D2e(o),P=fr(i,!0);if(I&&(u==="insideStart"||u==="insideEnd"||u==="end"))return P2e(i,A,P);var D=I?I2e(i):M2e(i);return Le.createElement(Op,y_({className:Fr("recharts-label",w)},P,D,{breakAll:T}),A)}Aa.displayName="Label";var _W=function(e){var r=e.cx,n=e.cy,i=e.angle,o=e.startAngle,u=e.endAngle,a=e.r,p=e.radius,g=e.innerRadius,v=e.outerRadius,w=e.x,T=e.y,A=e.top,I=e.left,P=e.width,D=e.height,L=e.clockWise,O=e.labelViewBox;if(O)return O;if(Bt(P)&&Bt(D)){if(Bt(w)&&Bt(T))return{x:w,y:T,width:P,height:D};if(Bt(A)&&Bt(I))return{x:A,y:I,width:P,height:D}}return Bt(w)&&Bt(T)?{x:w,y:T,width:0,height:0}:Bt(r)&&Bt(n)?{cx:r,cy:n,startAngle:o||i||0,endAngle:u||i||0,innerRadius:g||0,outerRadius:v||p||a||0,clockWise:L}:e.viewBox?e.viewBox:{}},O2e=function(e,r){return e?e===!0?Le.createElement(Aa,{key:"label-implicit",viewBox:r}):pa(e)?Le.createElement(Aa,{key:"label-implicit",viewBox:r,value:e}):Y.isValidElement(e)?e.type===Aa?Y.cloneElement(e,{key:"label-implicit",viewBox:r}):Le.createElement(Aa,{key:"label-implicit",content:e,viewBox:r}):Tr(e)?Le.createElement(Aa,{key:"label-implicit",content:e,viewBox:r}):q0(e)?Le.createElement(Aa,y_({viewBox:r},e,{key:"label-implicit"})):null:null},R2e=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var i=e.children,o=_W(e),u=Ps(i,Aa).map(function(p,g){return Y.cloneElement(p,{viewBox:r||o,key:"label-".concat(g)})});if(!n)return u;var a=O2e(e.label,r||o);return[a].concat(v2e(u))};Aa.parseViewBox=_W;Aa.renderCallByParent=R2e;function L2e(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var z2e=L2e;const $2e=Pn(z2e);function x_(t){"@babel/helpers - typeof";return x_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x_(t)}var F2e=["valueAccessor"],B2e=["data","dataKey","clockWise","id","textBreakAll"];function V2e(t){return W2e(t)||G2e(t)||q2e(t)||U2e()}function U2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q2e(t,e){if(t){if(typeof t=="string")return iP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iP(t,e)}}function G2e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function W2e(t){if(Array.isArray(t))return iP(t)}function iP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function mk(){return mk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mk.apply(this,arguments)}function w8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function k8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?w8(Object(r),!0).forEach(function(n){H2e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):w8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function H2e(t,e,r){return e=K2e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K2e(t){var e=Z2e(t,"string");return x_(e)=="symbol"?e:e+""}function Z2e(t,e){if(x_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(x_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T8(t,e){if(t==null)return{};var r=X2e(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function X2e(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var Y2e=function(e){return Array.isArray(e.value)?$2e(e.value):e.value};function sc(t){var e=t.valueAccessor,r=e===void 0?Y2e:e,n=T8(t,F2e),i=n.data,o=n.dataKey,u=n.clockWise,a=n.id,p=n.textBreakAll,g=T8(n,B2e);return!i||!i.length?null:Le.createElement(Ur,{className:"recharts-label-list"},i.map(function(v,w){var T=_r(o)?r(v,w):ai(v&&v.payload,o),A=_r(a)?{}:{id:"".concat(a,"-").concat(w)};return Le.createElement(Aa,mk({},fr(v,!0),g,A,{parentViewBox:v.parentViewBox,value:T,textBreakAll:p,viewBox:Aa.parseViewBox(_r(u)?v:k8(k8({},v),{},{clockWise:u})),key:"label-".concat(w),index:w}))}))}sc.displayName="LabelList";function J2e(t,e){return t?t===!0?Le.createElement(sc,{key:"labelList-implicit",data:e}):Le.isValidElement(t)||Tr(t)?Le.createElement(sc,{key:"labelList-implicit",data:e,content:t}):q0(t)?Le.createElement(sc,mk({data:e},t,{key:"labelList-implicit"})):null:null}function Q2e(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var n=t.children,i=Ps(n,sc).map(function(u,a){return Y.cloneElement(u,{data:e,key:"labelList-".concat(a)})});if(!r)return i;var o=J2e(t.label,e);return[o].concat(V2e(i))}sc.renderCallByParent=Q2e;function v_(t){"@babel/helpers - typeof";return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v_(t)}function aP(){return aP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},aP.apply(this,arguments)}function S8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function E8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?S8(Object(r),!0).forEach(function(n){eke(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function eke(t,e,r){return e=tke(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tke(t){var e=rke(t,"string");return v_(e)=="symbol"?e:e+""}function rke(t,e){if(v_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(v_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nke=function(e,r){var n=Es(r-e),i=Math.min(Math.abs(r-e),359.999);return n*i},xw=function(e){var r=e.cx,n=e.cy,i=e.radius,o=e.angle,u=e.sign,a=e.isExternal,p=e.cornerRadius,g=e.cornerIsExternal,v=p*(a?1:-1)+i,w=Math.asin(p/v)/pk,T=g?o:o+u*w,A=Xn(r,n,v,T),I=Xn(r,n,i,T),P=g?o-u*w:o,D=Xn(r,n,v*Math.cos(w*pk),P);return{center:A,circleTangency:I,lineTangency:D,theta:w}},bW=function(e){var r=e.cx,n=e.cy,i=e.innerRadius,o=e.outerRadius,u=e.startAngle,a=e.endAngle,p=nke(u,a),g=u+p,v=Xn(r,n,o,u),w=Xn(r,n,o,g),T="M ".concat(v.x,",").concat(v.y,`
    A `).concat(o,",").concat(o,`,0,
    `).concat(+(Math.abs(p)>180),",").concat(+(u>g),`,
    `).concat(w.x,",").concat(w.y,`
  `);if(i>0){var A=Xn(r,n,i,u),I=Xn(r,n,i,g);T+="L ".concat(I.x,",").concat(I.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(p)>180),",").concat(+(u<=g),`,
            `).concat(A.x,",").concat(A.y," Z")}else T+="L ".concat(r,",").concat(n," Z");return T},ike=function(e){var r=e.cx,n=e.cy,i=e.innerRadius,o=e.outerRadius,u=e.cornerRadius,a=e.forceCornerRadius,p=e.cornerIsExternal,g=e.startAngle,v=e.endAngle,w=Es(v-g),T=xw({cx:r,cy:n,radius:o,angle:g,sign:w,cornerRadius:u,cornerIsExternal:p}),A=T.circleTangency,I=T.lineTangency,P=T.theta,D=xw({cx:r,cy:n,radius:o,angle:v,sign:-w,cornerRadius:u,cornerIsExternal:p}),L=D.circleTangency,O=D.lineTangency,$=D.theta,G=p?Math.abs(g-v):Math.abs(g-v)-P-$;if(G<0)return a?"M ".concat(I.x,",").concat(I.y,`
        a`).concat(u,",").concat(u,",0,0,1,").concat(u*2,`,0
        a`).concat(u,",").concat(u,",0,0,1,").concat(-u*2,`,0
      `):bW({cx:r,cy:n,innerRadius:i,outerRadius:o,startAngle:g,endAngle:v});var B="M ".concat(I.x,",").concat(I.y,`
    A`).concat(u,",").concat(u,",0,0,").concat(+(w<0),",").concat(A.x,",").concat(A.y,`
    A`).concat(o,",").concat(o,",0,").concat(+(G>180),",").concat(+(w<0),",").concat(L.x,",").concat(L.y,`
    A`).concat(u,",").concat(u,",0,0,").concat(+(w<0),",").concat(O.x,",").concat(O.y,`
  `);if(i>0){var J=xw({cx:r,cy:n,radius:i,angle:g,sign:w,isExternal:!0,cornerRadius:u,cornerIsExternal:p}),W=J.circleTangency,H=J.lineTangency,V=J.theta,se=xw({cx:r,cy:n,radius:i,angle:v,sign:-w,isExternal:!0,cornerRadius:u,cornerIsExternal:p}),K=se.circleTangency,ce=se.lineTangency,ne=se.theta,re=p?Math.abs(g-v):Math.abs(g-v)-V-ne;if(re<0&&u===0)return"".concat(B,"L").concat(r,",").concat(n,"Z");B+="L".concat(ce.x,",").concat(ce.y,`
      A`).concat(u,",").concat(u,",0,0,").concat(+(w<0),",").concat(K.x,",").concat(K.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(re>180),",").concat(+(w>0),",").concat(W.x,",").concat(W.y,`
      A`).concat(u,",").concat(u,",0,0,").concat(+(w<0),",").concat(H.x,",").concat(H.y,"Z")}else B+="L".concat(r,",").concat(n,"Z");return B},ake={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},wW=function(e){var r=E8(E8({},ake),e),n=r.cx,i=r.cy,o=r.innerRadius,u=r.outerRadius,a=r.cornerRadius,p=r.forceCornerRadius,g=r.cornerIsExternal,v=r.startAngle,w=r.endAngle,T=r.className;if(u<o||v===w)return null;var A=Fr("recharts-sector",T),I=u-o,P=js(a,I,0,!0),D;return P>0&&Math.abs(v-w)<360?D=ike({cx:n,cy:i,innerRadius:o,outerRadius:u,cornerRadius:Math.min(P,I/2),forceCornerRadius:p,cornerIsExternal:g,startAngle:v,endAngle:w}):D=bW({cx:n,cy:i,innerRadius:o,outerRadius:u,startAngle:v,endAngle:w}),Le.createElement("path",aP({},fr(r,!0),{className:A,d:D,role:"img"}))};function __(t){"@babel/helpers - typeof";return __=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},__(t)}function sP(){return sP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sP.apply(this,arguments)}function j8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function A8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?j8(Object(r),!0).forEach(function(n){ske(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ske(t,e,r){return e=oke(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oke(t){var e=lke(t,"string");return __(e)=="symbol"?e:e+""}function lke(t,e){if(__(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(__(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var N8={curveBasisClosed:ide,curveBasisOpen:ade,curveBasis:nde,curveBumpX:Uue,curveBumpY:que,curveLinearClosed:sde,curveLinear:tS,curveMonotoneX:wq,curveMonotoneY:ode,curveNatural:lde,curveStep:cde,curveStepAfter:dde,curveStepBefore:ude},vw=function(e){return e.x===+e.x&&e.y===+e.y},Ix=function(e){return e.x},Mx=function(e){return e.y},cke=function(e,r){if(Tr(e))return e;var n="curve".concat(QT(e));return(n==="curveMonotone"||n==="curveBump")&&r?N8["".concat(n).concat(r==="vertical"?"Y":"X")]:N8[n]||tS},uke=function(e){var r=e.type,n=r===void 0?"linear":r,i=e.points,o=i===void 0?[]:i,u=e.baseLine,a=e.layout,p=e.connectNulls,g=p===void 0?!1:p,v=cke(n,a),w=g?o.filter(function(P){return vw(P)}):o,T;if(Array.isArray(u)){var A=g?u.filter(function(P){return vw(P)}):u,I=w.map(function(P,D){return A8(A8({},P),{},{base:A[D]})});return a==="vertical"?T=lw().y(Mx).x1(Ix).x0(function(P){return P.base.x}):T=lw().x(Ix).y1(Mx).y0(function(P){return P.base.y}),T.defined(vw).curve(v),T(I)}return a==="vertical"&&Bt(u)?T=lw().y(Mx).x1(Ix).x0(u):Bt(u)?T=lw().x(Ix).y1(Mx).y0(u):T=yM().x(Ix).y(Mx),T.defined(vw).curve(v),T(w)},Oh=function(e){var r=e.className,n=e.points,i=e.path,o=e.pathRef;if((!n||!n.length)&&!i)return null;var u=n&&n.length?uke(e):i;return Y.createElement("path",sP({},fr(e,!1),B2(e),{className:Fr("recharts-curve",r),d:u,ref:o}))},kW={exports:{}},dke="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",hke=dke,fke=hke;function TW(){}function SW(){}SW.resetWarningCache=TW;var pke=function(){function t(n,i,o,u,a,p){if(p!==fke){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:SW,resetWarningCache:TW};return r.PropTypes=r,r};kW.exports=pke();var mke=kW.exports;const Nn=Pn(mke);var gke=Object.getOwnPropertyNames,yke=Object.getOwnPropertySymbols,xke=Object.prototype.hasOwnProperty;function C8(t,e){return function(n,i,o){return t(n,i,o)&&e(n,i,o)}}function _w(t){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return t(r,n,i);var o=i.cache,u=o.get(r),a=o.get(n);if(u&&a)return u===n&&a===r;o.set(r,n),o.set(n,r);var p=t(r,n,i);return o.delete(r),o.delete(n),p}}function P8(t){return gke(t).concat(yke(t))}var vke=Object.hasOwn||function(t,e){return xke.call(t,e)};function Xp(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var _ke="__v",bke="__o",wke="_owner",I8=Object.getOwnPropertyDescriptor,M8=Object.keys;function kke(t,e,r){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function Tke(t,e){return Xp(t.getTime(),e.getTime())}function Ske(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function Eke(t,e){return t===e}function D8(t,e,r){var n=t.size;if(n!==e.size)return!1;if(!n)return!0;for(var i=new Array(n),o=t.entries(),u,a,p=0;(u=o.next())&&!u.done;){for(var g=e.entries(),v=!1,w=0;(a=g.next())&&!a.done;){if(i[w]){w++;continue}var T=u.value,A=a.value;if(r.equals(T[0],A[0],p,w,t,e,r)&&r.equals(T[1],A[1],T[0],A[0],t,e,r)){v=i[w]=!0;break}w++}if(!v)return!1;p++}return!0}var jke=Xp;function Ake(t,e,r){var n=M8(t),i=n.length;if(M8(e).length!==i)return!1;for(;i-- >0;)if(!EW(t,e,r,n[i]))return!1;return!0}function Dx(t,e,r){var n=P8(t),i=n.length;if(P8(e).length!==i)return!1;for(var o,u,a;i-- >0;)if(o=n[i],!EW(t,e,r,o)||(u=I8(t,o),a=I8(e,o),(u||a)&&(!u||!a||u.configurable!==a.configurable||u.enumerable!==a.enumerable||u.writable!==a.writable)))return!1;return!0}function Nke(t,e){return Xp(t.valueOf(),e.valueOf())}function Cke(t,e){return t.source===e.source&&t.flags===e.flags}function O8(t,e,r){var n=t.size;if(n!==e.size)return!1;if(!n)return!0;for(var i=new Array(n),o=t.values(),u,a;(u=o.next())&&!u.done;){for(var p=e.values(),g=!1,v=0;(a=p.next())&&!a.done;){if(!i[v]&&r.equals(u.value,a.value,u.value,a.value,t,e,r)){g=i[v]=!0;break}v++}if(!g)return!1}return!0}function Pke(t,e){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function Ike(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function EW(t,e,r,n){return(n===wke||n===bke||n===_ke)&&(t.$$typeof||e.$$typeof)?!0:vke(e,n)&&r.equals(t[n],e[n],n,n,t,e,r)}var Mke="[object Arguments]",Dke="[object Boolean]",Oke="[object Date]",Rke="[object Error]",Lke="[object Map]",zke="[object Number]",$ke="[object Object]",Fke="[object RegExp]",Bke="[object Set]",Vke="[object String]",Uke="[object URL]",qke=Array.isArray,R8=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,L8=Object.assign,Gke=Object.prototype.toString.call.bind(Object.prototype.toString);function Wke(t){var e=t.areArraysEqual,r=t.areDatesEqual,n=t.areErrorsEqual,i=t.areFunctionsEqual,o=t.areMapsEqual,u=t.areNumbersEqual,a=t.areObjectsEqual,p=t.arePrimitiveWrappersEqual,g=t.areRegExpsEqual,v=t.areSetsEqual,w=t.areTypedArraysEqual,T=t.areUrlsEqual;return function(I,P,D){if(I===P)return!0;if(I==null||P==null)return!1;var L=typeof I;if(L!==typeof P)return!1;if(L!=="object")return L==="number"?u(I,P,D):L==="function"?i(I,P,D):!1;var O=I.constructor;if(O!==P.constructor)return!1;if(O===Object)return a(I,P,D);if(qke(I))return e(I,P,D);if(R8!=null&&R8(I))return w(I,P,D);if(O===Date)return r(I,P,D);if(O===RegExp)return g(I,P,D);if(O===Map)return o(I,P,D);if(O===Set)return v(I,P,D);var $=Gke(I);return $===Oke?r(I,P,D):$===Fke?g(I,P,D):$===Lke?o(I,P,D):$===Bke?v(I,P,D):$===$ke?typeof I.then!="function"&&typeof P.then!="function"&&a(I,P,D):$===Uke?T(I,P,D):$===Rke?n(I,P,D):$===Mke?a(I,P,D):$===Dke||$===zke||$===Vke?p(I,P,D):!1}}function Hke(t){var e=t.circular,r=t.createCustomConfig,n=t.strict,i={areArraysEqual:n?Dx:kke,areDatesEqual:Tke,areErrorsEqual:Ske,areFunctionsEqual:Eke,areMapsEqual:n?C8(D8,Dx):D8,areNumbersEqual:jke,areObjectsEqual:n?Dx:Ake,arePrimitiveWrappersEqual:Nke,areRegExpsEqual:Cke,areSetsEqual:n?C8(O8,Dx):O8,areTypedArraysEqual:n?Dx:Pke,areUrlsEqual:Ike};if(r&&(i=L8({},i,r(i))),e){var o=_w(i.areArraysEqual),u=_w(i.areMapsEqual),a=_w(i.areObjectsEqual),p=_w(i.areSetsEqual);i=L8({},i,{areArraysEqual:o,areMapsEqual:u,areObjectsEqual:a,areSetsEqual:p})}return i}function Kke(t){return function(e,r,n,i,o,u,a){return t(e,r,a)}}function Zke(t){var e=t.circular,r=t.comparator,n=t.createState,i=t.equals,o=t.strict;if(n)return function(p,g){var v=n(),w=v.cache,T=w===void 0?e?new WeakMap:void 0:w,A=v.meta;return r(p,g,{cache:T,equals:i,meta:A,strict:o})};if(e)return function(p,g){return r(p,g,{cache:new WeakMap,equals:i,meta:void 0,strict:o})};var u={cache:void 0,equals:i,meta:void 0,strict:o};return function(p,g){return r(p,g,u)}}var Xke=ff();ff({strict:!0});ff({circular:!0});ff({circular:!0,strict:!0});ff({createInternalComparator:function(){return Xp}});ff({strict:!0,createInternalComparator:function(){return Xp}});ff({circular:!0,createInternalComparator:function(){return Xp}});ff({circular:!0,createInternalComparator:function(){return Xp},strict:!0});function ff(t){t===void 0&&(t={});var e=t.circular,r=e===void 0?!1:e,n=t.createInternalComparator,i=t.createState,o=t.strict,u=o===void 0?!1:o,a=Hke(t),p=Wke(a),g=n?n(p):Kke(p);return Zke({circular:r,comparator:p,createState:i,equals:g,strict:u})}function Yke(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function z8(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function i(o){r<0&&(r=o),o-r>e?(t(o),r=-1):Yke(i)};requestAnimationFrame(n)}function oP(t){"@babel/helpers - typeof";return oP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oP(t)}function Jke(t){return rTe(t)||tTe(t)||eTe(t)||Qke()}function Qke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eTe(t,e){if(t){if(typeof t=="string")return $8(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $8(t,e)}}function $8(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function tTe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function rTe(t){if(Array.isArray(t))return t}function nTe(){var t={},e=function(){return null},r=!1,n=function i(o){if(!r){if(Array.isArray(o)){if(!o.length)return;var u=o,a=Jke(u),p=a[0],g=a.slice(1);if(typeof p=="number"){z8(i.bind(null,g),p);return}i(p),z8(i.bind(null,g));return}oP(o)==="object"&&(t=o,e(t)),typeof o=="function"&&o()}};return{stop:function(){r=!0},start:function(o){r=!1,n(o)},subscribe:function(o){return e=o,function(){e=function(){return null}}}}}function b_(t){"@babel/helpers - typeof";return b_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b_(t)}function F8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function B8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?F8(Object(r),!0).forEach(function(n){jW(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jW(t,e,r){return e=iTe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iTe(t){var e=aTe(t,"string");return b_(e)==="symbol"?e:String(e)}function aTe(t,e){if(b_(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(b_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sTe=function(e,r){return[Object.keys(e),Object.keys(r)].reduce(function(n,i){return n.filter(function(o){return i.includes(o)})})},oTe=function(e){return e},lTe=function(e){return e.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},vv=function(e,r){return Object.keys(r).reduce(function(n,i){return B8(B8({},n),{},jW({},i,e(i,r[i])))},{})},V8=function(e,r,n){return e.map(function(i){return"".concat(lTe(i)," ").concat(r,"ms ").concat(n)}).join(",")};function cTe(t,e){return hTe(t)||dTe(t,e)||AW(t,e)||uTe()}function uTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dTe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function hTe(t){if(Array.isArray(t))return t}function fTe(t){return gTe(t)||mTe(t)||AW(t)||pTe()}function pTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AW(t,e){if(t){if(typeof t=="string")return lP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lP(t,e)}}function mTe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function gTe(t){if(Array.isArray(t))return lP(t)}function lP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var gk=1e-4,NW=function(e,r){return[0,3*e,3*r-6*e,3*e-3*r+1]},CW=function(e,r){return e.map(function(n,i){return n*Math.pow(r,i)}).reduce(function(n,i){return n+i})},U8=function(e,r){return function(n){var i=NW(e,r);return CW(i,n)}},yTe=function(e,r){return function(n){var i=NW(e,r),o=[].concat(fTe(i.map(function(u,a){return u*a}).slice(1)),[0]);return CW(o,n)}},q8=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0],o=r[1],u=r[2],a=r[3];if(r.length===1)switch(r[0]){case"linear":i=0,o=0,u=1,a=1;break;case"ease":i=.25,o=.1,u=.25,a=1;break;case"ease-in":i=.42,o=0,u=1,a=1;break;case"ease-out":i=.42,o=0,u=.58,a=1;break;case"ease-in-out":i=0,o=0,u=.58,a=1;break;default:{var p=r[0].split("(");if(p[0]==="cubic-bezier"&&p[1].split(")")[0].split(",").length===4){var g=p[1].split(")")[0].split(",").map(function(D){return parseFloat(D)}),v=cTe(g,4);i=v[0],o=v[1],u=v[2],a=v[3]}}}var w=U8(i,u),T=U8(o,a),A=yTe(i,u),I=function(L){return L>1?1:L<0?0:L},P=function(L){for(var O=L>1?1:L,$=O,G=0;G<8;++G){var B=w($)-O,J=A($);if(Math.abs(B-O)<gk||J<gk)return T($);$=I($-B/J)}return T($)};return P.isStepper=!1,P},xTe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.stiff,n=r===void 0?100:r,i=e.damping,o=i===void 0?8:i,u=e.dt,a=u===void 0?17:u,p=function(v,w,T){var A=-(v-w)*n,I=T*o,P=T+(A-I)*a/1e3,D=T*a/1e3+v;return Math.abs(D-w)<gk&&Math.abs(P)<gk?[w,0]:[D,P]};return p.isStepper=!0,p.dt=a,p},vTe=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return q8(i);case"spring":return xTe();default:if(i.split("(")[0]==="cubic-bezier")return q8(i)}return typeof i=="function"?i:null};function w_(t){"@babel/helpers - typeof";return w_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w_(t)}function G8(t){return wTe(t)||bTe(t)||PW(t)||_Te()}function _Te(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bTe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function wTe(t){if(Array.isArray(t))return uP(t)}function W8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ra(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?W8(Object(r),!0).forEach(function(n){cP(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cP(t,e,r){return e=kTe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kTe(t){var e=TTe(t,"string");return w_(e)==="symbol"?e:String(e)}function TTe(t,e){if(w_(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(w_(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function STe(t,e){return ATe(t)||jTe(t,e)||PW(t,e)||ETe()}function ETe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PW(t,e){if(t){if(typeof t=="string")return uP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uP(t,e)}}function uP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function jTe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function ATe(t){if(Array.isArray(t))return t}var yk=function(e,r,n){return e+(r-e)*n},dP=function(e){var r=e.from,n=e.to;return r!==n},NTe=function t(e,r,n){var i=vv(function(o,u){if(dP(u)){var a=e(u.from,u.to,u.velocity),p=STe(a,2),g=p[0],v=p[1];return Ra(Ra({},u),{},{from:g,velocity:v})}return u},r);return n<1?vv(function(o,u){return dP(u)?Ra(Ra({},u),{},{velocity:yk(u.velocity,i[o].velocity,n),from:yk(u.from,i[o].from,n)}):u},r):t(e,i,n-1)};const CTe=function(t,e,r,n,i){var o=sTe(t,e),u=o.reduce(function(D,L){return Ra(Ra({},D),{},cP({},L,[t[L],e[L]]))},{}),a=o.reduce(function(D,L){return Ra(Ra({},D),{},cP({},L,{from:t[L],velocity:0,to:e[L]}))},{}),p=-1,g,v,w=function(){return null},T=function(){return vv(function(L,O){return O.from},a)},A=function(){return!Object.values(a).filter(dP).length},I=function(L){g||(g=L);var O=L-g,$=O/r.dt;a=NTe(r,a,$),i(Ra(Ra(Ra({},t),e),T())),g=L,A()||(p=requestAnimationFrame(w))},P=function(L){v||(v=L);var O=(L-v)/n,$=vv(function(B,J){return yk.apply(void 0,G8(J).concat([r(O)]))},u);if(i(Ra(Ra(Ra({},t),e),$)),O<1)p=requestAnimationFrame(w);else{var G=vv(function(B,J){return yk.apply(void 0,G8(J).concat([r(1)]))},u);i(Ra(Ra(Ra({},t),e),G))}};return w=r.isStepper?I:P,function(){return requestAnimationFrame(w),function(){cancelAnimationFrame(p)}}};function a0(t){"@babel/helpers - typeof";return a0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a0(t)}var PTe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function ITe(t,e){if(t==null)return{};var r=MTe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function MTe(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function OA(t){return LTe(t)||RTe(t)||OTe(t)||DTe()}function DTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OTe(t,e){if(t){if(typeof t=="string")return hP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hP(t,e)}}function RTe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LTe(t){if(Array.isArray(t))return hP(t)}function hP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function H8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ql(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?H8(Object(r),!0).forEach(function(n){qx(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):H8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qx(t,e,r){return e=IW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K8(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,IW(n.key),n)}}function $Te(t,e,r){return e&&K8(t.prototype,e),r&&K8(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function IW(t){var e=FTe(t,"string");return a0(e)==="symbol"?e:String(e)}function FTe(t,e){if(a0(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(a0(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fP(t,e)}function fP(t,e){return fP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},fP(t,e)}function VTe(t){var e=UTe();return function(){var n=xk(t),i;if(e){var o=xk(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return pP(this,i)}}function pP(t,e){if(e&&(a0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mP(t)}function mP(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function UTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xk(t){return xk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xk(t)}var yS=function(t){BTe(r,t);var e=VTe(r);function r(n,i){var o;zTe(this,r),o=e.call(this,n,i);var u=o.props,a=u.isActive,p=u.attributeName,g=u.from,v=u.to,w=u.steps,T=u.children,A=u.duration;if(o.handleStyleChange=o.handleStyleChange.bind(mP(o)),o.changeStyle=o.changeStyle.bind(mP(o)),!a||A<=0)return o.state={style:{}},typeof T=="function"&&(o.state={style:v}),pP(o);if(w&&w.length)o.state={style:w[0].style};else if(g){if(typeof T=="function")return o.state={style:g},pP(o);o.state={style:p?qx({},p,g):g}}else o.state={style:{}};return o}return $Te(r,[{key:"componentDidMount",value:function(){var i=this.props,o=i.isActive,u=i.canBegin;this.mounted=!0,!(!o||!u)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var o=this.props,u=o.isActive,a=o.canBegin,p=o.attributeName,g=o.shouldReAnimate,v=o.to,w=o.from,T=this.state.style;if(a){if(!u){var A={style:p?qx({},p,v):v};this.state&&T&&(p&&T[p]!==v||!p&&T!==v)&&this.setState(A);return}if(!(Xke(i.to,v)&&i.canBegin&&i.isActive)){var I=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var P=I||g?w:i.to;if(this.state&&T){var D={style:p?qx({},p,P):P};(p&&T[p]!==P||!p&&T!==P)&&this.setState(D)}this.runAnimation(ql(ql({},this.props),{},{from:P,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var o=this,u=i.from,a=i.to,p=i.duration,g=i.easing,v=i.begin,w=i.onAnimationEnd,T=i.onAnimationStart,A=CTe(u,a,vTe(g),p,this.changeStyle),I=function(){o.stopJSAnimation=A()};this.manager.start([T,v,I,p,w])}},{key:"runStepAnimation",value:function(i){var o=this,u=i.steps,a=i.begin,p=i.onAnimationStart,g=u[0],v=g.style,w=g.duration,T=w===void 0?0:w,A=function(P,D,L){if(L===0)return P;var O=D.duration,$=D.easing,G=$===void 0?"ease":$,B=D.style,J=D.properties,W=D.onAnimationEnd,H=L>0?u[L-1]:D,V=J||Object.keys(B);if(typeof G=="function"||G==="spring")return[].concat(OA(P),[o.runJSAnimation.bind(o,{from:H.style,to:B,duration:O,easing:G}),O]);var se=V8(V,O,G),K=ql(ql(ql({},H.style),B),{},{transition:se});return[].concat(OA(P),[K,O,W]).filter(oTe)};return this.manager.start([p].concat(OA(u.reduce(A,[v,Math.max(T,a)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=nTe());var o=i.begin,u=i.duration,a=i.attributeName,p=i.to,g=i.easing,v=i.onAnimationStart,w=i.onAnimationEnd,T=i.steps,A=i.children,I=this.manager;if(this.unSubscribe=I.subscribe(this.handleStyleChange),typeof g=="function"||typeof A=="function"||g==="spring"){this.runJSAnimation(i);return}if(T.length>1){this.runStepAnimation(i);return}var P=a?qx({},a,p):p,D=V8(Object.keys(P),u,g);I.start([v,o,ql(ql({},P),{},{transition:D}),u,w])}},{key:"render",value:function(){var i=this.props,o=i.children;i.begin;var u=i.duration;i.attributeName,i.easing;var a=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var p=ITe(i,PTe),g=Y.Children.count(o),v=this.state.style;if(typeof o=="function")return o(v);if(!a||g===0||u<=0)return o;var w=function(A){var I=A.props,P=I.style,D=P===void 0?{}:P,L=I.className,O=Y.cloneElement(A,ql(ql({},p),{},{style:ql(ql({},D),v),className:L}));return O};return g===1?w(Y.Children.only(o)):Le.createElement("div",null,Y.Children.map(o,function(T){return w(T)}))}}]),r}(Y.PureComponent);yS.displayName="Animate";yS.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};yS.propTypes={from:Nn.oneOfType([Nn.object,Nn.string]),to:Nn.oneOfType([Nn.object,Nn.string]),attributeName:Nn.string,duration:Nn.number,begin:Nn.number,easing:Nn.oneOfType([Nn.string,Nn.func]),steps:Nn.arrayOf(Nn.shape({duration:Nn.number.isRequired,style:Nn.object.isRequired,easing:Nn.oneOfType([Nn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Nn.func]),properties:Nn.arrayOf("string"),onAnimationEnd:Nn.func})),children:Nn.oneOfType([Nn.node,Nn.func]),isActive:Nn.bool,canBegin:Nn.bool,onAnimationEnd:Nn.func,shouldReAnimate:Nn.bool,onAnimationStart:Nn.func,onAnimationReStart:Nn.func};const hd=yS;function k_(t){"@babel/helpers - typeof";return k_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k_(t)}function vk(){return vk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vk.apply(this,arguments)}function qTe(t,e){return KTe(t)||HTe(t,e)||WTe(t,e)||GTe()}function GTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WTe(t,e){if(t){if(typeof t=="string")return Z8(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z8(t,e)}}function Z8(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function HTe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function KTe(t){if(Array.isArray(t))return t}function X8(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Y8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?X8(Object(r),!0).forEach(function(n){ZTe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):X8(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZTe(t,e,r){return e=XTe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XTe(t){var e=YTe(t,"string");return k_(e)=="symbol"?e:e+""}function YTe(t,e){if(k_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(k_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var J8=function(e,r,n,i,o){var u=Math.min(Math.abs(n)/2,Math.abs(i)/2),a=i>=0?1:-1,p=n>=0?1:-1,g=i>=0&&n>=0||i<0&&n<0?1:0,v;if(u>0&&o instanceof Array){for(var w=[0,0,0,0],T=0,A=4;T<A;T++)w[T]=o[T]>u?u:o[T];v="M".concat(e,",").concat(r+a*w[0]),w[0]>0&&(v+="A ".concat(w[0],",").concat(w[0],",0,0,").concat(g,",").concat(e+p*w[0],",").concat(r)),v+="L ".concat(e+n-p*w[1],",").concat(r),w[1]>0&&(v+="A ".concat(w[1],",").concat(w[1],",0,0,").concat(g,`,
        `).concat(e+n,",").concat(r+a*w[1])),v+="L ".concat(e+n,",").concat(r+i-a*w[2]),w[2]>0&&(v+="A ".concat(w[2],",").concat(w[2],",0,0,").concat(g,`,
        `).concat(e+n-p*w[2],",").concat(r+i)),v+="L ".concat(e+p*w[3],",").concat(r+i),w[3]>0&&(v+="A ".concat(w[3],",").concat(w[3],",0,0,").concat(g,`,
        `).concat(e,",").concat(r+i-a*w[3])),v+="Z"}else if(u>0&&o===+o&&o>0){var I=Math.min(u,o);v="M ".concat(e,",").concat(r+a*I,`
            A `).concat(I,",").concat(I,",0,0,").concat(g,",").concat(e+p*I,",").concat(r,`
            L `).concat(e+n-p*I,",").concat(r,`
            A `).concat(I,",").concat(I,",0,0,").concat(g,",").concat(e+n,",").concat(r+a*I,`
            L `).concat(e+n,",").concat(r+i-a*I,`
            A `).concat(I,",").concat(I,",0,0,").concat(g,",").concat(e+n-p*I,",").concat(r+i,`
            L `).concat(e+p*I,",").concat(r+i,`
            A `).concat(I,",").concat(I,",0,0,").concat(g,",").concat(e,",").concat(r+i-a*I," Z")}else v="M ".concat(e,",").concat(r," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return v},JTe=function(e,r){if(!e||!r)return!1;var n=e.x,i=e.y,o=r.x,u=r.y,a=r.width,p=r.height;if(Math.abs(a)>0&&Math.abs(p)>0){var g=Math.min(o,o+a),v=Math.max(o,o+a),w=Math.min(u,u+p),T=Math.max(u,u+p);return n>=g&&n<=v&&i>=w&&i<=T}return!1},QTe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},t3=function(e){var r=Y8(Y8({},QTe),e),n=Y.useRef(),i=Y.useState(-1),o=qTe(i,2),u=o[0],a=o[1];Y.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var G=n.current.getTotalLength();G&&a(G)}catch{}},[]);var p=r.x,g=r.y,v=r.width,w=r.height,T=r.radius,A=r.className,I=r.animationEasing,P=r.animationDuration,D=r.animationBegin,L=r.isAnimationActive,O=r.isUpdateAnimationActive;if(p!==+p||g!==+g||v!==+v||w!==+w||v===0||w===0)return null;var $=Fr("recharts-rectangle",A);return O?Le.createElement(hd,{canBegin:u>0,from:{width:v,height:w,x:p,y:g},to:{width:v,height:w,x:p,y:g},duration:P,animationEasing:I,isActive:O},function(G){var B=G.width,J=G.height,W=G.x,H=G.y;return Le.createElement(hd,{canBegin:u>0,from:"0px ".concat(u===-1?1:u,"px"),to:"".concat(u,"px 0px"),attributeName:"strokeDasharray",begin:D,duration:P,isActive:L,easing:I},Le.createElement("path",vk({},fr(r,!0),{className:$,d:J8(W,H,B,J,T),ref:n})))}):Le.createElement("path",vk({},fr(r,!0),{className:$,d:J8(p,g,v,w,T)}))},eSe=["points","className","baseLinePoints","connectNulls"];function pg(){return pg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pg.apply(this,arguments)}function tSe(t,e){if(t==null)return{};var r=rSe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function rSe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Q8(t){return sSe(t)||aSe(t)||iSe(t)||nSe()}function nSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iSe(t,e){if(t){if(typeof t=="string")return gP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gP(t,e)}}function aSe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function sSe(t){if(Array.isArray(t))return gP(t)}function gP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var e$=function(e){return e&&e.x===+e.x&&e.y===+e.y},oSe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return e.forEach(function(n){e$(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),e$(e[0])&&r[r.length-1].push(e[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},_v=function(e,r){var n=oSe(e);r&&(n=[n.reduce(function(o,u){return[].concat(Q8(o),Q8(u))},[])]);var i=n.map(function(o){return o.reduce(function(u,a,p){return"".concat(u).concat(p===0?"M":"L").concat(a.x,",").concat(a.y)},"")}).join("");return n.length===1?"".concat(i,"Z"):i},lSe=function(e,r,n){var i=_v(e,n);return"".concat(i.slice(-1)==="Z"?i.slice(0,-1):i,"L").concat(_v(r.reverse(),n).slice(1))},cSe=function(e){var r=e.points,n=e.className,i=e.baseLinePoints,o=e.connectNulls,u=tSe(e,eSe);if(!r||!r.length)return null;var a=Fr("recharts-polygon",n);if(i&&i.length){var p=u.stroke&&u.stroke!=="none",g=lSe(r,i,o);return Le.createElement("g",{className:a},Le.createElement("path",pg({},fr(u,!0),{fill:g.slice(-1)==="Z"?u.fill:"none",stroke:"none",d:g})),p?Le.createElement("path",pg({},fr(u,!0),{fill:"none",d:_v(r,o)})):null,p?Le.createElement("path",pg({},fr(u,!0),{fill:"none",d:_v(i,o)})):null)}var v=_v(r,o);return Le.createElement("path",pg({},fr(u,!0),{fill:v.slice(-1)==="Z"?u.fill:"none",className:a,d:v}))};function yP(){return yP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yP.apply(this,arguments)}var mb=function(e){var r=e.cx,n=e.cy,i=e.r,o=e.className,u=Fr("recharts-dot",o);return r===+r&&n===+n&&i===+i?Y.createElement("circle",yP({},fr(e,!1),B2(e),{className:u,cx:r,cy:n,r:i})):null};function T_(t){"@babel/helpers - typeof";return T_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T_(t)}var uSe=["x","y","top","left","width","height","className"];function xP(){return xP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xP.apply(this,arguments)}function t$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function dSe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?t$(Object(r),!0).forEach(function(n){hSe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):t$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hSe(t,e,r){return e=fSe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fSe(t){var e=pSe(t,"string");return T_(e)=="symbol"?e:e+""}function pSe(t,e){if(T_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(T_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mSe(t,e){if(t==null)return{};var r=gSe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function gSe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var ySe=function(e,r,n,i,o,u){return"M".concat(e,",").concat(o,"v").concat(i,"M").concat(u,",").concat(r,"h").concat(n)},xSe=function(e){var r=e.x,n=r===void 0?0:r,i=e.y,o=i===void 0?0:i,u=e.top,a=u===void 0?0:u,p=e.left,g=p===void 0?0:p,v=e.width,w=v===void 0?0:v,T=e.height,A=T===void 0?0:T,I=e.className,P=mSe(e,uSe),D=dSe({x:n,y:o,top:a,left:g,width:w,height:A},P);return!Bt(n)||!Bt(o)||!Bt(w)||!Bt(A)||!Bt(a)||!Bt(g)?null:Le.createElement("path",xP({},fr(D,!0),{className:Fr("recharts-cross",I),d:ySe(n,o,w,A,a,g)}))},vSe=fS,_Se=qG,bSe=hu;function wSe(t,e){return t&&t.length?vSe(t,bSe(e),_Se):void 0}var kSe=wSe;const TSe=Pn(kSe);var SSe=fS,ESe=hu,jSe=GG;function ASe(t,e){return t&&t.length?SSe(t,ESe(e),jSe):void 0}var NSe=ASe;const CSe=Pn(NSe);var PSe=["cx","cy","angle","ticks","axisLine"],ISe=["ticks","tick","angle","tickFormatter","stroke"];function s0(t){"@babel/helpers - typeof";return s0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s0(t)}function bv(){return bv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bv.apply(this,arguments)}function r$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Jf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?r$(Object(r),!0).forEach(function(n){xS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):r$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function n$(t,e){if(t==null)return{};var r=MSe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function MSe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function DSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DW(n.key),n)}}function OSe(t,e,r){return e&&i$(t.prototype,e),r&&i$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function RSe(t,e,r){return e=_k(e),LSe(t,MW()?Reflect.construct(e,r||[],_k(t).constructor):e.apply(t,r))}function LSe(t,e){if(e&&(s0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zSe(t)}function zSe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MW=function(){return!!t})()}function _k(t){return _k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_k(t)}function $Se(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vP(t,e)}function vP(t,e){return vP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},vP(t,e)}function xS(t,e,r){return e=DW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DW(t){var e=FSe(t,"string");return s0(e)=="symbol"?e:e+""}function FSe(t,e){if(s0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(s0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vS=function(t){function e(){return DSe(this,e),RSe(this,e,arguments)}return $Se(e,t),OSe(e,[{key:"getTickValueCoord",value:function(n){var i=n.coordinate,o=this.props,u=o.angle,a=o.cx,p=o.cy;return Xn(a,p,i,u)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,i;switch(n){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var n=this.props,i=n.cx,o=n.cy,u=n.angle,a=n.ticks,p=TSe(a,function(v){return v.coordinate||0}),g=CSe(a,function(v){return v.coordinate||0});return{cx:i,cy:o,startAngle:u,endAngle:u,innerRadius:g.coordinate||0,outerRadius:p.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,o=n.cy,u=n.angle,a=n.ticks,p=n.axisLine,g=n$(n,PSe),v=a.reduce(function(I,P){return[Math.min(I[0],P.coordinate),Math.max(I[1],P.coordinate)]},[1/0,-1/0]),w=Xn(i,o,v[0],u),T=Xn(i,o,v[1],u),A=Jf(Jf(Jf({},fr(g,!1)),{},{fill:"none"},fr(p,!1)),{},{x1:w.x,y1:w.y,x2:T.x,y2:T.y});return Le.createElement("line",bv({className:"recharts-polar-radius-axis-line"},A))}},{key:"renderTicks",value:function(){var n=this,i=this.props,o=i.ticks,u=i.tick,a=i.angle,p=i.tickFormatter,g=i.stroke,v=n$(i,ISe),w=this.getTickTextAnchor(),T=fr(v,!1),A=fr(u,!1),I=o.map(function(P,D){var L=n.getTickValueCoord(P),O=Jf(Jf(Jf(Jf({textAnchor:w,transform:"rotate(".concat(90-a,", ").concat(L.x,", ").concat(L.y,")")},T),{},{stroke:"none",fill:g},A),{},{index:D},L),{},{payload:P});return Le.createElement(Ur,bv({className:Fr("recharts-polar-radius-axis-tick",vW(u)),key:"tick-".concat(P.coordinate)},Gh(n.props,P,D)),e.renderTickItem(u,O,p?p(P.value,D):P.value))});return Le.createElement(Ur,{className:"recharts-polar-radius-axis-ticks"},I)}},{key:"render",value:function(){var n=this.props,i=n.ticks,o=n.axisLine,u=n.tick;return!i||!i.length?null:Le.createElement(Ur,{className:Fr("recharts-polar-radius-axis",this.props.className)},o&&this.renderAxisLine(),u&&this.renderTicks(),Aa.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,i,o){var u;return Le.isValidElement(n)?u=Le.cloneElement(n,i):Tr(n)?u=n(i):u=Le.createElement(Op,bv({},i,{className:"recharts-polar-radius-axis-tick-value"}),o),u}}])}(Y.PureComponent);xS(vS,"displayName","PolarRadiusAxis");xS(vS,"axisType","radiusAxis");xS(vS,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function o0(t){"@babel/helpers - typeof";return o0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o0(t)}function lp(){return lp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},lp.apply(this,arguments)}function a$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Qf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?a$(Object(r),!0).forEach(function(n){_S(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,RW(n.key),n)}}function VSe(t,e,r){return e&&s$(t.prototype,e),r&&s$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function USe(t,e,r){return e=bk(e),qSe(t,OW()?Reflect.construct(e,r||[],bk(t).constructor):e.apply(t,r))}function qSe(t,e){if(e&&(o0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GSe(t)}function GSe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OW=function(){return!!t})()}function bk(t){return bk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bk(t)}function WSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_P(t,e)}function _P(t,e){return _P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_P(t,e)}function _S(t,e,r){return e=RW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RW(t){var e=HSe(t,"string");return o0(e)=="symbol"?e:e+""}function HSe(t,e){if(o0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(o0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KSe=Math.PI/180,o$=1e-5,bS=function(t){function e(){return BSe(this,e),USe(this,e,arguments)}return WSe(e,t),VSe(e,[{key:"getTickLineCoord",value:function(n){var i=this.props,o=i.cx,u=i.cy,a=i.radius,p=i.orientation,g=i.tickSize,v=g||8,w=Xn(o,u,a,n.coordinate),T=Xn(o,u,a+(p==="inner"?-1:1)*v,n.coordinate);return{x1:w.x,y1:w.y,x2:T.x,y2:T.y}}},{key:"getTickTextAnchor",value:function(n){var i=this.props.orientation,o=Math.cos(-n.coordinate*KSe),u;return o>o$?u=i==="outer"?"start":"end":o<-o$?u=i==="outer"?"end":"start":u="middle",u}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,o=n.cy,u=n.radius,a=n.axisLine,p=n.axisLineType,g=Qf(Qf({},fr(this.props,!1)),{},{fill:"none"},fr(a,!1));if(p==="circle")return Le.createElement(mb,lp({className:"recharts-polar-angle-axis-line"},g,{cx:i,cy:o,r:u}));var v=this.props.ticks,w=v.map(function(T){return Xn(i,o,u,T.coordinate)});return Le.createElement(cSe,lp({className:"recharts-polar-angle-axis-line"},g,{points:w}))}},{key:"renderTicks",value:function(){var n=this,i=this.props,o=i.ticks,u=i.tick,a=i.tickLine,p=i.tickFormatter,g=i.stroke,v=fr(this.props,!1),w=fr(u,!1),T=Qf(Qf({},v),{},{fill:"none"},fr(a,!1)),A=o.map(function(I,P){var D=n.getTickLineCoord(I),L=n.getTickTextAnchor(I),O=Qf(Qf(Qf({textAnchor:L},v),{},{stroke:"none",fill:g},w),{},{index:P,payload:I,x:D.x2,y:D.y2});return Le.createElement(Ur,lp({className:Fr("recharts-polar-angle-axis-tick",vW(u)),key:"tick-".concat(I.coordinate)},Gh(n.props,I,P)),a&&Le.createElement("line",lp({className:"recharts-polar-angle-axis-tick-line"},T,D)),u&&e.renderTickItem(u,O,p?p(I.value,P):I.value))});return Le.createElement(Ur,{className:"recharts-polar-angle-axis-ticks"},A)}},{key:"render",value:function(){var n=this.props,i=n.ticks,o=n.radius,u=n.axisLine;return o<=0||!i||!i.length?null:Le.createElement(Ur,{className:Fr("recharts-polar-angle-axis",this.props.className)},u&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,i,o){var u;return Le.isValidElement(n)?u=Le.cloneElement(n,i):Tr(n)?u=n(i):u=Le.createElement(Op,lp({},i,{className:"recharts-polar-angle-axis-tick-value"}),o),u}}])}(Y.PureComponent);_S(bS,"displayName","PolarAngleAxis");_S(bS,"axisType","angleAxis");_S(bS,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var ZSe=Lq,XSe=ZSe(Object.getPrototypeOf,Object),YSe=XSe,JSe=bd,QSe=YSe,eEe=wd,tEe="[object Object]",rEe=Function.prototype,nEe=Object.prototype,LW=rEe.toString,iEe=nEe.hasOwnProperty,aEe=LW.call(Object);function sEe(t){if(!eEe(t)||JSe(t)!=tEe)return!1;var e=QSe(t);if(e===null)return!0;var r=iEe.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&LW.call(r)==aEe}var oEe=sEe;const lEe=Pn(oEe);var cEe=bd,uEe=wd,dEe="[object Boolean]";function hEe(t){return t===!0||t===!1||uEe(t)&&cEe(t)==dEe}var fEe=hEe;const pEe=Pn(fEe);function S_(t){"@babel/helpers - typeof";return S_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S_(t)}function wk(){return wk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wk.apply(this,arguments)}function mEe(t,e){return vEe(t)||xEe(t,e)||yEe(t,e)||gEe()}function gEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yEe(t,e){if(t){if(typeof t=="string")return l$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l$(t,e)}}function l$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function xEe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function vEe(t){if(Array.isArray(t))return t}function c$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function u$(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?c$(Object(r),!0).forEach(function(n){_Ee(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _Ee(t,e,r){return e=bEe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bEe(t){var e=wEe(t,"string");return S_(e)=="symbol"?e:e+""}function wEe(t,e){if(S_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(S_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var d$=function(e,r,n,i,o){var u=n-i,a;return a="M ".concat(e,",").concat(r),a+="L ".concat(e+n,",").concat(r),a+="L ".concat(e+n-u/2,",").concat(r+o),a+="L ".concat(e+n-u/2-i,",").concat(r+o),a+="L ".concat(e,",").concat(r," Z"),a},kEe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},TEe=function(e){var r=u$(u$({},kEe),e),n=Y.useRef(),i=Y.useState(-1),o=mEe(i,2),u=o[0],a=o[1];Y.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var $=n.current.getTotalLength();$&&a($)}catch{}},[]);var p=r.x,g=r.y,v=r.upperWidth,w=r.lowerWidth,T=r.height,A=r.className,I=r.animationEasing,P=r.animationDuration,D=r.animationBegin,L=r.isUpdateAnimationActive;if(p!==+p||g!==+g||v!==+v||w!==+w||T!==+T||v===0&&w===0||T===0)return null;var O=Fr("recharts-trapezoid",A);return L?Le.createElement(hd,{canBegin:u>0,from:{upperWidth:0,lowerWidth:0,height:T,x:p,y:g},to:{upperWidth:v,lowerWidth:w,height:T,x:p,y:g},duration:P,animationEasing:I,isActive:L},function($){var G=$.upperWidth,B=$.lowerWidth,J=$.height,W=$.x,H=$.y;return Le.createElement(hd,{canBegin:u>0,from:"0px ".concat(u===-1?1:u,"px"),to:"".concat(u,"px 0px"),attributeName:"strokeDasharray",begin:D,duration:P,easing:I},Le.createElement("path",wk({},fr(r,!0),{className:O,d:d$(W,H,G,B,J),ref:n})))}):Le.createElement("g",null,Le.createElement("path",wk({},fr(r,!0),{className:O,d:d$(p,g,v,w,T)})))},SEe=["option","shapeType","propTransformer","activeClassName","isActive"];function E_(t){"@babel/helpers - typeof";return E_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E_(t)}function EEe(t,e){if(t==null)return{};var r=jEe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function jEe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function h$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function kk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?h$(Object(r),!0).forEach(function(n){AEe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AEe(t,e,r){return e=NEe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NEe(t){var e=CEe(t,"string");return E_(e)=="symbol"?e:e+""}function CEe(t,e){if(E_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(E_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PEe(t,e){return kk(kk({},e),t)}function IEe(t,e){return t==="symbols"}function f$(t){var e=t.shapeType,r=t.elementProps;switch(e){case"rectangle":return Le.createElement(t3,r);case"trapezoid":return Le.createElement(TEe,r);case"sector":return Le.createElement(wW,r);case"symbols":if(IEe(e))return Le.createElement(nS,r);break;default:return null}}function MEe(t){return Y.isValidElement(t)?t.props:t}function Tk(t){var e=t.option,r=t.shapeType,n=t.propTransformer,i=n===void 0?PEe:n,o=t.activeClassName,u=o===void 0?"recharts-active-shape":o,a=t.isActive,p=EEe(t,SEe),g;if(Y.isValidElement(e))g=Y.cloneElement(e,kk(kk({},p),MEe(e)));else if(Tr(e))g=e(p);else if(lEe(e)&&!pEe(e)){var v=i(e,p);g=Le.createElement(f$,{shapeType:r,elementProps:v})}else{var w=p;g=Le.createElement(f$,{shapeType:r,elementProps:w})}return a?Le.createElement(Ur,{className:u},g):g}function wS(t,e){return e!=null&&"trapezoids"in t.props}function kS(t,e){return e!=null&&"sectors"in t.props}function j_(t,e){return e!=null&&"points"in t.props}function DEe(t,e){var r,n,i=t.x===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.x)||t.x===e.x,o=t.y===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.y)||t.y===e.y;return i&&o}function OEe(t,e){var r=t.endAngle===e.endAngle,n=t.startAngle===e.startAngle;return r&&n}function REe(t,e){var r=t.x===e.x,n=t.y===e.y,i=t.z===e.z;return r&&n&&i}function LEe(t,e){var r;return wS(t,e)?r=DEe:kS(t,e)?r=OEe:j_(t,e)&&(r=REe),r}function zEe(t,e){var r;return wS(t,e)?r="trapezoids":kS(t,e)?r="sectors":j_(t,e)&&(r="points"),r}function $Ee(t,e){if(wS(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(kS(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return j_(t,e)?e.payload:{}}function FEe(t){var e=t.activeTooltipItem,r=t.graphicalItem,n=t.itemData,i=zEe(r,e),o=$Ee(r,e),u=n.filter(function(p,g){var v=Wh(o,p),w=r.props[i].filter(function(I){var P=LEe(r,e);return P(I,e)}),T=r.props[i].indexOf(w[w.length-1]),A=g===T;return v&&A}),a=n.indexOf(u[u.length-1]);return a}var Qw;function l0(t){"@babel/helpers - typeof";return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l0(t)}function mg(){return mg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mg.apply(this,arguments)}function p$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Hn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?p$(Object(r),!0).forEach(function(n){al(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$W(n.key),n)}}function VEe(t,e,r){return e&&m$(t.prototype,e),r&&m$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function UEe(t,e,r){return e=Sk(e),qEe(t,zW()?Reflect.construct(e,r||[],Sk(t).constructor):e.apply(t,r))}function qEe(t,e){if(e&&(l0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GEe(t)}function GEe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zW=function(){return!!t})()}function Sk(t){return Sk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sk(t)}function WEe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bP(t,e)}function bP(t,e){return bP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},bP(t,e)}function al(t,e,r){return e=$W(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $W(t){var e=HEe(t,"string");return l0(e)=="symbol"?e:e+""}function HEe(t,e){if(l0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(l0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fc=function(t){function e(r){var n;return BEe(this,e),n=UEe(this,e,[r]),al(n,"pieRef",null),al(n,"sectorRefs",[]),al(n,"id",uf("recharts-pie-")),al(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Tr(i)&&i()}),al(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Tr(i)&&i()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return WEe(e,t),VEe(e,[{key:"isActiveIndex",value:function(n){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(n)!==-1:n===i}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var o=this.props,u=o.label,a=o.labelLine,p=o.dataKey,g=o.valueKey,v=fr(this.props,!1),w=fr(u,!1),T=fr(a,!1),A=u&&u.offsetRadius||20,I=n.map(function(P,D){var L=(P.startAngle+P.endAngle)/2,O=Xn(P.cx,P.cy,P.outerRadius+A,L),$=Hn(Hn(Hn(Hn({},v),P),{},{stroke:"none"},w),{},{index:D,textAnchor:e.getTextAnchor(O.x,P.cx)},O),G=Hn(Hn(Hn(Hn({},v),P),{},{fill:"none",stroke:P.fill},T),{},{index:D,points:[Xn(P.cx,P.cy,P.outerRadius,L),O]}),B=p;return _r(p)&&_r(g)?B="value":_r(p)&&(B=g),Le.createElement(Ur,{key:"label-".concat(P.startAngle,"-").concat(P.endAngle,"-").concat(P.midAngle,"-").concat(D)},a&&e.renderLabelLineItem(a,G,"line"),e.renderLabelItem(u,$,ai(P,B)))});return Le.createElement(Ur,{className:"recharts-pie-labels"},I)}},{key:"renderSectorsStatically",value:function(n){var i=this,o=this.props,u=o.activeShape,a=o.blendStroke,p=o.inactiveShape;return n.map(function(g,v){if((g==null?void 0:g.startAngle)===0&&(g==null?void 0:g.endAngle)===0&&n.length!==1)return null;var w=i.isActiveIndex(v),T=p&&i.hasActiveIndex()?p:null,A=w?u:T,I=Hn(Hn({},g),{},{stroke:a?g.fill:g.stroke,tabIndex:-1});return Le.createElement(Ur,mg({ref:function(D){D&&!i.sectorRefs.includes(D)&&i.sectorRefs.push(D)},tabIndex:-1,className:"recharts-pie-sector"},Gh(i.props,g,v),{key:"sector-".concat(g==null?void 0:g.startAngle,"-").concat(g==null?void 0:g.endAngle,"-").concat(g.midAngle,"-").concat(v)}),Le.createElement(Tk,mg({option:A,isActive:w,shapeType:"sector"},I)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,i=this.props,o=i.sectors,u=i.isAnimationActive,a=i.animationBegin,p=i.animationDuration,g=i.animationEasing,v=i.animationId,w=this.state,T=w.prevSectors,A=w.prevIsAnimationActive;return Le.createElement(hd,{begin:a,duration:p,isActive:u,easing:g,from:{t:0},to:{t:1},key:"pie-".concat(v,"-").concat(A),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(I){var P=I.t,D=[],L=o&&o[0],O=L.startAngle;return o.forEach(function($,G){var B=T&&T[G],J=G>0?jo($,"paddingAngle",0):0;if(B){var W=Ei(B.endAngle-B.startAngle,$.endAngle-$.startAngle),H=Hn(Hn({},$),{},{startAngle:O+J,endAngle:O+W(P)+J});D.push(H),O=H.endAngle}else{var V=$.endAngle,se=$.startAngle,K=Ei(0,V-se),ce=K(P),ne=Hn(Hn({},$),{},{startAngle:O+J,endAngle:O+ce+J});D.push(ne),O=ne.endAngle}}),Le.createElement(Ur,null,n.renderSectorsStatically(D))})}},{key:"attachKeyboardHandlers",value:function(n){var i=this;n.onkeydown=function(o){if(!o.altKey)switch(o.key){case"ArrowLeft":{var u=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[u].focus(),i.setState({sectorToFocus:u});break}case"ArrowRight":{var a=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[a].focus(),i.setState({sectorToFocus:a});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,i=n.sectors,o=n.isAnimationActive,u=this.state.prevSectors;return o&&i&&i.length&&(!u||!Wh(u,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,i=this.props,o=i.hide,u=i.sectors,a=i.className,p=i.label,g=i.cx,v=i.cy,w=i.innerRadius,T=i.outerRadius,A=i.isAnimationActive,I=this.state.isAnimationFinished;if(o||!u||!u.length||!Bt(g)||!Bt(v)||!Bt(w)||!Bt(T))return null;var P=Fr("recharts-pie",a);return Le.createElement(Ur,{tabIndex:this.props.rootTabIndex,className:P,ref:function(L){n.pieRef=L}},this.renderSectors(),p&&this.renderLabels(u),Aa.renderCallByParent(this.props,null,!1),(!A||I)&&sc.renderCallByParent(this.props,u,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return i.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:n.sectors!==i.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,i){return n>i?"start":n<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,i,o){if(Le.isValidElement(n))return Le.cloneElement(n,i);if(Tr(n))return n(i);var u=Fr("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return Le.createElement(Oh,mg({},i,{key:o,type:"linear",className:u}))}},{key:"renderLabelItem",value:function(n,i,o){if(Le.isValidElement(n))return Le.cloneElement(n,i);var u=o;if(Tr(n)&&(u=n(i),Le.isValidElement(u)))return u;var a=Fr("recharts-pie-label-text",typeof n!="boolean"&&!Tr(n)?n.className:"");return Le.createElement(Op,mg({},i,{alignmentBaseline:"middle",className:a}),u)}}])}(Y.PureComponent);Qw=fc;al(fc,"displayName","Pie");al(fc,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!dl.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});al(fc,"parseDeltaAngle",function(t,e){var r=Es(e-t),n=Math.min(Math.abs(e-t),360);return r*n});al(fc,"getRealPieData",function(t){var e=t.data,r=t.children,n=fr(t,!1),i=Ps(r,Hp);return e&&e.length?e.map(function(o,u){return Hn(Hn(Hn({payload:o},n),o),i&&i[u]&&i[u].props)}):i&&i.length?i.map(function(o){return Hn(Hn({},n),o.props)}):[]});al(fc,"parseCoordinateOfPie",function(t,e){var r=e.top,n=e.left,i=e.width,o=e.height,u=xW(i,o),a=n+js(t.cx,i,i/2),p=r+js(t.cy,o,o/2),g=js(t.innerRadius,u,0),v=js(t.outerRadius,u,u*.8),w=t.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:a,cy:p,innerRadius:g,outerRadius:v,maxRadius:w}});al(fc,"getComposedData",function(t){var e=t.item,r=t.offset,n=e.type.defaultProps!==void 0?Hn(Hn({},e.type.defaultProps),e.props):e.props,i=Qw.getRealPieData(n);if(!i||!i.length)return null;var o=n.cornerRadius,u=n.startAngle,a=n.endAngle,p=n.paddingAngle,g=n.dataKey,v=n.nameKey,w=n.valueKey,T=n.tooltipType,A=Math.abs(n.minAngle),I=Qw.parseCoordinateOfPie(n,r),P=Qw.parseDeltaAngle(u,a),D=Math.abs(P),L=g;_r(g)&&_r(w)?(ac(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),L="value"):_r(g)&&(ac(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),L=w);var O=i.filter(function(H){return ai(H,L,0)!==0}).length,$=(D>=360?O:O-1)*p,G=D-O*A-$,B=i.reduce(function(H,V){var se=ai(V,L,0);return H+(Bt(se)?se:0)},0),J;if(B>0){var W;J=i.map(function(H,V){var se=ai(H,L,0),K=ai(H,v,V),ce=(Bt(se)?se:0)/B,ne;V?ne=W.endAngle+Es(P)*p*(se!==0?1:0):ne=u;var re=ne+Es(P)*((se!==0?A:0)+ce*G),oe=(ne+re)/2,ae=(I.innerRadius+I.outerRadius)/2,xe=[{name:K,value:se,payload:H,dataKey:L,type:T}],ye=Xn(I.cx,I.cy,ae,oe);return W=Hn(Hn(Hn({percent:ce,cornerRadius:o,name:K,tooltipPayload:xe,midAngle:oe,middleRadius:ae,tooltipPosition:ye},H),I),{},{value:ai(H,L),startAngle:ne,endAngle:re,payload:H,paddingAngle:Es(P)*p}),W})}return Hn(Hn({},I),{},{sectors:J,data:i})});var KEe=Math.ceil,ZEe=Math.max;function XEe(t,e,r,n){for(var i=-1,o=ZEe(KEe((e-t)/(r||1)),0),u=Array(o);o--;)u[n?o:++i]=t,t+=r;return u}var YEe=XEe,JEe=rG,g$=1/0,QEe=17976931348623157e292;function eje(t){if(!t)return t===0?t:0;if(t=JEe(t),t===g$||t===-g$){var e=t<0?-1:1;return e*QEe}return t===t?t:0}var FW=eje,tje=YEe,rje=sS,RA=FW;function nje(t){return function(e,r,n){return n&&typeof n!="number"&&rje(e,r,n)&&(r=n=void 0),e=RA(e),r===void 0?(r=e,e=0):r=RA(r),n=n===void 0?e<r?1:-1:RA(n),tje(e,r,n,t)}}var ije=nje,aje=ije,sje=aje(),oje=sje;const Ek=Pn(oje);function A_(t){"@babel/helpers - typeof";return A_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A_(t)}function y$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function x$(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?y$(Object(r),!0).forEach(function(n){BW(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BW(t,e,r){return e=lje(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lje(t){var e=cje(t,"string");return A_(e)=="symbol"?e:e+""}function cje(t,e){if(A_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(A_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uje=["Webkit","Moz","O","ms"],dje=function(e,r){if(!e)return null;var n=e.replace(/(\w)/,function(o){return o.toUpperCase()}),i=uje.reduce(function(o,u){return x$(x$({},o),{},BW({},u+n,r))},{});return i[e]=r,i};function c0(t){"@babel/helpers - typeof";return c0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c0(t)}function jk(){return jk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jk.apply(this,arguments)}function v$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function LA(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?v$(Object(r),!0).forEach(function(n){_o(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function hje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,UW(n.key),n)}}function fje(t,e,r){return e&&_$(t.prototype,e),r&&_$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function pje(t,e,r){return e=Ak(e),mje(t,VW()?Reflect.construct(e,r||[],Ak(t).constructor):e.apply(t,r))}function mje(t,e){if(e&&(c0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gje(t)}function gje(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(VW=function(){return!!t})()}function Ak(t){return Ak=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ak(t)}function yje(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wP(t,e)}function wP(t,e){return wP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},wP(t,e)}function _o(t,e,r){return e=UW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UW(t){var e=xje(t,"string");return c0(e)=="symbol"?e:e+""}function xje(t,e){if(c0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(c0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vje=function(e){var r=e.data,n=e.startIndex,i=e.endIndex,o=e.x,u=e.width,a=e.travellerWidth;if(!r||!r.length)return{};var p=r.length,g=yv().domain(Ek(0,p)).range([o,o+u-a]),v=g.domain().map(function(w){return g(w)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:g(n),endX:g(i),scale:g,scaleValues:v}},b$=function(e){return e.changedTouches&&!!e.changedTouches.length},u0=function(t){function e(r){var n;return hje(this,e),n=pje(this,e,[r]),_o(n,"handleDrag",function(i){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(i):n.state.isSlideMoving&&n.handleSlideDrag(i)}),_o(n,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&n.handleDrag(i.changedTouches[0])}),_o(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=n.props,o=i.endIndex,u=i.onDragEnd,a=i.startIndex;u==null||u({endIndex:o,startIndex:a})}),n.detachDragEndListener()}),_o(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),_o(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),_o(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),_o(n,"handleSlideDragStart",function(i){var o=b$(i)?i.changedTouches[0]:i;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return yje(e,t),fje(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var i=n.startX,o=n.endX,u=this.state.scaleValues,a=this.props,p=a.gap,g=a.data,v=g.length-1,w=Math.min(i,o),T=Math.max(i,o),A=e.getIndexInRange(u,w),I=e.getIndexInRange(u,T);return{startIndex:A-A%p,endIndex:I===v?v:I-I%p}}},{key:"getTextOfTick",value:function(n){var i=this.props,o=i.data,u=i.tickFormatter,a=i.dataKey,p=ai(o[n],a,n);return Tr(u)?u(p,n):p}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var i=this.state,o=i.slideMoveStartX,u=i.startX,a=i.endX,p=this.props,g=p.x,v=p.width,w=p.travellerWidth,T=p.startIndex,A=p.endIndex,I=p.onChange,P=n.pageX-o;P>0?P=Math.min(P,g+v-w-a,g+v-w-u):P<0&&(P=Math.max(P,g-u,g-a));var D=this.getIndex({startX:u+P,endX:a+P});(D.startIndex!==T||D.endIndex!==A)&&I&&I(D),this.setState({startX:u+P,endX:a+P,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,i){var o=b$(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var i=this.state,o=i.brushMoveStartX,u=i.movingTravellerId,a=i.endX,p=i.startX,g=this.state[u],v=this.props,w=v.x,T=v.width,A=v.travellerWidth,I=v.onChange,P=v.gap,D=v.data,L={startX:this.state.startX,endX:this.state.endX},O=n.pageX-o;O>0?O=Math.min(O,w+T-A-g):O<0&&(O=Math.max(O,w-g)),L[u]=g+O;var $=this.getIndex(L),G=$.startIndex,B=$.endIndex,J=function(){var H=D.length-1;return u==="startX"&&(a>p?G%P===0:B%P===0)||a<p&&B===H||u==="endX"&&(a>p?B%P===0:G%P===0)||a>p&&B===H};this.setState(_o(_o({},u,g+O),"brushMoveStartX",n.pageX),function(){I&&J()&&I($)})}},{key:"handleTravellerMoveKeyboard",value:function(n,i){var o=this,u=this.state,a=u.scaleValues,p=u.startX,g=u.endX,v=this.state[i],w=a.indexOf(v);if(w!==-1){var T=w+n;if(!(T===-1||T>=a.length)){var A=a[T];i==="startX"&&A>=g||i==="endX"&&A<=p||this.setState(_o({},i,A),function(){o.props.onChange(o.getIndex({startX:o.state.startX,endX:o.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,i=n.x,o=n.y,u=n.width,a=n.height,p=n.fill,g=n.stroke;return Le.createElement("rect",{stroke:g,fill:p,x:i,y:o,width:u,height:a})}},{key:"renderPanorama",value:function(){var n=this.props,i=n.x,o=n.y,u=n.width,a=n.height,p=n.data,g=n.children,v=n.padding,w=Y.Children.only(g);return w?Le.cloneElement(w,{x:i,y:o,width:u,height:a,margin:v,compact:!0,data:p}):null}},{key:"renderTravellerLayer",value:function(n,i){var o,u,a=this,p=this.props,g=p.y,v=p.travellerWidth,w=p.height,T=p.traveller,A=p.ariaLabel,I=p.data,P=p.startIndex,D=p.endIndex,L=Math.max(n,this.props.x),O=LA(LA({},fr(this.props,!1)),{},{x:L,y:g,width:v,height:w}),$=A||"Min value: ".concat((o=I[P])===null||o===void 0?void 0:o.name,", Max value: ").concat((u=I[D])===null||u===void 0?void 0:u.name);return Le.createElement(Ur,{tabIndex:0,role:"slider","aria-label":$,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(B){["ArrowLeft","ArrowRight"].includes(B.key)&&(B.preventDefault(),B.stopPropagation(),a.handleTravellerMoveKeyboard(B.key==="ArrowRight"?1:-1,i))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(T,O))}},{key:"renderSlide",value:function(n,i){var o=this.props,u=o.y,a=o.height,p=o.stroke,g=o.travellerWidth,v=Math.min(n,i)+g,w=Math.max(Math.abs(i-n)-g,0);return Le.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:p,fillOpacity:.2,x:v,y:u,width:w,height:a})}},{key:"renderText",value:function(){var n=this.props,i=n.startIndex,o=n.endIndex,u=n.y,a=n.height,p=n.travellerWidth,g=n.stroke,v=this.state,w=v.startX,T=v.endX,A=5,I={pointerEvents:"none",fill:g};return Le.createElement(Ur,{className:"recharts-brush-texts"},Le.createElement(Op,jk({textAnchor:"end",verticalAnchor:"middle",x:Math.min(w,T)-A,y:u+a/2},I),this.getTextOfTick(i)),Le.createElement(Op,jk({textAnchor:"start",verticalAnchor:"middle",x:Math.max(w,T)+p+A,y:u+a/2},I),this.getTextOfTick(o)))}},{key:"render",value:function(){var n=this.props,i=n.data,o=n.className,u=n.children,a=n.x,p=n.y,g=n.width,v=n.height,w=n.alwaysShowText,T=this.state,A=T.startX,I=T.endX,P=T.isTextActive,D=T.isSlideMoving,L=T.isTravellerMoving,O=T.isTravellerFocused;if(!i||!i.length||!Bt(a)||!Bt(p)||!Bt(g)||!Bt(v)||g<=0||v<=0)return null;var $=Fr("recharts-brush",o),G=Le.Children.count(u)===1,B=dje("userSelect","none");return Le.createElement(Ur,{className:$,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:B},this.renderBackground(),G&&this.renderPanorama(),this.renderSlide(A,I),this.renderTravellerLayer(A,"startX"),this.renderTravellerLayer(I,"endX"),(P||D||L||O||w)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var i=n.x,o=n.y,u=n.width,a=n.height,p=n.stroke,g=Math.floor(o+a/2)-1;return Le.createElement(Le.Fragment,null,Le.createElement("rect",{x:i,y:o,width:u,height:a,fill:p,stroke:"none"}),Le.createElement("line",{x1:i+1,y1:g,x2:i+u-1,y2:g,fill:"none",stroke:"#fff"}),Le.createElement("line",{x1:i+1,y1:g+2,x2:i+u-1,y2:g+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,i){var o;return Le.isValidElement(n)?o=Le.cloneElement(n,i):Tr(n)?o=n(i):o=e.renderDefaultTraveller(i),o}},{key:"getDerivedStateFromProps",value:function(n,i){var o=n.data,u=n.width,a=n.x,p=n.travellerWidth,g=n.updateId,v=n.startIndex,w=n.endIndex;if(o!==i.prevData||g!==i.prevUpdateId)return LA({prevData:o,prevTravellerWidth:p,prevUpdateId:g,prevX:a,prevWidth:u},o&&o.length?vje({data:o,width:u,x:a,travellerWidth:p,startIndex:v,endIndex:w}):{scale:null,scaleValues:null});if(i.scale&&(u!==i.prevWidth||a!==i.prevX||p!==i.prevTravellerWidth)){i.scale.range([a,a+u-p]);var T=i.scale.domain().map(function(A){return i.scale(A)});return{prevData:o,prevTravellerWidth:p,prevUpdateId:g,prevX:a,prevWidth:u,startX:i.scale(n.startIndex),endX:i.scale(n.endIndex),scaleValues:T}}return null}},{key:"getIndexInRange",value:function(n,i){for(var o=n.length,u=0,a=o-1;a-u>1;){var p=Math.floor((u+a)/2);n[p]>i?a=p:u=p}return i>=n[a]?a:u}}])}(Y.PureComponent);_o(u0,"displayName","Brush");_o(u0,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var _je=SM;function bje(t,e){var r;return _je(t,function(n,i,o){return r=e(n,i,o),!r}),!!r}var wje=bje,kje=Nq,Tje=hu,Sje=wje,Eje=so,jje=sS;function Aje(t,e,r){var n=Eje(t)?kje:Sje;return r&&jje(t,e,r)&&(e=void 0),n(t,Tje(e))}var Nje=Aje;const Cje=Pn(Nje);var Zc=function(e,r){var n=e.alwaysShow,i=e.ifOverflow;return n&&(i="extendDomain"),i===r},w$=Yq;function Pje(t,e,r){e=="__proto__"&&w$?w$(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Ije=Pje,Mje=Ije,Dje=Zq,Oje=hu;function Rje(t,e){var r={};return e=Oje(e),Dje(t,function(n,i,o){Mje(r,i,e(n,i,o))}),r}var Lje=Rje;const zje=Pn(Lje);function $je(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}var Fje=$je,Bje=SM;function Vje(t,e){var r=!0;return Bje(t,function(n,i,o){return r=!!e(n,i,o),r}),r}var Uje=Vje,qje=Fje,Gje=Uje,Wje=hu,Hje=so,Kje=sS;function Zje(t,e,r){var n=Hje(t)?qje:Gje;return r&&Kje(t,e,r)&&(e=void 0),n(t,Wje(e))}var Xje=Zje;const qW=Pn(Xje);var Yje=["x","y"];function N_(t){"@babel/helpers - typeof";return N_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N_(t)}function kP(){return kP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kP.apply(this,arguments)}function k$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ox(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?k$(Object(r),!0).forEach(function(n){Jje(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Jje(t,e,r){return e=Qje(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qje(t){var e=eAe(t,"string");return N_(e)=="symbol"?e:e+""}function eAe(t,e){if(N_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(N_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tAe(t,e){if(t==null)return{};var r=rAe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function rAe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function nAe(t,e){var r=t.x,n=t.y,i=tAe(t,Yje),o="".concat(r),u=parseInt(o,10),a="".concat(n),p=parseInt(a,10),g="".concat(e.height||i.height),v=parseInt(g,10),w="".concat(e.width||i.width),T=parseInt(w,10);return Ox(Ox(Ox(Ox(Ox({},e),i),u?{x:u}:{}),p?{y:p}:{}),{},{height:v,width:T,name:e.name,radius:e.radius})}function T$(t){return Le.createElement(Tk,kP({shapeType:"rectangle",propTransformer:nAe,activeClassName:"recharts-active-bar"},t))}var iAe=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,i){if(typeof e=="number")return e;var o=Bt(n)||Ace(n);return o?e(n,i):(o||Lp(!1),r)}},aAe=["value","background"],GW;function d0(t){"@babel/helpers - typeof";return d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d0(t)}function sAe(t,e){if(t==null)return{};var r=oAe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function oAe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Nk(){return Nk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Nk.apply(this,arguments)}function S$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ji(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?S$(Object(r),!0).forEach(function(n){vh(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,HW(n.key),n)}}function cAe(t,e,r){return e&&E$(t.prototype,e),r&&E$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uAe(t,e,r){return e=Ck(e),dAe(t,WW()?Reflect.construct(e,r||[],Ck(t).constructor):e.apply(t,r))}function dAe(t,e){if(e&&(d0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hAe(t)}function hAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function WW(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WW=function(){return!!t})()}function Ck(t){return Ck=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ck(t)}function fAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&TP(t,e)}function TP(t,e){return TP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},TP(t,e)}function vh(t,e,r){return e=HW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HW(t){var e=pAe(t,"string");return d0(e)=="symbol"?e:e+""}function pAe(t,e){if(d0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(d0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ry=function(t){function e(){var r;lAe(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=uAe(this,e,[].concat(i)),vh(r,"state",{isAnimationFinished:!1}),vh(r,"id",uf("recharts-bar-")),vh(r,"handleAnimationEnd",function(){var u=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),u&&u()}),vh(r,"handleAnimationStart",function(){var u=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),u&&u()}),r}return fAe(e,t),cAe(e,[{key:"renderRectanglesStatically",value:function(n){var i=this,o=this.props,u=o.shape,a=o.dataKey,p=o.activeIndex,g=o.activeBar,v=fr(this.props,!1);return n&&n.map(function(w,T){var A=T===p,I=A?g:u,P=Ji(Ji(Ji({},v),w),{},{isActive:A,option:I,index:T,dataKey:a,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return Le.createElement(Ur,Nk({className:"recharts-bar-rectangle"},Gh(i.props,w,T),{key:"rectangle-".concat(w==null?void 0:w.x,"-").concat(w==null?void 0:w.y,"-").concat(w==null?void 0:w.value,"-").concat(T)}),Le.createElement(T$,P))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,i=this.props,o=i.data,u=i.layout,a=i.isAnimationActive,p=i.animationBegin,g=i.animationDuration,v=i.animationEasing,w=i.animationId,T=this.state.prevData;return Le.createElement(hd,{begin:p,duration:g,isActive:a,easing:v,from:{t:0},to:{t:1},key:"bar-".concat(w),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(A){var I=A.t,P=o.map(function(D,L){var O=T&&T[L];if(O){var $=Ei(O.x,D.x),G=Ei(O.y,D.y),B=Ei(O.width,D.width),J=Ei(O.height,D.height);return Ji(Ji({},D),{},{x:$(I),y:G(I),width:B(I),height:J(I)})}if(u==="horizontal"){var W=Ei(0,D.height),H=W(I);return Ji(Ji({},D),{},{y:D.y+D.height-H,height:H})}var V=Ei(0,D.width),se=V(I);return Ji(Ji({},D),{},{width:se})});return Le.createElement(Ur,null,n.renderRectanglesStatically(P))})}},{key:"renderRectangles",value:function(){var n=this.props,i=n.data,o=n.isAnimationActive,u=this.state.prevData;return o&&i&&i.length&&(!u||!Wh(u,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var n=this,i=this.props,o=i.data,u=i.dataKey,a=i.activeIndex,p=fr(this.props.background,!1);return o.map(function(g,v){g.value;var w=g.background,T=sAe(g,aAe);if(!w)return null;var A=Ji(Ji(Ji(Ji(Ji({},T),{},{fill:"#eee"},w),p),Gh(n.props,g,v)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:u,index:v,className:"recharts-bar-background-rectangle"});return Le.createElement(T$,Nk({key:"background-bar-".concat(v),option:n.props.background,isActive:v===a},A))})}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,u=o.data,a=o.xAxis,p=o.yAxis,g=o.layout,v=o.children,w=Ps(v,ty);if(!w)return null;var T=g==="vertical"?u[0].height/2:u[0].width/2,A=function(D,L){var O=Array.isArray(D.value)?D.value[1]:D.value;return{x:D.x,y:D.y,value:O,errorVal:ai(D,L)}},I={clipPath:n?"url(#clipPath-".concat(i,")"):null};return Le.createElement(Ur,I,w.map(function(P){return Le.cloneElement(P,{key:"error-bar-".concat(i,"-").concat(P.props.dataKey),data:u,xAxis:a,yAxis:p,layout:g,offset:T,dataPointFormatter:A})}))}},{key:"render",value:function(){var n=this.props,i=n.hide,o=n.data,u=n.className,a=n.xAxis,p=n.yAxis,g=n.left,v=n.top,w=n.width,T=n.height,A=n.isAnimationActive,I=n.background,P=n.id;if(i||!o||!o.length)return null;var D=this.state.isAnimationFinished,L=Fr("recharts-bar",u),O=a&&a.allowDataOverflow,$=p&&p.allowDataOverflow,G=O||$,B=_r(P)?this.id:P;return Le.createElement(Ur,{className:L},O||$?Le.createElement("defs",null,Le.createElement("clipPath",{id:"clipPath-".concat(B)},Le.createElement("rect",{x:O?g:g-w/2,y:$?v:v-T/2,width:O?w:w*2,height:$?T:T*2}))):null,Le.createElement(Ur,{className:"recharts-bar-rectangles",clipPath:G?"url(#clipPath-".concat(B,")"):null},I?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(G,B),(!A||D)&&sc.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:i.curData}:n.data!==i.curData?{curData:n.data}:null}}])}(Y.PureComponent);GW=ry;vh(ry,"displayName","Bar");vh(ry,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!dl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});vh(ry,"getComposedData",function(t){var e=t.props,r=t.item,n=t.barPosition,i=t.bandSize,o=t.xAxis,u=t.yAxis,a=t.xAxisTicks,p=t.yAxisTicks,g=t.stackedData,v=t.dataStartIndex,w=t.displayedData,T=t.offset,A=Zwe(n,r);if(!A)return null;var I=e.layout,P=r.type.defaultProps,D=P!==void 0?Ji(Ji({},P),r.props):r.props,L=D.dataKey,O=D.children,$=D.minPointSize,G=I==="horizontal"?u:o,B=g?G.scale.domain():null,J=r2e({numericAxis:G}),W=Ps(O,Hp),H=w.map(function(V,se){var K,ce,ne,re,oe,ae;g?K=Xwe(g[v+se],B):(K=ai(V,L),Array.isArray(K)||(K=[J,K]));var xe=iAe($,GW.defaultProps.minPointSize)(K[1],se);if(I==="horizontal"){var ye,Se=[u.scale(K[0]),u.scale(K[1])],be=Se[0],Ce=Se[1];ce=p8({axis:o,ticks:a,bandSize:i,offset:A.offset,entry:V,index:se}),ne=(ye=Ce??be)!==null&&ye!==void 0?ye:void 0,re=A.size;var $e=be-Ce;if(oe=Number.isNaN($e)?0:$e,ae={x:ce,y:u.y,width:re,height:u.height},Math.abs(xe)>0&&Math.abs(oe)<Math.abs(xe)){var Ye=Es(oe||xe)*(Math.abs(xe)-Math.abs(oe));ne-=Ye,oe+=Ye}}else{var jt=[o.scale(K[0]),o.scale(K[1])],Me=jt[0],St=jt[1];if(ce=Me,ne=p8({axis:u,ticks:p,bandSize:i,offset:A.offset,entry:V,index:se}),re=St-Me,oe=A.size,ae={x:o.x,y:ne,width:o.width,height:oe},Math.abs(xe)>0&&Math.abs(re)<Math.abs(xe)){var Ct=Es(re||xe)*(Math.abs(xe)-Math.abs(re));re+=Ct}}return Ji(Ji(Ji({},V),{},{x:ce,y:ne,width:re,height:oe,value:g?K:K[1],payload:V,background:ae},W&&W[se]&&W[se].props),{},{tooltipPayload:[gW(r,V)],tooltipPosition:{x:ce+re/2,y:ne+oe/2}})});return Ji({data:H,layout:I},T)});function C_(t){"@babel/helpers - typeof";return C_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C_(t)}function mAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KW(n.key),n)}}function gAe(t,e,r){return e&&j$(t.prototype,e),r&&j$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function A$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Xl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?A$(Object(r),!0).forEach(function(n){TS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):A$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function TS(t,e,r){return e=KW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KW(t){var e=yAe(t,"string");return C_(e)=="symbol"?e:e+""}function yAe(t,e){if(C_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(C_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var r3=function(e,r,n,i,o){var u=e.width,a=e.height,p=e.layout,g=e.children,v=Object.keys(r),w={left:n.left,leftMirror:n.left,right:u-n.right,rightMirror:u-n.right,top:n.top,topMirror:n.top,bottom:a-n.bottom,bottomMirror:a-n.bottom},T=!!wo(g,ry);return v.reduce(function(A,I){var P=r[I],D=P.orientation,L=P.domain,O=P.padding,$=O===void 0?{}:O,G=P.mirror,B=P.reversed,J="".concat(D).concat(G?"Mirror":""),W,H,V,se,K;if(P.type==="number"&&(P.padding==="gap"||P.padding==="no-gap")){var ce=L[1]-L[0],ne=1/0,re=P.categoricalDomain.sort(Ice);if(re.forEach(function(jt,Me){Me>0&&(ne=Math.min((jt||0)-(re[Me-1]||0),ne))}),Number.isFinite(ne)){var oe=ne/ce,ae=P.layout==="vertical"?n.height:n.width;if(P.padding==="gap"&&(W=oe*ae/2),P.padding==="no-gap"){var xe=js(e.barCategoryGap,oe*ae),ye=oe*ae/2;W=ye-xe-(ye-xe)/ae*xe}}}i==="xAxis"?H=[n.left+($.left||0)+(W||0),n.left+n.width-($.right||0)-(W||0)]:i==="yAxis"?H=p==="horizontal"?[n.top+n.height-($.bottom||0),n.top+($.top||0)]:[n.top+($.top||0)+(W||0),n.top+n.height-($.bottom||0)-(W||0)]:H=P.range,B&&(H=[H[1],H[0]]);var Se=hW(P,o,T),be=Se.scale,Ce=Se.realScaleType;be.domain(L).range(H),fW(be);var $e=pW(be,Xl(Xl({},P),{},{realScaleType:Ce}));i==="xAxis"?(K=D==="top"&&!G||D==="bottom"&&G,V=n.left,se=w[J]-K*P.height):i==="yAxis"&&(K=D==="left"&&!G||D==="right"&&G,V=w[J]-K*P.width,se=n.top);var Ye=Xl(Xl(Xl({},P),$e),{},{realScaleType:Ce,x:V,y:se,scale:be,width:i==="xAxis"?n.width:P.width,height:i==="yAxis"?n.height:P.height});return Ye.bandSize=fk(Ye,$e),!P.hide&&i==="xAxis"?w[J]+=(K?-1:1)*Ye.height:P.hide||(w[J]+=(K?-1:1)*Ye.width),Xl(Xl({},A),{},TS({},I,Ye))},{})},ZW=function(e,r){var n=e.x,i=e.y,o=r.x,u=r.y;return{x:Math.min(n,o),y:Math.min(i,u),width:Math.abs(o-n),height:Math.abs(u-i)}},xAe=function(e){var r=e.x1,n=e.y1,i=e.x2,o=e.y2;return ZW({x:r,y:n},{x:i,y:o})},XW=function(){function t(e){mAe(this,t),this.scale=e}return gAe(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.bandAware,o=n.position;if(r!==void 0){if(o)switch(o){case"start":return this.scale(r);case"middle":{var u=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+u}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(r)+a}default:return this.scale(r)}if(i){var p=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+p}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),i=n[0],o=n[n.length-1];return i<=o?r>=i&&r<=o:r>=o&&r<=i}}],[{key:"create",value:function(r){return new t(r)}}])}();TS(XW,"EPS",1e-4);var n3=function(e){var r=Object.keys(e).reduce(function(n,i){return Xl(Xl({},n),{},TS({},i,XW.create(e[i])))},{});return Xl(Xl({},r),{},{apply:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=o.bandAware,a=o.position;return zje(i,function(p,g){return r[g].apply(p,{bandAware:u,position:a})})},isInRange:function(i){return qW(i,function(o,u){return r[u].isInRange(o)})}})};function vAe(t){return(t%180+180)%180}var _Ae=function(e){var r=e.width,n=e.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=vAe(i),u=o*Math.PI/180,a=Math.atan(n/r),p=u>a&&u<Math.PI-a?n/Math.sin(u):r/Math.cos(u);return Math.abs(p)},bAe=hu,wAe=ub,kAe=iS;function TAe(t){return function(e,r,n){var i=Object(e);if(!wAe(e)){var o=bAe(r);e=kAe(e),r=function(a){return o(i[a],a,i)}}var u=t(e,r,n);return u>-1?i[o?e[u]:u]:void 0}}var SAe=TAe,EAe=FW;function jAe(t){var e=EAe(t),r=e%1;return e===e?r?e-r:e:0}var AAe=jAe,NAe=Uq,CAe=hu,PAe=AAe,IAe=Math.max;function MAe(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:PAe(r);return i<0&&(i=IAe(n+i,0)),NAe(t,CAe(e),i)}var DAe=MAe,OAe=SAe,RAe=DAe,LAe=OAe(RAe),zAe=LAe;const $Ae=Pn(zAe);var FAe=Ile(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),i3=Y.createContext(void 0),a3=Y.createContext(void 0),YW=Y.createContext(void 0),JW=Y.createContext({}),QW=Y.createContext(void 0),eH=Y.createContext(0),tH=Y.createContext(0),N$=function(e){var r=e.state,n=r.xAxisMap,i=r.yAxisMap,o=r.offset,u=e.clipPathId,a=e.children,p=e.width,g=e.height,v=FAe(o);return Le.createElement(i3.Provider,{value:n},Le.createElement(a3.Provider,{value:i},Le.createElement(JW.Provider,{value:o},Le.createElement(YW.Provider,{value:v},Le.createElement(QW.Provider,{value:u},Le.createElement(eH.Provider,{value:g},Le.createElement(tH.Provider,{value:p},a)))))))},BAe=function(){return Y.useContext(QW)},rH=function(e){var r=Y.useContext(i3);r==null&&Lp(!1);var n=r[e];return n==null&&Lp(!1),n},VAe=function(){var e=Y.useContext(i3);return mh(e)},UAe=function(){var e=Y.useContext(a3),r=$Ae(e,function(n){return qW(n.domain,Number.isFinite)});return r||mh(e)},nH=function(e){var r=Y.useContext(a3);r==null&&Lp(!1);var n=r[e];return n==null&&Lp(!1),n},qAe=function(){var e=Y.useContext(YW);return e},GAe=function(){return Y.useContext(JW)},s3=function(){return Y.useContext(tH)},o3=function(){return Y.useContext(eH)};function h0(t){"@babel/helpers - typeof";return h0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h0(t)}function WAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aH(n.key),n)}}function HAe(t,e,r){return e&&C$(t.prototype,e),r&&C$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function KAe(t,e,r){return e=Pk(e),ZAe(t,iH()?Reflect.construct(e,r||[],Pk(t).constructor):e.apply(t,r))}function ZAe(t,e){if(e&&(h0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XAe(t)}function XAe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iH=function(){return!!t})()}function Pk(t){return Pk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pk(t)}function YAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SP(t,e)}function SP(t,e){return SP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},SP(t,e)}function P$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function I$(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?P$(Object(r),!0).forEach(function(n){l3(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function l3(t,e,r){return e=aH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aH(t){var e=JAe(t,"string");return h0(e)=="symbol"?e:e+""}function JAe(t,e){if(h0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(h0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QAe(t,e){return nNe(t)||rNe(t,e)||tNe(t,e)||eNe()}function eNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tNe(t,e){if(t){if(typeof t=="string")return M$(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M$(t,e)}}function M$(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function rNe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function nNe(t){if(Array.isArray(t))return t}function EP(){return EP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},EP.apply(this,arguments)}var iNe=function(e,r){var n;return Le.isValidElement(e)?n=Le.cloneElement(e,r):Tr(e)?n=e(r):n=Le.createElement("line",EP({},r,{className:"recharts-reference-line-line"})),n},aNe=function(e,r,n,i,o,u,a,p,g){var v=o.x,w=o.y,T=o.width,A=o.height;if(n){var I=g.y,P=e.y.apply(I,{position:u});if(Zc(g,"discard")&&!e.y.isInRange(P))return null;var D=[{x:v+T,y:P},{x:v,y:P}];return p==="left"?D.reverse():D}if(r){var L=g.x,O=e.x.apply(L,{position:u});if(Zc(g,"discard")&&!e.x.isInRange(O))return null;var $=[{x:O,y:w+A},{x:O,y:w}];return a==="top"?$.reverse():$}if(i){var G=g.segment,B=G.map(function(J){return e.apply(J,{position:u})});return Zc(g,"discard")&&Cje(B,function(J){return!e.isInRange(J)})?null:B}return null};function sNe(t){var e=t.x,r=t.y,n=t.segment,i=t.xAxisId,o=t.yAxisId,u=t.shape,a=t.className,p=t.alwaysShow,g=BAe(),v=rH(i),w=nH(o),T=qAe();if(!g||!T)return null;ac(p===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var A=n3({x:v.scale,y:w.scale}),I=pa(e),P=pa(r),D=n&&n.length===2,L=aNe(A,I,P,D,T,t.position,v.orientation,w.orientation,t);if(!L)return null;var O=QAe(L,2),$=O[0],G=$.x,B=$.y,J=O[1],W=J.x,H=J.y,V=Zc(t,"hidden")?"url(#".concat(g,")"):void 0,se=I$(I$({clipPath:V},fr(t,!0)),{},{x1:G,y1:B,x2:W,y2:H});return Le.createElement(Ur,{className:Fr("recharts-reference-line",a)},iNe(u,se),Aa.renderCallByParent(t,xAe({x1:G,y1:B,x2:W,y2:H})))}var c3=function(t){function e(){return WAe(this,e),KAe(this,e,arguments)}return YAe(e,t),HAe(e,[{key:"render",value:function(){return Le.createElement(sNe,this.props)}}])}(Le.Component);l3(c3,"displayName","ReferenceLine");l3(c3,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function jP(){return jP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jP.apply(this,arguments)}function f0(t){"@babel/helpers - typeof";return f0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f0(t)}function D$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function O$(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?D$(Object(r),!0).forEach(function(n){SS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):D$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function oNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oH(n.key),n)}}function lNe(t,e,r){return e&&R$(t.prototype,e),r&&R$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cNe(t,e,r){return e=Ik(e),uNe(t,sH()?Reflect.construct(e,r||[],Ik(t).constructor):e.apply(t,r))}function uNe(t,e){if(e&&(f0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dNe(t)}function dNe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sH=function(){return!!t})()}function Ik(t){return Ik=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ik(t)}function hNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AP(t,e)}function AP(t,e){return AP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},AP(t,e)}function SS(t,e,r){return e=oH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oH(t){var e=fNe(t,"string");return f0(e)=="symbol"?e:e+""}function fNe(t,e){if(f0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(f0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var pNe=function(e){var r=e.x,n=e.y,i=e.xAxis,o=e.yAxis,u=n3({x:i.scale,y:o.scale}),a=u.apply({x:r,y:n},{bandAware:!0});return Zc(e,"discard")&&!u.isInRange(a)?null:a},ES=function(t){function e(){return oNe(this,e),cNe(this,e,arguments)}return hNe(e,t),lNe(e,[{key:"render",value:function(){var n=this.props,i=n.x,o=n.y,u=n.r,a=n.alwaysShow,p=n.clipPathId,g=pa(i),v=pa(o);if(ac(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!g||!v)return null;var w=pNe(this.props);if(!w)return null;var T=w.x,A=w.y,I=this.props,P=I.shape,D=I.className,L=Zc(this.props,"hidden")?"url(#".concat(p,")"):void 0,O=O$(O$({clipPath:L},fr(this.props,!0)),{},{cx:T,cy:A});return Le.createElement(Ur,{className:Fr("recharts-reference-dot",D)},e.renderDot(P,O),Aa.renderCallByParent(this.props,{x:T-u,y:A-u,width:2*u,height:2*u}))}}])}(Le.Component);SS(ES,"displayName","ReferenceDot");SS(ES,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});SS(ES,"renderDot",function(t,e){var r;return Le.isValidElement(t)?r=Le.cloneElement(t,e):Tr(t)?r=t(e):r=Le.createElement(mb,jP({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),r});function NP(){return NP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},NP.apply(this,arguments)}function p0(t){"@babel/helpers - typeof";return p0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p0(t)}function L$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function z$(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?L$(Object(r),!0).forEach(function(n){jS(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):L$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cH(n.key),n)}}function gNe(t,e,r){return e&&$$(t.prototype,e),r&&$$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yNe(t,e,r){return e=Mk(e),xNe(t,lH()?Reflect.construct(e,r||[],Mk(t).constructor):e.apply(t,r))}function xNe(t,e){if(e&&(p0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vNe(t)}function vNe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lH=function(){return!!t})()}function Mk(t){return Mk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Mk(t)}function _Ne(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CP(t,e)}function CP(t,e){return CP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},CP(t,e)}function jS(t,e,r){return e=cH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cH(t){var e=bNe(t,"string");return p0(e)=="symbol"?e:e+""}function bNe(t,e){if(p0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(p0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wNe=function(e,r,n,i,o){var u=o.x1,a=o.x2,p=o.y1,g=o.y2,v=o.xAxis,w=o.yAxis;if(!v||!w)return null;var T=n3({x:v.scale,y:w.scale}),A={x:e?T.x.apply(u,{position:"start"}):T.x.rangeMin,y:n?T.y.apply(p,{position:"start"}):T.y.rangeMin},I={x:r?T.x.apply(a,{position:"end"}):T.x.rangeMax,y:i?T.y.apply(g,{position:"end"}):T.y.rangeMax};return Zc(o,"discard")&&(!T.isInRange(A)||!T.isInRange(I))?null:ZW(A,I)},AS=function(t){function e(){return mNe(this,e),yNe(this,e,arguments)}return _Ne(e,t),gNe(e,[{key:"render",value:function(){var n=this.props,i=n.x1,o=n.x2,u=n.y1,a=n.y2,p=n.className,g=n.alwaysShow,v=n.clipPathId;ac(g===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var w=pa(i),T=pa(o),A=pa(u),I=pa(a),P=this.props.shape;if(!w&&!T&&!A&&!I&&!P)return null;var D=wNe(w,T,A,I,this.props);if(!D&&!P)return null;var L=Zc(this.props,"hidden")?"url(#".concat(v,")"):void 0;return Le.createElement(Ur,{className:Fr("recharts-reference-area",p)},e.renderRect(P,z$(z$({clipPath:L},fr(this.props,!0)),D)),Aa.renderCallByParent(this.props,D))}}])}(Le.Component);jS(AS,"displayName","ReferenceArea");jS(AS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});jS(AS,"renderRect",function(t,e){var r;return Le.isValidElement(t)?r=Le.cloneElement(t,e):Tr(t)?r=t(e):r=Le.createElement(t3,NP({},e,{className:"recharts-reference-area-rect"})),r});function uH(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],i=0;i<t.length;i+=e)if(r===void 0||r(t[i])===!0)n.push(t[i]);else return;return n}function kNe(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return _Ae(n,r)}function TNe(t,e,r){var n=r==="width",i=t.x,o=t.y,u=t.width,a=t.height;return e===1?{start:n?i:o,end:n?i+u:o+a}:{start:n?i+u:o+a,end:n?i:o}}function Dk(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var o=r();return t*(e-t*o/2-n)>=0&&t*(e+t*o/2-i)<=0}function SNe(t,e){return uH(t,e+1)}function ENe(t,e,r,n,i){for(var o=(n||[]).slice(),u=e.start,a=e.end,p=0,g=1,v=u,w=function(){var I=n==null?void 0:n[p];if(I===void 0)return{v:uH(n,g)};var P=p,D,L=function(){return D===void 0&&(D=r(I,P)),D},O=I.coordinate,$=p===0||Dk(t,O,L,v,a);$||(p=0,v=u,g+=1),$&&(v=O+t*(L()/2+i),p+=g)},T;g<=o.length;)if(T=w(),T)return T.v;return[]}function P_(t){"@babel/helpers - typeof";return P_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P_(t)}function F$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ns(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?F$(Object(r),!0).forEach(function(n){jNe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jNe(t,e,r){return e=ANe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ANe(t){var e=NNe(t,"string");return P_(e)=="symbol"?e:e+""}function NNe(t,e){if(P_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(P_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CNe(t,e,r,n,i){for(var o=(n||[]).slice(),u=o.length,a=e.start,p=e.end,g=function(T){var A=o[T],I,P=function(){return I===void 0&&(I=r(A,T)),I};if(T===u-1){var D=t*(A.coordinate+t*P()/2-p);o[T]=A=ns(ns({},A),{},{tickCoord:D>0?A.coordinate-D*t:A.coordinate})}else o[T]=A=ns(ns({},A),{},{tickCoord:A.coordinate});var L=Dk(t,A.tickCoord,P,a,p);L&&(p=A.tickCoord-t*(P()/2+i),o[T]=ns(ns({},A),{},{isShow:!0}))},v=u-1;v>=0;v--)g(v);return o}function PNe(t,e,r,n,i,o){var u=(n||[]).slice(),a=u.length,p=e.start,g=e.end;if(o){var v=n[a-1],w=r(v,a-1),T=t*(v.coordinate+t*w/2-g);u[a-1]=v=ns(ns({},v),{},{tickCoord:T>0?v.coordinate-T*t:v.coordinate});var A=Dk(t,v.tickCoord,function(){return w},p,g);A&&(g=v.tickCoord-t*(w/2+i),u[a-1]=ns(ns({},v),{},{isShow:!0}))}for(var I=o?a-1:a,P=function(O){var $=u[O],G,B=function(){return G===void 0&&(G=r($,O)),G};if(O===0){var J=t*($.coordinate-t*B()/2-p);u[O]=$=ns(ns({},$),{},{tickCoord:J<0?$.coordinate-J*t:$.coordinate})}else u[O]=$=ns(ns({},$),{},{tickCoord:$.coordinate});var W=Dk(t,$.tickCoord,B,p,g);W&&(p=$.tickCoord+t*(B()/2+i),u[O]=ns(ns({},$),{},{isShow:!0}))},D=0;D<I;D++)P(D);return u}function u3(t,e,r){var n=t.tick,i=t.ticks,o=t.viewBox,u=t.minTickGap,a=t.orientation,p=t.interval,g=t.tickFormatter,v=t.unit,w=t.angle;if(!i||!i.length||!n)return[];if(Bt(p)||dl.isSsr)return SNe(i,typeof p=="number"&&Bt(p)?p:0);var T=[],A=a==="top"||a==="bottom"?"width":"height",I=v&&A==="width"?gv(v,{fontSize:e,letterSpacing:r}):{width:0,height:0},P=function($,G){var B=Tr(g)?g($.value,G):$.value;return A==="width"?kNe(gv(B,{fontSize:e,letterSpacing:r}),I,w):gv(B,{fontSize:e,letterSpacing:r})[A]},D=i.length>=2?Es(i[1].coordinate-i[0].coordinate):1,L=TNe(o,D,A);return p==="equidistantPreserveStart"?ENe(D,L,P,i,u):(p==="preserveStart"||p==="preserveStartEnd"?T=PNe(D,L,P,i,u,p==="preserveStartEnd"):T=CNe(D,L,P,i,u),T.filter(function(O){return O.isShow}))}var INe=["viewBox"],MNe=["viewBox"],DNe=["ticks"];function m0(t){"@babel/helpers - typeof";return m0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m0(t)}function gg(){return gg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gg.apply(this,arguments)}function B$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ua(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?B$(Object(r),!0).forEach(function(n){d3(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):B$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function zA(t,e){if(t==null)return{};var r=ONe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ONe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function RNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hH(n.key),n)}}function LNe(t,e,r){return e&&V$(t.prototype,e),r&&V$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zNe(t,e,r){return e=Ok(e),$Ne(t,dH()?Reflect.construct(e,r||[],Ok(t).constructor):e.apply(t,r))}function $Ne(t,e){if(e&&(m0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FNe(t)}function FNe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dH=function(){return!!t})()}function Ok(t){return Ok=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ok(t)}function BNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&PP(t,e)}function PP(t,e){return PP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},PP(t,e)}function d3(t,e,r){return e=hH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hH(t){var e=VNe(t,"string");return m0(e)=="symbol"?e:e+""}function VNe(t,e){if(m0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(m0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ny=function(t){function e(r){var n;return RNe(this,e),n=zNe(this,e,[r]),n.state={fontSize:"",letterSpacing:""},n}return BNe(e,t),LNe(e,[{key:"shouldComponentUpdate",value:function(n,i){var o=n.viewBox,u=zA(n,INe),a=this.props,p=a.viewBox,g=zA(a,MNe);return!Ng(o,p)||!Ng(u,g)||!Ng(i,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var i=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var i=this.props,o=i.x,u=i.y,a=i.width,p=i.height,g=i.orientation,v=i.tickSize,w=i.mirror,T=i.tickMargin,A,I,P,D,L,O,$=w?-1:1,G=n.tickSize||v,B=Bt(n.tickCoord)?n.tickCoord:n.coordinate;switch(g){case"top":A=I=n.coordinate,D=u+ +!w*p,P=D-$*G,O=P-$*T,L=B;break;case"left":P=D=n.coordinate,I=o+ +!w*a,A=I-$*G,L=A-$*T,O=B;break;case"right":P=D=n.coordinate,I=o+ +w*a,A=I+$*G,L=A+$*T,O=B;break;default:A=I=n.coordinate,D=u+ +w*p,P=D+$*G,O=P+$*T,L=B;break}return{line:{x1:A,y1:P,x2:I,y2:D},tick:{x:L,y:O}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,i=n.orientation,o=n.mirror,u;switch(i){case"left":u=o?"start":"end";break;case"right":u=o?"end":"start";break;default:u="middle";break}return u}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,i=n.orientation,o=n.mirror,u="end";switch(i){case"left":case"right":u="middle";break;case"top":u=o?"start":"end";break;default:u=o?"end":"start";break}return u}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.x,o=n.y,u=n.width,a=n.height,p=n.orientation,g=n.mirror,v=n.axisLine,w=ua(ua(ua({},fr(this.props,!1)),fr(v,!1)),{},{fill:"none"});if(p==="top"||p==="bottom"){var T=+(p==="top"&&!g||p==="bottom"&&g);w=ua(ua({},w),{},{x1:i,y1:o+T*a,x2:i+u,y2:o+T*a})}else{var A=+(p==="left"&&!g||p==="right"&&g);w=ua(ua({},w),{},{x1:i+A*u,y1:o,x2:i+A*u,y2:o+a})}return Le.createElement("line",gg({},w,{className:Fr("recharts-cartesian-axis-line",jo(v,"className"))}))}},{key:"renderTicks",value:function(n,i,o){var u=this,a=this.props,p=a.tickLine,g=a.stroke,v=a.tick,w=a.tickFormatter,T=a.unit,A=u3(ua(ua({},this.props),{},{ticks:n}),i,o),I=this.getTickTextAnchor(),P=this.getTickVerticalAnchor(),D=fr(this.props,!1),L=fr(v,!1),O=ua(ua({},D),{},{fill:"none"},fr(p,!1)),$=A.map(function(G,B){var J=u.getTickLineCoord(G),W=J.line,H=J.tick,V=ua(ua(ua(ua({textAnchor:I,verticalAnchor:P},D),{},{stroke:"none",fill:g},L),H),{},{index:B,payload:G,visibleTicksCount:A.length,tickFormatter:w});return Le.createElement(Ur,gg({className:"recharts-cartesian-axis-tick",key:"tick-".concat(G.value,"-").concat(G.coordinate,"-").concat(G.tickCoord)},Gh(u.props,G,B)),p&&Le.createElement("line",gg({},O,W,{className:Fr("recharts-cartesian-axis-tick-line",jo(p,"className"))})),v&&e.renderTickItem(v,V,"".concat(Tr(w)?w(G.value,B):G.value).concat(T||"")))});return Le.createElement("g",{className:"recharts-cartesian-axis-ticks"},$)}},{key:"render",value:function(){var n=this,i=this.props,o=i.axisLine,u=i.width,a=i.height,p=i.ticksGenerator,g=i.className,v=i.hide;if(v)return null;var w=this.props,T=w.ticks,A=zA(w,DNe),I=T;return Tr(p)&&(I=T&&T.length>0?p(this.props):p(A)),u<=0||a<=0||!I||!I.length?null:Le.createElement(Ur,{className:Fr("recharts-cartesian-axis",g),ref:function(D){n.layerReference=D}},o&&this.renderAxisLine(),this.renderTicks(I,this.state.fontSize,this.state.letterSpacing),Aa.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,i,o){var u,a=Fr(i.className,"recharts-cartesian-axis-tick-value");return Le.isValidElement(n)?u=Le.cloneElement(n,ua(ua({},i),{},{className:a})):Tr(n)?u=n(ua(ua({},i),{},{className:a})):u=Le.createElement(Op,gg({},i,{className:"recharts-cartesian-axis-tick-value"}),o),u}}])}(Y.Component);d3(ny,"displayName","CartesianAxis");d3(ny,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var UNe=["x1","y1","x2","y2","key"],qNe=["offset"];function zp(t){"@babel/helpers - typeof";return zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zp(t)}function U$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function os(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?U$(Object(r),!0).forEach(function(n){GNe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):U$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function GNe(t,e,r){return e=WNe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WNe(t){var e=HNe(t,"string");return zp(e)=="symbol"?e:e+""}function HNe(t,e){if(zp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mp(){return mp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mp.apply(this,arguments)}function q$(t,e){if(t==null)return{};var r=KNe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function KNe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}var ZNe=function(e){var r=e.fill;if(!r||r==="none")return null;var n=e.fillOpacity,i=e.x,o=e.y,u=e.width,a=e.height,p=e.ry;return Le.createElement("rect",{x:i,y:o,ry:p,width:u,height:a,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function fH(t,e){var r;if(Le.isValidElement(t))r=Le.cloneElement(t,e);else if(Tr(t))r=t(e);else{var n=e.x1,i=e.y1,o=e.x2,u=e.y2,a=e.key,p=q$(e,UNe),g=fr(p,!1);g.offset;var v=q$(g,qNe);r=Le.createElement("line",mp({},v,{x1:n,y1:i,x2:o,y2:u,fill:"none",key:a}))}return r}function XNe(t){var e=t.x,r=t.width,n=t.horizontal,i=n===void 0?!0:n,o=t.horizontalPoints;if(!i||!o||!o.length)return null;var u=o.map(function(a,p){var g=os(os({},t),{},{x1:e,y1:a,x2:e+r,y2:a,key:"line-".concat(p),index:p});return fH(i,g)});return Le.createElement("g",{className:"recharts-cartesian-grid-horizontal"},u)}function YNe(t){var e=t.y,r=t.height,n=t.vertical,i=n===void 0?!0:n,o=t.verticalPoints;if(!i||!o||!o.length)return null;var u=o.map(function(a,p){var g=os(os({},t),{},{x1:a,y1:e,x2:a,y2:e+r,key:"line-".concat(p),index:p});return fH(i,g)});return Le.createElement("g",{className:"recharts-cartesian-grid-vertical"},u)}function JNe(t){var e=t.horizontalFill,r=t.fillOpacity,n=t.x,i=t.y,o=t.width,u=t.height,a=t.horizontalPoints,p=t.horizontal,g=p===void 0?!0:p;if(!g||!e||!e.length)return null;var v=a.map(function(T){return Math.round(T+i-i)}).sort(function(T,A){return T-A});i!==v[0]&&v.unshift(0);var w=v.map(function(T,A){var I=!v[A+1],P=I?i+u-T:v[A+1]-T;if(P<=0)return null;var D=A%e.length;return Le.createElement("rect",{key:"react-".concat(A),y:T,x:n,height:P,width:o,stroke:"none",fill:e[D],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Le.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},w)}function QNe(t){var e=t.vertical,r=e===void 0?!0:e,n=t.verticalFill,i=t.fillOpacity,o=t.x,u=t.y,a=t.width,p=t.height,g=t.verticalPoints;if(!r||!n||!n.length)return null;var v=g.map(function(T){return Math.round(T+o-o)}).sort(function(T,A){return T-A});o!==v[0]&&v.unshift(0);var w=v.map(function(T,A){var I=!v[A+1],P=I?o+a-T:v[A+1]-T;if(P<=0)return null;var D=A%n.length;return Le.createElement("rect",{key:"react-".concat(A),x:T,y:u,width:P,height:p,stroke:"none",fill:n[D],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return Le.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},w)}var eCe=function(e,r){var n=e.xAxis,i=e.width,o=e.height,u=e.offset;return dW(u3(os(os(os({},ny.defaultProps),n),{},{ticks:Zu(n,!0),viewBox:{x:0,y:0,width:i,height:o}})),u.left,u.left+u.width,r)},tCe=function(e,r){var n=e.yAxis,i=e.width,o=e.height,u=e.offset;return dW(u3(os(os(os({},ny.defaultProps),n),{},{ticks:Zu(n,!0),viewBox:{x:0,y:0,width:i,height:o}})),u.top,u.top+u.height,r)},Zm={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function gb(t){var e,r,n,i,o,u,a=s3(),p=o3(),g=GAe(),v=os(os({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:Zm.stroke,fill:(r=t.fill)!==null&&r!==void 0?r:Zm.fill,horizontal:(n=t.horizontal)!==null&&n!==void 0?n:Zm.horizontal,horizontalFill:(i=t.horizontalFill)!==null&&i!==void 0?i:Zm.horizontalFill,vertical:(o=t.vertical)!==null&&o!==void 0?o:Zm.vertical,verticalFill:(u=t.verticalFill)!==null&&u!==void 0?u:Zm.verticalFill,x:Bt(t.x)?t.x:g.left,y:Bt(t.y)?t.y:g.top,width:Bt(t.width)?t.width:g.width,height:Bt(t.height)?t.height:g.height}),w=v.x,T=v.y,A=v.width,I=v.height,P=v.syncWithTicks,D=v.horizontalValues,L=v.verticalValues,O=VAe(),$=UAe();if(!Bt(A)||A<=0||!Bt(I)||I<=0||!Bt(w)||w!==+w||!Bt(T)||T!==+T)return null;var G=v.verticalCoordinatesGenerator||eCe,B=v.horizontalCoordinatesGenerator||tCe,J=v.horizontalPoints,W=v.verticalPoints;if((!J||!J.length)&&Tr(B)){var H=D&&D.length,V=B({yAxis:$?os(os({},$),{},{ticks:H?D:$.ticks}):void 0,width:a,height:p,offset:g},H?!0:P);ac(Array.isArray(V),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(zp(V),"]")),Array.isArray(V)&&(J=V)}if((!W||!W.length)&&Tr(G)){var se=L&&L.length,K=G({xAxis:O?os(os({},O),{},{ticks:se?L:O.ticks}):void 0,width:a,height:p,offset:g},se?!0:P);ac(Array.isArray(K),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(zp(K),"]")),Array.isArray(K)&&(W=K)}return Le.createElement("g",{className:"recharts-cartesian-grid"},Le.createElement(ZNe,{fill:v.fill,fillOpacity:v.fillOpacity,x:v.x,y:v.y,width:v.width,height:v.height,ry:v.ry}),Le.createElement(XNe,mp({},v,{offset:g,horizontalPoints:J,xAxis:O,yAxis:$})),Le.createElement(YNe,mp({},v,{offset:g,verticalPoints:W,xAxis:O,yAxis:$})),Le.createElement(JNe,mp({},v,{horizontalPoints:J})),Le.createElement(QNe,mp({},v,{verticalPoints:W})))}gb.displayName="CartesianGrid";var rCe=["type","layout","connectNulls","ref"],nCe=["key"];function g0(t){"@babel/helpers - typeof";return g0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g0(t)}function G$(t,e){if(t==null)return{};var r=iCe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function iCe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function wv(){return wv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wv.apply(this,arguments)}function W$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function vo(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?W$(Object(r),!0).forEach(function(n){Yl(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Xm(t){return lCe(t)||oCe(t)||sCe(t)||aCe()}function aCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sCe(t,e){if(t){if(typeof t=="string")return IP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IP(t,e)}}function oCe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lCe(t){if(Array.isArray(t))return IP(t)}function IP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function cCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mH(n.key),n)}}function uCe(t,e,r){return e&&H$(t.prototype,e),r&&H$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dCe(t,e,r){return e=Rk(e),hCe(t,pH()?Reflect.construct(e,r||[],Rk(t).constructor):e.apply(t,r))}function hCe(t,e){if(e&&(g0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fCe(t)}function fCe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pH=function(){return!!t})()}function Rk(t){return Rk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rk(t)}function pCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&MP(t,e)}function MP(t,e){return MP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},MP(t,e)}function Yl(t,e,r){return e=mH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mH(t){var e=mCe(t,"string");return g0(e)=="symbol"?e:e+""}function mCe(t,e){if(g0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(g0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hh=function(t){function e(){var r;cCe(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=dCe(this,e,[].concat(i)),Yl(r,"state",{isAnimationFinished:!0,totalLength:0}),Yl(r,"generateSimpleStrokeDasharray",function(u,a){return"".concat(a,"px ").concat(u-a,"px")}),Yl(r,"getStrokeDasharray",function(u,a,p){var g=p.reduce(function(L,O){return L+O});if(!g)return r.generateSimpleStrokeDasharray(a,u);for(var v=Math.floor(u/g),w=u%g,T=a-u,A=[],I=0,P=0;I<p.length;P+=p[I],++I)if(P+p[I]>w){A=[].concat(Xm(p.slice(0,I)),[w-P]);break}var D=A.length%2===0?[0,T]:[T];return[].concat(Xm(e.repeat(p,v)),Xm(A),D).map(function(L){return"".concat(L,"px")}).join(", ")}),Yl(r,"id",uf("recharts-line-")),Yl(r,"pathRef",function(u){r.mainCurve=u}),Yl(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Yl(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return pCe(e,t),uCe(e,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,u=o.points,a=o.xAxis,p=o.yAxis,g=o.layout,v=o.children,w=Ps(v,ty);if(!w)return null;var T=function(P,D){return{x:P.x,y:P.y,value:P.value,errorVal:ai(P.payload,D)}},A={clipPath:n?"url(#clipPath-".concat(i,")"):null};return Le.createElement(Ur,A,w.map(function(I){return Le.cloneElement(I,{key:"bar-".concat(I.props.dataKey),data:u,xAxis:a,yAxis:p,layout:g,dataPointFormatter:T})}))}},{key:"renderDots",value:function(n,i,o){var u=this.props.isAnimationActive;if(u&&!this.state.isAnimationFinished)return null;var a=this.props,p=a.dot,g=a.points,v=a.dataKey,w=fr(this.props,!1),T=fr(p,!0),A=g.map(function(P,D){var L=vo(vo(vo({key:"dot-".concat(D),r:3},w),T),{},{index:D,cx:P.x,cy:P.y,value:P.value,dataKey:v,payload:P.payload,points:g});return e.renderDotItem(p,L)}),I={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return Le.createElement(Ur,wv({className:"recharts-line-dots",key:"dots"},I),A)}},{key:"renderCurveStatically",value:function(n,i,o,u){var a=this.props,p=a.type,g=a.layout,v=a.connectNulls;a.ref;var w=G$(a,rCe),T=vo(vo(vo({},fr(w,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(o,")"):null,points:n},u),{},{type:p,layout:g,connectNulls:v});return Le.createElement(Oh,wv({},T,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,i){var o=this,u=this.props,a=u.points,p=u.strokeDasharray,g=u.isAnimationActive,v=u.animationBegin,w=u.animationDuration,T=u.animationEasing,A=u.animationId,I=u.animateNewValues,P=u.width,D=u.height,L=this.state,O=L.prevPoints,$=L.totalLength;return Le.createElement(hd,{begin:v,duration:w,isActive:g,easing:T,from:{t:0},to:{t:1},key:"line-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(G){var B=G.t;if(O){var J=O.length/a.length,W=a.map(function(ce,ne){var re=Math.floor(ne*J);if(O[re]){var oe=O[re],ae=Ei(oe.x,ce.x),xe=Ei(oe.y,ce.y);return vo(vo({},ce),{},{x:ae(B),y:xe(B)})}if(I){var ye=Ei(P*2,ce.x),Se=Ei(D/2,ce.y);return vo(vo({},ce),{},{x:ye(B),y:Se(B)})}return vo(vo({},ce),{},{x:ce.x,y:ce.y})});return o.renderCurveStatically(W,n,i)}var H=Ei(0,$),V=H(B),se;if(p){var K="".concat(p).split(/[,\s]+/gim).map(function(ce){return parseFloat(ce)});se=o.getStrokeDasharray(V,$,K)}else se=o.generateSimpleStrokeDasharray($,V);return o.renderCurveStatically(a,n,i,{strokeDasharray:se})})}},{key:"renderCurve",value:function(n,i){var o=this.props,u=o.points,a=o.isAnimationActive,p=this.state,g=p.prevPoints,v=p.totalLength;return a&&u&&u.length&&(!g&&v>0||!Wh(g,u))?this.renderCurveWithAnimation(n,i):this.renderCurveStatically(u,n,i)}},{key:"render",value:function(){var n,i=this.props,o=i.hide,u=i.dot,a=i.points,p=i.className,g=i.xAxis,v=i.yAxis,w=i.top,T=i.left,A=i.width,I=i.height,P=i.isAnimationActive,D=i.id;if(o||!a||!a.length)return null;var L=this.state.isAnimationFinished,O=a.length===1,$=Fr("recharts-line",p),G=g&&g.allowDataOverflow,B=v&&v.allowDataOverflow,J=G||B,W=_r(D)?this.id:D,H=(n=fr(u,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},V=H.r,se=V===void 0?3:V,K=H.strokeWidth,ce=K===void 0?2:K,ne=eq(u)?u:{},re=ne.clipDot,oe=re===void 0?!0:re,ae=se*2+ce;return Le.createElement(Ur,{className:$},G||B?Le.createElement("defs",null,Le.createElement("clipPath",{id:"clipPath-".concat(W)},Le.createElement("rect",{x:G?T:T-A/2,y:B?w:w-I/2,width:G?A:A*2,height:B?I:I*2})),!oe&&Le.createElement("clipPath",{id:"clipPath-dots-".concat(W)},Le.createElement("rect",{x:T-ae/2,y:w-ae/2,width:A+ae,height:I+ae}))):null,!O&&this.renderCurve(J,W),this.renderErrorBar(J,W),(O||u)&&this.renderDots(J,oe,W),(!P||L)&&sc.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:i.curPoints}:n.points!==i.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,i){for(var o=n.length%2!==0?[].concat(Xm(n),[0]):n,u=[],a=0;a<i;++a)u=[].concat(Xm(u),Xm(o));return u}},{key:"renderDotItem",value:function(n,i){var o;if(Le.isValidElement(n))o=Le.cloneElement(n,i);else if(Tr(n))o=n(i);else{var u=i.key,a=G$(i,nCe),p=Fr("recharts-line-dot",typeof n!="boolean"?n.className:"");o=Le.createElement(mb,wv({key:u},a,{className:p}))}return o}}])}(Y.PureComponent);Yl(Hh,"displayName","Line");Yl(Hh,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!dl.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Yl(Hh,"getComposedData",function(t){var e=t.props,r=t.xAxis,n=t.yAxis,i=t.xAxisTicks,o=t.yAxisTicks,u=t.dataKey,a=t.bandSize,p=t.displayedData,g=t.offset,v=e.layout,w=p.map(function(T,A){var I=ai(T,u);return v==="horizontal"?{x:i0({axis:r,ticks:i,bandSize:a,entry:T,index:A}),y:_r(I)?null:n.scale(I),value:I,payload:T}:{x:_r(I)?null:r.scale(I),y:i0({axis:n,ticks:o,bandSize:a,entry:T,index:A}),value:I,payload:T}});return vo({points:w,layout:v},g)});var gCe=["layout","type","stroke","connectNulls","isRange","ref"],yCe=["key"],gH;function y0(t){"@babel/helpers - typeof";return y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y0(t)}function yH(t,e){if(t==null)return{};var r=xCe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function xCe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function gp(){return gp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gp.apply(this,arguments)}function K$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function oh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?K$(Object(r),!0).forEach(function(n){Vc(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):K$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vH(n.key),n)}}function _Ce(t,e,r){return e&&Z$(t.prototype,e),r&&Z$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function bCe(t,e,r){return e=Lk(e),wCe(t,xH()?Reflect.construct(e,r||[],Lk(t).constructor):e.apply(t,r))}function wCe(t,e){if(e&&(y0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kCe(t)}function kCe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xH=function(){return!!t})()}function Lk(t){return Lk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lk(t)}function TCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DP(t,e)}function DP(t,e){return DP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},DP(t,e)}function Vc(t,e,r){return e=vH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vH(t){var e=SCe(t,"string");return y0(e)=="symbol"?e:e+""}function SCe(t,e){if(y0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(y0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cs=function(t){function e(){var r;vCe(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=bCe(this,e,[].concat(i)),Vc(r,"state",{isAnimationFinished:!0}),Vc(r,"id",uf("recharts-area-")),Vc(r,"handleAnimationEnd",function(){var u=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Tr(u)&&u()}),Vc(r,"handleAnimationStart",function(){var u=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Tr(u)&&u()}),r}return TCe(e,t),_Ce(e,[{key:"renderDots",value:function(n,i,o){var u=this.props.isAnimationActive,a=this.state.isAnimationFinished;if(u&&!a)return null;var p=this.props,g=p.dot,v=p.points,w=p.dataKey,T=fr(this.props,!1),A=fr(g,!0),I=v.map(function(D,L){var O=oh(oh(oh({key:"dot-".concat(L),r:3},T),A),{},{index:L,cx:D.x,cy:D.y,dataKey:w,value:D.value,payload:D.payload,points:v});return e.renderDotItem(g,O)}),P={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return Le.createElement(Ur,gp({className:"recharts-area-dots"},P),I)}},{key:"renderHorizontalRect",value:function(n){var i=this.props,o=i.baseLine,u=i.points,a=i.strokeWidth,p=u[0].x,g=u[u.length-1].x,v=n*Math.abs(p-g),w=xh(u.map(function(T){return T.y||0}));return Bt(o)&&typeof o=="number"?w=Math.max(o,w):o&&Array.isArray(o)&&o.length&&(w=Math.max(xh(o.map(function(T){return T.y||0})),w)),Bt(w)?Le.createElement("rect",{x:p<g?p:p-v,y:0,width:v,height:Math.floor(w+(a?parseInt("".concat(a),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var i=this.props,o=i.baseLine,u=i.points,a=i.strokeWidth,p=u[0].y,g=u[u.length-1].y,v=n*Math.abs(p-g),w=xh(u.map(function(T){return T.x||0}));return Bt(o)&&typeof o=="number"?w=Math.max(o,w):o&&Array.isArray(o)&&o.length&&(w=Math.max(xh(o.map(function(T){return T.x||0})),w)),Bt(w)?Le.createElement("rect",{x:0,y:p<g?p:p-v,width:w+(a?parseInt("".concat(a),10):1),height:Math.floor(v)}):null}},{key:"renderClipRect",value:function(n){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,i,o,u){var a=this.props,p=a.layout,g=a.type,v=a.stroke,w=a.connectNulls,T=a.isRange;a.ref;var A=yH(a,gCe);return Le.createElement(Ur,{clipPath:o?"url(#clipPath-".concat(u,")"):null},Le.createElement(Oh,gp({},fr(A,!0),{points:n,connectNulls:w,type:g,baseLine:i,layout:p,stroke:"none",className:"recharts-area-area"})),v!=="none"&&Le.createElement(Oh,gp({},fr(this.props,!1),{className:"recharts-area-curve",layout:p,type:g,connectNulls:w,fill:"none",points:n})),v!=="none"&&T&&Le.createElement(Oh,gp({},fr(this.props,!1),{className:"recharts-area-curve",layout:p,type:g,connectNulls:w,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(n,i){var o=this,u=this.props,a=u.points,p=u.baseLine,g=u.isAnimationActive,v=u.animationBegin,w=u.animationDuration,T=u.animationEasing,A=u.animationId,I=this.state,P=I.prevPoints,D=I.prevBaseLine;return Le.createElement(hd,{begin:v,duration:w,isActive:g,easing:T,from:{t:0},to:{t:1},key:"area-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(L){var O=L.t;if(P){var $=P.length/a.length,G=a.map(function(H,V){var se=Math.floor(V*$);if(P[se]){var K=P[se],ce=Ei(K.x,H.x),ne=Ei(K.y,H.y);return oh(oh({},H),{},{x:ce(O),y:ne(O)})}return H}),B;if(Bt(p)&&typeof p=="number"){var J=Ei(D,p);B=J(O)}else if(_r(p)||K0(p)){var W=Ei(D,0);B=W(O)}else B=p.map(function(H,V){var se=Math.floor(V*$);if(D[se]){var K=D[se],ce=Ei(K.x,H.x),ne=Ei(K.y,H.y);return oh(oh({},H),{},{x:ce(O),y:ne(O)})}return H});return o.renderAreaStatically(G,B,n,i)}return Le.createElement(Ur,null,Le.createElement("defs",null,Le.createElement("clipPath",{id:"animationClipPath-".concat(i)},o.renderClipRect(O))),Le.createElement(Ur,{clipPath:"url(#animationClipPath-".concat(i,")")},o.renderAreaStatically(a,p,n,i)))})}},{key:"renderArea",value:function(n,i){var o=this.props,u=o.points,a=o.baseLine,p=o.isAnimationActive,g=this.state,v=g.prevPoints,w=g.prevBaseLine,T=g.totalLength;return p&&u&&u.length&&(!v&&T>0||!Wh(v,u)||!Wh(w,a))?this.renderAreaWithAnimation(n,i):this.renderAreaStatically(u,a,n,i)}},{key:"render",value:function(){var n,i=this.props,o=i.hide,u=i.dot,a=i.points,p=i.className,g=i.top,v=i.left,w=i.xAxis,T=i.yAxis,A=i.width,I=i.height,P=i.isAnimationActive,D=i.id;if(o||!a||!a.length)return null;var L=this.state.isAnimationFinished,O=a.length===1,$=Fr("recharts-area",p),G=w&&w.allowDataOverflow,B=T&&T.allowDataOverflow,J=G||B,W=_r(D)?this.id:D,H=(n=fr(u,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},V=H.r,se=V===void 0?3:V,K=H.strokeWidth,ce=K===void 0?2:K,ne=eq(u)?u:{},re=ne.clipDot,oe=re===void 0?!0:re,ae=se*2+ce;return Le.createElement(Ur,{className:$},G||B?Le.createElement("defs",null,Le.createElement("clipPath",{id:"clipPath-".concat(W)},Le.createElement("rect",{x:G?v:v-A/2,y:B?g:g-I/2,width:G?A:A*2,height:B?I:I*2})),!oe&&Le.createElement("clipPath",{id:"clipPath-dots-".concat(W)},Le.createElement("rect",{x:v-ae/2,y:g-ae/2,width:A+ae,height:I+ae}))):null,O?null:this.renderArea(J,W),(u||O)&&this.renderDots(J,oe,W),(!P||L)&&sc.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:n.points!==i.curPoints||n.baseLine!==i.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(Y.PureComponent);gH=cs;Vc(cs,"displayName","Area");Vc(cs,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!dl.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Vc(cs,"getBaseValue",function(t,e,r,n){var i=t.layout,o=t.baseValue,u=e.props.baseValue,a=u??o;if(Bt(a)&&typeof a=="number")return a;var p=i==="horizontal"?n:r,g=p.scale.domain();if(p.type==="number"){var v=Math.max(g[0],g[1]),w=Math.min(g[0],g[1]);return a==="dataMin"?w:a==="dataMax"||v<0?v:Math.max(Math.min(g[0],g[1]),0)}return a==="dataMin"?g[0]:a==="dataMax"?g[1]:g[0]});Vc(cs,"getComposedData",function(t){var e=t.props,r=t.item,n=t.xAxis,i=t.yAxis,o=t.xAxisTicks,u=t.yAxisTicks,a=t.bandSize,p=t.dataKey,g=t.stackedData,v=t.dataStartIndex,w=t.displayedData,T=t.offset,A=e.layout,I=g&&g.length,P=gH.getBaseValue(e,r,n,i),D=A==="horizontal",L=!1,O=w.map(function(G,B){var J;I?J=g[v+B]:(J=ai(G,p),Array.isArray(J)?L=!0:J=[P,J]);var W=J[1]==null||I&&ai(G,p)==null;return D?{x:i0({axis:n,ticks:o,bandSize:a,entry:G,index:B}),y:W?null:i.scale(J[1]),value:J,payload:G}:{x:W?null:n.scale(J[1]),y:i0({axis:i,ticks:u,bandSize:a,entry:G,index:B}),value:J,payload:G}}),$;return I||L?$=O.map(function(G){var B=Array.isArray(G.value)?G.value[0]:null;return D?{x:G.x,y:B!=null&&G.y!=null?i.scale(B):null}:{x:B!=null?n.scale(B):null,y:G.y}}):$=D?i.scale(P):n.scale(P),oh({points:O,baseLine:$,layout:A,isRange:L},T)});Vc(cs,"renderDotItem",function(t,e){var r;if(Le.isValidElement(t))r=Le.cloneElement(t,e);else if(Tr(t))r=t(e);else{var n=Fr("recharts-area-dot",typeof t!="boolean"?t.className:""),i=e.key,o=yH(e,yCe);r=Le.createElement(mb,gp({},o,{key:i,className:n}))}return r});function x0(t){"@babel/helpers - typeof";return x0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x0(t)}function ECe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function X$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wH(n.key),n)}}function jCe(t,e,r){return e&&X$(t.prototype,e),r&&X$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ACe(t,e,r){return e=zk(e),NCe(t,_H()?Reflect.construct(e,r||[],zk(t).constructor):e.apply(t,r))}function NCe(t,e){if(e&&(x0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CCe(t)}function CCe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _H(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_H=function(){return!!t})()}function zk(t){return zk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zk(t)}function PCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OP(t,e)}function OP(t,e){return OP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},OP(t,e)}function bH(t,e,r){return e=wH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wH(t){var e=ICe(t,"string");return x0(e)=="symbol"?e:e+""}function ICe(t,e){if(x0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(x0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var NS=function(t){function e(){return ECe(this,e),ACe(this,e,arguments)}return PCe(e,t),jCe(e,[{key:"render",value:function(){return null}}])}(Y.Component);bH(NS,"displayName","ZAxis");bH(NS,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var MCe=["option","isActive"];function kv(){return kv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},kv.apply(this,arguments)}function DCe(t,e){if(t==null)return{};var r=OCe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function OCe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function RCe(t){var e=t.option,r=t.isActive,n=DCe(t,MCe);return typeof e=="string"?Y.createElement(Tk,kv({option:Y.createElement(nS,kv({type:e},n)),isActive:r,shapeType:"symbols"},n)):Y.createElement(Tk,kv({option:e,isActive:r,shapeType:"symbols"},n))}function v0(t){"@babel/helpers - typeof";return v0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v0(t)}function Tv(){return Tv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Tv.apply(this,arguments)}function Y$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function tl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Y$(Object(r),!0).forEach(function(n){_h(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Y$(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,TH(n.key),n)}}function zCe(t,e,r){return e&&J$(t.prototype,e),r&&J$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $Ce(t,e,r){return e=$k(e),FCe(t,kH()?Reflect.construct(e,r||[],$k(t).constructor):e.apply(t,r))}function FCe(t,e){if(e&&(v0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BCe(t)}function BCe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kH=function(){return!!t})()}function $k(t){return $k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$k(t)}function VCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&RP(t,e)}function RP(t,e){return RP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},RP(t,e)}function _h(t,e,r){return e=TH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TH(t){var e=UCe(t,"string");return v0(e)=="symbol"?e:e+""}function UCe(t,e){if(v0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(v0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var CS=function(t){function e(){var r;LCe(this,e);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=$Ce(this,e,[].concat(i)),_h(r,"state",{isAnimationFinished:!1}),_h(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),_h(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),_h(r,"id",uf("recharts-scatter-")),r}return VCe(e,t),zCe(e,[{key:"renderSymbolsStatically",value:function(n){var i=this,o=this.props,u=o.shape,a=o.activeShape,p=o.activeIndex,g=fr(this.props,!1);return n.map(function(v,w){var T=p===w,A=T?a:u,I=tl(tl({},g),v);return Le.createElement(Ur,Tv({className:"recharts-scatter-symbol",key:"symbol-".concat(v==null?void 0:v.cx,"-").concat(v==null?void 0:v.cy,"-").concat(v==null?void 0:v.size,"-").concat(w)},Gh(i.props,v,w),{role:"img"}),Le.createElement(RCe,Tv({option:A,isActive:T,key:"symbol-".concat(w)},I)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,i=this.props,o=i.points,u=i.isAnimationActive,a=i.animationBegin,p=i.animationDuration,g=i.animationEasing,v=i.animationId,w=this.state.prevPoints;return Le.createElement(hd,{begin:a,duration:p,isActive:u,easing:g,from:{t:0},to:{t:1},key:"pie-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(T){var A=T.t,I=o.map(function(P,D){var L=w&&w[D];if(L){var O=Ei(L.cx,P.cx),$=Ei(L.cy,P.cy),G=Ei(L.size,P.size);return tl(tl({},P),{},{cx:O(A),cy:$(A),size:G(A)})}var B=Ei(0,P.size);return tl(tl({},P),{},{size:B(A)})});return Le.createElement(Ur,null,n.renderSymbolsStatically(I))})}},{key:"renderSymbols",value:function(){var n=this.props,i=n.points,o=n.isAnimationActive,u=this.state.prevPoints;return o&&i&&i.length&&(!u||!Wh(u,i))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(i)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,u=i.xAxis,a=i.yAxis,p=i.children,g=Ps(p,ty);return g?g.map(function(v,w){var T=v.props,A=T.direction,I=T.dataKey;return Le.cloneElement(v,{key:"".concat(A,"-").concat(I,"-").concat(o[w]),data:o,xAxis:u,yAxis:a,layout:A==="x"?"vertical":"horizontal",dataPointFormatter:function(D,L){return{x:D.cx,y:D.cy,value:A==="x"?+D.node.x:+D.node.y,errorVal:ai(D,L)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,i=n.points,o=n.line,u=n.lineType,a=n.lineJointType,p=fr(this.props,!1),g=fr(o,!1),v,w;if(u==="joint")v=i.map(function($){return{x:$.cx,y:$.cy}});else if(u==="fitting"){var T=Pce(i),A=T.xmin,I=T.xmax,P=T.a,D=T.b,L=function(G){return P*G+D};v=[{x:A,y:L(A)},{x:I,y:L(I)}]}var O=tl(tl(tl({},p),{},{fill:"none",stroke:p&&p.fill},g),{},{points:v});return Le.isValidElement(o)?w=Le.cloneElement(o,O):Tr(o)?w=o(O):w=Le.createElement(Oh,Tv({},O,{type:a})),Le.createElement(Ur,{className:"recharts-scatter-line",key:"recharts-scatter-line"},w)}},{key:"render",value:function(){var n=this.props,i=n.hide,o=n.points,u=n.line,a=n.className,p=n.xAxis,g=n.yAxis,v=n.left,w=n.top,T=n.width,A=n.height,I=n.id,P=n.isAnimationActive;if(i||!o||!o.length)return null;var D=this.state.isAnimationFinished,L=Fr("recharts-scatter",a),O=p&&p.allowDataOverflow,$=g&&g.allowDataOverflow,G=O||$,B=_r(I)?this.id:I;return Le.createElement(Ur,{className:L,clipPath:G?"url(#clipPath-".concat(B,")"):null},O||$?Le.createElement("defs",null,Le.createElement("clipPath",{id:"clipPath-".concat(B)},Le.createElement("rect",{x:O?v:v-T/2,y:$?w:w-A/2,width:O?T:T*2,height:$?A:A*2}))):null,u&&this.renderLine(),this.renderErrorBar(),Le.createElement(Ur,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!P||D)&&sc.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:i.curPoints}:n.points!==i.curPoints?{curPoints:n.points}:null}}])}(Y.PureComponent);_h(CS,"displayName","Scatter");_h(CS,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!dl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});_h(CS,"getComposedData",function(t){var e=t.xAxis,r=t.yAxis,n=t.zAxis,i=t.item,o=t.displayedData,u=t.xAxisTicks,a=t.yAxisTicks,p=t.offset,g=i.props.tooltipType,v=Ps(i.props.children,Hp),w=_r(e.dataKey)?i.props.dataKey:e.dataKey,T=_r(r.dataKey)?i.props.dataKey:r.dataKey,A=n&&n.dataKey,I=n?n.range:NS.defaultProps.range,P=I&&I[0],D=e.scale.bandwidth?e.scale.bandwidth():0,L=r.scale.bandwidth?r.scale.bandwidth():0,O=o.map(function($,G){var B=ai($,w),J=ai($,T),W=!_r(A)&&ai($,A)||"-",H=[{name:_r(e.dataKey)?i.props.name:e.name||e.dataKey,unit:e.unit||"",value:B,payload:$,dataKey:w,type:g},{name:_r(r.dataKey)?i.props.name:r.name||r.dataKey,unit:r.unit||"",value:J,payload:$,dataKey:T,type:g}];W!=="-"&&H.push({name:n.name||n.dataKey,unit:n.unit||"",value:W,payload:$,dataKey:A,type:g});var V=i0({axis:e,ticks:u,bandSize:D,entry:$,index:G,dataKey:w}),se=i0({axis:r,ticks:a,bandSize:L,entry:$,index:G,dataKey:T}),K=W!=="-"?n.scale(W):P,ce=Math.sqrt(Math.max(K,0)/Math.PI);return tl(tl({},$),{},{cx:V,cy:se,x:V-ce,y:se-ce,xAxis:e,yAxis:r,zAxis:n,width:2*ce,height:2*ce,size:K,node:{x:B,y:J,z:W},tooltipPayload:H,tooltipPosition:{x:V,y:se},payload:$},v&&v[G]&&v[G].props)});return tl({points:O},p)});function _0(t){"@babel/helpers - typeof";return _0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_0(t)}function qCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jH(n.key),n)}}function GCe(t,e,r){return e&&Q$(t.prototype,e),r&&Q$(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function WCe(t,e,r){return e=Fk(e),HCe(t,SH()?Reflect.construct(e,r||[],Fk(t).constructor):e.apply(t,r))}function HCe(t,e){if(e&&(_0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KCe(t)}function KCe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function SH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SH=function(){return!!t})()}function Fk(t){return Fk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Fk(t)}function ZCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LP(t,e)}function LP(t,e){return LP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},LP(t,e)}function EH(t,e,r){return e=jH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jH(t){var e=XCe(t,"string");return _0(e)=="symbol"?e:e+""}function XCe(t,e){if(_0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zP(){return zP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zP.apply(this,arguments)}function YCe(t){var e=t.xAxisId,r=s3(),n=o3(),i=rH(e);return i==null?null:Y.createElement(ny,zP({},i,{className:Fr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(u){return Zu(u,!0)}}))}var Td=function(t){function e(){return qCe(this,e),WCe(this,e,arguments)}return ZCe(e,t),GCe(e,[{key:"render",value:function(){return Y.createElement(YCe,this.props)}}])}(Y.Component);EH(Td,"displayName","XAxis");EH(Td,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function b0(t){"@babel/helpers - typeof";return b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b0(t)}function JCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,CH(n.key),n)}}function QCe(t,e,r){return e&&eF(t.prototype,e),r&&eF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ePe(t,e,r){return e=Bk(e),tPe(t,AH()?Reflect.construct(e,r||[],Bk(t).constructor):e.apply(t,r))}function tPe(t,e){if(e&&(b0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rPe(t)}function rPe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function AH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(AH=function(){return!!t})()}function Bk(t){return Bk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bk(t)}function nPe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$P(t,e)}function $P(t,e){return $P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},$P(t,e)}function NH(t,e,r){return e=CH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CH(t){var e=iPe(t,"string");return b0(e)=="symbol"?e:e+""}function iPe(t,e){if(b0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(b0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FP(){return FP=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},FP.apply(this,arguments)}var aPe=function(e){var r=e.yAxisId,n=s3(),i=o3(),o=nH(r);return o==null?null:Y.createElement(ny,FP({},o,{className:Fr("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(a){return Zu(a,!0)}}))},ou=function(t){function e(){return JCe(this,e),ePe(this,e,arguments)}return nPe(e,t),QCe(e,[{key:"render",value:function(){return Y.createElement(aPe,this.props)}}])}(Y.Component);NH(ou,"displayName","YAxis");NH(ou,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function tF(t){return cPe(t)||lPe(t)||oPe(t)||sPe()}function sPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oPe(t,e){if(t){if(typeof t=="string")return BP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BP(t,e)}}function lPe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cPe(t){if(Array.isArray(t))return BP(t)}function BP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var VP=function(e,r,n,i,o){var u=Ps(e,c3),a=Ps(e,ES),p=[].concat(tF(u),tF(a)),g=Ps(e,AS),v="".concat(i,"Id"),w=i[0],T=r;if(p.length&&(T=p.reduce(function(P,D){if(D.props[v]===n&&Zc(D.props,"extendDomain")&&Bt(D.props[w])){var L=D.props[w];return[Math.min(P[0],L),Math.max(P[1],L)]}return P},T)),g.length){var A="".concat(w,"1"),I="".concat(w,"2");T=g.reduce(function(P,D){if(D.props[v]===n&&Zc(D.props,"extendDomain")&&Bt(D.props[A])&&Bt(D.props[I])){var L=D.props[A],O=D.props[I];return[Math.min(P[0],L,O),Math.max(P[1],L,O)]}return P},T)}return o&&o.length&&(T=o.reduce(function(P,D){return Bt(D)?[Math.min(P[0],D),Math.max(P[1],D)]:P},T)),T},PH={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(p,g,v){this.fn=p,this.context=g,this.once=v||!1}function o(p,g,v,w,T){if(typeof v!="function")throw new TypeError("The listener must be a function");var A=new i(v,w||p,T),I=r?r+g:g;return p._events[I]?p._events[I].fn?p._events[I]=[p._events[I],A]:p._events[I].push(A):(p._events[I]=A,p._eventsCount++),p}function u(p,g){--p._eventsCount===0?p._events=new n:delete p._events[g]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var g=[],v,w;if(this._eventsCount===0)return g;for(w in v=this._events)e.call(v,w)&&g.push(r?w.slice(1):w);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(v)):g},a.prototype.listeners=function(g){var v=r?r+g:g,w=this._events[v];if(!w)return[];if(w.fn)return[w.fn];for(var T=0,A=w.length,I=new Array(A);T<A;T++)I[T]=w[T].fn;return I},a.prototype.listenerCount=function(g){var v=r?r+g:g,w=this._events[v];return w?w.fn?1:w.length:0},a.prototype.emit=function(g,v,w,T,A,I){var P=r?r+g:g;if(!this._events[P])return!1;var D=this._events[P],L=arguments.length,O,$;if(D.fn){switch(D.once&&this.removeListener(g,D.fn,void 0,!0),L){case 1:return D.fn.call(D.context),!0;case 2:return D.fn.call(D.context,v),!0;case 3:return D.fn.call(D.context,v,w),!0;case 4:return D.fn.call(D.context,v,w,T),!0;case 5:return D.fn.call(D.context,v,w,T,A),!0;case 6:return D.fn.call(D.context,v,w,T,A,I),!0}for($=1,O=new Array(L-1);$<L;$++)O[$-1]=arguments[$];D.fn.apply(D.context,O)}else{var G=D.length,B;for($=0;$<G;$++)switch(D[$].once&&this.removeListener(g,D[$].fn,void 0,!0),L){case 1:D[$].fn.call(D[$].context);break;case 2:D[$].fn.call(D[$].context,v);break;case 3:D[$].fn.call(D[$].context,v,w);break;case 4:D[$].fn.call(D[$].context,v,w,T);break;default:if(!O)for(B=1,O=new Array(L-1);B<L;B++)O[B-1]=arguments[B];D[$].fn.apply(D[$].context,O)}}return!0},a.prototype.on=function(g,v,w){return o(this,g,v,w,!1)},a.prototype.once=function(g,v,w){return o(this,g,v,w,!0)},a.prototype.removeListener=function(g,v,w,T){var A=r?r+g:g;if(!this._events[A])return this;if(!v)return u(this,A),this;var I=this._events[A];if(I.fn)I.fn===v&&(!T||I.once)&&(!w||I.context===w)&&u(this,A);else{for(var P=0,D=[],L=I.length;P<L;P++)(I[P].fn!==v||T&&!I[P].once||w&&I[P].context!==w)&&D.push(I[P]);D.length?this._events[A]=D.length===1?D[0]:D:u(this,A)}return this},a.prototype.removeAllListeners=function(g){var v;return g?(v=r?r+g:g,this._events[v]&&u(this,v)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(PH);var uPe=PH.exports;const dPe=Pn(uPe);var $A=new dPe,FA="recharts.syncMouseEvents";function I_(t){"@babel/helpers - typeof";return I_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I_(t)}function hPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,IH(n.key),n)}}function fPe(t,e,r){return e&&rF(t.prototype,e),r&&rF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BA(t,e,r){return e=IH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IH(t){var e=pPe(t,"string");return I_(e)=="symbol"?e:e+""}function pPe(t,e){if(I_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(I_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mPe=function(){function t(){hPe(this,t),BA(this,"activeIndex",0),BA(this,"coordinateList",[]),BA(this,"layout","horizontal")}return fPe(t,[{key:"setDetails",value:function(r){var n,i=r.coordinateList,o=i===void 0?null:i,u=r.container,a=u===void 0?null:u,p=r.layout,g=p===void 0?null:p,v=r.offset,w=v===void 0?null:v,T=r.mouseHandlerCallback,A=T===void 0?null:T;this.coordinateList=(n=o??this.coordinateList)!==null&&n!==void 0?n:[],this.container=a??this.container,this.layout=g??this.layout,this.offset=w??this.offset,this.mouseHandlerCallback=A??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),o=i.x,u=i.y,a=i.height,p=this.coordinateList[this.activeIndex].coordinate,g=((r=window)===null||r===void 0?void 0:r.scrollX)||0,v=((n=window)===null||n===void 0?void 0:n.scrollY)||0,w=o+p+g,T=u+this.offset.top+a/2+v;this.mouseHandlerCallback({pageX:w,pageY:T})}}}])}();function gPe(t,e,r){if(r==="number"&&e===!0&&Array.isArray(t)){var n=t==null?void 0:t[0],i=t==null?void 0:t[1];if(n&&i&&Bt(n)&&Bt(i))return!0}return!1}function yPe(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function MH(t){var e=t.cx,r=t.cy,n=t.radius,i=t.startAngle,o=t.endAngle,u=Xn(e,r,n,i),a=Xn(e,r,n,o);return{points:[u,a],cx:e,cy:r,radius:n,startAngle:i,endAngle:o}}function xPe(t,e,r){var n,i,o,u;if(t==="horizontal")n=e.x,o=n,i=r.top,u=r.top+r.height;else if(t==="vertical")i=e.y,u=i,n=r.left,o=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var a=e.cx,p=e.cy,g=e.innerRadius,v=e.outerRadius,w=e.angle,T=Xn(a,p,g,w),A=Xn(a,p,v,w);n=T.x,i=T.y,o=A.x,u=A.y}else return MH(e);return[{x:n,y:i},{x:o,y:u}]}function M_(t){"@babel/helpers - typeof";return M_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M_(t)}function nF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function bw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nF(Object(r),!0).forEach(function(n){vPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vPe(t,e,r){return e=_Pe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Pe(t){var e=bPe(t,"string");return M_(e)=="symbol"?e:e+""}function bPe(t,e){if(M_(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(M_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wPe(t){var e,r,n=t.element,i=t.tooltipEventType,o=t.isActive,u=t.activeCoordinate,a=t.activePayload,p=t.offset,g=t.activeTooltipIndex,v=t.tooltipAxisBandSize,w=t.layout,T=t.chartName,A=(e=n.props.cursor)!==null&&e!==void 0?e:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!A||!o||!u||T!=="ScatterChart"&&i!=="axis")return null;var I,P=Oh;if(T==="ScatterChart")I=u,P=xSe;else if(T==="BarChart")I=yPe(w,u,p,v),P=t3;else if(w==="radial"){var D=MH(u),L=D.cx,O=D.cy,$=D.radius,G=D.startAngle,B=D.endAngle;I={cx:L,cy:O,startAngle:G,endAngle:B,innerRadius:$,outerRadius:$},P=wW}else I={points:xPe(w,u,p)},P=Oh;var J=bw(bw(bw(bw({stroke:"#ccc",pointerEvents:"none"},p),I),fr(A,!1)),{},{payload:a,payloadIndex:g,className:Fr("recharts-tooltip-cursor",A.className)});return Y.isValidElement(A)?Y.cloneElement(A,J):Y.createElement(P,J)}var kPe=["item"],TPe=["children","className","width","height","style","compact","title","desc"];function w0(t){"@babel/helpers - typeof";return w0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w0(t)}function yg(){return yg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yg.apply(this,arguments)}function iF(t,e){return jPe(t)||EPe(t,e)||OH(t,e)||SPe()}function SPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EPe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,o,u,a=[],p=!0,g=!1;try{if(o=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;p=!1}else for(;!(p=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);p=!0);}catch(v){g=!0,i=v}finally{try{if(!p&&r.return!=null&&(u=r.return(),Object(u)!==u))return}finally{if(g)throw i}}return a}}function jPe(t){if(Array.isArray(t))return t}function aF(t,e){if(t==null)return{};var r=APe(t,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function APe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function NPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sF(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,RH(n.key),n)}}function CPe(t,e,r){return e&&sF(t.prototype,e),r&&sF(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function PPe(t,e,r){return e=Vk(e),IPe(t,DH()?Reflect.construct(e,r||[],Vk(t).constructor):e.apply(t,r))}function IPe(t,e){if(e&&(w0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MPe(t)}function MPe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function DH(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DH=function(){return!!t})()}function Vk(t){return Vk=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vk(t)}function DPe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&UP(t,e)}function UP(t,e){return UP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UP(t,e)}function k0(t){return LPe(t)||RPe(t)||OH(t)||OPe()}function OPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OH(t,e){if(t){if(typeof t=="string")return qP(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qP(t,e)}}function RPe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LPe(t){if(Array.isArray(t))return qP(t)}function qP(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function oF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function bt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oF(Object(r),!0).forEach(function(n){Ar(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ar(t,e,r){return e=RH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RH(t){var e=zPe(t,"string");return w0(e)=="symbol"?e:e+""}function zPe(t,e){if(w0(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(w0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $Pe={xAxis:["bottom","top"],yAxis:["left","right"]},FPe={width:"100%",height:"100%"},LH={x:0,y:0};function ww(t){return t}var BPe=function(e,r){return r==="horizontal"?e.x:r==="vertical"?e.y:r==="centric"?e.angle:e.radius},VPe=function(e,r,n,i){var o=r.find(function(v){return v&&v.index===n});if(o){if(e==="horizontal")return{x:o.coordinate,y:i.y};if(e==="vertical")return{x:i.x,y:o.coordinate};if(e==="centric"){var u=o.coordinate,a=i.radius;return bt(bt(bt({},i),Xn(i.cx,i.cy,a,u)),{},{angle:u,radius:a})}var p=o.coordinate,g=i.angle;return bt(bt(bt({},i),Xn(i.cx,i.cy,p,g)),{},{angle:g,radius:p})}return LH},PS=function(e,r){var n=r.graphicalItems,i=r.dataStartIndex,o=r.dataEndIndex,u=(n??[]).reduce(function(a,p){var g=p.props.data;return g&&g.length?[].concat(k0(a),k0(g)):a},[]);return u.length>0?u:e&&e.length&&Bt(i)&&Bt(o)?e.slice(i,o+1):[]};function zH(t){return t==="number"?[0,"auto"]:void 0}var GP=function(e,r,n,i){var o=e.graphicalItems,u=e.tooltipAxis,a=PS(r,e);return n<0||!o||!o.length||n>=a.length?null:o.reduce(function(p,g){var v,w=(v=g.props.data)!==null&&v!==void 0?v:r;w&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=n&&(w=w.slice(e.dataStartIndex,e.dataEndIndex+1));var T;if(u.dataKey&&!u.allowDuplicatedCategory){var A=w===void 0?a:w;T=F2(A,u.dataKey,i)}else T=w&&w[n]||a[n];return T?[].concat(k0(p),[gW(g,T)]):p},[])},lF=function(e,r,n,i){var o=i||{x:e.chartX,y:e.chartY},u=BPe(o,n),a=e.orderedTooltipTicks,p=e.tooltipAxis,g=e.tooltipTicks,v=Uwe(u,a,g,p);if(v>=0&&g){var w=g[v]&&g[v].value,T=GP(e,r,v,w),A=VPe(n,a,v,o);return{activeTooltipIndex:v,activeLabel:w,activePayload:T,activeCoordinate:A}}return null},UPe=function(e,r){var n=r.axes,i=r.graphicalItems,o=r.axisType,u=r.axisIdKey,a=r.stackGroups,p=r.dataStartIndex,g=r.dataEndIndex,v=e.layout,w=e.children,T=e.stackOffset,A=uW(v,o);return n.reduce(function(I,P){var D,L=P.type.defaultProps!==void 0?bt(bt({},P.type.defaultProps),P.props):P.props,O=L.type,$=L.dataKey,G=L.allowDataOverflow,B=L.allowDuplicatedCategory,J=L.scale,W=L.ticks,H=L.includeHidden,V=L[u];if(I[V])return I;var se=PS(e.data,{graphicalItems:i.filter(function($e){var Ye,jt=u in $e.props?$e.props[u]:(Ye=$e.type.defaultProps)===null||Ye===void 0?void 0:Ye[u];return jt===V}),dataStartIndex:p,dataEndIndex:g}),K=se.length,ce,ne,re;gPe(L.domain,G,O)&&(ce=rP(L.domain,null,G),A&&(O==="number"||J!=="auto")&&(re=xv(se,$,"category")));var oe=zH(O);if(!ce||ce.length===0){var ae,xe=(ae=L.domain)!==null&&ae!==void 0?ae:oe;if($){if(ce=xv(se,$,O),O==="category"&&A){var ye=Cce(ce);B&&ye?(ne=ce,ce=Ek(0,K)):B||(ce=y8(xe,ce,P).reduce(function($e,Ye){return $e.indexOf(Ye)>=0?$e:[].concat(k0($e),[Ye])},[]))}else if(O==="category")B?ce=ce.filter(function($e){return $e!==""&&!_r($e)}):ce=y8(xe,ce,P).reduce(function($e,Ye){return $e.indexOf(Ye)>=0||Ye===""||_r(Ye)?$e:[].concat(k0($e),[Ye])},[]);else if(O==="number"){var Se=Kwe(se,i.filter(function($e){var Ye,jt,Me=u in $e.props?$e.props[u]:(Ye=$e.type.defaultProps)===null||Ye===void 0?void 0:Ye[u],St="hide"in $e.props?$e.props.hide:(jt=$e.type.defaultProps)===null||jt===void 0?void 0:jt.hide;return Me===V&&(H||!St)}),$,o,v);Se&&(ce=Se)}A&&(O==="number"||J!=="auto")&&(re=xv(se,$,"category"))}else A?ce=Ek(0,K):a&&a[V]&&a[V].hasStack&&O==="number"?ce=T==="expand"?[0,1]:mW(a[V].stackGroups,p,g):ce=cW(se,i.filter(function($e){var Ye=u in $e.props?$e.props[u]:$e.type.defaultProps[u],jt="hide"in $e.props?$e.props.hide:$e.type.defaultProps.hide;return Ye===V&&(H||!jt)}),O,v,!0);if(O==="number")ce=VP(w,ce,V,o,W),xe&&(ce=rP(xe,ce,G));else if(O==="category"&&xe){var be=xe,Ce=ce.every(function($e){return be.indexOf($e)>=0});Ce&&(ce=be)}}return bt(bt({},I),{},Ar({},V,bt(bt({},L),{},{axisType:o,domain:ce,categoricalDomain:re,duplicateDomain:ne,originalDomain:(D=L.domain)!==null&&D!==void 0?D:oe,isCategorical:A,layout:v})))},{})},qPe=function(e,r){var n=r.graphicalItems,i=r.Axis,o=r.axisType,u=r.axisIdKey,a=r.stackGroups,p=r.dataStartIndex,g=r.dataEndIndex,v=e.layout,w=e.children,T=PS(e.data,{graphicalItems:n,dataStartIndex:p,dataEndIndex:g}),A=T.length,I=uW(v,o),P=-1;return n.reduce(function(D,L){var O=L.type.defaultProps!==void 0?bt(bt({},L.type.defaultProps),L.props):L.props,$=O[u],G=zH("number");if(!D[$]){P++;var B;return I?B=Ek(0,A):a&&a[$]&&a[$].hasStack?(B=mW(a[$].stackGroups,p,g),B=VP(w,B,$,o)):(B=rP(G,cW(T,n.filter(function(J){var W,H,V=u in J.props?J.props[u]:(W=J.type.defaultProps)===null||W===void 0?void 0:W[u],se="hide"in J.props?J.props.hide:(H=J.type.defaultProps)===null||H===void 0?void 0:H.hide;return V===$&&!se}),"number",v),i.defaultProps.allowDataOverflow),B=VP(w,B,$,o)),bt(bt({},D),{},Ar({},$,bt(bt({axisType:o},i.defaultProps),{},{hide:!0,orientation:jo($Pe,"".concat(o,".").concat(P%2),null),domain:B,originalDomain:G,isCategorical:I,layout:v})))}return D},{})},GPe=function(e,r){var n=r.axisType,i=n===void 0?"xAxis":n,o=r.AxisComp,u=r.graphicalItems,a=r.stackGroups,p=r.dataStartIndex,g=r.dataEndIndex,v=e.children,w="".concat(i,"Id"),T=Ps(v,o),A={};return T&&T.length?A=UPe(e,{axes:T,graphicalItems:u,axisType:i,axisIdKey:w,stackGroups:a,dataStartIndex:p,dataEndIndex:g}):u&&u.length&&(A=qPe(e,{Axis:o,graphicalItems:u,axisType:i,axisIdKey:w,stackGroups:a,dataStartIndex:p,dataEndIndex:g})),A},WPe=function(e){var r=mh(e),n=Zu(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:EM(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:fk(r,n)}},cF=function(e){var r=e.children,n=e.defaultShowTooltip,i=wo(r,u0),o=0,u=0;return e.data&&e.data.length!==0&&(u=e.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(o=i.props.startIndex),i.props.endIndex>=0&&(u=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:o,dataEndIndex:u,activeTooltipIndex:-1,isTooltipActive:!!n}},HPe=function(e){return!e||!e.length?!1:e.some(function(r){var n=Qu(r&&r.type);return n&&n.indexOf("Bar")>=0})},uF=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},KPe=function(e,r){var n=e.props,i=e.graphicalItems,o=e.xAxisMap,u=o===void 0?{}:o,a=e.yAxisMap,p=a===void 0?{}:a,g=n.width,v=n.height,w=n.children,T=n.margin||{},A=wo(w,u0),I=wo(w,Hc),P=Object.keys(p).reduce(function(B,J){var W=p[J],H=W.orientation;return!W.mirror&&!W.hide?bt(bt({},B),{},Ar({},H,B[H]+W.width)):B},{left:T.left||0,right:T.right||0}),D=Object.keys(u).reduce(function(B,J){var W=u[J],H=W.orientation;return!W.mirror&&!W.hide?bt(bt({},B),{},Ar({},H,jo(B,"".concat(H))+W.height)):B},{top:T.top||0,bottom:T.bottom||0}),L=bt(bt({},D),P),O=L.bottom;A&&(L.bottom+=A.props.height||u0.defaultProps.height),I&&r&&(L=Wwe(L,i,n,r));var $=g-L.left-L.right,G=v-L.top-L.bottom;return bt(bt({brushBottom:O},L),{},{width:Math.max($,0),height:Math.max(G,0)})},ZPe=function(e,r){if(r==="xAxis")return e[r].width;if(r==="yAxis")return e[r].height},IS=function(e){var r=e.chartName,n=e.GraphicalChild,i=e.defaultTooltipEventType,o=i===void 0?"axis":i,u=e.validateTooltipEventTypes,a=u===void 0?["axis"]:u,p=e.axisComponents,g=e.legendContent,v=e.formatAxisMap,w=e.defaultProps,T=function(L,O){var $=O.graphicalItems,G=O.stackGroups,B=O.offset,J=O.updateId,W=O.dataStartIndex,H=O.dataEndIndex,V=L.barSize,se=L.layout,K=L.barGap,ce=L.barCategoryGap,ne=L.maxBarSize,re=uF(se),oe=re.numericAxisName,ae=re.cateAxisName,xe=HPe($),ye=[];return $.forEach(function(Se,be){var Ce=PS(L.data,{graphicalItems:[Se],dataStartIndex:W,dataEndIndex:H}),$e=Se.type.defaultProps!==void 0?bt(bt({},Se.type.defaultProps),Se.props):Se.props,Ye=$e.dataKey,jt=$e.maxBarSize,Me=$e["".concat(oe,"Id")],St=$e["".concat(ae,"Id")],Ct={},Ft=p.reduce(function(ht,Jt){var tr=O["".concat(Jt.axisType,"Map")],zr=$e["".concat(Jt.axisType,"Id")];tr&&tr[zr]||Jt.axisType==="zAxis"||Lp(!1);var yr=tr[zr];return bt(bt({},ht),{},Ar(Ar({},Jt.axisType,yr),"".concat(Jt.axisType,"Ticks"),Zu(yr)))},Ct),gt=Ft[ae],Zt=Ft["".concat(ae,"Ticks")],Tt=G&&G[Me]&&G[Me].hasStack&&n2e(Se,G[Me].stackGroups),ot=Qu(Se.type).indexOf("Bar")>=0,ar=fk(gt,Zt),mt=[],Lt=xe&&qwe({barSize:V,stackGroups:G,totalSize:ZPe(Ft,ae)});if(ot){var dr,Gr,qr=_r(jt)?ne:jt,ln=(dr=(Gr=fk(gt,Zt,!0))!==null&&Gr!==void 0?Gr:qr)!==null&&dr!==void 0?dr:0;mt=Gwe({barGap:K,barCategoryGap:ce,bandSize:ln!==ar?ln:ar,sizeList:Lt[St],maxBarSize:qr}),ln!==ar&&(mt=mt.map(function(ht){return bt(bt({},ht),{},{position:bt(bt({},ht.position),{},{offset:ht.position.offset-ln/2})})}))}var Ui=Se&&Se.type&&Se.type.getComposedData;Ui&&ye.push({props:bt(bt({},Ui(bt(bt({},Ft),{},{displayedData:Ce,props:L,dataKey:Ye,item:Se,bandSize:ar,barPosition:mt,offset:B,stackedData:Tt,layout:se,dataStartIndex:W,dataEndIndex:H}))),{},Ar(Ar(Ar({key:Se.key||"item-".concat(be)},oe,Ft[oe]),ae,Ft[ae]),"animationId",J)),childIndex:Uce(Se,L.children),item:Se})}),ye},A=function(L,O){var $=L.props,G=L.dataStartIndex,B=L.dataEndIndex,J=L.updateId;if(!oL({props:$}))return null;var W=$.children,H=$.layout,V=$.stackOffset,se=$.data,K=$.reverseStackOrder,ce=uF(H),ne=ce.numericAxisName,re=ce.cateAxisName,oe=Ps(W,n),ae=t2e(se,oe,"".concat(ne,"Id"),"".concat(re,"Id"),V,K),xe=p.reduce(function($e,Ye){var jt="".concat(Ye.axisType,"Map");return bt(bt({},$e),{},Ar({},jt,GPe($,bt(bt({},Ye),{},{graphicalItems:oe,stackGroups:Ye.axisType===ne&&ae,dataStartIndex:G,dataEndIndex:B}))))},{}),ye=KPe(bt(bt({},xe),{},{props:$,graphicalItems:oe}),O==null?void 0:O.legendBBox);Object.keys(xe).forEach(function($e){xe[$e]=v($,xe[$e],ye,$e.replace("Map",""),r)});var Se=xe["".concat(re,"Map")],be=WPe(Se),Ce=T($,bt(bt({},xe),{},{dataStartIndex:G,dataEndIndex:B,updateId:J,graphicalItems:oe,stackGroups:ae,offset:ye}));return bt(bt({formattedGraphicalItems:Ce,graphicalItems:oe,offset:ye,stackGroups:ae},be),xe)},I=function(D){function L(O){var $,G,B;return NPe(this,L),B=PPe(this,L,[O]),Ar(B,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Ar(B,"accessibilityManager",new mPe),Ar(B,"handleLegendBBoxUpdate",function(J){if(J){var W=B.state,H=W.dataStartIndex,V=W.dataEndIndex,se=W.updateId;B.setState(bt({legendBBox:J},A({props:B.props,dataStartIndex:H,dataEndIndex:V,updateId:se},bt(bt({},B.state),{},{legendBBox:J}))))}}),Ar(B,"handleReceiveSyncEvent",function(J,W,H){if(B.props.syncId===J){if(H===B.eventEmitterSymbol&&typeof B.props.syncMethod!="function")return;B.applySyncEvent(W)}}),Ar(B,"handleBrushChange",function(J){var W=J.startIndex,H=J.endIndex;if(W!==B.state.dataStartIndex||H!==B.state.dataEndIndex){var V=B.state.updateId;B.setState(function(){return bt({dataStartIndex:W,dataEndIndex:H},A({props:B.props,dataStartIndex:W,dataEndIndex:H,updateId:V},B.state))}),B.triggerSyncEvent({dataStartIndex:W,dataEndIndex:H})}}),Ar(B,"handleMouseEnter",function(J){var W=B.getMouseInfo(J);if(W){var H=bt(bt({},W),{},{isTooltipActive:!0});B.setState(H),B.triggerSyncEvent(H);var V=B.props.onMouseEnter;Tr(V)&&V(H,J)}}),Ar(B,"triggeredAfterMouseMove",function(J){var W=B.getMouseInfo(J),H=W?bt(bt({},W),{},{isTooltipActive:!0}):{isTooltipActive:!1};B.setState(H),B.triggerSyncEvent(H);var V=B.props.onMouseMove;Tr(V)&&V(H,J)}),Ar(B,"handleItemMouseEnter",function(J){B.setState(function(){return{isTooltipActive:!0,activeItem:J,activePayload:J.tooltipPayload,activeCoordinate:J.tooltipPosition||{x:J.cx,y:J.cy}}})}),Ar(B,"handleItemMouseLeave",function(){B.setState(function(){return{isTooltipActive:!1}})}),Ar(B,"handleMouseMove",function(J){J.persist(),B.throttleTriggeredAfterMouseMove(J)}),Ar(B,"handleMouseLeave",function(J){B.throttleTriggeredAfterMouseMove.cancel();var W={isTooltipActive:!1};B.setState(W),B.triggerSyncEvent(W);var H=B.props.onMouseLeave;Tr(H)&&H(W,J)}),Ar(B,"handleOuterEvent",function(J){var W=Vce(J),H=jo(B.props,"".concat(W));if(W&&Tr(H)){var V,se;/.*touch.*/i.test(W)?se=B.getMouseInfo(J.changedTouches[0]):se=B.getMouseInfo(J),H((V=se)!==null&&V!==void 0?V:{},J)}}),Ar(B,"handleClick",function(J){var W=B.getMouseInfo(J);if(W){var H=bt(bt({},W),{},{isTooltipActive:!0});B.setState(H),B.triggerSyncEvent(H);var V=B.props.onClick;Tr(V)&&V(H,J)}}),Ar(B,"handleMouseDown",function(J){var W=B.props.onMouseDown;if(Tr(W)){var H=B.getMouseInfo(J);W(H,J)}}),Ar(B,"handleMouseUp",function(J){var W=B.props.onMouseUp;if(Tr(W)){var H=B.getMouseInfo(J);W(H,J)}}),Ar(B,"handleTouchMove",function(J){J.changedTouches!=null&&J.changedTouches.length>0&&B.throttleTriggeredAfterMouseMove(J.changedTouches[0])}),Ar(B,"handleTouchStart",function(J){J.changedTouches!=null&&J.changedTouches.length>0&&B.handleMouseDown(J.changedTouches[0])}),Ar(B,"handleTouchEnd",function(J){J.changedTouches!=null&&J.changedTouches.length>0&&B.handleMouseUp(J.changedTouches[0])}),Ar(B,"handleDoubleClick",function(J){var W=B.props.onDoubleClick;if(Tr(W)){var H=B.getMouseInfo(J);W(H,J)}}),Ar(B,"handleContextMenu",function(J){var W=B.props.onContextMenu;if(Tr(W)){var H=B.getMouseInfo(J);W(H,J)}}),Ar(B,"triggerSyncEvent",function(J){B.props.syncId!==void 0&&$A.emit(FA,B.props.syncId,J,B.eventEmitterSymbol)}),Ar(B,"applySyncEvent",function(J){var W=B.props,H=W.layout,V=W.syncMethod,se=B.state.updateId,K=J.dataStartIndex,ce=J.dataEndIndex;if(J.dataStartIndex!==void 0||J.dataEndIndex!==void 0)B.setState(bt({dataStartIndex:K,dataEndIndex:ce},A({props:B.props,dataStartIndex:K,dataEndIndex:ce,updateId:se},B.state)));else if(J.activeTooltipIndex!==void 0){var ne=J.chartX,re=J.chartY,oe=J.activeTooltipIndex,ae=B.state,xe=ae.offset,ye=ae.tooltipTicks;if(!xe)return;if(typeof V=="function")oe=V(ye,J);else if(V==="value"){oe=-1;for(var Se=0;Se<ye.length;Se++)if(ye[Se].value===J.activeLabel){oe=Se;break}}var be=bt(bt({},xe),{},{x:xe.left,y:xe.top}),Ce=Math.min(ne,be.x+be.width),$e=Math.min(re,be.y+be.height),Ye=ye[oe]&&ye[oe].value,jt=GP(B.state,B.props.data,oe),Me=ye[oe]?{x:H==="horizontal"?ye[oe].coordinate:Ce,y:H==="horizontal"?$e:ye[oe].coordinate}:LH;B.setState(bt(bt({},J),{},{activeLabel:Ye,activeCoordinate:Me,activePayload:jt,activeTooltipIndex:oe}))}else B.setState(J)}),Ar(B,"renderCursor",function(J){var W,H=B.state,V=H.isTooltipActive,se=H.activeCoordinate,K=H.activePayload,ce=H.offset,ne=H.activeTooltipIndex,re=H.tooltipAxisBandSize,oe=B.getTooltipEventType(),ae=(W=J.props.active)!==null&&W!==void 0?W:V,xe=B.props.layout,ye=J.key||"_recharts-cursor";return Le.createElement(wPe,{key:ye,activeCoordinate:se,activePayload:K,activeTooltipIndex:ne,chartName:r,element:J,isActive:ae,layout:xe,offset:ce,tooltipAxisBandSize:re,tooltipEventType:oe})}),Ar(B,"renderPolarAxis",function(J,W,H){var V=jo(J,"type.axisType"),se=jo(B.state,"".concat(V,"Map")),K=J.type.defaultProps,ce=K!==void 0?bt(bt({},K),J.props):J.props,ne=se&&se[ce["".concat(V,"Id")]];return Y.cloneElement(J,bt(bt({},ne),{},{className:Fr(V,ne.className),key:J.key||"".concat(W,"-").concat(H),ticks:Zu(ne,!0)}))}),Ar(B,"renderPolarGrid",function(J){var W=J.props,H=W.radialLines,V=W.polarAngles,se=W.polarRadius,K=B.state,ce=K.radiusAxisMap,ne=K.angleAxisMap,re=mh(ce),oe=mh(ne),ae=oe.cx,xe=oe.cy,ye=oe.innerRadius,Se=oe.outerRadius;return Y.cloneElement(J,{polarAngles:Array.isArray(V)?V:Zu(oe,!0).map(function(be){return be.coordinate}),polarRadius:Array.isArray(se)?se:Zu(re,!0).map(function(be){return be.coordinate}),cx:ae,cy:xe,innerRadius:ye,outerRadius:Se,key:J.key||"polar-grid",radialLines:H})}),Ar(B,"renderLegend",function(){var J=B.state.formattedGraphicalItems,W=B.props,H=W.children,V=W.width,se=W.height,K=B.props.margin||{},ce=V-(K.left||0)-(K.right||0),ne=oW({children:H,formattedGraphicalItems:J,legendWidth:ce,legendContent:g});if(!ne)return null;var re=ne.item,oe=aF(ne,kPe);return Y.cloneElement(re,bt(bt({},oe),{},{chartWidth:V,chartHeight:se,margin:K,onBBoxUpdate:B.handleLegendBBoxUpdate}))}),Ar(B,"renderTooltip",function(){var J,W=B.props,H=W.children,V=W.accessibilityLayer,se=wo(H,as);if(!se)return null;var K=B.state,ce=K.isTooltipActive,ne=K.activeCoordinate,re=K.activePayload,oe=K.activeLabel,ae=K.offset,xe=(J=se.props.active)!==null&&J!==void 0?J:ce;return Y.cloneElement(se,{viewBox:bt(bt({},ae),{},{x:ae.left,y:ae.top}),active:xe,label:oe,payload:xe?re:[],coordinate:ne,accessibilityLayer:V})}),Ar(B,"renderBrush",function(J){var W=B.props,H=W.margin,V=W.data,se=B.state,K=se.offset,ce=se.dataStartIndex,ne=se.dataEndIndex,re=se.updateId;return Y.cloneElement(J,{key:J.key||"_recharts-brush",onChange:yw(B.handleBrushChange,J.props.onChange),data:V,x:Bt(J.props.x)?J.props.x:K.left,y:Bt(J.props.y)?J.props.y:K.top+K.height+K.brushBottom-(H.bottom||0),width:Bt(J.props.width)?J.props.width:K.width,startIndex:ce,endIndex:ne,updateId:"brush-".concat(re)})}),Ar(B,"renderReferenceElement",function(J,W,H){if(!J)return null;var V=B,se=V.clipPathId,K=B.state,ce=K.xAxisMap,ne=K.yAxisMap,re=K.offset,oe=J.type.defaultProps||{},ae=J.props,xe=ae.xAxisId,ye=xe===void 0?oe.xAxisId:xe,Se=ae.yAxisId,be=Se===void 0?oe.yAxisId:Se;return Y.cloneElement(J,{key:J.key||"".concat(W,"-").concat(H),xAxis:ce[ye],yAxis:ne[be],viewBox:{x:re.left,y:re.top,width:re.width,height:re.height},clipPathId:se})}),Ar(B,"renderActivePoints",function(J){var W=J.item,H=J.activePoint,V=J.basePoint,se=J.childIndex,K=J.isRange,ce=[],ne=W.props.key,re=W.item.type.defaultProps!==void 0?bt(bt({},W.item.type.defaultProps),W.item.props):W.item.props,oe=re.activeDot,ae=re.dataKey,xe=bt(bt({index:se,dataKey:ae,cx:H.x,cy:H.y,r:4,fill:e3(W.item),strokeWidth:2,stroke:"#fff",payload:H.payload,value:H.value},fr(oe,!1)),B2(oe));return ce.push(L.renderActiveDot(oe,xe,"".concat(ne,"-activePoint-").concat(se))),V?ce.push(L.renderActiveDot(oe,bt(bt({},xe),{},{cx:V.x,cy:V.y}),"".concat(ne,"-basePoint-").concat(se))):K&&ce.push(null),ce}),Ar(B,"renderGraphicChild",function(J,W,H){var V=B.filterFormatItem(J,W,H);if(!V)return null;var se=B.getTooltipEventType(),K=B.state,ce=K.isTooltipActive,ne=K.tooltipAxis,re=K.activeTooltipIndex,oe=K.activeLabel,ae=B.props.children,xe=wo(ae,as),ye=V.props,Se=ye.points,be=ye.isRange,Ce=ye.baseLine,$e=V.item.type.defaultProps!==void 0?bt(bt({},V.item.type.defaultProps),V.item.props):V.item.props,Ye=$e.activeDot,jt=$e.hide,Me=$e.activeBar,St=$e.activeShape,Ct=!!(!jt&&ce&&xe&&(Ye||Me||St)),Ft={};se!=="axis"&&xe&&xe.props.trigger==="click"?Ft={onClick:yw(B.handleItemMouseEnter,J.props.onClick)}:se!=="axis"&&(Ft={onMouseLeave:yw(B.handleItemMouseLeave,J.props.onMouseLeave),onMouseEnter:yw(B.handleItemMouseEnter,J.props.onMouseEnter)});var gt=Y.cloneElement(J,bt(bt({},V.props),Ft));function Zt(Jt){return typeof ne.dataKey=="function"?ne.dataKey(Jt.payload):null}if(Ct)if(re>=0){var Tt,ot;if(ne.dataKey&&!ne.allowDuplicatedCategory){var ar=typeof ne.dataKey=="function"?Zt:"payload.".concat(ne.dataKey.toString());Tt=F2(Se,ar,oe),ot=be&&Ce&&F2(Ce,ar,oe)}else Tt=Se==null?void 0:Se[re],ot=be&&Ce&&Ce[re];if(St||Me){var mt=J.props.activeIndex!==void 0?J.props.activeIndex:re;return[Y.cloneElement(J,bt(bt(bt({},V.props),Ft),{},{activeIndex:mt})),null,null]}if(!_r(Tt))return[gt].concat(k0(B.renderActivePoints({item:V,activePoint:Tt,basePoint:ot,childIndex:re,isRange:be})))}else{var Lt,dr=(Lt=B.getItemByXY(B.state.activeCoordinate))!==null&&Lt!==void 0?Lt:{graphicalItem:gt},Gr=dr.graphicalItem,qr=Gr.item,ln=qr===void 0?J:qr,Ui=Gr.childIndex,ht=bt(bt(bt({},V.props),Ft),{},{activeIndex:Ui});return[Y.cloneElement(ln,ht),null,null]}return be?[gt,null,null]:[gt,null]}),Ar(B,"renderCustomized",function(J,W,H){return Y.cloneElement(J,bt(bt({key:"recharts-customized-".concat(H)},B.props),B.state))}),Ar(B,"renderMap",{CartesianGrid:{handler:ww,once:!0},ReferenceArea:{handler:B.renderReferenceElement},ReferenceLine:{handler:ww},ReferenceDot:{handler:B.renderReferenceElement},XAxis:{handler:ww},YAxis:{handler:ww},Brush:{handler:B.renderBrush,once:!0},Bar:{handler:B.renderGraphicChild},Line:{handler:B.renderGraphicChild},Area:{handler:B.renderGraphicChild},Radar:{handler:B.renderGraphicChild},RadialBar:{handler:B.renderGraphicChild},Scatter:{handler:B.renderGraphicChild},Pie:{handler:B.renderGraphicChild},Funnel:{handler:B.renderGraphicChild},Tooltip:{handler:B.renderCursor,once:!0},PolarGrid:{handler:B.renderPolarGrid,once:!0},PolarAngleAxis:{handler:B.renderPolarAxis},PolarRadiusAxis:{handler:B.renderPolarAxis},Customized:{handler:B.renderCustomized}}),B.clipPathId="".concat(($=O.id)!==null&&$!==void 0?$:uf("recharts"),"-clip"),B.throttleTriggeredAfterMouseMove=nG(B.triggeredAfterMouseMove,(G=O.throttleDelay)!==null&&G!==void 0?G:1e3/60),B.state={},B}return DPe(L,D),CPe(L,[{key:"componentDidMount",value:function(){var $,G;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:($=this.props.margin.left)!==null&&$!==void 0?$:0,top:(G=this.props.margin.top)!==null&&G!==void 0?G:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var $=this.props,G=$.children,B=$.data,J=$.height,W=$.layout,H=wo(G,as);if(H){var V=H.props.defaultIndex;if(!(typeof V!="number"||V<0||V>this.state.tooltipTicks.length-1)){var se=this.state.tooltipTicks[V]&&this.state.tooltipTicks[V].value,K=GP(this.state,B,V,se),ce=this.state.tooltipTicks[V].coordinate,ne=(this.state.offset.top+J)/2,re=W==="horizontal",oe=re?{x:ce,y:ne}:{y:ce,x:ne},ae=this.state.formattedGraphicalItems.find(function(ye){var Se=ye.item;return Se.type.name==="Scatter"});ae&&(oe=bt(bt({},oe),ae.props.points[V].tooltipPosition),K=ae.props.points[V].tooltipPayload);var xe={activeTooltipIndex:V,isTooltipActive:!0,activeLabel:se,activePayload:K,activeCoordinate:oe};this.setState(xe),this.renderCursor(H),this.accessibilityManager.setIndex(V)}}}},{key:"getSnapshotBeforeUpdate",value:function($,G){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==G.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==$.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==$.margin){var B,J;this.accessibilityManager.setDetails({offset:{left:(B=this.props.margin.left)!==null&&B!==void 0?B:0,top:(J=this.props.margin.top)!==null&&J!==void 0?J:0}})}return null}},{key:"componentDidUpdate",value:function($){mC([wo($.children,as)],[wo(this.props.children,as)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var $=wo(this.props.children,as);if($&&typeof $.props.shared=="boolean"){var G=$.props.shared?"axis":"item";return a.indexOf(G)>=0?G:o}return o}},{key:"getMouseInfo",value:function($){if(!this.container)return null;var G=this.container,B=G.getBoundingClientRect(),J=dve(B),W={chartX:Math.round($.pageX-J.left),chartY:Math.round($.pageY-J.top)},H=B.width/G.offsetWidth||1,V=this.inRange(W.chartX,W.chartY,H);if(!V)return null;var se=this.state,K=se.xAxisMap,ce=se.yAxisMap,ne=this.getTooltipEventType(),re=lF(this.state,this.props.data,this.props.layout,V);if(ne!=="axis"&&K&&ce){var oe=mh(K).scale,ae=mh(ce).scale,xe=oe&&oe.invert?oe.invert(W.chartX):null,ye=ae&&ae.invert?ae.invert(W.chartY):null;return bt(bt({},W),{},{xValue:xe,yValue:ye},re)}return re?bt(bt({},W),re):null}},{key:"inRange",value:function($,G){var B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,J=this.props.layout,W=$/B,H=G/B;if(J==="horizontal"||J==="vertical"){var V=this.state.offset,se=W>=V.left&&W<=V.left+V.width&&H>=V.top&&H<=V.top+V.height;return se?{x:W,y:H}:null}var K=this.state,ce=K.angleAxisMap,ne=K.radiusAxisMap;if(ce&&ne){var re=mh(ce);return _8({x:W,y:H},re)}return null}},{key:"parseEventsOfWrapper",value:function(){var $=this.props.children,G=this.getTooltipEventType(),B=wo($,as),J={};B&&G==="axis"&&(B.props.trigger==="click"?J={onClick:this.handleClick}:J={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var W=B2(this.props,this.handleOuterEvent);return bt(bt({},W),J)}},{key:"addListener",value:function(){$A.on(FA,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){$A.removeListener(FA,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function($,G,B){for(var J=this.state.formattedGraphicalItems,W=0,H=J.length;W<H;W++){var V=J[W];if(V.item===$||V.props.key===$.key||G===Qu(V.item.type)&&B===V.childIndex)return V}return null}},{key:"renderClipPath",value:function(){var $=this.clipPathId,G=this.state.offset,B=G.left,J=G.top,W=G.height,H=G.width;return Le.createElement("defs",null,Le.createElement("clipPath",{id:$},Le.createElement("rect",{x:B,y:J,height:W,width:H})))}},{key:"getXScales",value:function(){var $=this.state.xAxisMap;return $?Object.entries($).reduce(function(G,B){var J=iF(B,2),W=J[0],H=J[1];return bt(bt({},G),{},Ar({},W,H.scale))},{}):null}},{key:"getYScales",value:function(){var $=this.state.yAxisMap;return $?Object.entries($).reduce(function(G,B){var J=iF(B,2),W=J[0],H=J[1];return bt(bt({},G),{},Ar({},W,H.scale))},{}):null}},{key:"getXScaleByAxisId",value:function($){var G;return(G=this.state.xAxisMap)===null||G===void 0||(G=G[$])===null||G===void 0?void 0:G.scale}},{key:"getYScaleByAxisId",value:function($){var G;return(G=this.state.yAxisMap)===null||G===void 0||(G=G[$])===null||G===void 0?void 0:G.scale}},{key:"getItemByXY",value:function($){var G=this.state,B=G.formattedGraphicalItems,J=G.activeItem;if(B&&B.length)for(var W=0,H=B.length;W<H;W++){var V=B[W],se=V.props,K=V.item,ce=K.type.defaultProps!==void 0?bt(bt({},K.type.defaultProps),K.props):K.props,ne=Qu(K.type);if(ne==="Bar"){var re=(se.data||[]).find(function(ye){return JTe($,ye)});if(re)return{graphicalItem:V,payload:re}}else if(ne==="RadialBar"){var oe=(se.data||[]).find(function(ye){return _8($,ye)});if(oe)return{graphicalItem:V,payload:oe}}else if(wS(V,J)||kS(V,J)||j_(V,J)){var ae=FEe({graphicalItem:V,activeTooltipItem:J,itemData:ce.data}),xe=ce.activeIndex===void 0?ae:ce.activeIndex;return{graphicalItem:bt(bt({},V),{},{childIndex:xe}),payload:j_(V,J)?ce.data[ae]:V.props.data[ae]}}}return null}},{key:"render",value:function(){var $=this;if(!oL(this))return null;var G=this.props,B=G.children,J=G.className,W=G.width,H=G.height,V=G.style,se=G.compact,K=G.title,ce=G.desc,ne=aF(G,TPe),re=fr(ne,!1);if(se)return Le.createElement(N$,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Le.createElement(yC,yg({},re,{width:W,height:H,title:K,desc:ce}),this.renderClipPath(),cL(B,this.renderMap)));if(this.props.accessibilityLayer){var oe,ae;re.tabIndex=(oe=this.props.tabIndex)!==null&&oe!==void 0?oe:0,re.role=(ae=this.props.role)!==null&&ae!==void 0?ae:"application",re.onKeyDown=function(ye){$.accessibilityManager.keyboardEvent(ye)},re.onFocus=function(){$.accessibilityManager.focus()}}var xe=this.parseEventsOfWrapper();return Le.createElement(N$,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Le.createElement("div",yg({className:Fr("recharts-wrapper",J),style:bt({position:"relative",cursor:"default",width:W,height:H},V)},xe,{ref:function(Se){$.container=Se}}),Le.createElement(yC,yg({},re,{width:W,height:H,title:K,desc:ce,style:FPe}),this.renderClipPath(),cL(B,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(Y.Component);Ar(I,"displayName",r),Ar(I,"defaultProps",bt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},w)),Ar(I,"getDerivedStateFromProps",function(D,L){var O=D.dataKey,$=D.data,G=D.children,B=D.width,J=D.height,W=D.layout,H=D.stackOffset,V=D.margin,se=L.dataStartIndex,K=L.dataEndIndex;if(L.updateId===void 0){var ce=cF(D);return bt(bt(bt({},ce),{},{updateId:0},A(bt(bt({props:D},ce),{},{updateId:0}),L)),{},{prevDataKey:O,prevData:$,prevWidth:B,prevHeight:J,prevLayout:W,prevStackOffset:H,prevMargin:V,prevChildren:G})}if(O!==L.prevDataKey||$!==L.prevData||B!==L.prevWidth||J!==L.prevHeight||W!==L.prevLayout||H!==L.prevStackOffset||!Ng(V,L.prevMargin)){var ne=cF(D),re={chartX:L.chartX,chartY:L.chartY,isTooltipActive:L.isTooltipActive},oe=bt(bt({},lF(L,$,W)),{},{updateId:L.updateId+1}),ae=bt(bt(bt({},ne),re),oe);return bt(bt(bt({},ae),A(bt({props:D},ae),L)),{},{prevDataKey:O,prevData:$,prevWidth:B,prevHeight:J,prevLayout:W,prevStackOffset:H,prevMargin:V,prevChildren:G})}if(!mC(G,L.prevChildren)){var xe,ye,Se,be,Ce=wo(G,u0),$e=Ce&&(xe=(ye=Ce.props)===null||ye===void 0?void 0:ye.startIndex)!==null&&xe!==void 0?xe:se,Ye=Ce&&(Se=(be=Ce.props)===null||be===void 0?void 0:be.endIndex)!==null&&Se!==void 0?Se:K,jt=$e!==se||Ye!==K,Me=!_r($),St=Me&&!jt?L.updateId:L.updateId+1;return bt(bt({updateId:St},A(bt(bt({props:D},L),{},{updateId:St,dataStartIndex:$e,dataEndIndex:Ye}),L)),{},{prevChildren:G,dataStartIndex:$e,dataEndIndex:Ye})}return null}),Ar(I,"renderActiveDot",function(D,L,O){var $;return Y.isValidElement(D)?$=Y.cloneElement(D,L):Tr(D)?$=D(L):$=Le.createElement(mb,L),Le.createElement(Ur,{className:"recharts-active-dot",key:O},$)});var P=Y.forwardRef(function(L,O){return Le.createElement(I,yg({},L,{ref:O}))});return P.displayName=I.displayName,P},XPe=IS({chartName:"LineChart",GraphicalChild:Hh,axisComponents:[{axisType:"xAxis",AxisComp:Td},{axisType:"yAxis",AxisComp:ou}],formatAxisMap:r3}),h3=IS({chartName:"PieChart",GraphicalChild:fc,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:bS},{axisType:"radiusAxis",AxisComp:vS}],formatAxisMap:f2e,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),$H=IS({chartName:"AreaChart",GraphicalChild:cs,axisComponents:[{axisType:"xAxis",AxisComp:Td},{axisType:"yAxis",AxisComp:ou}],formatAxisMap:r3}),YPe=IS({chartName:"ComposedChart",GraphicalChild:[Hh,cs,ry,CS],axisComponents:[{axisType:"xAxis",AxisComp:Td},{axisType:"yAxis",AxisComp:ou},{axisType:"zAxis",AxisComp:NS}],formatAxisMap:r3});const JPe=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FH=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},QPe=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],u=t[r++],a=t[r++],p=((i&7)<<18|(o&63)<<12|(u&63)<<6|a&63)-65536;e[n++]=String.fromCharCode(55296+(p>>10)),e[n++]=String.fromCharCode(56320+(p&1023))}else{const o=t[r++],u=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|u&63)}}return e.join("")},BH={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],u=i+1<t.length,a=u?t[i+1]:0,p=i+2<t.length,g=p?t[i+2]:0,v=o>>2,w=(o&3)<<4|a>>4;let T=(a&15)<<2|g>>6,A=g&63;p||(A=64,u||(T=64)),n.push(r[v],r[w],r[T],r[A])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(FH(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):QPe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],a=i<t.length?r[t.charAt(i)]:0;++i;const g=i<t.length?r[t.charAt(i)]:64;++i;const w=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||a==null||g==null||w==null)throw new e4e;const T=o<<2|a>>4;if(n.push(T),g!==64){const A=a<<4&240|g>>2;if(n.push(A),w!==64){const I=g<<6&192|w;n.push(I)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class e4e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const t4e=function(t){const e=FH(t);return BH.encodeByteArray(e,!0)},Uk=function(t){return t4e(t).replace(/\./g,"")},r4e=function(t){try{return BH.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4e=()=>n4e().__FIREBASE_DEFAULTS__,a4e=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},s4e=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&r4e(t[1]);return e&&JSON.parse(e)},f3=()=>{try{return JPe()||i4e()||a4e()||s4e()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},o4e=t=>{var e,r;return(r=(e=f3())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},VH=t=>{const e=o4e(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},UH=()=>{var t;return(t=f3())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4e{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function qH(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4e(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Uk(JSON.stringify(r)),Uk(JSON.stringify(u)),a].join(".")}const Sv={};function u4e(){const t={prod:[],emulator:[]};for(const e of Object.keys(Sv))Sv[e]?t.emulator.push(e):t.prod.push(e);return t}function d4e(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let dF=!1;function GH(t,e){if(typeof window>"u"||typeof document>"u"||!MS(window.location.host)||Sv[t]===e||Sv[t]||dF)return;Sv[t]=e;function r(T){return`__firebase__banner__${T}`}const n="__firebase__banner",o=u4e().prod.length>0;function u(){const T=document.getElementById(n);T&&T.remove()}function a(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function p(T,A){T.setAttribute("width","24"),T.setAttribute("id",A),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function g(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{dF=!0,u()},T}function v(T,A){T.setAttribute("id",A),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function w(){const T=d4e(n),A=r("text"),I=document.getElementById(A)||document.createElement("span"),P=r("learnmore"),D=document.getElementById(P)||document.createElement("a"),L=r("preprendIcon"),O=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const $=T.element;a($),v(D,P);const G=g();p(O,L),$.append(O,I,D,G),document.body.appendChild($)}o?(I.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,I.innerText="Preview backend running in this workspace."),I.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h4e(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function f4e(){var t;const e=(t=f3())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function p4e(){return!f4e()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function m4e(){try{return typeof indexedDB=="object"}catch{return!1}}function g4e(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4e="FirebaseError";class Yp extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=y4e,Object.setPrototypeOf(this,Yp.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,WH.prototype.create)}}class WH{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],u=o?x4e(o,n):"Error",a=`${this.serviceName}: ${u} (${i}).`;return new Yp(i,a,n)}}function x4e(t,e){return t.replace(v4e,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const v4e=/\{\$([^}]+)}/g;function qk(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],u=e[i];if(hF(o)&&hF(u)){if(!qk(o,u))return!1}else if(o!==u)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function hF(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ao(t){return t&&t._delegate?t._delegate:t}class T0{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4e{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new l4e;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(w4e(e))try{this.getOrInitializeService({instanceIdentifier:sp})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=sp){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sp){return this.instances.has(e)}getOptions(e=sp){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,u]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);n===a&&u.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),o=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;o.add(e),this.onInitCallbacks.set(i,o);const u=this.instances.get(i);return u&&e(u,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:b4e(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=sp){return this.component?this.component.multipleInstances?e:sp:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function b4e(t){return t===sp?void 0:t}function w4e(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4e{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new _4e(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var on;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(on||(on={}));const T4e={debug:on.DEBUG,verbose:on.VERBOSE,info:on.INFO,warn:on.WARN,error:on.ERROR,silent:on.SILENT},S4e=on.INFO,E4e={[on.DEBUG]:"log",[on.VERBOSE]:"log",[on.INFO]:"info",[on.WARN]:"warn",[on.ERROR]:"error"},j4e=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=E4e[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class HH{constructor(e){this.name=e,this._logLevel=S4e,this._logHandler=j4e,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in on))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?T4e[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,on.DEBUG,...e),this._logHandler(this,on.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,on.VERBOSE,...e),this._logHandler(this,on.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,on.INFO,...e),this._logHandler(this,on.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,on.WARN,...e),this._logHandler(this,on.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,on.ERROR,...e),this._logHandler(this,on.ERROR,...e)}}const A4e=(t,e)=>e.some(r=>t instanceof r);let fF,pF;function N4e(){return fF||(fF=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function C4e(){return pF||(pF=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const KH=new WeakMap,WP=new WeakMap,ZH=new WeakMap,VA=new WeakMap,p3=new WeakMap;function P4e(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",u)},o=()=>{r(Rh(t.result)),i()},u=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",u)});return e.then(r=>{r instanceof IDBCursor&&KH.set(r,t)}).catch(()=>{}),p3.set(e,t),e}function I4e(t){if(WP.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",u),t.removeEventListener("abort",u)},o=()=>{r(),i()},u=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",u),t.addEventListener("abort",u)});WP.set(t,e)}let HP={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return WP.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ZH.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Rh(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function M4e(t){HP=t(HP)}function D4e(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(UA(this),e,...r);return ZH.set(n,e.sort?e.sort():[e]),Rh(n)}:C4e().includes(t)?function(...e){return t.apply(UA(this),e),Rh(KH.get(this))}:function(...e){return Rh(t.apply(UA(this),e))}}function O4e(t){return typeof t=="function"?D4e(t):(t instanceof IDBTransaction&&I4e(t),A4e(t,N4e())?new Proxy(t,HP):t)}function Rh(t){if(t instanceof IDBRequest)return P4e(t);if(VA.has(t))return VA.get(t);const e=O4e(t);return e!==t&&(VA.set(t,e),p3.set(e,t)),e}const UA=t=>p3.get(t);function R4e(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const u=indexedDB.open(t,e),a=Rh(u);return n&&u.addEventListener("upgradeneeded",p=>{n(Rh(u.result),p.oldVersion,p.newVersion,Rh(u.transaction),p)}),r&&u.addEventListener("blocked",p=>r(p.oldVersion,p.newVersion,p)),a.then(p=>{o&&p.addEventListener("close",()=>o()),i&&p.addEventListener("versionchange",g=>i(g.oldVersion,g.newVersion,g))}).catch(()=>{}),a}const L4e=["get","getKey","getAll","getAllKeys","count"],z4e=["put","add","delete","clear"],qA=new Map;function mF(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qA.get(e))return qA.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=z4e.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||L4e.includes(r)))return;const o=async function(u,...a){const p=this.transaction(u,i?"readwrite":"readonly");let g=p.store;return n&&(g=g.index(a.shift())),(await Promise.all([g[r](...a),i&&p.done]))[0]};return qA.set(e,o),o}M4e(t=>({...t,get:(e,r,n)=>mF(e,r)||t.get(e,r,n),has:(e,r)=>!!mF(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4e{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(F4e(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function F4e(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const KP="@firebase/app",gF="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd=new HH("@firebase/app"),B4e="@firebase/app-compat",V4e="@firebase/analytics-compat",U4e="@firebase/analytics",q4e="@firebase/app-check-compat",G4e="@firebase/app-check",W4e="@firebase/auth",H4e="@firebase/auth-compat",K4e="@firebase/database",Z4e="@firebase/data-connect",X4e="@firebase/database-compat",Y4e="@firebase/functions",J4e="@firebase/functions-compat",Q4e="@firebase/installations",eIe="@firebase/installations-compat",tIe="@firebase/messaging",rIe="@firebase/messaging-compat",nIe="@firebase/performance",iIe="@firebase/performance-compat",aIe="@firebase/remote-config",sIe="@firebase/remote-config-compat",oIe="@firebase/storage",lIe="@firebase/storage-compat",cIe="@firebase/firestore",uIe="@firebase/ai",dIe="@firebase/firestore-compat",hIe="firebase",fIe="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZP="[DEFAULT]",pIe={[KP]:"fire-core",[B4e]:"fire-core-compat",[U4e]:"fire-analytics",[V4e]:"fire-analytics-compat",[G4e]:"fire-app-check",[q4e]:"fire-app-check-compat",[W4e]:"fire-auth",[H4e]:"fire-auth-compat",[K4e]:"fire-rtdb",[Z4e]:"fire-data-connect",[X4e]:"fire-rtdb-compat",[Y4e]:"fire-fn",[J4e]:"fire-fn-compat",[Q4e]:"fire-iid",[eIe]:"fire-iid-compat",[tIe]:"fire-fcm",[rIe]:"fire-fcm-compat",[nIe]:"fire-perf",[iIe]:"fire-perf-compat",[aIe]:"fire-rc",[sIe]:"fire-rc-compat",[oIe]:"fire-gcs",[lIe]:"fire-gcs-compat",[cIe]:"fire-fst",[dIe]:"fire-fst-compat",[uIe]:"fire-vertex","fire-js":"fire-js",[hIe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk=new Map,mIe=new Map,XP=new Map;function yF(t,e){try{t.container.addComponent(e)}catch(r){fd.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function D_(t){const e=t.name;if(XP.has(e))return fd.debug(`There were multiple attempts to register component ${e}.`),!1;XP.set(e,t);for(const r of Gk.values())yF(r,t);for(const r of mIe.values())yF(r,t);return!0}function XH(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function YH(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gIe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lh=new WH("app","Firebase",gIe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yIe{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new T0("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lh.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xIe=fIe;function JH(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ZP,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw Lh.create("bad-app-name",{appName:String(i)});if(r||(r=UH()),!r)throw Lh.create("no-options");const o=Gk.get(i);if(o){if(qk(r,o.options)&&qk(n,o.config))return o;throw Lh.create("duplicate-app",{appName:i})}const u=new k4e(i);for(const p of XP.values())u.addComponent(p);const a=new yIe(r,n,u);return Gk.set(i,a),a}function QH(t=ZP){const e=Gk.get(t);if(!e&&t===ZP&&UH())return JH();if(!e)throw Lh.create("no-app",{appName:t});return e}function zh(t,e,r){var n;let i=(n=pIe[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const o=i.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const a=[`Unable to register library "${i}" with version "${e}":`];o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&u&&a.push("and"),u&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fd.warn(a.join(" "));return}D_(new T0(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vIe="firebase-heartbeat-database",_Ie=1,O_="firebase-heartbeat-store";let GA=null;function eK(){return GA||(GA=R4e(vIe,_Ie,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(O_)}catch(r){console.warn(r)}}}}).catch(t=>{throw Lh.create("idb-open",{originalErrorMessage:t.message})})),GA}async function bIe(t){try{const r=(await eK()).transaction(O_),n=await r.objectStore(O_).get(tK(t));return await r.done,n}catch(e){if(e instanceof Yp)fd.warn(e.message);else{const r=Lh.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});fd.warn(r.message)}}}async function xF(t,e){try{const n=(await eK()).transaction(O_,"readwrite");await n.objectStore(O_).put(e,tK(t)),await n.done}catch(r){if(r instanceof Yp)fd.warn(r.message);else{const n=Lh.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});fd.warn(n.message)}}}function tK(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wIe=1024,kIe=30;class TIe{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new EIe(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=vF();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(u=>u.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>kIe){const u=jIe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){fd.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=vF(),{heartbeatsToSend:n,unsentEntries:i}=SIe(this._heartbeatsCache.heartbeats),o=Uk(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return fd.warn(r),""}}}function vF(){return new Date().toISOString().substring(0,10)}function SIe(t,e=wIe){const r=[];let n=t.slice();for(const i of t){const o=r.find(u=>u.agent===i.agent);if(o){if(o.dates.push(i.date),_F(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),_F(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class EIe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return m4e()?g4e().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await bIe(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return xF(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return xF(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function _F(t){return Uk(JSON.stringify({version:2,heartbeats:t})).length}function jIe(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AIe(t){D_(new T0("platform-logger",e=>new $4e(e),"PRIVATE")),D_(new T0("heartbeat",e=>new TIe(e),"PRIVATE")),zh(KP,gF,t),zh(KP,gF,"esm2017"),zh("fire-js","")}AIe("");var bF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $h,rK;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(W,H){function V(){}V.prototype=H.prototype,W.D=H.prototype,W.prototype=new V,W.prototype.constructor=W,W.C=function(se,K,ce){for(var ne=Array(arguments.length-2),re=2;re<arguments.length;re++)ne[re-2]=arguments[re];return H.prototype[K].apply(se,ne)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(W,H,V){V||(V=0);var se=Array(16);if(typeof H=="string")for(var K=0;16>K;++K)se[K]=H.charCodeAt(V++)|H.charCodeAt(V++)<<8|H.charCodeAt(V++)<<16|H.charCodeAt(V++)<<24;else for(K=0;16>K;++K)se[K]=H[V++]|H[V++]<<8|H[V++]<<16|H[V++]<<24;H=W.g[0],V=W.g[1],K=W.g[2];var ce=W.g[3],ne=H+(ce^V&(K^ce))+se[0]+3614090360&4294967295;H=V+(ne<<7&4294967295|ne>>>25),ne=ce+(K^H&(V^K))+se[1]+3905402710&4294967295,ce=H+(ne<<12&4294967295|ne>>>20),ne=K+(V^ce&(H^V))+se[2]+606105819&4294967295,K=ce+(ne<<17&4294967295|ne>>>15),ne=V+(H^K&(ce^H))+se[3]+3250441966&4294967295,V=K+(ne<<22&4294967295|ne>>>10),ne=H+(ce^V&(K^ce))+se[4]+4118548399&4294967295,H=V+(ne<<7&4294967295|ne>>>25),ne=ce+(K^H&(V^K))+se[5]+1200080426&4294967295,ce=H+(ne<<12&4294967295|ne>>>20),ne=K+(V^ce&(H^V))+se[6]+2821735955&4294967295,K=ce+(ne<<17&4294967295|ne>>>15),ne=V+(H^K&(ce^H))+se[7]+4249261313&4294967295,V=K+(ne<<22&4294967295|ne>>>10),ne=H+(ce^V&(K^ce))+se[8]+1770035416&4294967295,H=V+(ne<<7&4294967295|ne>>>25),ne=ce+(K^H&(V^K))+se[9]+2336552879&4294967295,ce=H+(ne<<12&4294967295|ne>>>20),ne=K+(V^ce&(H^V))+se[10]+4294925233&4294967295,K=ce+(ne<<17&4294967295|ne>>>15),ne=V+(H^K&(ce^H))+se[11]+2304563134&4294967295,V=K+(ne<<22&4294967295|ne>>>10),ne=H+(ce^V&(K^ce))+se[12]+1804603682&4294967295,H=V+(ne<<7&4294967295|ne>>>25),ne=ce+(K^H&(V^K))+se[13]+4254626195&4294967295,ce=H+(ne<<12&4294967295|ne>>>20),ne=K+(V^ce&(H^V))+se[14]+2792965006&4294967295,K=ce+(ne<<17&4294967295|ne>>>15),ne=V+(H^K&(ce^H))+se[15]+1236535329&4294967295,V=K+(ne<<22&4294967295|ne>>>10),ne=H+(K^ce&(V^K))+se[1]+4129170786&4294967295,H=V+(ne<<5&4294967295|ne>>>27),ne=ce+(V^K&(H^V))+se[6]+3225465664&4294967295,ce=H+(ne<<9&4294967295|ne>>>23),ne=K+(H^V&(ce^H))+se[11]+643717713&4294967295,K=ce+(ne<<14&4294967295|ne>>>18),ne=V+(ce^H&(K^ce))+se[0]+3921069994&4294967295,V=K+(ne<<20&4294967295|ne>>>12),ne=H+(K^ce&(V^K))+se[5]+3593408605&4294967295,H=V+(ne<<5&4294967295|ne>>>27),ne=ce+(V^K&(H^V))+se[10]+38016083&4294967295,ce=H+(ne<<9&4294967295|ne>>>23),ne=K+(H^V&(ce^H))+se[15]+3634488961&4294967295,K=ce+(ne<<14&4294967295|ne>>>18),ne=V+(ce^H&(K^ce))+se[4]+3889429448&4294967295,V=K+(ne<<20&4294967295|ne>>>12),ne=H+(K^ce&(V^K))+se[9]+568446438&4294967295,H=V+(ne<<5&4294967295|ne>>>27),ne=ce+(V^K&(H^V))+se[14]+3275163606&4294967295,ce=H+(ne<<9&4294967295|ne>>>23),ne=K+(H^V&(ce^H))+se[3]+4107603335&4294967295,K=ce+(ne<<14&4294967295|ne>>>18),ne=V+(ce^H&(K^ce))+se[8]+1163531501&4294967295,V=K+(ne<<20&4294967295|ne>>>12),ne=H+(K^ce&(V^K))+se[13]+2850285829&4294967295,H=V+(ne<<5&4294967295|ne>>>27),ne=ce+(V^K&(H^V))+se[2]+4243563512&4294967295,ce=H+(ne<<9&4294967295|ne>>>23),ne=K+(H^V&(ce^H))+se[7]+1735328473&4294967295,K=ce+(ne<<14&4294967295|ne>>>18),ne=V+(ce^H&(K^ce))+se[12]+2368359562&4294967295,V=K+(ne<<20&4294967295|ne>>>12),ne=H+(V^K^ce)+se[5]+4294588738&4294967295,H=V+(ne<<4&4294967295|ne>>>28),ne=ce+(H^V^K)+se[8]+2272392833&4294967295,ce=H+(ne<<11&4294967295|ne>>>21),ne=K+(ce^H^V)+se[11]+1839030562&4294967295,K=ce+(ne<<16&4294967295|ne>>>16),ne=V+(K^ce^H)+se[14]+4259657740&4294967295,V=K+(ne<<23&4294967295|ne>>>9),ne=H+(V^K^ce)+se[1]+2763975236&4294967295,H=V+(ne<<4&4294967295|ne>>>28),ne=ce+(H^V^K)+se[4]+1272893353&4294967295,ce=H+(ne<<11&4294967295|ne>>>21),ne=K+(ce^H^V)+se[7]+4139469664&4294967295,K=ce+(ne<<16&4294967295|ne>>>16),ne=V+(K^ce^H)+se[10]+3200236656&4294967295,V=K+(ne<<23&4294967295|ne>>>9),ne=H+(V^K^ce)+se[13]+681279174&4294967295,H=V+(ne<<4&4294967295|ne>>>28),ne=ce+(H^V^K)+se[0]+3936430074&4294967295,ce=H+(ne<<11&4294967295|ne>>>21),ne=K+(ce^H^V)+se[3]+3572445317&4294967295,K=ce+(ne<<16&4294967295|ne>>>16),ne=V+(K^ce^H)+se[6]+76029189&4294967295,V=K+(ne<<23&4294967295|ne>>>9),ne=H+(V^K^ce)+se[9]+3654602809&4294967295,H=V+(ne<<4&4294967295|ne>>>28),ne=ce+(H^V^K)+se[12]+3873151461&4294967295,ce=H+(ne<<11&4294967295|ne>>>21),ne=K+(ce^H^V)+se[15]+530742520&4294967295,K=ce+(ne<<16&4294967295|ne>>>16),ne=V+(K^ce^H)+se[2]+3299628645&4294967295,V=K+(ne<<23&4294967295|ne>>>9),ne=H+(K^(V|~ce))+se[0]+4096336452&4294967295,H=V+(ne<<6&4294967295|ne>>>26),ne=ce+(V^(H|~K))+se[7]+1126891415&4294967295,ce=H+(ne<<10&4294967295|ne>>>22),ne=K+(H^(ce|~V))+se[14]+2878612391&4294967295,K=ce+(ne<<15&4294967295|ne>>>17),ne=V+(ce^(K|~H))+se[5]+4237533241&4294967295,V=K+(ne<<21&4294967295|ne>>>11),ne=H+(K^(V|~ce))+se[12]+1700485571&4294967295,H=V+(ne<<6&4294967295|ne>>>26),ne=ce+(V^(H|~K))+se[3]+2399980690&4294967295,ce=H+(ne<<10&4294967295|ne>>>22),ne=K+(H^(ce|~V))+se[10]+4293915773&4294967295,K=ce+(ne<<15&4294967295|ne>>>17),ne=V+(ce^(K|~H))+se[1]+2240044497&4294967295,V=K+(ne<<21&4294967295|ne>>>11),ne=H+(K^(V|~ce))+se[8]+1873313359&4294967295,H=V+(ne<<6&4294967295|ne>>>26),ne=ce+(V^(H|~K))+se[15]+4264355552&4294967295,ce=H+(ne<<10&4294967295|ne>>>22),ne=K+(H^(ce|~V))+se[6]+2734768916&4294967295,K=ce+(ne<<15&4294967295|ne>>>17),ne=V+(ce^(K|~H))+se[13]+1309151649&4294967295,V=K+(ne<<21&4294967295|ne>>>11),ne=H+(K^(V|~ce))+se[4]+4149444226&4294967295,H=V+(ne<<6&4294967295|ne>>>26),ne=ce+(V^(H|~K))+se[11]+3174756917&4294967295,ce=H+(ne<<10&4294967295|ne>>>22),ne=K+(H^(ce|~V))+se[2]+718787259&4294967295,K=ce+(ne<<15&4294967295|ne>>>17),ne=V+(ce^(K|~H))+se[9]+3951481745&4294967295,W.g[0]=W.g[0]+H&4294967295,W.g[1]=W.g[1]+(K+(ne<<21&4294967295|ne>>>11))&4294967295,W.g[2]=W.g[2]+K&4294967295,W.g[3]=W.g[3]+ce&4294967295}n.prototype.u=function(W,H){H===void 0&&(H=W.length);for(var V=H-this.blockSize,se=this.B,K=this.h,ce=0;ce<H;){if(K==0)for(;ce<=V;)i(this,W,ce),ce+=this.blockSize;if(typeof W=="string"){for(;ce<H;)if(se[K++]=W.charCodeAt(ce++),K==this.blockSize){i(this,se),K=0;break}}else for(;ce<H;)if(se[K++]=W[ce++],K==this.blockSize){i(this,se),K=0;break}}this.h=K,this.o+=H},n.prototype.v=function(){var W=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);W[0]=128;for(var H=1;H<W.length-8;++H)W[H]=0;var V=8*this.o;for(H=W.length-8;H<W.length;++H)W[H]=V&255,V/=256;for(this.u(W),W=Array(16),H=V=0;4>H;++H)for(var se=0;32>se;se+=8)W[V++]=this.g[H]>>>se&255;return W};function o(W,H){var V=a;return Object.prototype.hasOwnProperty.call(V,W)?V[W]:V[W]=H(W)}function u(W,H){this.h=H;for(var V=[],se=!0,K=W.length-1;0<=K;K--){var ce=W[K]|0;se&&ce==H||(V[K]=ce,se=!1)}this.g=V}var a={};function p(W){return-128<=W&&128>W?o(W,function(H){return new u([H|0],0>H?-1:0)}):new u([W|0],0>W?-1:0)}function g(W){if(isNaN(W)||!isFinite(W))return w;if(0>W)return D(g(-W));for(var H=[],V=1,se=0;W>=V;se++)H[se]=W/V|0,V*=4294967296;return new u(H,0)}function v(W,H){if(W.length==0)throw Error("number format error: empty string");if(H=H||10,2>H||36<H)throw Error("radix out of range: "+H);if(W.charAt(0)=="-")return D(v(W.substring(1),H));if(0<=W.indexOf("-"))throw Error('number format error: interior "-" character');for(var V=g(Math.pow(H,8)),se=w,K=0;K<W.length;K+=8){var ce=Math.min(8,W.length-K),ne=parseInt(W.substring(K,K+ce),H);8>ce?(ce=g(Math.pow(H,ce)),se=se.j(ce).add(g(ne))):(se=se.j(V),se=se.add(g(ne)))}return se}var w=p(0),T=p(1),A=p(16777216);t=u.prototype,t.m=function(){if(P(this))return-D(this).m();for(var W=0,H=1,V=0;V<this.g.length;V++){var se=this.i(V);W+=(0<=se?se:4294967296+se)*H,H*=4294967296}return W},t.toString=function(W){if(W=W||10,2>W||36<W)throw Error("radix out of range: "+W);if(I(this))return"0";if(P(this))return"-"+D(this).toString(W);for(var H=g(Math.pow(W,6)),V=this,se="";;){var K=G(V,H).g;V=L(V,K.j(H));var ce=((0<V.g.length?V.g[0]:V.h)>>>0).toString(W);if(V=K,I(V))return ce+se;for(;6>ce.length;)ce="0"+ce;se=ce+se}},t.i=function(W){return 0>W?0:W<this.g.length?this.g[W]:this.h};function I(W){if(W.h!=0)return!1;for(var H=0;H<W.g.length;H++)if(W.g[H]!=0)return!1;return!0}function P(W){return W.h==-1}t.l=function(W){return W=L(this,W),P(W)?-1:I(W)?0:1};function D(W){for(var H=W.g.length,V=[],se=0;se<H;se++)V[se]=~W.g[se];return new u(V,~W.h).add(T)}t.abs=function(){return P(this)?D(this):this},t.add=function(W){for(var H=Math.max(this.g.length,W.g.length),V=[],se=0,K=0;K<=H;K++){var ce=se+(this.i(K)&65535)+(W.i(K)&65535),ne=(ce>>>16)+(this.i(K)>>>16)+(W.i(K)>>>16);se=ne>>>16,ce&=65535,ne&=65535,V[K]=ne<<16|ce}return new u(V,V[V.length-1]&-2147483648?-1:0)};function L(W,H){return W.add(D(H))}t.j=function(W){if(I(this)||I(W))return w;if(P(this))return P(W)?D(this).j(D(W)):D(D(this).j(W));if(P(W))return D(this.j(D(W)));if(0>this.l(A)&&0>W.l(A))return g(this.m()*W.m());for(var H=this.g.length+W.g.length,V=[],se=0;se<2*H;se++)V[se]=0;for(se=0;se<this.g.length;se++)for(var K=0;K<W.g.length;K++){var ce=this.i(se)>>>16,ne=this.i(se)&65535,re=W.i(K)>>>16,oe=W.i(K)&65535;V[2*se+2*K]+=ne*oe,O(V,2*se+2*K),V[2*se+2*K+1]+=ce*oe,O(V,2*se+2*K+1),V[2*se+2*K+1]+=ne*re,O(V,2*se+2*K+1),V[2*se+2*K+2]+=ce*re,O(V,2*se+2*K+2)}for(se=0;se<H;se++)V[se]=V[2*se+1]<<16|V[2*se];for(se=H;se<2*H;se++)V[se]=0;return new u(V,0)};function O(W,H){for(;(W[H]&65535)!=W[H];)W[H+1]+=W[H]>>>16,W[H]&=65535,H++}function $(W,H){this.g=W,this.h=H}function G(W,H){if(I(H))throw Error("division by zero");if(I(W))return new $(w,w);if(P(W))return H=G(D(W),H),new $(D(H.g),D(H.h));if(P(H))return H=G(W,D(H)),new $(D(H.g),H.h);if(30<W.g.length){if(P(W)||P(H))throw Error("slowDivide_ only works with positive integers.");for(var V=T,se=H;0>=se.l(W);)V=B(V),se=B(se);var K=J(V,1),ce=J(se,1);for(se=J(se,2),V=J(V,2);!I(se);){var ne=ce.add(se);0>=ne.l(W)&&(K=K.add(V),ce=ne),se=J(se,1),V=J(V,1)}return H=L(W,K.j(H)),new $(K,H)}for(K=w;0<=W.l(H);){for(V=Math.max(1,Math.floor(W.m()/H.m())),se=Math.ceil(Math.log(V)/Math.LN2),se=48>=se?1:Math.pow(2,se-48),ce=g(V),ne=ce.j(H);P(ne)||0<ne.l(W);)V-=se,ce=g(V),ne=ce.j(H);I(ce)&&(ce=T),K=K.add(ce),W=L(W,ne)}return new $(K,W)}t.A=function(W){return G(this,W).h},t.and=function(W){for(var H=Math.max(this.g.length,W.g.length),V=[],se=0;se<H;se++)V[se]=this.i(se)&W.i(se);return new u(V,this.h&W.h)},t.or=function(W){for(var H=Math.max(this.g.length,W.g.length),V=[],se=0;se<H;se++)V[se]=this.i(se)|W.i(se);return new u(V,this.h|W.h)},t.xor=function(W){for(var H=Math.max(this.g.length,W.g.length),V=[],se=0;se<H;se++)V[se]=this.i(se)^W.i(se);return new u(V,this.h^W.h)};function B(W){for(var H=W.g.length+1,V=[],se=0;se<H;se++)V[se]=W.i(se)<<1|W.i(se-1)>>>31;return new u(V,W.h)}function J(W,H){var V=H>>5;H%=32;for(var se=W.g.length-V,K=[],ce=0;ce<se;ce++)K[ce]=0<H?W.i(ce+V)>>>H|W.i(ce+V+1)<<32-H:W.i(ce+V);return new u(K,W.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,rK=n,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=g,u.fromString=v,$h=u}).apply(typeof bF<"u"?bF:typeof self<"u"?self:typeof window<"u"?window:{});var kw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var nK,Gx,iK,e2,YP,aK,sK,oK;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(C,Z,de){return C==Array.prototype||C==Object.prototype||(C[Z]=de.value),C};function r(C){C=[typeof globalThis=="object"&&globalThis,C,typeof window=="object"&&window,typeof self=="object"&&self,typeof kw=="object"&&kw];for(var Z=0;Z<C.length;++Z){var de=C[Z];if(de&&de.Math==Math)return de}throw Error("Cannot find global object")}var n=r(this);function i(C,Z){if(Z)e:{var de=n;C=C.split(".");for(var ke=0;ke<C.length-1;ke++){var et=C[ke];if(!(et in de))break e;de=de[et]}C=C[C.length-1],ke=de[C],Z=Z(ke),Z!=ke&&Z!=null&&e(de,C,{configurable:!0,writable:!0,value:Z})}}function o(C,Z){C instanceof String&&(C+="");var de=0,ke=!1,et={next:function(){if(!ke&&de<C.length){var ut=de++;return{value:Z(ut,C[ut]),done:!1}}return ke=!0,{done:!0,value:void 0}}};return et[Symbol.iterator]=function(){return et},et}i("Array.prototype.values",function(C){return C||function(){return o(this,function(Z,de){return de})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},a=this||self;function p(C){var Z=typeof C;return Z=Z!="object"?Z:C?Array.isArray(C)?"array":Z:"null",Z=="array"||Z=="object"&&typeof C.length=="number"}function g(C){var Z=typeof C;return Z=="object"&&C!=null||Z=="function"}function v(C,Z,de){return C.call.apply(C.bind,arguments)}function w(C,Z,de){if(!C)throw Error();if(2<arguments.length){var ke=Array.prototype.slice.call(arguments,2);return function(){var et=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(et,ke),C.apply(Z,et)}}return function(){return C.apply(Z,arguments)}}function T(C,Z,de){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:w,T.apply(null,arguments)}function A(C,Z){var de=Array.prototype.slice.call(arguments,1);return function(){var ke=de.slice();return ke.push.apply(ke,arguments),C.apply(this,ke)}}function I(C,Z){function de(){}de.prototype=Z.prototype,C.aa=Z.prototype,C.prototype=new de,C.prototype.constructor=C,C.Qb=function(ke,et,ut){for(var Gt=Array(arguments.length-2),un=2;un<arguments.length;un++)Gt[un-2]=arguments[un];return Z.prototype[et].apply(ke,Gt)}}function P(C){const Z=C.length;if(0<Z){const de=Array(Z);for(let ke=0;ke<Z;ke++)de[ke]=C[ke];return de}return[]}function D(C,Z){for(let de=1;de<arguments.length;de++){const ke=arguments[de];if(p(ke)){const et=C.length||0,ut=ke.length||0;C.length=et+ut;for(let Gt=0;Gt<ut;Gt++)C[et+Gt]=ke[Gt]}else C.push(ke)}}class L{constructor(Z,de){this.i=Z,this.j=de,this.h=0,this.g=null}get(){let Z;return 0<this.h?(this.h--,Z=this.g,this.g=Z.next,Z.next=null):Z=this.i(),Z}}function O(C){return/^[\s\xa0]*$/.test(C)}function $(){var C=a.navigator;return C&&(C=C.userAgent)?C:""}function G(C){return G[" "](C),C}G[" "]=function(){};var B=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function J(C,Z,de){for(const ke in C)Z.call(de,C[ke],ke,C)}function W(C,Z){for(const de in C)Z.call(void 0,C[de],de,C)}function H(C){const Z={};for(const de in C)Z[de]=C[de];return Z}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function se(C,Z){let de,ke;for(let et=1;et<arguments.length;et++){ke=arguments[et];for(de in ke)C[de]=ke[de];for(let ut=0;ut<V.length;ut++)de=V[ut],Object.prototype.hasOwnProperty.call(ke,de)&&(C[de]=ke[de])}}function K(C){var Z=1;C=C.split(":");const de=[];for(;0<Z&&C.length;)de.push(C.shift()),Z--;return C.length&&de.push(C.join(":")),de}function ce(C){a.setTimeout(()=>{throw C},0)}function ne(){var C=Se;let Z=null;return C.g&&(Z=C.g,C.g=C.g.next,C.g||(C.h=null),Z.next=null),Z}class re{constructor(){this.h=this.g=null}add(Z,de){const ke=oe.get();ke.set(Z,de),this.h?this.h.next=ke:this.g=ke,this.h=ke}}var oe=new L(()=>new ae,C=>C.reset());class ae{constructor(){this.next=this.g=this.h=null}set(Z,de){this.h=Z,this.g=de,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,ye=!1,Se=new re,be=()=>{const C=a.Promise.resolve(void 0);xe=()=>{C.then(Ce)}};var Ce=()=>{for(var C;C=ne();){try{C.h.call(C.g)}catch(de){ce(de)}var Z=oe;Z.j(C),100>Z.h&&(Z.h++,C.next=Z.g,Z.g=C)}ye=!1};function $e(){this.s=this.s,this.C=this.C}$e.prototype.s=!1,$e.prototype.ma=function(){this.s||(this.s=!0,this.N())},$e.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ye(C,Z){this.type=C,this.g=this.target=Z,this.defaultPrevented=!1}Ye.prototype.h=function(){this.defaultPrevented=!0};var jt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var C=!1,Z=Object.defineProperty({},"passive",{get:function(){C=!0}});try{const de=()=>{};a.addEventListener("test",de,Z),a.removeEventListener("test",de,Z)}catch{}return C}();function Me(C,Z){if(Ye.call(this,C?C.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,C){var de=this.type=C.type,ke=C.changedTouches&&C.changedTouches.length?C.changedTouches[0]:null;if(this.target=C.target||C.srcElement,this.g=Z,Z=C.relatedTarget){if(B){e:{try{G(Z.nodeName);var et=!0;break e}catch{}et=!1}et||(Z=null)}}else de=="mouseover"?Z=C.fromElement:de=="mouseout"&&(Z=C.toElement);this.relatedTarget=Z,ke?(this.clientX=ke.clientX!==void 0?ke.clientX:ke.pageX,this.clientY=ke.clientY!==void 0?ke.clientY:ke.pageY,this.screenX=ke.screenX||0,this.screenY=ke.screenY||0):(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0),this.button=C.button,this.key=C.key||"",this.ctrlKey=C.ctrlKey,this.altKey=C.altKey,this.shiftKey=C.shiftKey,this.metaKey=C.metaKey,this.pointerId=C.pointerId||0,this.pointerType=typeof C.pointerType=="string"?C.pointerType:St[C.pointerType]||"",this.state=C.state,this.i=C,C.defaultPrevented&&Me.aa.h.call(this)}}I(Me,Ye);var St={2:"touch",3:"pen",4:"mouse"};Me.prototype.h=function(){Me.aa.h.call(this);var C=this.i;C.preventDefault?C.preventDefault():C.returnValue=!1};var Ct="closure_listenable_"+(1e6*Math.random()|0),Ft=0;function gt(C,Z,de,ke,et){this.listener=C,this.proxy=null,this.src=Z,this.type=de,this.capture=!!ke,this.ha=et,this.key=++Ft,this.da=this.fa=!1}function Zt(C){C.da=!0,C.listener=null,C.proxy=null,C.src=null,C.ha=null}function Tt(C){this.src=C,this.g={},this.h=0}Tt.prototype.add=function(C,Z,de,ke,et){var ut=C.toString();C=this.g[ut],C||(C=this.g[ut]=[],this.h++);var Gt=ar(C,Z,ke,et);return-1<Gt?(Z=C[Gt],de||(Z.fa=!1)):(Z=new gt(Z,this.src,ut,!!ke,et),Z.fa=de,C.push(Z)),Z};function ot(C,Z){var de=Z.type;if(de in C.g){var ke=C.g[de],et=Array.prototype.indexOf.call(ke,Z,void 0),ut;(ut=0<=et)&&Array.prototype.splice.call(ke,et,1),ut&&(Zt(Z),C.g[de].length==0&&(delete C.g[de],C.h--))}}function ar(C,Z,de,ke){for(var et=0;et<C.length;++et){var ut=C[et];if(!ut.da&&ut.listener==Z&&ut.capture==!!de&&ut.ha==ke)return et}return-1}var mt="closure_lm_"+(1e6*Math.random()|0),Lt={};function dr(C,Z,de,ke,et){if(ke&&ke.once)return ln(C,Z,de,ke,et);if(Array.isArray(Z)){for(var ut=0;ut<Z.length;ut++)dr(C,Z[ut],de,ke,et);return null}return de=In(de),C&&C[Ct]?C.K(Z,de,g(ke)?!!ke.capture:!!ke,et):Gr(C,Z,de,!1,ke,et)}function Gr(C,Z,de,ke,et,ut){if(!Z)throw Error("Invalid event type");var Gt=g(et)?!!et.capture:!!et,un=zr(C);if(un||(C[mt]=un=new Tt(C)),de=un.add(Z,de,ke,Gt,ut),de.proxy)return de;if(ke=qr(),de.proxy=ke,ke.src=C,ke.listener=de,C.addEventListener)jt||(et=Gt),et===void 0&&(et=!1),C.addEventListener(Z.toString(),ke,et);else if(C.attachEvent)C.attachEvent(Jt(Z.toString()),ke);else if(C.addListener&&C.removeListener)C.addListener(ke);else throw Error("addEventListener and attachEvent are unavailable.");return de}function qr(){function C(de){return Z.call(C.src,C.listener,de)}const Z=tr;return C}function ln(C,Z,de,ke,et){if(Array.isArray(Z)){for(var ut=0;ut<Z.length;ut++)ln(C,Z[ut],de,ke,et);return null}return de=In(de),C&&C[Ct]?C.L(Z,de,g(ke)?!!ke.capture:!!ke,et):Gr(C,Z,de,!0,ke,et)}function Ui(C,Z,de,ke,et){if(Array.isArray(Z))for(var ut=0;ut<Z.length;ut++)Ui(C,Z[ut],de,ke,et);else ke=g(ke)?!!ke.capture:!!ke,de=In(de),C&&C[Ct]?(C=C.i,Z=String(Z).toString(),Z in C.g&&(ut=C.g[Z],de=ar(ut,de,ke,et),-1<de&&(Zt(ut[de]),Array.prototype.splice.call(ut,de,1),ut.length==0&&(delete C.g[Z],C.h--)))):C&&(C=zr(C))&&(Z=C.g[Z.toString()],C=-1,Z&&(C=ar(Z,de,ke,et)),(de=-1<C?Z[C]:null)&&ht(de))}function ht(C){if(typeof C!="number"&&C&&!C.da){var Z=C.src;if(Z&&Z[Ct])ot(Z.i,C);else{var de=C.type,ke=C.proxy;Z.removeEventListener?Z.removeEventListener(de,ke,C.capture):Z.detachEvent?Z.detachEvent(Jt(de),ke):Z.addListener&&Z.removeListener&&Z.removeListener(ke),(de=zr(Z))?(ot(de,C),de.h==0&&(de.src=null,Z[mt]=null)):Zt(C)}}}function Jt(C){return C in Lt?Lt[C]:Lt[C]="on"+C}function tr(C,Z){if(C.da)C=!0;else{Z=new Me(Z,this);var de=C.listener,ke=C.ha||C.src;C.fa&&ht(C),C=de.call(ke,Z)}return C}function zr(C){return C=C[mt],C instanceof Tt?C:null}var yr="__closure_events_fn_"+(1e9*Math.random()>>>0);function In(C){return typeof C=="function"?C:(C[yr]||(C[yr]=function(Z){return C.handleEvent(Z)}),C[yr])}function Cr(){$e.call(this),this.i=new Tt(this),this.M=this,this.F=null}I(Cr,$e),Cr.prototype[Ct]=!0,Cr.prototype.removeEventListener=function(C,Z,de,ke){Ui(this,C,Z,de,ke)};function hn(C,Z){var de,ke=C.F;if(ke)for(de=[];ke;ke=ke.F)de.push(ke);if(C=C.M,ke=Z.type||Z,typeof Z=="string")Z=new Ye(Z,C);else if(Z instanceof Ye)Z.target=Z.target||C;else{var et=Z;Z=new Ye(ke,C),se(Z,et)}if(et=!0,de)for(var ut=de.length-1;0<=ut;ut--){var Gt=Z.g=de[ut];et=fs(Gt,ke,!0,Z)&&et}if(Gt=Z.g=C,et=fs(Gt,ke,!0,Z)&&et,et=fs(Gt,ke,!1,Z)&&et,de)for(ut=0;ut<de.length;ut++)Gt=Z.g=de[ut],et=fs(Gt,ke,!1,Z)&&et}Cr.prototype.N=function(){if(Cr.aa.N.call(this),this.i){var C=this.i,Z;for(Z in C.g){for(var de=C.g[Z],ke=0;ke<de.length;ke++)Zt(de[ke]);delete C.g[Z],C.h--}}this.F=null},Cr.prototype.K=function(C,Z,de,ke){return this.i.add(String(C),Z,!1,de,ke)},Cr.prototype.L=function(C,Z,de,ke){return this.i.add(String(C),Z,!0,de,ke)};function fs(C,Z,de,ke){if(Z=C.i.g[String(Z)],!Z)return!0;Z=Z.concat();for(var et=!0,ut=0;ut<Z.length;++ut){var Gt=Z[ut];if(Gt&&!Gt.da&&Gt.capture==de){var un=Gt.listener,$i=Gt.ha||Gt.src;Gt.fa&&ot(C.i,Gt),et=un.call($i,ke)!==!1&&et}}return et&&!ke.defaultPrevented}function ps(C,Z,de){if(typeof C=="function")de&&(C=T(C,de));else if(C&&typeof C.handleEvent=="function")C=T(C.handleEvent,C);else throw Error("Invalid listener argument");return 2147483647<Number(Z)?-1:a.setTimeout(C,Z||0)}function Os(C){C.g=ps(()=>{C.g=null,C.i&&(C.i=!1,Os(C))},C.l);const Z=C.h;C.h=null,C.m.apply(null,Z)}class Do extends $e{constructor(Z,de){super(),this.m=Z,this.l=de,this.h=null,this.i=!1,this.g=null}j(Z){this.h=arguments,this.g?this.i=!0:Os(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function va(C){$e.call(this),this.h=C,this.g={}}I(va,$e);var qa=[];function ms(C){J(C.g,function(Z,de){this.g.hasOwnProperty(de)&&ht(Z)},C),C.g={}}va.prototype.N=function(){va.aa.N.call(this),ms(this)},va.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ga=a.JSON.stringify,oo=a.JSON.parse,_l=class{stringify(C){return a.JSON.stringify(C,void 0)}parse(C){return a.JSON.parse(C,void 0)}};function De(){}De.prototype.h=null;function pe(C){return C.h||(C.h=C.i())}function le(){}var Ne={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ze(){Ye.call(this,"d")}I(ze,Ye);function Ge(){Ye.call(this,"c")}I(Ge,Ye);var Ze={},Xe=null;function We(){return Xe=Xe||new Cr}Ze.La="serverreachability";function it(C){Ye.call(this,Ze.La,C)}I(it,Ye);function It(C){const Z=We();hn(Z,new it(Z))}Ze.STAT_EVENT="statevent";function zt(C,Z){Ye.call(this,Ze.STAT_EVENT,C),this.stat=Z}I(zt,Ye);function vt(C){const Z=We();hn(Z,new zt(Z,C))}Ze.Ma="timingevent";function xr(C,Z){Ye.call(this,Ze.Ma,C),this.size=Z}I(xr,Ye);function vr(C,Z){if(typeof C!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){C()},Z)}function mr(){this.g=!0}mr.prototype.xa=function(){this.g=!1};function Pr(C,Z,de,ke,et,ut){C.info(function(){if(C.g)if(ut)for(var Gt="",un=ut.split("&"),$i=0;$i<un.length;$i++){var Qr=un[$i].split("=");if(1<Qr.length){var Wi=Qr[0];Qr=Qr[1];var Ii=Wi.split("_");Gt=2<=Ii.length&&Ii[1]=="type"?Gt+(Wi+"="+Qr+"&"):Gt+(Wi+"=redacted&")}}else Gt=null;else Gt=ut;return"XMLHTTP REQ ("+ke+") [attempt "+et+"]: "+Z+`
`+de+`
`+Gt})}function $r(C,Z,de,ke,et,ut,Gt){C.info(function(){return"XMLHTTP RESP ("+ke+") [ attempt "+et+"]: "+Z+`
`+de+`
`+ut+" "+Gt})}function nn(C,Z,de,ke){C.info(function(){return"XMLHTTP TEXT ("+Z+"): "+qi(C,de)+(ke?" "+ke:"")})}function Yn(C,Z){C.info(function(){return"TIMEOUT: "+Z})}mr.prototype.info=function(){};function qi(C,Z){if(!C.g)return Z;if(!Z)return null;try{var de=JSON.parse(Z);if(de){for(C=0;C<de.length;C++)if(Array.isArray(de[C])){var ke=de[C];if(!(2>ke.length)){var et=ke[1];if(Array.isArray(et)&&!(1>et.length)){var ut=et[0];if(ut!="noop"&&ut!="stop"&&ut!="close")for(var Gt=1;Gt<et.length;Gt++)et[Gt]=""}}}}return Ga(de)}catch{return Z}}var zn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},li;function Pi(){}I(Pi,De),Pi.prototype.g=function(){return new XMLHttpRequest},Pi.prototype.i=function(){return{}},li=new Pi;function Pa(C,Z,de,ke){this.j=C,this.i=Z,this.l=de,this.R=ke||1,this.U=new va(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new tm}function tm(){this.i=null,this.g="",this.h=!1}var yf={},Wr={};function mu(C,Z,de){C.L=1,C.v=aa(yi(Z)),C.m=de,C.P=!0,mc(C,null)}function mc(C,Z){C.F=Date.now(),Ia(C),C.A=yi(C.v);var de=C.A,ke=C.R;Array.isArray(ke)||(ke=[String(ke)]),$n(de.i,"t",ke),C.C=0,de=C.j.J,C.h=new tm,C.g=Su(C.j,de?Z:null,!C.m),0<C.O&&(C.M=new Do(T(C.Y,C,C.g),C.O)),Z=C.U,de=C.g,ke=C.ca;var et="readystatechange";Array.isArray(et)||(et&&(qa[0]=et.toString()),et=qa);for(var ut=0;ut<et.length;ut++){var Gt=dr(de,et[ut],ke||Z.handleEvent,!1,Z.h||Z);if(!Gt)break;Z.g[Gt.key]=Gt}Z=C.H?H(C.H):{},C.m?(C.u||(C.u="POST"),Z["Content-Type"]="application/x-www-form-urlencoded",C.g.ea(C.A,C.u,C.m,Z)):(C.u="GET",C.g.ea(C.A,C.u,null,Z)),It(),Pr(C.i,C.u,C.A,C.l,C.R,C.m)}Pa.prototype.ca=function(C){C=C.target;const Z=this.M;Z&&zi(C)==3?Z.j():this.Y(C)},Pa.prototype.Y=function(C){try{if(C==this.g)e:{const Ii=zi(this.g);var Z=this.g.Ba();const Vo=this.g.Z();if(!(3>Ii)&&(Ii!=3||this.g&&(this.h.h||this.g.oa()||wc(this.g)))){this.J||Ii!=4||Z==7||(Z==8||0>=Vo?It(3):It(2)),gu(this);var de=this.g.Z();this.X=de;t:if(Sd(this)){var ke=wc(this.g);C="";var et=ke.length,ut=zi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ma(this),bl(this);var Gt="";break t}this.h.i=new a.TextDecoder}for(Z=0;Z<et;Z++)this.h.h=!0,C+=this.h.i.decode(ke[Z],{stream:!(ut&&Z==et-1)});ke.length=0,this.h.g+=C,this.C=0,Gt=this.h.g}else Gt=this.g.oa();if(this.o=de==200,$r(this.i,this.u,this.A,this.l,this.R,Ii,de),this.o){if(this.T&&!this.K){t:{if(this.g){var un,$i=this.g;if((un=$i.g?$i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(un)){var Qr=un;break t}}Qr=null}if(de=Qr)nn(this.i,this.l,de,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ys(this,de);else{this.o=!1,this.s=3,vt(12),Ma(this),bl(this);break e}}if(this.P){de=!0;let Da;for(;!this.J&&this.C<Gt.length;)if(Da=Ed(this,Gt),Da==Wr){Ii==4&&(this.s=4,vt(14),de=!1),nn(this.i,this.l,null,"[Incomplete Response]");break}else if(Da==yf){this.s=4,vt(15),nn(this.i,this.l,Gt,"[Invalid Chunk]"),de=!1;break}else nn(this.i,this.l,Da,null),ys(this,Da);if(Sd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ii!=4||Gt.length!=0||this.h.h||(this.s=1,vt(16),de=!1),this.o=this.o&&de,!de)nn(this.i,this.l,Gt,"[Invalid Chunked Response]"),Ma(this),bl(this);else if(0<Gt.length&&!this.W){this.W=!0;var Wi=this.j;Wi.g==this&&Wi.ba&&!Wi.M&&(Wi.j.info("Great, no buffering proxy detected. Bytes received: "+Gt.length),ku(Wi),Wi.M=!0,vt(11))}}else nn(this.i,this.l,Gt,null),ys(this,Gt);Ii==4&&Ma(this),this.o&&!this.J&&(Ii==4?Al(this.j,this):(this.o=!1,Ia(this)))}else ho(this.g),de==400&&0<Gt.indexOf("Unknown SID")?(this.s=3,vt(12)):(this.s=0,vt(13)),Ma(this),bl(this)}}}catch{}finally{}};function Sd(C){return C.g?C.u=="GET"&&C.L!=2&&C.j.Ca:!1}function Ed(C,Z){var de=C.C,ke=Z.indexOf(`
`,de);return ke==-1?Wr:(de=Number(Z.substring(de,ke)),isNaN(de)?yf:(ke+=1,ke+de>Z.length?Wr:(Z=Z.slice(ke,ke+de),C.C=ke+de,Z)))}Pa.prototype.cancel=function(){this.J=!0,Ma(this)};function Ia(C){C.S=Date.now()+C.I,Rs(C,C.I)}function Rs(C,Z){if(C.B!=null)throw Error("WatchDog timer not null");C.B=vr(T(C.ba,C),Z)}function gu(C){C.B&&(a.clearTimeout(C.B),C.B=null)}Pa.prototype.ba=function(){this.B=null;const C=Date.now();0<=C-this.S?(Yn(this.i,this.A),this.L!=2&&(It(),vt(17)),Ma(this),this.s=2,bl(this)):Rs(this,this.S-C)};function bl(C){C.j.G==0||C.J||Al(C.j,C)}function Ma(C){gu(C);var Z=C.M;Z&&typeof Z.ma=="function"&&Z.ma(),C.M=null,ms(C.U),C.g&&(Z=C.g,C.g=null,Z.abort(),Z.ma())}function ys(C,Z){try{var de=C.j;if(de.G!=0&&(de.g==C||ci(de.h,C))){if(!C.K&&ci(de.h,C)&&de.G==3){try{var ke=de.Da.g.parse(Z)}catch{ke=null}if(Array.isArray(ke)&&ke.length==3){var et=ke;if(et[0]==0){e:if(!de.u){if(de.g)if(de.g.F+3e3<C.F)Tc(de),bu(de);else break e;Md(de),vt(18)}}else de.za=et[1],0<de.za-de.T&&37500>et[2]&&de.F&&de.v==0&&!de.C&&(de.C=vr(T(de.Za,de),6e3));if(1>=qn(de.h)&&de.ca){try{de.ca()}catch{}de.ca=void 0}}else Ha(de,11)}else if((C.K||de.g==C)&&Tc(de),!O(Z))for(et=de.Da.g.parse(Z),Z=0;Z<et.length;Z++){let Qr=et[Z];if(de.T=Qr[0],Qr=Qr[1],de.G==2)if(Qr[0]=="c"){de.K=Qr[1],de.ia=Qr[2];const Wi=Qr[3];Wi!=null&&(de.la=Wi,de.j.info("VER="+de.la));const Ii=Qr[4];Ii!=null&&(de.Aa=Ii,de.j.info("SVER="+de.Aa));const Vo=Qr[5];Vo!=null&&typeof Vo=="number"&&0<Vo&&(ke=1.5*Vo,de.L=ke,de.j.info("backChannelRequestTimeoutMs_="+ke)),ke=de;const Da=C.g;if(Da){const Nl=Da.g?Da.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Nl){var ut=ke.h;ut.g||Nl.indexOf("spdy")==-1&&Nl.indexOf("quic")==-1&&Nl.indexOf("h2")==-1||(ut.j=ut.l,ut.g=new Set,ut.h&&(jd(ut,ut.h),ut.h=null))}if(ke.D){const Od=Da.g?Da.g.getResponseHeader("X-HTTP-Session-Id"):null;Od&&(ke.ya=Od,tn(ke.I,ke.D,Od))}}de.G=3,de.l&&de.l.ua(),de.ba&&(de.R=Date.now()-C.F,de.j.info("Handshake RTT: "+de.R+"ms")),ke=de;var Gt=C;if(ke.qa=Fo(ke,ke.J?ke.ia:null,ke.W),Gt.K){xs(ke.h,Gt);var un=Gt,$i=ke.L;$i&&(un.I=$i),un.B&&(gu(un),Ia(un)),ke.g=Gt}else Id(ke);0<de.i.length&&kc(de)}else Qr[0]!="stop"&&Qr[0]!="close"||Ha(de,7);else de.G==3&&(Qr[0]=="stop"||Qr[0]=="close"?Qr[0]=="stop"?Ha(de,7):El(de):Qr[0]!="noop"&&de.l&&de.l.ta(Qr),de.v=0)}}It(4)}catch{}}var yu=class{constructor(C,Z){this.g=C,this.map=Z}};function lt(C){this.l=C||10,a.PerformanceNavigationTiming?(C=a.performance.getEntriesByType("navigation"),C=0<C.length&&(C[0].nextHopProtocol=="hq"||C[0].nextHopProtocol=="h2")):C=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=C?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ls(C){return C.h?!0:C.g?C.g.size>=C.j:!1}function qn(C){return C.h?1:C.g?C.g.size:0}function ci(C,Z){return C.h?C.h==Z:C.g?C.g.has(Z):!1}function jd(C,Z){C.g?C.g.add(Z):C.h=Z}function xs(C,Z){C.h&&C.h==Z?C.h=null:C.g&&C.g.has(Z)&&C.g.delete(Z)}lt.prototype.cancel=function(){if(this.i=Ad(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const C of this.g.values())C.cancel();this.g.clear()}};function Ad(C){if(C.h!=null)return C.i.concat(C.h.D);if(C.g!=null&&C.g.size!==0){let Z=C.i;for(const de of C.g.values())Z=Z.concat(de.D);return Z}return P(C.i)}function rm(C){if(C.V&&typeof C.V=="function")return C.V();if(typeof Map<"u"&&C instanceof Map||typeof Set<"u"&&C instanceof Set)return Array.from(C.values());if(typeof C=="string")return C.split("");if(p(C)){for(var Z=[],de=C.length,ke=0;ke<de;ke++)Z.push(C[ke]);return Z}Z=[],de=0;for(ke in C)Z[de++]=C[ke];return Z}function gc(C){if(C.na&&typeof C.na=="function")return C.na();if(!C.V||typeof C.V!="function"){if(typeof Map<"u"&&C instanceof Map)return Array.from(C.keys());if(!(typeof Set<"u"&&C instanceof Set)){if(p(C)||typeof C=="string"){var Z=[];C=C.length;for(var de=0;de<C;de++)Z.push(de);return Z}Z=[],de=0;for(const ke in C)Z[de++]=ke;return Z}}}function qt(C,Z){if(C.forEach&&typeof C.forEach=="function")C.forEach(Z,void 0);else if(p(C)||typeof C=="string")Array.prototype.forEach.call(C,Z,void 0);else for(var de=gc(C),ke=rm(C),et=ke.length,ut=0;ut<et;ut++)Z.call(void 0,ke[ut],de&&de[ut],C)}var Dr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mr(C,Z){if(C){C=C.split("&");for(var de=0;de<C.length;de++){var ke=C[de].indexOf("="),et=null;if(0<=ke){var ut=C[de].substring(0,ke);et=C[de].substring(ke+1)}else ut=C[de];Z(ut,et?decodeURIComponent(et.replace(/\+/g," ")):"")}}}function gi(C){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,C instanceof gi){this.h=C.h,Sr(this,C.j),this.o=C.o,this.g=C.g,Gi(this,C.s),this.l=C.l;var Z=C.i,de=new co;de.i=Z.i,Z.g&&(de.g=new Map(Z.g),de.h=Z.h),yc(this,de),this.m=C.m}else C&&(Z=String(C).match(Dr))?(this.h=!1,Sr(this,Z[1]||"",!0),this.o=an(Z[2]||""),this.g=an(Z[3]||"",!0),Gi(this,Z[4]),this.l=an(Z[5]||"",!0),yc(this,Z[6]||"",!0),this.m=an(Z[7]||"")):(this.h=!1,this.i=new co(null,this.h))}gi.prototype.toString=function(){var C=[],Z=this.j;Z&&C.push(xc(Z,vc,!0),":");var de=this.g;return(de||Z=="file")&&(C.push("//"),(Z=this.o)&&C.push(xc(Z,vc,!0),"@"),C.push(encodeURIComponent(String(de)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),de=this.s,de!=null&&C.push(":",String(de))),(de=this.l)&&(this.g&&de.charAt(0)!="/"&&C.push("/"),C.push(xc(de,de.charAt(0)=="/"?xf:xu,!0))),(de=this.i.toString())&&C.push("?",de),(de=this.m)&&C.push("#",xc(de,vu)),C.join("")};function yi(C){return new gi(C)}function Sr(C,Z,de){C.j=de?an(Z,!0):Z,C.j&&(C.j=C.j.replace(/:$/,""))}function Gi(C,Z){if(Z){if(Z=Number(Z),isNaN(Z)||0>Z)throw Error("Bad port number "+Z);C.s=Z}else C.s=null}function yc(C,Z,de){Z instanceof co?(C.i=Z,vf(C.i,C.h)):(de||(Z=xc(Z,nm)),C.i=new co(Z,C.h))}function tn(C,Z,de){C.i.set(Z,de)}function aa(C){return tn(C,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),C}function an(C,Z){return C?Z?decodeURI(C.replace(/%25/g,"%2525")):decodeURIComponent(C):""}function xc(C,Z,de){return typeof C=="string"?(C=encodeURI(C).replace(Z,lo),de&&(C=C.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C):null}function lo(C){return C=C.charCodeAt(0),"%"+(C>>4&15).toString(16)+(C&15).toString(16)}var vc=/[#\/\?@]/g,xu=/[#\?:]/g,xf=/[#\?]/g,nm=/[#\?@]/g,vu=/#/g;function co(C,Z){this.h=this.g=null,this.i=C||null,this.j=!!Z}function vs(C){C.g||(C.g=new Map,C.h=0,C.i&&Mr(C.i,function(Z,de){C.add(decodeURIComponent(Z.replace(/\+/g," ")),de)}))}t=co.prototype,t.add=function(C,Z){vs(this),this.i=null,C=Oo(this,C);var de=this.g.get(C);return de||this.g.set(C,de=[]),de.push(Z),this.h+=1,this};function wl(C,Z){vs(C),Z=Oo(C,Z),C.g.has(Z)&&(C.i=null,C.h-=C.g.get(Z).length,C.g.delete(Z))}function sa(C,Z){return vs(C),Z=Oo(C,Z),C.g.has(Z)}t.forEach=function(C,Z){vs(this),this.g.forEach(function(de,ke){de.forEach(function(et){C.call(Z,et,ke,this)},this)},this)},t.na=function(){vs(this);const C=Array.from(this.g.values()),Z=Array.from(this.g.keys()),de=[];for(let ke=0;ke<Z.length;ke++){const et=C[ke];for(let ut=0;ut<et.length;ut++)de.push(Z[ke])}return de},t.V=function(C){vs(this);let Z=[];if(typeof C=="string")sa(this,C)&&(Z=Z.concat(this.g.get(Oo(this,C))));else{C=Array.from(this.g.values());for(let de=0;de<C.length;de++)Z=Z.concat(C[de])}return Z},t.set=function(C,Z){return vs(this),this.i=null,C=Oo(this,C),sa(this,C)&&(this.h-=this.g.get(C).length),this.g.set(C,[Z]),this.h+=1,this},t.get=function(C,Z){return C?(C=this.V(C),0<C.length?String(C[0]):Z):Z};function $n(C,Z,de){wl(C,Z),0<de.length&&(C.i=null,C.g.set(Oo(C,Z),P(de)),C.h+=de.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const C=[],Z=Array.from(this.g.keys());for(var de=0;de<Z.length;de++){var ke=Z[de];const ut=encodeURIComponent(String(ke)),Gt=this.V(ke);for(ke=0;ke<Gt.length;ke++){var et=ut;Gt[ke]!==""&&(et+="="+encodeURIComponent(String(Gt[ke]))),C.push(et)}}return this.i=C.join("&")};function Oo(C,Z){return Z=String(Z),C.j&&(Z=Z.toLowerCase()),Z}function vf(C,Z){Z&&!C.j&&(vs(C),C.i=null,C.g.forEach(function(de,ke){var et=ke.toLowerCase();ke!=et&&(wl(this,ke),$n(this,et,de))},C)),C.j=Z}function _a(C,Z){const de=new mr;if(a.Image){const ke=new Image;ke.onload=A(uo,de,"TestLoadImage: loaded",!0,Z,ke),ke.onerror=A(uo,de,"TestLoadImage: error",!1,Z,ke),ke.onabort=A(uo,de,"TestLoadImage: abort",!1,Z,ke),ke.ontimeout=A(uo,de,"TestLoadImage: timeout",!1,Z,ke),a.setTimeout(function(){ke.ontimeout&&ke.ontimeout()},1e4),ke.src=C}else Z(!1)}function Wa(C,Z){const de=new mr,ke=new AbortController,et=setTimeout(()=>{ke.abort(),uo(de,"TestPingServer: timeout",!1,Z)},1e4);fetch(C,{signal:ke.signal}).then(ut=>{clearTimeout(et),ut.ok?uo(de,"TestPingServer: ok",!0,Z):uo(de,"TestPingServer: server error",!1,Z)}).catch(()=>{clearTimeout(et),uo(de,"TestPingServer: error",!1,Z)})}function uo(C,Z,de,ke,et){try{et&&(et.onload=null,et.onerror=null,et.onabort=null,et.ontimeout=null),ke(de)}catch{}}function _u(){this.g=new _l}function Fn(C,Z,de){const ke=de||"";try{qt(C,function(et,ut){let Gt=et;g(et)&&(Gt=Ga(et)),Z.push(ke+ut+"="+encodeURIComponent(Gt))})}catch(et){throw Z.push(ke+"type="+encodeURIComponent("_badmap")),et}}function Ro(C){this.l=C.Ub||null,this.j=C.eb||!1}I(Ro,De),Ro.prototype.g=function(){return new _c(this.l,this.j)},Ro.prototype.i=function(C){return function(){return C}}({});function _c(C,Z){Cr.call(this),this.D=C,this.o=Z,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}I(_c,Cr),t=_c.prototype,t.open=function(C,Z){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=C,this.A=Z,this.readyState=1,kl(this)},t.send=function(C){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const Z={headers:this.u,method:this.B,credentials:this.m,cache:void 0};C&&(Z.body=C),(this.D||a).fetch(new Request(this.A,Z)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jn(this)),this.readyState=0},t.Sa=function(C){if(this.g&&(this.l=C,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=C.headers,this.readyState=2,kl(this)),this.g&&(this.readyState=3,kl(this),this.g)))if(this.responseType==="arraybuffer")C.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in C){if(this.j=C.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lo(this)}else C.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lo(C){C.j.read().then(C.Pa.bind(C)).catch(C.ga.bind(C))}t.Pa=function(C){if(this.g){if(this.o&&C.value)this.response.push(C.value);else if(!this.o){var Z=C.value?C.value:new Uint8Array(0);(Z=this.v.decode(Z,{stream:!C.done}))&&(this.response=this.responseText+=Z)}C.done?Jn(this):kl(this),this.readyState==3&&Lo(this)}},t.Ra=function(C){this.g&&(this.response=this.responseText=C,Jn(this))},t.Qa=function(C){this.g&&(this.response=C,Jn(this))},t.ga=function(){this.g&&Jn(this)};function Jn(C){C.readyState=4,C.l=null,C.j=null,C.v=null,kl(C)}t.setRequestHeader=function(C,Z){this.u.append(C,Z)},t.getResponseHeader=function(C){return this.h&&this.h.get(C.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const C=[],Z=this.h.entries();for(var de=Z.next();!de.done;)de=de.value,C.push(de[0]+": "+de[1]),de=Z.next();return C.join(`\r
`)};function kl(C){C.onreadystatechange&&C.onreadystatechange.call(C)}Object.defineProperty(_c.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(C){this.m=C?"include":"same-origin"}});function Nd(C){let Z="";return J(C,function(de,ke){Z+=ke,Z+=":",Z+=de,Z+=`\r
`}),Z}function _s(C,Z,de){e:{for(ke in de){var ke=!1;break e}ke=!0}ke||(de=Nd(de),typeof C=="string"?de!=null&&encodeURIComponent(String(de)):tn(C,Z,de))}function cn(C){Cr.call(this),this.headers=new Map,this.o=C||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}I(cn,Cr);var Cd=/^https?$/i,dy=["POST","PUT"];t=cn.prototype,t.Ha=function(C){this.J=C},t.ea=function(C,Z,de,ke){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+C);Z=Z?Z.toUpperCase():"GET",this.D=C,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():li.g(),this.v=this.o?pe(this.o):pe(li),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(Z,String(C),!0),this.B=!1}catch(ut){Pd(this,ut);return}if(C=de||"",de=new Map(this.headers),ke)if(Object.getPrototypeOf(ke)===Object.prototype)for(var et in ke)de.set(et,ke[et]);else if(typeof ke.keys=="function"&&typeof ke.get=="function")for(const ut of ke.keys())de.set(ut,ke.get(ut));else throw Error("Unknown input type for opt_headers: "+String(ke));ke=Array.from(de.keys()).find(ut=>ut.toLowerCase()=="content-type"),et=a.FormData&&C instanceof a.FormData,!(0<=Array.prototype.indexOf.call(dy,Z,void 0))||ke||et||de.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ut,Gt]of de)this.g.setRequestHeader(ut,Gt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zo(this),this.u=!0,this.g.send(C),this.u=!1}catch(ut){Pd(this,ut)}};function Pd(C,Z){C.h=!1,C.g&&(C.j=!0,C.g.abort(),C.j=!1),C.l=Z,C.m=5,Tl(C),bc(C)}function Tl(C){C.A||(C.A=!0,hn(C,"complete"),hn(C,"error"))}t.abort=function(C){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=C||7,hn(this,"complete"),hn(this,"abort"),bc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bc(this,!0)),cn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?bs(this):this.bb())},t.bb=function(){bs(this)};function bs(C){if(C.h&&typeof u<"u"&&(!C.v[1]||zi(C)!=4||C.Z()!=2)){if(C.u&&zi(C)==4)ps(C.Ea,0,C);else if(hn(C,"readystatechange"),zi(C)==4){C.h=!1;try{const Gt=C.Z();e:switch(Gt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var Z=!0;break e;default:Z=!1}var de;if(!(de=Z)){var ke;if(ke=Gt===0){var et=String(C.D).match(Dr)[1]||null;!et&&a.self&&a.self.location&&(et=a.self.location.protocol.slice(0,-1)),ke=!Cd.test(et?et.toLowerCase():"")}de=ke}if(de)hn(C,"complete"),hn(C,"success");else{C.m=6;try{var ut=2<zi(C)?C.g.statusText:""}catch{ut=""}C.l=ut+" ["+C.Z()+"]",Tl(C)}}finally{bc(C)}}}}function bc(C,Z){if(C.g){zo(C);const de=C.g,ke=C.v[0]?()=>{}:null;C.g=null,C.v=null,Z||hn(C,"ready");try{de.onreadystatechange=ke}catch{}}}function zo(C){C.I&&(a.clearTimeout(C.I),C.I=null)}t.isActive=function(){return!!this.g};function zi(C){return C.g?C.g.readyState:0}t.Z=function(){try{return 2<zi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(C){if(this.g){var Z=this.g.responseText;return C&&Z.indexOf(C)==0&&(Z=Z.substring(C.length)),oo(Z)}};function wc(C){try{if(!C.g)return null;if("response"in C.g)return C.g.response;switch(C.H){case"":case"text":return C.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in C.g)return C.g.mozResponseArrayBuffer}return null}catch{return null}}function ho(C){const Z={};C=(C.g&&2<=zi(C)&&C.g.getAllResponseHeaders()||"").split(`\r
`);for(let ke=0;ke<C.length;ke++){if(O(C[ke]))continue;var de=K(C[ke]);const et=de[0];if(de=de[1],typeof de!="string")continue;de=de.trim();const ut=Z[et]||[];Z[et]=ut,ut.push(de)}W(Z,function(ke){return ke.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $o(C,Z,de){return de&&de.internalChannelParams&&de.internalChannelParams[C]||Z}function Sl(C){this.Aa=0,this.i=[],this.j=new mr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$o("failFast",!1,C),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$o("baseRetryDelayMs",5e3,C),this.cb=$o("retryDelaySeedMs",1e4,C),this.Wa=$o("forwardChannelMaxRetries",2,C),this.wa=$o("forwardChannelRequestTimeoutMs",2e4,C),this.pa=C&&C.xmlHttpFactory||void 0,this.Xa=C&&C.Tb||void 0,this.Ca=C&&C.useFetchStreams||!1,this.L=void 0,this.J=C&&C.supportsCrossDomainXhr||!1,this.K="",this.h=new lt(C&&C.concurrentRequestLimit),this.Da=new _u,this.P=C&&C.fastHandshake||!1,this.O=C&&C.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=C&&C.Rb||!1,C&&C.xa&&this.j.xa(),C&&C.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&C&&C.detectBufferingProxy||!1,this.ja=void 0,C&&C.longPollingTimeout&&0<C.longPollingTimeout&&(this.ja=C.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Sl.prototype,t.la=8,t.G=1,t.connect=function(C,Z,de,ke){vt(0),this.W=C,this.H=Z||{},de&&ke!==void 0&&(this.H.OSID=de,this.H.OAID=ke),this.F=this.X,this.I=Fo(this,null,this.W),kc(this)};function El(C){if(wu(C),C.G==3){var Z=C.U++,de=yi(C.I);if(tn(de,"SID",C.K),tn(de,"RID",Z),tn(de,"TYPE","terminate"),Vr(C,de),Z=new Pa(C,C.j,Z),Z.L=2,Z.v=aa(yi(de)),de=!1,a.navigator&&a.navigator.sendBeacon)try{de=a.navigator.sendBeacon(Z.v.toString(),"")}catch{}!de&&a.Image&&(new Image().src=Z.v,de=!0),de||(Z.g=Su(Z.j,null),Z.g.ea(Z.v)),Z.F=Date.now(),Ia(Z)}zs(C)}function bu(C){C.g&&(ku(C),C.g.cancel(),C.g=null)}function wu(C){bu(C),C.u&&(a.clearTimeout(C.u),C.u=null),Tc(C),C.h.cancel(),C.s&&(typeof C.s=="number"&&a.clearTimeout(C.s),C.s=null)}function kc(C){if(!Ls(C.h)&&!C.s){C.s=!0;var Z=C.Ga;xe||be(),ye||(xe(),ye=!0),Se.add(Z,C),C.B=0}}function _f(C,Z){return qn(C.h)>=C.h.j-(C.s?1:0)?!1:C.s?(C.i=Z.D.concat(C.i),!0):C.G==1||C.G==2||C.B>=(C.Va?0:C.Wa)?!1:(C.s=vr(T(C.Ga,C,Z),Tu(C,C.B)),C.B++,!0)}t.Ga=function(C){if(this.s)if(this.s=null,this.G==1){if(!C){this.U=Math.floor(1e5*Math.random()),C=this.U++;const et=new Pa(this,this.j,C);let ut=this.o;if(this.S&&(ut?(ut=H(ut),se(ut,this.S)):ut=this.S),this.m!==null||this.O||(et.H=ut,ut=null),this.P)e:{for(var Z=0,de=0;de<this.i.length;de++){t:{var ke=this.i[de];if("__data__"in ke.map&&(ke=ke.map.__data__,typeof ke=="string")){ke=ke.length;break t}ke=void 0}if(ke===void 0)break;if(Z+=ke,4096<Z){Z=de;break e}if(Z===4096||de===this.i.length-1){Z=de+1;break e}}Z=1e3}else Z=1e3;Z=im(this,et,Z),de=yi(this.I),tn(de,"RID",C),tn(de,"CVER",22),this.D&&tn(de,"X-HTTP-Session-Id",this.D),Vr(this,de),ut&&(this.O?Z="headers="+encodeURIComponent(String(Nd(ut)))+"&"+Z:this.m&&_s(de,this.m,ut)),jd(this.h,et),this.Ua&&tn(de,"TYPE","init"),this.P?(tn(de,"$req",Z),tn(de,"SID","null"),et.T=!0,mu(et,de,null)):mu(et,de,Z),this.G=2}}else this.G==3&&(C?jl(this,C):this.i.length==0||Ls(this.h)||jl(this))};function jl(C,Z){var de;Z?de=Z.l:de=C.U++;const ke=yi(C.I);tn(ke,"SID",C.K),tn(ke,"RID",de),tn(ke,"AID",C.T),Vr(C,ke),C.m&&C.o&&_s(ke,C.m,C.o),de=new Pa(C,C.j,de,C.B+1),C.m===null&&(de.H=C.o),Z&&(C.i=Z.D.concat(C.i)),Z=im(C,de,1e3),de.I=Math.round(.5*C.wa)+Math.round(.5*C.wa*Math.random()),jd(C.h,de),mu(de,ke,Z)}function Vr(C,Z){C.H&&J(C.H,function(de,ke){tn(Z,ke,de)}),C.l&&qt({},function(de,ke){tn(Z,ke,de)})}function im(C,Z,de){de=Math.min(C.i.length,de);var ke=C.l?T(C.l.Na,C.l,C):null;e:{var et=C.i;let ut=-1;for(;;){const Gt=["count="+de];ut==-1?0<de?(ut=et[0].g,Gt.push("ofs="+ut)):ut=0:Gt.push("ofs="+ut);let un=!0;for(let $i=0;$i<de;$i++){let Qr=et[$i].g;const Wi=et[$i].map;if(Qr-=ut,0>Qr)ut=Math.max(0,et[$i].g-100),un=!1;else try{Fn(Wi,Gt,"req"+Qr+"_")}catch{ke&&ke(Wi)}}if(un){ke=Gt.join("&");break e}}}return C=C.i.splice(0,de),Z.D=C,ke}function Id(C){if(!C.g&&!C.u){C.Y=1;var Z=C.Fa;xe||be(),ye||(xe(),ye=!0),Se.add(Z,C),C.v=0}}function Md(C){return C.g||C.u||3<=C.v?!1:(C.Y++,C.u=vr(T(C.Fa,C),Tu(C,C.v)),C.v++,!0)}t.Fa=function(){if(this.u=null,bf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var C=2*this.R;this.j.info("BP detection timer enabled: "+C),this.A=vr(T(this.ab,this),C)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,vt(10),bu(this),bf(this))};function ku(C){C.A!=null&&(a.clearTimeout(C.A),C.A=null)}function bf(C){C.g=new Pa(C,C.j,"rpc",C.Y),C.m===null&&(C.g.H=C.o),C.g.O=0;var Z=yi(C.qa);tn(Z,"RID","rpc"),tn(Z,"SID",C.K),tn(Z,"AID",C.T),tn(Z,"CI",C.F?"0":"1"),!C.F&&C.ja&&tn(Z,"TO",C.ja),tn(Z,"TYPE","xmlhttp"),Vr(C,Z),C.m&&C.o&&_s(Z,C.m,C.o),C.L&&(C.g.I=C.L);var de=C.g;C=C.ia,de.L=1,de.v=aa(yi(Z)),de.m=null,de.P=!0,mc(de,C)}t.Za=function(){this.C!=null&&(this.C=null,bu(this),Md(this),vt(19))};function Tc(C){C.C!=null&&(a.clearTimeout(C.C),C.C=null)}function Al(C,Z){var de=null;if(C.g==Z){Tc(C),ku(C),C.g=null;var ke=2}else if(ci(C.h,Z))de=Z.D,xs(C.h,Z),ke=1;else return;if(C.G!=0){if(Z.o)if(ke==1){de=Z.m?Z.m.length:0,Z=Date.now()-Z.F;var et=C.B;ke=We(),hn(ke,new xr(ke,de)),kc(C)}else Id(C);else if(et=Z.s,et==3||et==0&&0<Z.X||!(ke==1&&_f(C,Z)||ke==2&&Md(C)))switch(de&&0<de.length&&(Z=C.h,Z.i=Z.i.concat(de)),et){case 1:Ha(C,5);break;case 4:Ha(C,10);break;case 3:Ha(C,6);break;default:Ha(C,2)}}}function Tu(C,Z){let de=C.Ta+Math.floor(Math.random()*C.cb);return C.isActive()||(de*=2),de*Z}function Ha(C,Z){if(C.j.info("Error code "+Z),Z==2){var de=T(C.fb,C),ke=C.Xa;const et=!ke;ke=new gi(ke||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Sr(ke,"https"),aa(ke),et?_a(ke.toString(),de):Wa(ke.toString(),de)}else vt(2);C.G=0,C.l&&C.l.sa(Z),zs(C),wu(C)}t.fb=function(C){C?(this.j.info("Successfully pinged google.com"),vt(2)):(this.j.info("Failed to ping google.com"),vt(1))};function zs(C){if(C.G=0,C.ka=[],C.l){const Z=Ad(C.h);(Z.length!=0||C.i.length!=0)&&(D(C.ka,Z),D(C.ka,C.i),C.h.i.length=0,P(C.i),C.i.length=0),C.l.ra()}}function Fo(C,Z,de){var ke=de instanceof gi?yi(de):new gi(de);if(ke.g!="")Z&&(ke.g=Z+"."+ke.g),Gi(ke,ke.s);else{var et=a.location;ke=et.protocol,Z=Z?Z+"."+et.hostname:et.hostname,et=+et.port;var ut=new gi(null);ke&&Sr(ut,ke),Z&&(ut.g=Z),et&&Gi(ut,et),de&&(ut.l=de),ke=ut}return de=C.D,Z=C.ya,de&&Z&&tn(ke,de,Z),tn(ke,"VER",C.la),Vr(C,ke),ke}function Su(C,Z,de){if(Z&&!C.J)throw Error("Can't create secondary domain capable XhrIo object.");return Z=C.Ca&&!C.pa?new cn(new Ro({eb:de})):new cn(C.pa),Z.Ha(C.J),Z}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function wf(){}t=wf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Bo(){}Bo.prototype.g=function(C,Z){return new oa(C,Z)};function oa(C,Z){Cr.call(this),this.g=new Sl(Z),this.l=C,this.h=Z&&Z.messageUrlParams||null,C=Z&&Z.messageHeaders||null,Z&&Z.clientProtocolHeaderRequired&&(C?C["X-Client-Protocol"]="webchannel":C={"X-Client-Protocol":"webchannel"}),this.g.o=C,C=Z&&Z.initMessageHeaders||null,Z&&Z.messageContentType&&(C?C["X-WebChannel-Content-Type"]=Z.messageContentType:C={"X-WebChannel-Content-Type":Z.messageContentType}),Z&&Z.va&&(C?C["X-WebChannel-Client-Profile"]=Z.va:C={"X-WebChannel-Client-Profile":Z.va}),this.g.S=C,(C=Z&&Z.Sb)&&!O(C)&&(this.g.m=C),this.v=Z&&Z.supportsCrossDomainXhr||!1,this.u=Z&&Z.sendRawJson||!1,(Z=Z&&Z.httpSessionIdParam)&&!O(Z)&&(this.g.D=Z,C=this.h,C!==null&&Z in C&&(C=this.h,Z in C&&delete C[Z])),this.j=new fo(this)}I(oa,Cr),oa.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},oa.prototype.close=function(){El(this.g)},oa.prototype.o=function(C){var Z=this.g;if(typeof C=="string"){var de={};de.__data__=C,C=de}else this.u&&(de={},de.__data__=Ga(C),C=de);Z.i.push(new yu(Z.Ya++,C)),Z.G==3&&kc(Z)},oa.prototype.N=function(){this.g.l=null,delete this.j,El(this.g),delete this.g,oa.aa.N.call(this)};function Dd(C){ze.call(this),C.__headers__&&(this.headers=C.__headers__,this.statusCode=C.__status__,delete C.__headers__,delete C.__status__);var Z=C.__sm__;if(Z){e:{for(const de in Z){C=de;break e}C=void 0}(this.i=C)&&(C=this.i,Z=Z!==null&&C in Z?Z[C]:void 0),this.data=Z}else this.data=C}I(Dd,ze);function Eu(){Ge.call(this),this.status=1}I(Eu,Ge);function fo(C){this.g=C}I(fo,wf),fo.prototype.ua=function(){hn(this.g,"a")},fo.prototype.ta=function(C){hn(this.g,new Dd(C))},fo.prototype.sa=function(C){hn(this.g,new Eu)},fo.prototype.ra=function(){hn(this.g,"b")},Bo.prototype.createWebChannel=Bo.prototype.g,oa.prototype.send=oa.prototype.o,oa.prototype.open=oa.prototype.m,oa.prototype.close=oa.prototype.close,oK=function(){return new Bo},sK=function(){return We()},aK=Ze,YP={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},zn.NO_ERROR=0,zn.TIMEOUT=8,zn.HTTP_ERROR=6,e2=zn,gs.COMPLETE="complete",iK=gs,le.EventType=Ne,Ne.OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",Cr.prototype.listen=Cr.prototype.K,Gx=le,cn.prototype.listenOnce=cn.prototype.L,cn.prototype.getLastError=cn.prototype.Ka,cn.prototype.getLastErrorCode=cn.prototype.Ba,cn.prototype.getStatus=cn.prototype.Z,cn.prototype.getResponseJson=cn.prototype.Oa,cn.prototype.getResponseText=cn.prototype.oa,cn.prototype.send=cn.prototype.ea,cn.prototype.setWithCredentials=cn.prototype.Ha,nK=cn}).apply(typeof kw<"u"?kw:typeof self<"u"?self:typeof window<"u"?window:{});const wF="@firebase/firestore",kF="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}is.UNAUTHENTICATED=new is(null),is.GOOGLE_CREDENTIALS=new is("google-credentials-uid"),is.FIRST_PARTY=new is("first-party-uid"),is.MOCK_USER=new is("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iy="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p=new HH("@firebase/firestore");function Ym(){return $p.logLevel}function nr(t,...e){if($p.logLevel<=on.DEBUG){const r=e.map(m3);$p.debug(`Firestore (${iy}): ${t}`,...r)}}function pd(t,...e){if($p.logLevel<=on.ERROR){const r=e.map(m3);$p.error(`Firestore (${iy}): ${t}`,...r)}}function Kh(t,...e){if($p.logLevel<=on.WARN){const r=e.map(m3);$p.warn(`Firestore (${iy}): ${t}`,...r)}}function m3(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,lK(t,n,r)}function lK(t,e,r){let n=`FIRESTORE (${iy}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw pd(n),new Error(n)}function Cn(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||lK(e,i,n)}function Br(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Yt extends Yp{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cK{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class NIe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(is.UNAUTHENTICATED))}shutdown(){}}class CIe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class PIe{constructor(e){this.t=e,this.currentUser=is.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Cn(this.o===void 0,42304);let n=this.i;const i=p=>this.i!==n?(n=this.i,r(p)):Promise.resolve();let o=new td;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new td,e.enqueueRetryable(()=>i(this.currentUser))};const u=()=>{const p=o;e.enqueueRetryable(async()=>{await p.promise,await i(this.currentUser)})},a=p=>{nr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(p=>a(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?a(p):(nr("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new td)}},0),u()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(nr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Cn(typeof n.accessToken=="string",31837,{l:n}),new cK(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Cn(e===null||typeof e=="string",2055,{h:e}),new is(e)}}class IIe{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=is.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class MIe{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new IIe(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(is.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class TF{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DIe{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,YH(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Cn(this.o===void 0,3512);const n=o=>{o.error!=null&&nr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,nr("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{nr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):nr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new TF(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Cn(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new TF(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OIe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uK(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=OIe(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function Hr(t,e){return t<e?-1:t>e?1:0}function JP(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),i=e.codePointAt(r);if(n!==i){if(n<128&&i<128)return Hr(n,i);{const o=uK(),u=RIe(o.encode(SF(t,r)),o.encode(SF(e,r)));return u!==0?u:Hr(n,i)}}r+=n>65535?2:1}return Hr(t.length,e.length)}function SF(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function RIe(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return Hr(t[r],e[r]);return Hr(t.length,e.length)}function S0(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EF="__name__";class zc{constructor(e,r,n){r===void 0?r=0:r>e.length&&Nr(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&Nr(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return zc.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof zc?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=zc.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return Hr(e.length,r.length)}static compareSegments(e,r){const n=zc.isNumericId(e),i=zc.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?zc.extractNumericId(e).compare(zc.extractNumericId(r)):JP(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $h.fromString(e.substring(4,e.length-2))}}class Vn extends zc{construct(e,r,n){return new Vn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Yt(wt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Vn(r)}static emptyPath(){return new Vn([])}}const LIe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Fa extends zc{construct(e,r,n){return new Fa(e,r,n)}static isValidIdentifier(e){return LIe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Fa.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===EF}static keyField(){return new Fa([EF])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Yt(wt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let u=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Yt(wt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[i+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new Yt(wt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=p,i+=2}else a==="`"?(u=!u,i++):a!=="."||u?(n+=a,i++):(o(),i++)}if(o(),u)throw new Yt(wt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Fa(r)}static emptyPath(){return new Fa([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this.path=e}static fromPath(e){return new pr(Vn.fromString(e))}static fromName(e){return new pr(Vn.fromString(e).popFirst(5))}static empty(){return new pr(Vn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Vn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Vn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pr(new Vn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dK(t,e,r){if(!r)throw new Yt(wt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function zIe(t,e,r,n){if(e===!0&&n===!0)throw new Yt(wt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function jF(t){if(!pr.isDocumentKey(t))throw new Yt(wt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function AF(t){if(pr.isDocumentKey(t))throw new Yt(wt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hK(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function DS(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Nr(12329,{type:typeof t})}function io(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Yt(wt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=DS(t);throw new Yt(wt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function $Ie(t,e){if(e<=0)throw new Yt(wt.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(t,e){const r={typeString:t};return e&&(r.value=e),r}function yb(t,e){if(!hK(t))throw new Yt(wt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const u=t[n];if(i&&typeof u!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&u!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Yt(wt.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF=-62135596800,CF=1e6;class jn{static now(){return jn.fromMillis(Date.now())}static fromDate(e){return jn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*CF);return new jn(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Yt(wt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Yt(wt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<NF)throw new Yt(wt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Yt(wt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/CF}_compareTo(e){return this.seconds===e.seconds?Hr(this.nanoseconds,e.nanoseconds):Hr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:jn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(yb(e,jn._jsonSchema))return new jn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-NF;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}jn._jsonSchemaVersion="firestore/timestamp/1.0",jn._jsonSchema={type:na("string",jn._jsonSchemaVersion),seconds:na("number"),nanoseconds:na("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{static fromTimestamp(e){return new Lr(e)}static min(){return new Lr(new jn(0,0))}static max(){return new Lr(new jn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_=-1;function FIe(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Lr.fromTimestamp(n===1e9?new jn(r+1,0):new jn(r,n));return new Zh(i,pr.empty(),e)}function BIe(t){return new Zh(t.readTime,t.key,R_)}class Zh{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Zh(Lr.min(),pr.empty(),R_)}static max(){return new Zh(Lr.max(),pr.empty(),R_)}}function VIe(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=pr.comparator(t.documentKey,e.documentKey),r!==0?r:Hr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UIe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class qIe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ay(t){if(t.code!==wt.FAILED_PRECONDITION||t.message!==UIe)throw t;nr("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Nr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Dt((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Dt?r:Dt.resolve(r)}catch(r){return Dt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Dt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Dt.reject(r)}static resolve(e){return new Dt((r,n)=>{r(e)})}static reject(e){return new Dt((r,n)=>{n(e)})}static waitFor(e){return new Dt((r,n)=>{let i=0,o=0,u=!1;e.forEach(a=>{++i,a.next(()=>{++o,u&&o===i&&r()},p=>n(p))}),u=!0,o===i&&r()})}static or(e){let r=Dt.resolve(!1);for(const n of e)r=r.next(i=>i?Dt.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new Dt((n,i)=>{const o=e.length,u=new Array(o);let a=0;for(let p=0;p<o;p++){const g=p;r(e[g]).next(v=>{u[g]=v,++a,a===o&&n(u)},v=>i(v))}})}static doWhile(e,r){return new Dt((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function GIe(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function sy(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this._e(n),this.ae=n=>r.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}OS.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3=-1;function RS(t){return t==null}function Wk(t){return t===0&&1/t==-1/0}function WIe(t){return typeof t=="number"&&Number.isInteger(t)&&!Wk(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fK="";function HIe(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=PF(e)),e=KIe(t.get(r),e);return PF(e)}function KIe(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case fK:r+="";break;default:r+=o}}return r}function PF(t){return t+fK+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IF(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function pf(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function pK(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,r){this.comparator=e,this.root=r||$a.EMPTY}insert(e,r){return new Ci(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,$a.BLACK,null,null))}remove(e){return new Ci(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$a.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Tw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Tw(this.root,e,this.comparator,!1)}getReverseIterator(){return new Tw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Tw(this.root,e,this.comparator,!0)}}class Tw{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $a{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??$a.RED,this.left=i??$a.EMPTY,this.right=o??$a.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new $a(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return $a.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return $a.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$a.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$a.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Nr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Nr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Nr(27949);return e+(this.isRed()?0:1)}}$a.EMPTY=null,$a.RED=!0,$a.BLACK=!1;$a.EMPTY=new class{constructor(){this.size=0}get key(){throw Nr(57766)}get value(){throw Nr(16141)}get color(){throw Nr(16727)}get left(){throw Nr(29726)}get right(){throw Nr(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new $a(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e){this.comparator=e,this.data=new Ci(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new MF(this.data.getIterator())}getIteratorFrom(e){return new MF(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ya)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ya(this.comparator);return r.data=e,r}}class MF{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e){this.fields=e,e.sort(Fa.comparator)}static empty(){return new So([])}unionWith(e){let r=new ya(Fa.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new So(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return S0(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mK extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new mK("Invalid base64 string: "+o):o}}(e);return new Ua(r)}static fromUint8Array(e){const r=function(i){let o="";for(let u=0;u<i.length;++u)o+=String.fromCharCode(i[u]);return o}(e);return new Ua(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Hr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ua.EMPTY_BYTE_STRING=new Ua("");const ZIe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xh(t){if(Cn(!!t,39018),typeof t=="string"){let e=0;const r=ZIe.exec(t);if(Cn(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Bi(t.seconds),nanos:Bi(t.nanos)}}function Bi(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Yh(t){return typeof t=="string"?Ua.fromBase64String(t):Ua.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gK="server_timestamp",yK="__type__",xK="__previous_value__",vK="__local_write_time__";function LS(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[yK])===null||r===void 0?void 0:r.stringValue)===gK}function zS(t){const e=t.mapValue.fields[xK];return LS(e)?zS(e):e}function L_(t){const e=Xh(t.mapValue.fields[vK].timestampValue);return new jn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XIe{constructor(e,r,n,i,o,u,a,p,g,v){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=a,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=v}}const Hk="(default)";class z_{constructor(e,r){this.projectId=e,this.database=r||Hk}static empty(){return new z_("","")}get isDefaultDatabase(){return this.database===Hk}isEqual(e){return e instanceof z_&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _K="__type__",bK="__max__",Sw={mapValue:{fields:{__type__:{stringValue:bK}}}},wK="__vector__",Kk="value";function Jh(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?LS(t)?4:JIe(t)?9007199254740991:YIe(t)?10:11:Nr(28295,{value:t})}function lu(t,e){if(t===e)return!0;const r=Jh(t);if(r!==Jh(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return L_(t).isEqual(L_(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const u=Xh(i.timestampValue),a=Xh(o.timestampValue);return u.seconds===a.seconds&&u.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Yh(i.bytesValue).isEqual(Yh(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Bi(i.geoPointValue.latitude)===Bi(o.geoPointValue.latitude)&&Bi(i.geoPointValue.longitude)===Bi(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Bi(i.integerValue)===Bi(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const u=Bi(i.doubleValue),a=Bi(o.doubleValue);return u===a?Wk(u)===Wk(a):isNaN(u)&&isNaN(a)}return!1}(t,e);case 9:return S0(t.arrayValue.values||[],e.arrayValue.values||[],lu);case 10:case 11:return function(i,o){const u=i.mapValue.fields||{},a=o.mapValue.fields||{};if(IF(u)!==IF(a))return!1;for(const p in u)if(u.hasOwnProperty(p)&&(a[p]===void 0||!lu(u[p],a[p])))return!1;return!0}(t,e);default:return Nr(52216,{left:t})}}function $_(t,e){return(t.values||[]).find(r=>lu(r,e))!==void 0}function E0(t,e){if(t===e)return 0;const r=Jh(t),n=Jh(e);if(r!==n)return Hr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Hr(t.booleanValue,e.booleanValue);case 2:return function(o,u){const a=Bi(o.integerValue||o.doubleValue),p=Bi(u.integerValue||u.doubleValue);return a<p?-1:a>p?1:a===p?0:isNaN(a)?isNaN(p)?0:-1:1}(t,e);case 3:return DF(t.timestampValue,e.timestampValue);case 4:return DF(L_(t),L_(e));case 5:return JP(t.stringValue,e.stringValue);case 6:return function(o,u){const a=Yh(o),p=Yh(u);return a.compareTo(p)}(t.bytesValue,e.bytesValue);case 7:return function(o,u){const a=o.split("/"),p=u.split("/");for(let g=0;g<a.length&&g<p.length;g++){const v=Hr(a[g],p[g]);if(v!==0)return v}return Hr(a.length,p.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,u){const a=Hr(Bi(o.latitude),Bi(u.latitude));return a!==0?a:Hr(Bi(o.longitude),Bi(u.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return OF(t.arrayValue,e.arrayValue);case 10:return function(o,u){var a,p,g,v;const w=o.fields||{},T=u.fields||{},A=(a=w[Kk])===null||a===void 0?void 0:a.arrayValue,I=(p=T[Kk])===null||p===void 0?void 0:p.arrayValue,P=Hr(((g=A==null?void 0:A.values)===null||g===void 0?void 0:g.length)||0,((v=I==null?void 0:I.values)===null||v===void 0?void 0:v.length)||0);return P!==0?P:OF(A,I)}(t.mapValue,e.mapValue);case 11:return function(o,u){if(o===Sw.mapValue&&u===Sw.mapValue)return 0;if(o===Sw.mapValue)return 1;if(u===Sw.mapValue)return-1;const a=o.fields||{},p=Object.keys(a),g=u.fields||{},v=Object.keys(g);p.sort(),v.sort();for(let w=0;w<p.length&&w<v.length;++w){const T=JP(p[w],v[w]);if(T!==0)return T;const A=E0(a[p[w]],g[v[w]]);if(A!==0)return A}return Hr(p.length,v.length)}(t.mapValue,e.mapValue);default:throw Nr(23264,{le:r})}}function DF(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Hr(t,e);const r=Xh(t),n=Xh(e),i=Hr(r.seconds,n.seconds);return i!==0?i:Hr(r.nanos,n.nanos)}function OF(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=E0(r[i],n[i]);if(o)return o}return Hr(r.length,n.length)}function j0(t){return QP(t)}function QP(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Xh(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Yh(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return pr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=QP(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const u of n)o?o=!1:i+=",",i+=`${u}:${QP(r.fields[u])}`;return i+"}"}(t.mapValue):Nr(61005,{value:t})}function t2(t){switch(Jh(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=zS(t);return e?16+t2(e):16;case 5:return 2*t.stringValue.length;case 6:return Yh(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+t2(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return pf(n.fields,(o,u)=>{i+=o.length+t2(u)}),i}(t.mapValue);default:throw Nr(13486,{value:t})}}function Zk(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function e4(t){return!!t&&"integerValue"in t}function x3(t){return!!t&&"arrayValue"in t}function RF(t){return!!t&&"nullValue"in t}function LF(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function r2(t){return!!t&&"mapValue"in t}function YIe(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[_K])===null||r===void 0?void 0:r.stringValue)===wK}function Ev(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return pf(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Ev(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Ev(t.arrayValue.values[r]);return e}return Object.assign({},t)}function JIe(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===bK}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e){this.value=e}static empty(){return new Ks({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!r2(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ev(r)}setAll(e){let r=Fa.emptyPath(),n={},i=[];e.forEach((u,a)=>{if(!r.isImmediateParentOf(a)){const p=this.getFieldsMap(r);this.applyChanges(p,n,i),n={},i=[],r=a.popLast()}u?n[a.lastSegment()]=Ev(u):i.push(a.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());r2(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return lu(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];r2(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){pf(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Ks(Ev(this.value))}}function kK(t){const e=[];return pf(t.fields,(r,n)=>{const i=new Fa([r]);if(r2(n)){const o=kK(n.mapValue).fields;if(o.length===0)e.push(i);else for(const u of o)e.push(i.child(u))}else e.push(i)}),new So(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,r,n,i,o,u,a){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=u,this.documentState=a}static newInvalidDocument(e){return new ls(e,0,Lr.min(),Lr.min(),Lr.min(),Ks.empty(),0)}static newFoundDocument(e,r,n,i){return new ls(e,1,r,Lr.min(),n,i,0)}static newNoDocument(e,r){return new ls(e,2,r,Lr.min(),Lr.min(),Ks.empty(),0)}static newUnknownDocument(e,r){return new ls(e,3,r,Lr.min(),Lr.min(),Ks.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Lr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ks.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ks.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Lr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ls&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ls(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e,r){this.position=e,this.inclusive=r}}function zF(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],u=t.position[i];if(o.field.isKeyField()?n=pr.comparator(pr.fromName(u.referenceValue),r.key):n=E0(u,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function $F(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!lu(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e,r="asc"){this.field=e,this.dir=r}}function QIe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TK{}class ra extends TK{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new tMe(e,r,n):r==="array-contains"?new iMe(e,n):r==="in"?new aMe(e,n):r==="not-in"?new sMe(e,n):r==="array-contains-any"?new oMe(e,n):new ra(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new rMe(e,n):new nMe(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(E0(r,this.value)):r!==null&&Jh(this.value)===Jh(r)&&this.matchesComparison(E0(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Nr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class uc extends TK{constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new uc(e,r)}matches(e){return SK(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function SK(t){return t.op==="and"}function EK(t){return eMe(t)&&SK(t)}function eMe(t){for(const e of t.filters)if(e instanceof uc)return!1;return!0}function t4(t){if(t instanceof ra)return t.field.canonicalString()+t.op.toString()+j0(t.value);if(EK(t))return t.filters.map(e=>t4(e)).join(",");{const e=t.filters.map(r=>t4(r)).join(",");return`${t.op}(${e})`}}function jK(t,e){return t instanceof ra?function(n,i){return i instanceof ra&&n.op===i.op&&n.field.isEqual(i.field)&&lu(n.value,i.value)}(t,e):t instanceof uc?function(n,i){return i instanceof uc&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,u,a)=>o&&jK(u,i.filters[a]),!0):!1}(t,e):void Nr(19439)}function AK(t){return t instanceof ra?function(r){return`${r.field.canonicalString()} ${r.op} ${j0(r.value)}`}(t):t instanceof uc?function(r){return r.op.toString()+" {"+r.getFilters().map(AK).join(" ,")+"}"}(t):"Filter"}class tMe extends ra{constructor(e,r,n){super(e,r,n),this.key=pr.fromName(n.referenceValue)}matches(e){const r=pr.comparator(e.key,this.key);return this.matchesComparison(r)}}class rMe extends ra{constructor(e,r){super(e,"in",r),this.keys=NK("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class nMe extends ra{constructor(e,r){super(e,"not-in",r),this.keys=NK("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function NK(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>pr.fromName(n.referenceValue))}class iMe extends ra{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return x3(r)&&$_(r.arrayValue,this.value)}}class aMe extends ra{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&$_(this.value.arrayValue,r)}}class sMe extends ra{constructor(e,r){super(e,"not-in",r)}matches(e){if($_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!$_(this.value.arrayValue,r)}}class oMe extends ra{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!x3(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>$_(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lMe{constructor(e,r=null,n=[],i=[],o=null,u=null,a=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=u,this.endAt=a,this.Pe=null}}function FF(t,e=null,r=[],n=[],i=null,o=null,u=null){return new lMe(t,e,r,n,i,o,u)}function v3(t){const e=Br(t);if(e.Pe===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>t4(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),RS(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>j0(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>j0(n)).join(",")),e.Pe=r}return e.Pe}function _3(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!QIe(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!jK(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$F(t.startAt,e.startAt)&&$F(t.endAt,e.endAt)}function r4(t){return pr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,r=null,n=[],i=[],o=null,u="F",a=null,p=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=u,this.startAt=a,this.endAt=p,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function cMe(t,e,r,n,i,o,u,a){return new Jp(t,e,r,n,i,o,u,a)}function $S(t){return new Jp(t)}function BF(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function b3(t){return t.collectionGroup!==null}function Ig(t){const e=Br(t);if(e.Te===null){e.Te=[];const r=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let a=new ya(Fa.comparator);return u.filters.forEach(p=>{p.getFlattenedFilters().forEach(g=>{g.isInequality()&&(a=a.add(g.field))})}),a})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Te.push(new F_(o,n))}),r.has(Fa.keyField().canonicalString())||e.Te.push(new F_(Fa.keyField(),n))}return e.Te}function Xc(t){const e=Br(t);return e.Ie||(e.Ie=uMe(e,Ig(t))),e.Ie}function uMe(t,e){if(t.limitType==="F")return FF(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new F_(i.field,o)});const r=t.endAt?new A0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new A0(t.startAt.position,t.startAt.inclusive):null;return FF(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function n4(t,e){const r=t.filters.concat([e]);return new Jp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Xk(t,e,r){return new Jp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function FS(t,e){return _3(Xc(t),Xc(e))&&t.limitType===e.limitType}function CK(t){return`${v3(Xc(t))}|lt:${t.limitType}`}function Jm(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>AK(i)).join(", ")}]`),RS(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>j0(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>j0(i)).join(",")),`Target(${n})`}(Xc(t))}; limitType=${t.limitType})`}function BS(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):pr.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Ig(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(u,a,p){const g=zF(u,a,p);return u.inclusive?g<=0:g<0}(n.startAt,Ig(n),i)||n.endAt&&!function(u,a,p){const g=zF(u,a,p);return u.inclusive?g>=0:g>0}(n.endAt,Ig(n),i))}(t,e)}function dMe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function PK(t){return(e,r)=>{let n=!1;for(const i of Ig(t)){const o=hMe(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function hMe(t,e,r){const n=t.field.isKeyField()?pr.comparator(e.key,r.key):function(o,u,a){const p=u.data.field(o),g=a.data.field(o);return p!==null&&g!==null?E0(p,g):Nr(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Nr(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){pf(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return pK(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fMe=new Ci(pr.comparator);function md(){return fMe}const IK=new Ci(pr.comparator);function Wx(...t){let e=IK;for(const r of t)e=e.insert(r.key,r);return e}function MK(t){let e=IK;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function yp(){return jv()}function DK(){return jv()}function jv(){return new Qp(t=>t.toString(),(t,e)=>t.isEqual(e))}const pMe=new Ci(pr.comparator),mMe=new ya(pr.comparator);function en(...t){let e=mMe;for(const r of t)e=e.add(r);return e}const gMe=new ya(Hr);function yMe(){return gMe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w3(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wk(e)?"-0":e}}function OK(t){return{integerValue:""+t}}function xMe(t,e){return WIe(e)?OK(e):w3(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(){this._=void 0}}function vMe(t,e,r){return t instanceof Yk?function(i,o){const u={fields:{[yK]:{stringValue:gK},[vK]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&LS(o)&&(o=zS(o)),o&&(u.fields[xK]=o),{mapValue:u}}(r,e):t instanceof B_?LK(t,e):t instanceof V_?zK(t,e):function(i,o){const u=RK(i,o),a=VF(u)+VF(i.Ee);return e4(u)&&e4(i.Ee)?OK(a):w3(i.serializer,a)}(t,e)}function _Me(t,e,r){return t instanceof B_?LK(t,e):t instanceof V_?zK(t,e):r}function RK(t,e){return t instanceof Jk?function(n){return e4(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Yk extends VS{}class B_ extends VS{constructor(e){super(),this.elements=e}}function LK(t,e){const r=$K(e);for(const n of t.elements)r.some(i=>lu(i,n))||r.push(n);return{arrayValue:{values:r}}}class V_ extends VS{constructor(e){super(),this.elements=e}}function zK(t,e){let r=$K(e);for(const n of t.elements)r=r.filter(i=>!lu(i,n));return{arrayValue:{values:r}}}class Jk extends VS{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function VF(t){return Bi(t.integerValue||t.doubleValue)}function $K(t){return x3(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function bMe(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof B_&&i instanceof B_||n instanceof V_&&i instanceof V_?S0(n.elements,i.elements,lu):n instanceof Jk&&i instanceof Jk?lu(n.Ee,i.Ee):n instanceof Yk&&i instanceof Yk}(t.transform,e.transform)}class wMe{constructor(e,r){this.version=e,this.transformResults=r}}class hl{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new hl}static exists(e){return new hl(void 0,e)}static updateTime(e){return new hl(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function n2(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class US{}function FK(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new k3(t.key,hl.none()):new xb(t.key,t.data,hl.none());{const r=t.data,n=Ks.empty();let i=new ya(Fa.comparator);for(let o of e.fields)if(!i.has(o)){let u=r.field(o);u===null&&o.length>1&&(o=o.popLast(),u=r.field(o)),u===null?n.delete(o):n.set(o,u),i=i.add(o)}return new mf(t.key,n,new So(i.toArray()),hl.none())}}function kMe(t,e,r){t instanceof xb?function(i,o,u){const a=i.value.clone(),p=qF(i.fieldTransforms,o,u.transformResults);a.setAll(p),o.convertToFoundDocument(u.version,a).setHasCommittedMutations()}(t,e,r):t instanceof mf?function(i,o,u){if(!n2(i.precondition,o))return void o.convertToUnknownDocument(u.version);const a=qF(i.fieldTransforms,o,u.transformResults),p=o.data;p.setAll(BK(i)),p.setAll(a),o.convertToFoundDocument(u.version,p).setHasCommittedMutations()}(t,e,r):function(i,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,r)}function Av(t,e,r,n){return t instanceof xb?function(o,u,a,p){if(!n2(o.precondition,u))return a;const g=o.value.clone(),v=GF(o.fieldTransforms,p,u);return g.setAll(v),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),null}(t,e,r,n):t instanceof mf?function(o,u,a,p){if(!n2(o.precondition,u))return a;const g=GF(o.fieldTransforms,p,u),v=u.data;return v.setAll(BK(o)),v.setAll(g),u.convertToFoundDocument(u.version,v).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(w=>w.field))}(t,e,r,n):function(o,u,a){return n2(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):a}(t,e,r)}function TMe(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=RK(n.transform,i||null);o!=null&&(r===null&&(r=Ks.empty()),r.set(n.field,o))}return r||null}function UF(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&S0(n,i,(o,u)=>bMe(o,u))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class xb extends US{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class mf extends US{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function BK(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function qF(t,e,r){const n=new Map;Cn(t.length===r.length,32656,{Ae:r.length,Re:t.length});for(let i=0;i<r.length;i++){const o=t[i],u=o.transform,a=e.data.field(o.field);n.set(o.field,_Me(u,a,r[i]))}return n}function GF(t,e,r){const n=new Map;for(const i of t){const o=i.transform,u=r.data.field(i.field);n.set(i.field,vMe(o,u,e))}return n}class k3 extends US{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class SMe extends US{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EMe{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&kMe(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Av(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Av(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=DK();return this.mutations.forEach(i=>{const o=e.get(i.key),u=o.overlayedDocument;let a=this.applyToLocalView(u,o.mutatedFields);a=r.has(i.key)?null:a;const p=FK(u,a);p!==null&&n.set(i.key,p),u.isValidDocument()||u.convertToNoDocument(Lr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),en())}isEqual(e){return this.batchId===e.batchId&&S0(this.mutations,e.mutations,(r,n)=>UF(r,n))&&S0(this.baseMutations,e.baseMutations,(r,n)=>UF(r,n))}}class T3{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Cn(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let i=function(){return pMe}();const o=e.mutations;for(let u=0;u<o.length;u++)i=i.insert(o[u].key,n[u].version);return new T3(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jMe{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AMe{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yi,sn;function NMe(t){switch(t){case wt.OK:return Nr(64938);case wt.CANCELLED:case wt.UNKNOWN:case wt.DEADLINE_EXCEEDED:case wt.RESOURCE_EXHAUSTED:case wt.INTERNAL:case wt.UNAVAILABLE:case wt.UNAUTHENTICATED:return!1;case wt.INVALID_ARGUMENT:case wt.NOT_FOUND:case wt.ALREADY_EXISTS:case wt.PERMISSION_DENIED:case wt.FAILED_PRECONDITION:case wt.ABORTED:case wt.OUT_OF_RANGE:case wt.UNIMPLEMENTED:case wt.DATA_LOSS:return!0;default:return Nr(15467,{code:t})}}function VK(t){if(t===void 0)return pd("GRPC error has no .code"),wt.UNKNOWN;switch(t){case Yi.OK:return wt.OK;case Yi.CANCELLED:return wt.CANCELLED;case Yi.UNKNOWN:return wt.UNKNOWN;case Yi.DEADLINE_EXCEEDED:return wt.DEADLINE_EXCEEDED;case Yi.RESOURCE_EXHAUSTED:return wt.RESOURCE_EXHAUSTED;case Yi.INTERNAL:return wt.INTERNAL;case Yi.UNAVAILABLE:return wt.UNAVAILABLE;case Yi.UNAUTHENTICATED:return wt.UNAUTHENTICATED;case Yi.INVALID_ARGUMENT:return wt.INVALID_ARGUMENT;case Yi.NOT_FOUND:return wt.NOT_FOUND;case Yi.ALREADY_EXISTS:return wt.ALREADY_EXISTS;case Yi.PERMISSION_DENIED:return wt.PERMISSION_DENIED;case Yi.FAILED_PRECONDITION:return wt.FAILED_PRECONDITION;case Yi.ABORTED:return wt.ABORTED;case Yi.OUT_OF_RANGE:return wt.OUT_OF_RANGE;case Yi.UNIMPLEMENTED:return wt.UNIMPLEMENTED;case Yi.DATA_LOSS:return wt.DATA_LOSS;default:return Nr(39323,{code:t})}}(sn=Yi||(Yi={}))[sn.OK=0]="OK",sn[sn.CANCELLED=1]="CANCELLED",sn[sn.UNKNOWN=2]="UNKNOWN",sn[sn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",sn[sn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",sn[sn.NOT_FOUND=5]="NOT_FOUND",sn[sn.ALREADY_EXISTS=6]="ALREADY_EXISTS",sn[sn.PERMISSION_DENIED=7]="PERMISSION_DENIED",sn[sn.UNAUTHENTICATED=16]="UNAUTHENTICATED",sn[sn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",sn[sn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",sn[sn.ABORTED=10]="ABORTED",sn[sn.OUT_OF_RANGE=11]="OUT_OF_RANGE",sn[sn.UNIMPLEMENTED=12]="UNIMPLEMENTED",sn[sn.INTERNAL=13]="INTERNAL",sn[sn.UNAVAILABLE=14]="UNAVAILABLE",sn[sn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CMe=new $h([4294967295,4294967295],0);function WF(t){const e=uK().encode(t),r=new rK;return r.update(e),new Uint8Array(r.digest())}function HF(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new $h([r,n],0),new $h([i,o],0)]}class S3{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Hx(`Invalid padding: ${r}`);if(n<0)throw new Hx(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Hx(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Hx(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=$h.fromNumber(this.fe)}pe(e,r,n){let i=e.add(r.multiply($h.fromNumber(n)));return i.compare(CMe)===1&&(i=new $h([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const r=WF(e),[n,i]=HF(r);for(let o=0;o<this.hashCount;o++){const u=this.pe(n,i,o);if(!this.ye(u))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new S3(o,i,r);return n.forEach(a=>u.insert(a)),u}insert(e){if(this.fe===0)return;const r=WF(e),[n,i]=HF(r);for(let o=0;o<this.hashCount;o++){const u=this.pe(n,i,o);this.we(u)}}we(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Hx extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,vb.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new qS(Lr.min(),i,new Ci(Hr),md(),en())}}class vb{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new vb(n,r,en(),en(),en())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,r,n,i){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=i}}class UK{constructor(e,r){this.targetId=e,this.De=r}}class qK{constructor(e,r,n=Ua.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class KF{constructor(){this.ve=0,this.Ce=ZF(),this.Fe=Ua.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=en(),r=en(),n=en();return this.Ce.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Nr(38017,{changeType:o})}}),new vb(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=ZF()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Cn(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class PMe{constructor(e){this.We=e,this.Ge=new Map,this.ze=md(),this.je=Ew(),this.Je=Ew(),this.He=new Ci(Hr)}Ye(e){for(const r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(const r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{const n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:Nr(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((n,i)=>{this.nt(i)&&r(i)})}it(e){const r=e.targetId,n=e.De.count,i=this.st(r);if(i){const o=i.target;if(r4(o))if(n===0){const u=new pr(o.path);this.Xe(r,u,ls.newNoDocument(u,Lr.min()))}else Cn(n===1,20013,{expectedCount:n});else{const u=this.ot(r);if(u!==n){const a=this._t(e),p=a?this.ut(a,e,u):1;if(p!==0){this.rt(r);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,g)}}}}}_t(e){const r=e.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let u,a;try{u=Yh(n).toUint8Array()}catch(p){if(p instanceof mK)return Kh("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{a=new S3(u,i,o)}catch(p){return Kh(p instanceof Hx?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return a.fe===0?null:a}ut(e,r,n){return r.De.count===n-this.ht(e,r.targetId)?0:2}ht(e,r){const n=this.We.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const u=this.We.lt(),a=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Xe(r,o,null),i++)}),i}Pt(e){const r=new Map;this.Ge.forEach((o,u)=>{const a=this.st(u);if(a){if(o.current&&r4(a.target)){const p=new pr(a.target.path);this.Tt(p).has(u)||this.It(u,p)||this.Xe(u,p,ls.newNoDocument(p,e))}o.Ne&&(r.set(u,o.Le()),o.ke())}});let n=en();this.Je.forEach((o,u)=>{let a=!0;u.forEachWhile(p=>{const g=this.st(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(o))}),this.ze.forEach((o,u)=>u.setReadTime(e));const i=new qS(e,r,this.He,this.ze,n);return this.ze=md(),this.je=Ew(),this.Je=Ew(),this.He=new Ci(Hr),i}Ze(e,r){if(!this.nt(e))return;const n=this.It(e,r.key)?2:0;this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;const i=this.tt(e);this.It(e,r)?i.qe(r,1):i.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new KF,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new ya(Hr),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new ya(Hr),this.je=this.je.insert(e,r)),r}nt(e){const r=this.st(e)!==null;return r||nr("WatchChangeAggregator","Detected inactive target",e),r}st(e){const r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new KF),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function Ew(){return new Ci(pr.comparator)}function ZF(){return new Ci(pr.comparator)}const IMe=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),MMe=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),DMe=(()=>({and:"AND",or:"OR"}))();class OMe{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function i4(t,e){return t.useProto3Json||RS(e)?e:{value:e}}function Qk(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function GK(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function RMe(t,e){return Qk(t,e.toTimestamp())}function Yc(t){return Cn(!!t,49232),Lr.fromTimestamp(function(r){const n=Xh(r);return new jn(n.seconds,n.nanos)}(t))}function E3(t,e){return a4(t,e).canonicalString()}function a4(t,e){const r=function(i){return new Vn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function WK(t){const e=Vn.fromString(t);return Cn(YK(e),10190,{key:e.toString()}),e}function s4(t,e){return E3(t.databaseId,e.path)}function WA(t,e){const r=WK(e);if(r.get(1)!==t.databaseId.projectId)throw new Yt(wt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Yt(wt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new pr(KK(r))}function HK(t,e){return E3(t.databaseId,e)}function LMe(t){const e=WK(t);return e.length===4?Vn.emptyPath():KK(e)}function o4(t){return new Vn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KK(t){return Cn(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function XF(t,e,r){return{name:s4(t,e),fields:r.value.mapValue.fields}}function zMe(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Nr(39313,{state:g})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(g,v){return g.useProto3Json?(Cn(v===void 0||typeof v=="string",58123),Ua.fromBase64String(v||"")):(Cn(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),Ua.fromUint8Array(v||new Uint8Array))}(t,e.targetChange.resumeToken),u=e.targetChange.cause,a=u&&function(g){const v=g.code===void 0?wt.UNKNOWN:VK(g.code);return new Yt(v,g.message||"")}(u);r=new qK(n,i,o,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=WA(t,n.document.name),o=Yc(n.document.updateTime),u=n.document.createTime?Yc(n.document.createTime):Lr.min(),a=new Ks({mapValue:{fields:n.document.fields}}),p=ls.newFoundDocument(i,o,u,a),g=n.targetIds||[],v=n.removedTargetIds||[];r=new i2(g,v,p.key,p)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=WA(t,n.document),o=n.readTime?Yc(n.readTime):Lr.min(),u=ls.newNoDocument(i,o),a=n.removedTargetIds||[];r=new i2([],a,u.key,u)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=WA(t,n.document),o=n.removedTargetIds||[];r=new i2([],o,i,null)}else{if(!("filter"in e))return Nr(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,u=new AMe(i,o),a=n.targetId;r=new UK(a,u)}}return r}function $Me(t,e){let r;if(e instanceof xb)r={update:XF(t,e.key,e.value)};else if(e instanceof k3)r={delete:s4(t,e.key)};else if(e instanceof mf)r={update:XF(t,e.key,e.data),updateMask:KMe(e.fieldMask)};else{if(!(e instanceof SMe))return Nr(16599,{Rt:e.type});r={verify:s4(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,u){const a=u.transform;if(a instanceof Yk)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof B_)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof V_)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Jk)return{fieldPath:u.field.canonicalString(),increment:a.Ee};throw Nr(20930,{transform:u.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:RMe(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Nr(27497)}(t,e.precondition)),r}function FMe(t,e){return t&&t.length>0?(Cn(e!==void 0,14353),t.map(r=>function(i,o){let u=i.updateTime?Yc(i.updateTime):Yc(o);return u.isEqual(Lr.min())&&(u=Yc(o)),new wMe(u,i.transformResults||[])}(r,e))):[]}function BMe(t,e){return{documents:[HK(t,e.path)]}}function VMe(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=HK(t,i);const o=function(g){if(g.length!==0)return XK(uc.create(g,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const u=function(g){if(g.length!==0)return g.map(v=>function(T){return{field:Qm(T.field),direction:GMe(T.dir)}}(v))}(e.orderBy);u&&(r.structuredQuery.orderBy=u);const a=i4(t,e.limit);return a!==null&&(r.structuredQuery.limit=a),e.startAt&&(r.structuredQuery.startAt=function(g){return{before:g.inclusive,values:g.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(g){return{before:!g.inclusive,values:g.position}}(e.endAt)),{Vt:r,parent:i}}function UMe(t){let e=LMe(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Cn(n===1,65062);const v=r.from[0];v.allDescendants?i=v.collectionId:e=e.child(v.collectionId)}let o=[];r.where&&(o=function(w){const T=ZK(w);return T instanceof uc&&EK(T)?T.getFilters():[T]}(r.where));let u=[];r.orderBy&&(u=function(w){return w.map(T=>function(I){return new F_(eg(I.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction))}(T))}(r.orderBy));let a=null;r.limit&&(a=function(w){let T;return T=typeof w=="object"?w.value:w,RS(T)?null:T}(r.limit));let p=null;r.startAt&&(p=function(w){const T=!!w.before,A=w.values||[];return new A0(A,T)}(r.startAt));let g=null;return r.endAt&&(g=function(w){const T=!w.before,A=w.values||[];return new A0(A,T)}(r.endAt)),cMe(e,i,u,o,a,"F",p,g)}function qMe(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Nr(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function ZK(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=eg(r.unaryFilter.field);return ra.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=eg(r.unaryFilter.field);return ra.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=eg(r.unaryFilter.field);return ra.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=eg(r.unaryFilter.field);return ra.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Nr(61313);default:return Nr(60726)}}(t):t.fieldFilter!==void 0?function(r){return ra.create(eg(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Nr(58110);default:return Nr(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return uc.create(r.compositeFilter.filters.map(n=>ZK(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Nr(1026)}}(r.compositeFilter.op))}(t):Nr(30097,{filter:t})}function GMe(t){return IMe[t]}function WMe(t){return MMe[t]}function HMe(t){return DMe[t]}function Qm(t){return{fieldPath:t.canonicalString()}}function eg(t){return Fa.fromServerFormat(t.fieldPath)}function XK(t){return t instanceof ra?function(r){if(r.op==="=="){if(LF(r.value))return{unaryFilter:{field:Qm(r.field),op:"IS_NAN"}};if(RF(r.value))return{unaryFilter:{field:Qm(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(LF(r.value))return{unaryFilter:{field:Qm(r.field),op:"IS_NOT_NAN"}};if(RF(r.value))return{unaryFilter:{field:Qm(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qm(r.field),op:WMe(r.op),value:r.value}}}(t):t instanceof uc?function(r){const n=r.getFilters().map(i=>XK(i));return n.length===1?n[0]:{compositeFilter:{op:HMe(r.op),filters:n}}}(t):Nr(54877,{filter:t})}function KMe(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function YK(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,r,n,i,o=Lr.min(),u=Lr.min(),a=Ua.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=a,this.expectedCount=p}withSequenceNumber(e){return new bh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new bh(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZMe{constructor(e){this.gt=e}}function XMe(t){const e=UMe({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Xk(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YMe{constructor(){this.Dn=new JMe}addToCollectionParentIndex(e,r){return this.Dn.add(r),Dt.resolve()}getCollectionParents(e,r){return Dt.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return Dt.resolve()}deleteFieldIndex(e,r){return Dt.resolve()}deleteAllFieldIndexes(e){return Dt.resolve()}createTargetIndexes(e,r){return Dt.resolve()}getDocumentsMatchingTarget(e,r){return Dt.resolve(null)}getIndexType(e,r){return Dt.resolve(0)}getFieldIndexes(e,r){return Dt.resolve([])}getNextCollectionGroupToUpdate(e){return Dt.resolve(null)}getMinOffset(e,r){return Dt.resolve(Zh.min())}getMinOffsetFromCollectionGroup(e,r){return Dt.resolve(Zh.min())}updateCollectionGroup(e,r,n){return Dt.resolve()}updateIndexEntries(e,r){return Dt.resolve()}}class JMe{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new ya(Vn.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ya(Vn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},JK=41943040;class Ws{static withCacheSize(e){return new Ws(e,Ws.DEFAULT_COLLECTION_PERCENTILE,Ws.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ws.DEFAULT_COLLECTION_PERCENTILE=10,Ws.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ws.DEFAULT=new Ws(JK,Ws.DEFAULT_COLLECTION_PERCENTILE,Ws.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ws.DISABLED=new Ws(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new N0(0)}static ur(){return new N0(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF="LruGarbageCollector",QMe=1048576;function QF([t,e],[r,n]){const i=Hr(t,r);return i===0?Hr(e,n):i}class e3e{constructor(e){this.Tr=e,this.buffer=new ya(QF),this.Ir=0}dr(){return++this.Ir}Er(e){const r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();QF(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class t3e{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){nr(JF,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){sy(r)?nr(JF,"Ignoring IndexedDB error during garbage collection: ",r):await ay(r)}await this.Rr(3e5)})}}class r3e{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Dt.resolve(OS.ue);const n=new e3e(r);return this.Vr.forEachTarget(e,i=>n.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>n.Er(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(nr("LruGarbageCollector","Garbage collection skipped; disabled"),Dt.resolve(YF)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(nr("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),YF):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,i,o,u,a,p,g;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(w=>(w>this.params.maximumSequenceNumbersToCollect?(nr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),i=this.params.maximumSequenceNumbersToCollect):i=w,u=Date.now(),this.nthSequenceNumber(e,i))).next(w=>(n=w,a=Date.now(),this.removeTargets(e,n,r))).next(w=>(o=w,p=Date.now(),this.removeOrphanedDocuments(e,n))).next(w=>(g=Date.now(),Ym()<=on.DEBUG&&nr("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-v}ms
	Determined least recently used ${i} in `+(a-u)+`ms
	Removed ${o} targets in `+(p-a)+`ms
	Removed ${w} documents in `+(g-p)+`ms
Total Duration: ${g-v}ms`),Dt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:w})))}}function n3e(t,e){return new r3e(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3e{constructor(){this.changes=new Qp(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,ls.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Dt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3e{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3e{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Av(n.mutation,i,So.empty(),jn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,en()).next(()=>n))}getLocalViewOfDocuments(e,r,n=en()){const i=yp();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let u=Wx();return o.forEach((a,p)=>{u=u.insert(a,p.overlayedDocument)}),u}))}getOverlayedDocuments(e,r){const n=yp();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,en()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((u,a)=>{r.set(u,a)})})}computeViews(e,r,n,i){let o=md();const u=jv(),a=function(){return jv()}();return r.forEach((p,g)=>{const v=n.get(g.key);i.has(g.key)&&(v===void 0||v.mutation instanceof mf)?o=o.insert(g.key,g):v!==void 0?(u.set(g.key,v.mutation.getFieldMask()),Av(v.mutation,g,v.mutation.getFieldMask(),jn.now())):u.set(g.key,So.empty())}),this.recalculateAndSaveOverlays(e,o).next(p=>(p.forEach((g,v)=>u.set(g,v)),r.forEach((g,v)=>{var w;return a.set(g,new a3e(v,(w=u.get(g))!==null&&w!==void 0?w:null))}),a))}recalculateAndSaveOverlays(e,r){const n=jv();let i=new Ci((u,a)=>u-a),o=en();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(u=>{for(const a of u)a.keys().forEach(p=>{const g=r.get(p);if(g===null)return;let v=n.get(p)||So.empty();v=a.applyToLocalView(g,v),n.set(p,v);const w=(i.get(a.batchId)||en()).add(p);i=i.insert(a.batchId,w)})}).next(()=>{const u=[],a=i.getReverseIterator();for(;a.hasNext();){const p=a.getNext(),g=p.key,v=p.value,w=DK();v.forEach(T=>{if(!o.has(T)){const A=FK(r.get(T),n.get(T));A!==null&&w.set(T,A),o=o.add(T)}}),u.push(this.documentOverlayCache.saveOverlays(e,g,w))}return Dt.waitFor(u)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(u){return pr.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):b3(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const u=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):Dt.resolve(yp());let a=R_,p=o;return u.next(g=>Dt.forEach(g,(v,w)=>(a<w.largestBatchId&&(a=w.largestBatchId),o.get(v)?Dt.resolve():this.remoteDocumentCache.getEntry(e,v).next(T=>{p=p.insert(v,T)}))).next(()=>this.populateOverlays(e,g,o)).next(()=>this.computeViews(e,p,g,en())).next(v=>({batchId:a,changes:MK(v)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new pr(r)).next(n=>{let i=Wx();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let u=Wx();return this.indexManager.getCollectionParents(e,o).next(a=>Dt.forEach(a,p=>{const g=function(w,T){return new Jp(T,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)}(r,p.child(o));return this.getDocumentsMatchingCollectionQuery(e,g,n,i).next(v=>{v.forEach((w,T)=>{u=u.insert(w,T)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(u=>{o.forEach((p,g)=>{const v=g.getKey();u.get(v)===null&&(u=u.insert(v,ls.newInvalidDocument(v)))});let a=Wx();return u.forEach((p,g)=>{const v=o.get(p);v!==void 0&&Av(v.mutation,g,So.empty(),jn.now()),BS(r,g)&&(a=a.insert(p,g))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3e{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return Dt.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Yc(i.createTime)}}(r)),Dt.resolve()}getNamedQuery(e,r){return Dt.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,function(i){return{name:i.name,query:XMe(i.bundledQuery),readTime:Yc(i.readTime)}}(r)),Dt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3e{constructor(){this.overlays=new Ci(pr.comparator),this.kr=new Map}getOverlay(e,r){return Dt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=yp();return Dt.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.wt(e,r,o)}),Dt.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.kr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(n)),Dt.resolve()}getOverlaysForCollection(e,r,n){const i=yp(),o=r.length+1,u=new pr(r.child("")),a=this.overlays.getIteratorFrom(u);for(;a.hasNext();){const p=a.getNext().value,g=p.getKey();if(!r.isPrefixOf(g.path))break;g.path.length===o&&p.largestBatchId>n&&i.set(p.getKey(),p)}return Dt.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new Ci((g,v)=>g-v);const u=this.overlays.getIterator();for(;u.hasNext();){const g=u.getNext().value;if(g.getKey().getCollectionGroup()===r&&g.largestBatchId>n){let v=o.get(g.largestBatchId);v===null&&(v=yp(),o=o.insert(g.largestBatchId,v)),v.set(g.getKey(),g)}}const a=yp(),p=o.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((g,v)=>a.set(g,v)),!(a.size()>=i)););return Dt.resolve(a)}wt(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const u=this.kr.get(i.largestBatchId).delete(n.key);this.kr.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(n.key,new jMe(r,n));let o=this.kr.get(r);o===void 0&&(o=en(),this.kr.set(r,o)),this.kr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3e{constructor(){this.sessionToken=Ua.EMPTY_BYTE_STRING}getSessionToken(e){return Dt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Dt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(){this.qr=new ya(Ea.Qr),this.$r=new ya(Ea.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){const n=new Ea(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Wr(new Ea(e,r))}Gr(e,r){e.forEach(n=>this.removeReference(n,r))}zr(e){const r=new pr(new Vn([])),n=new Ea(r,e),i=new Ea(r,e+1),o=[];return this.$r.forEachInRange([n,i],u=>{this.Wr(u),o.push(u.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const r=new pr(new Vn([])),n=new Ea(r,e),i=new Ea(r,e+1);let o=en();return this.$r.forEachInRange([n,i],u=>{o=o.add(u.key)}),o}containsKey(e){const r=new Ea(e,0),n=this.qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Ea{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return pr.comparator(e.key,r.key)||Hr(e.Hr,r.Hr)}static Ur(e,r){return Hr(e.Hr,r.Hr)||pr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3e{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new ya(Ea.Qr)}checkEmpty(e){return Dt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new EMe(o,r,n,i);this.mutationQueue.push(u);for(const a of i)this.Yr=this.Yr.add(new Ea(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Dt.resolve(u)}lookupMutationBatch(e,r){return Dt.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.Xr(n),o=i<0?0:i;return Dt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Dt.resolve(this.mutationQueue.length===0?y3:this.er-1)}getAllMutationBatches(e){return Dt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Ea(r,0),i=new Ea(r,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([n,i],u=>{const a=this.Zr(u.Hr);o.push(a)}),Dt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ya(Hr);return r.forEach(i=>{const o=new Ea(i,0),u=new Ea(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,u],a=>{n=n.add(a.Hr)})}),Dt.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;pr.isDocumentKey(o)||(o=o.child(""));const u=new Ea(new pr(o),0);let a=new ya(Hr);return this.Yr.forEachWhile(p=>{const g=p.key.path;return!!n.isPrefixOf(g)&&(g.length===i&&(a=a.add(p.Hr)),!0)},u),Dt.resolve(this.ei(a))}ei(e){const r=[];return e.forEach(n=>{const i=this.Zr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Cn(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return Dt.forEach(r.mutations,i=>{const o=new Ea(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){const n=new Ea(r,0),i=this.Yr.firstAfterOrEqual(n);return Dt.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Dt.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d3e{constructor(e){this.ni=e,this.docs=function(){return new Ci(pr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,u=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Dt.resolve(n?n.document.mutableCopy():ls.newInvalidDocument(r))}getEntries(e,r){let n=md();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():ls.newInvalidDocument(i))}),Dt.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=md();const u=r.path,a=new pr(u.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(a);for(;p.hasNext();){const{key:g,value:{document:v}}=p.getNext();if(!u.isPrefixOf(g.path))break;g.path.length>u.length+1||VIe(BIe(v),n)<=0||(i.has(v.key)||BS(r,v))&&(o=o.insert(v.key,v.mutableCopy()))}return Dt.resolve(o)}getAllFromCollectionGroup(e,r,n,i){Nr(9500)}ri(e,r){return Dt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new h3e(this)}getSize(e){return Dt.resolve(this.size)}}class h3e extends i3e{constructor(e){super(),this.Or=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Or.addEntry(e,i)):this.Or.removeEntry(n)}),Dt.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3e{constructor(e){this.persistence=e,this.ii=new Qp(r=>v3(r),_3),this.lastRemoteSnapshotVersion=Lr.min(),this.highestTargetId=0,this.si=0,this.oi=new j3,this.targetCount=0,this._i=N0.ar()}forEachTarget(e,r){return this.ii.forEach((n,i)=>r(i)),Dt.resolve()}getLastRemoteSnapshotVersion(e){return Dt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Dt.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),Dt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),Dt.resolve()}hr(e){this.ii.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this._i=new N0(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,Dt.resolve()}updateTargetData(e,r){return this.hr(r),Dt.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,Dt.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.ii.forEach((u,a)=>{a.sequenceNumber<=r&&n.get(a.targetId)===null&&(this.ii.delete(u),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),Dt.waitFor(o).next(()=>i)}getTargetCount(e){return Dt.resolve(this.targetCount)}getTargetData(e,r){const n=this.ii.get(r)||null;return Dt.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),Dt.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(u=>{o.push(i.markPotentiallyOrphaned(e,u))}),Dt.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),Dt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.oi.Jr(r);return Dt.resolve(n)}containsKey(e,r){return Dt.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QK{constructor(e,r){this.ai={},this.overlays={},this.ui=new OS(0),this.ci=!1,this.ci=!0,this.li=new c3e,this.referenceDelegate=e(this),this.hi=new f3e(this),this.indexManager=new YMe,this.remoteDocumentCache=function(i){return new d3e(i)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new ZMe(r),this.Ti=new o3e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new l3e,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new u3e(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){nr("MemoryPersistence","Starting transaction:",e);const i=new p3e(this.ui.next());return this.referenceDelegate.Ii(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,r){return Dt.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class p3e extends qIe{constructor(e){super(),this.currentSequenceNumber=e}}class A3{constructor(e){this.persistence=e,this.Ai=new j3,this.Ri=null}static Vi(e){return new A3(e)}get mi(){if(this.Ri)return this.Ri;throw Nr(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),Dt.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),Dt.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),Dt.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(i=>this.mi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.mi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Dt.forEach(this.mi,n=>{const i=pr.fromPath(n);return this.fi(e,i).next(o=>{o||r.removeEntry(i,Lr.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(n=>{n?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return Dt.or([()=>Dt.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class eT{constructor(e,r){this.persistence=e,this.gi=new Qp(n=>HIe(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=n3e(this,r)}static Vi(e,r){return new eT(e,r)}Ii(){}di(e){return Dt.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){const r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}yr(e){let r=0;return this.gr(e,n=>{r++}).next(()=>r)}gr(e,r){return Dt.forEach(this.gi,(n,i)=>this.Sr(e,n,i).next(o=>o?Dt.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,u=>this.Sr(e,u,r).next(a=>{a||(n++,o.removeEntry(u,Lr.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),Dt.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),Dt.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),Dt.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),Dt.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=t2(e.data.value)),r}Sr(e,r,n){return Dt.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.gi.get(r);return Dt.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=i}static Es(e,r){let n=en(),i=en();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new N3(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3e{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return p4e()?8:GIe(h4e())>0?6:4}()}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ps(e,r).next(u=>{o.result=u}).next(()=>{if(!o.result)return this.ys(e,r,i,n).next(u=>{o.result=u})}).next(()=>{if(o.result)return;const u=new m3e;return this.ws(e,r,u).next(a=>{if(o.result=a,this.Rs)return this.Ss(e,r,u,a.size)})}).next(()=>o.result)}Ss(e,r,n,i){return n.documentReadCount<this.Vs?(Ym()<=on.DEBUG&&nr("QueryEngine","SDK will not create cache indexes for query:",Jm(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Dt.resolve()):(Ym()<=on.DEBUG&&nr("QueryEngine","Query:",Jm(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.fs*i?(Ym()<=on.DEBUG&&nr("QueryEngine","The SDK decides to create cache indexes for query:",Jm(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xc(r))):Dt.resolve())}ps(e,r){if(BF(r))return Dt.resolve(null);let n=Xc(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Xk(r,null,"F"),n=Xc(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const u=en(...o);return this.gs.getDocuments(e,u).next(a=>this.indexManager.getMinOffset(e,n).next(p=>{const g=this.bs(r,a);return this.Ds(r,g,u,p.readTime)?this.ps(e,Xk(r,null,"F")):this.vs(e,g,r,p)}))})))}ys(e,r,n,i){return BF(r)||i.isEqual(Lr.min())?Dt.resolve(null):this.gs.getDocuments(e,n).next(o=>{const u=this.bs(r,o);return this.Ds(r,u,n,i)?Dt.resolve(null):(Ym()<=on.DEBUG&&nr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Jm(r)),this.vs(e,u,r,FIe(i,R_)).next(a=>a))})}bs(e,r){let n=new ya(PK(e));return r.forEach((i,o)=>{BS(e,o)&&(n=n.add(o))}),n}Ds(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,r,n){return Ym()<=on.DEBUG&&nr("QueryEngine","Using full collection scan to execute query:",Jm(r)),this.gs.getDocumentsMatchingQuery(e,r,Zh.min(),n)}vs(e,r,n,i){return this.gs.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(u=>{o=o.insert(u.key,u)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C3="LocalStore",y3e=3e8;class x3e{constructor(e,r,n,i){this.persistence=e,this.Cs=r,this.serializer=i,this.Fs=new Ci(Hr),this.Ms=new Qp(o=>v3(o),_3),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new s3e(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}function v3e(t,e,r,n){return new x3e(t,e,r,n)}async function eZ(t,e){const r=Br(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Ns(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const u=[],a=[];let p=en();for(const g of i){u.push(g.batchId);for(const v of g.mutations)p=p.add(v.key)}for(const g of o){a.push(g.batchId);for(const v of g.mutations)p=p.add(v.key)}return r.localDocuments.getDocuments(n,p).next(g=>({Bs:g,removedBatchIds:u,addedBatchIds:a}))})})}function _3e(t,e){const r=Br(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Os.newChangeBuffer({trackRemovals:!0});return function(a,p,g,v){const w=g.batch,T=w.keys();let A=Dt.resolve();return T.forEach(I=>{A=A.next(()=>v.getEntry(p,I)).next(P=>{const D=g.docVersions.get(I);Cn(D!==null,48541),P.version.compareTo(D)<0&&(w.applyToRemoteDocument(P,g),P.isValidDocument()&&(P.setReadTime(g.commitVersion),v.addEntry(P)))})}),A.next(()=>a.mutationQueue.removeMutationBatch(p,w))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let p=en();for(let g=0;g<a.mutationResults.length;++g)a.mutationResults[g].transformResults.length>0&&(p=p.add(a.batch.mutations[g].key));return p}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function tZ(t){const e=Br(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function b3e(t,e){const r=Br(t),n=e.snapshotVersion;let i=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const u=r.Os.newChangeBuffer({trackRemovals:!0});i=r.Fs;const a=[];e.targetChanges.forEach((v,w)=>{const T=i.get(w);if(!T)return;a.push(r.hi.removeMatchingKeys(o,v.removedDocuments,w).next(()=>r.hi.addMatchingKeys(o,v.addedDocuments,w)));let A=T.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(w)!==null?A=A.withResumeToken(Ua.EMPTY_BYTE_STRING,Lr.min()).withLastLimboFreeSnapshotVersion(Lr.min()):v.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(v.resumeToken,n)),i=i.insert(w,A),function(P,D,L){return P.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=y3e?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0}(T,A,v)&&a.push(r.hi.updateTargetData(o,A))});let p=md(),g=en();if(e.documentUpdates.forEach(v=>{e.resolvedLimboDocuments.has(v)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(o,v))}),a.push(w3e(o,u,e.documentUpdates).next(v=>{p=v.Ls,g=v.ks})),!n.isEqual(Lr.min())){const v=r.hi.getLastRemoteSnapshotVersion(o).next(w=>r.hi.setTargetsMetadata(o,o.currentSequenceNumber,n));a.push(v)}return Dt.waitFor(a).next(()=>u.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,p,g)).next(()=>p)}).then(o=>(r.Fs=i,o))}function w3e(t,e,r){let n=en(),i=en();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let u=md();return r.forEach((a,p)=>{const g=o.get(a);p.isFoundDocument()!==g.isFoundDocument()&&(i=i.add(a)),p.isNoDocument()&&p.version.isEqual(Lr.min())?(e.removeEntry(a,p.readTime),u=u.insert(a,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),u=u.insert(a,p)):nr(C3,"Ignoring outdated watch update for ",a,". Current version:",g.version," Watch version:",p.version)}),{Ls:u,ks:i}})}function k3e(t,e){const r=Br(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=y3),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function T3e(t,e){const r=Br(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.hi.getTargetData(n,e).next(o=>o?(i=o,Dt.resolve(i)):r.hi.allocateTargetId(n).next(u=>(i=new bh(e,u,"TargetPurposeListen",n.currentSequenceNumber),r.hi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Fs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(n.targetId,n),r.Ms.set(e,n.targetId)),n})}async function l4(t,e,r){const n=Br(t),i=n.Fs.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,u=>n.persistence.referenceDelegate.removeTarget(u,i))}catch(u){if(!sy(u))throw u;nr(C3,`Failed to update sequence numbers for target ${e}: ${u}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(i.target)}function eB(t,e,r){const n=Br(t);let i=Lr.min(),o=en();return n.persistence.runTransaction("Execute query","readwrite",u=>function(p,g,v){const w=Br(p),T=w.Ms.get(v);return T!==void 0?Dt.resolve(w.Fs.get(T)):w.hi.getTargetData(g,v)}(n,u,Xc(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(u,a.targetId).next(p=>{o=p})}).next(()=>n.Cs.getDocumentsMatchingQuery(u,e,r?i:Lr.min(),r?o:en())).next(a=>(S3e(n,dMe(e),a),{documents:a,qs:o})))}function S3e(t,e,r){let n=t.xs.get(e)||Lr.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.xs.set(e,n)}class tB{constructor(){this.activeTargetIds=yMe()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class E3e{constructor(){this.Fo=new tB,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new tB,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3e{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rB="ConnectivityMonitor";class nB{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){nr(rB,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){nr(rB,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jw=null;function c4(){return jw===null?jw=function(){return 268435456+Math.round(2147483648*Math.random())}():jw++,"0x"+jw.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA="RestConnection",A3e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class N3e{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.Ko=this.databaseId.database===Hk?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,r,n,i,o){const u=c4(),a=this.Go(e,r.toUriEncodedString());nr(HA,`Sending RPC '${e}' ${u}:`,a,n);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(p,i,o);const{host:g}=new URL(a),v=MS(g);return this.jo(e,a,p,n,v).then(w=>(nr(HA,`Received RPC '${e}' ${u}: `,w),w),w=>{throw Kh(HA,`RPC '${e}' ${u} failed with error: `,w,"url: ",a,"request:",n),w})}Jo(e,r,n,i,o,u){return this.Wo(e,r,n,i,o)}zo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+iy}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}Go(e,r){const n=A3e[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C3e{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs="WebChannelConnection";class P3e extends N3e{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,i,o){const u=c4();return new Promise((a,p)=>{const g=new nK;g.setWithCredentials(!0),g.listenOnce(iK.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case e2.NO_ERROR:const w=g.getResponseJson();nr(rs,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(w)),a(w);break;case e2.TIMEOUT:nr(rs,`RPC '${e}' ${u} timed out`),p(new Yt(wt.DEADLINE_EXCEEDED,"Request time out"));break;case e2.HTTP_ERROR:const T=g.getStatus();if(nr(rs,`RPC '${e}' ${u} failed with status:`,T,"response text:",g.getResponseText()),T>0){let A=g.getResponseJson();Array.isArray(A)&&(A=A[0]);const I=A==null?void 0:A.error;if(I&&I.status&&I.message){const P=function(L){const O=L.toLowerCase().replace(/_/g,"-");return Object.values(wt).indexOf(O)>=0?O:wt.UNKNOWN}(I.status);p(new Yt(P,I.message))}else p(new Yt(wt.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new Yt(wt.UNAVAILABLE,"Connection failed."));break;default:Nr(9055,{c_:e,streamId:u,l_:g.getLastErrorCode(),h_:g.getLastError()})}}finally{nr(rs,`RPC '${e}' ${u} completed.`)}});const v=JSON.stringify(i);nr(rs,`RPC '${e}' ${u} sending request:`,i),g.send(r,"POST",v,n,15)})}P_(e,r,n){const i=c4(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=oK(),a=sK(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.zo(p.initMessageHeaders,r,n),p.encodeInitMessageHeaders=!0;const v=o.join("");nr(rs,`Creating RPC '${e}' stream ${i}: ${v}`,p);const w=u.createWebChannel(v,p);this.T_(w);let T=!1,A=!1;const I=new C3e({Ho:D=>{A?nr(rs,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(T||(nr(rs,`Opening RPC '${e}' stream ${i} transport.`),w.open(),T=!0),nr(rs,`RPC '${e}' stream ${i} sending:`,D),w.send(D))},Yo:()=>w.close()}),P=(D,L,O)=>{D.listen(L,$=>{try{O($)}catch(G){setTimeout(()=>{throw G},0)}})};return P(w,Gx.EventType.OPEN,()=>{A||(nr(rs,`RPC '${e}' stream ${i} transport opened.`),I.s_())}),P(w,Gx.EventType.CLOSE,()=>{A||(A=!0,nr(rs,`RPC '${e}' stream ${i} transport closed`),I.__(),this.I_(w))}),P(w,Gx.EventType.ERROR,D=>{A||(A=!0,Kh(rs,`RPC '${e}' stream ${i} transport errored. Name:`,D.name,"Message:",D.message),I.__(new Yt(wt.UNAVAILABLE,"The operation could not be completed")))}),P(w,Gx.EventType.MESSAGE,D=>{var L;if(!A){const O=D.data[0];Cn(!!O,16349);const $=O,G=($==null?void 0:$.error)||((L=$[0])===null||L===void 0?void 0:L.error);if(G){nr(rs,`RPC '${e}' stream ${i} received error:`,G);const B=G.status;let J=function(V){const se=Yi[V];if(se!==void 0)return VK(se)}(B),W=G.message;J===void 0&&(J=wt.INTERNAL,W="Unknown error status: "+B+" with message "+G.message),A=!0,I.__(new Yt(J,W)),w.close()}else nr(rs,`RPC '${e}' stream ${i} received:`,O),I.a_(O)}}),P(a,aK.STAT_EVENT,D=>{D.stat===YP.PROXY?nr(rs,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===YP.NOPROXY&&nr(rs,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{I.o_()},0),I}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function KA(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(t){return new OMe(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rZ{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),i=Math.max(0,r-n);i>0&&nr("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iB="PersistentStream";class nZ{constructor(e,r,n,i,o,u,a,p){this.Fi=e,this.w_=n,this.S_=i,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=a,this.listener=p,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new rZ(e,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():r&&r.code===wt.RESOURCE_EXHAUSTED?(pd(r.toString()),pd("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===wt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.b_===r&&this.W_(n,i)},n=>{e(()=>{const i=new Yt(wt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(i)})})}W_(e,r){const n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{n(()=>this.G_(i))}),this.stream.onMessage(i=>{n(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return nr(iB,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(nr(iB,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class I3e extends nZ{constructor(e,r,n,i,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,u),this.serializer=o}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const r=zMe(this.serializer,e),n=function(o){if(!("targetChange"in o))return Lr.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?Lr.min():u.readTime?Yc(u.readTime):Lr.min()}(e);return this.listener.J_(r,n)}H_(e){const r={};r.database=o4(this.serializer),r.addTarget=function(o,u){let a;const p=u.target;if(a=r4(p)?{documents:BMe(o,p)}:{query:VMe(o,p).Vt},a.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){a.resumeToken=GK(o,u.resumeToken);const g=i4(o,u.expectedCount);g!==null&&(a.expectedCount=g)}else if(u.snapshotVersion.compareTo(Lr.min())>0){a.readTime=Qk(o,u.snapshotVersion.toTimestamp());const g=i4(o,u.expectedCount);g!==null&&(a.expectedCount=g)}return a}(this.serializer,e);const n=qMe(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){const r={};r.database=o4(this.serializer),r.removeTarget=e,this.k_(r)}}class M3e extends nZ{constructor(e,r,n,i,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,u),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return Cn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Cn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Cn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const r=FMe(e.writeResults,e.commitTime),n=Yc(e.commitTime);return this.listener.ta(n,r)}na(){const e={};e.database=o4(this.serializer),this.k_(e)}X_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>$Me(this.serializer,n))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D3e{}class O3e extends D3e{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new Yt(wt.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Wo(e,a4(r,n),i,o,u)).catch(o=>{throw o.name==="FirebaseError"?(o.code===wt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Yt(wt.UNKNOWN,o.toString())})}Jo(e,r,n,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,a])=>this.connection.Jo(e,a4(r,n),i,u,a,o)).catch(u=>{throw u.name==="FirebaseError"?(u.code===wt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Yt(wt.UNKNOWN,u.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class R3e{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(pd(r),this._a=!1):nr("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp="RemoteStore";class L3e{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(u=>{n.enqueueAndForget(async()=>{em(this)&&(nr(Fp,"Restarting streams for network reachability change."),await async function(p){const g=Br(p);g.Ia.add(4),await _b(g),g.Aa.set("Unknown"),g.Ia.delete(4),await WS(g)}(this))})}),this.Aa=new R3e(n,i)}}async function WS(t){if(em(t))for(const e of t.da)await e(!0)}async function _b(t){for(const e of t.da)await e(!1)}function iZ(t,e){const r=Br(t);r.Ta.has(e.targetId)||(r.Ta.set(e.targetId,e),D3(r)?M3(r):oy(r).x_()&&I3(r,e))}function P3(t,e){const r=Br(t),n=oy(r);r.Ta.delete(e),n.x_()&&aZ(r,e),r.Ta.size===0&&(n.x_()?n.B_():em(r)&&r.Aa.set("Unknown"))}function I3(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Lr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}oy(t).H_(e)}function aZ(t,e){t.Ra.$e(e),oy(t).Y_(e)}function M3(t){t.Ra=new PMe({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),oy(t).start(),t.Aa.aa()}function D3(t){return em(t)&&!oy(t).M_()&&t.Ta.size>0}function em(t){return Br(t).Ia.size===0}function sZ(t){t.Ra=void 0}async function z3e(t){t.Aa.set("Online")}async function $3e(t){t.Ta.forEach((e,r)=>{I3(t,e)})}async function F3e(t,e){sZ(t),D3(t)?(t.Aa.la(e),M3(t)):t.Aa.set("Unknown")}async function B3e(t,e,r){if(t.Aa.set("Online"),e instanceof qK&&e.state===2&&e.cause)try{await async function(i,o){const u=o.cause;for(const a of o.targetIds)i.Ta.has(a)&&(await i.remoteSyncer.rejectListen(a,u),i.Ta.delete(a),i.Ra.removeTarget(a))}(t,e)}catch(n){nr(Fp,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await tT(t,n)}else if(e instanceof i2?t.Ra.Ye(e):e instanceof UK?t.Ra.it(e):t.Ra.et(e),!r.isEqual(Lr.min()))try{const n=await tZ(t.localStore);r.compareTo(n)>=0&&await function(o,u){const a=o.Ra.Pt(u);return a.targetChanges.forEach((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const v=o.Ta.get(g);v&&o.Ta.set(g,v.withResumeToken(p.resumeToken,u))}}),a.targetMismatches.forEach((p,g)=>{const v=o.Ta.get(p);if(!v)return;o.Ta.set(p,v.withResumeToken(Ua.EMPTY_BYTE_STRING,v.snapshotVersion)),aZ(o,p);const w=new bh(v.target,p,g,v.sequenceNumber);I3(o,w)}),o.remoteSyncer.applyRemoteEvent(a)}(t,r)}catch(n){nr(Fp,"Failed to raise snapshot:",n),await tT(t,n)}}async function tT(t,e,r){if(!sy(e))throw e;t.Ia.add(1),await _b(t),t.Aa.set("Offline"),r||(r=()=>tZ(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{nr(Fp,"Retrying IndexedDB access"),await r(),t.Ia.delete(1),await WS(t)})}function oZ(t,e){return e().catch(r=>tT(t,r,e))}async function HS(t){const e=Br(t),r=Qh(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:y3;for(;V3e(e);)try{const i=await k3e(e.localStore,n);if(i===null){e.Pa.length===0&&r.B_();break}n=i.batchId,U3e(e,i)}catch(i){await tT(e,i)}lZ(e)&&cZ(e)}function V3e(t){return em(t)&&t.Pa.length<10}function U3e(t,e){t.Pa.push(e);const r=Qh(t);r.x_()&&r.Z_&&r.X_(e.mutations)}function lZ(t){return em(t)&&!Qh(t).M_()&&t.Pa.length>0}function cZ(t){Qh(t).start()}async function q3e(t){Qh(t).na()}async function G3e(t){const e=Qh(t);for(const r of t.Pa)e.X_(r.mutations)}async function W3e(t,e,r){const n=t.Pa.shift(),i=T3.from(n,e,r);await oZ(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await HS(t)}async function H3e(t,e){e&&Qh(t).Z_&&await async function(n,i){if(function(u){return NMe(u)&&u!==wt.ABORTED}(i.code)){const o=n.Pa.shift();Qh(n).N_(),await oZ(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await HS(n)}}(t,e),lZ(t)&&cZ(t)}async function aB(t,e){const r=Br(t);r.asyncQueue.verifyOperationInProgress(),nr(Fp,"RemoteStore received new credentials");const n=em(r);r.Ia.add(3),await _b(r),n&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ia.delete(3),await WS(r)}async function K3e(t,e){const r=Br(t);e?(r.Ia.delete(2),await WS(r)):e||(r.Ia.add(2),await _b(r),r.Aa.set("Unknown"))}function oy(t){return t.Va||(t.Va=function(r,n,i){const o=Br(r);return o.ia(),new I3e(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Zo:z3e.bind(null,t),e_:$3e.bind(null,t),n_:F3e.bind(null,t),J_:B3e.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),D3(t)?M3(t):t.Aa.set("Unknown")):(await t.Va.stop(),sZ(t))})),t.Va}function Qh(t){return t.ma||(t.ma=function(r,n,i){const o=Br(r);return o.ia(),new M3e(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:q3e.bind(null,t),n_:H3e.bind(null,t),ea:G3e.bind(null,t),ta:W3e.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await HS(t)):(await t.ma.stop(),t.Pa.length>0&&(nr(Fp,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new td,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const u=Date.now()+n,a=new O3(e,r,u,i,o);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Yt(wt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function R3(t,e){if(pd("AsyncQueue",`${e}: ${t}`),sy(t))return new Yt(wt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{static emptySet(e){return new Mg(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||pr.comparator(r.key,n.key):(r,n)=>pr.comparator(r.key,n.key),this.keyedMap=Wx(),this.sortedSet=new Ci(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Mg)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Mg;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{constructor(){this.fa=new Ci(pr.comparator)}track(e){const r=e.doc.key,n=this.fa.get(r);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(r,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(r):e.type===1&&n.type===2?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):Nr(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){const e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class C0{constructor(e,r,n,i,o,u,a,p,g){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=a,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,r,n,i,o){const u=[];return r.forEach(a=>{u.push({type:0,doc:a})}),new C0(e,r,Mg.emptySet(r),u,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&FS(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3e{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class X3e{constructor(){this.queries=oB(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,n){const i=Br(r),o=i.queries;i.queries=oB(),o.forEach((u,a)=>{for(const p of a.wa)p.onError(n)})})(this,new Yt(wt.ABORTED,"Firestore shutting down"))}}function oB(){return new Qp(t=>CK(t),FS)}async function L3(t,e){const r=Br(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.Sa()&&e.ba()&&(n=2):(o=new Z3e,n=e.ba()?0:1);try{switch(n){case 0:o.ya=await r.onListen(i,!0);break;case 1:o.ya=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(u){const a=R3(u,`Initialization of query '${Jm(e.query)}' failed`);return void e.onError(a)}r.queries.set(i,o),o.wa.push(e),e.va(r.onlineState),o.ya&&e.Ca(o.ya)&&$3(r)}async function z3(t,e){const r=Br(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const u=o.wa.indexOf(e);u>=0&&(o.wa.splice(u,1),o.wa.length===0?i=e.ba()?0:1:!o.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function Y3e(t,e){const r=Br(t);let n=!1;for(const i of e){const o=i.query,u=r.queries.get(o);if(u){for(const a of u.wa)a.Ca(i)&&(n=!0);u.ya=i}}n&&$3(r)}function J3e(t,e,r){const n=Br(t),i=n.queries.get(e);if(i)for(const o of i.wa)o.onError(r);n.queries.delete(e)}function $3(t){t.Da.forEach(e=>{e.next()})}var u4,lB;(lB=u4||(u4={})).Fa="default",lB.Cache="cache";class F3{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new C0(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){if(!e.fromCache||!this.ba())return!0;const n=r!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(e){e=C0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==u4.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uZ{constructor(e){this.key=e}}class dZ{constructor(e){this.key=e}}class Q3e{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=en(),this.mutatedKeys=en(),this.Xa=PK(e),this.eu=new Mg(this.Xa)}get tu(){return this.Ha}nu(e,r){const n=r?r.ru:new sB,i=r?r.eu:this.eu;let o=r?r.mutatedKeys:this.mutatedKeys,u=i,a=!1;const p=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,g=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((v,w)=>{const T=i.get(v),A=BS(this.query,w)?w:null,I=!!T&&this.mutatedKeys.has(T.key),P=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let D=!1;T&&A?T.data.isEqual(A.data)?I!==P&&(n.track({type:3,doc:A}),D=!0):this.iu(T,A)||(n.track({type:2,doc:A}),D=!0,(p&&this.Xa(A,p)>0||g&&this.Xa(A,g)<0)&&(a=!0)):!T&&A?(n.track({type:0,doc:A}),D=!0):T&&!A&&(n.track({type:1,doc:T}),D=!0,(p||g)&&(a=!0)),D&&(A?(u=u.add(A),o=P?o.add(v):o.delete(v)):(u=u.delete(v),o=o.delete(v)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const v=this.query.limitType==="F"?u.last():u.first();u=u.delete(v.key),o=o.delete(v.key),n.track({type:1,doc:v})}return{eu:u,ru:n,Ds:a,mutatedKeys:o}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const u=e.ru.pa();u.sort((v,w)=>function(A,I){const P=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Nr(20277,{At:D})}};return P(A)-P(I)}(v.type,w.type)||this.Xa(v.doc,w.doc)),this.su(n),i=i!=null&&i;const a=r&&!i?this.ou():[],p=this.Za.size===0&&this.current&&!i?1:0,g=p!==this.Ya;return this.Ya=p,u.length!==0||g?{snapshot:new C0(this.query,e.eu,o,u,e.mutatedKeys,p===0,g,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new sB,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=en(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const r=[];return e.forEach(n=>{this.Za.has(n)||r.push(new dZ(n))}),this.Za.forEach(n=>{e.has(n)||r.push(new uZ(n))}),r}uu(e){this.Ha=e.qs,this.Za=en();const r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return C0.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const B3="SyncEngine";class e5e{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class t5e{constructor(e){this.key=e,this.lu=!1}}class r5e{constructor(e,r,n,i,o,u){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.hu={},this.Pu=new Qp(a=>CK(a),FS),this.Tu=new Map,this.Iu=new Set,this.du=new Ci(pr.comparator),this.Eu=new Map,this.Au=new j3,this.Ru={},this.Vu=new Map,this.mu=N0.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function n5e(t,e,r=!0){const n=yZ(t);let i;const o=n.Pu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=await hZ(n,e,r,!0),i}async function i5e(t,e){const r=yZ(t);await hZ(r,e,!0,!1)}async function hZ(t,e,r,n){const i=await T3e(t.localStore,Xc(e)),o=i.targetId,u=t.sharedClientState.addLocalQueryTarget(o,r);let a;return n&&(a=await a5e(t,e,o,u==="current",i.resumeToken)),t.isPrimaryClient&&r&&iZ(t.remoteStore,i),a}async function a5e(t,e,r,n,i){t.gu=(w,T,A)=>async function(P,D,L,O){let $=D.view.nu(L);$.Ds&&($=await eB(P.localStore,D.query,!1).then(({documents:W})=>D.view.nu(W,$)));const G=O&&O.targetChanges.get(D.targetId),B=O&&O.targetMismatches.get(D.targetId)!=null,J=D.view.applyChanges($,P.isPrimaryClient,G,B);return uB(P,D.targetId,J._u),J.snapshot}(t,w,T,A);const o=await eB(t.localStore,e,!0),u=new Q3e(e,o.qs),a=u.nu(o.documents),p=vb.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),g=u.applyChanges(a,t.isPrimaryClient,p);uB(t,r,g._u);const v=new e5e(e,r,u);return t.Pu.set(e,v),t.Tu.has(r)?t.Tu.get(r).push(e):t.Tu.set(r,[e]),g.snapshot}async function s5e(t,e,r){const n=Br(t),i=n.Pu.get(e),o=n.Tu.get(i.targetId);if(o.length>1)return n.Tu.set(i.targetId,o.filter(u=>!FS(u,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await l4(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&P3(n.remoteStore,i.targetId),d4(n,i.targetId)}).catch(ay)):(d4(n,i.targetId),await l4(n.localStore,i.targetId,!0))}async function o5e(t,e){const r=Br(t),n=r.Pu.get(e),i=r.Tu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),P3(r.remoteStore,n.targetId))}async function l5e(t,e,r){const n=m5e(t);try{const i=await function(u,a){const p=Br(u),g=jn.now(),v=a.reduce((A,I)=>A.add(I.key),en());let w,T;return p.persistence.runTransaction("Locally write mutations","readwrite",A=>{let I=md(),P=en();return p.Os.getEntries(A,v).next(D=>{I=D,I.forEach((L,O)=>{O.isValidDocument()||(P=P.add(L))})}).next(()=>p.localDocuments.getOverlayedDocuments(A,I)).next(D=>{w=D;const L=[];for(const O of a){const $=TMe(O,w.get(O.key).overlayedDocument);$!=null&&L.push(new mf(O.key,$,kK($.value.mapValue),hl.exists(!0)))}return p.mutationQueue.addMutationBatch(A,g,L,a)}).next(D=>{T=D;const L=D.applyToLocalDocumentSet(w,P);return p.documentOverlayCache.saveOverlays(A,D.batchId,L)})}).then(()=>({batchId:T.batchId,changes:MK(w)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(u,a,p){let g=u.Ru[u.currentUser.toKey()];g||(g=new Ci(Hr)),g=g.insert(a,p),u.Ru[u.currentUser.toKey()]=g}(n,i.batchId,r),await bb(n,i.changes),await HS(n.remoteStore)}catch(i){const o=R3(i,"Failed to persist write");r.reject(o)}}async function fZ(t,e){const r=Br(t);try{const n=await b3e(r.localStore,e);e.targetChanges.forEach((i,o)=>{const u=r.Eu.get(o);u&&(Cn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?u.lu=!0:i.modifiedDocuments.size>0?Cn(u.lu,14607):i.removedDocuments.size>0&&(Cn(u.lu,42227),u.lu=!1))}),await bb(r,n,e)}catch(n){await ay(n)}}function cB(t,e,r){const n=Br(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Pu.forEach((o,u)=>{const a=u.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(u,a){const p=Br(u);p.onlineState=a;let g=!1;p.queries.forEach((v,w)=>{for(const T of w.wa)T.va(a)&&(g=!0)}),g&&$3(p)}(n.eventManager,e),i.length&&n.hu.J_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function c5e(t,e,r){const n=Br(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Eu.get(e),o=i&&i.key;if(o){let u=new Ci(pr.comparator);u=u.insert(o,ls.newNoDocument(o,Lr.min()));const a=en().add(o),p=new qS(Lr.min(),new Map,new Ci(Hr),u,a);await fZ(n,p),n.du=n.du.remove(o),n.Eu.delete(e),V3(n)}else await l4(n.localStore,e,!1).then(()=>d4(n,e,r)).catch(ay)}async function u5e(t,e){const r=Br(t),n=e.batch.batchId;try{const i=await _3e(r.localStore,e);mZ(r,n,null),pZ(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await bb(r,i)}catch(i){await ay(i)}}async function d5e(t,e,r){const n=Br(t);try{const i=await function(u,a){const p=Br(u);return p.persistence.runTransaction("Reject batch","readwrite-primary",g=>{let v;return p.mutationQueue.lookupMutationBatch(g,a).next(w=>(Cn(w!==null,37113),v=w.keys(),p.mutationQueue.removeMutationBatch(g,w))).next(()=>p.mutationQueue.performConsistencyCheck(g)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(g,v,a)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,v)).next(()=>p.localDocuments.getDocuments(g,v))})}(n.localStore,e);mZ(n,e,r),pZ(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await bb(n,i)}catch(i){await ay(i)}}function pZ(t,e){(t.Vu.get(e)||[]).forEach(r=>{r.resolve()}),t.Vu.delete(e)}function mZ(t,e,r){const n=Br(t);let i=n.Ru[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Ru[n.currentUser.toKey()]=i}}function d4(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Tu.get(e))t.Pu.delete(n),r&&t.hu.pu(n,r);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(n=>{t.Au.containsKey(n)||gZ(t,n)})}function gZ(t,e){t.Iu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(P3(t.remoteStore,r),t.du=t.du.remove(e),t.Eu.delete(r),V3(t))}function uB(t,e,r){for(const n of r)n instanceof uZ?(t.Au.addReference(n.key,e),h5e(t,n)):n instanceof dZ?(nr(B3,"Document no longer in limbo: "+n.key),t.Au.removeReference(n.key,e),t.Au.containsKey(n.key)||gZ(t,n.key)):Nr(19791,{yu:n})}function h5e(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Iu.has(n)||(nr(B3,"New document in limbo: "+r),t.Iu.add(n),V3(t))}function V3(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const r=new pr(Vn.fromString(e)),n=t.mu.next();t.Eu.set(n,new t5e(r)),t.du=t.du.insert(r,n),iZ(t.remoteStore,new bh(Xc($S(r.path)),n,"TargetPurposeLimboResolution",OS.ue))}}async function bb(t,e,r){const n=Br(t),i=[],o=[],u=[];n.Pu.isEmpty()||(n.Pu.forEach((a,p)=>{u.push(n.gu(p,e,r).then(g=>{var v;if((g||r)&&n.isPrimaryClient){const w=g?!g.fromCache:(v=r==null?void 0:r.targetChanges.get(p.targetId))===null||v===void 0?void 0:v.current;n.sharedClientState.updateQueryState(p.targetId,w?"current":"not-current")}if(g){i.push(g);const w=N3.Es(p.targetId,g);o.push(w)}}))}),await Promise.all(u),n.hu.J_(i),await async function(p,g){const v=Br(p);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>Dt.forEach(g,T=>Dt.forEach(T.Is,A=>v.persistence.referenceDelegate.addReference(w,T.targetId,A)).next(()=>Dt.forEach(T.ds,A=>v.persistence.referenceDelegate.removeReference(w,T.targetId,A)))))}catch(w){if(!sy(w))throw w;nr(C3,"Failed to update sequence numbers: "+w)}for(const w of g){const T=w.targetId;if(!w.fromCache){const A=v.Fs.get(T),I=A.snapshotVersion,P=A.withLastLimboFreeSnapshotVersion(I);v.Fs=v.Fs.insert(T,P)}}}(n.localStore,o))}async function f5e(t,e){const r=Br(t);if(!r.currentUser.isEqual(e)){nr(B3,"User change. New user:",e.toKey());const n=await eZ(r.localStore,e);r.currentUser=e,function(o,u){o.Vu.forEach(a=>{a.forEach(p=>{p.reject(new Yt(wt.CANCELLED,u))})}),o.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await bb(r,n.Bs)}}function p5e(t,e){const r=Br(t),n=r.Eu.get(e);if(n&&n.lu)return en().add(n.key);{let i=en();const o=r.Tu.get(e);if(!o)return i;for(const u of o){const a=r.Pu.get(u);i=i.unionWith(a.view.tu)}return i}}function yZ(t){const e=Br(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=fZ.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=p5e.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=c5e.bind(null,e),e.hu.J_=Y3e.bind(null,e.eventManager),e.hu.pu=J3e.bind(null,e.eventManager),e}function m5e(t){const e=Br(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=u5e.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=d5e.bind(null,e),e}class rT{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=GS(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){return v3e(this.persistence,new g3e,e.initialUser,this.serializer)}Du(e){return new QK(A3.Vi,this.serializer)}bu(e){return new E3e}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rT.provider={build:()=>new rT};class g5e extends rT{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){Cn(this.persistence.referenceDelegate instanceof eT,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new t3e(n,e.asyncQueue,r)}Du(e){const r=this.cacheSizeBytes!==void 0?Ws.withCacheSize(this.cacheSizeBytes):Ws.DEFAULT;return new QK(n=>eT.Vi(n,r),this.serializer)}}class h4{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>cB(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=f5e.bind(null,this.syncEngine),await K3e(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new X3e}()}createDatastore(e){const r=GS(e.databaseInfo.databaseId),n=function(o){return new P3e(o)}(e.databaseInfo);return function(o,u,a,p){return new O3e(o,u,a,p)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,u,a){return new L3e(n,i,o,u,a)}(this.localStore,this.datastore,e.asyncQueue,r=>cB(this.syncEngine,r,0),function(){return nB.C()?new nB:new j3e}())}createSyncEngine(e,r){return function(i,o,u,a,p,g,v){const w=new r5e(i,o,u,a,p,g);return v&&(w.fu=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const o=Br(i);nr(Fp,"RemoteStore shutting down."),o.Ia.add(5),await _b(o),o.Ea.shutdown(),o.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}h4.provider={build:()=>new h4};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):pd("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef="FirestoreClient";class y5e{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=is.UNAUTHENTICATED,this.clientId=g3.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async u=>{nr(ef,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(n,u=>(nr(ef,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new td;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=R3(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function ZA(t,e){t.asyncQueue.verifyOperationInProgress(),nr(ef,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await eZ(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>{Kh("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{nr("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Kh("Terminating Firestore due to IndexedDb database deletion failed",i)})}),t._offlineComponents=e}async function dB(t,e){t.asyncQueue.verifyOperationInProgress();const r=await x5e(t);nr(ef,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>aB(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>aB(e.remoteStore,i)),t._onlineComponents=e}async function x5e(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){nr(ef,"Using user provided OfflineComponentProvider");try{await ZA(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===wt.FAILED_PRECONDITION||i.code===wt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Kh("Error using user provided cache. Falling back to memory cache: "+r),await ZA(t,new rT)}}else nr(ef,"Using default OfflineComponentProvider"),await ZA(t,new g5e(void 0));return t._offlineComponents}async function xZ(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(nr(ef,"Using user provided OnlineComponentProvider"),await dB(t,t._uninitializedComponentsProvider._online)):(nr(ef,"Using default OnlineComponentProvider"),await dB(t,new h4))),t._onlineComponents}function v5e(t){return xZ(t).then(e=>e.syncEngine)}async function nT(t){const e=await xZ(t),r=e.eventManager;return r.onListen=n5e.bind(null,e.syncEngine),r.onUnlisten=s5e.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=i5e.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=o5e.bind(null,e.syncEngine),r}function _5e(t,e,r={}){const n=new td;return t.asyncQueue.enqueueAndForget(async()=>function(o,u,a,p,g){const v=new U3({next:T=>{v.Ou(),u.enqueueAndForget(()=>z3(o,w));const A=T.docs.has(a);!A&&T.fromCache?g.reject(new Yt(wt.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&T.fromCache&&p&&p.source==="server"?g.reject(new Yt(wt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(T)},error:T=>g.reject(T)}),w=new F3($S(a.path),v,{includeMetadataChanges:!0,ka:!0});return L3(o,w)}(await nT(t),t.asyncQueue,e,r,n)),n.promise}function b5e(t,e,r={}){const n=new td;return t.asyncQueue.enqueueAndForget(async()=>function(o,u,a,p,g){const v=new U3({next:T=>{v.Ou(),u.enqueueAndForget(()=>z3(o,w)),T.fromCache&&p.source==="server"?g.reject(new Yt(wt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(T)},error:T=>g.reject(T)}),w=new F3(a,v,{includeMetadataChanges:!0,ka:!0});return L3(o,w)}(await nT(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vZ(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hB=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Z="firestore.googleapis.com",fB=!0;class pB{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Yt(wt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_Z,this.ssl=fB}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:fB;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=JK;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QMe)throw new Yt(wt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zIe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vZ((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Yt(wt.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Yt(wt.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Yt(wt.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class KS{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pB({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Yt(wt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Yt(wt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pB(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new NIe;switch(n.type){case"firstParty":return new MIe(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Yt(wt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=hB.get(r);n&&(nr("ComponentProvider","Removing Datastore"),hB.delete(r),n.terminate())}(this),Promise.resolve()}}function w5e(t,e,r,n={}){var i;t=io(t,KS);const o=MS(e),u=t._getSettings(),a=Object.assign(Object.assign({},u),{emulatorOptions:t._getEmulatorOptions()}),p=`${e}:${r}`;o&&(qH(`https://${p}`),GH("Firestore",!0)),u.host!==_Z&&u.host!==p&&Kh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g=Object.assign(Object.assign({},u),{host:p,ssl:o,emulatorOptions:n});if(!qk(g,a)&&(t._setSettings(g),n.mockUserToken)){let v,w;if(typeof n.mockUserToken=="string")v=n.mockUserToken,w=is.MOCK_USER;else{v=c4e(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const T=n.mockUserToken.sub||n.mockUserToken.user_id;if(!T)throw new Yt(wt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new is(T)}t._authCredentials=new CIe(new cK(v,w))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new fu(this.firestore,e,this._query)}}class Li{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Li(this.firestore,e,this._key)}toJSON(){return{type:Li._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(yb(r,Li._jsonSchema))return new Li(e,n||null,new pr(Vn.fromString(r.referencePath)))}}Li._jsonSchemaVersion="firestore/documentReference/1.0",Li._jsonSchema={type:na("string",Li._jsonSchemaVersion),referencePath:na("string")};class Fh extends fu{constructor(e,r,n){super(e,r,$S(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Li(this.firestore,null,new pr(e))}withConverter(e){return new Fh(this.firestore,e,this._path)}}function f4(t,e,...r){if(t=ao(t),dK("collection","path",e),t instanceof KS){const n=Vn.fromString(e,...r);return AF(n),new Fh(t,null,n)}{if(!(t instanceof Li||t instanceof Fh))throw new Yt(wt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Vn.fromString(e,...r));return AF(n),new Fh(t.firestore,null,n)}}function wh(t,e,...r){if(t=ao(t),arguments.length===1&&(e=g3.newId()),dK("doc","path",e),t instanceof KS){const n=Vn.fromString(e,...r);return jF(n),new Li(t,null,new pr(n))}{if(!(t instanceof Li||t instanceof Fh))throw new Yt(wt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Vn.fromString(e,...r));return jF(n),new Li(t.firestore,t instanceof Fh?t.converter:null,new pr(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mB="AsyncQueue";class gB{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new rZ(this,"async_queue_retry"),this.oc=()=>{const n=KA();n&&nr(mB,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const r=KA();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const r=KA();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new td;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!sy(e))throw e;nr(mB,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const r=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,pd("INTERNAL UNHANDLED ERROR: ",yB(n)),n}).then(n=>(this.nc=!1,n))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);const i=O3.createAndSchedule(this,e,r,n,o=>this.lc(o));return this.ec.push(i),i}ac(){this.tc&&Nr(47125,{hc:yB(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const r=this.ec.indexOf(e);this.ec.splice(r,1)}}function yB(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xB(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const o of n)if(o in i&&typeof i[o]=="function")return!0;return!1}(t,["next","error","complete"])}class gd extends KS{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new gB,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gB(e),this._firestoreClient=void 0,await e}}}function k5e(t,e){const r=typeof t=="object"?t:QH(),n=typeof t=="string"?t:e||Hk,i=XH(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=VH("firestore");o&&w5e(i,...o)}return i}function ZS(t){if(t._terminated)throw new Yt(wt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||T5e(t),t._firestoreClient}function T5e(t){var e,r,n;const i=t._freezeSettings(),o=function(a,p,g,v){return new XIe(a,p,g,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,vZ(v.experimentalLongPollingOptions),v.useFetchStreams,v.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new y5e(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(a){const p=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(p),_online:p}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sl(Ua.fromBase64String(e))}catch(r){throw new Yt(wt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new sl(Ua.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:sl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(yb(e,sl._jsonSchema))return sl.fromBase64String(e.bytes)}}sl._jsonSchemaVersion="firestore/bytes/1.0",sl._jsonSchema={type:na("string",sl._jsonSchemaVersion),bytes:na("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Yt(wt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fa(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Yt(wt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Yt(wt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Hr(this._lat,e._lat)||Hr(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Jc._jsonSchemaVersion}}static fromJSON(e){if(yb(e,Jc._jsonSchema))return new Jc(e.latitude,e.longitude)}}Jc._jsonSchemaVersion="firestore/geoPoint/1.0",Jc._jsonSchema={type:na("string",Jc._jsonSchemaVersion),latitude:na("number"),longitude:na("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Qc._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(yb(e,Qc._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new Qc(e.vectorValues);throw new Yt(wt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Qc._jsonSchemaVersion="firestore/vectorValue/1.0",Qc._jsonSchema={type:na("string",Qc._jsonSchemaVersion),vectorValues:na("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S5e=/^__.*__$/;class E5e{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new mf(e,this.data,this.fieldMask,r,this.fieldTransforms):new xb(e,this.data,r,this.fieldTransforms)}}class bZ{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new mf(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function wZ(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Nr(40011,{Ec:t})}}class G3{constructor(e,r,n,i,o,u){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new G3(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.fc(e),i}gc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return iT(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(wZ(this.Ec)&&S5e.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class j5e{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||GS(e)}Dc(e,r,n,i=!1){return new G3({Ec:e,methodName:r,bc:n,path:Fa.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wb(t){const e=t._freezeSettings(),r=GS(t._databaseId);return new j5e(t._databaseId,!!e.ignoreUndefinedProperties,r)}function kZ(t,e,r,n,i,o={}){const u=t.Dc(o.merge||o.mergeFields?2:0,e,r,i);W3("Data must be an object, but it was:",u,n);const a=SZ(n,u);let p,g;if(o.merge)p=new So(u.fieldMask),g=u.fieldTransforms;else if(o.mergeFields){const v=[];for(const w of o.mergeFields){const T=p4(e,w,r);if(!u.contains(T))throw new Yt(wt.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);jZ(v,T)||v.push(T)}p=new So(v),g=u.fieldTransforms.filter(w=>p.covers(w.field))}else p=null,g=u.fieldTransforms;return new E5e(new Ks(a),p,g)}class YS extends q3{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof YS}}function A5e(t,e,r,n){const i=t.Dc(1,e,r);W3("Data must be an object, but it was:",i,n);const o=[],u=Ks.empty();pf(n,(p,g)=>{const v=H3(e,p,r);g=ao(g);const w=i.gc(v);if(g instanceof YS)o.push(v);else{const T=kb(g,w);T!=null&&(o.push(v),u.set(v,T))}});const a=new So(o);return new bZ(u,a,i.fieldTransforms)}function N5e(t,e,r,n,i,o){const u=t.Dc(1,e,r),a=[p4(e,n,r)],p=[i];if(o.length%2!=0)throw new Yt(wt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<o.length;T+=2)a.push(p4(e,o[T])),p.push(o[T+1]);const g=[],v=Ks.empty();for(let T=a.length-1;T>=0;--T)if(!jZ(g,a[T])){const A=a[T];let I=p[T];I=ao(I);const P=u.gc(A);if(I instanceof YS)g.push(A);else{const D=kb(I,P);D!=null&&(g.push(A),v.set(A,D))}}const w=new So(g);return new bZ(v,w,u.fieldTransforms)}function TZ(t,e,r,n=!1){return kb(r,t.Dc(n?4:3,e))}function kb(t,e){if(EZ(t=ao(t)))return W3("Unsupported field value:",e,t),SZ(t,e);if(t instanceof q3)return function(n,i){if(!wZ(i.Ec))throw i.wc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,i){const o=[];let u=0;for(const a of n){let p=kb(a,i.yc(u));p==null&&(p={nullValue:"NULL_VALUE"}),o.push(p),u++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=ao(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return xMe(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=jn.fromDate(n);return{timestampValue:Qk(i.serializer,o)}}if(n instanceof jn){const o=new jn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Qk(i.serializer,o)}}if(n instanceof Jc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof sl)return{bytesValue:GK(i.serializer,n._byteString)};if(n instanceof Li){const o=i.databaseId,u=n.firestore._databaseId;if(!u.isEqual(o))throw i.wc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:E3(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Qc)return function(u,a){return{mapValue:{fields:{[_K]:{stringValue:wK},[Kk]:{arrayValue:{values:u.toArray().map(g=>{if(typeof g!="number")throw a.wc("VectorValues must only contain numeric values.");return w3(a.serializer,g)})}}}}}}(n,i);throw i.wc(`Unsupported field value: ${DS(n)}`)}(t,e)}function SZ(t,e){const r={};return pK(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pf(t,(n,i)=>{const o=kb(i,e.Vc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function EZ(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof jn||t instanceof Jc||t instanceof sl||t instanceof Li||t instanceof q3||t instanceof Qc)}function W3(t,e,r){if(!EZ(r)||!hK(r)){const n=DS(r);throw n==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+n)}}function p4(t,e,r){if((e=ao(e))instanceof XS)return e._internalPath;if(typeof e=="string")return H3(t,e);throw iT("Field path arguments must be of type string or ",t,!1,void 0,r)}const C5e=new RegExp("[~\\*/\\[\\]]");function H3(t,e,r){if(e.search(C5e)>=0)throw iT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new XS(...e.split("."))._internalPath}catch{throw iT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function iT(t,e,r,n,i){const o=n&&!n.isEmpty(),u=i!==void 0;let a=`Function ${e}() called with invalid data`;r&&(a+=" (via `toFirestore()`)"),a+=". ";let p="";return(o||u)&&(p+=" (found",o&&(p+=` in field ${n}`),u&&(p+=` in document ${i}`),p+=")"),new Yt(wt.INVALID_ARGUMENT,a+t+p)}function jZ(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Li(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new P5e(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(JS("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class P5e extends K3{data(){return super.data()}}function JS(t,e){return typeof e=="string"?H3(t,e):e instanceof XS?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AZ(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Yt(wt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Z3{}class QS extends Z3{}function Jl(t,e,...r){let n=[];e instanceof Z3&&n.push(e),n=n.concat(r),function(o){const u=o.filter(p=>p instanceof X3).length,a=o.filter(p=>p instanceof eE).length;if(u>1||u>0&&a>0)throw new Yt(wt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class eE extends QS{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new eE(e,r,n)}_apply(e){const r=this._parse(e);return NZ(e._query,r),new fu(e.firestore,e.converter,n4(e._query,r))}_parse(e){const r=wb(e.firestore);return function(o,u,a,p,g,v,w){let T;if(g.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new Yt(wt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){_B(w,v);const I=[];for(const P of w)I.push(vB(p,o,P));T={arrayValue:{values:I}}}else T=vB(p,o,w)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||_B(w,v),T=TZ(a,u,w,v==="in"||v==="not-in");return ra.create(g,v,T)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function kh(t,e,r){const n=e,i=JS("where",t);return eE._create(i,n,r)}class X3 extends Z3{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new X3(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:uc.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let u=i;const a=o.getFlattenedFilters();for(const p of a)NZ(u,p),u=n4(u,p)}(e._query,r),new fu(e.firestore,e.converter,n4(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Y3 extends QS{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Y3(e,r)}_apply(e){const r=function(i,o,u){if(i.startAt!==null)throw new Yt(wt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Yt(wt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new F_(o,u)}(e._query,this._field,this._direction);return new fu(e.firestore,e.converter,function(i,o){const u=i.explicitOrderBy.concat([o]);return new Jp(i.path,i.collectionGroup,u,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function Kx(t,e="asc"){const r=e,n=JS("orderBy",t);return Y3._create(n,r)}class J3 extends QS{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new J3(e,r,n)}_apply(e){return new fu(e.firestore,e.converter,Xk(e._query,this._limit,this._limitType))}}function hh(t){return $Ie("limit",t),J3._create("limit",t,"F")}class Q3 extends QS{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new Q3(e,r,n)}_apply(e){const r=M5e(e,this.type,this._docOrFields,this._inclusive);return new fu(e.firestore,e.converter,function(i,o){return new Jp(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,r))}}function I5e(...t){return Q3._create("startAfter",t,!1)}function M5e(t,e,r,n){if(r[0]=ao(r[0]),r[0]instanceof K3)return function(o,u,a,p,g){if(!p)throw new Yt(wt.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const v=[];for(const w of Ig(o))if(w.field.isKeyField())v.push(Zk(u,p.key));else{const T=p.data.field(w.field);if(LS(T))throw new Yt(wt.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const A=w.field.canonicalString();throw new Yt(wt.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${A}' (used as the orderBy) does not exist.`)}v.push(T)}return new A0(v,g)}(t._query,t.firestore._databaseId,e,r[0]._document,n);{const i=wb(t.firestore);return function(u,a,p,g,v,w){const T=u.explicitOrderBy;if(v.length>T.length)throw new Yt(wt.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const A=[];for(let I=0;I<v.length;I++){const P=v[I];if(T[I].field.isKeyField()){if(typeof P!="string")throw new Yt(wt.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof P}`);if(!b3(u)&&P.indexOf("/")!==-1)throw new Yt(wt.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${P}' contains a slash.`);const D=u.path.child(Vn.fromString(P));if(!pr.isDocumentKey(D))throw new Yt(wt.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${D}' is not because it contains an odd number of segments.`);const L=new pr(D);A.push(Zk(a,L))}else{const D=TZ(p,g,P);A.push(D)}}return new A0(A,w)}(t._query,t.firestore._databaseId,i,e,r,n)}}function vB(t,e,r){if(typeof(r=ao(r))=="string"){if(r==="")throw new Yt(wt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!b3(e)&&r.indexOf("/")!==-1)throw new Yt(wt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Vn.fromString(r));if(!pr.isDocumentKey(n))throw new Yt(wt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Zk(t,new pr(n))}if(r instanceof Li)return Zk(t,r._key);throw new Yt(wt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${DS(r)}.`)}function _B(t,e){if(!Array.isArray(t)||t.length===0)throw new Yt(wt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function NZ(t,e){const r=function(i,o){for(const u of i)for(const a of u.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Yt(wt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Yt(wt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class D5e{convertValue(e,r="none"){switch(Jh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Yh(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Nr(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return pf(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){var r,n,i;const o=(i=(n=(r=e.fields)===null||r===void 0?void 0:r[Kk].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(u=>Bi(u.doubleValue));return new Qc(o)}convertGeoPoint(e){return new Jc(Bi(e.latitude),Bi(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=zS(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(L_(e));default:return null}}convertTimestamp(e){const r=Xh(e);return new jn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Vn.fromString(e);Cn(YK(n),9688,{name:e});const i=new z_(n.get(1),n.get(3)),o=new pr(n.popFirst(5));return i.isEqual(r)||pd(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CZ(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Zx{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Tp extends K3{constructor(e,r,n,i,o,u){super(e,r,n,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new a2(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(JS("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Yt(wt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Tp._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Tp._jsonSchemaVersion="firestore/documentSnapshot/1.0",Tp._jsonSchema={type:na("string",Tp._jsonSchemaVersion),bundleSource:na("string","DocumentSnapshot"),bundleName:na("string"),bundle:na("string")};class a2 extends Tp{data(e={}){return super.data(e)}}class Sp{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Zx(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new a2(this._firestore,this._userDataWriter,n.key,n,new Zx(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Yt(wt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let u=0;return i._snapshot.docChanges.map(a=>{const p=new a2(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zx(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:p,oldIndex:-1,newIndex:u++}})}{let u=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{const p=new a2(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zx(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let g=-1,v=-1;return a.type!==0&&(g=u.indexOf(a.doc.key),u=u.delete(a.doc.key)),a.type!==1&&(u=u.add(a.doc),v=u.indexOf(a.doc.key)),{type:O5e(a.type),doc:p,oldIndex:g,newIndex:v}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Yt(wt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Sp._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=g3.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function O5e(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Nr(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PZ(t){t=io(t,Li);const e=io(t.firestore,gd);return _5e(ZS(e),t._key).then(r=>MZ(e,t,r))}Sp._jsonSchemaVersion="firestore/querySnapshot/1.0",Sp._jsonSchema={type:na("string",Sp._jsonSchemaVersion),bundleSource:na("string","QuerySnapshot"),bundleName:na("string"),bundle:na("string")};class e5 extends D5e{constructor(e){super(),this.firestore=e}convertBytes(e){return new sl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Li(this.firestore,null,r)}}function tc(t){t=io(t,fu);const e=io(t.firestore,gd),r=ZS(e),n=new e5(e);return AZ(t._query),b5e(r,t._query).then(i=>new Sp(e,n,t,i))}function R5e(t,e,r){t=io(t,Li);const n=io(t.firestore,gd),i=CZ(t.converter,e,r);return tE(n,[kZ(wb(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,hl.none())])}function bB(t,e,r,...n){t=io(t,Li);const i=io(t.firestore,gd),o=wb(i);let u;return u=typeof(e=ao(e))=="string"||e instanceof XS?N5e(o,"updateDoc",t._key,e,r,n):A5e(o,"updateDoc",t._key,e),tE(i,[u.toMutation(t._key,hl.exists(!0))])}function L5e(t){return tE(io(t.firestore,gd),[new k3(t._key,hl.none())])}function z5e(t,e){const r=io(t.firestore,gd),n=wh(t),i=CZ(t.converter,e);return tE(r,[kZ(wb(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,hl.exists(!1))]).then(()=>n)}function IZ(t,...e){var r,n,i;t=ao(t);let o={includeMetadataChanges:!1,source:"default"},u=0;typeof e[u]!="object"||xB(e[u])||(o=e[u++]);const a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(xB(e[u])){const w=e[u];e[u]=(r=w.next)===null||r===void 0?void 0:r.bind(w),e[u+1]=(n=w.error)===null||n===void 0?void 0:n.bind(w),e[u+2]=(i=w.complete)===null||i===void 0?void 0:i.bind(w)}let p,g,v;if(t instanceof Li)g=io(t.firestore,gd),v=$S(t._key.path),p={next:w=>{e[u]&&e[u](MZ(g,t,w))},error:e[u+1],complete:e[u+2]};else{const w=io(t,fu);g=io(w.firestore,gd),v=w._query;const T=new e5(g);p={next:A=>{e[u]&&e[u](new Sp(g,T,w,A))},error:e[u+1],complete:e[u+2]},AZ(t._query)}return function(T,A,I,P){const D=new U3(P),L=new F3(A,D,I);return T.asyncQueue.enqueueAndForget(async()=>L3(await nT(T),L)),()=>{D.Ou(),T.asyncQueue.enqueueAndForget(async()=>z3(await nT(T),L))}}(ZS(g),v,a,p)}function tE(t,e){return function(n,i){const o=new td;return n.asyncQueue.enqueueAndForget(async()=>l5e(await v5e(n),i,o)),o.promise}(ZS(t),e)}function MZ(t,e,r){const n=r.docs.get(e._key),i=new e5(t);return new Tp(t,i,e._key,n,new Zx(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){iy=i})(xIe),D_(new T0("firestore",(n,{instanceIdentifier:i,options:o})=>{const u=n.getProvider("app").getImmediate(),a=new gd(new PIe(n.getProvider("auth-internal")),new DIe(u,n.getProvider("app-check-internal")),function(g,v){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new Yt(wt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new z_(g.options.projectId,v)}(u,i),u);return o=Object.assign({useFetchStreams:r},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),zh(wF,kF,e),zh(wF,kF,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $5e="type.googleapis.com/google.protobuf.Int64Value",F5e="type.googleapis.com/google.protobuf.UInt64Value";function DZ(t,e){const r={};for(const n in t)t.hasOwnProperty(n)&&(r[n]=e(t[n]));return r}function aT(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>aT(e));if(typeof t=="function"||typeof t=="object")return DZ(t,e=>aT(e));throw new Error("Data cannot be encoded in JSON: "+t)}function P0(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case $5e:case F5e:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>P0(e)):typeof t=="function"||typeof t=="object"?DZ(t,e=>P0(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t5="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wB={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ys extends Yp{constructor(e,r,n){super(`${t5}/${e}`,r||""),this.details=n,Object.setPrototypeOf(this,Ys.prototype)}}function B5e(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function sT(t,e){let r=B5e(t),n=r,i;try{const o=e&&e.error;if(o){const u=o.status;if(typeof u=="string"){if(!wB[u])return new Ys("internal","internal");r=wB[u],n=u}const a=o.message;typeof a=="string"&&(n=a),i=o.details,i!==void 0&&(i=P0(i))}}catch{}return r==="ok"?null:new Ys(r,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5e{constructor(e,r,n,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,YH(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=r.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||r.get().then(o=>this.auth=o,()=>{}),this.messaging||n.get().then(o=>this.messaging=o,()=>{}),this.appCheck||i==null||i.get().then(o=>this.appCheck=o,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4="us-central1",U5e=/^data: (.*?)(?:\n|$)/;function q5e(t){let e=null;return{promise:new Promise((r,n)=>{e=setTimeout(()=>{n(new Ys("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class G5e{constructor(e,r,n,i,o=m4,u=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=u,this.emulatorOrigin=null,this.contextProvider=new V5e(e,r,n,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(o);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=m4}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function W5e(t,e,r){const n=MS(e);t.emulatorOrigin=`http${n?"s":""}://${e}:${r}`,n&&(qH(t.emulatorOrigin),GH("Functions",!0))}function H5e(t,e,r){const n=i=>Z5e(t,e,i,r||{});return n.stream=(i,o)=>Y5e(t,e,i,o),n}async function K5e(t,e,r,n){r["Content-Type"]="application/json";let i;try{i=await n(t,{method:"POST",body:JSON.stringify(e),headers:r})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}async function OZ(t,e){const r={},n=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return n.authToken&&(r.Authorization="Bearer "+n.authToken),n.messagingToken&&(r["Firebase-Instance-ID-Token"]=n.messagingToken),n.appCheckToken!==null&&(r["X-Firebase-AppCheck"]=n.appCheckToken),r}function Z5e(t,e,r,n){const i=t._url(e);return X5e(t,i,r,n)}async function X5e(t,e,r,n){r=aT(r);const i={data:r},o=await OZ(t,n),u=n.timeout||7e4,a=q5e(u),p=await Promise.race([K5e(e,i,o,t.fetchImpl),a.promise,t.cancelAllRequests]);if(a.cancel(),!p)throw new Ys("cancelled","Firebase Functions instance was deleted.");const g=sT(p.status,p.json);if(g)throw g;if(!p.json)throw new Ys("internal","Response is not valid JSON object.");let v=p.json.data;if(typeof v>"u"&&(v=p.json.result),typeof v>"u")throw new Ys("internal","Response is missing data field.");return{data:P0(v)}}function Y5e(t,e,r,n){const i=t._url(e);return J5e(t,i,r,n||{})}async function J5e(t,e,r,n){var i;r=aT(r);const o={data:r},u=await OZ(t,n);u["Content-Type"]="application/json",u.Accept="text/event-stream";let a;try{a=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(o),headers:u,signal:n==null?void 0:n.signal})}catch(A){if(A instanceof Error&&A.name==="AbortError"){const P=new Ys("cancelled","Request was cancelled.");return{data:Promise.reject(P),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(P)}}}}}}const I=sT(0,null);return{data:Promise.reject(I),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(I)}}}}}}let p,g;const v=new Promise((A,I)=>{p=A,g=I});(i=n==null?void 0:n.signal)===null||i===void 0||i.addEventListener("abort",()=>{const A=new Ys("cancelled","Request was cancelled.");g(A)});const w=a.body.getReader(),T=Q5e(w,p,g,n==null?void 0:n.signal);return{stream:{[Symbol.asyncIterator](){const A=T.getReader();return{async next(){const{value:I,done:P}=await A.read();return{value:I,done:P}},async return(){return await A.cancel(),{done:!0,value:void 0}}}}},data:v}}function Q5e(t,e,r,n){const i=(u,a)=>{const p=u.match(U5e);if(!p)return;const g=p[1];try{const v=JSON.parse(g);if("result"in v){e(P0(v.result));return}if("message"in v){a.enqueue(P0(v.message));return}if("error"in v){const w=sT(0,v);a.error(w),r(w);return}}catch(v){if(v instanceof Ys){a.error(v),r(v);return}}},o=new TextDecoder;return new ReadableStream({start(u){let a="";return p();async function p(){if(n!=null&&n.aborted){const g=new Ys("cancelled","Request was cancelled");return u.error(g),r(g),Promise.resolve()}try{const{value:g,done:v}=await t.read();if(v){a.trim()&&i(a.trim(),u),u.close();return}if(n!=null&&n.aborted){const T=new Ys("cancelled","Request was cancelled");u.error(T),r(T),await t.cancel();return}a+=o.decode(g,{stream:!0});const w=a.split(`
`);a=w.pop()||"";for(const T of w)T.trim()&&i(T.trim(),u);return p()}catch(g){const v=g instanceof Ys?g:sT(0,null);u.error(v),r(v)}}},cancel(){return t.cancel()}})}const kB="@firebase/functions",TB="0.12.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eDe="auth-internal",tDe="app-check-internal",rDe="messaging-internal";function nDe(t){const e=(r,{instanceIdentifier:n})=>{const i=r.getProvider("app").getImmediate(),o=r.getProvider(eDe),u=r.getProvider(rDe),a=r.getProvider(tDe);return new G5e(i,o,u,a,n)};D_(new T0(t5,e,"PUBLIC").setMultipleInstances(!0)),zh(kB,TB,t),zh(kB,TB,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iDe(t=QH(),e=m4){const n=XH(ao(t),t5).getImmediate({identifier:e}),i=VH("functions");return i&&aDe(n,...i),n}function aDe(t,e,r){W5e(ao(t),e,r)}function sDe(t,e,r){return H5e(ao(t),e,r)}nDe();var oDe="firebase",lDe="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zh(oDe,lDe,"app");const cDe={apiKey:{}.VITE_FIREBASE_API_KEY||"AIzaSyB_pnp6utp_Pw7GANLEmFz1gDo1c-o5qVU",authDomain:{}.VITE_FIREBASE_AUTH_DOMAIN||"sentinel-rdc.firebaseapp.com",databaseURL:{}.VITE_FIREBASE_DATABASE_URL||"https://sentinel-rdc-default-rtdb.europe-west1.firebasedatabase.app",projectId:{}.VITE_FIREBASE_PROJECT_ID||"sentinel-rdc",storageBucket:{}.VITE_FIREBASE_STORAGE_BUCKET||"sentinel-rdc.firebasestorage.app",messagingSenderId:{}.VITE_FIREBASE_MESSAGING_SENDER_ID||"720916055628",appId:{}.VITE_FIREBASE_APP_ID||"1:720916055628:web:5c64ead7a365b8db1596e9"},RZ=JH(cDe),Dg=k5e(RZ),uDe=iDe(RZ);class LZ{constructor(){Vl(this,"keywordsCollection",f4(Dg,"keywords"));Vl(this,"postsCollection",f4(Dg,"twitter_posts"))}convertFirebaseKeyword(e){var r,n,i,o,u,a,p,g,v;return console.log(`Converting keyword ${e.term}:`,{hasAnalytics:!!e.analytics,analytics:e.analytics,totalMentions:(r=e.analytics)==null?void 0:r.totalMentions}),{id:parseInt(e.id)||Date.now(),term:e.term,mentions:((n=e.analytics)==null?void 0:n.totalMentions)||0,trend:this.generateTrendData(((i=e.analytics)==null?void 0:i.totalMentions)||0),status:this.mapPriorityToStatus(e.priority),createdAt:e.createdAt.toDate(),sentiment:{positive:((u=(o=e.analytics)==null?void 0:o.sentimentBreakdown)==null?void 0:u.positive)||0,neutral:((p=(a=e.analytics)==null?void 0:a.sentimentBreakdown)==null?void 0:p.neutral)||0,negative:((v=(g=e.analytics)==null?void 0:g.sentimentBreakdown)==null?void 0:v.negative)||0}}}mapPriorityToStatus(e){switch(e){case"critical":return"critical";case"high":return"warning";default:return"active"}}generateTrendData(e){return[0,0,0,0,0,0,0]}async getKeywords(){try{try{const e=Jl(this.keywordsCollection,kh("isActive","==",!0),Kx("createdAt","desc"));return(await tc(e)).docs.map(n=>{const i=n.data();return this.convertFirebaseKeyword({id:n.id,...i})})}catch{return console.log("Index not created, fetching all keywords"),(await tc(this.keywordsCollection)).docs.map(n=>{const i=n.data();return this.convertFirebaseKeyword({id:n.id,...i})})}}catch(e){return console.error("Error fetching keywords:",e),this.getFallbackKeywords()}}onKeywordsChange(e){return IZ(this.keywordsCollection,r=>{const n=r.docs.map(i=>{const o=i.data();return console.log("Raw keyword data from Firestore:",{id:i.id,...o}),this.convertFirebaseKeyword({id:i.id,...o})});console.log("Converted keywords:",n),e(n)},r=>{console.error("Error in keywords listener:",r),e(this.getFallbackKeywords())})}async addKeyword(e){try{const r={term:e.trim(),isActive:!0,priority:"medium",createdAt:jn.now(),updatedAt:jn.now()},n=await z5e(this.keywordsCollection,r);return this.convertFirebaseKeyword({id:n.id,...r})}catch(r){throw console.error("Error adding keyword:",r),new Error("Failed to add keyword")}}async updateKeyword(e,r){try{const n=wh(this.keywordsCollection,e.toString()),i={updatedAt:jn.now()};r.term&&(i.term=r.term),await bB(n,i);const u=(await this.getKeywords()).find(a=>a.id===e);if(!u)throw new Error("Keyword not found after update");return u}catch(n){throw console.error("Error updating keyword:",n),new Error("Failed to update keyword")}}async deleteKeyword(e){try{const r=wh(this.keywordsCollection,e.toString());await L5e(r)}catch(r){throw console.error("Error deleting keyword:",r),new Error("Failed to delete keyword")}}async getKeywordTweets(e,r=100){try{console.log(`DEBUG: Getting tweets for keyword "${e}" with limit ${r}`);const n=Jl(this.postsCollection,kh("keyword","==",e),hh(1)),i=await tc(n);console.log(`DEBUG: Found ${i.docs.length} document(s) for keyword "${e}"`),i.docs.length>0&&console.log(`DEBUG: Sample document for "${e}":`,i.docs[0].data());const o=Jl(this.postsCollection,kh("keyword","==",e),hh(r)),u=await tc(o);return console.log(`DEBUG: getKeywordTweets for "${e}" returned ${u.docs.length} documents`),u.docs.map(a=>{const p=a.data();return{id:a.id,...p,timestamp:p.timestamp.toDate().toISOString(),scrapedAt:p.scrapedAt.toDate().toISOString()}})}catch(n){return console.error("Error fetching tweets:",n),[]}}async triggerKeywordScraping(e){try{return(await fetch(`https://us-central1-sentinel-rdc.cloudfunctions.net/api/keywords/${e}/scrape`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok?{success:!0,message:"Scraping initiated successfully"}:{success:!1,message:"Failed to trigger scraping"}}catch(r){return console.error("Error triggering scraping:",r),{success:!1,message:"Failed to trigger scraping"}}}async triggerAllKeywordsScraping(){try{const r=await sDe(uDe,"scrapeTwitterData")();return{success:!0,message:"Scraping initiated for all keywords"}}catch(e){return console.error("Error triggering all keywords scraping:",e),{success:!1,message:"Failed to trigger scraping"}}}async getKeywordAnalytics(e){try{const r=wh(this.keywordsCollection,e),n=await PZ(r);if(n.exists()){const i=n.data();if(i.analytics)return console.log("Found analytics in keyword document:",i.analytics),i.analytics;console.log("No analytics in document, calculating from posts for keyword:",i.term);const o=await this.calculateKeywordAnalyticsFromPosts(i.term);if(o&&o.totalMentions>0)return await bB(r,{analytics:o}),o}return null}catch(r){return console.error("Error fetching analytics:",r),null}}async debugKeywordAnalytics(e){try{const r=wh(this.keywordsCollection,e),n=await tc(Jl(this.keywordsCollection,kh("__name__","==",e)));if(n.empty)console.log("DEBUG - No keyword found with ID:",e);else{const i=n.docs[0],o=i.data();console.log("DEBUG - Raw keyword document:",o),console.log("DEBUG - Analytics field:",o.analytics),console.log("DEBUG - Document ID:",i.id)}}catch(r){console.error("DEBUG - Error fetching keyword:",r)}}async calculateKeywordAnalyticsFromPosts(e){try{const r=await this.getKeywordTweets(e,1e4);if(console.log(`Found ${r.length} posts for keyword "${e}"`),r.length===0)return{totalMentions:0,totalEngagement:0,averageEngagement:0,sentimentBreakdown:{positive:0,neutral:0,negative:0},sourceBreakdown:{},lastUpdated:new Date};const n=r.reduce((u,a)=>(u[a.sentiment||"neutral"]++,u),{positive:0,neutral:0,negative:0}),i=r.reduce((u,a)=>{var p,g,v;return u+(((p=a.engagement)==null?void 0:p.like_count)||0)+(((g=a.engagement)==null?void 0:g.retweet_count)||0)+(((v=a.engagement)==null?void 0:v.reply_count)||0)},0),o=r.reduce((u,a)=>{const p=a.author||"Unknown";return u[p]=(u[p]||0)+1,u},{});return{totalMentions:r.length,totalEngagement:i,averageEngagement:Math.round(i/r.length),sentimentBreakdown:{positive:Math.round(n.positive/r.length*100),neutral:Math.round(n.neutral/r.length*100),negative:Math.round(n.negative/r.length*100)},sourceBreakdown:o,lastUpdated:new Date}}catch(r){return console.error("Error calculating analytics from posts:",r),null}}getFallbackKeywords(){return[]}}function dDe({isOpen:t,onClose:e,keyword:r}){const[n,i]=Y.useState("analytics"),[o,u]=Y.useState(null),[a,p]=Y.useState(!0),[g,v]=Y.useState([]),w=new LZ;Y.useEffect(()=>{t&&r&&(A(),T())},[t,r]);const T=async()=>{if(r)try{const P=await w.getKeywordTweets(r.term,1e4);console.log(`Loading raw data for ${r.term}: found ${P.length} tweets`),v(P.map(D=>{var J,W,H,V,se,K,ce,ne,re;const L=D.author||"Unknown",O=D.platform||"Unknown",G={radio_okapi:"Radio Okapi",google_news:"Google News",media_congo:"Media Congo","7sur7":"7sur7.cd",congo_page:"Congo Page",actualite_cd:"Actualité.cd",congo_liberty:"Congo Liberty",la_prosperite:"La Prospérité",twitter:"Twitter"}[O]||L,B=O==="twitter"?"Twitter":O.includes("google")?"Google News":"News Website";return{id:D.id,timestamp:D.timestamp,source:G,platform:B,content:D.content,author:D.author,location:((J=D.geo)==null?void 0:J.full_name)||"RDC",sentiment:D.sentiment,engagement:(((W=D.engagement)==null?void 0:W.like_count)||0)+(((H=D.engagement)==null?void 0:H.retweet_count)||0)+(((V=D.engagement)==null?void 0:V.reply_count)||0),reach:((se=D.engagement)==null?void 0:se.impression_count)||0,verified:D.authorVerified||!1,language:((K=D.metadata)==null?void 0:K.language)||"fr",keywords:[r.term],category:B==="Twitter"?"Social Media":"News",priority:"medium",metadata:{likes:((ce=D.engagement)==null?void 0:ce.like_count)||0,shares:((ne=D.engagement)==null?void 0:ne.retweet_count)||0,comments:((re=D.engagement)==null?void 0:re.reply_count)||0}}}))}catch(P){console.error("Error loading raw data:",P)}},A=async()=>{if(r){p(!0);try{const P=await w.getKeywordAnalytics(r.id);u(P||null)}catch(P){console.error("Error loading analytics:",P),u(null)}finally{p(!1)}}};if(!t)return null;const I=[{id:"analytics",label:"Analytique",icon:H6},{id:"rawdata",label:"Données Brutes",icon:Wae}];return l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[l.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:e}),l.jsxs("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-6xl sm:w-full",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 px-6 pt-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white",children:['Analyse détaillée: "',(r==null?void 0:r.term)||"",'"']}),o&&l.jsx("div",{className:"mt-2",children:l.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[o.totalMentions.toLocaleString()," mentions totales"]})})]}),l.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:l.jsx(FU,{className:"h-6 w-6"})})]}),l.jsx("div",{className:"mt-4",children:l.jsx("nav",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:I.map(P=>l.jsxs("button",{onClick:()=>i(P.id),className:`flex items-center space-x-2 px-3 py-2 text-sm font-medium rounded-md transition-colors ${n===P.id?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"}`,children:[l.jsx(P.icon,{className:"h-4 w-4"}),l.jsx("span",{children:P.label})]},P.id))})})]}),l.jsx("div",{className:"px-6 py-6 max-h-[600px] overflow-y-auto",children:a?l.jsxs("div",{className:"flex items-center justify-center h-64",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),l.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Chargement des données..."})]}):l.jsxs(l.Fragment,{children:[n==="analytics"&&(o?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o.totalMentions.toLocaleString()}),l.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total mentions"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o.performance.avgDailyMentions.toFixed(1)}),l.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Mentions/jour"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[l.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[o.sentimentBreakdown.positive,"%"]}),l.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sentiment positif"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[l.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[o.performance.velocityChange>0?"+":"",o.performance.velocityChange.toFixed(1),"%"]}),l.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Évolution"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow border border-gray-200 dark:border-gray-700",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Répartition du sentiment"}),l.jsx("div",{className:"h-64",children:l.jsx(Jg,{width:"100%",height:"100%",children:l.jsxs(h3,{children:[l.jsx(fc,{data:[{name:"Positif",value:o.sentimentBreakdown.positive,color:"#10B981"},{name:"Neutre",value:o.sentimentBreakdown.neutral,color:"#6B7280"},{name:"Négatif",value:o.sentimentBreakdown.negative,color:"#EF4444"}],cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:[0,1,2].map(P=>l.jsx(Hp,{fill:["#10B981","#6B7280","#EF4444"][P]},`cell-${P}`))}),l.jsx(as,{}),l.jsx(Hc,{})]})})})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow border border-gray-200 dark:border-gray-700",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Évolution temporelle"}),l.jsx("div",{className:"h-64",children:l.jsx(Jg,{width:"100%",height:"100%",children:l.jsxs(XPe,{data:o.temporalTrends,children:[l.jsx(gb,{strokeDasharray:"3 3"}),l.jsx(Td,{dataKey:"date"}),l.jsx(ou,{}),l.jsx(as,{}),l.jsx(Hc,{}),l.jsx(Hh,{type:"monotone",dataKey:"mentions",stroke:"#3B82F6",strokeWidth:2})]})})})]})]}):l.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500 dark:text-gray-400",children:[l.jsx(H6,{className:"h-16 w-16 mb-4"}),l.jsx("h3",{className:"text-lg font-medium mb-2",children:"Aucune donnée disponible"}),l.jsx("p",{className:"text-sm text-center",children:"Les données d'analyse apparaîtront ici une fois que le scraping commencera."})]})),n==="rawdata"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:['Données brutes pour "',r==null?void 0:r.term,'"']}),l.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[g.length," éléments"]})]}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:l.jsx(Wg,{data:g})})]})]})}),l.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 px-6 py-3",children:l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:"Fermer"})})})]})]})})}class zZ{constructor(){Vl(this,"postsCollection",f4(Dg,"twitter_posts"))}convertToRawDataItem(e,r){var n;try{const i=this.determineActualSource(e),o=this.determineActualPlatform(e),u=e.engagement||{},a=this.calculateTotalEngagement(u);return{id:r,timestamp:this.extractTimestamp(e.timestamp),source:i,platform:o,content:e.content||"",author:e.author||"Unknown",location:this.determineLocation(e),sentiment:e.sentiment||"neutral",engagement:a,reach:u.impression_count||0,verified:e.authorVerified||!1,language:((n=e.metadata)==null?void 0:n.language)||"fr",keywords:e.keyword?[e.keyword]:[],category:o==="Twitter"?"Social Media":"News",priority:this.mapEngagementToPriority(a),metadata:{likes:u.like_count||0,shares:u.retweet_count||0,comments:u.reply_count||0}}}catch(i){return console.error("Error converting post to RawDataItem:",i,e),{id:r,timestamp:new Date().toISOString(),source:"Unknown",platform:"Unknown",content:e.content||"Error loading content",author:e.author||"Unknown",location:"RDC",sentiment:"neutral",engagement:0,reach:0,verified:!1,language:"fr",keywords:[],category:"Unknown",priority:"low",metadata:{likes:0,shares:0,comments:0}}}}determineActualSource(e){var r,n,i,o,u,a,p,g,v,w,T,A,I,P,D,L,O,$,G,B,J,W,H,V,se;if(e.platform){const ce={radio_okapi:"Radio Okapi",google_news:"Google News",media_congo:"Media Congo","7sur7":"7sur7.cd",congo_page:"Congo Page",actualite_cd:"Actualité.cd",congo_liberty:"Congo Liberty",la_prosperite:"La Prospérité",twitter:"Twitter"}[e.platform];if(ce)return ce}return e.author==="Radio Okapi"?"Radio Okapi":e.author==="Google News"?"Google News":e.author==="Media Congo"?"Media Congo":e.author==="7sur7.cd"?"7sur7.cd":e.author==="Congo Page"?"Congo Page":e.author==="Actualité.cd"?"Actualité.cd":e.author==="Congo Liberty"?"Congo Liberty":e.author==="La Prospérité"?"La Prospérité":e.author==="Voice of Congo"?"Voice of Congo":(r=e.id)!=null&&r.includes("radio_okapi_")?"Radio Okapi":(n=e.id)!=null&&n.includes("google_news_")?"Google News":(i=e.id)!=null&&i.includes("media_congo_")?"Media Congo":(o=e.id)!=null&&o.includes("7sur7_")?"7sur7.cd":(u=e.id)!=null&&u.includes("congo_page_")?"Congo Page":(a=e.id)!=null&&a.includes("actualite_cd_")?"Actualité.cd":(p=e.id)!=null&&p.includes("congo_liberty_")?"Congo Liberty":(g=e.id)!=null&&g.includes("la_prosperite_")?"La Prospérité":(v=e.id)!=null&&v.includes("voice_congo_")?"Voice of Congo":(T=(w=e.metadata)==null?void 0:w.urls)!=null&&T.some(K=>K.includes("radiookapi.net"))?"Radio Okapi":(I=(A=e.metadata)==null?void 0:A.urls)!=null&&I.some(K=>K.includes("news.google.com"))?"Google News":(D=(P=e.metadata)==null?void 0:P.urls)!=null&&D.some(K=>K.includes("mediacongo.net"))?"Media Congo":(O=(L=e.metadata)==null?void 0:L.urls)!=null&&O.some(K=>K.includes("7sur7.cd"))?"7sur7.cd":(G=($=e.metadata)==null?void 0:$.urls)!=null&&G.some(K=>K.includes("congopage.com"))?"Congo Page":(J=(B=e.metadata)==null?void 0:B.urls)!=null&&J.some(K=>K.includes("actualite.cd"))?"Actualité.cd":(H=(W=e.metadata)==null?void 0:W.urls)!=null&&H.some(K=>K.includes("congo-liberty.org"))?"Congo Liberty":(se=(V=e.metadata)==null?void 0:V.urls)!=null&&se.some(K=>K.includes("laprosperiteonline.net"))?"La Prospérité":"Twitter"}determineActualPlatform(e){switch(this.determineActualSource(e)){case"Twitter":return"Twitter";case"Google News":return"Google News";case"Radio Okapi":case"Voice of Congo":case"Actualité.cd":case"Media Congo":case"7sur7.cd":case"Congo Page":case"Congo Liberty":case"La Prospérité":case"DRC News":return"News Website";default:return"Unknown"}}determineLocation(e){var n;switch(this.determineActualSource(e)){case"Radio Okapi":case"Voice of Congo":case"Actualité.cd":case"Media Congo":case"7sur7.cd":case"Congo Page":case"Congo Liberty":case"La Prospérité":case"DRC News":return"Kinshasa, RDC";case"Google News":return"Global/RDC";case"Twitter":return((n=e.geo)==null?void 0:n.full_name)||"RDC";default:return"RDC"}}calculateTotalEngagement(e){return((e==null?void 0:e.like_count)||0)+((e==null?void 0:e.retweet_count)||0)+((e==null?void 0:e.reply_count)||0)+((e==null?void 0:e.quote_count)||0)}extractTimestamp(e){try{return e!=null&&e.toDate?e.toDate().toISOString():e!=null&&e.seconds?new Date(e.seconds*1e3).toISOString():typeof e=="string"?new Date(e).toISOString():e instanceof Date?e.toISOString():new Date().toISOString()}catch(r){return console.error("Error extracting timestamp:",r,e),new Date().toISOString()}}mapEngagementToPriority(e){return e>100?"high":e>20?"medium":"low"}async getRawData(e=1e4,r){try{console.log(`DEBUG: Getting raw data from collection 'twitter_posts' with limit ${e}`);const n=Jl(this.postsCollection,hh(1)),i=await tc(n);console.log(`DEBUG: Collection 'twitter_posts' has at least ${i.docs.length} documents`);let o=Jl(this.postsCollection,hh(e));console.log("DEBUG: Trying query without orderBy first..."),r&&(o=Jl(o,I5e(r)));const u=await tc(o);return console.log(`DEBUG: Firestore query returned ${u.docs.length} documents`),{data:u.docs.map(p=>{const g=p.data();return console.log("Raw Firestore data for doc",p.id,":",g),this.convertToRawDataItem(g,p.id)}),hasMore:!1,lastDoc:u.docs[u.docs.length-1]}}catch(n){return console.error("Error fetching raw data:",n),{data:[],hasMore:!1}}}async getRawDataByKeyword(e,r=1e4){try{const n=Jl(this.postsCollection,kh("keyword","==",e),Kx("timestamp","desc"),hh(r));return(await tc(n)).docs.map(o=>{const u=o.data();return this.convertToRawDataItem(u,o.id)})}catch(n){return console.error("Error fetching raw data by keyword:",n),[]}}async getRawDataBySentiment(e,r=1e4){try{const n=Jl(this.postsCollection,kh("sentiment","==",e),Kx("timestamp","desc"),hh(r));return(await tc(n)).docs.map(o=>{const u=o.data();return this.convertToRawDataItem(u,o.id)})}catch(n){return console.error("Error fetching raw data by sentiment:",n),[]}}async getRawDataByDateRange(e,r,n=1e4){try{const i=Jl(this.postsCollection,kh("timestamp",">=",jn.fromDate(e)),kh("timestamp","<=",jn.fromDate(r)),Kx("timestamp","desc"),hh(n));return(await tc(i)).docs.map(u=>{const a=u.data();return this.convertToRawDataItem(a,u.id)})}catch(i){return console.error("Error fetching raw data by date range:",i),[]}}async searchRawData(e,r=1e4){try{const n=Jl(this.postsCollection,Kx("timestamp","desc"),hh(r*2));return(await tc(n)).docs.map(u=>{const a=u.data();return this.convertToRawDataItem(a,u.id)}).filter(u=>u.content.toLowerCase().includes(e.toLowerCase())||u.author.toLowerCase().includes(e.toLowerCase())||u.keywords.some(a=>a.toLowerCase().includes(e.toLowerCase()))).slice(0,r)}catch(n){return console.error("Error searching raw data:",n),[]}}}class hDe{constructor(){Vl(this,"configCollection","config");Vl(this,"scrapingDocId","scraping")}async getScrapingConfig(){var e,r,n,i,o;try{const u=wh(Dg,this.configCollection,this.scrapingDocId),a=await PZ(u);if(a.exists()){const p=a.data();return{useOfficialAPI:p.useOfficialAPI??!0,enableScraping:p.enableScraping??!1,scrapingSources:{twitter:((e=p.scrapingSources)==null?void 0:e.twitter)??!0,radioOkapi:((r=p.scrapingSources)==null?void 0:r.radioOkapi)??!0,voiceOfCongo:((n=p.scrapingSources)==null?void 0:n.voiceOfCongo)??!0,drcNews:((i=p.scrapingSources)==null?void 0:i.drcNews)??!0},lastUpdated:((o=p.lastUpdated)==null?void 0:o.toDate())||new Date}}else{const p={useOfficialAPI:!0,enableScraping:!1,scrapingSources:{twitter:!0,radioOkapi:!0,voiceOfCongo:!0,drcNews:!0},lastUpdated:new Date};return await this.updateScrapingConfig(p),p}}catch(u){return console.error("Error getting scraping config:",u),{useOfficialAPI:!0,enableScraping:!1,scrapingSources:{twitter:!0,radioOkapi:!0,voiceOfCongo:!0,drcNews:!0},lastUpdated:new Date}}}async updateScrapingConfig(e){try{const r=wh(Dg,this.configCollection,this.scrapingDocId),n={...e,lastUpdated:jn.now()};await R5e(r,n,{merge:!0}),console.log("Scraping configuration updated:",e)}catch(r){throw console.error("Error updating scraping config:",r),r}}async toggleDataSource(e){try{await this.updateScrapingConfig({useOfficialAPI:e,enableScraping:!e}),console.log(`Data source toggled to: ${e?"Official API":"Scraping"}`)}catch(r){throw console.error("Error toggling data source:",r),r}}onConfigChange(e){const r=wh(Dg,this.configCollection,this.scrapingDocId);return IZ(r,n=>{var i,o,u,a,p;if(n.exists()){const g=n.data(),v={useOfficialAPI:g.useOfficialAPI??!0,enableScraping:g.enableScraping??!1,scrapingSources:{twitter:((i=g.scrapingSources)==null?void 0:i.twitter)??!0,radioOkapi:((o=g.scrapingSources)==null?void 0:o.radioOkapi)??!0,voiceOfCongo:((u=g.scrapingSources)==null?void 0:u.voiceOfCongo)??!0,drcNews:((a=g.scrapingSources)==null?void 0:a.drcNews)??!0},lastUpdated:((p=g.lastUpdated)==null?void 0:p.toDate())||new Date};e(v)}},n=>{console.error("Error listening to config changes:",n)})}async isOfficialAPIEnabled(){return(await this.getScrapingConfig()).useOfficialAPI}async isScrapingEnabled(){return(await this.getScrapingConfig()).enableScraping}async getEnabledSources(){const e=await this.getScrapingConfig(),r=[];return e.scrapingSources.twitter&&r.push("Twitter"),e.scrapingSources.radioOkapi&&r.push("Radio Okapi"),e.scrapingSources.voiceOfCongo&&r.push("Voice of Congo"),e.scrapingSources.drcNews&&r.push("DRC News"),r}}function fDe({keyword:t,className:e=""}){const[r,n]=Y.useState([]),[i,o]=Y.useState(!0),[u,a]=Y.useState(0),p=new zZ;Y.useEffect(()=>{g()},[t]);const g=async()=>{o(!0);try{const{data:A}=await p.getRawData(1e3),I=t?A.filter(O=>O.keywords.some($=>$.toLowerCase().includes(t.toLowerCase()))||O.content.toLowerCase().includes(t.toLowerCase())):A,P=new Map;I.forEach(O=>{const $=`${O.source}|${O.platform}`;P.has($)||P.set($,[]),P.get($).push(O)});const D=I.length,L=Array.from(P.entries()).map(([O,$])=>{const[G,B]=O.split("|"),J=$.reduce((H,V)=>H+V.engagement,0)/$.length,W=$.sort((H,V)=>new Date(V.timestamp).getTime()-new Date(H.timestamp).getTime())[0];return{source:G,platform:B,count:$.length,percentage:$.length/D*100,latestTimestamp:(W==null?void 0:W.timestamp)||"",avgEngagement:Math.round(J),icon:v(G),color:w(G)}});L.sort((O,$)=>$.count-O.count),n(L),a(D)}catch(A){console.error("Error loading source breakdown:",A)}finally{o(!1)}},v=A=>{switch(A){case"Twitter":return l.jsx(lf,{className:"w-4 h-4"});case"Radio Okapi":return l.jsx(eae,{className:"w-4 h-4"});case"Voice of Congo":case"Actualité.cd":case"Media Congo":case"Congo Page":case"Congo Liberty":case"DRC News":return l.jsx(Jie,{className:"w-4 h-4"});default:return l.jsx(Uh,{className:"w-4 h-4"})}},w=A=>{switch(A){case"Twitter":return"bg-blue-500";case"Radio Okapi":return"bg-green-500";case"Voice of Congo":return"bg-purple-500";case"Actualité.cd":return"bg-orange-500";case"Media Congo":return"bg-red-500";case"Congo Page":return"bg-indigo-500";case"Congo Liberty":return"bg-yellow-500";case"DRC News":return"bg-pink-500";default:return"bg-gray-500"}},T=A=>{const I=new Date,P=new Date(A),D=I.getTime()-P.getTime(),L=Math.floor(D/(1e3*60*60)),O=Math.floor(L/24);return O>0?`il y a ${O}j`:L>0?`il y a ${L}h`:"à l'instant"};return i?l.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 ${e}`,children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx(Gc,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Sources de Données"})]}),l.jsx("div",{className:"animate-pulse space-y-3",children:[1,2,3].map(A=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-4 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),l.jsx("div",{className:"flex-1 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),l.jsx("div",{className:"w-16 h-4 bg-gray-200 dark:bg-gray-700 rounded"})]},A))})]}):l.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 ${e}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Gc,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Sources de Données"})]}),l.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[u," éléments"]})]}),r.length===0?l.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[l.jsx(Gc,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),l.jsx("p",{children:"Aucune donnée disponible"}),t&&l.jsxs("p",{className:"text-sm",children:['pour le mot-clé "',t,'"']})]}):l.jsx("div",{className:"space-y-3",children:r.map((A,I)=>l.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[l.jsx("div",{className:`w-3 h-3 rounded-full ${A.color}`}),l.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[A.icon,l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("div",{className:"font-medium text-gray-800 dark:text-white truncate",children:A.source}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:A.platform})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"font-semibold text-gray-800 dark:text-white",children:A.count}),l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[A.percentage.toFixed(1),"%"]})]}),l.jsxs("div",{className:"text-right min-w-0",children:[l.jsx("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:A.avgEngagement}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"eng. moy."})]}),A.latestTimestamp&&l.jsx("div",{className:"text-right min-w-0",children:l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:T(A.latestTimestamp)})})]},`${A.source}-${A.platform}`))}),r.length>0&&l.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600",children:l.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-bold text-gray-800 dark:text-white",children:r.length}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Sources actives"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-bold text-gray-800 dark:text-white",children:Math.round(r.reduce((A,I)=>A+I.avgEngagement,0)/r.length)}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Engagement moyen"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-bold text-gray-800 dark:text-white",children:r.filter(A=>A.latestTimestamp&&new Date().getTime()-new Date(A.latestTimestamp).getTime()<24*60*60*1e3).length}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Actives (24h)"})]})]})})]})}function g4({keywords:t,setKeywords:e}){var xe,ye;const[r,n]=Y.useState(""),[i,o]=Y.useState(!1),[u,a]=Y.useState([]),[p,g]=Y.useState(!1),[v,w]=Y.useState("keywords"),[T,A]=Y.useState(null),[I,P]=Y.useState([]),[D,L]=Y.useState(!1);Y.useState(!1),Y.useState(null);const[O,$]=Y.useState(null);Y.useState(!1);const G=new LZ,B=new zZ,J=new hDe;Y.useEffect(()=>{const Se=G.onKeywordsChange(Ce=>{e(Ce)}),be=J.onConfigChange(Ce=>{$(Ce)});return W(),()=>{Se(),be()}},[]);const W=async()=>{L(!0);try{const{data:Se}=await B.getRawData(1e4);console.log(`Loading raw data: found ${Se.length} total items`),P(Se)}catch(Se){console.error("Error loading raw data:",Se)}finally{L(!1)}},H=async()=>{if(r.trim()&&t.length<20){o(!0);try{await G.addKeyword(r.trim()),n("")}catch(Se){console.error("Error adding keyword:",Se);const be={id:Date.now(),term:r.trim(),mentions:0,trend:[0,0,0,0,0,0,0],status:"active",createdAt:new Date,sentiment:{positive:0,negative:0,neutral:100}};e([...t,be]),n("")}finally{o(!1)}}},[V,se]=Y.useState(null),K=Se=>{const be=t.find(Ce=>Ce.id===Se);be&&se({id:Se,term:be.term})},ce=async()=>{if(V)try{await G.deleteKeyword(V.id)}catch(Se){console.error("Error deleting keyword:",Se),e(t.filter(be=>be.id!==V.id))}finally{se(null)}},ne=Se=>{a(be=>be.includes(Se)?be.filter(Ce=>Ce!==Se):[...be,Se])},re=Se=>{switch(Se){case"critical":return"from-red-500 to-red-600";case"warning":return"from-yellow-500 to-yellow-600";default:return"from-green-500 to-green-600"}},oe=Se=>{switch(Se){case"critical":return"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300";case"warning":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300";default:return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300"}},ae=async()=>{if(O)try{await J.toggleDataSource(!O.useOfficialAPI),console.log(`Switched to ${O.useOfficialAPI?"Scraping":"Official API"} mode`)}catch(Se){console.error("Error toggling data source:",Se)}};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Surveillance des Mots-clés"}),l.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.length," mots-clés actifs • Collecte automatique lors de l'ajout"]}),O&&l.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full text-xs font-medium ${O.useOfficialAPI?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300"}`,children:[O.useOfficialAPI?l.jsx(U6,{className:"w-3 h-3"}):l.jsx(V6,{className:"w-3 h-3"}),l.jsx("span",{children:O.useOfficialAPI?"API Twitter":"Scraping Multi-Sources"})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[u.length>0&&l.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[l.jsx(B6,{className:"w-4 h-4"}),l.jsxs("span",{children:["Supprimer (",u.length,")"]})]}),O&&l.jsxs("button",{onClick:ae,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${O.useOfficialAPI?"bg-blue-600 text-white hover:bg-blue-700":"bg-green-600 text-white hover:bg-green-700"}`,children:[O.useOfficialAPI?l.jsx(U6,{className:"w-4 h-4"}):l.jsx(V6,{className:"w-4 h-4"}),l.jsx("span",{children:O.useOfficialAPI?"Passer au Scraping":"Passer à l'API"})]}),l.jsxs("button",{onClick:()=>g(!p),className:"flex items-center space-x-2 px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[l.jsx(No,{className:"w-4 h-4"}),l.jsx("span",{children:"Analytique"})]})]})]}),l.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("button",{onClick:()=>w("keywords"),className:`px-6 py-4 font-medium text-sm border-b-2 transition-colors ${v==="keywords"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[l.jsx(No,{className:"w-4 h-4 inline mr-2"}),"Mots-clés"]}),l.jsxs("button",{onClick:()=>w("rawdata"),className:`px-6 py-4 font-medium text-sm border-b-2 transition-colors ${v==="rawdata"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[l.jsx(Gc,{className:"w-4 h-4 inline mr-2"}),"Données Brutes"]})]}),v==="keywords"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4",children:"Ajouter un mot-clé"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx("input",{type:"text",value:r,onChange:Se=>n(Se.target.value),onKeyPress:Se=>Se.key==="Enter"&&H(),placeholder:"Entrez un mot-clé à surveiller...",className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),r&&l.jsxs("div",{className:"absolute right-3 top-3 text-sm text-gray-500",children:[r.length,"/50"]})]}),l.jsxs("button",{onClick:H,disabled:!r.trim()||i||t.length>=20,className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:[l.jsx(qh,{className:"w-5 h-5"}),l.jsx("span",{children:i?"Ajout...":"Ajouter"})]})]}),t.length>=20&&l.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 mt-2",children:"Limite de 20 mots-clés atteinte"})]}),p&&l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Total des mentions"}),l.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:t.reduce((Se,be)=>Se+be.mentions,0).toLocaleString()}),l.jsx("p",{className:"text-sm text-green-600 mt-1",children:"+15% depuis hier"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Mot-clé le plus actif"}),l.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:((xe=t.reduce((Se,be)=>be.mentions>Se.mentions?be:Se,t[0]))==null?void 0:xe.term)||"-"}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[((ye=t.reduce((Se,be)=>be.mentions>Se.mentions?be:Se,t[0]))==null?void 0:ye.mentions)||0," mentions"]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Alertes actives"}),l.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:t.filter(Se=>Se.status==="critical"||Se.status==="warning").length}),l.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Nécessite attention"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:t.map(Se=>{const be=u.includes(Se.id),Ce=Math.max(...Se.trend,1);return l.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all p-6 border-2 cursor-pointer ${be?"border-blue-500":"border-transparent"}`,onClick:()=>A(Se),children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:Se.term}),l.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium mt-2 ${oe(Se.status)}`,children:Se.status==="critical"?"Critique":Se.status==="warning"?"Attention":"Normal"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:$e=>{$e.stopPropagation(),ne(Se.id)},className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",children:l.jsx("div",{className:`w-5 h-5 border-2 rounded ${be?"bg-blue-500 border-blue-500":"border-gray-300 dark:border-gray-600"}`,children:be&&l.jsx(hi,{className:"w-3 h-3 text-white"})})}),l.jsx("button",{onClick:$e=>{$e.stopPropagation(),K(Se.id)},className:"p-1 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors group",children:l.jsx(B6,{className:"w-4 h-4 text-gray-400 group-hover:text-red-600"})})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Mentions"}),l.jsx("span",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:Se.mentions})]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"aujourd'hui"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Tendance 7 jours"}),l.jsx("div",{className:"h-12 flex items-end space-x-1",children:Se.trend.map(($e,Ye)=>l.jsx("div",{className:`flex-1 bg-gradient-to-t ${re(Se.status)} rounded-t transition-all duration-300 hover:opacity-80`,style:{height:`${$e/Ce*100}%`}},Ye))})]}),Se.sentiment&&l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"Sentiment"}),l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:l.jsxs("div",{className:"h-full flex",children:[l.jsx("div",{className:"bg-green-500",style:{width:`${Se.sentiment.positive}%`}}),l.jsx("div",{className:"bg-gray-400",style:{width:`${Se.sentiment.neutral}%`}}),l.jsx("div",{className:"bg-red-500",style:{width:`${Se.sentiment.negative}%`}})]})})})]})]}),l.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx("button",{onClick:$e=>{$e.stopPropagation(),A(Se)},className:"text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-3 py-1 rounded-lg transition-colors",children:"Voir détails"})})})]},Se.id)})})]}),v==="rawdata"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx(fDe,{}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm",children:D?l.jsxs("div",{className:"flex items-center justify-center p-12",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Chargement des données..."})]}):l.jsx(Wg,{data:I})})]}),l.jsx(Zae,{isOpen:V!==null,onClose:()=>se(null),onConfirm:ce,title:"Supprimer le mot-clé",message:`Êtes-vous sûr de vouloir supprimer le mot-clé "${V==null?void 0:V.term}" ? Cette action est irréversible.`,confirmText:"Supprimer",cancelText:"Annuler",type:"danger"}),l.jsx(dDe,{keyword:T,isOpen:T!==null,onClose:()=>A(null)})]})}new Date(Date.now()-3e5).toISOString(),new Date(Date.now()-9e5).toISOString(),new Date(Date.now()-36e5).toISOString();const pDe=[{id:1,source:"twitter",author:"MinSécuritéRDC",verified:!0,content:"Nouvelles mesures de sécurité annoncées pour renforcer la protection dans les provinces orientales. Un plan d'action coordonné avec les forces de l'ordre est en cours de déploiement.",timestamp:new Date(Date.now()-3e5),sentiment:{score:.85,label:"positive"},credibility:94,engagement:{likes:1247,shares:523,comments:89},location:"Kinshasa",topics:["sécurité","gouvernement","provinces"],reach:125e3},{id:2,source:"facebook",author:"InfoCongoActu",verified:!1,content:"URGENT!!! Des RÉVÉLATIONS CHOQUANTES sur la situation sécuritaire!!! Le gouvernement CACHE LA VÉRITÉ! PARTAGEZ AVANT SUPPRESSION!!!",timestamp:new Date(Date.now()-9e5),sentiment:{score:-.92,label:"negative"},credibility:12,engagement:{likes:45,shares:2341,comments:167},alerts:["Propagation suspecte","Langage sensationnaliste","Source non vérifiée"],location:"Goma",topics:["désinformation","sécurité"],reach:45e3},{id:3,source:"news",author:"Radio Okapi",verified:!0,content:"Analyse approfondie: Les experts en sécurité nationale soulignent l'importance d'une approche intégrée combinant technologie moderne et engagement communautaire pour garantir la paix.",timestamp:new Date(Date.now()-36e5),sentiment:{score:.15,label:"neutral"},credibility:89,engagement:{likes:892,shares:234,comments:56},location:"Lubumbashi",topics:["analyse","sécurité","technologie"],reach:89e3}],mDe=t=>({twitter:{icon:"𝕏",color:"text-gray-900 dark:text-white"},facebook:{icon:"f",color:"text-blue-600"},news:{icon:Uh,color:"text-orange-500"}})[t],gDe=t=>{switch(t){case"news":return Uh;case"social":return ea;case"blog":return XI;default:return Gc}},yDe=t=>t>=80?{color:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300",label:"Fiable"}:t>=50?{color:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300",label:"À vérifier"}:{color:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300",label:"Douteux"},xDe=t=>{switch(t){case"critical":return"from-red-500 to-red-600";case"warning":return"from-yellow-500 to-yellow-600";case"active":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300";case"monitoring":return"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300";default:return"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}},vDe=t=>t==="positive"?{icon:ii,color:"text-green-600"}:t==="negative"?{icon:Qv,color:"text-red-600"}:{icon:ds,color:"text-gray-600"};function _De({}){const[t,e]=Y.useState(""),[r,n]=Y.useState({source:"all",sentiment:"all",timeRange:"24h",credibility:"all"}),[i,o]=Y.useState([]),[u,a]=Y.useState(!1),[p,g]=Y.useState("list"),v=()=>{t.length<2||(a(!0),setTimeout(()=>{o(pDe),a(!1)},1500))},w=T=>vDe(T);return l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",value:t,onChange:T=>e(T.target.value),onKeyPress:T=>T.key==="Enter"&&v(),placeholder:"Rechercher des personnes, sujets, événements...",className:"w-full pl-12 pr-4 py-4 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx(iu,{className:"absolute left-4 top-5 w-5 h-5 text-gray-400"}),l.jsx("button",{onClick:v,disabled:t.length<2||u,className:"absolute right-2 top-2 px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:u?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Recherche..."})]}):"Rechercher"})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsxs("select",{value:r.source,onChange:T=>n({...r,source:T.target.value}),className:"px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"all",children:"Toutes sources"}),l.jsx("option",{value:"twitter",children:"Twitter"}),l.jsx("option",{value:"facebook",children:"Facebook"}),l.jsx("option",{value:"news",children:"Actualités"})]}),l.jsxs("select",{value:r.sentiment,onChange:T=>n({...r,sentiment:T.target.value}),className:"px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"all",children:"Tout sentiment"}),l.jsx("option",{value:"positive",children:"Positif"}),l.jsx("option",{value:"neutral",children:"Neutre"}),l.jsx("option",{value:"negative",children:"Négatif"})]}),l.jsxs("select",{value:r.timeRange,onChange:T=>n({...r,timeRange:T.target.value}),className:"px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"1h",children:"Dernière heure"}),l.jsx("option",{value:"24h",children:"24 heures"}),l.jsx("option",{value:"7d",children:"7 jours"}),l.jsx("option",{value:"30d",children:"30 jours"})]}),l.jsxs("select",{value:r.credibility,onChange:T=>n({...r,credibility:T.target.value}),className:"px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"all",children:"Toute crédibilité"}),l.jsx("option",{value:"high",children:"Haute (80%+)"}),l.jsx("option",{value:"medium",children:"Moyenne (50-80%)"}),l.jsx("option",{value:"low",children:"Faible (-50%)"})]}),l.jsxs("div",{className:"ml-auto flex items-center space-x-2",children:[l.jsx("button",{onClick:()=>g("list"),className:`p-2 rounded-lg transition-colors ${p==="list"?"bg-gray-100 dark:bg-gray-700":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:l.jsx(YI,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>g("grid"),className:`p-2 rounded-lg transition-colors ${p==="grid"?"bg-gray-100 dark:bg-gray-700":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:l.jsx(Gc,{className:"w-5 h-5"})})]})]})]})}),i.length>0&&!u&&l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:[i.length," résultats trouvés"]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Recherche effectuée en 1.2 secondes • IA activée"})]}),l.jsxs("button",{className:"flex items-center space-x-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-4 py-2 rounded-lg transition-colors",children:[l.jsx(Co,{className:"w-4 h-4"}),l.jsx("span",{children:"Exporter"})]})]}),l.jsx("div",{className:p==="grid"?"grid grid-cols-1 md:grid-cols-2 gap-6":"space-y-4",children:i.map((T,A)=>{const I=mDe(T.source),P=yDe(T.credibility),D=w(T.sentiment.label),L=D.icon;return l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all p-6 animate-fadeInUp",style:{animationDelay:`${A*.1}s`},children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-xl flex items-center justify-center",children:typeof(I==null?void 0:I.icon)=="string"?l.jsx("span",{className:`text-2xl font-bold ${I.color}`,children:I.icon}):I!=null&&I.icon?l.jsx(I.icon,{className:`w-6 h-6 ${I.color}`}):l.jsx(Uh,{className:"w-6 h-6 text-gray-500"})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white",children:T.author}),T.verified&&l.jsx(hi,{className:"w-4 h-4 text-blue-500"})]}),l.jsxs("div",{className:"flex items-center space-x-3 text-sm text-gray-500 dark:text-gray-400",children:[l.jsx("span",{children:new Date(T.timestamp).toLocaleString("fr-FR")}),l.jsx("span",{children:"•"}),l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(od,{className:"w-3 h-3"}),l.jsx("span",{children:T.location})]})]})]})]}),l.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${P.color}`,children:[T.credibility,"% ",P.label]})]}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed mb-4",children:T.content}),T.alerts&&l.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-red-700 dark:text-red-300 font-medium mb-2",children:[l.jsx(oi,{className:"w-4 h-4"}),l.jsx("span",{children:"Alertes détectées"})]}),l.jsx("ul",{className:"text-sm text-red-600 dark:text-red-400 space-y-1",children:T.alerts.map((O,$)=>l.jsxs("li",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"w-1 h-1 bg-red-500 rounded-full"}),l.jsx("span",{children:O})]},$))})]}),l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("button",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:[l.jsx(ds,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:T.engagement.likes.toLocaleString()})]}),l.jsxs("button",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:[l.jsx(lf,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:T.engagement.comments})]}),l.jsxs("button",{className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:[l.jsx(ob,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:T.engagement.shares})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:`flex items-center space-x-1 ${D.color}`,children:[l.jsx(L,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium capitalize",children:T.sentiment.label})]}),l.jsx("div",{className:"flex items-center space-x-2",children:T.topics.slice(0,2).map(O=>l.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded-md text-xs font-medium text-gray-600 dark:text-gray-400",children:["#",O]},O))})]})]}),l.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Portée estimée"}),l.jsxs("span",{className:"font-medium text-gray-800 dark:text-white",children:[T.reach.toLocaleString()," personnes"]})]}),l.jsx("div",{className:"mt-2 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-1000",style:{width:`${Math.min(T.reach/2e5*100,100)}%`}})})]})]},T.id)})})]})}const Aw=({icon:t,title:e,value:r,change:n,changeColor:i,gradientFrom:o,gradientTo:u})=>l.jsxs("div",{className:`bg-gradient-to-br ${o} ${u} rounded-xl p-6 text-white`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx(t,{className:"w-8 h-8 opacity-80"}),l.jsx("span",{className:`text-sm font-medium bg-white/20 px-2 py-1 rounded ${i}`,children:n})]}),l.jsx("p",{className:"text-sm opacity-90",children:e}),l.jsx("p",{className:"text-3xl font-bold",children:r})]}),y4=({className:t})=>{const[e,r]=Y.useState("7d"),[n,i]=Y.useState(!1),[o,u]=Y.useState(!1),[a,p]=Y.useState("all"),[g,v]=Y.useState(null),[w,T]=Y.useState({start:"",end:""}),[A,I]=Y.useState([{id:"sentiment",title:"Évolution du Sentiment",type:"area",position:{x:0,y:0,w:6,h:4},visible:!0},{id:"sources",title:"Performance des Sources",type:"bar",position:{x:6,y:0,w:6,h:4},visible:!0},{id:"topics",title:"Distribution des Sujets",type:"pie",position:{x:0,y:4,w:6,h:4},visible:!0},{id:"engagement",title:"Entonnoir d'Engagement",type:"bar",position:{x:6,y:4,w:6,h:4},visible:!0}]),[P,D]=Y.useState("view"),[L,O]=Y.useState("png"),$=[{date:"01/11",positive:245,negative:89,neutral:156},{date:"02/11",positive:289,negative:112,neutral:189},{date:"03/11",positive:312,negative:98,neutral:201},{date:"04/11",positive:367,negative:134,neutral:223},{date:"05/11",positive:398,negative:156,neutral:245},{date:"06/11",positive:423,negative:189,neutral:267},{date:"07/11",positive:445,negative:201,neutral:289}],G=[{source:"Facebook",mentions:4567,engagement:89234,sentiment:72,growth:15.3},{source:"Twitter",mentions:3892,engagement:67123,sentiment:68,growth:-5.2},{source:"News",mentions:2341,engagement:45678,sentiment:81,growth:8.7},{source:"Forums",mentions:1234,engagement:23456,sentiment:54,growth:12.1}],B=[{name:"Sécurité",value:3938,percentage:28.5},{name:"Politique",value:3122,percentage:22.6},{name:"Économie",value:2714,percentage:19.6},{name:"Social",value:2145,percentage:15.5},{name:"Santé",value:1345,percentage:9.7},{name:"Autres",value:567,percentage:4.1}],J=[{name:"Impressions",value:145e3,fill:"#3B82F6"},{name:"Engagements",value:23450,fill:"#8B5CF6"},{name:"Partages",value:8920,fill:"#EC4899"},{name:"Actions",value:2340,fill:"#F59E0B"}],W=["#3B82F6","#8B5CF6","#EC4899","#F59E0B","#10B981","#6B7280"],H=Ce=>{switch(Ce){case"Facebook":return"bg-blue-500";case"Twitter":return"bg-gray-900";case"News":return"bg-orange-500";default:return"bg-purple-500"}},V=Ce=>Ce>=70?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":Ce>=50?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300",K=(()=>{const Ce=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],$e=Array.from({length:24},(Ye,jt)=>jt);return Ce.map(Ye=>({day:Ye,hours:$e.map(jt=>({hour:jt,intensity:Math.random(),mentions:Math.floor(Math.random()*100)}))}))})(),ce=Y.useCallback(async()=>{u(!0),setTimeout(()=>{u(!1)},2e3)},[]),ne=Y.useCallback((Ce,$e)=>{let Ye=null;switch($e){case"source":Ye={type:"source",value:Ce.source,data:[{platform:"Posts",count:234,engagement:12.3},{platform:"Comments",count:567,engagement:8.7},{platform:"Shares",count:89,engagement:24.1}]};break;case"topic":Ye={type:"topic",value:Ce.name,data:[{subtopic:"Elections",mentions:1234,sentiment:.6},{subtopic:"Corruption",mentions:567,sentiment:-.3},{subtopic:"Réformes",mentions:890,sentiment:.2}]};break;case"sentiment":Ye={type:"sentiment",value:Ce.date,data:[{hour:"00:00",positive:12,negative:5,neutral:8},{hour:"06:00",positive:23,negative:12,neutral:15},{hour:"12:00",positive:45,negative:18,neutral:32},{hour:"18:00",positive:38,negative:25,neutral:28}]};break}v(Ye)},[]),re=Y.useCallback((Ce,$e)=>{const Ye=`analytics-${Ce}-${new Date().toISOString().split("T")[0]}.${$e}`;if($e==="csv"||$e==="json"){const jt=Ce==="sentiment"?$:Ce==="sources"?G:Ce==="topics"?B:J,Me=$e==="csv"?oe(jt):JSON.stringify(jt,null,2),St=new Blob([Me],{type:$e==="csv"?"text/csv":"application/json"}),Ct=URL.createObjectURL(St),Ft=document.createElement("a");Ft.href=Ct,Ft.download=Ye,Ft.click(),URL.revokeObjectURL(Ct)}else alert(`Export ${$e.toUpperCase()} pour ${Ce} - Fonctionnalité en développement`)},[$,G,B,J]),oe=Ce=>{if(!Ce.length)return"";const $e=Object.keys(Ce[0]).join(","),Ye=Ce.map(jt=>Object.values(jt).join(","));return[$e,...Ye].join(`
`)},ae=Y.useCallback(Ce=>{const $e=Ce==="24h"?.5:Ce==="7d"?1:Ce==="30d"?2.1:Ce==="90d"?3.2:1;return{sentimentData:$.map(Ye=>({...Ye,positive:Math.floor(Ye.positive*$e*(.8+Math.random()*.4)),negative:Math.floor(Ye.negative*$e*(.8+Math.random()*.4)),neutral:Math.floor(Ye.neutral*$e*(.8+Math.random()*.4))})),sourcePerformance:G.map(Ye=>({...Ye,mentions:Math.floor(Ye.mentions*$e*(.8+Math.random()*.4)),engagement:Math.floor(Ye.engagement*$e*(.8+Math.random()*.4))}))}},[$,G]);Y.useEffect(()=>{const Ce=setInterval(()=>{e!=="custom"&&ce()},3e4);return()=>clearInterval(Ce)},[e,ce]);const xe=ae(e),ye=Ce=>Ce>.8?"bg-red-500":Ce>.6?"bg-orange-500":Ce>.4?"bg-yellow-500":Ce>.2?"bg-green-500":"bg-gray-300 dark:bg-gray-600",Se=()=>g?l.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:l.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[l.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>v(null)}),l.jsxs("div",{className:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 px-6 pt-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900 dark:text-white",children:["Analyse Détaillée - ",g.value]}),l.jsx("button",{onClick:()=>v(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:"×"})]})}),l.jsx("div",{className:"px-6 py-6",children:l.jsx("div",{className:"space-y-4",children:g.data.map((Ce,$e)=>l.jsx("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Object.values(Ce)[0]}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:Object.entries(Ce).slice(1).map(([Ye,jt])=>`${Ye}: ${jt}`).join(" • ")})]})},$e))})}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 px-6 py-4 flex justify-end space-x-3",children:[l.jsx("button",{onClick:()=>re(g.type,"csv"),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-50 dark:hover:bg-gray-500",children:"Exporter CSV"}),l.jsx("button",{onClick:()=>v(null),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:"Fermer"})]})]})]})}):null,be=(Ce,$e)=>{const Ye={onClick:jt=>ne(jt,Ce.id),style:{cursor:"pointer"}};return l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:Ce.title}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:()=>re(Ce.id,L),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:"Exporter",children:l.jsx(Co,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>ne($e,Ce.id),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:"Voir détails",children:l.jsx(RT,{className:"w-4 h-4"})})]})]}),l.jsx(Jg,{width:"100%",height:300,children:Ce.type==="area"?l.jsxs($H,{data:xe.sentimentData,...Ye,children:[l.jsx(gb,{strokeDasharray:"3 3"}),l.jsx(Td,{dataKey:"date"}),l.jsx(ou,{}),l.jsx(as,{}),l.jsx(cs,{type:"monotone",dataKey:"positive",stackId:"1",stroke:"#10B981",fill:"#10B981"}),l.jsx(cs,{type:"monotone",dataKey:"neutral",stackId:"1",stroke:"#6B7280",fill:"#6B7280"}),l.jsx(cs,{type:"monotone",dataKey:"negative",stackId:"1",stroke:"#EF4444",fill:"#EF4444"})]}):l.jsxs(h3,{...Ye,children:[l.jsx(fc,{data:B,cx:"50%",cy:"50%",outerRadius:100,dataKey:"value",label:({name:jt,percentage:Me})=>`${jt} ${Me}%`,children:B.map((jt,Me)=>l.jsx(Hp,{fill:W[Me%W.length]},`cell-${Me}`))}),l.jsx(as,{})]})})]})};return l.jsxs("div",{className:`min-h-screen bg-gray-50 dark:bg-gray-900 ${t}`,children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center",children:[l.jsx(No,{className:"w-8 h-8 mr-3 text-blue-600"}),"Analyses Avancées"]}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Tableaux de bord interactifs et analyses en temps réel"})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("button",{onClick:ce,disabled:o,className:`flex items-center space-x-2 px-4 py-2 rounded-lg ${o?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[l.jsx(ro,{className:`w-4 h-4 ${o?"animate-spin":""}`}),l.jsx("span",{children:o?"Actualisation...":"Actualiser"})]}),l.jsxs("button",{onClick:()=>D(P==="edit"?"view":"edit"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg ${P==="edit"?"bg-orange-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[l.jsx(Bie,{className:"w-4 h-4"}),l.jsx("span",{children:P==="edit"?"Terminer":"Personnaliser"})]})]})]})})}),l.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ZI,{className:"w-4 h-4 text-gray-400"}),l.jsxs("select",{value:e,onChange:Ce=>r(Ce.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"24h",children:"Dernières 24h"}),l.jsx("option",{value:"7d",children:"7 derniers jours"}),l.jsx("option",{value:"30d",children:"30 derniers jours"}),l.jsx("option",{value:"90d",children:"3 derniers mois"}),l.jsx("option",{value:"custom",children:"Période personnalisée"})]})]}),e==="custom"&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"date",value:w.start,onChange:Ce=>T($e=>({...$e,start:Ce.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}),l.jsx("span",{className:"text-gray-400",children:"à"}),l.jsx("input",{type:"date",value:w.end,onChange:Ce=>T($e=>({...$e,end:Ce.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(sb,{className:"w-4 h-4 text-gray-400"}),l.jsxs("select",{value:a,onChange:Ce=>p(Ce.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"all",children:"Toutes les métriques"}),l.jsx("option",{value:"sentiment",children:"Sentiment uniquement"}),l.jsx("option",{value:"engagement",children:"Engagement uniquement"}),l.jsx("option",{value:"reach",children:"Portée uniquement"})]})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Export:"}),l.jsxs("select",{value:L,onChange:Ce=>O(Ce.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"png",children:"PNG"}),l.jsx("option",{value:"pdf",children:"PDF"}),l.jsx("option",{value:"csv",children:"CSV"}),l.jsx("option",{value:"json",children:"JSON"})]})]}),l.jsxs("button",{onClick:()=>i(!n),className:`flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium ${n?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:[l.jsx(ds,{className:"w-4 h-4"}),l.jsx("span",{children:"Comparaison"})]})]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[l.jsx(Aw,{icon:il,title:"Total Mentions",value:"124.5K",change:"+23%",changeColor:"",gradientFrom:"from-blue-500",gradientTo:"to-blue-600"}),l.jsx(Aw,{icon:ii,title:"Taux d'Engagement",value:"18.7%",change:"+5.2%",changeColor:"",gradientFrom:"from-green-500",gradientTo:"to-green-600"}),l.jsx(Aw,{icon:ea,title:"Portée Unique",value:"2.1M",change:"+12%",changeColor:"",gradientFrom:"from-purple-500",gradientTo:"to-purple-600"}),l.jsx(Aw,{icon:Mh,title:"Score Sentiment",value:"72.3",change:"+8.1%",changeColor:"",gradientFrom:"from-orange-500",gradientTo:"to-orange-600"})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:A.filter(Ce=>Ce.visible).map(Ce=>l.jsxs("div",{className:"relative",children:[be(Ce,Ce.id==="sentiment"?xe.sentimentData:Ce.id==="sources"?xe.sourcePerformance:Ce.id==="topics"?B:J),P==="edit"&&l.jsx("div",{className:"absolute top-2 right-2 bg-white dark:bg-gray-800 rounded-lg p-2 shadow-lg border border-gray-200 dark:border-gray-600",children:l.jsx("button",{onClick:()=>I($e=>$e.map(Ye=>Ye.id===Ce.id?{...Ye,visible:!1}:Ye)),className:"text-red-600 hover:text-red-800 p-1",title:"Masquer",children:l.jsx(ul,{className:"w-4 h-4"})})})]},Ce.id))}),P==="edit"&&l.jsx("div",{className:"mb-8",children:l.jsxs("button",{className:"w-full border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 transition-colors",children:[l.jsx(qh,{className:"w-8 h-8 mx-auto text-gray-400 mb-2"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Ajouter un graphique"})]})}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Performance Détaillée des Sources"}),l.jsxs("button",{onClick:()=>re("sources-detailed",L),className:"flex items-center space-x-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:[l.jsx(ob,{className:"w-4 h-4"}),l.jsx("span",{children:"Partager"})]})]}),l.jsx("div",{className:"space-y-4",children:xe.sourcePerformance.map((Ce,$e)=>l.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer transition-colors",onClick:()=>ne(Ce,"source"),children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:`w-4 h-4 rounded-full ${H(Ce.source)}`}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:Ce.source}),l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[Ce.mentions.toLocaleString()," mentions • ",Ce.engagement.toLocaleString()," engagements"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${V(Ce.sentiment)}`,children:[Ce.sentiment,"% sentiment"]}),l.jsxs("span",{className:`text-sm font-medium ${Ce.growth>=0?"text-green-600":"text-red-600"}`,children:[Ce.growth>=0?"+":"",Ce.growth.toFixed(1),"%"]}),l.jsx(ul,{className:"w-4 h-4 text-gray-400"})]})]},Ce.source))})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Carte de Chaleur - Activité par Heure"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Faible"}),l.jsxs("div",{className:"flex space-x-1",children:[l.jsx("div",{className:"w-3 h-3 bg-gray-300 dark:bg-gray-600 rounded"}),l.jsx("div",{className:"w-3 h-3 bg-green-300 rounded"}),l.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded"}),l.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded"}),l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"})]}),l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Élevé"})]})]}),l.jsx("div",{className:"space-y-2",children:K.map(Ce=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-12 text-sm text-gray-600 dark:text-gray-400 text-right",children:Ce.day}),l.jsx("div",{className:"flex space-x-1",children:Ce.hours.map($e=>l.jsx("div",{className:`w-4 h-4 rounded-sm ${ye($e.intensity)} cursor-pointer`,title:`${Ce.day} ${$e.hour}:00 - ${$e.mentions} mentions`,onClick:()=>ne({day:Ce.day,hour:$e.hour,mentions:$e.mentions},"heatmap")},$e.hour))})]},Ce.day))}),l.jsxs("div",{className:"flex justify-center space-x-8 mt-4 text-xs text-gray-500 dark:text-gray-400",children:[l.jsx("span",{children:"00h"}),l.jsx("span",{children:"06h"}),l.jsx("span",{children:"12h"}),l.jsx("span",{children:"18h"}),l.jsx("span",{children:"24h"})]})]})]}),Se()]})]})};function bDe(t){return t}var XA=1,YA=2,x4=3,Xx=4,SB=1e-6;function wDe(t){return"translate("+t+",0)"}function kDe(t){return"translate(0,"+t+")"}function TDe(t){return e=>+t(e)}function SDe(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),r=>+t(r)+e}function EDe(){return!this.__axis}function $Z(t,e){var r=[],n=null,i=null,o=6,u=6,a=3,p=typeof window<"u"&&window.devicePixelRatio>1?0:.5,g=t===XA||t===Xx?-1:1,v=t===Xx||t===YA?"x":"y",w=t===XA||t===x4?wDe:kDe;function T(A){var I=n??(e.ticks?e.ticks.apply(e,r):e.domain()),P=i??(e.tickFormat?e.tickFormat.apply(e,r):bDe),D=Math.max(o,0)+a,L=e.range(),O=+L[0]+p,$=+L[L.length-1]+p,G=(e.bandwidth?SDe:TDe)(e.copy(),p),B=A.selection?A.selection():A,J=B.selectAll(".domain").data([null]),W=B.selectAll(".tick").data(I,e).order(),H=W.exit(),V=W.enter().append("g").attr("class","tick"),se=W.select("line"),K=W.select("text");J=J.merge(J.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),W=W.merge(V),se=se.merge(V.append("line").attr("stroke","currentColor").attr(v+"2",g*o)),K=K.merge(V.append("text").attr("fill","currentColor").attr(v,g*D).attr("dy",t===XA?"0em":t===x4?"0.71em":"0.32em")),A!==B&&(J=J.transition(A),W=W.transition(A),se=se.transition(A),K=K.transition(A),H=H.transition(A).attr("opacity",SB).attr("transform",function(ce){return isFinite(ce=G(ce))?w(ce+p):this.getAttribute("transform")}),V.attr("opacity",SB).attr("transform",function(ce){var ne=this.parentNode.__axis;return w((ne&&isFinite(ne=ne(ce))?ne:G(ce))+p)})),H.remove(),J.attr("d",t===Xx||t===YA?u?"M"+g*u+","+O+"H"+p+"V"+$+"H"+g*u:"M"+p+","+O+"V"+$:u?"M"+O+","+g*u+"V"+p+"H"+$+"V"+g*u:"M"+O+","+p+"H"+$),W.attr("opacity",1).attr("transform",function(ce){return w(G(ce)+p)}),se.attr(v+"2",g*o),K.attr(v,g*D).text(P),B.filter(EDe).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===YA?"start":t===Xx?"end":"middle"),B.each(function(){this.__axis=G})}return T.scale=function(A){return arguments.length?(e=A,T):e},T.ticks=function(){return r=Array.from(arguments),T},T.tickArguments=function(A){return arguments.length?(r=A==null?[]:Array.from(A),T):r.slice()},T.tickValues=function(A){return arguments.length?(n=A==null?null:Array.from(A),T):n&&n.slice()},T.tickFormat=function(A){return arguments.length?(i=A,T):i},T.tickSize=function(A){return arguments.length?(o=u=+A,T):o},T.tickSizeInner=function(A){return arguments.length?(o=+A,T):o},T.tickSizeOuter=function(A){return arguments.length?(u=+A,T):u},T.tickPadding=function(A){return arguments.length?(a=+A,T):a},T.offset=function(A){return arguments.length?(p=+A,T):p},T}function jDe(t){return $Z(x4,t)}function ADe(t){return $Z(Xx,t)}var NDe={value:()=>{}};function Tb(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new s2(r)}function s2(t){this._=t}function CDe(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}s2.prototype=Tb.prototype={constructor:s2,on:function(t,e){var r=this._,n=CDe(t+"",r),i,o=-1,u=n.length;if(arguments.length<2){for(;++o<u;)if((i=(t=n[o]).type)&&(i=PDe(r[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<u;)if(i=(t=n[o]).type)r[i]=EB(r[i],t.name,e);else if(e==null)for(i in r)r[i]=EB(r[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new s2(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var r=new Array(i),n=0,i,o;n<i;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],n=0,i=o.length;n<i;++n)o[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,o=n.length;i<o;++i)n[i].value.apply(e,r)}};function PDe(t,e){for(var r=0,n=t.length,i;r<n;++r)if((i=t[r]).name===e)return i.value}function EB(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=NDe,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var v4="http://www.w3.org/1999/xhtml";const jB={svg:"http://www.w3.org/2000/svg",xhtml:v4,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function rE(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),jB.hasOwnProperty(e)?{space:jB[e],local:t}:t}function IDe(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===v4&&e.documentElement.namespaceURI===v4?e.createElement(t):e.createElementNS(r,t)}}function MDe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function FZ(t){var e=rE(t);return(e.local?MDe:IDe)(e)}function DDe(){}function r5(t){return t==null?DDe:function(){return this.querySelector(t)}}function ODe(t){typeof t!="function"&&(t=r5(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o=e[i],u=o.length,a=n[i]=new Array(u),p,g,v=0;v<u;++v)(p=o[v])&&(g=t.call(p,p.__data__,v,o))&&("__data__"in p&&(g.__data__=p.__data__),a[v]=g);return new Po(n,this._parents)}function RDe(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function LDe(){return[]}function BZ(t){return t==null?LDe:function(){return this.querySelectorAll(t)}}function zDe(t){return function(){return RDe(t.apply(this,arguments))}}function $De(t){typeof t=="function"?t=zDe(t):t=BZ(t);for(var e=this._groups,r=e.length,n=[],i=[],o=0;o<r;++o)for(var u=e[o],a=u.length,p,g=0;g<a;++g)(p=u[g])&&(n.push(t.call(p,p.__data__,g,u)),i.push(p));return new Po(n,i)}function VZ(t){return function(){return this.matches(t)}}function UZ(t){return function(e){return e.matches(t)}}var FDe=Array.prototype.find;function BDe(t){return function(){return FDe.call(this.children,t)}}function VDe(){return this.firstElementChild}function UDe(t){return this.select(t==null?VDe:BDe(typeof t=="function"?t:UZ(t)))}var qDe=Array.prototype.filter;function GDe(){return Array.from(this.children)}function WDe(t){return function(){return qDe.call(this.children,t)}}function HDe(t){return this.selectAll(t==null?GDe:WDe(typeof t=="function"?t:UZ(t)))}function KDe(t){typeof t!="function"&&(t=VZ(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o=e[i],u=o.length,a=n[i]=[],p,g=0;g<u;++g)(p=o[g])&&t.call(p,p.__data__,g,o)&&a.push(p);return new Po(n,this._parents)}function qZ(t){return new Array(t.length)}function ZDe(){return new Po(this._enter||this._groups.map(qZ),this._parents)}function oT(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}oT.prototype={constructor:oT,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function XDe(t){return function(){return t}}function YDe(t,e,r,n,i,o){for(var u=0,a,p=e.length,g=o.length;u<g;++u)(a=e[u])?(a.__data__=o[u],n[u]=a):r[u]=new oT(t,o[u]);for(;u<p;++u)(a=e[u])&&(i[u]=a)}function JDe(t,e,r,n,i,o,u){var a,p,g=new Map,v=e.length,w=o.length,T=new Array(v),A;for(a=0;a<v;++a)(p=e[a])&&(T[a]=A=u.call(p,p.__data__,a,e)+"",g.has(A)?i[a]=p:g.set(A,p));for(a=0;a<w;++a)A=u.call(t,o[a],a,o)+"",(p=g.get(A))?(n[a]=p,p.__data__=o[a],g.delete(A)):r[a]=new oT(t,o[a]);for(a=0;a<v;++a)(p=e[a])&&g.get(T[a])===p&&(i[a]=p)}function QDe(t){return t.__data__}function eOe(t,e){if(!arguments.length)return Array.from(this,QDe);var r=e?JDe:YDe,n=this._parents,i=this._groups;typeof t!="function"&&(t=XDe(t));for(var o=i.length,u=new Array(o),a=new Array(o),p=new Array(o),g=0;g<o;++g){var v=n[g],w=i[g],T=w.length,A=tOe(t.call(v,v&&v.__data__,g,n)),I=A.length,P=a[g]=new Array(I),D=u[g]=new Array(I),L=p[g]=new Array(T);r(v,w,P,D,L,A,e);for(var O=0,$=0,G,B;O<I;++O)if(G=P[O]){for(O>=$&&($=O+1);!(B=D[$])&&++$<I;);G._next=B||null}}return u=new Po(u,n),u._enter=a,u._exit=p,u}function tOe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function rOe(){return new Po(this._exit||this._groups.map(qZ),this._parents)}function nOe(t,e,r){var n=this.enter(),i=this,o=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),r==null?o.remove():r(o),n&&i?n.merge(i).order():i}function iOe(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,o=n.length,u=Math.min(i,o),a=new Array(i),p=0;p<u;++p)for(var g=r[p],v=n[p],w=g.length,T=a[p]=new Array(w),A,I=0;I<w;++I)(A=g[I]||v[I])&&(T[I]=A);for(;p<i;++p)a[p]=r[p];return new Po(a,this._parents)}function aOe(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],i=n.length-1,o=n[i],u;--i>=0;)(u=n[i])&&(o&&u.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(u,o),o=u);return this}function sOe(t){t||(t=oOe);function e(w,T){return w&&T?t(w.__data__,T.__data__):!w-!T}for(var r=this._groups,n=r.length,i=new Array(n),o=0;o<n;++o){for(var u=r[o],a=u.length,p=i[o]=new Array(a),g,v=0;v<a;++v)(g=u[v])&&(p[v]=g);p.sort(e)}return new Po(i,this._parents).order()}function oOe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function lOe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function cOe(){return Array.from(this)}function uOe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,o=n.length;i<o;++i){var u=n[i];if(u)return u}return null}function dOe(){let t=0;for(const e of this)++t;return t}function hOe(){return!this.node()}function fOe(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i=e[r],o=0,u=i.length,a;o<u;++o)(a=i[o])&&t.call(a,a.__data__,o,i);return this}function pOe(t){return function(){this.removeAttribute(t)}}function mOe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function gOe(t,e){return function(){this.setAttribute(t,e)}}function yOe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function xOe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function vOe(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function _Oe(t,e){var r=rE(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?mOe:pOe:typeof e=="function"?r.local?vOe:xOe:r.local?yOe:gOe)(r,e))}function GZ(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function bOe(t){return function(){this.style.removeProperty(t)}}function wOe(t,e,r){return function(){this.style.setProperty(t,e,r)}}function kOe(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function TOe(t,e,r){return arguments.length>1?this.each((e==null?bOe:typeof e=="function"?kOe:wOe)(t,e,r??"")):I0(this.node(),t)}function I0(t,e){return t.style.getPropertyValue(e)||GZ(t).getComputedStyle(t,null).getPropertyValue(e)}function SOe(t){return function(){delete this[t]}}function EOe(t,e){return function(){this[t]=e}}function jOe(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function AOe(t,e){return arguments.length>1?this.each((e==null?SOe:typeof e=="function"?jOe:EOe)(t,e)):this.node()[t]}function WZ(t){return t.trim().split(/^|\s+/)}function n5(t){return t.classList||new HZ(t)}function HZ(t){this._node=t,this._names=WZ(t.getAttribute("class")||"")}HZ.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function KZ(t,e){for(var r=n5(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function ZZ(t,e){for(var r=n5(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function NOe(t){return function(){KZ(this,t)}}function COe(t){return function(){ZZ(this,t)}}function POe(t,e){return function(){(e.apply(this,arguments)?KZ:ZZ)(this,t)}}function IOe(t,e){var r=WZ(t+"");if(arguments.length<2){for(var n=n5(this.node()),i=-1,o=r.length;++i<o;)if(!n.contains(r[i]))return!1;return!0}return this.each((typeof e=="function"?POe:e?NOe:COe)(r,e))}function MOe(){this.textContent=""}function DOe(t){return function(){this.textContent=t}}function OOe(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ROe(t){return arguments.length?this.each(t==null?MOe:(typeof t=="function"?OOe:DOe)(t)):this.node().textContent}function LOe(){this.innerHTML=""}function zOe(t){return function(){this.innerHTML=t}}function $Oe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function FOe(t){return arguments.length?this.each(t==null?LOe:(typeof t=="function"?$Oe:zOe)(t)):this.node().innerHTML}function BOe(){this.nextSibling&&this.parentNode.appendChild(this)}function VOe(){return this.each(BOe)}function UOe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function qOe(){return this.each(UOe)}function GOe(t){var e=typeof t=="function"?t:FZ(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function WOe(){return null}function HOe(t,e){var r=typeof t=="function"?t:FZ(t),n=e==null?WOe:typeof e=="function"?e:r5(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function KOe(){var t=this.parentNode;t&&t.removeChild(this)}function ZOe(){return this.each(KOe)}function XOe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function YOe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function JOe(t){return this.select(t?YOe:XOe)}function QOe(t){return arguments.length?this.property("__data__",t):this.node().__data__}function eRe(t){return function(e){t.call(this,e,this.__data__)}}function tRe(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function rRe(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,i=e.length,o;r<i;++r)o=e[r],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++n]=o;++n?e.length=n:delete this.__on}}}function nRe(t,e,r){return function(){var n=this.__on,i,o=eRe(e);if(n){for(var u=0,a=n.length;u<a;++u)if((i=n[u]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=r),i.value=e;return}}this.addEventListener(t.type,o,r),i={type:t.type,name:t.name,value:e,listener:o,options:r},n?n.push(i):this.__on=[i]}}function iRe(t,e,r){var n=tRe(t+""),i,o=n.length,u;if(arguments.length<2){var a=this.node().__on;if(a){for(var p=0,g=a.length,v;p<g;++p)for(i=0,v=a[p];i<o;++i)if((u=n[i]).type===v.type&&u.name===v.name)return v.value}return}for(a=e?nRe:rRe,i=0;i<o;++i)this.each(a(n[i],e,r));return this}function XZ(t,e,r){var n=GZ(t),i=n.CustomEvent;typeof i=="function"?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function aRe(t,e){return function(){return XZ(this,t,e)}}function sRe(t,e){return function(){return XZ(this,t,e.apply(this,arguments))}}function oRe(t,e){return this.each((typeof e=="function"?sRe:aRe)(t,e))}function*lRe(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,o=n.length,u;i<o;++i)(u=n[i])&&(yield u)}var YZ=[null];function Po(t,e){this._groups=t,this._parents=e}function Sb(){return new Po([[document.documentElement]],YZ)}function cRe(){return this}Po.prototype=Sb.prototype={constructor:Po,select:ODe,selectAll:$De,selectChild:UDe,selectChildren:HDe,filter:KDe,data:eOe,enter:ZDe,exit:rOe,join:nOe,merge:iOe,selection:cRe,order:aOe,sort:sOe,call:lOe,nodes:cOe,node:uOe,size:dOe,empty:hOe,each:fOe,attr:_Oe,style:TOe,property:AOe,classed:IOe,text:ROe,html:FOe,raise:VOe,lower:qOe,append:GOe,insert:HOe,remove:ZOe,clone:JOe,datum:QOe,on:iRe,dispatch:oRe,[Symbol.iterator]:lRe};function ni(t){return typeof t=="string"?new Po([[document.querySelector(t)]],[document.documentElement]):new Po([[t]],YZ)}function uRe(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Uu(t,e){if(t=uRe(t),e===void 0&&(e=t.currentTarget),e){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const dRe={passive:!1},U_={capture:!0,passive:!1};function JA(t){t.stopImmediatePropagation()}function Og(t){t.preventDefault(),t.stopImmediatePropagation()}function JZ(t){var e=t.document.documentElement,r=ni(t).on("dragstart.drag",Og,U_);"onselectstart"in e?r.on("selectstart.drag",Og,U_):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function QZ(t,e){var r=t.document.documentElement,n=ni(t).on("dragstart.drag",null);e&&(n.on("click.drag",Og,U_),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Nw=t=>()=>t;function _4(t,{sourceEvent:e,subject:r,target:n,identifier:i,active:o,x:u,y:a,dx:p,dy:g,dispatch:v}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:p,enumerable:!0,configurable:!0},dy:{value:g,enumerable:!0,configurable:!0},_:{value:v}})}_4.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function hRe(t){return!t.ctrlKey&&!t.button}function fRe(){return this.parentNode}function pRe(t,e){return e??{x:t.x,y:t.y}}function mRe(){return navigator.maxTouchPoints||"ontouchstart"in this}function eX(){var t=hRe,e=fRe,r=pRe,n=mRe,i={},o=Tb("start","drag","end"),u=0,a,p,g,v,w=0;function T(G){G.on("mousedown.drag",A).filter(n).on("touchstart.drag",D).on("touchmove.drag",L,dRe).on("touchend.drag touchcancel.drag",O).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function A(G,B){if(!(v||!t.call(this,G,B))){var J=$(this,e.call(this,G,B),G,B,"mouse");J&&(ni(G.view).on("mousemove.drag",I,U_).on("mouseup.drag",P,U_),JZ(G.view),JA(G),g=!1,a=G.clientX,p=G.clientY,J("start",G))}}function I(G){if(Og(G),!g){var B=G.clientX-a,J=G.clientY-p;g=B*B+J*J>w}i.mouse("drag",G)}function P(G){ni(G.view).on("mousemove.drag mouseup.drag",null),QZ(G.view,g),Og(G),i.mouse("end",G)}function D(G,B){if(t.call(this,G,B)){var J=G.changedTouches,W=e.call(this,G,B),H=J.length,V,se;for(V=0;V<H;++V)(se=$(this,W,G,B,J[V].identifier,J[V]))&&(JA(G),se("start",G,J[V]))}}function L(G){var B=G.changedTouches,J=B.length,W,H;for(W=0;W<J;++W)(H=i[B[W].identifier])&&(Og(G),H("drag",G,B[W]))}function O(G){var B=G.changedTouches,J=B.length,W,H;for(v&&clearTimeout(v),v=setTimeout(function(){v=null},500),W=0;W<J;++W)(H=i[B[W].identifier])&&(JA(G),H("end",G,B[W]))}function $(G,B,J,W,H,V){var se=o.copy(),K=Uu(V||J,B),ce,ne,re;if((re=r.call(G,new _4("beforestart",{sourceEvent:J,target:T,identifier:H,active:u,x:K[0],y:K[1],dx:0,dy:0,dispatch:se}),W))!=null)return ce=re.x-K[0]||0,ne=re.y-K[1]||0,function oe(ae,xe,ye){var Se=K,be;switch(ae){case"start":i[H]=oe,be=u++;break;case"end":delete i[H],--u;case"drag":K=Uu(ye||xe,B),be=u;break}se.call(ae,G,new _4(ae,{sourceEvent:xe,subject:re,target:T,identifier:H,active:be,x:K[0]+ce,y:K[1]+ne,dx:K[0]-Se[0],dy:K[1]-Se[1],dispatch:se}),W)}}return T.filter=function(G){return arguments.length?(t=typeof G=="function"?G:Nw(!!G),T):t},T.container=function(G){return arguments.length?(e=typeof G=="function"?G:Nw(G),T):e},T.subject=function(G){return arguments.length?(r=typeof G=="function"?G:Nw(G),T):r},T.touchable=function(G){return arguments.length?(n=typeof G=="function"?G:Nw(!!G),T):n},T.on=function(){var G=o.on.apply(o,arguments);return G===o?T:G},T.clickDistance=function(G){return arguments.length?(w=(G=+G)*G,T):Math.sqrt(w)},T}var M0=0,Yx=0,Rx=0,tX=1e3,lT,Jx,cT=0,Bp=0,nE=0,q_=typeof performance=="object"&&performance.now?performance:Date,rX=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function i5(){return Bp||(rX(gRe),Bp=q_.now()+nE)}function gRe(){Bp=0}function uT(){this._call=this._time=this._next=null}uT.prototype=a5.prototype={constructor:uT,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?i5():+r)+(e==null?0:+e),!this._next&&Jx!==this&&(Jx?Jx._next=this:lT=this,Jx=this),this._call=t,this._time=r,b4()},stop:function(){this._call&&(this._call=null,this._time=1/0,b4())}};function a5(t,e,r){var n=new uT;return n.restart(t,e,r),n}function yRe(){i5(),++M0;for(var t=lT,e;t;)(e=Bp-t._time)>=0&&t._call.call(void 0,e),t=t._next;--M0}function AB(){Bp=(cT=q_.now())+nE,M0=Yx=0;try{yRe()}finally{M0=0,vRe(),Bp=0}}function xRe(){var t=q_.now(),e=t-cT;e>tX&&(nE-=e,cT=t)}function vRe(){for(var t,e=lT,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:lT=r);Jx=t,b4(n)}function b4(t){if(!M0){Yx&&(Yx=clearTimeout(Yx));var e=t-Bp;e>24?(t<1/0&&(Yx=setTimeout(AB,t-q_.now()-nE)),Rx&&(Rx=clearInterval(Rx))):(Rx||(cT=q_.now(),Rx=setInterval(xRe,tX)),M0=1,rX(AB))}}function NB(t,e,r){var n=new uT;return e=e==null?0:+e,n.restart(i=>{n.stop(),t(i+e)},e,r),n}var _Re=Tb("start","end","cancel","interrupt"),bRe=[],nX=0,CB=1,w4=2,o2=3,PB=4,k4=5,l2=6;function iE(t,e,r,n,i,o){var u=t.__transition;if(!u)t.__transition={};else if(r in u)return;wRe(t,r,{name:e,index:n,group:i,on:_Re,tween:bRe,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:nX})}function s5(t,e){var r=pc(t,e);if(r.state>nX)throw new Error("too late; already scheduled");return r}function pu(t,e){var r=pc(t,e);if(r.state>o2)throw new Error("too late; already running");return r}function pc(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function wRe(t,e,r){var n=t.__transition,i;n[e]=r,r.timer=a5(o,0,r.time);function o(g){r.state=CB,r.timer.restart(u,r.delay,r.time),r.delay<=g&&u(g-r.delay)}function u(g){var v,w,T,A;if(r.state!==CB)return p();for(v in n)if(A=n[v],A.name===r.name){if(A.state===o2)return NB(u);A.state===PB?(A.state=l2,A.timer.stop(),A.on.call("interrupt",t,t.__data__,A.index,A.group),delete n[v]):+v<e&&(A.state=l2,A.timer.stop(),A.on.call("cancel",t,t.__data__,A.index,A.group),delete n[v])}if(NB(function(){r.state===o2&&(r.state=PB,r.timer.restart(a,r.delay,r.time),a(g))}),r.state=w4,r.on.call("start",t,t.__data__,r.index,r.group),r.state===w4){for(r.state=o2,i=new Array(T=r.tween.length),v=0,w=-1;v<T;++v)(A=r.tween[v].value.call(t,t.__data__,r.index,r.group))&&(i[++w]=A);i.length=w+1}}function a(g){for(var v=g<r.duration?r.ease.call(null,g/r.duration):(r.timer.restart(p),r.state=k4,1),w=-1,T=i.length;++w<T;)i[w].call(t,v);r.state===k4&&(r.on.call("end",t,t.__data__,r.index,r.group),p())}function p(){r.state=l2,r.timer.stop(),delete n[e];for(var g in n)return;delete t.__transition}}function c2(t,e){var r=t.__transition,n,i,o=!0,u;if(r){e=e==null?null:e+"";for(u in r){if((n=r[u]).name!==e){o=!1;continue}i=n.state>w4&&n.state<k4,n.state=l2,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[u]}o&&delete t.__transition}}function kRe(t){return this.each(function(){c2(this,t)})}function TRe(t,e){var r,n;return function(){var i=pu(this,t),o=i.tween;if(o!==r){n=r=o;for(var u=0,a=n.length;u<a;++u)if(n[u].name===e){n=n.slice(),n.splice(u,1);break}}i.tween=n}}function SRe(t,e,r){var n,i;if(typeof r!="function")throw new Error;return function(){var o=pu(this,t),u=o.tween;if(u!==n){i=(n=u).slice();for(var a={name:e,value:r},p=0,g=i.length;p<g;++p)if(i[p].name===e){i[p]=a;break}p===g&&i.push(a)}o.tween=i}}function ERe(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=pc(this.node(),r).tween,i=0,o=n.length,u;i<o;++i)if((u=n[i]).name===t)return u.value;return null}return this.each((e==null?TRe:SRe)(r,t,e))}function o5(t,e,r){var n=t._id;return t.each(function(){var i=pu(this,n);(i.value||(i.value={}))[e]=r.apply(this,arguments)}),function(i){return pc(i,n).value[e]}}function iX(t,e){var r;return(typeof e=="number"?ec:e instanceof ld?ik:(r=ld(e))?(e=r,ik):gG)(t,e)}function jRe(t){return function(){this.removeAttribute(t)}}function ARe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function NRe(t,e,r){var n,i=r+"",o;return function(){var u=this.getAttribute(t);return u===i?null:u===n?o:o=e(n=u,r)}}function CRe(t,e,r){var n,i=r+"",o;return function(){var u=this.getAttributeNS(t.space,t.local);return u===i?null:u===n?o:o=e(n=u,r)}}function PRe(t,e,r){var n,i,o;return function(){var u,a=r(this),p;return a==null?void this.removeAttribute(t):(u=this.getAttribute(t),p=a+"",u===p?null:u===n&&p===i?o:(i=p,o=e(n=u,a)))}}function IRe(t,e,r){var n,i,o;return function(){var u,a=r(this),p;return a==null?void this.removeAttributeNS(t.space,t.local):(u=this.getAttributeNS(t.space,t.local),p=a+"",u===p?null:u===n&&p===i?o:(i=p,o=e(n=u,a)))}}function MRe(t,e){var r=rE(t),n=r==="transform"?w_e:iX;return this.attrTween(t,typeof e=="function"?(r.local?IRe:PRe)(r,n,o5(this,"attr."+t,e)):e==null?(r.local?ARe:jRe)(r):(r.local?CRe:NRe)(r,n,e))}function DRe(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function ORe(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function RRe(t,e){var r,n;function i(){var o=e.apply(this,arguments);return o!==n&&(r=(n=o)&&ORe(t,o)),r}return i._value=e,i}function LRe(t,e){var r,n;function i(){var o=e.apply(this,arguments);return o!==n&&(r=(n=o)&&DRe(t,o)),r}return i._value=e,i}function zRe(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=rE(t);return this.tween(r,(n.local?RRe:LRe)(n,e))}function $Re(t,e){return function(){s5(this,t).delay=+e.apply(this,arguments)}}function FRe(t,e){return e=+e,function(){s5(this,t).delay=e}}function BRe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?$Re:FRe)(e,t)):pc(this.node(),e).delay}function VRe(t,e){return function(){pu(this,t).duration=+e.apply(this,arguments)}}function URe(t,e){return e=+e,function(){pu(this,t).duration=e}}function qRe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?VRe:URe)(e,t)):pc(this.node(),e).duration}function GRe(t,e){if(typeof e!="function")throw new Error;return function(){pu(this,t).ease=e}}function WRe(t){var e=this._id;return arguments.length?this.each(GRe(e,t)):pc(this.node(),e).ease}function HRe(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;pu(this,t).ease=r}}function KRe(t){if(typeof t!="function")throw new Error;return this.each(HRe(this._id,t))}function ZRe(t){typeof t!="function"&&(t=VZ(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var o=e[i],u=o.length,a=n[i]=[],p,g=0;g<u;++g)(p=o[g])&&t.call(p,p.__data__,g,o)&&a.push(p);return new yd(n,this._parents,this._name,this._id)}function XRe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,o=Math.min(n,i),u=new Array(n),a=0;a<o;++a)for(var p=e[a],g=r[a],v=p.length,w=u[a]=new Array(v),T,A=0;A<v;++A)(T=p[A]||g[A])&&(w[A]=T);for(;a<n;++a)u[a]=e[a];return new yd(u,this._parents,this._name,this._id)}function YRe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function JRe(t,e,r){var n,i,o=YRe(e)?s5:pu;return function(){var u=o(this,t),a=u.on;a!==n&&(i=(n=a).copy()).on(e,r),u.on=i}}function QRe(t,e){var r=this._id;return arguments.length<2?pc(this.node(),r).on.on(t):this.each(JRe(r,t,e))}function e6e(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function t6e(){return this.on("end.remove",e6e(this._id))}function r6e(t){var e=this._name,r=this._id;typeof t!="function"&&(t=r5(t));for(var n=this._groups,i=n.length,o=new Array(i),u=0;u<i;++u)for(var a=n[u],p=a.length,g=o[u]=new Array(p),v,w,T=0;T<p;++T)(v=a[T])&&(w=t.call(v,v.__data__,T,a))&&("__data__"in v&&(w.__data__=v.__data__),g[T]=w,iE(g[T],e,r,T,g,pc(v,r)));return new yd(o,this._parents,e,r)}function n6e(t){var e=this._name,r=this._id;typeof t!="function"&&(t=BZ(t));for(var n=this._groups,i=n.length,o=[],u=[],a=0;a<i;++a)for(var p=n[a],g=p.length,v,w=0;w<g;++w)if(v=p[w]){for(var T=t.call(v,v.__data__,w,p),A,I=pc(v,r),P=0,D=T.length;P<D;++P)(A=T[P])&&iE(A,e,r,P,T,I);o.push(T),u.push(v)}return new yd(o,u,e,r)}var i6e=Sb.prototype.constructor;function a6e(){return new i6e(this._groups,this._parents)}function s6e(t,e){var r,n,i;return function(){var o=I0(this,t),u=(this.style.removeProperty(t),I0(this,t));return o===u?null:o===r&&u===n?i:i=e(r=o,n=u)}}function aX(t){return function(){this.style.removeProperty(t)}}function o6e(t,e,r){var n,i=r+"",o;return function(){var u=I0(this,t);return u===i?null:u===n?o:o=e(n=u,r)}}function l6e(t,e,r){var n,i,o;return function(){var u=I0(this,t),a=r(this),p=a+"";return a==null&&(p=a=(this.style.removeProperty(t),I0(this,t))),u===p?null:u===n&&p===i?o:(i=p,o=e(n=u,a))}}function c6e(t,e){var r,n,i,o="style."+e,u="end."+o,a;return function(){var p=pu(this,t),g=p.on,v=p.value[o]==null?a||(a=aX(e)):void 0;(g!==r||i!==v)&&(n=(r=g).copy()).on(u,i=v),p.on=n}}function u6e(t,e,r){var n=(t+="")=="transform"?b_e:iX;return e==null?this.styleTween(t,s6e(t,n)).on("end.style."+t,aX(t)):typeof e=="function"?this.styleTween(t,l6e(t,n,o5(this,"style."+t,e))).each(c6e(this._id,t)):this.styleTween(t,o6e(t,n,e),r).on("end.style."+t,null)}function d6e(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function h6e(t,e,r){var n,i;function o(){var u=e.apply(this,arguments);return u!==i&&(n=(i=u)&&d6e(t,u,r)),n}return o._value=e,o}function f6e(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,h6e(t,e,r??""))}function p6e(t){return function(){this.textContent=t}}function m6e(t){return function(){var e=t(this);this.textContent=e??""}}function g6e(t){return this.tween("text",typeof t=="function"?m6e(o5(this,"text",t)):p6e(t==null?"":t+""))}function y6e(t){return function(e){this.textContent=t.call(this,e)}}function x6e(t){var e,r;function n(){var i=t.apply(this,arguments);return i!==r&&(e=(r=i)&&y6e(i)),e}return n._value=t,n}function v6e(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,x6e(t))}function _6e(){for(var t=this._name,e=this._id,r=sX(),n=this._groups,i=n.length,o=0;o<i;++o)for(var u=n[o],a=u.length,p,g=0;g<a;++g)if(p=u[g]){var v=pc(p,e);iE(p,t,r,g,u,{time:v.time+v.delay+v.duration,delay:0,duration:v.duration,ease:v.ease})}return new yd(n,this._parents,t,r)}function b6e(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(o,u){var a={value:u},p={value:function(){--i===0&&o()}};r.each(function(){var g=pu(this,n),v=g.on;v!==t&&(e=(t=v).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(p)),g.on=e}),i===0&&o()})}var w6e=0;function yd(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function sX(){return++w6e}var Fu=Sb.prototype;yd.prototype={constructor:yd,select:r6e,selectAll:n6e,selectChild:Fu.selectChild,selectChildren:Fu.selectChildren,filter:ZRe,merge:XRe,selection:a6e,transition:_6e,call:Fu.call,nodes:Fu.nodes,node:Fu.node,size:Fu.size,empty:Fu.empty,each:Fu.each,on:QRe,attr:MRe,attrTween:zRe,style:u6e,styleTween:f6e,text:g6e,textTween:v6e,remove:t6e,tween:ERe,delay:BRe,duration:qRe,ease:WRe,easeVarying:KRe,end:b6e,[Symbol.iterator]:Fu[Symbol.iterator]};function k6e(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var T6e={time:null,delay:0,duration:250,ease:k6e};function S6e(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function E6e(t){var e,r;t instanceof yd?(e=t._id,t=t._name):(e=sX(),(r=T6e).time=i5(),t=t==null?null:t+"");for(var n=this._groups,i=n.length,o=0;o<i;++o)for(var u=n[o],a=u.length,p,g=0;g<a;++g)(p=u[g])&&iE(p,t,e,g,u,r||S6e(p,e));return new yd(n,this._parents,t,e)}Sb.prototype.interrupt=kRe;Sb.prototype.transition=E6e;function oX(t,e){var r,n=1;t==null&&(t=0),e==null&&(e=0);function i(){var o,u=r.length,a,p=0,g=0;for(o=0;o<u;++o)a=r[o],p+=a.x,g+=a.y;for(p=(p/u-t)*n,g=(g/u-e)*n,o=0;o<u;++o)a=r[o],a.x-=p,a.y-=g}return i.initialize=function(o){r=o},i.x=function(o){return arguments.length?(t=+o,i):t},i.y=function(o){return arguments.length?(e=+o,i):e},i.strength=function(o){return arguments.length?(n=+o,i):n},i}function j6e(t){const e=+this._x.call(null,t),r=+this._y.call(null,t);return lX(this.cover(e,r),e,r,t)}function lX(t,e,r,n){if(isNaN(e)||isNaN(r))return t;var i,o=t._root,u={data:n},a=t._x0,p=t._y0,g=t._x1,v=t._y1,w,T,A,I,P,D,L,O;if(!o)return t._root=u,t;for(;o.length;)if((P=e>=(w=(a+g)/2))?a=w:g=w,(D=r>=(T=(p+v)/2))?p=T:v=T,i=o,!(o=o[L=D<<1|P]))return i[L]=u,t;if(A=+t._x.call(null,o.data),I=+t._y.call(null,o.data),e===A&&r===I)return u.next=o,i?i[L]=u:t._root=u,t;do i=i?i[L]=new Array(4):t._root=new Array(4),(P=e>=(w=(a+g)/2))?a=w:g=w,(D=r>=(T=(p+v)/2))?p=T:v=T;while((L=D<<1|P)===(O=(I>=T)<<1|A>=w));return i[O]=o,i[L]=u,t}function A6e(t){var e,r,n=t.length,i,o,u=new Array(n),a=new Array(n),p=1/0,g=1/0,v=-1/0,w=-1/0;for(r=0;r<n;++r)isNaN(i=+this._x.call(null,e=t[r]))||isNaN(o=+this._y.call(null,e))||(u[r]=i,a[r]=o,i<p&&(p=i),i>v&&(v=i),o<g&&(g=o),o>w&&(w=o));if(p>v||g>w)return this;for(this.cover(p,g).cover(v,w),r=0;r<n;++r)lX(this,u[r],a[r],t[r]);return this}function N6e(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var r=this._x0,n=this._y0,i=this._x1,o=this._y1;if(isNaN(r))i=(r=Math.floor(t))+1,o=(n=Math.floor(e))+1;else{for(var u=i-r||1,a=this._root,p,g;r>t||t>=i||n>e||e>=o;)switch(g=(e<n)<<1|t<r,p=new Array(4),p[g]=a,a=p,u*=2,g){case 0:i=r+u,o=n+u;break;case 1:r=i-u,o=n+u;break;case 2:i=r+u,n=o-u;break;case 3:r=i-u,n=o-u;break}this._root&&this._root.length&&(this._root=a)}return this._x0=r,this._y0=n,this._x1=i,this._y1=o,this}function C6e(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function P6e(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Ss(t,e,r,n,i){this.node=t,this.x0=e,this.y0=r,this.x1=n,this.y1=i}function I6e(t,e,r){var n,i=this._x0,o=this._y0,u,a,p,g,v=this._x1,w=this._y1,T=[],A=this._root,I,P;for(A&&T.push(new Ss(A,i,o,v,w)),r==null?r=1/0:(i=t-r,o=e-r,v=t+r,w=e+r,r*=r);I=T.pop();)if(!(!(A=I.node)||(u=I.x0)>v||(a=I.y0)>w||(p=I.x1)<i||(g=I.y1)<o))if(A.length){var D=(u+p)/2,L=(a+g)/2;T.push(new Ss(A[3],D,L,p,g),new Ss(A[2],u,L,D,g),new Ss(A[1],D,a,p,L),new Ss(A[0],u,a,D,L)),(P=(e>=L)<<1|t>=D)&&(I=T[T.length-1],T[T.length-1]=T[T.length-1-P],T[T.length-1-P]=I)}else{var O=t-+this._x.call(null,A.data),$=e-+this._y.call(null,A.data),G=O*O+$*$;if(G<r){var B=Math.sqrt(r=G);i=t-B,o=e-B,v=t+B,w=e+B,n=A.data}}return n}function M6e(t){if(isNaN(v=+this._x.call(null,t))||isNaN(w=+this._y.call(null,t)))return this;var e,r=this._root,n,i,o,u=this._x0,a=this._y0,p=this._x1,g=this._y1,v,w,T,A,I,P,D,L;if(!r)return this;if(r.length)for(;;){if((I=v>=(T=(u+p)/2))?u=T:p=T,(P=w>=(A=(a+g)/2))?a=A:g=A,e=r,!(r=r[D=P<<1|I]))return this;if(!r.length)break;(e[D+1&3]||e[D+2&3]||e[D+3&3])&&(n=e,L=D)}for(;r.data!==t;)if(i=r,!(r=r.next))return this;return(o=r.next)&&delete r.next,i?(o?i.next=o:delete i.next,this):e?(o?e[D]=o:delete e[D],(r=e[0]||e[1]||e[2]||e[3])&&r===(e[3]||e[2]||e[1]||e[0])&&!r.length&&(n?n[L]=r:this._root=r),this):(this._root=o,this)}function D6e(t){for(var e=0,r=t.length;e<r;++e)this.remove(t[e]);return this}function O6e(){return this._root}function R6e(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function L6e(t){var e=[],r,n=this._root,i,o,u,a,p;for(n&&e.push(new Ss(n,this._x0,this._y0,this._x1,this._y1));r=e.pop();)if(!t(n=r.node,o=r.x0,u=r.y0,a=r.x1,p=r.y1)&&n.length){var g=(o+a)/2,v=(u+p)/2;(i=n[3])&&e.push(new Ss(i,g,v,a,p)),(i=n[2])&&e.push(new Ss(i,o,v,g,p)),(i=n[1])&&e.push(new Ss(i,g,u,a,v)),(i=n[0])&&e.push(new Ss(i,o,u,g,v))}return this}function z6e(t){var e=[],r=[],n;for(this._root&&e.push(new Ss(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var o,u=n.x0,a=n.y0,p=n.x1,g=n.y1,v=(u+p)/2,w=(a+g)/2;(o=i[0])&&e.push(new Ss(o,u,a,v,w)),(o=i[1])&&e.push(new Ss(o,v,a,p,w)),(o=i[2])&&e.push(new Ss(o,u,w,v,g)),(o=i[3])&&e.push(new Ss(o,v,w,p,g))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this}function $6e(t){return t[0]}function F6e(t){return arguments.length?(this._x=t,this):this._x}function B6e(t){return t[1]}function V6e(t){return arguments.length?(this._y=t,this):this._y}function l5(t,e,r){var n=new c5(e??$6e,r??B6e,NaN,NaN,NaN,NaN);return t==null?n:n.addAll(t)}function c5(t,e,r,n,i,o){this._x=t,this._y=e,this._x0=r,this._y0=n,this._x1=i,this._y1=o,this._root=void 0}function IB(t){for(var e={data:t.data},r=e;t=t.next;)r=r.next={data:t.data};return e}var Ds=l5.prototype=c5.prototype;Ds.copy=function(){var t=new c5(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,r,n;if(!e)return t;if(!e.length)return t._root=IB(e),t;for(r=[{source:e,target:t._root=new Array(4)}];e=r.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?r.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=IB(n));return t};Ds.add=j6e;Ds.addAll=A6e;Ds.cover=N6e;Ds.data=C6e;Ds.extent=P6e;Ds.find=I6e;Ds.remove=M6e;Ds.removeAll=D6e;Ds.root=O6e;Ds.size=R6e;Ds.visit=L6e;Ds.visitAfter=z6e;Ds.x=F6e;Ds.y=V6e;function ma(t){return function(){return t}}function Th(t){return(t()-.5)*1e-6}function U6e(t){return t.x+t.vx}function q6e(t){return t.y+t.vy}function Qx(t){var e,r,n,i=1,o=1;typeof t!="function"&&(t=ma(t==null?1:+t));function u(){for(var g,v=e.length,w,T,A,I,P,D,L=0;L<o;++L)for(w=l5(e,U6e,q6e).visitAfter(a),g=0;g<v;++g)T=e[g],P=r[T.index],D=P*P,A=T.x+T.vx,I=T.y+T.vy,w.visit(O);function O($,G,B,J,W){var H=$.data,V=$.r,se=P+V;if(H){if(H.index>T.index){var K=A-H.x-H.vx,ce=I-H.y-H.vy,ne=K*K+ce*ce;ne<se*se&&(K===0&&(K=Th(n),ne+=K*K),ce===0&&(ce=Th(n),ne+=ce*ce),ne=(se-(ne=Math.sqrt(ne)))/ne*i,T.vx+=(K*=ne)*(se=(V*=V)/(D+V)),T.vy+=(ce*=ne)*se,H.vx-=K*(se=1-se),H.vy-=ce*se)}return}return G>A+se||J<A-se||B>I+se||W<I-se}}function a(g){if(g.data)return g.r=r[g.data.index];for(var v=g.r=0;v<4;++v)g[v]&&g[v].r>g.r&&(g.r=g[v].r)}function p(){if(e){var g,v=e.length,w;for(r=new Array(v),g=0;g<v;++g)w=e[g],r[w.index]=+t(w,g,e)}}return u.initialize=function(g,v){e=g,n=v,p()},u.iterations=function(g){return arguments.length?(o=+g,u):o},u.strength=function(g){return arguments.length?(i=+g,u):i},u.radius=function(g){return arguments.length?(t=typeof g=="function"?g:ma(+g),p(),u):t},u}function G6e(t){return t.index}function MB(t,e){var r=t.get(e);if(!r)throw new Error("node not found: "+e);return r}function ev(t){var e=G6e,r=w,n,i=ma(30),o,u,a,p,g,v=1;t==null&&(t=[]);function w(D){return 1/Math.min(a[D.source.index],a[D.target.index])}function T(D){for(var L=0,O=t.length;L<v;++L)for(var $=0,G,B,J,W,H,V,se;$<O;++$)G=t[$],B=G.source,J=G.target,W=J.x+J.vx-B.x-B.vx||Th(g),H=J.y+J.vy-B.y-B.vy||Th(g),V=Math.sqrt(W*W+H*H),V=(V-o[$])/V*D*n[$],W*=V,H*=V,J.vx-=W*(se=p[$]),J.vy-=H*se,B.vx+=W*(se=1-se),B.vy+=H*se}function A(){if(u){var D,L=u.length,O=t.length,$=new Map(u.map((B,J)=>[e(B,J,u),B])),G;for(D=0,a=new Array(L);D<O;++D)G=t[D],G.index=D,typeof G.source!="object"&&(G.source=MB($,G.source)),typeof G.target!="object"&&(G.target=MB($,G.target)),a[G.source.index]=(a[G.source.index]||0)+1,a[G.target.index]=(a[G.target.index]||0)+1;for(D=0,p=new Array(O);D<O;++D)G=t[D],p[D]=a[G.source.index]/(a[G.source.index]+a[G.target.index]);n=new Array(O),I(),o=new Array(O),P()}}function I(){if(u)for(var D=0,L=t.length;D<L;++D)n[D]=+r(t[D],D,t)}function P(){if(u)for(var D=0,L=t.length;D<L;++D)o[D]=+i(t[D],D,t)}return T.initialize=function(D,L){u=D,g=L,A()},T.links=function(D){return arguments.length?(t=D,A(),T):t},T.id=function(D){return arguments.length?(e=D,T):e},T.iterations=function(D){return arguments.length?(v=+D,T):v},T.strength=function(D){return arguments.length?(r=typeof D=="function"?D:ma(+D),I(),T):r},T.distance=function(D){return arguments.length?(i=typeof D=="function"?D:ma(+D),P(),T):i},T}const W6e=1664525,H6e=1013904223,DB=4294967296;function K6e(){let t=1;return()=>(t=(W6e*t+H6e)%DB)/DB}function Z6e(t){return t.x}function X6e(t){return t.y}var Y6e=10,J6e=Math.PI*(3-Math.sqrt(5));function tv(t){var e,r=1,n=.001,i=1-Math.pow(n,1/300),o=0,u=.6,a=new Map,p=a5(w),g=Tb("tick","end"),v=K6e();t==null&&(t=[]);function w(){T(),g.call("tick",e),r<n&&(p.stop(),g.call("end",e))}function T(P){var D,L=t.length,O;P===void 0&&(P=1);for(var $=0;$<P;++$)for(r+=(o-r)*i,a.forEach(function(G){G(r)}),D=0;D<L;++D)O=t[D],O.fx==null?O.x+=O.vx*=u:(O.x=O.fx,O.vx=0),O.fy==null?O.y+=O.vy*=u:(O.y=O.fy,O.vy=0);return e}function A(){for(var P=0,D=t.length,L;P<D;++P){if(L=t[P],L.index=P,L.fx!=null&&(L.x=L.fx),L.fy!=null&&(L.y=L.fy),isNaN(L.x)||isNaN(L.y)){var O=Y6e*Math.sqrt(.5+P),$=P*J6e;L.x=O*Math.cos($),L.y=O*Math.sin($)}(isNaN(L.vx)||isNaN(L.vy))&&(L.vx=L.vy=0)}}function I(P){return P.initialize&&P.initialize(t,v),P}return A(),e={tick:T,restart:function(){return p.restart(w),e},stop:function(){return p.stop(),e},nodes:function(P){return arguments.length?(t=P,A(),a.forEach(I),e):t},alpha:function(P){return arguments.length?(r=+P,e):r},alphaMin:function(P){return arguments.length?(n=+P,e):n},alphaDecay:function(P){return arguments.length?(i=+P,e):+i},alphaTarget:function(P){return arguments.length?(o=+P,e):o},velocityDecay:function(P){return arguments.length?(u=1-P,e):1-u},randomSource:function(P){return arguments.length?(v=P,a.forEach(I),e):v},force:function(P,D){return arguments.length>1?(D==null?a.delete(P):a.set(P,I(D)),e):a.get(P)},find:function(P,D,L){var O=0,$=t.length,G,B,J,W,H;for(L==null?L=1/0:L*=L,O=0;O<$;++O)W=t[O],G=P-W.x,B=D-W.y,J=G*G+B*B,J<L&&(H=W,L=J);return H},on:function(P,D){return arguments.length>1?(g.on(P,D),e):g.on(P)}}}function rv(){var t,e,r,n,i=ma(-30),o,u=1,a=1/0,p=.81;function g(A){var I,P=t.length,D=l5(t,Z6e,X6e).visitAfter(w);for(n=A,I=0;I<P;++I)e=t[I],D.visit(T)}function v(){if(t){var A,I=t.length,P;for(o=new Array(I),A=0;A<I;++A)P=t[A],o[P.index]=+i(P,A,t)}}function w(A){var I=0,P,D,L=0,O,$,G;if(A.length){for(O=$=G=0;G<4;++G)(P=A[G])&&(D=Math.abs(P.value))&&(I+=P.value,L+=D,O+=D*P.x,$+=D*P.y);A.x=O/L,A.y=$/L}else{P=A,P.x=P.data.x,P.y=P.data.y;do I+=o[P.data.index];while(P=P.next)}A.value=I}function T(A,I,P,D){if(!A.value)return!0;var L=A.x-e.x,O=A.y-e.y,$=D-I,G=L*L+O*O;if($*$/p<G)return G<a&&(L===0&&(L=Th(r),G+=L*L),O===0&&(O=Th(r),G+=O*O),G<u&&(G=Math.sqrt(u*G)),e.vx+=L*A.value*n/G,e.vy+=O*A.value*n/G),!0;if(A.length||G>=a)return;(A.data!==e||A.next)&&(L===0&&(L=Th(r),G+=L*L),O===0&&(O=Th(r),G+=O*O),G<u&&(G=Math.sqrt(u*G)));do A.data!==e&&($=o[A.data.index]*n/G,e.vx+=L*$,e.vy+=O*$);while(A=A.next)}return g.initialize=function(A,I){t=A,r=I,v()},g.strength=function(A){return arguments.length?(i=typeof A=="function"?A:ma(+A),v(),g):i},g.distanceMin=function(A){return arguments.length?(u=A*A,g):Math.sqrt(u)},g.distanceMax=function(A){return arguments.length?(a=A*A,g):Math.sqrt(a)},g.theta=function(A){return arguments.length?(p=A*A,g):Math.sqrt(p)},g}function Q6e(t,e,r){var n,i=ma(.1),o,u;typeof t!="function"&&(t=ma(+t)),e==null&&(e=0),r==null&&(r=0);function a(g){for(var v=0,w=n.length;v<w;++v){var T=n[v],A=T.x-e||1e-6,I=T.y-r||1e-6,P=Math.sqrt(A*A+I*I),D=(u[v]-P)*o[v]*g/P;T.vx+=A*D,T.vy+=I*D}}function p(){if(n){var g,v=n.length;for(o=new Array(v),u=new Array(v),g=0;g<v;++g)u[g]=+t(n[g],g,n),o[g]=isNaN(u[g])?0:+i(n[g],g,n)}}return a.initialize=function(g){n=g,p()},a.strength=function(g){return arguments.length?(i=typeof g=="function"?g:ma(+g),p(),a):i},a.radius=function(g){return arguments.length?(t=typeof g=="function"?g:ma(+g),p(),a):t},a.x=function(g){return arguments.length?(e=+g,a):e},a.y=function(g){return arguments.length?(r=+g,a):r},a}function OB(t){var e=ma(.1),r,n,i;typeof t!="function"&&(t=ma(t==null?0:+t));function o(a){for(var p=0,g=r.length,v;p<g;++p)v=r[p],v.vx+=(i[p]-v.x)*n[p]*a}function u(){if(r){var a,p=r.length;for(n=new Array(p),i=new Array(p),a=0;a<p;++a)n[a]=isNaN(i[a]=+t(r[a],a,r))?0:+e(r[a],a,r)}}return o.initialize=function(a){r=a,u()},o.strength=function(a){return arguments.length?(e=typeof a=="function"?a:ma(+a),u(),o):e},o.x=function(a){return arguments.length?(t=typeof a=="function"?a:ma(+a),u(),o):t},o}function RB(t){var e=ma(.1),r,n,i;typeof t!="function"&&(t=ma(t==null?0:+t));function o(a){for(var p=0,g=r.length,v;p<g;++p)v=r[p],v.vy+=(i[p]-v.y)*n[p]*a}function u(){if(r){var a,p=r.length;for(n=new Array(p),i=new Array(p),a=0;a<p;++a)n[a]=isNaN(i[a]=+t(r[a],a,r))?0:+e(r[a],a,r)}}return o.initialize=function(a){r=a,u()},o.strength=function(a){return arguments.length?(e=typeof a=="function"?a:ma(+a),u(),o):e},o.y=function(a){return arguments.length?(t=typeof a=="function"?a:ma(+a),u(),o):t},o}function aE(t){for(var e=t.length/6|0,r=new Array(e),n=0;n<e;)r[n]="#"+t.slice(n*6,++n*6);return r}function sE(t){var e=t.length;return function(r){return t[Math.max(0,Math.min(e-1,Math.floor(r*e)))]}}const eLe=sE(aE("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));sE(aE("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));sE(aE("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));sE(aE("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));const Cw=t=>()=>t;function tLe(t,{sourceEvent:e,target:r,transform:n,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:i}})}function Xu(t,e,r){this.k=t,this.x=e,this.y=r}Xu.prototype={constructor:Xu,scale:function(t){return t===1?this:new Xu(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Xu(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var oE=new Xu(1,0,0);Xu.prototype;function QA(t){t.stopImmediatePropagation()}function Lx(t){t.preventDefault(),t.stopImmediatePropagation()}function rLe(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function nLe(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function LB(){return this.__zoom||oE}function iLe(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function aLe(){return navigator.maxTouchPoints||"ontouchstart"in this}function sLe(t,e,r){var n=t.invertX(e[0][0])-r[0][0],i=t.invertX(e[1][0])-r[1][0],o=t.invertY(e[0][1])-r[0][1],u=t.invertY(e[1][1])-r[1][1];return t.translate(i>n?(n+i)/2:Math.min(0,n)||Math.max(0,i),u>o?(o+u)/2:Math.min(0,o)||Math.max(0,u))}function Ep(){var t=rLe,e=nLe,r=sLe,n=iLe,i=aLe,o=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],a=250,p=E_e,g=Tb("start","zoom","end"),v,w,T,A=500,I=150,P=0,D=10;function L(re){re.property("__zoom",LB).on("wheel.zoom",H,{passive:!1}).on("mousedown.zoom",V).on("dblclick.zoom",se).filter(i).on("touchstart.zoom",K).on("touchmove.zoom",ce).on("touchend.zoom touchcancel.zoom",ne).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}L.transform=function(re,oe,ae,xe){var ye=re.selection?re.selection():re;ye.property("__zoom",LB),re!==ye?B(re,oe,ae,xe):ye.interrupt().each(function(){J(this,arguments).event(xe).start().zoom(null,typeof oe=="function"?oe.apply(this,arguments):oe).end()})},L.scaleBy=function(re,oe,ae,xe){L.scaleTo(re,function(){var ye=this.__zoom.k,Se=typeof oe=="function"?oe.apply(this,arguments):oe;return ye*Se},ae,xe)},L.scaleTo=function(re,oe,ae,xe){L.transform(re,function(){var ye=e.apply(this,arguments),Se=this.__zoom,be=ae==null?G(ye):typeof ae=="function"?ae.apply(this,arguments):ae,Ce=Se.invert(be),$e=typeof oe=="function"?oe.apply(this,arguments):oe;return r($(O(Se,$e),be,Ce),ye,u)},ae,xe)},L.translateBy=function(re,oe,ae,xe){L.transform(re,function(){return r(this.__zoom.translate(typeof oe=="function"?oe.apply(this,arguments):oe,typeof ae=="function"?ae.apply(this,arguments):ae),e.apply(this,arguments),u)},null,xe)},L.translateTo=function(re,oe,ae,xe,ye){L.transform(re,function(){var Se=e.apply(this,arguments),be=this.__zoom,Ce=xe==null?G(Se):typeof xe=="function"?xe.apply(this,arguments):xe;return r(oE.translate(Ce[0],Ce[1]).scale(be.k).translate(typeof oe=="function"?-oe.apply(this,arguments):-oe,typeof ae=="function"?-ae.apply(this,arguments):-ae),Se,u)},xe,ye)};function O(re,oe){return oe=Math.max(o[0],Math.min(o[1],oe)),oe===re.k?re:new Xu(oe,re.x,re.y)}function $(re,oe,ae){var xe=oe[0]-ae[0]*re.k,ye=oe[1]-ae[1]*re.k;return xe===re.x&&ye===re.y?re:new Xu(re.k,xe,ye)}function G(re){return[(+re[0][0]+ +re[1][0])/2,(+re[0][1]+ +re[1][1])/2]}function B(re,oe,ae,xe){re.on("start.zoom",function(){J(this,arguments).event(xe).start()}).on("interrupt.zoom end.zoom",function(){J(this,arguments).event(xe).end()}).tween("zoom",function(){var ye=this,Se=arguments,be=J(ye,Se).event(xe),Ce=e.apply(ye,Se),$e=ae==null?G(Ce):typeof ae=="function"?ae.apply(ye,Se):ae,Ye=Math.max(Ce[1][0]-Ce[0][0],Ce[1][1]-Ce[0][1]),jt=ye.__zoom,Me=typeof oe=="function"?oe.apply(ye,Se):oe,St=p(jt.invert($e).concat(Ye/jt.k),Me.invert($e).concat(Ye/Me.k));return function(Ct){if(Ct===1)Ct=Me;else{var Ft=St(Ct),gt=Ye/Ft[2];Ct=new Xu(gt,$e[0]-Ft[0]*gt,$e[1]-Ft[1]*gt)}be.zoom(null,Ct)}})}function J(re,oe,ae){return!ae&&re.__zooming||new W(re,oe)}function W(re,oe){this.that=re,this.args=oe,this.active=0,this.sourceEvent=null,this.extent=e.apply(re,oe),this.taps=0}W.prototype={event:function(re){return re&&(this.sourceEvent=re),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(re,oe){return this.mouse&&re!=="mouse"&&(this.mouse[1]=oe.invert(this.mouse[0])),this.touch0&&re!=="touch"&&(this.touch0[1]=oe.invert(this.touch0[0])),this.touch1&&re!=="touch"&&(this.touch1[1]=oe.invert(this.touch1[0])),this.that.__zoom=oe,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(re){var oe=ni(this.that).datum();g.call(re,this.that,new tLe(re,{sourceEvent:this.sourceEvent,target:L,type:re,transform:this.that.__zoom,dispatch:g}),oe)}};function H(re,...oe){if(!t.apply(this,arguments))return;var ae=J(this,oe).event(re),xe=this.__zoom,ye=Math.max(o[0],Math.min(o[1],xe.k*Math.pow(2,n.apply(this,arguments)))),Se=Uu(re);if(ae.wheel)(ae.mouse[0][0]!==Se[0]||ae.mouse[0][1]!==Se[1])&&(ae.mouse[1]=xe.invert(ae.mouse[0]=Se)),clearTimeout(ae.wheel);else{if(xe.k===ye)return;ae.mouse=[Se,xe.invert(Se)],c2(this),ae.start()}Lx(re),ae.wheel=setTimeout(be,I),ae.zoom("mouse",r($(O(xe,ye),ae.mouse[0],ae.mouse[1]),ae.extent,u));function be(){ae.wheel=null,ae.end()}}function V(re,...oe){if(T||!t.apply(this,arguments))return;var ae=re.currentTarget,xe=J(this,oe,!0).event(re),ye=ni(re.view).on("mousemove.zoom",$e,!0).on("mouseup.zoom",Ye,!0),Se=Uu(re,ae),be=re.clientX,Ce=re.clientY;JZ(re.view),QA(re),xe.mouse=[Se,this.__zoom.invert(Se)],c2(this),xe.start();function $e(jt){if(Lx(jt),!xe.moved){var Me=jt.clientX-be,St=jt.clientY-Ce;xe.moved=Me*Me+St*St>P}xe.event(jt).zoom("mouse",r($(xe.that.__zoom,xe.mouse[0]=Uu(jt,ae),xe.mouse[1]),xe.extent,u))}function Ye(jt){ye.on("mousemove.zoom mouseup.zoom",null),QZ(jt.view,xe.moved),Lx(jt),xe.event(jt).end()}}function se(re,...oe){if(t.apply(this,arguments)){var ae=this.__zoom,xe=Uu(re.changedTouches?re.changedTouches[0]:re,this),ye=ae.invert(xe),Se=ae.k*(re.shiftKey?.5:2),be=r($(O(ae,Se),xe,ye),e.apply(this,oe),u);Lx(re),a>0?ni(this).transition().duration(a).call(B,be,xe,re):ni(this).call(L.transform,be,xe,re)}}function K(re,...oe){if(t.apply(this,arguments)){var ae=re.touches,xe=ae.length,ye=J(this,oe,re.changedTouches.length===xe).event(re),Se,be,Ce,$e;for(QA(re),be=0;be<xe;++be)Ce=ae[be],$e=Uu(Ce,this),$e=[$e,this.__zoom.invert($e),Ce.identifier],ye.touch0?!ye.touch1&&ye.touch0[2]!==$e[2]&&(ye.touch1=$e,ye.taps=0):(ye.touch0=$e,Se=!0,ye.taps=1+!!v);v&&(v=clearTimeout(v)),Se&&(ye.taps<2&&(w=$e[0],v=setTimeout(function(){v=null},A)),c2(this),ye.start())}}function ce(re,...oe){if(this.__zooming){var ae=J(this,oe).event(re),xe=re.changedTouches,ye=xe.length,Se,be,Ce,$e;for(Lx(re),Se=0;Se<ye;++Se)be=xe[Se],Ce=Uu(be,this),ae.touch0&&ae.touch0[2]===be.identifier?ae.touch0[0]=Ce:ae.touch1&&ae.touch1[2]===be.identifier&&(ae.touch1[0]=Ce);if(be=ae.that.__zoom,ae.touch1){var Ye=ae.touch0[0],jt=ae.touch0[1],Me=ae.touch1[0],St=ae.touch1[1],Ct=(Ct=Me[0]-Ye[0])*Ct+(Ct=Me[1]-Ye[1])*Ct,Ft=(Ft=St[0]-jt[0])*Ft+(Ft=St[1]-jt[1])*Ft;be=O(be,Math.sqrt(Ct/Ft)),Ce=[(Ye[0]+Me[0])/2,(Ye[1]+Me[1])/2],$e=[(jt[0]+St[0])/2,(jt[1]+St[1])/2]}else if(ae.touch0)Ce=ae.touch0[0],$e=ae.touch0[1];else return;ae.zoom("touch",r($(be,Ce,$e),ae.extent,u))}}function ne(re,...oe){if(this.__zooming){var ae=J(this,oe).event(re),xe=re.changedTouches,ye=xe.length,Se,be;for(QA(re),T&&clearTimeout(T),T=setTimeout(function(){T=null},A),Se=0;Se<ye;++Se)be=xe[Se],ae.touch0&&ae.touch0[2]===be.identifier?delete ae.touch0:ae.touch1&&ae.touch1[2]===be.identifier&&delete ae.touch1;if(ae.touch1&&!ae.touch0&&(ae.touch0=ae.touch1,delete ae.touch1),ae.touch0)ae.touch0[1]=this.__zoom.invert(ae.touch0[0]);else if(ae.end(),ae.taps===2&&(be=Uu(be,this),Math.hypot(w[0]-be[0],w[1]-be[1])<D)){var Ce=ni(this).on("dblclick.zoom");Ce&&Ce.apply(this,arguments)}}}return L.wheelDelta=function(re){return arguments.length?(n=typeof re=="function"?re:Cw(+re),L):n},L.filter=function(re){return arguments.length?(t=typeof re=="function"?re:Cw(!!re),L):t},L.touchable=function(re){return arguments.length?(i=typeof re=="function"?re:Cw(!!re),L):i},L.extent=function(re){return arguments.length?(e=typeof re=="function"?re:Cw([[+re[0][0],+re[0][1]],[+re[1][0],+re[1][1]]]),L):e},L.scaleExtent=function(re){return arguments.length?(o[0]=+re[0],o[1]=+re[1],L):[o[0],o[1]]},L.translateExtent=function(re){return arguments.length?(u[0][0]=+re[0][0],u[1][0]=+re[1][0],u[0][1]=+re[0][1],u[1][1]=+re[1][1],L):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},L.constrain=function(re){return arguments.length?(r=re,L):r},L.duration=function(re){return arguments.length?(a=+re,L):a},L.interpolate=function(re){return arguments.length?(p=re,L):p},L.on=function(){var re=g.on.apply(g,arguments);return re===g?L:re},L.clickDistance=function(re){return arguments.length?(P=(re=+re)*re,L):Math.sqrt(P)},L.tapDistance=function(re){return arguments.length?(D=+re,L):D},L}function oLe({nodes:t,edges:e,width:r,height:n}){var Ye,jt;const i=Y.useRef(null),o=Y.useRef(null),[u,a]=Y.useState(null),[p,g]=Y.useState(null),[v,w]=Y.useState(""),[T,A]=Y.useState("all"),[I,P]=Y.useState("force"),[D,L]=Y.useState("network"),[O,$]=Y.useState(!1),[G,B]=Y.useState(!1),[J,W]=Y.useState("all"),[H,V]=Y.useState(1),se=Y.useRef(null),K=Y.useMemo(()=>{const Me=new Map;t.forEach(Ct=>{const Ft=e.filter(Lt=>(typeof Lt.source=="string"?Lt.source:Lt.source.id)===Ct.id||(typeof Lt.target=="string"?Lt.target:Lt.target.id)===Ct.id),gt=Ft.length/t.length,Zt=Ft.length,Tt=Ct.influence,ot=e.filter(Lt=>(typeof Lt.source=="string"?Lt.source:Lt.source.id)===Ct.id),ar=e.filter(Lt=>(typeof Lt.target=="string"?Lt.target:Lt.target.id)===Ct.id),mt=ot.length>ar.length?"cause":ar.length>ot.length?"effect":"mediator";Me.set(Ct.id,{...Ct,centrality:gt,degree:Zt,influence:Tt,causalityRole:mt,outgoingConnections:ot.length,incomingConnections:ar.length,clustering:Zt>1?2/(Zt*(Zt-1)):0})});const St=e.map(Ct=>{const Ft=typeof Ct.source=="string"?Ct.source:Ct.source.id,gt=typeof Ct.target=="string"?Ct.target:Ct.target.id,Zt=Me.get(Ft),Tt=Me.get(gt);let ot="correlation",ar="present";if(Zt&&Tt){Ct.type==="collaboration"||Ct.type==="mention"?ot=Zt.influence>Tt.influence?"cause":"effect":Ct.type==="opposition"&&(ot="correlation",ar="present");const mt=Ct.timestamp?Date.now()-Ct.timestamp.getTime():0;ar=mt>30*24*60*60*1e3?"past":mt>7*24*60*60*1e3?"present":"future"}return{...Ct,causality:ot,temporal:ar,strength:Ct.weight/10,source:Ft,target:gt}});return{nodes:Array.from(Me.values()),edges:St}},[t,e]),ce=Y.useMemo(()=>{let Me=K.nodes,St=K.edges;if(v){const Ft=v.toLowerCase();Me=Me.filter(gt=>{var Zt,Tt;return gt.label.toLowerCase().includes(Ft)||gt.type.toLowerCase().includes(Ft)||((Zt=gt.metadata.description)==null?void 0:Zt.toLowerCase().includes(Ft))||((Tt=gt.causalityRole)==null?void 0:Tt.toLowerCase().includes(Ft))})}T!=="all"&&(Me=Me.filter(Ft=>Ft.type===T)),J!=="all"&&(St=St.filter(Ft=>Ft.temporal===J));const Ct=new Set(Me.map(Ft=>Ft.id));return St=St.filter(Ft=>Ct.has(Ft.source)&&Ct.has(Ft.target)),{nodes:Me,edges:St}},[K,v,T,J]),ne=Y.useMemo(()=>{const Me=new Set(t.map(St=>St.type));return Array.from(Me)},[t]),re=Y.useMemo(()=>({nodeType:{person:"#3B82F6",organization:"#10B981",location:"#F59E0B",hashtag:"#8B5CF6",topic:"#EF4444"},causality:{cause:"#DC2626",effect:"#059669",mediator:"#7C3AED",correlation:"#6B7280"},temporal:{past:"#6B7280",present:"#3B82F6",future:"#10B981"},influence:ZM(eLe).domain([0,100])}),[]),oe=Y.useMemo(()=>({relationship:{collaboration:"#10B981",opposition:"#EF4444",mention:"#3B82F6",friendship:"#8B5CF6",retweet:"#06B6D4",family:"#F97316"},causality:{cause:"#DC2626",effect:"#059669",correlation:"#6B7280"},temporal:{past:"#9CA3AF",present:"#3B82F6",future:"#10B981"}}),[]),ae=Y.useCallback(Me=>{g(Me)},[]),xe=Y.useCallback(()=>{g(null)},[]),ye=Y.useCallback(Me=>{a(St=>St===Me?null:Me)},[]),Se=Y.useCallback((Me,St)=>isNaN(Me)||!isFinite(Me)?St:Me,[]),be=Y.useCallback(()=>{if(!i.current||ce.nodes.length===0)return;const Me=ni(i.current);Me.selectAll("*").remove();const St=Me.append("defs");Object.entries(oe.causality).forEach(([ht,Jt])=>{const tr=St.append("marker").attr("id",`arrow-${ht}`).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",0).attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto");ht==="cause"?tr.append("path").attr("d","M0,-5L10,0L0,5L2,0Z").attr("fill",Jt).attr("stroke",Jt):ht==="effect"?tr.append("circle").attr("cx",5).attr("cy",0).attr("r",3).attr("fill",Jt):tr.append("path").attr("d","M0,-3L6,0L0,3L0,0Z").attr("fill",Jt).attr("opacity",.7)}),Object.entries(re.nodeType).forEach(([ht,Jt])=>{var zr,yr,In,Cr;const tr=St.append("radialGradient").attr("id",`gradient-${ht}`).attr("cx","30%").attr("cy","30%");tr.append("stop").attr("offset","0%").attr("stop-color",((yr=(zr=ld(Jt))==null?void 0:zr.brighter(1.2))==null?void 0:yr.toString())||Jt),tr.append("stop").attr("offset","70%").attr("stop-color",Jt),tr.append("stop").attr("offset","100%").attr("stop-color",((Cr=(In=ld(Jt))==null?void 0:In.darker(.5))==null?void 0:Cr.toString())||Jt)});const Ct=St.append("filter").attr("id","glow").attr("x","-50%").attr("y","-50%").attr("width","200%").attr("height","200%");Ct.append("feGaussianBlur").attr("stdDeviation","3").attr("result","coloredBlur");const Ft=Ct.append("feMerge");Ft.append("feMergeNode").attr("in","coloredBlur"),Ft.append("feMergeNode").attr("in","SourceGraphic");const gt=Me.append("g").attr("class","main-container"),Zt=Ep().scaleExtent([.1,20]).on("zoom",ht=>{gt.attr("transform",ht.transform),V(ht.transform.k)});Me.call(Zt);const Tt=ce.nodes.map(ht=>({...ht,x:r/2+(Math.random()-.5)*100,y:n/2+(Math.random()-.5)*100,vx:0,vy:0})),ot=ce.edges.map(ht=>({...ht,source:ht.source,target:ht.target}));let ar;if(I==="force")ar=tv(Tt).force("link",ev(ot).id(ht=>ht.id).distance(ht=>100+ht.weight*15).strength(ht=>ht.strength||.8)).force("charge",rv().strength(ht=>-300-ht.influence*8)).force("center",oX(r/2,n/2)).force("collision",Qx().radius(ht=>Math.max(20,Math.min(ht.size,50))+10)).alphaDecay(.01).velocityDecay(.6);else if(I==="hierarchical"){const ht=new Map,Jt=Math.max(...Tt.map(tr=>tr.influence));Tt.forEach(tr=>{const zr=Math.floor(tr.influence/Jt*5);ht.set(tr.id,zr)}),ar=tv(Tt).force("link",ev(ot).id(tr=>tr.id).distance(80).strength(.5)).force("charge",rv().strength(-200)).force("y",RB(tr=>{const zr=ht.get(tr.id)||0;return n-zr*(n/6)-50}).strength(.8)).force("x",OB(r/2).strength(.1)).force("collision",Qx().radius(30))}else if(I==="temporal"){const ht=cG(ot,tr=>{var zr;return((zr=tr.timestamp)==null?void 0:zr.getTime())||Date.now()}),Jt=e0().domain(ht).range([100,r-100]);ar=tv(Tt).force("link",ev(ot).id(tr=>tr.id).distance(60).strength(.3)).force("charge",rv().strength(-150)).force("x",OB(tr=>{const zr=ot.filter(yr=>yr.source===tr.id||yr.target===tr.id).reduce((yr,In)=>{var Cr;return yr+(((Cr=In.timestamp)==null?void 0:Cr.getTime())||Date.now())},0)/ot.filter(yr=>yr.source===tr.id||yr.target===tr.id).length;return Jt(zr)}).strength(.7)).force("y",RB(n/2).strength(.1)).force("collision",Qx().radius(25))}else{const ht=Math.max(...Tt.map(Jt=>Jt.influence));ar=tv(Tt).force("link",ev(ot).id(Jt=>Jt.id).distance(50).strength(.2)).force("charge",rv().strength(-100)).force("radial",Q6e(Jt=>(1-Jt.influence/ht)*Math.min(r,n)*.4,r/2,n/2).strength(.8)).force("collision",Qx().radius(25))}se.current=ar;const Lt=gt.append("g").attr("class","links").selectAll("g").data(ot).join("g").attr("class","link-group"),dr=Lt.append("path").attr("class","edge").attr("stroke",ht=>D==="causality"?oe.causality[ht.causality||"correlation"]:D==="temporal"?oe.temporal[ht.temporal||"present"]:oe.relationship[ht.type]||"#6B7280").attr("stroke-width",ht=>Math.max(1,Math.min(8,ht.weight*1.5))).attr("stroke-opacity",ht=>.3+(ht.strength||.5)*.5).attr("fill","none").attr("marker-end",ht=>`url(#arrow-${ht.causality||"correlation"})`).style("cursor","pointer").style("stroke-dasharray",ht=>ht.temporal==="future"?"5,5":ht.temporal==="past"?"2,3":"none");Lt.filter(ht=>ht.weight>7).append("circle").attr("class","flow-indicator").attr("r",3).attr("fill","#3B82F6").attr("opacity",.8).style("pointer-events","none");const qr=gt.append("g").attr("class","nodes").selectAll("g").data(Tt).join("g").attr("class","node-group").style("cursor","pointer"),ln=qr.append("circle").attr("class","node-circle").attr("r",ht=>Math.max(20,Math.min(ht.size,50))).attr("fill",ht=>D==="causality"?re.causality[ht.causalityRole||"mediator"]:D==="influence"?re.influence(ht.influence):`url(#gradient-${ht.type})`).attr("stroke",ht=>u===ht.id?"#000":"#fff").attr("stroke-width",ht=>u===ht.id?4:2).attr("filter",ht=>ht.influence>80?"url(#glow)":"none");O&&qr.filter(ht=>ht.centrality&&ht.centrality>.1).append("circle").attr("class","centrality-ring").attr("r",ht=>Math.max(20,Math.min(ht.size,50))+(ht.centrality||0)*50).attr("fill","none").attr("stroke","#F59E0B").attr("stroke-width",2).attr("stroke-opacity",.6).attr("stroke-dasharray","4,4"),D==="causality"&&qr.append("text").attr("class","causality-indicator").attr("x",ht=>Math.max(20,Math.min(ht.size,50))+5).attr("y",ht=>-Math.max(20,Math.min(ht.size,50))+5).attr("font-size","12px").attr("font-weight","bold").attr("fill",ht=>re.causality[ht.causalityRole||"mediator"]).text(ht=>ht.causalityRole==="cause"?"→":ht.causalityRole==="effect"?"←":"↔"),qr.append("text").attr("class","node-label").attr("y",ht=>Math.max(20,Math.min(ht.size,50))+25).attr("text-anchor","middle").attr("font-size",ht=>Math.max(10,Math.min(16,12+ht.influence/30))).attr("font-weight","600").attr("fill","#1F2937").attr("stroke","#fff").attr("stroke-width",3).attr("paint-order","stroke").text(ht=>ht.label.length>20?ht.label.substring(0,17)+"...":ht.label).style("pointer-events","none"),qr.filter(ht=>ht.metadata.verified).append("path").attr("class","verification-badge").attr("d",ht=>{const Jt=Math.max(20,Math.min(ht.size,50)),tr=Jt*.7,zr=-Jt*.7;return`M${tr-6},${zr}L${tr-2},${zr+4}L${tr+6},${zr-4}`}).attr("stroke","#10B981").attr("stroke-width",2).attr("fill","none"),qr.on("click",function(ht,Jt){ht.stopPropagation(),ye(Jt.id)}).on("mouseenter",function(ht,Jt){ae(Jt.id);const tr=new Set,zr=new Set;ot.forEach(yr=>{const In=typeof yr.source=="string"?yr.source:yr.source.id,Cr=typeof yr.target=="string"?yr.target:yr.target.id;In===Jt.id&&(tr.add(Cr),zr.add(yr.id)),Cr===Jt.id&&(tr.add(In),zr.add(yr.id))}),ln.transition().duration(200).attr("opacity",yr=>yr.id===Jt.id||tr.has(yr.id)?1:.2).attr("r",yr=>{const In=Math.max(20,Math.min(yr.size,50));return yr.id===Jt.id?In*1.3:In}),dr.transition().duration(200).attr("opacity",yr=>zr.has(yr.id)?.9:.1).attr("stroke-width",yr=>zr.has(yr.id)?Math.max(2,Math.min(10,yr.weight*2)):Math.max(1,Math.min(8,yr.weight*1.5)))}).on("mouseleave",function(ht,Jt){xe(),ln.transition().duration(300).attr("opacity",1).attr("r",tr=>Math.max(20,Math.min(tr.size,50))),dr.transition().duration(300).attr("opacity",tr=>.3+(tr.strength||.5)*.5).attr("stroke-width",tr=>Math.max(1,Math.min(8,tr.weight*1.5)))});const Ui=eX().on("start",(ht,Jt)=>{!ht.active&&se.current&&se.current.alphaTarget(.3).restart(),Jt.fx=Jt.x,Jt.fy=Jt.y}).on("drag",(ht,Jt)=>{Jt.fx=ht.x,Jt.fy=ht.y}).on("end",(ht,Jt)=>{!ht.active&&se.current&&se.current.alphaTarget(0),I==="force"&&(Jt.fx=null,Jt.fy=null)});return qr.call(Ui),ar.on("tick",()=>{dr.attr("d",ht=>{const Jt=Se(ht.source.x,r/2),tr=Se(ht.source.y,n/2),zr=Se(ht.target.x,r/2),yr=Se(ht.target.y,n/2),In=zr-Jt,Cr=yr-tr,hn=Math.sqrt(In*In+Cr*Cr)*.4;return ht.causality==="cause"?`M${Jt},${tr}Q${Jt+In/2+hn},${tr+Cr/2} ${zr},${yr}`:ht.causality==="effect"?`M${Jt},${tr}Q${Jt+In/2-hn},${tr+Cr/2} ${zr},${yr}`:`M${Jt},${tr}L${zr},${yr}`}),Lt.selectAll(".flow-indicator").attr("cx",ht=>{const Jt=Se(ht.source.x,r/2),tr=Se(ht.target.x,r/2);return(Jt+tr)/2}).attr("cy",ht=>{const Jt=Se(ht.source.y,n/2),tr=Se(ht.target.y,n/2);return(Jt+tr)/2}),qr.attr("transform",ht=>{const Jt=Se(ht.x,r/2),tr=Se(ht.y,n/2);return ht.x=Jt,ht.y=tr,`translate(${Jt},${tr})`})}),Me.on("click",ht=>{ht.target===Me.node()&&a(null)}),ar.alpha(1).restart(),()=>{se.current&&se.current.stop()}},[ce,r,n,I,D,O,u,p,re,oe,ye,ae,xe,Se]);Y.useEffect(()=>{be()},[be]);const Ce=u?t.find(Me=>Me.id===u):null,$e=p?t.find(Me=>Me.id===p):null;return l.jsxs("div",{ref:o,className:"relative w-full h-full bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg overflow-hidden",children:[l.jsxs("div",{className:"absolute top-4 left-4 z-20 bg-white/95 backdrop-blur-sm rounded-xl shadow-xl p-5 space-y-4 max-w-sm border border-gray-200",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:"font-bold text-gray-900 text-base",children:"Intelligence Analysis"}),l.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"})]}),l.jsx("div",{children:l.jsx("input",{type:"text",placeholder:"Search entities, roles, or descriptions...",value:v,onChange:Me=>w(Me.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:"Analysis Mode"}),l.jsx("div",{className:"grid grid-cols-2 gap-1",children:["network","causality","influence","temporal"].map(Me=>l.jsx("button",{onClick:()=>L(Me),className:`px-2 py-1.5 text-xs rounded-lg font-medium transition-all duration-200 capitalize ${D===Me?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:Me},Me))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-2",children:"Layout Algorithm"}),l.jsx("div",{className:"grid grid-cols-2 gap-1",children:["force","hierarchical","temporal","influence"].map(Me=>l.jsx("button",{onClick:()=>P(Me),className:`px-2 py-1.5 text-xs rounded-lg font-medium transition-all duration-200 capitalize ${I===Me?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:Me},Me))})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Entity Type"}),l.jsxs("select",{value:T,onChange:Me=>A(Me.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 transition-all duration-200",children:[l.jsx("option",{value:"all",children:"All Types"}),ne.map(Me=>l.jsx("option",{value:Me,children:Me},Me))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1",children:"Temporal Filter"}),l.jsxs("select",{value:J,onChange:Me=>W(Me.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 transition-all duration-200",children:[l.jsx("option",{value:"all",children:"All Time"}),l.jsx("option",{value:"past",children:"Historical"}),l.jsx("option",{value:"present",children:"Current"}),l.jsx("option",{value:"future",children:"Projected"})]})]})]}),l.jsxs("div",{className:"space-y-2 pt-3 border-t border-gray-200",children:[l.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[l.jsx("input",{type:"checkbox",checked:O,onChange:Me=>$(Me.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsx("span",{children:"Show Centrality Measures"})]}),l.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[l.jsx("input",{type:"checkbox",checked:G,onChange:Me=>B(Me.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsx("span",{children:"Highlight Influence Paths"})]})]}),l.jsxs("div",{className:"text-xs text-gray-600 pt-3 border-t border-gray-200 space-y-1",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Entities:"}),l.jsxs("span",{className:"font-medium",children:[ce.nodes.length,"/",t.length]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Relationships:"}),l.jsxs("span",{className:"font-medium",children:[ce.edges.length,"/",e.length]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Zoom Level:"}),l.jsxs("span",{className:"font-medium",children:[(H*100).toFixed(0),"%"]})]})]})]}),l.jsx("svg",{ref:i,width:r,height:n,className:"w-full h-full"}),l.jsxs("div",{className:"absolute bottom-4 left-4 z-20 bg-white/95 backdrop-blur-sm rounded-xl shadow-xl p-4 border border-gray-200",children:[l.jsxs("h5",{className:"font-bold text-sm text-gray-900 mb-3",children:["Legend - ",D.charAt(0).toUpperCase()+D.slice(1)," Analysis"]}),l.jsxs("div",{className:"space-y-3 text-xs",children:[D==="causality"&&l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-gray-700 mb-2",children:"Causality Roles:"}),Object.entries(re.causality).map(([Me,St])=>l.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:St}}),l.jsx("span",{className:"capitalize",children:Me}),l.jsx("span",{className:"text-gray-500",children:Me==="cause"?"→":Me==="effect"?"←":"↔"})]},Me))]}),D==="temporal"&&l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-gray-700 mb-2",children:"Temporal Relationships:"}),Object.entries(oe.temporal).map(([Me,St])=>l.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[l.jsx("div",{className:"w-4 h-0.5",style:{backgroundColor:St}}),l.jsx("span",{className:"capitalize",children:Me})]},Me))]}),(D==="network"||D==="influence")&&l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-gray-700 mb-2",children:"Entity Types:"}),Object.entries(re.nodeType).map(([Me,St])=>l.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:St}}),l.jsx("span",{className:"capitalize",children:Me})]},Me))]}),l.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[l.jsx("div",{className:"font-semibold text-gray-700 mb-1",children:"Visual Indicators:"}),l.jsxs("div",{className:"space-y-1 text-gray-600",children:[l.jsx("div",{children:"• Size = Influence Level"}),l.jsx("div",{children:"• Glow = High Impact (80+)"}),l.jsx("div",{children:"• ✓ = Verified Source"}),O&&l.jsx("div",{children:"• Dotted Ring = High Centrality"})]})]})]})]}),$e&&!u&&l.jsxs("div",{className:"fixed z-40 bg-white rounded-xl shadow-2xl border border-gray-200 p-4 max-w-sm pointer-events-none",style:{left:"50%",top:"20%",transform:"translateX(-50%)"},children:[l.jsx("div",{className:"font-bold text-gray-900 text-lg",children:$e.label}),l.jsxs("div",{className:"text-sm text-gray-600 mt-2 space-y-1",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Type:"}),l.jsx("span",{className:"capitalize font-medium",children:$e.type})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Influence:"}),l.jsx("span",{className:"font-medium",children:$e.influence})]}),((Ye=K.nodes.find(Me=>Me.id===$e.id))==null?void 0:Ye.causalityRole)&&l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Role:"}),l.jsx("span",{className:"capitalize font-medium",children:(jt=K.nodes.find(Me=>Me.id===$e.id))==null?void 0:jt.causalityRole})]}),$e.metadata.sentiment!==void 0&&l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Sentiment:"}),l.jsxs("span",{className:`font-medium ${$e.metadata.sentiment>0?"text-green-600":$e.metadata.sentiment<0?"text-red-600":"text-gray-600"}`,children:[$e.metadata.sentiment>0?"+":"",$e.metadata.sentiment.toFixed(2)]})]}),$e.metadata.verified&&l.jsx("div",{className:"text-green-600 text-sm",children:"✓ Verified Source"})]})]}),Ce&&l.jsxs("div",{className:"absolute top-4 right-4 z-30 bg-white rounded-xl shadow-2xl border border-gray-200 p-6 max-w-md max-h-[calc(100vh-2rem)] overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsx("h3",{className:"font-bold text-xl text-gray-900",children:Ce.label}),l.jsx("button",{onClick:()=>a(null),className:"text-gray-400 hover:text-gray-600 text-2xl leading-none transition-colors duration-200",children:"×"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[l.jsx("span",{className:"text-gray-500 block",children:"Type"}),l.jsx("div",{className:"font-bold capitalize text-lg",children:Ce.type})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[l.jsx("span",{className:"text-gray-500 block",children:"Influence"}),l.jsx("div",{className:"font-bold text-lg",children:Ce.influence})]})]}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Network Analysis"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Total Connections:"}),l.jsx("span",{className:"font-medium",children:e.filter(Me=>(typeof Me.source=="string"?Me.source:Me.source.id)===Ce.id||(typeof Me.target=="string"?Me.target:Me.target.id)===Ce.id).length})]}),(()=>{const Me=K.nodes.find(St=>St.id===Ce.id);return Me?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Outgoing:"}),l.jsx("span",{className:"font-medium",children:Me.outgoingConnections})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Incoming:"}),l.jsx("span",{className:"font-medium",children:Me.incomingConnections})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Causality Role:"}),l.jsx("span",{className:"font-medium capitalize",children:Me.causalityRole})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Centrality:"}),l.jsxs("span",{className:"font-medium",children:[(Me.centrality*100).toFixed(1),"%"]})]})]}):null})()]})]}),Ce.metadata.sentiment!==void 0&&l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Sentiment Analysis"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm",children:"Sentiment Score:"}),l.jsxs("span",{className:`font-bold ${Ce.metadata.sentiment>0?"text-green-600":Ce.metadata.sentiment<0?"text-red-600":"text-gray-600"}`,children:[Ce.metadata.sentiment>0?"+":"",Ce.metadata.sentiment.toFixed(2)]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:l.jsx("div",{className:`h-3 rounded-full transition-all duration-500 ${Ce.metadata.sentiment>0?"bg-green-500":"bg-red-500"}`,style:{width:`${Math.abs(Ce.metadata.sentiment)*50+50}%`,marginLeft:Ce.metadata.sentiment<0?"auto":"0"}})})]})]}),l.jsxs("div",{className:"space-y-2 text-sm",children:[Ce.metadata.verified&&l.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[l.jsx("span",{className:"font-bold",children:"✓"}),l.jsx("span",{children:"Verified Source"})]}),Ce.metadata.followerCount&&l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500",children:"Followers:"}),l.jsx("span",{className:"font-medium",children:Ce.metadata.followerCount.toLocaleString()})]}),Ce.metadata.credibility&&l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500",children:"Credibility:"}),l.jsxs("span",{className:"font-medium",children:[(Ce.metadata.credibility*100).toFixed(0),"%"]})]})]}),Ce.metadata.description&&l.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Description"}),l.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:Ce.metadata.description})]})]})]})]})}class lLe extends LT{constructor(){super("sentinel_network")}generateMockNetworkData(){const e=[{id:"president",label:"Félix Tshisekedi",type:"person",size:45,influence:95,color:"#1E40AF",metadata:{verified:!0,followerCount:25e5,postCount:1200,sentiment:.3,credibility:.9,category:"Politique",description:"Président de la République Démocratique du Congo"}},{id:"pm",label:"Judith Suminwa",type:"person",size:35,influence:78,color:"#1E40AF",metadata:{verified:!0,followerCount:85e4,postCount:800,sentiment:.2,credibility:.85,category:"Politique",description:"Première Ministre de la RDC"}},{id:"opposition1",label:"Martin Fayulu",type:"person",size:30,influence:65,color:"#DC2626",metadata:{verified:!0,followerCount:12e5,postCount:2400,sentiment:-.4,credibility:.7,category:"Opposition",description:"Leader de l'opposition politique"}},{id:"media-radio-okapi",label:"Radio Okapi",type:"organization",size:32,influence:72,color:"#7C3AED",metadata:{verified:!0,followerCount:95e4,postCount:15e3,sentiment:.1,credibility:.95,category:"Médias",description:"Radio officielle des Nations Unies en RDC"}},{id:"media-actualite-cd",label:"Actualité.cd",type:"organization",size:28,influence:58,color:"#7C3AED",metadata:{verified:!0,followerCount:42e4,postCount:8500,sentiment:0,credibility:.8,category:"Médias",description:"Site d'information congolais"}},{id:"un-monusco",label:"MONUSCO",type:"organization",size:38,influence:82,color:"#059669",metadata:{verified:!0,followerCount:3e5,postCount:2800,sentiment:-.2,credibility:.9,category:"International",description:"Mission de l'ONU en RDC"}},{id:"civil-lucha",label:"LUCHA",type:"organization",size:25,influence:55,color:"#EA580C",metadata:{verified:!1,followerCount:18e4,postCount:3200,sentiment:-.6,credibility:.75,category:"Société Civile",description:"Mouvement citoyen de jeunes"}},{id:"location-goma",label:"Goma",type:"location",size:28,influence:60,color:"#DC2626",metadata:{verified:!1,followerCount:0,postCount:0,sentiment:-.8,credibility:1,category:"Zone de conflit",description:"Capitale du Nord-Kivu, zone de tensions"}},{id:"location-kinshasa",label:"Kinshasa",type:"location",size:40,influence:85,color:"#1E40AF",metadata:{verified:!1,followerCount:0,postCount:0,sentiment:.2,credibility:1,category:"Capitale",description:"Capitale politique de la RDC"}},{id:"hashtag-elections",label:"#Elections2024",type:"hashtag",size:35,influence:70,color:"#059669",metadata:{verified:!1,followerCount:0,postCount:25e3,sentiment:.1,credibility:.6,category:"Politique",description:"Hashtag des élections présidentielles"}},{id:"hashtag-paix",label:"#PaixRDC",type:"hashtag",size:22,influence:45,color:"#059669",metadata:{verified:!1,followerCount:0,postCount:12e3,sentiment:.6,credibility:.7,category:"Paix",description:"Campagne pour la paix en RDC"}},{id:"hashtag-m23",label:"#M23",type:"hashtag",size:30,influence:65,color:"#DC2626",metadata:{verified:!1,followerCount:0,postCount:18e3,sentiment:-.9,credibility:.5,category:"Conflit",description:"Groupe armé dans l'Est de la RDC"}},{id:"topic-mining",label:"Exploitation Minière",type:"topic",size:26,influence:52,color:"#D97706",metadata:{verified:!1,followerCount:0,postCount:0,sentiment:-.3,credibility:.8,category:"Économie",description:"Secteur minier et ressources naturelles"}}],r=[{id:"president-pm",source:"president",target:"pm",weight:9,type:"collaboration",timestamp:new Date(Date.now()-5*24*60*60*1e3),metadata:{frequency:45,strength:.9,sentiment:.3}},{id:"president-opposition",source:"president",target:"opposition1",weight:6,type:"opposition",timestamp:new Date(Date.now()-2*24*60*60*1e3),metadata:{frequency:25,strength:.7,sentiment:-.6}},{id:"president-radio-okapi",source:"president",target:"media-radio-okapi",weight:8,type:"mention",timestamp:new Date(Date.now()-1*24*60*60*1e3),metadata:{frequency:120,strength:.8,sentiment:.2}},{id:"pm-actualite",source:"pm",target:"media-actualite-cd",weight:6,type:"mention",timestamp:new Date(Date.now()-3*24*60*60*1e3),metadata:{frequency:85,strength:.6,sentiment:.1}},{id:"opposition-actualite",source:"opposition1",target:"media-actualite-cd",weight:7,type:"mention",timestamp:new Date(Date.now()-1*24*60*60*1e3),metadata:{frequency:95,strength:.7,sentiment:-.3}},{id:"president-monusco",source:"president",target:"un-monusco",weight:7,type:"collaboration",timestamp:new Date(Date.now()-7*24*60*60*1e3),metadata:{frequency:35,strength:.6,sentiment:-.1}},{id:"monusco-goma",source:"un-monusco",target:"location-goma",weight:8,type:"mention",timestamp:new Date(Date.now()-1*24*60*60*1e3),metadata:{frequency:180,strength:.9,sentiment:-.7}},{id:"lucha-opposition",source:"civil-lucha",target:"opposition1",weight:5,type:"collaboration",timestamp:new Date(Date.now()-10*24*60*60*1e3),metadata:{frequency:22,strength:.5,sentiment:-.2}},{id:"lucha-kinshasa",source:"civil-lucha",target:"location-kinshasa",weight:6,type:"mention",timestamp:new Date(Date.now()-2*24*60*60*1e3),metadata:{frequency:65,strength:.7,sentiment:-.4}},{id:"president-kinshasa",source:"president",target:"location-kinshasa",weight:9,type:"mention",timestamp:new Date(Date.now()-1*24*60*60*1e3),metadata:{frequency:200,strength:.95,sentiment:.4}},{id:"president-elections",source:"president",target:"hashtag-elections",weight:8,type:"mention",timestamp:new Date(Date.now()-4*24*60*60*1e3),metadata:{frequency:150,strength:.8,sentiment:.5}},{id:"opposition-elections",source:"opposition1",target:"hashtag-elections",weight:7,type:"mention",timestamp:new Date(Date.now()-2*24*60*60*1e3),metadata:{frequency:120,strength:.7,sentiment:-.3}},{id:"goma-m23",source:"location-goma",target:"hashtag-m23",weight:9,type:"mention",timestamp:new Date(Date.now()-1*24*60*60*1e3),metadata:{frequency:300,strength:.95,sentiment:-.9}},{id:"monusco-m23",source:"un-monusco",target:"hashtag-m23",weight:8,type:"mention",timestamp:new Date(Date.now()-1*24*60*60*1e3),metadata:{frequency:145,strength:.8,sentiment:-.8}},{id:"president-paix",source:"president",target:"hashtag-paix",weight:6,type:"mention",timestamp:new Date(Date.now()-3*24*60*60*1e3),metadata:{frequency:85,strength:.7,sentiment:.8}},{id:"radio-okapi-paix",source:"media-radio-okapi",target:"hashtag-paix",weight:5,type:"mention",timestamp:new Date(Date.now()-5*24*60*60*1e3),metadata:{frequency:95,strength:.6,sentiment:.7}},{id:"president-mining",source:"president",target:"topic-mining",weight:7,type:"mention",timestamp:new Date(Date.now()-6*24*60*60*1e3),metadata:{frequency:45,strength:.7,sentiment:.2}},{id:"goma-mining",source:"location-goma",target:"topic-mining",weight:6,type:"mention",timestamp:new Date(Date.now()-4*24*60*60*1e3),metadata:{frequency:75,strength:.8,sentiment:-.5}}];return{nodes:e,edges:r}}async getNetworkData(e){var i,o;await this.simulateDelay(400);let{nodes:r,edges:n}=this.loadFromStorage()||this.generateMockNetworkData();if(console.log("NetworkService: Generated data",{nodeCount:r.length,edgeCount:n.length,sampleNode:r[0],sampleEdge:n[0]}),e){if((i=e.nodeTypes)!=null&&i.length){const u=new Set(r.filter(a=>e.nodeTypes.includes(a.type)).map(a=>a.id));r=r.filter(a=>u.has(a.id)),n=n.filter(a=>u.has(a.source)&&u.has(a.target))}if((o=e.edgeTypes)!=null&&o.length&&(n=n.filter(u=>e.edgeTypes.includes(u.type))),e.minInfluence!==void 0){const u=new Set(r.filter(a=>a.influence>=e.minInfluence).map(a=>a.id));r=r.filter(a=>u.has(a.id)),n=n.filter(a=>u.has(a.source)&&u.has(a.target))}e.minWeight!==void 0&&(n=n.filter(u=>u.weight>=e.minWeight)),e.dateRange&&(n=n.filter(u=>u.timestamp>=e.dateRange.start&&u.timestamp<=e.dateRange.end))}return{nodes:r,edges:n}}async getNodeDetails(e){await this.simulateDelay(200);const{nodes:r,edges:n}=await this.getNetworkData(),i=r.find(u=>u.id===e);if(!i)throw new Error("Node not found");const o=n.filter(u=>u.source===e||u.target===e);return{...i,connections:o}}async performNetworkAnalysis(e){await this.simulateDelay(800);const{nodes:r,edges:n}=await this.getNetworkData(e),i=Array.from({length:4},(p,g)=>{const v=r.filter((w,T)=>T%4===g);return{id:`community-${g+1}`,nodes:v.map(w=>w.id),size:v.length,influence:v.reduce((w,T)=>w+T.influence,0)/v.length,sentiment:v.reduce((w,T)=>w+(T.metadata.sentiment||0),0)/v.length}}),o=r.sort((p,g)=>g.influence-p.influence).slice(0,5),u={betweenness:r.reduce((p,g)=>(p[g.id]=Math.random(),p),{}),closeness:r.reduce((p,g)=>(p[g.id]=Math.random(),p),{}),eigenvector:r.reduce((p,g)=>(p[g.id]=Math.random(),p),{})},a=Array.from({length:5},(p,g)=>{const v=r[Math.floor(Math.random()*r.length)],w=r[Math.floor(Math.random()*r.length)],T=Math.floor(Math.random()*4)+2,A=[v.id];for(let I=1;I<T-1;I++){const P=r[Math.floor(Math.random()*r.length)];A.push(P.id)}return A.push(w.id),{from:v.id,to:w.id,path:A,length:T}});return{communityDetection:{communities:i},influencers:o,centralityMetrics:u,pathAnalysis:{shortestPaths:a}}}async detectCommunities(){return await this.simulateDelay(600),(await this.performNetworkAnalysis()).communityDetection.communities}async findShortestPath(e,r){await this.simulateDelay(300);const{nodes:n}=await this.getNetworkData(),i=n.find(p=>p.id===e),o=n.find(p=>p.id===r);if(!i||!o)return null;const u=Math.floor(Math.random()*4)+2,a=[e];for(let p=1;p<u-1;p++){const g=n[Math.floor(Math.random()*n.length)];a.push(g.id)}return a.push(r),{path:a,length:u}}async getNetworkMetrics(){await this.simulateDelay(200);const{nodes:e,edges:r}=await this.getNetworkData();return{totalNodes:e.length,totalEdges:r.length,density:r.length/(e.length*(e.length-1)/2),avgClustering:Math.random()*.5+.2,avgPathLength:Math.random()*3+2,diameter:Math.floor(Math.random()*6)+4}}async exportNetworkData(e){await this.simulateDelay(500);const{nodes:r,edges:n}=await this.getNetworkData();switch(e){case"json":return JSON.stringify({nodes:r,edges:n},null,2);case"csv":const i=`id,label,type,influence
`+r.map(u=>`${u.id},${u.label},${u.type},${u.influence}`).join(`
`),o=`source,target,weight,type
`+n.map(u=>`${u.source},${u.target},${u.weight},${u.type}`).join(`
`);return`NODES:
${i}

EDGES:
${o}`;case"graphml":return`<?xml version="1.0" encoding="UTF-8"?>
<graphml xmlns="http://graphml.graphdrawing.org/xmlns">
  <graph id="G" edgedefault="undirected">
    ${r.map(u=>`<node id="${u.id}"><data key="label">${u.label}</data></node>`).join(`
    `)}
    ${n.map(u=>`<edge source="${u.source}" target="${u.target}"><data key="weight">${u.weight}</data></edge>`).join(`
    `)}
  </graph>
</graphml>`;default:throw new Error(`Unsupported format: ${e}`)}}}function T4(){Y.useState(null);const[t,e]=Y.useState("influence"),[r,n]=Y.useState({nodes:[],edges:[]}),[i,o]=Y.useState("force"),[u,a]=Y.useState("type"),[p,g]=Y.useState(!0),[v,w]=Y.useState({width:1200,height:800}),T=new lLe,A=Array.from({length:24},(P,D)=>({time:`${D}:00`,original:D===0?100:0,firstGen:D>0&&D<4?50*(4-D):0,secondGen:D>2&&D<8?30*(8-D):0,thirdGen:D>5&&D<12?20*(12-D):0})),I=[{name:"Gouvernement",members:234,color:"from-blue-500 to-blue-600",overlap:15},{name:"Opposition",members:189,color:"from-red-500 to-red-600",overlap:8},{name:"Société Civile",members:342,color:"from-green-500 to-green-600",overlap:23},{name:"Médias",members:156,color:"from-purple-500 to-purple-600",overlap:31}];return Y.useEffect(()=>{const P=async()=>{try{const L=await T.getNetworkData();console.log("Network data loaded:",L.nodes.length,"nodes,",L.edges.length,"edges"),n(L)}catch(L){console.error("Failed to load network data:",L)}};P();const D=setInterval(P,3e4);return()=>clearInterval(D)},[]),Y.useEffect(()=>{const P=()=>{const D=document.querySelector(".network-visualization-container");if(D){const L=D.getBoundingClientRect();w({width:Math.max(800,L.width-64),height:800})}else w({width:Math.max(800,window.innerWidth-120),height:800})};return P(),window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[]),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Intelligence Réseau"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Analyse des connexions et influences"})]}),l.jsx("div",{className:"flex items-center space-x-2",children:["influence","cascade","communities"].map(P=>l.jsxs("button",{onClick:()=>e(P),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${t===P?"bg-blue-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[P==="influence"&&"Carte d'Influence",P==="cascade"&&"Cascade d'Information",P==="communities"&&"Communautés"]},P))})]}),t==="influence"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-8",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"text-center mb-4",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-2",children:"Analyse du Réseau d'Influence"}),l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.nodes.length," nœuds • ",r.edges.length," connexions • Layout: ",i]})]}),l.jsxs("div",{className:"flex flex-wrap gap-4 justify-center mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Layout:"}),l.jsxs("select",{value:i,onChange:P=>o(P.target.value),className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"force",children:"Force"}),l.jsx("option",{value:"hierarchical",children:"Hiérarchique"}),l.jsx("option",{value:"circular",children:"Circulaire"}),l.jsx("option",{value:"grid",children:"Grille"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Couleurs:"}),l.jsxs("select",{value:u,onChange:P=>a(P.target.value),className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[l.jsx("option",{value:"type",children:"Par Type"}),l.jsx("option",{value:"influence",children:"Par Influence"}),l.jsx("option",{value:"sentiment",children:"Par Sentiment"}),l.jsx("option",{value:"default",children:"Défaut"})]})]}),l.jsx("div",{className:"flex items-center space-x-2",children:l.jsxs("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l.jsx("input",{type:"checkbox",checked:p,onChange:P=>g(P.target.checked),className:"mr-1"}),"Afficher labels"]})})]})]}),r.nodes.length>0?l.jsx("div",{className:"relative w-full network-visualization-container",children:l.jsx(oLe,{nodes:r.nodes,edges:r.edges,width:v.width,height:v.height})}):l.jsx("div",{className:"h-[500px] flex items-center justify-center bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Chargement des données réseau..."})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Nœuds Actifs"}),l.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:"127"}),l.jsx("p",{className:"text-sm text-green-600 mt-1",children:"+15 cette semaine"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Connexions"}),l.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:"892"}),l.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Densité: 0.72"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Vitesse Propagation"}),l.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:"2.4h"}),l.jsx("p",{className:"text-sm text-yellow-600 mt-1",children:"Temps moyen"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Portée Max"}),l.jsx("p",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:"450K"}),l.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"Par propagation"})]})]})]}),t==="cascade"&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-6",children:"Cascade d'Information"}),l.jsx(Jg,{width:"100%",height:400,children:l.jsxs($H,{data:A,children:[l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"originalGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.8}),l.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:.1})]}),l.jsxs("linearGradient",{id:"firstGenGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"5%",stopColor:"#8B5CF6",stopOpacity:.8}),l.jsx("stop",{offset:"95%",stopColor:"#8B5CF6",stopOpacity:.1})]}),l.jsxs("linearGradient",{id:"secondGenGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"5%",stopColor:"#EC4899",stopOpacity:.8}),l.jsx("stop",{offset:"95%",stopColor:"#EC4899",stopOpacity:.1})]}),l.jsxs("linearGradient",{id:"thirdGenGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"5%",stopColor:"#F59E0B",stopOpacity:.8}),l.jsx("stop",{offset:"95%",stopColor:"#F59E0B",stopOpacity:.1})]})]}),l.jsx(gb,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),l.jsx(Td,{dataKey:"time",stroke:"#6B7280"}),l.jsx(ou,{stroke:"#6B7280"}),l.jsx(as,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #E5E7EB",borderRadius:"8px"}}),l.jsx(Hc,{}),l.jsx(cs,{type:"monotone",dataKey:"original",stackId:"1",stroke:"#3B82F6",fillOpacity:1,fill:"url(#originalGrad)",name:"Source originale"}),l.jsx(cs,{type:"monotone",dataKey:"firstGen",stackId:"1",stroke:"#8B5CF6",fillOpacity:1,fill:"url(#firstGenGrad)",name:"1ère génération"}),l.jsx(cs,{type:"monotone",dataKey:"secondGen",stackId:"1",stroke:"#EC4899",fillOpacity:1,fill:"url(#secondGenGrad)",name:"2ème génération"}),l.jsx(cs,{type:"monotone",dataKey:"thirdGen",stackId:"1",stroke:"#F59E0B",fillOpacity:1,fill:"url(#thirdGenGrad)",name:"3ème génération"})]})}),l.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:"Vitesse de Propagation"}),l.jsxs("div",{className:"flex items-end space-x-2",children:[l.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"3.2x"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"facteur viral"})]})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:"Profondeur Max"}),l.jsxs("div",{className:"flex items-end space-x-2",children:[l.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"7"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"générations"})]})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:"Saturation"}),l.jsxs("div",{className:"flex items-end space-x-2",children:[l.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"12h"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"temps moyen"})]})]})]})]}),t==="communities"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-8",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-6",children:"Détection de Communautés"}),l.jsx("div",{className:"relative h-96",children:I.map((P,D)=>{const L=[{left:"25%",top:"30%"},{left:"65%",top:"25%"},{left:"30%",top:"65%"},{left:"70%",top:"60%"}],O=100+P.members/3;return l.jsxs("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2",style:L[D],children:[l.jsx("div",{className:`rounded-full bg-gradient-to-br ${P.color} opacity-30 absolute`,style:{width:`${O*1.2}px`,height:`${O*1.2}px`,left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),l.jsx("div",{className:`rounded-full bg-gradient-to-br ${P.color} opacity-50 absolute`,style:{width:`${O}px`,height:`${O}px`,left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),l.jsxs("div",{className:`rounded-full bg-gradient-to-br ${P.color} flex flex-col items-center justify-center text-white relative`,style:{width:`${O*.8}px`,height:`${O*.8}px`},children:[l.jsx("p",{className:"font-semibold text-lg",children:P.members}),l.jsx("p",{className:"text-sm opacity-90",children:P.name})]})]},P.name)})})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:I.map(P=>l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("div",{className:`w-16 h-16 bg-gradient-to-br ${P.color} rounded-xl mb-4`}),l.jsx("h5",{className:"font-semibold text-gray-800 dark:text-white mb-2",children:P.name}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Membres:"}),l.jsx("span",{className:"font-medium",children:P.members})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Chevauchement:"}),l.jsxs("span",{className:"font-medium",children:[P.overlap,"%"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Croissance:"}),l.jsx("span",{className:"font-medium text-green-600",children:"+12%"})]})]})]},P.name))})]})]})}var cX={exports:{}};(function(t,e){(function(r,n){t.exports=n()})($c,function(){var r,n,i;function o(a,p){if(!r)r=p;else if(!n)n=p;else{var g="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",v={};r(v),i=p(v),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([g],{type:"text/javascript"})))}}o(["exports"],function(a){var p=typeof self<"u"?self:{},g="2.15.0";let v;const w={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(v==null){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{v={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):c}catch{v=c}}return v},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!w.API_URL)return null;try{const c=new URL(w.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},T={supported:!1,testSupport:function(c){!P&&I&&(D?L(c):A=c)}};let A,I,P=!1,D=!1;function L(c){const s=c.createTexture();c.bindTexture(c.TEXTURE_2D,s);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,I),c.isContextLost())return;T.supported=!0}catch{}c.deleteTexture(s),P=!0}p.document&&(I=p.document.createElement("img"),I.onload=function(){A&&L(A),A=null,D=!0},I.onerror=function(){P=!0,A=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const O="01";function $(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var G=B;function B(c,s,d,f){this.cx=3*c,this.bx=3*(d-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=s,this.p2x=d,this.p2y=f}B.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,s){if(s===void 0&&(s=1e-6),c<0)return 0;if(c>1)return 1;for(var d=c,f=0;f<8;f++){var y=this.sampleCurveX(d)-c;if(Math.abs(y)<s)return d;var _=this.sampleCurveDerivativeX(d);if(Math.abs(_)<1e-6)break;d-=y/_}var k=0,E=1;for(d=c,f=0;f<20&&(y=this.sampleCurveX(d),!(Math.abs(y-c)<s));f++)c>y?k=d:E=d,d=.5*(E-k)+k;return d},solve:function(c,s){return this.sampleCurveY(this.solveCurveX(c,s))}};var J=$(G),W=H;function H(c,s){this.x=c,this.y=s}H.prototype={clone:function(){return new H(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,s){return this.clone()._rotateAround(c,s)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var s=c.x-this.x,d=c.y-this.y;return s*s+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,s){return Math.atan2(this.x*s-this.y*c,this.x*c+this.y*s)},_matMult:function(c){var s=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=s,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var s=Math.cos(c),d=Math.sin(c),f=d*this.x+s*this.y;return this.x=s*this.x-d*this.y,this.y=f,this},_rotateAround:function(c,s){var d=Math.cos(c),f=Math.sin(c),y=s.y+f*(this.x-s.x)+d*(this.y-s.y);return this.x=s.x+d*(this.x-s.x)-f*(this.y-s.y),this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},H.convert=function(c){return c instanceof H?c:Array.isArray(c)?new H(c[0],c[1]):c};var V=$(W);const se=Math.PI/180,K=180/Math.PI;function ce(c){return c*se}function ne(c){return c*K}const re=[[0,0],[1,0],[1,1],[0,1]];function oe(c){if(c<=0)return 0;if(c>=1)return 1;const s=c*c,d=s*c;return 4*(c<.5?d:3*(c-s)+d-.75)}function ae(c,s,d,f){const y=new J(c,s,d,f);return function(_){return y.solve(_)}}const xe=ae(.25,.1,.25,1);function ye(c,s,d){return Math.min(d,Math.max(s,c))}function Se(c,s,d){return(d=ye((d-c)/(s-c),0,1))*d*(3-2*d)}function be(c,s,d){const f=d-s,y=((c-s)%f+f)%f+s;return y===s?d:y}function Ce(c,s,d){if(!c.length)return d(null,[]);let f=c.length;const y=new Array(c.length);let _=null;c.forEach((k,E)=>{s(k,(N,M)=>{N&&(_=N),y[E]=M,--f==0&&d(_,y)})})}function $e(c){const s=[];for(const d in c)s.push(c[d]);return s}function Ye(c,...s){for(const d of s)for(const f in d)c[f]=d[f];return c}let jt=1;function Me(){return jt++}function St(){return function c(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function Ct(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Ft(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function gt(c,s){c.forEach(d=>{s[d]&&(s[d]=s[d].bind(s))})}function Zt(c,s){return c.indexOf(s,c.length-s.length)!==-1}function Tt(c,s,d){const f={};for(const y in c)f[y]=s.call(d||this,c[y],y,c);return f}function ot(c,s,d){const f={};for(const y in c)s.call(d||this,c[y],y,c)&&(f[y]=c[y]);return f}function ar(c){return Array.isArray(c)?c.map(ar):typeof c=="object"&&c?Tt(c,ar):c}const mt={};function Lt(c){mt[c]||(typeof console<"u"&&console.warn(c),mt[c]=!0)}function dr(c,s,d){return(d.y-c.y)*(s.x-c.x)>(s.y-c.y)*(d.x-c.x)}function Gr(c){let s=0;for(let d,f,y=0,_=c.length,k=_-1;y<_;k=y++)d=c[y],f=c[k],s+=(f.x-d.x)*(d.y+f.y);return s}function qr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ln(c){const s={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(d,f,y,_)=>{const k=y||_;return s[f]=!k||k.toLowerCase(),""}),s["max-age"]){const d=parseInt(s["max-age"],10);isNaN(d)?delete s["max-age"]:s["max-age"]=d}return s}let Ui=null;function ht(c){if(Ui==null){const s=c.navigator?c.navigator.userAgent:null;Ui=!!c.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Ui}function Jt(c){try{const s=p[c];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}function tr(c,s){return[c[4*s],c[4*s+1],c[4*s+2],c[4*s+3]]}const zr="mapbox-tiles";let yr=500,In=50,Cr,hn;function fs(){try{return p.caches}catch{}}function ps(){fs()&&!Cr&&(Cr=p.caches.open(zr))}function Os(c){const s=c.indexOf("?");if(s<0)return c;const d=function(y){const _=y.indexOf("?");return _>0?y.slice(_+1).split("&"):[]}(c),f=d.filter(y=>{const _=y.split("=");return _[0]==="language"||_[0]==="worldview"});return f.length?`${c.slice(0,s)}?${f.join("&")}`:c.slice(0,s)}let Do=1/0;const va={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(va);class qa extends Error{constructor(s,d,f){d===401&&Ze(f)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=d,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ms=qr()?()=>self.worker&&self.worker.referrer:()=>(p.location.protocol==="blob:"?p.parent:p).location.href,Ga=function(c,s){if(!(/^file:/.test(d=c.url)||/^file:/.test(ms())&&!/^\w+:/.test(d))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(f,y){const _=new p.AbortController,k=new p.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:ms(),referrerPolicy:f.referrerPolicy,signal:_.signal});let E=!1,N=!1;const M=(F=k.url).indexOf("sku=")>0&&Ze(F);var F;f.type==="json"&&k.headers.set("Accept","application/json");const q=(te,ie,fe)=>{if(N)return;if(te&&te.message!=="SecurityError"&&Lt(te.toString()),ie&&fe)return X(ie);const ge=Date.now();p.fetch(k).then(je=>{if(je.ok){const Re=M?je.clone():null;return X(je,Re,ge)}return y(new qa(je.statusText,je.status,f.url))}).catch(je=>{je.name!=="AbortError"&&y(new Error(`${je.message} ${f.url}`))})},X=(te,ie,fe)=>{(f.type==="arrayBuffer"?te.arrayBuffer():f.type==="json"?te.json():te.text()).then(ge=>{N||(ie&&fe&&function(je,Re,Ae){if(ps(),!Cr)return;const Oe={status:Re.status,statusText:Re.statusText,headers:new p.Headers};Re.headers.forEach((nt,Qe)=>Oe.headers.set(Qe,nt));const Be=ln(Re.headers.get("Cache-Control")||"");if(Be["no-store"])return;Be["max-age"]&&Oe.headers.set("Expires",new Date(Ae+1e3*Be["max-age"]).toUTCString());const Fe=Oe.headers.get("Expires");Fe&&(new Date(Fe).getTime()-Ae<42e4||function(nt,Qe){if(hn===void 0)try{new Response(new ReadableStream),hn=!0}catch{hn=!1}hn?Qe(nt.body):nt.blob().then(Qe)}(Re,nt=>{const Qe=new p.Response(nt,Oe);ps(),Cr&&Cr.then(dt=>dt.put(Os(je.url),Qe)).catch(dt=>Lt(dt.message))}))}(k,ie,fe),E=!0,y(null,ge,te.headers.get("Cache-Control"),te.headers.get("Expires")))}).catch(ge=>{N||y(new Error(ge.message))})};return M?function(te,ie){if(ps(),!Cr)return ie(null);const fe=Os(te.url);Cr.then(ge=>{ge.match(fe).then(je=>{const Re=function(Ae){if(!Ae)return!1;const Oe=new Date(Ae.headers.get("Expires")||0),Be=ln(Ae.headers.get("Cache-Control")||"");return Oe>Date.now()&&!Be["no-cache"]}(je);ge.delete(fe),Re&&ge.put(fe,je.clone()),ie(null,je,Re)}).catch(ie)}).catch(ie)}(k,q):q(null,null),{cancel:()=>{N=!0,E||_.abort()}}}(c,s);if(qr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,s,void 0,!0)}var d;return function(f,y){const _=new p.XMLHttpRequest;_.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const k in f.headers)_.setRequestHeader(k,f.headers[k]);return f.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=f.credentials==="include",_.onerror=()=>{y(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let k=_.response;if(f.type==="json")try{k=JSON.parse(_.response)}catch(E){return y(E)}y(null,k,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else y(new qa(_.statusText,_.status,f.url))},_.send(f.body),{cancel:()=>_.abort()}}(c,s)},oo=function(c,s){return Ga(Ye(c,{type:"arrayBuffer"}),s)};function _l(c){const s=p.document.createElement("a");return s.href=c,s.protocol===p.document.location.protocol&&s.host===p.document.location.host}const De="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let pe,le;pe=[],le=0;const Ne=function(c,s){if(T.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),le>=w.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:c,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return pe.push(_),_}le++;let d=!1;const f=()=>{if(!d)for(d=!0,le--;pe.length&&le<w.MAX_PARALLEL_IMAGE_REQUESTS;){const _=pe.shift(),{requestParameters:k,callback:E,cancelled:N}=_;N||(_.cancel=Ne(k,E).cancel)}},y=oo(c,(_,k,E,N)=>{f(),_?s(_):k&&(p.createImageBitmap?function(M,F){const q=new p.Blob([new Uint8Array(M)],{type:"image/png"});p.createImageBitmap(q).then(X=>{F(null,X)}).catch(X=>{F(new Error(`Could not load image because of ${X.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(k,(M,F)=>s(M,F,E,N)):function(M,F){const q=new p.Image,X=p.URL;q.onload=()=>{F(null,q),X.revokeObjectURL(q.src),q.onload=null,p.requestAnimationFrame(()=>{q.src=De})},q.onerror=()=>F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const te=new p.Blob([new Uint8Array(M)],{type:"image/png"});q.src=M.byteLength?X.createObjectURL(te):De}(k,(M,F)=>s(M,F,E,N)))});return{cancel:()=>{y.cancel(),f()}}},ze="NO_ACCESS_TOKEN";function Ge(c){return c.indexOf("mapbox:")===0}function Ze(c){return w.API_URL_REGEX.test(c)}function Xe(c){return w.API_CDN_URL_REGEX.test(c)}function We(c){return w.API_STYLE_REGEX.test(c)&&!it(c)}function it(c){return w.API_SPRITE_REGEX.test(c)}const It=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function zt(c){const s=c.match(It);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function vt(c){const s=c.params.length?`?${c.params.join("&")}`:"";return`${c.protocol}://${c.authority}${c.path}${s}`}const xr="mapbox.eventData";function vr(c){if(!c)return null;const s=c.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(decodeURIComponent(p.atob(s[1]).split("").map(d=>"%"+("00"+d.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class mr{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const d=vr(w.ACCESS_TOKEN);let f="";return f=d&&d.u?p.btoa(encodeURIComponent(d.u).replace(/%([0-9A-F]{2})/g,(y,_)=>String.fromCharCode(+("0x"+_)))):w.ACCESS_TOKEN||"",s?`${xr}.${s}:${f}`:`${xr}:${f}`}fetchEventData(){const s=Jt("localStorage"),d=this.getStorageKey(),f=this.getStorageKey("uuid");if(s)try{const y=p.localStorage.getItem(d);y&&(this.eventData=JSON.parse(y));const _=p.localStorage.getItem(f);_&&(this.anonId=_)}catch{Lt("Unable to read from LocalStorage")}}saveEventData(){const s=Jt("localStorage"),d=this.getStorageKey(),f=this.getStorageKey("uuid");if(s)try{p.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&p.localStorage.setItem(d,JSON.stringify(this.eventData))}catch{Lt("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,d,f,y){if(!w.EVENTS_URL)return;const _=zt(w.EVENTS_URL);_.params.push(`access_token=${y||w.ACCESS_TOKEN||""}`);const k={event:this.type,created:new Date(s).toISOString()},E=d?Ye(k,d):k,N={url:vt(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=function(M,F){return Ga(Ye(M,{method:"POST"}),F)}(N,M=>{this.pendingRequest=null,f(M),this.saveEventData(),this.processRequests(y)})}queueRequest(s,d){this.queue.push(s),this.processRequests(d)}}const Pr=new class extends mr{constructor(c){super("appUserTurnstile"),this._customAccessToken=c}postTurnstileEvent(c,s){w.EVENTS_URL&&w.ACCESS_TOKEN&&Array.isArray(c)&&c.some(d=>Ge(d)||Ze(d))&&this.queueRequest(Date.now(),s)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=vr(w.ACCESS_TOKEN),d=s?s.u:w.ACCESS_TOKEN;let f=d!==this.eventData.tokenU;Ft(this.anonId)||(this.anonId=St(),f=!0);const y=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),k=new Date(y),E=(y-this.eventData.lastSuccess)/864e5;f=f||E>=1||E<-1||_.getDate()!==k.getDate()}else f=!0;f?this.postEvent(y,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:O,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=y,this.eventData.tokenU=d)},c):this.processRequests()}},$r=Pr.postTurnstileEvent.bind(Pr),nn=new class extends mr{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(c,s,d,f){this.skuToken=s,this.errorCb=f,w.EVENTS_URL&&(d||w.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},d):this.errorCb(new Error(ze)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:d}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),Ft(this.anonId)||(this.anonId=St()),this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:O,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):s&&(this.success[s]=!0)},c))}},Yn=nn.postMapLoadEvent.bind(nn),qi=new class extends mr{constructor(){super("gljs.performance")}postPerformanceEvent(c,s){w.EVENTS_URL&&(c||w.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},c)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:d}=this.queue.shift(),f=function(y){const _=p.performance.getEntriesByType("resource"),k=p.performance.getEntriesByType("mark"),E=function(X){const te={};if(X){for(const ie in X)if(ie!=="other")for(const fe of X[ie]){const ge=`${ie}ResolveRangeMin`,je=`${ie}ResolveRangeMax`,Re=`${ie}RequestCount`,Ae=`${ie}RequestCachedCount`;te[ge]=Math.min(te[ge]||1/0,fe.startTime),te[je]=Math.max(te[je]||-1/0,fe.responseEnd);const Oe=Be=>{te[Be]===void 0&&(te[Be]=0),++te[Be]};fe.transferSize!==void 0&&fe.transferSize===0&&Oe(Ae),Oe(Re)}}return te}(function(X,te){const ie={};if(X)for(const fe of X){const ge=te(fe);ie[ge]===void 0&&(ie[ge]=[]),ie[ge].push(fe)}return ie}(_,yf)),N=p.devicePixelRatio,M=p.navigator.connection||p.navigator.mozConnection||p.navigator.webkitConnection,F={counters:[],metadata:[],attributes:[]},q=(X,te,ie)=>{ie!=null&&X.push({name:te,value:ie.toString()})};for(const X in E)q(F.counters,X,E[X]);if(y.interactionRange[0]!==1/0&&y.interactionRange[1]!==-1/0&&(q(F.counters,"interactionRangeMin",y.interactionRange[0]),q(F.counters,"interactionRangeMax",y.interactionRange[1])),k)for(const X of Object.keys(Pa)){const te=Pa[X],ie=k.find(fe=>fe.name===te);ie&&q(F.counters,te,ie.startTime)}return q(F.counters,"visibilityHidden",y.visibilityHidden),q(F.attributes,"style",function(X){if(X)for(const te of X){const ie=te.name.split("?")[0];if(We(ie)){const fe=ie.split("/").slice(-2);if(fe.length===2)return`mapbox://styles/${fe[0]}/${fe[1]}`}}}(_)),q(F.attributes,"terrainEnabled",y.terrainEnabled?"true":"false"),q(F.attributes,"fogEnabled",y.fogEnabled?"true":"false"),q(F.attributes,"projection",y.projection),q(F.attributes,"zoom",y.zoom),q(F.metadata,"devicePixelRatio",N),q(F.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),q(F.metadata,"navigatorUserAgent",p.navigator.userAgent),q(F.metadata,"screenWidth",p.screen.width),q(F.metadata,"screenHeight",p.screen.height),q(F.metadata,"windowWidth",p.innerWidth),q(F.metadata,"windowHeight",p.innerHeight),q(F.metadata,"mapWidth",y.width/N),q(F.metadata,"mapHeight",y.height/N),q(F.metadata,"webglRenderer",y.renderer),q(F.metadata,"webglVendor",y.vendor),q(F.metadata,"sdkVersion",g),q(F.metadata,"sdkIdentifier","mapbox-gl-js"),F}(d);for(const y of f.metadata);for(const y of f.counters);for(const y of f.attributes);this.postEvent(s,f,()=>{},c)}},zn=qi.postPerformanceEvent.bind(qi),gs=new class extends mr{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(c,s,d,f){if(!w.API_URL||!w.SESSION_PATH)return;const y=zt(w.API_URL+w.SESSION_PATH);y.params.push(`sku=${s||""}`),y.params.push(`access_token=${f||w.ACCESS_TOKEN||""}`);const _={url:vt(y),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(k,E){return Ga(Ye(k,{method:"GET"}),E)}(_,k=>{this.pendingRequest=null,d(k),this.saveEventData(),this.processRequests(f)})}getSessionAPI(c,s,d,f){this.skuToken=s,this.errorCb=f,w.SESSION_PATH&&w.API_URL&&(d||w.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},d):this.errorCb(new Error(ze)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:d}=this.queue.shift();s&&this.success[s]||this.getSession(d,this.skuToken,f=>{f?this.errorCb(f):s&&(this.success[s]=!0)},c)}},li=gs.getSessionAPI.bind(gs),Pi=new Set,Pa={create:"create",load:"load",fullLoad:"fullLoad"},tm={mark(c){p.performance.mark(c)},measure(c,s,d){p.performance.measure(c,s,d)}};function yf(c){const s=c.name.split("?")[0];return Xe(s)&&s.includes("mapbox-gl.js")?"javascript":Xe(s)&&s.includes("mapbox-gl.css")?"css":function(d){return w.API_FONTS_REGEX.test(d)}(s)?"fontRange":it(s)?"sprite":We(s)?"style":function(d){return w.API_TILEJSON_REGEX.test(d)}(s)?"tilejson":"other"}const Wr=p.performance;function mu(c){const s=c?c.url.toString():void 0;return Wr.getEntriesByName(s)}let mc,Sd,Ed,Ia;const Rs={now:()=>Ed!==void 0?Ed:p.performance.now(),setNow(c){Ed=c},restoreNow(){Ed=void 0},frame(c){const s=p.requestAnimationFrame(c);return{cancel:()=>p.cancelAnimationFrame(s)}},getImageData(c,s=0){const{width:d,height:f}=c;Ia||(Ia=p.document.createElement("canvas"));const y=Ia.getContext("2d",{willReadFrequently:!0});if(!y)throw new Error("failed to create canvas 2d context");return(d>Ia.width||f>Ia.height)&&(Ia.width=d,Ia.height=f),y.clearRect(-s,-s,d+2*s,f+2*s),y.drawImage(c,0,0,d,f),y.getImageData(-s,-s,d+2*s,f+2*s)},resolveURL:c=>(mc||(mc=p.document.createElement("a")),mc.href=c,mc.href),get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(Sd==null&&(Sd=p.matchMedia("(prefers-reduced-motion: reduce)")),Sd.matches)}};function gu(c,s,d){d[c]&&d[c].indexOf(s)!==-1||(d[c]=d[c]||[],d[c].push(s))}function bl(c,s,d){if(d&&d[c]){const f=d[c].indexOf(s);f!==-1&&d[c].splice(f,1)}}class Ma{constructor(s,d={}){Ye(this,d),this.type=s}}class ys extends Ma{constructor(s,d={}){super("error",Ye({error:s},d))}}class yu{on(s,d){return this._listeners=this._listeners||{},gu(s,d,this._listeners),this}off(s,d){return bl(s,d,this._listeners),bl(s,d,this._oneTimeListeners),this}once(s,d){return d?(this._oneTimeListeners=this._oneTimeListeners||{},gu(s,d,this._oneTimeListeners),this):new Promise(f=>this.once(s,f))}fire(s,d){typeof s=="string"&&(s=new Ma(s,d||{}));const f=s.type;if(this.listens(f)){s.target=this;const y=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const E of y)E.call(this,s);const _=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const E of _)bl(f,E,this._oneTimeListeners),E.call(this,s);const k=this._eventedParent;k&&(Ye(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),k.fire(s))}else s instanceof ys&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,d){return this._eventedParent=s,this._eventedParentData=d,this}}var lt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ls(c,...s){for(const d of s)for(const f in d)c[f]=d[f];return c}function qn(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function ci(c){if(Array.isArray(c))return c.map(ci);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const s={};for(const d in c)s[d]=ci(c[d]);return s}return qn(c)}class jd extends Error{constructor(s,d){super(d),this.message=d,this.key=s}}var xs=jd;class Ad{constructor(s,d=[]){this.parent=s,this.bindings={};for(const[f,y]of d)this.bindings[f]=y}concat(s){return new Ad(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}var rm=Ad;const gc={kind:"null"},qt={kind:"number"},Dr={kind:"string"},Mr={kind:"boolean"},gi={kind:"color"},yi={kind:"object"},Sr={kind:"value"},Gi={kind:"collator"},yc={kind:"formatted"},tn={kind:"resolvedImage"};function aa(c,s){return{kind:"array",itemType:c,N:s}}function an(c){if(c.kind==="array"){const s=an(c.itemType);return typeof c.N=="number"?`array<${s}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${s}>`}return c.kind}const xc=[gc,qt,Dr,Mr,gi,yc,yi,aa(Sr),tn];function lo(c,s){if(s.kind==="error")return null;if(c.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!lo(c.itemType,s.itemType))&&(typeof c.N!="number"||c.N===s.N))return null}else{if(c.kind===s.kind)return null;if(c.kind==="value"){for(const d of xc)if(!lo(d,s))return null}}return`Expected ${an(c)} but found ${an(s)} instead.`}function vc(c,s){return s.some(d=>d.kind===c.kind)}function xu(c,s){return s.some(d=>d==="null"?c===null:d==="array"?Array.isArray(c):d==="object"?c&&!Array.isArray(c)&&typeof c=="object":d===typeof c)}var xf,nm={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function vu(c){return(c=Math.round(c))<0?0:c>255?255:c}function co(c){return vu(c[c.length-1]==="%"?parseFloat(c)/100*255:parseInt(c))}function vs(c){return(s=c[c.length-1]==="%"?parseFloat(c)/100:parseFloat(c))<0?0:s>1?1:s;var s}function wl(c,s,d){return d<0?d+=1:d>1&&(d-=1),6*d<1?c+(s-c)*d*6:2*d<1?s:3*d<2?c+(s-c)*(2/3-d)*6:c}try{xf={}.parseCSSColor=function(c){var s,d=c.replace(/ /g,"").toLowerCase();if(d in nm)return nm[d].slice();if(d[0]==="#")return d.length===4?(s=parseInt(d.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:d.length===7&&(s=parseInt(d.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var f=d.indexOf("("),y=d.indexOf(")");if(f!==-1&&y+1===d.length){var _=d.substr(0,f),k=d.substr(f+1,y-(f+1)).split(","),E=1;switch(_){case"rgba":if(k.length!==4)return null;E=vs(k.pop());case"rgb":return k.length!==3?null:[co(k[0]),co(k[1]),co(k[2]),E];case"hsla":if(k.length!==4)return null;E=vs(k.pop());case"hsl":if(k.length!==3)return null;var N=(parseFloat(k[0])%360+360)%360/360,M=vs(k[1]),F=vs(k[2]),q=F<=.5?F*(M+1):F+M-F*M,X=2*F-q;return[vu(255*wl(X,q,N+1/3)),vu(255*wl(X,q,N)),vu(255*wl(X,q,N-1/3)),E];default:return null}}return null}}catch{}class sa{constructor(s,d,f,y=1){this.r=s,this.g=d,this.b=f,this.a=y}static parse(s){if(!s)return;if(s instanceof sa)return s;if(typeof s!="string")return;const d=xf(s);return d?new sa(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3]):void 0}toString(){const[s,d,f,y]=this.toArray();return`rgba(${Math.round(s)},${Math.round(d)},${Math.round(f)},${y})`}toArray(){const{r:s,g:d,b:f,a:y}=this;return y===0?[0,0,0,0]:[255*s/y,255*d/y,255*f/y,y]}toArray01(){const{r:s,g:d,b:f,a:y}=this;return y===0?[0,0,0,0]:[s/y,d/y,f/y,y]}toArray01PremultipliedAlpha(){const{r:s,g:d,b:f,a:y}=this;return[s,d,f,y]}}sa.black=new sa(0,0,0,1),sa.white=new sa(1,1,1,1),sa.transparent=new sa(0,0,0,0),sa.red=new sa(1,0,0,1),sa.blue=new sa(0,0,1,1);var $n=sa;class Oo{constructor(s,d,f){this.sensitivity=s?d?"variant":"case":d?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,d){return this.collator.compare(s,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class vf{constructor(s,d,f,y,_){this.text=s.normalize?s.normalize():s,this.image=d,this.scale=f,this.fontStack=y,this.textColor=_}}class _a{constructor(s){this.sections=s}static fromString(s){return new _a([new vf(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof _a?s:_a.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const d of this.sections){if(d.image){s.push(["image",d.image.name]);continue}s.push(d.text);const f={};d.fontStack&&(f["text-font"]=["literal",d.fontStack.split(",")]),d.scale&&(f["font-scale"]=d.scale),d.textColor&&(f["text-color"]=["rgba"].concat(d.textColor.toArray())),s.push(f)}return s}}class Wa{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new Wa({name:s,available:!1}):null}serialize(){return["image",this.name]}}function uo(c,s,d,f){return typeof c=="number"&&c>=0&&c<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof d=="number"&&d>=0&&d<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,s,d,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,s,d,f]:[c,s,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function _u(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof $n||c instanceof Oo||c instanceof _a||c instanceof Wa)return!0;if(Array.isArray(c)){for(const s of c)if(!_u(s))return!1;return!0}if(typeof c=="object"){for(const s in c)if(!_u(c[s]))return!1;return!0}return!1}function Fn(c){if(c===null)return gc;if(typeof c=="string")return Dr;if(typeof c=="boolean")return Mr;if(typeof c=="number")return qt;if(c instanceof $n)return gi;if(c instanceof Oo)return Gi;if(c instanceof _a)return yc;if(c instanceof Wa)return tn;if(Array.isArray(c)){const s=c.length;let d;for(const f of c){const y=Fn(f);if(d){if(d===y)continue;d=Sr;break}d=y}return aa(d||Sr,s)}return yi}function Ro(c){const s=typeof c;return c===null?"":s==="string"||s==="number"||s==="boolean"?String(c):c instanceof $n||c instanceof _a||c instanceof Wa?c.toString():JSON.stringify(c)}class _c{constructor(s,d){this.type=s,this.value=d}static parse(s,d){if(s.length!==2)return d.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!_u(s[1]))return d.error("invalid value");const f=s[1];let y=Fn(f);const _=d.expectedType;return y.kind!=="array"||y.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(y=_),new _c(y,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof $n?["rgba"].concat(this.value.toArray()):this.value instanceof _a?this.value.serialize():this.value}}var Lo=_c,Jn=class{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}};const kl={string:Dr,number:qt,boolean:Mr,object:yi};class Nd{constructor(s,d){this.type=s,this.args=d}static parse(s,d){if(s.length<2)return d.error("Expected at least one argument.");let f,y=1;const _=s[0];if(_==="array"){let E,N;if(s.length>2){const M=s[1];if(typeof M!="string"||!(M in kl)||M==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);E=kl[M],y++}else E=Sr;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return d.error('The length argument to "array" must be a positive integer literal',2);N=s[2],y++}f=aa(E,N)}else f=kl[_];const k=[];for(;y<s.length;y++){const E=d.parse(s[y],y,Sr);if(!E)return null;k.push(E)}return new Nd(f,k)}evaluate(s){for(let d=0;d<this.args.length;d++){const f=this.args[d].evaluate(s);if(!lo(this.type,Fn(f)))return f;if(d===this.args.length-1)throw new Jn(`Expected value to be of type ${an(this.type)}, but found ${an(Fn(f))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,d=[s.kind];if(s.kind==="array"){const f=s.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){d.push(f.kind);const y=s.N;(typeof y=="number"||this.args.length>1)&&d.push(y)}}return d.concat(this.args.map(f=>f.serialize()))}}var _s=Nd;class cn{constructor(s){this.type=yc,this.sections=s}static parse(s,d){if(s.length<2)return d.error("Expected at least one argument.");const f=s[1];if(!Array.isArray(f)&&typeof f=="object")return d.error("First argument must be an image or text section.");const y=[];let _=!1;for(let k=1;k<=s.length-1;++k){const E=s[k];if(_&&typeof E=="object"&&!Array.isArray(E)){_=!1;let N=null;if(E["font-scale"]&&(N=d.parse(E["font-scale"],1,qt),!N))return null;let M=null;if(E["text-font"]&&(M=d.parse(E["text-font"],1,aa(Dr)),!M))return null;let F=null;if(E["text-color"]&&(F=d.parse(E["text-color"],1,gi),!F))return null;const q=y[y.length-1];q.scale=N,q.font=M,q.textColor=F}else{const N=d.parse(s[k],1,Sr);if(!N)return null;const M=N.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,y.push({content:N,scale:null,font:null,textColor:null})}}return new cn(y)}evaluate(s){return new _a(this.sections.map(d=>{const f=d.content.evaluate(s);return Fn(f)===tn?new vf("",f,null,null,null):new vf(Ro(f),null,d.scale?d.scale.evaluate(s):null,d.font?d.font.evaluate(s).join(","):null,d.textColor?d.textColor.evaluate(s):null)}))}eachChild(s){for(const d of this.sections)s(d.content),d.scale&&s(d.scale),d.font&&s(d.font),d.textColor&&s(d.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const d of this.sections){s.push(d.content.serialize());const f={};d.scale&&(f["font-scale"]=d.scale.serialize()),d.font&&(f["text-font"]=d.font.serialize()),d.textColor&&(f["text-color"]=d.textColor.serialize()),s.push(f)}return s}}class Cd{constructor(s){this.type=tn,this.input=s}static parse(s,d){if(s.length!==2)return d.error("Expected two arguments.");const f=d.parse(s[1],1,Dr);return f?new Cd(f):d.error("No image name provided.")}evaluate(s){const d=this.input.evaluate(s),f=Wa.fromString(d);return f&&s.availableImages&&(f.available=s.availableImages.indexOf(d)>-1),f}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const dy={"to-boolean":Mr,"to-color":gi,"to-number":qt,"to-string":Dr};class Pd{constructor(s,d){this.type=s,this.args=d}static parse(s,d){if(s.length<2)return d.error("Expected at least one argument.");const f=s[0];if((f==="to-boolean"||f==="to-string")&&s.length!==2)return d.error("Expected one argument.");const y=dy[f],_=[];for(let k=1;k<s.length;k++){const E=d.parse(s[k],k,Sr);if(!E)return null;_.push(E)}return new Pd(y,_)}evaluate(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){let d,f;for(const y of this.args){if(d=y.evaluate(s),f=null,d instanceof $n)return d;if(typeof d=="string"){const _=s.parseColor(d);if(_)return _}else if(Array.isArray(d)&&(f=d.length<3||d.length>4?`Invalid rbga value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:uo(d[0],d[1],d[2],d[3]),!f))return new $n(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Jn(f||`Could not parse color from value '${typeof d=="string"?d:String(JSON.stringify(d))}'`)}if(this.type.kind==="number"){let d=null;for(const f of this.args){if(d=f.evaluate(s),d===null)return 0;const y=Number(d);if(!isNaN(y))return y}throw new Jn(`Could not convert ${JSON.stringify(d)} to number.`)}return this.type.kind==="formatted"?_a.fromString(Ro(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?Wa.fromString(Ro(this.args[0].evaluate(s))):Ro(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if(this.type.kind==="formatted")return new cn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Cd(this.args[0]).serialize();const s=[`to-${this.type.kind}`];return this.eachChild(d=>{s.push(d.serialize())}),s}}var Tl=Pd;const bs=["Unknown","Point","LineString","Polygon"];var bc=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?bs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:d,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(d*s-c[0])+this.featureDistanceData.bearing[1]*(f*s-c[1])}return 0}parseColor(c){let s=this._parseColorCache[c];return s||(s=this._parseColorCache[c]=$n.parse(c)),s}};class zo{constructor(s,d,f,y){this.name=s,this.type=d,this._evaluate=f,this.args=y}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,d){const f=s[0],y=zo.definitions[f];if(!y)return d.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(y)?y[0]:y.type,k=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,E=k.filter(([M])=>!Array.isArray(M)||M.length===s.length-1);let N=null;for(const[M,F]of E){N=new oa(d.registry,d.path,null,d.scope);const q=[];let X=!1;for(let te=1;te<s.length;te++){const ie=s[te],fe=Array.isArray(M)?M[te-1]:M.type,ge=N.parse(ie,1+q.length,fe);if(!ge){X=!0;break}q.push(ge)}if(!X)if(Array.isArray(M)&&M.length!==q.length)N.error(`Expected ${M.length} arguments, but found ${q.length} instead.`);else{for(let te=0;te<q.length;te++){const ie=Array.isArray(M)?M[te]:M.type,fe=q[te];N.concat(te+1).checkSubtype(ie,fe.type)}if(N.errors.length===0)return new zo(f,_,F,q)}}if(E.length===1)d.errors.push(...N.errors);else{const M=(E.length?E:k).map(([q])=>{return X=q,Array.isArray(X)?`(${X.map(an).join(", ")})`:`(${an(X.type)}...)`;var X}).join(" | "),F=[];for(let q=1;q<s.length;q++){const X=d.parse(s[q],1+F.length);if(!X)return null;F.push(an(X.type))}d.error(`Expected arguments of type ${M}, but found (${F.join(", ")}) instead.`)}return null}static register(s,d){zo.definitions=d;for(const f in d)s[f]=zo}}var zi=zo;class wc{constructor(s,d,f){this.type=Gi,this.locale=f,this.caseSensitive=s,this.diacriticSensitive=d}static parse(s,d){if(s.length!==2)return d.error("Expected one argument.");const f=s[1];if(typeof f!="object"||Array.isArray(f))return d.error("Collator options argument must be an object.");const y=d.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Mr);if(!y)return null;const _=d.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Mr);if(!_)return null;let k=null;return f.locale&&(k=d.parse(f.locale,1,Dr),!k)?null:new wc(y,_,k)}evaluate(s){return new Oo(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}const ho=8192;function $o(c,s){c[0]=Math.min(c[0],s[0]),c[1]=Math.min(c[1],s[1]),c[2]=Math.max(c[2],s[0]),c[3]=Math.max(c[3],s[1])}function Sl(c,s){return!(c[0]<=s[0]||c[2]>=s[2]||c[1]<=s[1]||c[3]>=s[3])}function El(c,s){const d=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,y=Math.pow(2,s.z);return[Math.round(d*y*ho),Math.round(f*y*ho)]}function bu(c,s,d){const f=c[0]-s[0],y=c[1]-s[1],_=c[0]-d[0],k=c[1]-d[1];return f*k-_*y==0&&f*_<=0&&y*k<=0}function wu(c,s){let d=!1;for(let k=0,E=s.length;k<E;k++){const N=s[k];for(let M=0,F=N.length;M<F-1;M++){if(bu(c,N[M],N[M+1]))return!1;(y=N[M])[1]>(f=c)[1]!=(_=N[M+1])[1]>f[1]&&f[0]<(_[0]-y[0])*(f[1]-y[1])/(_[1]-y[1])+y[0]&&(d=!d)}}var f,y,_;return d}function kc(c,s){for(let d=0;d<s.length;d++)if(wu(c,s[d]))return!0;return!1}function _f(c,s,d,f){const y=f[0]-d[0],_=f[1]-d[1],k=(c[0]-d[0])*_-y*(c[1]-d[1]),E=(s[0]-d[0])*_-y*(s[1]-d[1]);return k>0&&E<0||k<0&&E>0}function jl(c,s,d){for(const M of d)for(let F=0;F<M.length-1;++F)if((E=[(k=M[F+1])[0]-(_=M[F])[0],k[1]-_[1]])[0]*(N=[(y=s)[0]-(f=c)[0],y[1]-f[1]])[1]-E[1]*N[0]!=0&&_f(f,y,_,k)&&_f(_,k,f,y))return!0;var f,y,_,k,E,N;return!1}function Vr(c,s){for(let d=0;d<c.length;++d)if(!wu(c[d],s))return!1;for(let d=0;d<c.length-1;++d)if(jl(c[d],c[d+1],s))return!1;return!0}function im(c,s){for(let d=0;d<s.length;d++)if(Vr(c,s[d]))return!0;return!1}function Id(c,s,d){const f=[];for(let y=0;y<c.length;y++){const _=[];for(let k=0;k<c[y].length;k++){const E=El(c[y][k],d);$o(s,E),_.push(E)}f.push(_)}return f}function Md(c,s,d){const f=[];for(let y=0;y<c.length;y++){const _=Id(c[y],s,d);f.push(_)}return f}function ku(c,s,d,f){if(c[0]<d[0]||c[0]>d[2]){const y=.5*f;let _=c[0]-d[0]>y?-f:d[0]-c[0]>y?f:0;_===0&&(_=c[0]-d[2]>y?-f:d[2]-c[0]>y?f:0),c[0]+=_}$o(s,c)}function bf(c,s,d,f){const y=Math.pow(2,f.z)*ho,_=[f.x*ho,f.y*ho],k=[];if(!c)return k;for(const E of c)for(const N of E){const M=[N.x+_[0],N.y+_[1]];ku(M,s,d,y),k.push(M)}return k}function Tc(c,s,d,f){const y=Math.pow(2,f.z)*ho,_=[f.x*ho,f.y*ho],k=[];if(!c)return k;for(const N of c){const M=[];for(const F of N){const q=[F.x+_[0],F.y+_[1]];$o(s,q),M.push(q)}k.push(M)}if(s[2]-s[0]<=y/2){(E=s)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const N of k)for(const M of N)ku(M,s,d,y)}var E;return k}class Al{constructor(s,d){this.type=Mr,this.geojson=s,this.geometries=d}static parse(s,d){if(s.length!==2)return d.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(_u(s[1])){const f=s[1];if(f.type==="FeatureCollection")for(let y=0;y<f.features.length;++y){const _=f.features[y].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Al(f,f.features[y].geometry)}else if(f.type==="Feature"){const y=f.geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Al(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Al(f,f)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(d,f){const y=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],k=d.canonicalID();if(!k)return!1;if(f.type==="Polygon"){const E=Id(f.coordinates,_,k),N=bf(d.geometry(),y,_,k);if(!Sl(y,_))return!1;for(const M of N)if(!wu(M,E))return!1}if(f.type==="MultiPolygon"){const E=Md(f.coordinates,_,k),N=bf(d.geometry(),y,_,k);if(!Sl(y,_))return!1;for(const M of N)if(!kc(M,E))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(d,f){const y=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],k=d.canonicalID();if(!k)return!1;if(f.type==="Polygon"){const E=Id(f.coordinates,_,k),N=Tc(d.geometry(),y,_,k);if(!Sl(y,_))return!1;for(const M of N)if(!Vr(M,E))return!1}if(f.type==="MultiPolygon"){const E=Md(f.coordinates,_,k),N=Tc(d.geometry(),y,_,k);if(!Sl(y,_))return!1;for(const M of N)if(!im(M,E))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Tu=Al;function Ha(c){if(c instanceof zi&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Tu)return!1;let s=!0;return c.eachChild(d=>{s&&!Ha(d)&&(s=!1)}),s}function zs(c){if(c instanceof zi&&c.name==="feature-state")return!1;let s=!0;return c.eachChild(d=>{s&&!zs(d)&&(s=!1)}),s}function Fo(c,s){if(c instanceof zi&&s.indexOf(c.name)>=0)return!1;let d=!0;return c.eachChild(f=>{d&&!Fo(f,s)&&(d=!1)}),d}class Su{constructor(s,d){this.type=d.type,this.name=s,this.boundExpression=d}static parse(s,d){if(s.length!==2||typeof s[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");const f=s[1];return d.scope.has(f)?new Su(f,d.scope.get(f)):d.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var wf=Su;class Bo{constructor(s,d=[],f,y=new rm,_=[]){this.registry=s,this.path=d,this.key=d.map(k=>`[${k}]`).join(""),this.scope=y,this.errors=_,this.expectedType=f}parse(s,d,f,y,_={}){return d?this.concat(d,f,y)._parse(s,_):this._parse(s,_)}_parse(s,d){function f(y,_,k){return k==="assert"?new _s(_,[y]):k==="coerce"?new Tl(_,[y]):y}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=s[0];if(typeof y!="string")return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[y];if(_){let k=_.parse(s,this);if(!k)return null;if(this.expectedType){const E=this.expectedType,N=k.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||N.kind!=="value")if(E.kind!=="color"&&E.kind!=="formatted"&&E.kind!=="resolvedImage"||N.kind!=="value"&&N.kind!=="string"){if(this.checkSubtype(E,N))return null}else k=f(k,E,d.typeAnnotation||"coerce");else k=f(k,E,d.typeAnnotation||"assert")}if(!(k instanceof Lo)&&k.type.kind!=="resolvedImage"&&Dd(k)){const E=new bc;try{k=new Lo(k.type,k.evaluate(E))}catch(N){return this.error(N.message),null}}return k}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,d,f){const y=typeof s=="number"?this.path.concat(s):this.path,_=f?this.scope.concat(f):this.scope;return new Bo(this.registry,y,d||null,_,this.errors)}error(s,...d){const f=`${this.key}${d.map(y=>`[${y}]`).join("")}`;this.errors.push(new xs(f,s))}checkSubtype(s,d){const f=lo(s,d);return f&&this.error(f),f}}var oa=Bo;function Dd(c){if(c instanceof wf)return Dd(c.boundExpression);if(c instanceof zi&&c.name==="error"||c instanceof wc||c instanceof Tu)return!1;const s=c instanceof Tl||c instanceof _s;let d=!0;return c.eachChild(f=>{d=s?d&&Dd(f):d&&f instanceof Lo}),!!d&&Ha(c)&&Fo(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Eu(c,s){const d=c.length-1;let f,y,_=0,k=d,E=0;for(;_<=k;)if(E=Math.floor((_+k)/2),f=c[E],y=c[E+1],f<=s){if(E===d||s<y)return E;_=E+1}else{if(!(f>s))throw new Jn("Input is not a number.");k=E-1}return 0}class fo{constructor(s,d,f){this.type=s,this.input=d,this.labels=[],this.outputs=[];for(const[y,_]of f)this.labels.push(y),this.outputs.push(_)}static parse(s,d){if(s.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return d.error("Expected an even number of arguments.");const f=d.parse(s[1],1,qt);if(!f)return null;const y=[];let _=null;d.expectedType&&d.expectedType.kind!=="value"&&(_=d.expectedType);for(let k=1;k<s.length;k+=2){const E=k===1?-1/0:s[k],N=s[k+1],M=k,F=k+1;if(typeof E!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(y.length&&y[y.length-1][0]>=E)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const q=d.parse(N,F,_);if(!q)return null;_=_||q.type,y.push([E,q])}return new fo(_,f,y)}evaluate(s){const d=this.labels,f=this.outputs;if(d.length===1)return f[0].evaluate(s);const y=this.input.evaluate(s);if(y<=d[0])return f[0].evaluate(s);const _=d.length;return y>=d[_-1]?f[_-1].evaluate(s):f[Eu(d,y)].evaluate(s)}eachChild(s){s(this.input);for(const d of this.outputs)s(d)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let d=0;d<this.labels.length;d++)d>0&&s.push(this.labels[d]),s.push(this.outputs[d].serialize());return s}}var C=fo;function Z(c,s,d){return c*(1-d)+s*d}var de=Object.freeze({__proto__:null,array:function(c,s,d){return c.map((f,y)=>Z(f,s[y],d))},color:function(c,s,d){return new $n(Z(c.r,s.r,d),Z(c.g,s.g,d),Z(c.b,s.b,d),Z(c.a,s.a,d))},number:Z});const ke=.95047,et=1.08883,ut=4/29,Gt=6/29,un=3*Gt*Gt,$i=Gt*Gt*Gt,Qr=Math.PI/180,Wi=180/Math.PI;function Ii(c){return c>$i?Math.pow(c,1/3):c/un+ut}function Vo(c){return c>Gt?c*c*c:un*(c-ut)}function Da(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Nl(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Od(c){const s=Nl(c.r),d=Nl(c.g),f=Nl(c.b),y=Ii((.4124564*s+.3575761*d+.1804375*f)/ke),_=Ii((.2126729*s+.7151522*d+.072175*f)/1);return{l:116*_-16,a:500*(y-_),b:200*(_-Ii((.0193339*s+.119192*d+.9503041*f)/et)),alpha:c.a}}function Cb(c){let s=(c.l+16)/116,d=isNaN(c.a)?s:s+c.a/500,f=isNaN(c.b)?s:s-c.b/200;return s=1*Vo(s),d=ke*Vo(d),f=et*Vo(f),new $n(Da(3.2404542*d-1.5371385*s-.4985314*f),Da(-.969266*d+1.8760108*s+.041556*f),Da(.0556434*d-.2040259*s+1.0572252*f),c.alpha)}function hE(c,s,d){const f=s-c;return c+d*(f>180||f<-180?f-360*Math.round(f/360):f)}const kf={forward:Od,reverse:Cb,interpolate:function(c,s,d){return{l:Z(c.l,s.l,d),a:Z(c.a,s.a,d),b:Z(c.b,s.b,d),alpha:Z(c.alpha,s.alpha,d)}}},Rd={forward:function(c){const{l:s,a:d,b:f}=Od(c),y=Math.atan2(f,d)*Wi;return{h:y<0?y+360:y,c:Math.sqrt(d*d+f*f),l:s,alpha:c.a}},reverse:function(c){const s=c.h*Qr,d=c.c;return Cb({l:c.l,a:Math.cos(s)*d,b:Math.sin(s)*d,alpha:c.alpha})},interpolate:function(c,s,d){return{h:hE(c.h,s.h,d),c:Z(c.c,s.c,d),l:Z(c.l,s.l,d),alpha:Z(c.alpha,s.alpha,d)}}};var hy=Object.freeze({__proto__:null,hcl:Rd,lab:kf});class Tf{constructor(s,d,f,y,_){this.type=s,this.operator=d,this.interpolation=f,this.input=y,this.labels=[],this.outputs=[];for(const[k,E]of _)this.labels.push(k),this.outputs.push(E)}static interpolationFactor(s,d,f,y){let _=0;if(s.name==="exponential")_=fy(d,s.base,f,y);else if(s.name==="linear")_=fy(d,1,f,y);else if(s.name==="cubic-bezier"){const k=s.controlPoints;_=new J(k[0],k[1],k[2],k[3]).solve(fy(d,1,f,y))}return _}static parse(s,d){let[f,y,_,...k]=s;if(!Array.isArray(y)||y.length===0)return d.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){const M=y[1];if(typeof M!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:M}}else{if(y[0]!=="cubic-bezier")return d.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const M=y.slice(1);if(M.length!==4||M.some(F=>typeof F!="number"||F<0||F>1))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:M}}}if(s.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(_=d.parse(_,2,qt),!_)return null;const E=[];let N=null;f==="interpolate-hcl"||f==="interpolate-lab"?N=gi:d.expectedType&&d.expectedType.kind!=="value"&&(N=d.expectedType);for(let M=0;M<k.length;M+=2){const F=k[M],q=k[M+1],X=M+3,te=M+4;if(typeof F!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(E.length&&E[E.length-1][0]>=F)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);const ie=d.parse(q,te,N);if(!ie)return null;N=N||ie.type,E.push([F,ie])}return N.kind==="number"||N.kind==="color"||N.kind==="array"&&N.itemType.kind==="number"&&typeof N.N=="number"?new Tf(N,f,y,_,E):d.error(`Type ${an(N)} is not interpolatable.`)}evaluate(s){const d=this.labels,f=this.outputs;if(d.length===1)return f[0].evaluate(s);const y=this.input.evaluate(s);if(y<=d[0])return f[0].evaluate(s);const _=d.length;if(y>=d[_-1])return f[_-1].evaluate(s);const k=Eu(d,y),E=Tf.interpolationFactor(this.interpolation,y,d[k],d[k+1]),N=f[k].evaluate(s),M=f[k+1].evaluate(s);return this.operator==="interpolate"?de[this.type.kind.toLowerCase()](N,M,E):this.operator==="interpolate-hcl"?Rd.reverse(Rd.interpolate(Rd.forward(N),Rd.forward(M),E)):kf.reverse(kf.interpolate(kf.forward(N),kf.forward(M),E))}eachChild(s){s(this.input);for(const d of this.outputs)s(d)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const d=[this.operator,s,this.input.serialize()];for(let f=0;f<this.labels.length;f++)d.push(this.labels[f],this.outputs[f].serialize());return d}}function fy(c,s,d,f){const y=f-d,_=c-d;return y===0?0:s===1?_/y:(Math.pow(s,_)-1)/(Math.pow(s,y)-1)}var Uo=Tf;class am{constructor(s,d){this.type=s,this.args=d}static parse(s,d){if(s.length<2)return d.error("Expectected at least one argument.");let f=null;const y=d.expectedType;y&&y.kind!=="value"&&(f=y);const _=[];for(const E of s.slice(1)){const N=d.parse(E,1+_.length,f,void 0,{typeAnnotation:"omit"});if(!N)return null;f=f||N.type,_.push(N)}const k=y&&_.some(E=>lo(y,E.type));return new am(k?Sr:f,_)}evaluate(s){let d,f=null,y=0;for(const _ of this.args){if(y++,f=_.evaluate(s),f&&f instanceof Wa&&!f.available&&(d||(d=f),f=null,y===this.args.length))return d;if(f!==null)break}return f}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(d=>{s.push(d.serialize())}),s}}var py=am;class sm{constructor(s,d){this.type=d.type,this.bindings=[].concat(s),this.result=d}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const d of this.bindings)s(d[1]);s(this.result)}static parse(s,d){if(s.length<4)return d.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const f=[];for(let _=1;_<s.length-1;_+=2){const k=s[_];if(typeof k!="string")return d.error(`Expected string, but found ${typeof k} instead.`,_);if(/[^a-zA-Z0-9_]/.test(k))return d.error("Variable names must contain only alphanumeric characters or '_'.",_);const E=d.parse(s[_+1],_+1);if(!E)return null;f.push([k,E])}const y=d.parse(s[s.length-1],s.length-1,d.expectedType,f);return y?new sm(f,y):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[d,f]of this.bindings)s.push(d,f.serialize());return s.push(this.result.serialize()),s}}var Pb=sm;class my{constructor(s,d,f){this.type=s,this.index=d,this.input=f}static parse(s,d){if(s.length!==3)return d.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=d.parse(s[1],1,qt),y=d.parse(s[2],2,aa(d.expectedType||Sr));return f&&y?new my(y.type.itemType,f,y):null}evaluate(s){const d=this.index.evaluate(s),f=this.input.evaluate(s);if(d<0)throw new Jn(`Array index out of bounds: ${d} < 0.`);if(d>=f.length)throw new Jn(`Array index out of bounds: ${d} > ${f.length-1}.`);if(d!==Math.floor(d))throw new Jn(`Array index must be an integer, but found ${d} instead.`);return f[d]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var fE=my;class gy{constructor(s,d){this.type=Mr,this.needle=s,this.haystack=d}static parse(s,d){if(s.length!==3)return d.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=d.parse(s[1],1,Sr),y=d.parse(s[2],2,Sr);return f&&y?vc(f.type,[Mr,Dr,qt,gc,Sr])?new gy(f,y):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(f.type)} instead`):null}evaluate(s){const d=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(f==null)return!1;if(!xu(d,["boolean","string","number","null"]))throw new Jn(`Expected first argument to be of type boolean, string, number or null, but found ${an(Fn(d))} instead.`);if(!xu(f,["string","array"]))throw new Jn(`Expected second argument to be of type array or string, but found ${an(Fn(f))} instead.`);return f.indexOf(d)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var om=gy;class Sf{constructor(s,d,f){this.type=qt,this.needle=s,this.haystack=d,this.fromIndex=f}static parse(s,d){if(s.length<=2||s.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=d.parse(s[1],1,Sr),y=d.parse(s[2],2,Sr);if(!f||!y)return null;if(!vc(f.type,[Mr,Dr,qt,gc,Sr]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(f.type)} instead`);if(s.length===4){const _=d.parse(s[3],3,qt);return _?new Sf(f,y,_):null}return new Sf(f,y)}evaluate(s){const d=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!xu(d,["boolean","string","number","null"]))throw new Jn(`Expected first argument to be of type boolean, string, number or null, but found ${an(Fn(d))} instead.`);if(!xu(f,["string","array"]))throw new Jn(`Expected second argument to be of type array or string, but found ${an(Fn(f))} instead.`);if(this.fromIndex){const y=this.fromIndex.evaluate(s);return f.indexOf(d,y)}return f.indexOf(d)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Ib=Sf;class yy{constructor(s,d,f,y,_,k){this.inputType=s,this.type=d,this.input=f,this.cases=y,this.outputs=_,this.otherwise=k}static parse(s,d){if(s.length<5)return d.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return d.error("Expected an even number of arguments.");let f,y;d.expectedType&&d.expectedType.kind!=="value"&&(y=d.expectedType);const _={},k=[];for(let M=2;M<s.length-1;M+=2){let F=s[M];const q=s[M+1];Array.isArray(F)||(F=[F]);const X=d.concat(M);if(F.length===0)return X.error("Expected at least one branch label.");for(const ie of F){if(typeof ie!="number"&&typeof ie!="string")return X.error("Branch labels must be numbers or strings.");if(typeof ie=="number"&&Math.abs(ie)>Number.MAX_SAFE_INTEGER)return X.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ie=="number"&&Math.floor(ie)!==ie)return X.error("Numeric branch labels must be integer values.");if(f){if(X.checkSubtype(f,Fn(ie)))return null}else f=Fn(ie);if(_[String(ie)]!==void 0)return X.error("Branch labels must be unique.");_[String(ie)]=k.length}const te=d.parse(q,M,y);if(!te)return null;y=y||te.type,k.push(te)}const E=d.parse(s[1],1,Sr);if(!E)return null;const N=d.parse(s[s.length-1],s.length-1,y);return N?E.type.kind!=="value"&&d.concat(1).checkSubtype(f,E.type)?null:new yy(f,y,E,_,k,N):null}evaluate(s){const d=this.input.evaluate(s);return(Fn(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],d=Object.keys(this.cases).sort(),f=[],y={};for(const k of d){const E=y[this.cases[k]];E===void 0?(y[this.cases[k]]=f.length,f.push([this.cases[k],[k]])):f[E][1].push(k)}const _=k=>this.inputType.kind==="number"?Number(k):k;for(const[k,E]of f)s.push(E.length===1?_(E[0]):E.map(_)),s.push(this.outputs[k].serialize());return s.push(this.otherwise.serialize()),s}}var pE=yy;class xy{constructor(s,d,f){this.type=s,this.branches=d,this.otherwise=f}static parse(s,d){if(s.length<4)return d.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return d.error("Expected an odd number of arguments.");let f;d.expectedType&&d.expectedType.kind!=="value"&&(f=d.expectedType);const y=[];for(let k=1;k<s.length-1;k+=2){const E=d.parse(s[k],k,Mr);if(!E)return null;const N=d.parse(s[k+1],k+1,f);if(!N)return null;y.push([E,N]),f=f||N.type}const _=d.parse(s[s.length-1],s.length-1,f);return _?new xy(f,y,_):null}evaluate(s){for(const[d,f]of this.branches)if(d.evaluate(s))return f.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[d,f]of this.branches)s(d),s(f);s(this.otherwise)}outputDefined(){return this.branches.every(([s,d])=>d.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(d=>{s.push(d.serialize())}),s}}var Mb=xy;class Ef{constructor(s,d,f,y){this.type=s,this.input=d,this.beginIndex=f,this.endIndex=y}static parse(s,d){if(s.length<=2||s.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=d.parse(s[1],1,Sr),y=d.parse(s[2],2,qt);if(!f||!y)return null;if(!vc(f.type,[aa(Sr),Dr,Sr]))return d.error(`Expected first argument to be of type array or string, but found ${an(f.type)} instead`);if(s.length===4){const _=d.parse(s[3],3,qt);return _?new Ef(f.type,f,y,_):null}return new Ef(f.type,f,y)}evaluate(s){const d=this.input.evaluate(s),f=this.beginIndex.evaluate(s);if(!xu(d,["string","array"]))throw new Jn(`Expected first argument to be of type array or string, but found ${an(Fn(d))} instead.`);if(this.endIndex){const y=this.endIndex.evaluate(s);return d.slice(f,y)}return d.slice(f)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Db=Ef;function lm(c,s){return c==="=="||c==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function Ob(c,s,d,f){return f.compare(s,d)===0}function Ld(c,s,d){const f=c!=="=="&&c!=="!=";return class uX{constructor(_,k,E){this.type=Mr,this.lhs=_,this.rhs=k,this.collator=E,this.hasUntypedArgument=_.type.kind==="value"||k.type.kind==="value"}static parse(_,k){if(_.length!==3&&_.length!==4)return k.error("Expected two or three arguments.");const E=_[0];let N=k.parse(_[1],1,Sr);if(!N)return null;if(!lm(E,N.type))return k.concat(1).error(`"${E}" comparisons are not supported for type '${an(N.type)}'.`);let M=k.parse(_[2],2,Sr);if(!M)return null;if(!lm(E,M.type))return k.concat(2).error(`"${E}" comparisons are not supported for type '${an(M.type)}'.`);if(N.type.kind!==M.type.kind&&N.type.kind!=="value"&&M.type.kind!=="value")return k.error(`Cannot compare types '${an(N.type)}' and '${an(M.type)}'.`);f&&(N.type.kind==="value"&&M.type.kind!=="value"?N=new _s(M.type,[N]):N.type.kind!=="value"&&M.type.kind==="value"&&(M=new _s(N.type,[M])));let F=null;if(_.length===4){if(N.type.kind!=="string"&&M.type.kind!=="string"&&N.type.kind!=="value"&&M.type.kind!=="value")return k.error("Cannot use collator to compare non-string types.");if(F=k.parse(_[3],3,Gi),!F)return null}return new uX(N,M,F)}evaluate(_){const k=this.lhs.evaluate(_),E=this.rhs.evaluate(_);if(f&&this.hasUntypedArgument){const N=Fn(k),M=Fn(E);if(N.kind!==M.kind||N.kind!=="string"&&N.kind!=="number")throw new Jn(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${N.kind}, ${M.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const N=Fn(k),M=Fn(E);if(N.kind!=="string"||M.kind!=="string")return s(_,k,E)}return this.collator?d(_,k,E,this.collator.evaluate(_)):s(_,k,E)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[c];return this.eachChild(k=>{_.push(k.serialize())}),_}}}const mE=Ld("==",function(c,s,d){return s===d},Ob),gE=Ld("!=",function(c,s,d){return s!==d},function(c,s,d,f){return!Ob(0,s,d,f)}),yE=Ld("<",function(c,s,d){return s<d},function(c,s,d,f){return f.compare(s,d)<0}),xE=Ld(">",function(c,s,d){return s>d},function(c,s,d,f){return f.compare(s,d)>0}),vE=Ld("<=",function(c,s,d){return s<=d},function(c,s,d,f){return f.compare(s,d)<=0}),Rb=Ld(">=",function(c,s,d){return s>=d},function(c,s,d,f){return f.compare(s,d)>=0});class cm{constructor(s,d,f,y,_,k){this.type=Dr,this.number=s,this.locale=d,this.currency=f,this.unit=y,this.minFractionDigits=_,this.maxFractionDigits=k}static parse(s,d){if(s.length!==3)return d.error("Expected two arguments.");const f=d.parse(s[1],1,qt);if(!f)return null;const y=s[2];if(typeof y!="object"||Array.isArray(y))return d.error("NumberFormat options argument must be an object.");let _=null;if(y.locale&&(_=d.parse(y.locale,1,Dr),!_))return null;let k=null;if(y.currency&&(k=d.parse(y.currency,1,Dr),!k))return null;let E=null;if(y.unit&&(E=d.parse(y.unit,1,Dr),!E))return null;let N=null;if(y["min-fraction-digits"]&&(N=d.parse(y["min-fraction-digits"],1,qt),!N))return null;let M=null;return y["max-fraction-digits"]&&(M=d.parse(y["max-fraction-digits"],1,qt),!M)?null:new cm(f,_,k,E,N,M)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class zd{constructor(s){this.type=qt,this.input=s}static parse(s,d){if(s.length!==2)return d.error(`Expected 1 argument, but found ${s.length-1} instead.`);const f=d.parse(s[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?d.error(`Expected argument of type string or array, but found ${an(f.type)} instead.`):new zd(f):null}evaluate(s){const d=this.input.evaluate(s);if(typeof d=="string"||Array.isArray(d))return d.length;throw new Jn(`Expected value to be of type string or array, but found ${an(Fn(d))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(d=>{s.push(d.serialize())}),s}}const Lb={"==":mE,"!=":gE,">":xE,"<":yE,">=":Rb,"<=":vE,array:_s,at:fE,boolean:_s,case:Mb,coalesce:py,collator:wc,format:cn,image:Cd,in:om,"index-of":Ib,interpolate:Uo,"interpolate-hcl":Uo,"interpolate-lab":Uo,length:zd,let:Pb,literal:Lo,match:pE,number:_s,"number-format":cm,object:_s,slice:Db,step:C,string:_s,"to-boolean":Tl,"to-color":Tl,"to-number":Tl,"to-string":Tl,var:wf,within:Tu};function zb(c,[s,d,f,y]){s=s.evaluate(c),d=d.evaluate(c),f=f.evaluate(c);const _=y?y.evaluate(c):1,k=uo(s,d,f,_);if(k)throw new Jn(k);return new $n(s/255*_,d/255*_,f/255*_,_)}function Cl(c,s){return c in s}function um(c,s){const d=s[c];return d===void 0?null:d}function $s(c){return{type:c}}zi.register(Lb,{error:[{kind:"error"},[Dr],(c,[s])=>{throw new Jn(s.evaluate(c))}],typeof:[Dr,[Sr],(c,[s])=>an(Fn(s.evaluate(c)))],"to-rgba":[aa(qt,4),[gi],(c,[s])=>s.evaluate(c).toArray()],rgb:[gi,[qt,qt,qt],zb],rgba:[gi,[qt,qt,qt,qt],zb],has:{type:Mr,overloads:[[[Dr],(c,[s])=>Cl(s.evaluate(c),c.properties())],[[Dr,yi],(c,[s,d])=>Cl(s.evaluate(c),d.evaluate(c))]]},get:{type:Sr,overloads:[[[Dr],(c,[s])=>um(s.evaluate(c),c.properties())],[[Dr,yi],(c,[s,d])=>um(s.evaluate(c),d.evaluate(c))]]},"feature-state":[Sr,[Dr],(c,[s])=>um(s.evaluate(c),c.featureState||{})],properties:[yi,[],c=>c.properties()],"geometry-type":[Dr,[],c=>c.geometryType()],id:[Sr,[],c=>c.id()],zoom:[qt,[],c=>c.globals.zoom],pitch:[qt,[],c=>c.globals.pitch||0],"distance-from-center":[qt,[],c=>c.distanceFromCenter()],"heatmap-density":[qt,[],c=>c.globals.heatmapDensity||0],"line-progress":[qt,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[qt,[],c=>c.globals.skyRadialProgress||0],accumulated:[Sr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[qt,$s(qt),(c,s)=>{let d=0;for(const f of s)d+=f.evaluate(c);return d}],"*":[qt,$s(qt),(c,s)=>{let d=1;for(const f of s)d*=f.evaluate(c);return d}],"-":{type:qt,overloads:[[[qt,qt],(c,[s,d])=>s.evaluate(c)-d.evaluate(c)],[[qt],(c,[s])=>-s.evaluate(c)]]},"/":[qt,[qt,qt],(c,[s,d])=>s.evaluate(c)/d.evaluate(c)],"%":[qt,[qt,qt],(c,[s,d])=>s.evaluate(c)%d.evaluate(c)],ln2:[qt,[],()=>Math.LN2],pi:[qt,[],()=>Math.PI],e:[qt,[],()=>Math.E],"^":[qt,[qt,qt],(c,[s,d])=>Math.pow(s.evaluate(c),d.evaluate(c))],sqrt:[qt,[qt],(c,[s])=>Math.sqrt(s.evaluate(c))],log10:[qt,[qt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN10],ln:[qt,[qt],(c,[s])=>Math.log(s.evaluate(c))],log2:[qt,[qt],(c,[s])=>Math.log(s.evaluate(c))/Math.LN2],sin:[qt,[qt],(c,[s])=>Math.sin(s.evaluate(c))],cos:[qt,[qt],(c,[s])=>Math.cos(s.evaluate(c))],tan:[qt,[qt],(c,[s])=>Math.tan(s.evaluate(c))],asin:[qt,[qt],(c,[s])=>Math.asin(s.evaluate(c))],acos:[qt,[qt],(c,[s])=>Math.acos(s.evaluate(c))],atan:[qt,[qt],(c,[s])=>Math.atan(s.evaluate(c))],min:[qt,$s(qt),(c,s)=>Math.min(...s.map(d=>d.evaluate(c)))],max:[qt,$s(qt),(c,s)=>Math.max(...s.map(d=>d.evaluate(c)))],abs:[qt,[qt],(c,[s])=>Math.abs(s.evaluate(c))],round:[qt,[qt],(c,[s])=>{const d=s.evaluate(c);return d<0?-Math.round(-d):Math.round(d)}],floor:[qt,[qt],(c,[s])=>Math.floor(s.evaluate(c))],ceil:[qt,[qt],(c,[s])=>Math.ceil(s.evaluate(c))],"filter-==":[Mr,[Dr,Sr],(c,[s,d])=>c.properties()[s.value]===d.value],"filter-id-==":[Mr,[Sr],(c,[s])=>c.id()===s.value],"filter-type-==":[Mr,[Dr],(c,[s])=>c.geometryType()===s.value],"filter-<":[Mr,[Dr,Sr],(c,[s,d])=>{const f=c.properties()[s.value],y=d.value;return typeof f==typeof y&&f<y}],"filter-id-<":[Mr,[Sr],(c,[s])=>{const d=c.id(),f=s.value;return typeof d==typeof f&&d<f}],"filter->":[Mr,[Dr,Sr],(c,[s,d])=>{const f=c.properties()[s.value],y=d.value;return typeof f==typeof y&&f>y}],"filter-id->":[Mr,[Sr],(c,[s])=>{const d=c.id(),f=s.value;return typeof d==typeof f&&d>f}],"filter-<=":[Mr,[Dr,Sr],(c,[s,d])=>{const f=c.properties()[s.value],y=d.value;return typeof f==typeof y&&f<=y}],"filter-id-<=":[Mr,[Sr],(c,[s])=>{const d=c.id(),f=s.value;return typeof d==typeof f&&d<=f}],"filter->=":[Mr,[Dr,Sr],(c,[s,d])=>{const f=c.properties()[s.value],y=d.value;return typeof f==typeof y&&f>=y}],"filter-id->=":[Mr,[Sr],(c,[s])=>{const d=c.id(),f=s.value;return typeof d==typeof f&&d>=f}],"filter-has":[Mr,[Sr],(c,[s])=>s.value in c.properties()],"filter-has-id":[Mr,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Mr,[aa(Dr)],(c,[s])=>s.value.indexOf(c.geometryType())>=0],"filter-id-in":[Mr,[aa(Sr)],(c,[s])=>s.value.indexOf(c.id())>=0],"filter-in-small":[Mr,[Dr,aa(Sr)],(c,[s,d])=>d.value.indexOf(c.properties()[s.value])>=0],"filter-in-large":[Mr,[Dr,aa(Sr)],(c,[s,d])=>function(f,y,_,k){for(;_<=k;){const E=_+k>>1;if(y[E]===f)return!0;y[E]>f?k=E-1:_=E+1}return!1}(c.properties()[s.value],d.value,0,d.value.length-1)],all:{type:Mr,overloads:[[[Mr,Mr],(c,[s,d])=>s.evaluate(c)&&d.evaluate(c)],[$s(Mr),(c,s)=>{for(const d of s)if(!d.evaluate(c))return!1;return!0}]]},any:{type:Mr,overloads:[[[Mr,Mr],(c,[s,d])=>s.evaluate(c)||d.evaluate(c)],[$s(Mr),(c,s)=>{for(const d of s)if(d.evaluate(c))return!0;return!1}]]},"!":[Mr,[Mr],(c,[s])=>!s.evaluate(c)],"is-supported-script":[Mr,[Dr],(c,[s])=>{const d=c.globals&&c.globals.isSupportedScript;return!d||d(s.evaluate(c))}],upcase:[Dr,[Dr],(c,[s])=>s.evaluate(c).toUpperCase()],downcase:[Dr,[Dr],(c,[s])=>s.evaluate(c).toLowerCase()],concat:[Dr,$s(Sr),(c,s)=>s.map(d=>Ro(d.evaluate(c))).join("")],"resolved-locale":[Dr,[Gi],(c,[s])=>s.evaluate(c).resolvedLocale()]});var jf=Lb;function $b(c){return{result:"success",value:c}}function ju(c){return{result:"error",value:c}}function $d(c){return c["property-type"]==="data-driven"}function dm(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function hm(c){return!!c.expression&&c.expression.interpolated}function Kr(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function Af(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function Fb(c){return c}function fm(c,s){const d=s.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",y=f||!(f||c.property!==void 0),_=c.type||(hm(s)?"exponential":"interval");if(d&&((c=Ls({},c)).stops&&(c.stops=c.stops.map(M=>[M[0],$n.parse(M[1])])),c.default=$n.parse(c.default?c.default:s.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!hy[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let k,E,N;if(_==="exponential")k=Pl;else if(_==="interval")k=pm;else if(_==="categorical"){k=Bb,E=Object.create(null);for(const M of c.stops)E[M[0]]=M[1];N=typeof c.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);k=Vb}if(f){const M={},F=[];for(let te=0;te<c.stops.length;te++){const ie=c.stops[te],fe=ie[0].zoom;M[fe]===void 0&&(M[fe]={zoom:fe,type:c.type,property:c.property,default:c.default,stops:[]},F.push(fe)),M[fe].stops.push([ie[0].value,ie[1]])}const q=[];for(const te of F)q.push([M[te].zoom,fm(M[te],s)]);const X={name:"linear"};return{kind:"composite",interpolationType:X,interpolationFactor:Uo.interpolationFactor.bind(void 0,X),zoomStops:q.map(te=>te[0]),evaluate:({zoom:te},ie)=>Pl({stops:q,base:c.base},s,te).evaluate(te,ie)}}if(y){const M=_==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Uo.interpolationFactor.bind(void 0,M),zoomStops:c.stops.map(F=>F[0]),evaluate:({zoom:F})=>k(c,s,F,E,N)}}return{kind:"source",evaluate(M,F){const q=F&&F.properties?F.properties[c.property]:void 0;return q===void 0?Fd(c.default,s.default):k(c,s,q,E,N)}}}function Fd(c,s,d){return c!==void 0?c:s!==void 0?s:d!==void 0?d:void 0}function Bb(c,s,d,f,y){return Fd(typeof d===y?f[d]:void 0,c.default,s.default)}function pm(c,s,d){if(Kr(d)!=="number")return Fd(c.default,s.default);const f=c.stops.length;if(f===1||d<=c.stops[0][0])return c.stops[0][1];if(d>=c.stops[f-1][0])return c.stops[f-1][1];const y=Eu(c.stops.map(_=>_[0]),d);return c.stops[y][1]}function Pl(c,s,d){const f=c.base!==void 0?c.base:1;if(Kr(d)!=="number")return Fd(c.default,s.default);const y=c.stops.length;if(y===1||d<=c.stops[0][0])return c.stops[0][1];if(d>=c.stops[y-1][0])return c.stops[y-1][1];const _=Eu(c.stops.map(F=>F[0]),d),k=function(F,q,X,te){const ie=te-X,fe=F-X;return ie===0?0:q===1?fe/ie:(Math.pow(q,fe)-1)/(Math.pow(q,ie)-1)}(d,f,c.stops[_][0],c.stops[_+1][0]),E=c.stops[_][1],N=c.stops[_+1][1];let M=de[s.type]||Fb;if(c.colorSpace&&c.colorSpace!=="rgb"){const F=hy[c.colorSpace];M=(q,X)=>F.reverse(F.interpolate(F.forward(q),F.forward(X),k))}return typeof E.evaluate=="function"?{evaluate(...F){const q=E.evaluate.apply(void 0,F),X=N.evaluate.apply(void 0,F);if(q!==void 0&&X!==void 0)return M(q,X,k)}}:M(E,N,k)}function Vb(c,s,d){return s.type==="color"?d=$n.parse(d):s.type==="formatted"?d=_a.fromString(d.toString()):s.type==="resolvedImage"?d=Wa.fromString(d.toString()):Kr(d)===s.type||s.type==="enum"&&s.values[d]||(d=void 0),Fd(d,c.default,s.default)}class mm{constructor(s,d){this.expression=s,this._warningHistory={},this._evaluator=new bc,this._defaultValue=d?function(f){return f.type==="color"&&(Af(f.default)||Array.isArray(f.default))?new $n(0,0,0,0):f.type==="color"?$n.parse(f.default)||null:f.default===void 0?null:f.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null}evaluateWithoutErrorHandling(s,d,f,y,_,k,E,N){return this._evaluator.globals=s,this._evaluator.feature=d,this._evaluator.featureState=f,this._evaluator.canonical=y||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=k,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=N||null,this.expression.evaluate(this._evaluator)}evaluate(s,d,f,y,_,k,E,N){this._evaluator.globals=s,this._evaluator.feature=d||null,this._evaluator.featureState=f||null,this._evaluator.canonical=y||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=k||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=N||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new Jn(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function Bd(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in jf}function Vd(c,s){const d=new oa(jf,[],s?function(y){const _={color:gi,string:Dr,number:qt,enum:Dr,boolean:Mr,formatted:yc,resolvedImage:tn};return y.type==="array"?aa(_[y.value]||Sr,y.length):_[y.type]}(s):void 0),f=d.parse(c,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?$b(new mm(f,s)):ju(d.errors)}class vy{constructor(s,d){this.kind=s,this._styleExpression=d,this.isStateDependent=s!=="constant"&&!zs(d.expression)}evaluateWithoutErrorHandling(s,d,f,y,_,k){return this._styleExpression.evaluateWithoutErrorHandling(s,d,f,y,_,k)}evaluate(s,d,f,y,_,k){return this._styleExpression.evaluate(s,d,f,y,_,k)}}class Nf{constructor(s,d,f,y){this.kind=s,this.zoomStops=f,this._styleExpression=d,this.isStateDependent=s!=="camera"&&!zs(d.expression),this.interpolationType=y}evaluateWithoutErrorHandling(s,d,f,y,_,k){return this._styleExpression.evaluateWithoutErrorHandling(s,d,f,y,_,k)}evaluate(s,d,f,y,_,k){return this._styleExpression.evaluate(s,d,f,y,_,k)}interpolationFactor(s,d,f){return this.interpolationType?Uo.interpolationFactor(this.interpolationType,s,d,f):0}}function Cf(c,s){if((c=Vd(c,s)).result==="error")return c;const d=c.value.expression,f=Ha(d);if(!f&&!$d(s))return ju([new xs("","data expressions not supported")]);const y=Fo(d,["zoom","pitch","distance-from-center"]);if(!y&&!dm(s))return ju([new xs("","zoom expressions not supported")]);const _=ym(d);return _||y?_ instanceof xs?ju([_]):_ instanceof Uo&&!hm(s)?ju([new xs("",'"interpolate" expressions cannot be used with this property')]):$b(_?new Nf(f?"camera":"composite",c.value,_.labels,_ instanceof Uo?_.interpolation:void 0):new vy(f?"constant":"source",c.value)):ju([new xs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class gm{constructor(s,d){this._parameters=s,this._specification=d,Ls(this,fm(this._parameters,this._specification))}static deserialize(s){return new gm(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function ym(c){let s=null;if(c instanceof Pb)s=ym(c.result);else if(c instanceof py){for(const d of c.args)if(s=ym(d),s)break}else(c instanceof C||c instanceof Uo)&&c.input instanceof zi&&c.input.name==="zoom"&&(s=c);return s instanceof xs||c.eachChild(d=>{const f=ym(d);f instanceof xs?s=f:!s&&f?s=new xs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&f&&s!==f&&(s=new xs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}class Kt{constructor(s,d,f,y){this.message=(s?`${s}: `:"")+f,y&&(this.identifier=y),d!=null&&d.__line__&&(this.line=d.__line__)}}function po(c){const s=c.key,d=c.value,f=c.valueSpec||{},y=c.objectElementValidators||{},_=c.style,k=c.styleSpec;let E=[];const N=Kr(d);if(N!=="object")return[new Kt(s,d,`object expected, ${N} found`)];for(const M in d){const F=M.split(".")[0];let q;y[F]?q=y[F]:f[F]?q=ba:y["*"]?q=y["*"]:f["*"]&&(q=ba),q?E=E.concat(q({key:(s&&`${s}.`)+M,value:d[M],valueSpec:f[F]||f["*"],style:_,styleSpec:k,object:d,objectKey:M},d)):E.push(new Kt(s,d[M],`unknown property "${M}"`))}for(const M in f)y[M]||f[M].required&&f[M].default===void 0&&d[M]===void 0&&E.push(new Kt(s,d,`missing required property "${M}"`));return E}function Ub(c){const s=c.value,d=c.valueSpec,f=c.style,y=c.styleSpec,_=c.key,k=c.arrayElementValidator||ba;if(Kr(s)!=="array")return[new Kt(_,s,`array expected, ${Kr(s)} found`)];if(d.length&&s.length!==d.length)return[new Kt(_,s,`array length ${d.length} expected, length ${s.length} found`)];if(d["min-length"]&&s.length<d["min-length"])return[new Kt(_,s,`array length at least ${d["min-length"]} expected, length ${s.length} found`)];let E={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};y.$version<7&&(E.function=d.function),Kr(d.value)==="object"&&(E=d.value);let N=[];for(let M=0;M<s.length;M++)N=N.concat(k({array:s,arrayIndex:M,value:s[M],valueSpec:E,style:f,styleSpec:y,key:`${_}[${M}]`}));return N}function Pf(c){const s=c.key,d=c.value,f=c.valueSpec;let y=Kr(d);if(y==="number"&&d!=d&&(y="NaN"),y!=="number")return[new Kt(s,d,`number expected, ${y} found`)];if("minimum"in f){let _=f.minimum;if(Kr(f.minimum)==="array"&&(_=f.minimum[c.arrayIndex]),d<_)return[new Kt(s,d,`${d} is less than the minimum value ${_}`)]}if("maximum"in f){let _=f.maximum;if(Kr(f.maximum)==="array"&&(_=f.maximum[c.arrayIndex]),d>_)return[new Kt(s,d,`${d} is greater than the maximum value ${_}`)]}return[]}function If(c){const s=c.valueSpec,d=qn(c.value.type);let f,y,_,k={};const E=d!=="categorical"&&c.value.property===void 0,N=!E,M=Kr(c.value.stops)==="array"&&Kr(c.value.stops[0])==="array"&&Kr(c.value.stops[0][0])==="object",F=po({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(te){if(d==="identity")return[new Kt(te.key,te.value,'identity function may not have a "stops" property')];let ie=[];const fe=te.value;return ie=ie.concat(Ub({key:te.key,value:fe,valueSpec:te.valueSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:q})),Kr(fe)==="array"&&fe.length===0&&ie.push(new Kt(te.key,fe,"array must have at least one stop")),ie},default:function(te){return ba({key:te.key,value:te.value,valueSpec:s,style:te.style,styleSpec:te.styleSpec})}}});return d==="identity"&&E&&F.push(new Kt(c.key,c.value,'missing required property "property"')),d==="identity"||c.value.stops||F.push(new Kt(c.key,c.value,'missing required property "stops"')),d==="exponential"&&c.valueSpec.expression&&!hm(c.valueSpec)&&F.push(new Kt(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(N&&!$d(c.valueSpec)?F.push(new Kt(c.key,c.value,"property functions not supported")):E&&!dm(c.valueSpec)&&F.push(new Kt(c.key,c.value,"zoom functions not supported"))),d!=="categorical"&&!M||c.value.property!==void 0||F.push(new Kt(c.key,c.value,'"property" property is required')),F;function q(te){let ie=[];const fe=te.value,ge=te.key;if(Kr(fe)!=="array")return[new Kt(ge,fe,`array expected, ${Kr(fe)} found`)];if(fe.length!==2)return[new Kt(ge,fe,`array length 2 expected, length ${fe.length} found`)];if(M){if(Kr(fe[0])!=="object")return[new Kt(ge,fe,`object expected, ${Kr(fe[0])} found`)];if(fe[0].zoom===void 0)return[new Kt(ge,fe,"object stop key must have zoom")];if(fe[0].value===void 0)return[new Kt(ge,fe,"object stop key must have value")];const je=qn(fe[0].zoom);if(typeof je!="number")return[new Kt(ge,fe[0].zoom,"stop zoom values must be numbers")];if(_&&_>je)return[new Kt(ge,fe[0].zoom,"stop zoom values must appear in ascending order")];je!==_&&(_=je,y=void 0,k={}),ie=ie.concat(po({key:`${ge}[0]`,value:fe[0],valueSpec:{zoom:{}},style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:Pf,value:X}}))}else ie=ie.concat(X({key:`${ge}[0]`,value:fe[0],valueSpec:{},style:te.style,styleSpec:te.styleSpec},fe));return Bd(ci(fe[1]))?ie.concat([new Kt(`${ge}[1]`,fe[1],"expressions are not allowed in function stops.")]):ie.concat(ba({key:`${ge}[1]`,value:fe[1],valueSpec:s,style:te.style,styleSpec:te.styleSpec}))}function X(te,ie){const fe=Kr(te.value),ge=qn(te.value),je=te.value!==null?te.value:ie;if(f){if(fe!==f)return[new Kt(te.key,je,`${fe} stop domain type must match previous stop domain type ${f}`)]}else f=fe;if(fe!=="number"&&fe!=="string"&&fe!=="boolean"&&typeof ge!="number"&&typeof ge!="string"&&typeof ge!="boolean")return[new Kt(te.key,je,"stop domain value must be a number, string, or boolean")];if(fe!=="number"&&d!=="categorical"){let Re=`number expected, ${fe} found`;return $d(s)&&d===void 0&&(Re+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Kt(te.key,je,Re)]}return d!=="categorical"||fe!=="number"||typeof ge=="number"&&isFinite(ge)&&Math.floor(ge)===ge?d!=="categorical"&&fe==="number"&&typeof ge=="number"&&typeof y=="number"&&y!==void 0&&ge<y?[new Kt(te.key,je,"stop domain values must appear in ascending order")]:(y=ge,d==="categorical"&&ge in k?[new Kt(te.key,je,"stop domain values must be unique")]:(k[ge]=!0,[])):[new Kt(te.key,je,`integer expected, found ${String(ge)}`)]}}function Hi(c){const s=(c.expressionContext==="property"?Cf:Vd)(ci(c.value),c.valueSpec);if(s.result==="error")return s.value.map(f=>new Kt(`${c.key}${f.key}`,c.value,f.message));const d=s.value.expression||s.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!d.outputDefined())return[new Kt(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!zs(d))return[new Kt(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter")return Mf(d,c);if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Fo(d,["zoom","feature-state"]))return[new Kt(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!Ha(d))return[new Kt(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Mf(c,s){const d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const y of s.valueSpec.expression.parameters)d.delete(y);if(d.size===0)return[];const f=[];return c instanceof zi&&d.has(c.name)?[new Kt(s.key,s.value,`["${c.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(c.eachChild(y=>{f.push(...Mf(y,s))}),f)}function xm(c){const s=c.key,d=c.value,f=c.valueSpec,y=[];return Array.isArray(f.values)?f.values.indexOf(qn(d))===-1&&y.push(new Kt(s,d,`expected one of [${f.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(f.values).indexOf(qn(d))===-1&&y.push(new Kt(s,d,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(d)} found`)),y}function _y(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const s of c.slice(1))if(!_y(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}function vm(c,s="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};_y(c)||(c=qd(c));const d=c;let f=!0;try{f=function(M){if(!Ud(M))return M;let F=ci(M);return _m(F),F=qb(F),F}(d)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(d,null,2)}
        `)}const y=lt[`filter_${s}`],_=Vd(f,y);let k=null;if(_.result==="error")throw new Error(_.value.map(M=>`${M.key}: ${M.message}`).join(", "));k=(M,F,q)=>_.value.evaluate(M,F,{},q);let E=null,N=null;if(f!==d){const M=Vd(d,y);if(M.result==="error")throw new Error(M.value.map(F=>`${F.key}: ${F.message}`).join(", "));E=(F,q,X,te,ie)=>M.value.evaluate(F,q,{},X,void 0,void 0,te,ie),N=!Ha(M.value.expression)}return{filter:k,dynamicFilter:E||void 0,needGeometry:Gb(f),needFeature:!!N}}function qb(c){if(!Array.isArray(c))return c;const s=function(d){if(by.has(d[0])){for(let f=1;f<d.length;f++)if(Ud(d[f]))return!0}return d}(c);return s===!0?s:s.map(d=>qb(d))}function _m(c){let s=!1;const d=[];if(c[0]==="case"){for(let f=1;f<c.length-1;f+=2)s=s||Ud(c[f]),d.push(c[f+1]);d.push(c[c.length-1])}else if(c[0]==="match"){s=s||Ud(c[1]);for(let f=2;f<c.length-1;f+=2)d.push(c[f+1]);d.push(c[c.length-1])}else if(c[0]==="step"){s=s||Ud(c[1]);for(let f=1;f<c.length-1;f+=2)d.push(c[f+1])}s&&(c.length=0,c.push("any",...d));for(let f=1;f<c.length;f++)_m(c[f])}function Ud(c){if(!Array.isArray(c))return!1;if((s=c[0])==="pitch"||s==="distance-from-center")return!0;var s;for(let d=1;d<c.length;d++)if(Ud(c[d]))return!0;return!1}const by=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function _E(c,s){return c<s?-1:c>s?1:0}function Gb(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let s=1;s<c.length;s++)if(Gb(c[s]))return!0;return!1}function qd(c){if(!c)return!0;const s=c[0];return c.length<=1?s!=="any":s==="=="?wy(c[1],c[2],"=="):s==="!="?bm(wy(c[1],c[2],"==")):s==="<"||s===">"||s==="<="||s===">="?wy(c[1],c[2],s):s==="any"?(d=c.slice(1),["any"].concat(d.map(qd))):s==="all"?["all"].concat(c.slice(1).map(qd)):s==="none"?["all"].concat(c.slice(1).map(qd).map(bm)):s==="in"?ky(c[1],c.slice(2)):s==="!in"?bm(ky(c[1],c.slice(2))):s==="has"?Ty(c[1]):s==="!has"?bm(Ty(c[1])):s!=="within"||c;var d}function wy(c,s,d){switch(c){case"$type":return[`filter-type-${d}`,s];case"$id":return[`filter-id-${d}`,s];default:return[`filter-${d}`,c,s]}}function ky(c,s){if(s.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(d=>typeof d!=typeof s[0])?["filter-in-large",c,["literal",s.sort(_E)]]:["filter-in-small",c,["literal",s]]}}function Ty(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function bm(c){return["!",c]}function Df(c){return _y(ci(c.value))?Hi(Ls({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${c.layerType||"fill"}`]})):Of(c)}function Of(c){const s=c.value,d=c.key;if(Kr(s)!=="array")return[new Kt(d,s,`array expected, ${Kr(s)} found`)];const f=c.styleSpec;let y,_=[];if(s.length<1)return[new Kt(d,s,"filter array must have at least 1 element")];switch(_=_.concat(xm({key:`${d}[0]`,value:s[0],valueSpec:f.filter_operator,style:c.style,styleSpec:c.styleSpec})),qn(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&qn(s[1])==="$type"&&_.push(new Kt(d,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&_.push(new Kt(d,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(y=Kr(s[1]),y!=="string"&&_.push(new Kt(`${d}[1]`,s[1],`string expected, ${y} found`)));for(let k=2;k<s.length;k++)y=Kr(s[k]),qn(s[1])==="$type"?_=_.concat(xm({key:`${d}[${k}]`,value:s[k],valueSpec:f.geometry_type,style:c.style,styleSpec:c.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&_.push(new Kt(`${d}[${k}]`,s[k],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let k=1;k<s.length;k++)_=_.concat(Of({key:`${d}[${k}]`,value:s[k],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":y=Kr(s[1]),s.length!==2?_.push(new Kt(d,s,`filter array for "${s[0]}" operator must have 2 elements`)):y!=="string"&&_.push(new Kt(`${d}[1]`,s[1],`string expected, ${y} found`));break;case"within":y=Kr(s[1]),s.length!==2?_.push(new Kt(d,s,`filter array for "${s[0]}" operator must have 2 elements`)):y!=="object"&&_.push(new Kt(`${d}[1]`,s[1],`object expected, ${y} found`))}return _}function Sy(c,s){const d=c.key,f=c.style,y=c.styleSpec,_=c.value,k=c.objectKey,E=y[`${s}_${c.layerType}`];if(!E)return[];const N=k.match(/^(.*)-transition$/);if(s==="paint"&&N&&E[N[1]]&&E[N[1]].transition)return ba({key:d,value:_,valueSpec:y.transition,style:f,styleSpec:y});const M=c.valueSpec||E[k];if(!M)return[new Kt(d,_,`unknown property "${k}"`)];let F;if(Kr(_)==="string"&&$d(M)&&!M.tokens&&(F=/^{([^}]+)}$/.exec(_))){const X=`\`{ "type": "identity", "property": ${F?JSON.stringify(F[1]):'"_"'} }\``;return[new Kt(d,_,`"${k}" does not support interpolation syntax
Use an identity property function instead: ${X}.`)]}const q=[];return c.layerType==="symbol"&&(k==="text-field"&&f&&!f.glyphs&&q.push(new Kt(d,_,'use of "text-field" requires a style "glyphs" property')),k==="text-font"&&Af(ci(_))&&qn(_.type)==="identity"&&q.push(new Kt(d,_,'"text-font" does not support identity functions'))),q.concat(ba({key:c.key,value:_,valueSpec:M,style:f,styleSpec:y,expressionContext:"property",propertyType:s,propertyKey:k}))}function Wb(c){return Sy(c,"paint")}function Ey(c){return Sy(c,"layout")}function Hb(c){let s=[];const d=c.value,f=c.key,y=c.style,_=c.styleSpec;d.type||d.ref||s.push(new Kt(f,d,'either "type" or "ref" is required'));let k=qn(d.type);const E=qn(d.ref);if(d.id){const N=qn(d.id);for(let M=0;M<c.arrayIndex;M++){const F=y.layers[M];qn(F.id)===N&&s.push(new Kt(f,d.id,`duplicate layer id "${d.id}", previously used at line ${F.id.__line__}`))}}if("ref"in d){let N;["type","source","source-layer","filter","layout"].forEach(M=>{M in d&&s.push(new Kt(f,d[M],`"${M}" is prohibited for ref layers`))}),y.layers.forEach(M=>{qn(M.id)===E&&(N=M)}),N?N.ref?s.push(new Kt(f,d.ref,"ref cannot reference another ref layer")):k=qn(N.type):typeof E=="string"&&s.push(new Kt(f,d.ref,`ref layer "${E}" not found`))}else if(k!=="background"&&k!=="sky")if(d.source){const N=y.sources&&y.sources[d.source],M=N&&qn(N.type);N?M==="vector"&&k==="raster"?s.push(new Kt(f,d.source,`layer "${d.id}" requires a raster source`)):M==="raster"&&k!=="raster"?s.push(new Kt(f,d.source,`layer "${d.id}" requires a vector source`)):M!=="vector"||d["source-layer"]?M==="raster-dem"&&k!=="hillshade"?s.push(new Kt(f,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!d.paint||!d.paint["line-gradient"]&&!d.paint["line-trim-offset"]||M==="geojson"&&N.lineMetrics||s.push(new Kt(f,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new Kt(f,d,`layer "${d.id}" must specify a "source-layer"`)):s.push(new Kt(f,d.source,`source "${d.source}" not found`))}else s.push(new Kt(f,d,'missing required property "source"'));return s=s.concat(po({key:f,value:d,valueSpec:_.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ba({key:`${f}.type`,value:d.type,valueSpec:_.layer.type,style:c.style,styleSpec:c.styleSpec,object:d,objectKey:"type"}),filter:N=>Df(Ls({layerType:k},N)),layout:N=>po({layer:d,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":M=>Ey(Ls({layerType:k},M))}}),paint:N=>po({layer:d,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":M=>Wb(Ls({layerType:k},M))}})}})),s}function Sc(c){const s=c.value,d=c.key,f=Kr(s);return f!=="string"?[new Kt(d,s,`string expected, ${f} found`)]:[]}const Kb={promoteId:function({key:c,value:s}){if(Kr(s)==="string")return Sc({key:c,value:s});{const d=[];for(const f in s)d.push(...Sc({key:`${c}.${f}`,value:s[f]}));return d}}};function Zb(c){const s=c.value,d=c.key,f=c.styleSpec,y=c.style;if(!s.type)return[new Kt(d,s,'"type" is required')];const _=qn(s.type);let k;switch(_){case"vector":case"raster":case"raster-dem":return k=po({key:d,value:s,valueSpec:f[`source_${_.replace("-","_")}`],style:c.style,styleSpec:f,objectElementValidators:Kb}),k;case"geojson":if(k=po({key:d,value:s,valueSpec:f.source_geojson,style:y,styleSpec:f,objectElementValidators:Kb}),s.cluster)for(const E in s.clusterProperties){const[N,M]=s.clusterProperties[E],F=typeof N=="string"?[N,["accumulated"],["get",E]]:N;k.push(...Hi({key:`${d}.${E}.map`,value:M,expressionContext:"cluster-map"})),k.push(...Hi({key:`${d}.${E}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return k;case"video":return po({key:d,value:s,valueSpec:f.source_video,style:y,styleSpec:f});case"image":return po({key:d,value:s,valueSpec:f.source_image,style:y,styleSpec:f});case"canvas":return[new Kt(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return xm({key:`${d}.type`,value:s.type,valueSpec:{values:bE(f)},style:y,styleSpec:f})}}function bE(c){return c.source.reduce((s,d)=>{const f=c[d];return f.type.type==="enum"&&(s=s.concat(Object.keys(f.type.values))),s},[])}function Xb(c){const s=c.value,d=c.styleSpec,f=d.light,y=c.style;let _=[];const k=Kr(s);if(s===void 0)return _;if(k!=="object")return _=_.concat([new Kt("light",s,`object expected, ${k} found`)]),_;for(const E in s){const N=E.match(/^(.*)-transition$/);_=_.concat(N&&f[N[1]]&&f[N[1]].transition?ba({key:E,value:s[E],valueSpec:d.transition,style:y,styleSpec:d}):f[E]?ba({key:E,value:s[E],valueSpec:f[E],style:y,styleSpec:d}):[new Kt(E,s[E],`unknown property "${E}"`)])}return _}function jy(c){const s=c.value,d=c.key,f=c.style,y=c.styleSpec,_=y.terrain;let k=[];const E=Kr(s);if(s===void 0)return k;if(E!=="object")return k=k.concat([new Kt("terrain",s,`object expected, ${E} found`)]),k;for(const N in s){const M=N.match(/^(.*)-transition$/);k=k.concat(M&&_[M[1]]&&_[M[1]].transition?ba({key:N,value:s[N],valueSpec:y.transition,style:f,styleSpec:y}):_[N]?ba({key:N,value:s[N],valueSpec:_[N],style:f,styleSpec:y}):[new Kt(N,s[N],`unknown property "${N}"`)])}if(s.source){const N=f.sources&&f.sources[s.source],M=N&&qn(N.type);N?M!=="raster-dem"&&k.push(new Kt(d,s.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):k.push(new Kt(d,s.source,`source "${s.source}" not found`))}else k.push(new Kt(d,s,'terrain is missing required property "source"'));return k}function Yb(c){const s=c.value,d=c.style,f=c.styleSpec,y=f.fog;let _=[];const k=Kr(s);if(s===void 0)return _;if(k!=="object")return _=_.concat([new Kt("fog",s,`object expected, ${k} found`)]),_;for(const E in s){const N=E.match(/^(.*)-transition$/);_=_.concat(N&&y[N[1]]&&y[N[1]].transition?ba({key:E,value:s[E],valueSpec:f.transition,style:d,styleSpec:f}):y[E]?ba({key:E,value:s[E],valueSpec:y[E],style:d,styleSpec:f}):[new Kt(E,s[E],`unknown property "${E}"`)])}return _}const Jb={"*":()=>[],array:Ub,boolean:function(c){const s=c.value,d=c.key,f=Kr(s);return f!=="boolean"?[new Kt(d,s,`boolean expected, ${f} found`)]:[]},number:Pf,color:function(c){const s=c.key,d=c.value,f=Kr(d);return f!=="string"?[new Kt(s,d,`color expected, ${f} found`)]:xf(d)===null?[new Kt(s,d,`color expected, "${d}" found`)]:[]},enum:xm,filter:Df,function:If,layer:Hb,object:po,source:Zb,light:Xb,terrain:jy,fog:Yb,string:Sc,formatted:function(c){return Sc(c).length===0?[]:Hi(c)},resolvedImage:function(c){return Sc(c).length===0?[]:Hi(c)},projection:function(c){const s=c.value,d=c.styleSpec,f=d.projection,y=c.style;let _=[];const k=Kr(s);if(k==="object")for(const E in s)_=_.concat(ba({key:E,value:s[E],valueSpec:f[E],style:y,styleSpec:d}));else k!=="string"&&(_=_.concat([new Kt("projection",s,`object or string expected, ${k} found`)]));return _}};function ba(c){const s=c.value,d=c.valueSpec,f=c.styleSpec;return d.expression&&Af(qn(s))?If(c):d.expression&&Bd(ci(s))?Hi(c):d.type&&Jb[d.type]?Jb[d.type](c):po(Ls({},c,{valueSpec:d.type?f[d.type]:d}))}function wE(c){const s=c.value,d=c.key,f=Sc(c);return f.length||(s.indexOf("{fontstack}")===-1&&f.push(new Kt(d,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&f.push(new Kt(d,s,'"glyphs" url must include a "{range}" token'))),f}function Qb(c,s=lt){return Fs(ba({key:"",value:c,valueSpec:s.$root,styleSpec:s,style:c,objectElementValidators:{glyphs:wE,"*":()=>[]}}))}const kE=c=>Fs(Wb(c)),TE=c=>Fs(Ey(c));function Fs(c){return c.slice().sort((s,d)=>s.line&&d.line?s.line-d.line:0)}function e1(c,s){let d=!1;if(s&&s.length)for(const f of s)c.fire(new ys(new Error(f.message))),d=!0;return d}var SE=qo,mo=3;function qo(c,s,d){var f=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var y=new Int32Array(this.arrayBuffer);c=y[0],this.d=(s=y[1])+2*(d=y[2]);for(var _=0;_<this.d*this.d;_++){var k=y[mo+_],E=y[mo+_+1];f.push(k===E?null:y.subarray(k,E))}var N=y[mo+f.length+1];this.keys=y.subarray(y[mo+f.length],N),this.bboxes=y.subarray(N),this.insert=this._insertReadonly}else{this.d=s+2*d;for(var M=0;M<this.d*this.d;M++)f.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=c,this.padding=d,this.scale=s/c,this.uid=0;var F=d/s*c;this.min=-F,this.max=c+F}qo.prototype.insert=function(c,s,d,f,y){this._forEachCell(s,d,f,y,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(s),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(y)},qo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},qo.prototype._insertCell=function(c,s,d,f,y,_){this.cells[y].push(_)},qo.prototype.query=function(c,s,d,f,y){var _=this.min,k=this.max;if(c<=_&&s<=_&&k<=d&&k<=f&&!y)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(c,s,d,f,this._queryCell,E,{},y),E},qo.prototype._queryCell=function(c,s,d,f,y,_,k,E){var N=this.cells[y];if(N!==null)for(var M=this.keys,F=this.bboxes,q=0;q<N.length;q++){var X=N[q];if(k[X]===void 0){var te=4*X;(E?E(F[te+0],F[te+1],F[te+2],F[te+3]):c<=F[te+2]&&s<=F[te+3]&&d>=F[te+0]&&f>=F[te+1])?(k[X]=!0,_.push(M[X])):k[X]=!1}}},qo.prototype._forEachCell=function(c,s,d,f,y,_,k,E){for(var N=this._convertToCellCoord(c),M=this._convertToCellCoord(s),F=this._convertToCellCoord(d),q=this._convertToCellCoord(f),X=N;X<=F;X++)for(var te=M;te<=q;te++){var ie=this.d*te+X;if((!E||E(this._convertFromCellCoord(X),this._convertFromCellCoord(te),this._convertFromCellCoord(X+1),this._convertFromCellCoord(te+1)))&&y.call(this,c,s,d,f,ie,_,k,E))return}},qo.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},qo.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},qo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,s=mo+this.cells.length+1+1,d=0,f=0;f<this.cells.length;f++)d+=this.cells[f].length;var y=new Int32Array(s+d+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var _=s,k=0;k<c.length;k++){var E=c[k];y[mo+k]=_,y.set(E,_),_+=E.length}return y[mo+c.length]=_,y.set(this.keys,_),y[mo+c.length+1]=_+=this.keys.length,y.set(this.bboxes,_),_+=this.bboxes.length,y.buffer};var Au=$(SE);const wm={};function Xt(c,s,d={}){Object.defineProperty(c,"_classRegistryKey",{value:s,writeable:!1}),wm[s]={klass:c,omit:d.omit||[]}}Xt(Object,"Object"),Au.serialize=function(c,s){const d=c.toArrayBuffer();return s&&s.push(d),{buffer:d}},Au.deserialize=function(c){return new Au(c.buffer)},Object.defineProperty(Au,"name",{value:"Grid"}),Xt(Au,"Grid"),Xt($n,"Color"),Xt(Error,"Error"),Xt(qa,"AJAXError"),Xt(Wa,"ResolvedImage"),Xt(gm,"StylePropertyFunction"),Xt(mm,"StyleExpression",{omit:["_evaluator"]}),Xt(Nf,"ZoomDependentExpression"),Xt(vy,"ZoomConstantExpression"),Xt(zi,"CompoundExpression",{omit:["_evaluate"]});for(const c in jf)wm[jf[c]._classRegistryKey]||Xt(jf[c],`Expression${c}`);function Ay(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function Ny(c){return p.ImageBitmap&&c instanceof p.ImageBitmap}function Gd(c,s){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Ay(c)||Ny(c))return s&&s.push(c),c;if(ArrayBuffer.isView(c)){const d=c;return s&&s.push(d.buffer),d}if(c instanceof p.ImageData)return s&&s.push(c.data.buffer),c;if(Array.isArray(c)){const d=[];for(const f of c)d.push(Gd(f,s));return d}if(typeof c=="object"){const d=c.constructor,f=d._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const y=d.serialize?d.serialize(c,s):{};if(!d.serialize){for(const _ in c)c.hasOwnProperty(_)&&(wm[f].omit.indexOf(_)>=0||(y[_]=Gd(c[_],s)));c instanceof Error&&(y.message=c.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(y.$name=f),y}throw new Error("can't serialize object of type "+typeof c)}function Nu(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Ay(c)||Ny(c)||ArrayBuffer.isView(c)||c instanceof p.ImageData)return c;if(Array.isArray(c))return c.map(Nu);if(typeof c=="object"){const s=c.$name||"Object",{klass:d}=wm[s];if(!d)throw new Error(`can't deserialize unregistered class ${s}`);if(d.deserialize)return d.deserialize(c);const f=Object.create(d.prototype);for(const y of Object.keys(c))y!=="$name"&&(f[y]=Nu(c[y]));return f}throw new Error("can't deserialize object of type "+typeof c)}const Ht={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function Cy(c){for(const s of c)if(Py(s.charCodeAt(0)))return!0;return!1}function EE(c){for(const s of c)if(!t1(s.charCodeAt(0)))return!1;return!0}function t1(c){return!(Ht.Arabic(c)||Ht["Arabic Supplement"](c)||Ht["Arabic Extended-A"](c)||Ht["Arabic Presentation Forms-A"](c)||Ht["Arabic Presentation Forms-B"](c))}function Py(c){return!(c!==746&&c!==747&&(c<4352||!(Ht["Bopomofo Extended"](c)||Ht.Bopomofo(c)||Ht["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Ht["CJK Compatibility Ideographs"](c)||Ht["CJK Compatibility"](c)||Ht["CJK Radicals Supplement"](c)||Ht["CJK Strokes"](c)||!(!Ht["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Ht["CJK Unified Ideographs Extension A"](c)||Ht["CJK Unified Ideographs"](c)||Ht["Enclosed CJK Letters and Months"](c)||Ht["Hangul Compatibility Jamo"](c)||Ht["Hangul Jamo Extended-A"](c)||Ht["Hangul Jamo Extended-B"](c)||Ht["Hangul Jamo"](c)||Ht["Hangul Syllables"](c)||Ht.Hiragana(c)||Ht["Ideographic Description Characters"](c)||Ht.Kanbun(c)||Ht["Kangxi Radicals"](c)||Ht["Katakana Phonetic Extensions"](c)||Ht.Katakana(c)&&c!==12540||!(!Ht["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Ht["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Ht["Unified Canadian Aboriginal Syllabics"](c)||Ht["Unified Canadian Aboriginal Syllabics Extended"](c)||Ht["Vertical Forms"](c)||Ht["Yijing Hexagram Symbols"](c)||Ht["Yi Syllables"](c)||Ht["Yi Radicals"](c))))}function r1(c){return!(Py(c)||function(s){return!!(Ht["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||Ht["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||Ht["Letterlike Symbols"](s)||Ht["Number Forms"](s)||Ht["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||Ht["Control Pictures"](s)&&s!==9251||Ht["Optical Character Recognition"](s)||Ht["Enclosed Alphanumerics"](s)||Ht["Geometric Shapes"](s)||Ht["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Ht["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Ht["CJK Symbols and Punctuation"](s)||Ht.Katakana(s)||Ht["Private Use Area"](s)||Ht["CJK Compatibility Forms"](s)||Ht["Small Form Variants"](s)||Ht["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(c))}function n1(c){return c>=1424&&c<=2303||Ht["Arabic Presentation Forms-A"](c)||Ht["Arabic Presentation Forms-B"](c)}function jE(c,s){return!(!s&&n1(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Ht.Khmer(c))}function AE(c){for(const s of c)if(n1(s.charCodeAt(0)))return!0;return!1}const Iy="deferred",My="loading",Dy="loaded";let Wd=null,x="unavailable",h=null;const m=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(x="error"),Wd&&Wd(c)};function b(){S.fire(new Ma("pluginStateChange",{pluginStatus:x,pluginURL:h}))}const S=new yu,j=function(){return x},R=function(){if(x!==Iy||!h)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");x=My,b(),h&&oo({url:h},c=>{c?m(c):(x=Dy,b())})},z={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>x===Dy||z.applyArabicShaping!=null,isLoading:()=>x===My,setState(c){x=c.pluginStatus,h=c.pluginURL},isParsed:()=>z.applyArabicShaping!=null&&z.processBidirectionalText!=null&&z.processStyledBidirectionalText!=null,getPluginURL:()=>h};class U{constructor(s,d){this.zoom=s,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.transition=d.transition,this.pitch=d.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(s){return function(d,f){for(const y of d)if(!jE(y.charCodeAt(0),f))return!1;return!0}(s,z.isLoaded())}}class ee{constructor(s,d){this.property=s,this.value=d,this.expression=function(f,y){if(Af(f))return new gm(f,y);if(Bd(f)){const _=Cf(f,y);if(_.result==="error")throw new Error(_.value.map(k=>`${k.key}: ${k.message}`).join(", "));return _.value}{let _=f;return typeof f=="string"&&y.type==="color"&&(_=$n.parse(f)),{kind:"constant",evaluate:()=>_}}}(d===void 0?s.specification.default:d,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,d,f){return this.property.possiblyEvaluate(this,s,d,f)}}class Q{constructor(s){this.property=s,this.value=new ee(s,void 0)}transitioned(s,d){return new me(this.property,this.value,d,Ye({},s.transition,this.transition),s.now)}untransitioned(){return new me(this.property,this.value,null,{},0)}}class ue{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return ar(this._values[s].value.value)}setValue(s,d){this._values.hasOwnProperty(s)||(this._values[s]=new Q(this._values[s].property)),this._values[s].value=new ee(this._values[s].property,d===null?void 0:ar(d))}getTransition(s){return ar(this._values[s].transition)}setTransition(s,d){this._values.hasOwnProperty(s)||(this._values[s]=new Q(this._values[s].property)),this._values[s].transition=ar(d)||void 0}serialize(){const s={};for(const d of Object.keys(this._values)){const f=this.getValue(d);f!==void 0&&(s[d]=f);const y=this.getTransition(d);y!==void 0&&(s[`${d}-transition`]=y)}return s}transitioned(s,d){const f=new _e(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].transitioned(s,d._values[y]);return f}untransitioned(){const s=new _e(this._properties);for(const d of Object.keys(this._values))s._values[d]=this._values[d].untransitioned();return s}}class me{constructor(s,d,f,y,_){const k=y.delay||0,E=y.duration||0;_=_||0,this.property=s,this.value=d,this.begin=_+k,this.end=this.begin+E,s.specification.transition&&(y.delay||y.duration)&&(this.prior=f)}possiblyEvaluate(s,d,f){const y=s.now||0,_=this.value.possiblyEvaluate(s,d,f),k=this.prior;if(k){if(y>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(y<this.begin)return k.possiblyEvaluate(s,d,f);{const E=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(k.possiblyEvaluate(s,d,f),_,oe(E))}}return _}}class _e{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,d,f){const y=new Ee(this._properties);for(const _ of Object.keys(this._values))y._values[_]=this._values[_].possiblyEvaluate(s,d,f);return y}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Te{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}getValue(s){return ar(this._values[s].value)}setValue(s,d){this._values[s]=new ee(this._values[s].property,d===null?void 0:ar(d))}serialize(){const s={};for(const d of Object.keys(this._values)){const f=this.getValue(d);f!==void 0&&(s[d]=f)}return s}possiblyEvaluate(s,d,f){const y=new Ee(this._properties);for(const _ of Object.keys(this._values))y._values[_]=this._values[_].possiblyEvaluate(s,d,f);return y}}class we{constructor(s,d,f){this.property=s,this.value=d,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,d,f,y){return this.property.evaluate(this.value,this.parameters,s,d,f,y)}}class Ee{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class he{constructor(s){this.specification=s}possiblyEvaluate(s,d){return s.expression.evaluate(d)}interpolate(s,d,f){const y=de[this.specification.type];return y?y(s,d,f):s}}class ve{constructor(s,d){this.specification=s,this.overrides=d}possiblyEvaluate(s,d,f,y){return new we(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(d,null,{},f,y)}:s.expression,d)}interpolate(s,d,f){if(s.value.kind!=="constant"||d.value.kind!=="constant")return s;if(s.value.value===void 0||d.value.value===void 0)return new we(this,{kind:"constant",value:void 0},s.parameters);const y=de[this.specification.type];return y?new we(this,{kind:"constant",value:y(s.value.value,d.value.value,f)},s.parameters):s}evaluate(s,d,f,y,_,k){return s.kind==="constant"?s.value:s.evaluate(d,f,y,_,k)}}class Pe{constructor(s){this.specification=s}possiblyEvaluate(s,d,f,y){return!!s.expression.evaluate(d,null,{},f,y)}interpolate(){return!1}}class Ie{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const d=new U(0,{});for(const f in s){const y=s[f];y.specification.overridable&&this.overridableProperties.push(f);const _=this.defaultPropertyValues[f]=new ee(y,void 0),k=this.defaultTransitionablePropertyValues[f]=new Q(y);this.defaultTransitioningPropertyValues[f]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=_.possiblyEvaluate(d)}}}function Ve(c,s){return 256*(c=ye(Math.floor(c),0,255))+ye(Math.floor(s),0,255)}Xt(ve,"DataDrivenProperty"),Xt(he,"DataConstantProperty"),Xt(Pe,"ColorRampProperty");const qe={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ue{constructor(s,d){this._structArray=s,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ke{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,d){return s._trim(),d&&(s.isTransferred=!0,d.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const d=Object.create(this.prototype);return d.arrayBuffer=s.arrayBuffer,d.length=s.length,d.capacity=s.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function He(c,s=1){let d=0,f=0;return{members:c.map(y=>{const _=qe[y.type].BYTES_PER_ELEMENT,k=d=rt(d,Math.max(s,_)),E=y.components||1;return f=Math.max(f,_),d+=_*E,{name:y.name,type:y.type,components:E,offset:k}}),size:rt(d,Math.max(f,s)),alignment:s}}function rt(c,s){return Math.ceil(c/s)*s}class At extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,d)}emplace(s,d,f){const y=2*s;return this.int16[y+0]=d,this.int16[y+1]=f,s}}At.prototype.bytesPerElement=4,Xt(At,"StructArrayLayout2i4");class Je extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f){const y=this.length;return this.resize(y+1),this.emplace(y,s,d,f)}emplace(s,d,f,y){const _=3*s;return this.int16[_+0]=d,this.int16[_+1]=f,this.int16[_+2]=y,s}}Je.prototype.bytesPerElement=6,Xt(Je,"StructArrayLayout3i6");class pt extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f,y){const _=this.length;return this.resize(_+1),this.emplace(_,s,d,f,y)}emplace(s,d,f,y,_){const k=4*s;return this.int16[k+0]=d,this.int16[k+1]=f,this.int16[k+2]=y,this.int16[k+3]=_,s}}pt.prototype.bytesPerElement=8,Xt(pt,"StructArrayLayout4i8");class at extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_,k,E){const N=this.length;return this.resize(N+1),this.emplace(N,s,d,f,y,_,k,E)}emplace(s,d,f,y,_,k,E,N){const M=6*s,F=12*s,q=3*s;return this.int16[M+0]=d,this.int16[M+1]=f,this.uint8[F+4]=y,this.uint8[F+5]=_,this.uint8[F+6]=k,this.uint8[F+7]=E,this.float32[q+2]=N,s}}at.prototype.bytesPerElement=12,Xt(at,"StructArrayLayout2i4ub1f12");class Et extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,y){const _=this.length;return this.resize(_+1),this.emplace(_,s,d,f,y)}emplace(s,d,f,y,_){const k=4*s;return this.float32[k+0]=d,this.float32[k+1]=f,this.float32[k+2]=y,this.float32[k+3]=_,s}}Et.prototype.bytesPerElement=16,Xt(Et,"StructArrayLayout4f16");class tt extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_){const k=this.length;return this.resize(k+1),this.emplace(k,s,d,f,y,_)}emplace(s,d,f,y,_,k){const E=6*s,N=3*s;return this.uint16[E+0]=d,this.uint16[E+1]=f,this.uint16[E+2]=y,this.uint16[E+3]=_,this.float32[N+2]=k,s}}tt.prototype.bytesPerElement=12,Xt(tt,"StructArrayLayout4ui1f12");class ft extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f,y){const _=this.length;return this.resize(_+1),this.emplace(_,s,d,f,y)}emplace(s,d,f,y,_){const k=4*s;return this.uint16[k+0]=d,this.uint16[k+1]=f,this.uint16[k+2]=y,this.uint16[k+3]=_,s}}ft.prototype.bytesPerElement=8,Xt(ft,"StructArrayLayout4ui8");class Pt extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_,k){const E=this.length;return this.resize(E+1),this.emplace(E,s,d,f,y,_,k)}emplace(s,d,f,y,_,k,E){const N=6*s;return this.int16[N+0]=d,this.int16[N+1]=f,this.int16[N+2]=y,this.int16[N+3]=_,this.int16[N+4]=k,this.int16[N+5]=E,s}}Pt.prototype.bytesPerElement=12,Xt(Pt,"StructArrayLayout6i12");class _t extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_,k,E,N,M,F,q,X){const te=this.length;return this.resize(te+1),this.emplace(te,s,d,f,y,_,k,E,N,M,F,q,X)}emplace(s,d,f,y,_,k,E,N,M,F,q,X,te){const ie=12*s;return this.int16[ie+0]=d,this.int16[ie+1]=f,this.int16[ie+2]=y,this.int16[ie+3]=_,this.uint16[ie+4]=k,this.uint16[ie+5]=E,this.uint16[ie+6]=N,this.uint16[ie+7]=M,this.int16[ie+8]=F,this.int16[ie+9]=q,this.int16[ie+10]=X,this.int16[ie+11]=te,s}}_t.prototype.bytesPerElement=24,Xt(_t,"StructArrayLayout4i4ui4i24");class Mt extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_,k){const E=this.length;return this.resize(E+1),this.emplace(E,s,d,f,y,_,k)}emplace(s,d,f,y,_,k,E){const N=10*s,M=5*s;return this.int16[N+0]=d,this.int16[N+1]=f,this.int16[N+2]=y,this.float32[M+2]=_,this.float32[M+3]=k,this.float32[M+4]=E,s}}Mt.prototype.bytesPerElement=20,Xt(Mt,"StructArrayLayout3i3f20");class ir extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.uint32[1*s+0]=d,s}}ir.prototype.bytesPerElement=4,Xt(ir,"StructArrayLayout1ul4");class gr extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_,k,E,N,M,F,q,X,te){const ie=this.length;return this.resize(ie+1),this.emplace(ie,s,d,f,y,_,k,E,N,M,F,q,X,te)}emplace(s,d,f,y,_,k,E,N,M,F,q,X,te,ie){const fe=20*s,ge=10*s;return this.int16[fe+0]=d,this.int16[fe+1]=f,this.int16[fe+2]=y,this.int16[fe+3]=_,this.int16[fe+4]=k,this.float32[ge+3]=E,this.float32[ge+4]=N,this.float32[ge+5]=M,this.float32[ge+6]=F,this.int16[fe+14]=q,this.uint32[ge+8]=X,this.uint16[fe+18]=te,this.uint16[fe+19]=ie,s}}gr.prototype.bytesPerElement=40,Xt(gr,"StructArrayLayout5i4f1i1ul2ui40");class Qt extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_,k,E){const N=this.length;return this.resize(N+1),this.emplace(N,s,d,f,y,_,k,E)}emplace(s,d,f,y,_,k,E,N){const M=8*s;return this.int16[M+0]=d,this.int16[M+1]=f,this.int16[M+2]=y,this.int16[M+4]=_,this.int16[M+5]=k,this.int16[M+6]=E,this.int16[M+7]=N,s}}Qt.prototype.bytesPerElement=16,Xt(Qt,"StructArrayLayout3i2i2i16");class ur extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_){const k=this.length;return this.resize(k+1),this.emplace(k,s,d,f,y,_)}emplace(s,d,f,y,_,k){const E=4*s,N=8*s;return this.float32[E+0]=d,this.float32[E+1]=f,this.float32[E+2]=y,this.int16[N+6]=_,this.int16[N+7]=k,s}}ur.prototype.bytesPerElement=16,Xt(ur,"StructArrayLayout2f1f2i16");class Rr extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,y){const _=this.length;return this.resize(_+1),this.emplace(_,s,d,f,y)}emplace(s,d,f,y,_){const k=12*s,E=3*s;return this.uint8[k+0]=d,this.uint8[k+1]=f,this.float32[E+1]=y,this.float32[E+2]=_,s}}Rr.prototype.bytesPerElement=12,Xt(Rr,"StructArrayLayout2ub2f12");class Or extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f){const y=this.length;return this.resize(y+1),this.emplace(y,s,d,f)}emplace(s,d,f,y){const _=3*s;return this.float32[_+0]=d,this.float32[_+1]=f,this.float32[_+2]=y,s}}Or.prototype.bytesPerElement=12,Xt(Or,"StructArrayLayout3f12");class rr extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f){const y=this.length;return this.resize(y+1),this.emplace(y,s,d,f)}emplace(s,d,f,y){const _=3*s;return this.uint16[_+0]=d,this.uint16[_+1]=f,this.uint16[_+2]=y,s}}rr.prototype.bytesPerElement=6,Xt(rr,"StructArrayLayout3ui6");class rn extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_,k,E,N,M,F,q,X,te,ie,fe,ge,je,Re,Ae,Oe,Be){const Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,s,d,f,y,_,k,E,N,M,F,q,X,te,ie,fe,ge,je,Re,Ae,Oe,Be)}emplace(s,d,f,y,_,k,E,N,M,F,q,X,te,ie,fe,ge,je,Re,Ae,Oe,Be,Fe){const nt=30*s,Qe=15*s,dt=60*s;return this.int16[nt+0]=d,this.int16[nt+1]=f,this.int16[nt+2]=y,this.float32[Qe+2]=_,this.float32[Qe+3]=k,this.uint16[nt+8]=E,this.uint16[nt+9]=N,this.uint32[Qe+5]=M,this.uint32[Qe+6]=F,this.uint32[Qe+7]=q,this.uint16[nt+16]=X,this.uint16[nt+17]=te,this.uint16[nt+18]=ie,this.float32[Qe+10]=fe,this.float32[Qe+11]=ge,this.uint8[dt+48]=je,this.uint8[dt+49]=Re,this.uint8[dt+50]=Ae,this.uint32[Qe+13]=Oe,this.int16[nt+28]=Be,this.uint8[dt+58]=Fe,s}}rn.prototype.bytesPerElement=60,Xt(rn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class fn extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_,k,E,N,M,F,q,X,te,ie,fe,ge,je,Re,Ae,Oe,Be,Fe,nt,Qe,dt,Nt,st,yt,xt,kt){const Ot=this.length;return this.resize(Ot+1),this.emplace(Ot,s,d,f,y,_,k,E,N,M,F,q,X,te,ie,fe,ge,je,Re,Ae,Oe,Be,Fe,nt,Qe,dt,Nt,st,yt,xt,kt)}emplace(s,d,f,y,_,k,E,N,M,F,q,X,te,ie,fe,ge,je,Re,Ae,Oe,Be,Fe,nt,Qe,dt,Nt,st,yt,xt,kt,Ot){const ct=38*s,Ut=19*s;return this.int16[ct+0]=d,this.int16[ct+1]=f,this.int16[ct+2]=y,this.float32[Ut+2]=_,this.float32[Ut+3]=k,this.int16[ct+8]=E,this.int16[ct+9]=N,this.int16[ct+10]=M,this.int16[ct+11]=F,this.int16[ct+12]=q,this.int16[ct+13]=X,this.uint16[ct+14]=te,this.uint16[ct+15]=ie,this.uint16[ct+16]=fe,this.uint16[ct+17]=ge,this.uint16[ct+18]=je,this.uint16[ct+19]=Re,this.uint16[ct+20]=Ae,this.uint16[ct+21]=Oe,this.uint16[ct+22]=Be,this.uint16[ct+23]=Fe,this.uint16[ct+24]=nt,this.uint16[ct+25]=Qe,this.uint16[ct+26]=dt,this.uint16[ct+27]=Nt,this.uint16[ct+28]=st,this.uint32[Ut+15]=yt,this.float32[Ut+16]=xt,this.float32[Ut+17]=kt,this.float32[Ut+18]=Ot,s}}fn.prototype.bytesPerElement=76,Xt(fn,"StructArrayLayout3i2f6i15ui1ul3f76");class pn extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.float32[1*s+0]=d,s}}pn.prototype.bytesPerElement=4,Xt(pn,"StructArrayLayout1f4");class mn extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,y,_){const k=this.length;return this.resize(k+1),this.emplace(k,s,d,f,y,_)}emplace(s,d,f,y,_,k){const E=5*s;return this.float32[E+0]=d,this.float32[E+1]=f,this.float32[E+2]=y,this.float32[E+3]=_,this.float32[E+4]=k,s}}mn.prototype.bytesPerElement=20,Xt(mn,"StructArrayLayout5f20");class wa extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f,y){const _=this.length;return this.resize(_+1),this.emplace(_,s,d,f,y)}emplace(s,d,f,y,_){const k=6*s;return this.uint32[3*s+0]=d,this.uint16[k+2]=f,this.uint16[k+3]=y,this.uint16[k+4]=_,s}}wa.prototype.bytesPerElement=12,Xt(wa,"StructArrayLayout1ul3ui12");class Ki extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,d)}emplace(s,d,f){const y=2*s;return this.uint16[y+0]=d,this.uint16[y+1]=f,s}}Ki.prototype.bytesPerElement=4,Xt(Ki,"StructArrayLayout2ui4");class Bs extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.uint16[1*s+0]=d,s}}Bs.prototype.bytesPerElement=2,Xt(Bs,"StructArrayLayout1ui2");class Go extends Ke{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,d)}emplace(s,d,f){const y=2*s;return this.float32[y+0]=d,this.float32[y+1]=f,s}}Go.prototype.bytesPerElement=8,Xt(Go,"StructArrayLayout2f8");class Rn extends Ue{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Rn.prototype.size=40;class gn extends gr{get(s){return new Rn(this,s)}}Xt(gn,"CollisionBoxArray");class Xr extends Ue{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}Xr.prototype.size=60;class xi extends rn{get(s){return new Xr(this,s)}}Xt(xi,"PlacedSymbolArray");class Oa extends Ue{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(s){this._structArray.uint32[this._pos4+15]=s}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Oa.prototype.size=76;class Mn extends fn{get(s){return new Oa(this,s)}}Xt(Mn,"SymbolInstanceArray");class Ka extends pn{getoffsetX(s){return this.float32[1*s+0]}}Xt(Ka,"GlyphOffsetArray");class km extends At{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}Xt(km,"SymbolLineVertexArray");class Cu extends Ue{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Cu.prototype.size=12;class Rf extends wa{get(s){return new Cu(this,s)}}Xt(Rf,"FeatureIndexArray");class Il extends Ki{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}Xt(Il,"FillExtrusionCentroidArray");const Ec=He([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Pu=He([{name:"a_dash",components:4,type:"Uint16"}]);var Tm={exports:{}},Lf={exports:{}};Lf.exports=function(c,s){var d,f,y,_,k,E,N,M;for(f=c.length-(d=3&c.length),y=s,k=3432918353,E=461845907,M=0;M<f;)N=255&c.charCodeAt(M)|(255&c.charCodeAt(++M))<<8|(255&c.charCodeAt(++M))<<16|(255&c.charCodeAt(++M))<<24,++M,y=27492+(65535&(_=5*(65535&(y=(y^=N=(65535&(N=(N=(65535&N)*k+(((N>>>16)*k&65535)<<16)&4294967295)<<15|N>>>17))*E+(((N>>>16)*E&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(N=0,d){case 3:N^=(255&c.charCodeAt(M+2))<<16;case 2:N^=(255&c.charCodeAt(M+1))<<8;case 1:y^=N=(65535&(N=(N=(65535&(N^=255&c.charCodeAt(M)))*k+(((N>>>16)*k&65535)<<16)&4294967295)<<15|N>>>17))*E+(((N>>>16)*E&65535)<<16)&4294967295}return y^=c.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0};var Oy=Lf.exports,G5={exports:{}};G5.exports=function(c,s){for(var d,f=c.length,y=s^f,_=0;f>=4;)d=1540483477*(65535&(d=255&c.charCodeAt(_)|(255&c.charCodeAt(++_))<<8|(255&c.charCodeAt(++_))<<16|(255&c.charCodeAt(++_))<<24))+((1540483477*(d>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),f-=4,++_;switch(f){case 3:y^=(255&c.charCodeAt(_+2))<<16;case 2:y^=(255&c.charCodeAt(_+1))<<8;case 1:y=1540483477*(65535&(y^=255&c.charCodeAt(_)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0};var W5=Oy,VY=G5.exports;Tm.exports=W5,Tm.exports.murmur3=W5,Tm.exports.murmur2=VY;var NE=$(Tm.exports);class i1{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,d,f,y){this.ids.push(H5(s)),this.positions.push(d,f,y)}getPositions(s){const d=H5(s);let f=0,y=this.ids.length-1;for(;f<y;){const k=f+y>>1;this.ids[k]>=d?y=k:f=k+1}const _=[];for(;this.ids[f]===d;)_.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return _}static serialize(s,d){const f=new Float64Array(s.ids),y=new Uint32Array(s.positions);return CE(f,y,0,f.length-1),d&&d.push(f.buffer,y.buffer),{ids:f,positions:y}}static deserialize(s){const d=new i1;return d.ids=s.ids,d.positions=s.positions,d.indexed=!0,d}}function H5(c){const s=+c;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:NE(String(c))}function CE(c,s,d,f){for(;d<f;){const y=c[d+f>>1];let _=d-1,k=f+1;for(;;){do _++;while(c[_]<y);do k--;while(c[k]>y);if(_>=k)break;a1(c,_,k),a1(s,3*_,3*k),a1(s,3*_+1,3*k+1),a1(s,3*_+2,3*k+2)}k-d<f-k?(CE(c,s,d,k),d=k+1):(CE(c,s,k+1,f),f=k)}}function a1(c,s,d){const f=c[s];c[s]=c[d],c[d]=f}Xt(i1,"FeaturePositionMap");class Iu{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,d){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,d),this.initialized=!0),!!this.location}}class s1 extends Iu{constructor(s){super(s),this.current=0}set(s,d,f){this.fetchUniformLocation(s,d)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class K5 extends Iu{constructor(s){super(s),this.current=[0,0,0,0]}set(s,d,f){this.fetchUniformLocation(s,d)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class Z5 extends Iu{constructor(s){super(s),this.current=$n.transparent}set(s,d,f){this.fetchUniformLocation(s,d)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const UY=new Float32Array(16),qY=new Float32Array(9),GY=new Float32Array(4);function PE(c){return[Ve(255*c.r,255*c.g),Ve(255*c.b,255*c.a)]}class Ry{constructor(s,d,f){this.value=s,this.uniformNames=d.map(y=>`u_${y}`),this.type=f}setUniform(s,d,f,y,_){d.set(s,_,y.constantOr(this.value))}getBinding(s,d){return this.type==="color"?new Z5(s):new s1(s)}}class Sm{constructor(s,d){this.uniformNames=d.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,d,f,y,_){const k=_==="u_pattern"||_==="u_dash"?this.pattern:_==="u_pixel_ratio"?this.pixelRatio:null;k&&d.set(s,_,k)}getBinding(s,d){return d==="u_pattern"||d==="u_dash"?new K5(s):new s1(s)}}class Mu{constructor(s,d,f,y){this.expression=s,this.type=f,this.maxValue=0,this.paintVertexAttributes=d.map(_=>({name:`a_${_}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(s,d,f,y,_,k){const E=this.paintVertexArray.length,N=this.expression.evaluate(new U(0),d,{},_,y,k);this.paintVertexArray.resize(s),this._setPaintValue(E,s,N)}updatePaintArray(s,d,f,y,_){const k=this.expression.evaluate({zoom:0},f,y,void 0,_);this._setPaintValue(s,d,k)}_setPaintValue(s,d,f){if(this.type==="color"){const y=PE(f);for(let _=s;_<d;_++)this.paintVertexArray.emplace(_,y[0],y[1])}else{for(let y=s;y<d;y++)this.paintVertexArray.emplace(y,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ml{constructor(s,d,f,y,_,k){this.expression=s,this.uniformNames=d.map(E=>`u_${E}_t`),this.type=f,this.useIntegerZoom=y,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=d.map(E=>({name:`a_${E}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new k}populatePaintArray(s,d,f,y,_,k){const E=this.expression.evaluate(new U(this.zoom),d,{},_,y,k),N=this.expression.evaluate(new U(this.zoom+1),d,{},_,y,k),M=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(M,s,E,N)}updatePaintArray(s,d,f,y,_){const k=this.expression.evaluate({zoom:this.zoom},f,y,void 0,_),E=this.expression.evaluate({zoom:this.zoom+1},f,y,void 0,_);this._setPaintValue(s,d,k,E)}_setPaintValue(s,d,f,y){if(this.type==="color"){const _=PE(f),k=PE(y);for(let E=s;E<d;E++)this.paintVertexArray.emplace(E,_[0],_[1],k[0],k[1])}else{for(let _=s;_<d;_++)this.paintVertexArray.emplace(_,f,y);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(y))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,d,f,y,_){const k=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,E=ye(this.expression.interpolationFactor(k,this.zoom,this.zoom+1),0,1);d.set(s,_,E)}getBinding(s,d){return new s1(s)}}class Hd{constructor(s,d,f,y,_){this.expression=s,this.layerId=_,this.paintVertexAttributes=(f==="array"?Pu:Ec).members;for(let k=0;k<d.length;++k);this.paintVertexArray=new y}populatePaintArray(s,d,f){const y=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(y,s,d.patterns&&d.patterns[this.layerId],f)}updatePaintArray(s,d,f,y,_,k){this._setPaintValues(s,d,f.patterns&&f.patterns[this.layerId],k)}_setPaintValues(s,d,f,y){if(!y||!f)return;const _=y[f];if(!_)return;const{tl:k,br:E,pixelRatio:N}=_;for(let M=s;M<d;M++)this.paintVertexArray.emplace(M,k[0],k[1],E[0],E[1],N)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Kd{constructor(s,d,f=()=>!0){this.binders={},this._buffers=[];const y=[];for(const _ in s.paint._values){if(!f(_))continue;const k=s.paint.get(_);if(!(k instanceof we&&$d(k.property.specification)))continue;const E=HY(_,s.type),N=k.value,M=k.property.specification.type,F=!!k.property.useIntegerZoom,q=_==="line-dasharray"||_.endsWith("pattern"),X=_==="line-dasharray"&&s.layout.get("line-cap").value.kind!=="constant";if(N.kind!=="constant"||X)if(N.kind==="source"||X||q){const te=X5(_,M,"source");this.binders[_]=q?new Hd(N,E,M,te,s.id):new Mu(N,E,M,te),y.push(`/a_${_}`)}else{const te=X5(_,M,"composite");this.binders[_]=new Ml(N,E,M,F,d,te),y.push(`/z_${_}`)}else this.binders[_]=q?new Sm(N.value,E):new Ry(N.value,E,M),y.push(`/u_${_}`)}this.cacheKey=y.sort().join("")}getMaxValue(s){const d=this.binders[s];return d instanceof Mu||d instanceof Ml?d.maxValue:0}populatePaintArrays(s,d,f,y,_,k){for(const E in this.binders){const N=this.binders[E];(N instanceof Mu||N instanceof Ml||N instanceof Hd)&&N.populatePaintArray(s,d,f,y,_,k)}}setConstantPatternPositions(s){for(const d in this.binders){const f=this.binders[d];f instanceof Sm&&f.setConstantPatternPositions(s)}}updatePaintArrays(s,d,f,y,_,k){let E=!1;for(const N in s){const M=d.getPositions(N);for(const F of M){const q=f.feature(F.index);for(const X in this.binders){const te=this.binders[X];if((te instanceof Mu||te instanceof Ml||te instanceof Hd)&&te.expression.isStateDependent===!0){const ie=y.paint.get(X);te.expression=ie.value,te.updatePaintArray(F.start,F.end,q,s[N],_,k),E=!0}}}}return E}defines(){const s=[];for(const d in this.binders){const f=this.binders[d];(f instanceof Ry||f instanceof Sm)&&s.push(...f.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return s}getBinderAttributes(){const s=[];for(const d in this.binders){const f=this.binders[d];if(f instanceof Mu||f instanceof Ml||f instanceof Hd)for(let y=0;y<f.paintVertexAttributes.length;y++)s.push(f.paintVertexAttributes[y].name)}return s}getBinderUniforms(){const s=[];for(const d in this.binders){const f=this.binders[d];if(f instanceof Ry||f instanceof Sm||f instanceof Ml)for(const y of f.uniformNames)s.push(y)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const d=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof Ry||y instanceof Sm||y instanceof Ml)for(const _ of y.uniformNames)d.push({name:_,property:f,binding:y.getBinding(s,_)})}return d}setUniforms(s,d,f,y,_){for(const{name:k,property:E,binding:N}of f)this.binders[E].setUniform(s,N,_,y.get(E),k)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const d=this.binders[s];(d instanceof Mu||d instanceof Ml||d instanceof Hd)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(s){for(const d in this.binders){const f=this.binders[d];(f instanceof Mu||f instanceof Ml||f instanceof Hd)&&f.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const d=this.binders[s];(d instanceof Mu||d instanceof Ml||d instanceof Hd)&&d.destroy()}}}class zf{constructor(s,d,f=()=>!0){this.programConfigurations={};for(const y of s)this.programConfigurations[y.id]=new Kd(y,d,f);this.needsUpload=!1,this._featureMap=new i1,this._bufferOffset=0}populatePaintArrays(s,d,f,y,_,k,E){for(const N in this.programConfigurations)this.programConfigurations[N].populatePaintArrays(s,d,y,_,k,E);d.id!==void 0&&this._featureMap.add(d.id,f,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,d,f,y,_){for(const k of f)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(s,this._featureMap,d,k,y,_)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const WY={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function HY(c,s){return WY[c]||[c.replace(`${s}-`,"").replace(/-/g,"_")]}const KY={"line-pattern":{source:tt,composite:tt},"fill-pattern":{source:tt,composite:tt},"fill-extrusion-pattern":{source:tt,composite:tt},"line-dasharray":{source:ft,composite:ft}},ZY={color:{source:Go,composite:Et},number:{source:pn,composite:Go}};function X5(c,s,d){const f=KY[c];return f&&f[d]||ZY[s][d]}Xt(Ry,"ConstantBinder"),Xt(Sm,"PatternConstantBinder"),Xt(Mu,"SourceExpressionBinder"),Xt(Hd,"PatternCompositeBinder"),Xt(Ml,"CompositeExpressionBinder"),Xt(Kd,"ProgramConfiguration",{omit:["_buffers"]}),Xt(zf,"ProgramConfigurationSet");const Y5="-transition";class Dl extends yu{constructor(s,d){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&s.type!=="sky"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),d.layout&&(this._unevaluatedLayout=new Te(d.layout)),d.paint)){this._transitionablePaint=new ue(d.paint);for(const f in s.paint)this.setPaintProperty(f,s.paint[f],{validate:!1});for(const f in s.layout)this.setLayoutProperty(f,s.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ee(d.paint)}}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,d,f={}){d!=null&&this._validate(TE,`layers.${this.id}.layout.${s}`,s,d,f)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,d):this.visibility=d)}getPaintProperty(s){return Zt(s,Y5)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,d,f={}){if(d!=null&&this._validate(kE,`layers.${this.id}.paint.${s}`,s,d,f))return!1;if(Zt(s,Y5))return this._transitionablePaint.setTransition(s.slice(0,-11),d||void 0),!1;{const y=this._transitionablePaint._values[s],_=y.value.isDataDriven(),k=y.value;this._transitionablePaint.setValue(s,d),this._handleSpecialPaintPropertyUpdate(s);const E=this._transitionablePaint._values[s].value,N=E.isDataDriven(),M=Zt(s,"pattern")||s==="line-dasharray";return N||_||M||this._handleOverridablePaintPropertyUpdate(s,k,E)}}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getProgramConfiguration(s){return null}_handleOverridablePaintPropertyUpdate(s,d,f){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,d){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,d)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),ot(s,(d,f)=>!(d===void 0||f==="layout"&&!Object.keys(d).length||f==="paint"&&!Object.keys(d).length))}_validate(s,d,f,y,_={}){return(!_||_.validate!==!1)&&e1(this,s.call(Qb,{key:d,layerType:this.type,objectKey:f,value:y,styleSpec:lt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const d=this.paint.get(s);if(d instanceof we&&$d(d.property.specification)&&(d.value.kind==="source"||d.value.kind==="composite")&&d.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=vm(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const XY=He([{name:"a_pos",components:2,type:"Int16"}],4),YY=He([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class vi{constructor(s=[]){this.segments=s}prepareSegment(s,d,f,y){let _=this.segments[this.segments.length-1];return s>vi.MAX_VERTEX_ARRAY_LENGTH&&Lt(`Max vertices per segment is ${vi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!_||_.vertexLength+s>vi.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==y)&&(_={vertexOffset:d.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},y!==void 0&&(_.sortKey=y),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const s of this.segments)for(const d in s.vaos)s.vaos[d].destroy()}static simpleSegment(s,d,f,y){return new vi([{vertexOffset:s,primitiveOffset:d,vertexLength:f,primitiveLength:y,vaos:{},sortKey:0}])}}vi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xt(vi,"SegmentVector");var cr=8192;class Zd{constructor(s,d){s&&(d?this.setSouthWest(s).setNorthEast(d):s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof yn?new yn(s.lng,s.lat):yn.convert(s),this}setSouthWest(s){return this._sw=s instanceof yn?new yn(s.lng,s.lat):yn.convert(s),this}extend(s){const d=this._sw,f=this._ne;let y,_;if(s instanceof yn)y=s,_=s;else{if(!(s instanceof Zd))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(Zd.convert(s)):this.extend(yn.convert(s)):typeof s=="object"&&s!==null&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(yn.convert(s)):this;if(y=s._sw,_=s._ne,!y||!_)return this}return d||f?(d.lng=Math.min(y.lng,d.lng),d.lat=Math.min(y.lat,d.lat),f.lng=Math.max(_.lng,f.lng),f.lat=Math.max(_.lat,f.lat)):(this._sw=new yn(y.lng,y.lat),this._ne=new yn(_.lng,_.lat)),this}getCenter(){return new yn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new yn(this.getWest(),this.getNorth())}getSouthEast(){return new yn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:d,lat:f}=yn.convert(s);let y=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&y}static convert(s){return!s||s instanceof Zd?s:new Zd(s)}}var o1=1e-6,Vs=typeof Float32Array<"u"?Float32Array:Array;function J5(){var c=new Vs(9);return Vs!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function Q5(c,s,d){var f=s[0],y=s[1],_=s[2],k=s[3],E=s[4],N=s[5],M=s[6],F=s[7],q=s[8],X=d[0],te=d[1],ie=d[2],fe=d[3],ge=d[4],je=d[5],Re=d[6],Ae=d[7],Oe=d[8];return c[0]=X*f+te*k+ie*M,c[1]=X*y+te*E+ie*F,c[2]=X*_+te*N+ie*q,c[3]=fe*f+ge*k+je*M,c[4]=fe*y+ge*E+je*F,c[5]=fe*_+ge*N+je*q,c[6]=Re*f+Ae*k+Oe*M,c[7]=Re*y+Ae*E+Oe*F,c[8]=Re*_+Ae*N+Oe*q,c}function Ol(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function IE(c,s){var d=s[0],f=s[1],y=s[2],_=s[3],k=s[4],E=s[5],N=s[6],M=s[7],F=s[8],q=s[9],X=s[10],te=s[11],ie=s[12],fe=s[13],ge=s[14],je=s[15],Re=d*E-f*k,Ae=d*N-y*k,Oe=d*M-_*k,Be=f*N-y*E,Fe=f*M-_*E,nt=y*M-_*N,Qe=F*fe-q*ie,dt=F*ge-X*ie,Nt=F*je-te*ie,st=q*ge-X*fe,yt=q*je-te*fe,xt=X*je-te*ge,kt=Re*xt-Ae*yt+Oe*st+Be*Nt-Fe*dt+nt*Qe;return kt?(c[0]=(E*xt-N*yt+M*st)*(kt=1/kt),c[1]=(y*yt-f*xt-_*st)*kt,c[2]=(fe*nt-ge*Fe+je*Be)*kt,c[3]=(X*Fe-q*nt-te*Be)*kt,c[4]=(N*Nt-k*xt-M*dt)*kt,c[5]=(d*xt-y*Nt+_*dt)*kt,c[6]=(ge*Oe-ie*nt-je*Ae)*kt,c[7]=(F*nt-X*Oe+te*Ae)*kt,c[8]=(k*yt-E*Nt+M*Qe)*kt,c[9]=(f*Nt-d*yt-_*Qe)*kt,c[10]=(ie*Fe-fe*Oe+je*Re)*kt,c[11]=(q*Oe-F*Fe-te*Re)*kt,c[12]=(E*dt-k*st-N*Qe)*kt,c[13]=(d*st-f*dt+y*Qe)*kt,c[14]=(fe*Ae-ie*Be-ge*Re)*kt,c[15]=(F*Be-q*Ae+X*Re)*kt,c):null}function $f(c,s,d){var f=s[0],y=s[1],_=s[2],k=s[3],E=s[4],N=s[5],M=s[6],F=s[7],q=s[8],X=s[9],te=s[10],ie=s[11],fe=s[12],ge=s[13],je=s[14],Re=s[15],Ae=d[0],Oe=d[1],Be=d[2],Fe=d[3];return c[0]=Ae*f+Oe*E+Be*q+Fe*fe,c[1]=Ae*y+Oe*N+Be*X+Fe*ge,c[2]=Ae*_+Oe*M+Be*te+Fe*je,c[3]=Ae*k+Oe*F+Be*ie+Fe*Re,c[4]=(Ae=d[4])*f+(Oe=d[5])*E+(Be=d[6])*q+(Fe=d[7])*fe,c[5]=Ae*y+Oe*N+Be*X+Fe*ge,c[6]=Ae*_+Oe*M+Be*te+Fe*je,c[7]=Ae*k+Oe*F+Be*ie+Fe*Re,c[8]=(Ae=d[8])*f+(Oe=d[9])*E+(Be=d[10])*q+(Fe=d[11])*fe,c[9]=Ae*y+Oe*N+Be*X+Fe*ge,c[10]=Ae*_+Oe*M+Be*te+Fe*je,c[11]=Ae*k+Oe*F+Be*ie+Fe*Re,c[12]=(Ae=d[12])*f+(Oe=d[13])*E+(Be=d[14])*q+(Fe=d[15])*fe,c[13]=Ae*y+Oe*N+Be*X+Fe*ge,c[14]=Ae*_+Oe*M+Be*te+Fe*je,c[15]=Ae*k+Oe*F+Be*ie+Fe*Re,c}function Ly(c,s,d){var f,y,_,k,E,N,M,F,q,X,te,ie,fe=d[0],ge=d[1],je=d[2];return s===c?(c[12]=s[0]*fe+s[4]*ge+s[8]*je+s[12],c[13]=s[1]*fe+s[5]*ge+s[9]*je+s[13],c[14]=s[2]*fe+s[6]*ge+s[10]*je+s[14],c[15]=s[3]*fe+s[7]*ge+s[11]*je+s[15]):(y=s[1],_=s[2],k=s[3],E=s[4],N=s[5],M=s[6],F=s[7],q=s[8],X=s[9],te=s[10],ie=s[11],c[0]=f=s[0],c[1]=y,c[2]=_,c[3]=k,c[4]=E,c[5]=N,c[6]=M,c[7]=F,c[8]=q,c[9]=X,c[10]=te,c[11]=ie,c[12]=f*fe+E*ge+q*je+s[12],c[13]=y*fe+N*ge+X*je+s[13],c[14]=_*fe+M*ge+te*je+s[14],c[15]=k*fe+F*ge+ie*je+s[15]),c}function Ff(c,s,d){var f=d[0],y=d[1],_=d[2];return c[0]=s[0]*f,c[1]=s[1]*f,c[2]=s[2]*f,c[3]=s[3]*f,c[4]=s[4]*y,c[5]=s[5]*y,c[6]=s[6]*y,c[7]=s[7]*y,c[8]=s[8]*_,c[9]=s[9]*_,c[10]=s[10]*_,c[11]=s[11]*_,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15],c}function ME(c,s,d){var f=Math.sin(d),y=Math.cos(d),_=s[4],k=s[5],E=s[6],N=s[7],M=s[8],F=s[9],q=s[10],X=s[11];return s!==c&&(c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[3],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[4]=_*y+M*f,c[5]=k*y+F*f,c[6]=E*y+q*f,c[7]=N*y+X*f,c[8]=M*y-_*f,c[9]=F*y-k*f,c[10]=q*y-E*f,c[11]=X*y-N*f,c}function l1(c,s,d){var f=Math.sin(d),y=Math.cos(d),_=s[0],k=s[1],E=s[2],N=s[3],M=s[8],F=s[9],q=s[10],X=s[11];return s!==c&&(c[4]=s[4],c[5]=s[5],c[6]=s[6],c[7]=s[7],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=_*y-M*f,c[1]=k*y-F*f,c[2]=E*y-q*f,c[3]=N*y-X*f,c[8]=_*f+M*y,c[9]=k*f+F*y,c[10]=E*f+q*y,c[11]=N*f+X*y,c}function eD(c,s){return c[0]=s[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=s[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=s[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function tD(c,s,d){var f,y,_,k=d[0],E=d[1],N=d[2],M=Math.hypot(k,E,N);return M<o1?null:(k*=M=1/M,E*=M,N*=M,f=Math.sin(s),y=Math.cos(s),c[0]=k*k*(_=1-y)+y,c[1]=E*k*_+N*f,c[2]=N*k*_-E*f,c[3]=0,c[4]=k*E*_-N*f,c[5]=E*E*_+y,c[6]=N*E*_+k*f,c[7]=0,c[8]=k*N*_+E*f,c[9]=E*N*_-k*f,c[10]=N*N*_+y,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}Math.hypot||(Math.hypot=function(){for(var c=0,s=arguments.length;s--;)c+=arguments[s]*arguments[s];return Math.sqrt(c)});var JY=$f;function DE(){var c=new Vs(3);return Vs!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function rD(c){var s=new Vs(3);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s}function zy(c){return Math.hypot(c[0],c[1],c[2])}function Em(c,s,d){var f=new Vs(3);return f[0]=c,f[1]=s,f[2]=d,f}function Du(c,s,d){return c[0]=s[0]+d[0],c[1]=s[1]+d[1],c[2]=s[2]+d[2],c}function OE(c,s,d){return c[0]=s[0]-d[0],c[1]=s[1]-d[1],c[2]=s[2]-d[2],c}function nD(c,s,d){return c[0]=s[0]*d[0],c[1]=s[1]*d[1],c[2]=s[2]*d[2],c}function $y(c,s,d){return c[0]=Math.min(s[0],d[0]),c[1]=Math.min(s[1],d[1]),c[2]=Math.min(s[2],d[2]),c}function Fy(c,s,d){return c[0]=Math.max(s[0],d[0]),c[1]=Math.max(s[1],d[1]),c[2]=Math.max(s[2],d[2]),c}function go(c,s,d){return c[0]=s[0]*d,c[1]=s[1]*d,c[2]=s[2]*d,c}function By(c,s,d,f){return c[0]=s[0]+d[0]*f,c[1]=s[1]+d[1]*f,c[2]=s[2]+d[2]*f,c}function Za(c,s){var d=s[0],f=s[1],y=s[2],_=d*d+f*f+y*y;return _>0&&(_=1/Math.sqrt(_)),c[0]=s[0]*_,c[1]=s[1]*_,c[2]=s[2]*_,c}function Wo(c,s){return c[0]*s[0]+c[1]*s[1]+c[2]*s[2]}function RE(c,s,d){var f=s[0],y=s[1],_=s[2],k=d[0],E=d[1],N=d[2];return c[0]=y*N-_*E,c[1]=_*k-f*N,c[2]=f*E-y*k,c}function ui(c,s,d){var f=s[0],y=s[1],_=s[2],k=d[3]*f+d[7]*y+d[11]*_+d[15];return c[0]=(d[0]*f+d[4]*y+d[8]*_+d[12])/(k=k||1),c[1]=(d[1]*f+d[5]*y+d[9]*_+d[13])/k,c[2]=(d[2]*f+d[6]*y+d[10]*_+d[14])/k,c}function iD(c,s,d){var f=d[0],y=d[1],_=d[2],k=s[0],E=s[1],N=s[2],M=y*N-_*E,F=_*k-f*N,q=f*E-y*k,X=y*q-_*F,te=_*M-f*q,ie=f*F-y*M,fe=2*d[3];return F*=fe,q*=fe,te*=2,ie*=2,c[0]=k+(M*=fe)+(X*=2),c[1]=E+F+te,c[2]=N+q+ie,c}var Vy,Rl=OE,QY=nD,eJ=zy;function aD(c,s,d){return c[0]=s[0]*d,c[1]=s[1]*d,c[2]=s[2]*d,c[3]=s[3]*d,c}function sD(c,s){var d=s[0],f=s[1],y=s[2],_=s[3],k=d*d+f*f+y*y+_*_;return k>0&&(k=1/Math.sqrt(k)),c[0]=d*k,c[1]=f*k,c[2]=y*k,c[3]=_*k,c}function Bf(c,s,d){var f=s[0],y=s[1],_=s[2],k=s[3];return c[0]=d[0]*f+d[4]*y+d[8]*_+d[12]*k,c[1]=d[1]*f+d[5]*y+d[9]*_+d[13]*k,c[2]=d[2]*f+d[6]*y+d[10]*_+d[14]*k,c[3]=d[3]*f+d[7]*y+d[11]*_+d[15]*k,c}function oD(){var c=new Vs(4);return Vs!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function lD(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function cD(c,s,d){d*=.5;var f=s[0],y=s[1],_=s[2],k=s[3],E=Math.sin(d),N=Math.cos(d);return c[0]=f*N+k*E,c[1]=y*N+_*E,c[2]=_*N-y*E,c[3]=k*N-f*E,c}function uD(c,s,d){d*=.5;var f=s[0],y=s[1],_=s[2],k=s[3],E=Math.sin(d),N=Math.cos(d);return c[0]=f*N-_*E,c[1]=y*N+k*E,c[2]=_*N+f*E,c[3]=k*N-y*E,c}DE(),Vy=new Vs(4),Vs!=Float32Array&&(Vy[0]=0,Vy[1]=0,Vy[2]=0,Vy[3]=0);var tJ=sD;DE(),Em(1,0,0),Em(0,1,0),oD(),oD(),J5();const rJ=He([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:dD}=rJ,hD=He([{name:"a_pos_3",components:3,type:"Int16"}]);var Uy=He([{name:"a_pos",type:"Int16",components:2}]);class LE{constructor(s,d){this.pos=s,this.dir=d}intersectsPlane(s,d,f){const y=Wo(d,this.dir);if(Math.abs(y)<1e-6)return!1;const _=((s[0]-this.pos[0])*d[0]+(s[1]-this.pos[1])*d[1]+(s[2]-this.pos[2])*d[2])/y;return f[0]=this.pos[0]+this.dir[0]*_,f[1]=this.pos[1]+this.dir[1]*_,f[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(s,d,f){if(function(te,ie){var fe=te[0],ge=te[1],je=te[2],Re=ie[0],Ae=ie[1],Oe=ie[2];return Math.abs(fe-Re)<=o1*Math.max(1,Math.abs(fe),Math.abs(Re))&&Math.abs(ge-Ae)<=o1*Math.max(1,Math.abs(ge),Math.abs(Ae))&&Math.abs(je-Oe)<=o1*Math.max(1,Math.abs(je),Math.abs(Oe))}(this.pos,s)||d===0)return f[0]=f[1]=f[2]=0,!1;const[y,_,k]=this.dir,E=this.pos[0]-s[0],N=this.pos[1]-s[1],M=this.pos[2]-s[2],F=y*y+_*_+k*k,q=2*(E*y+N*_+M*k),X=q*q-4*F*(E*E+N*N+M*M-d*d);if(X<0){const te=Math.max(-q/2,0),ie=E+y*te,fe=N+_*te,ge=M+k*te,je=Math.hypot(ie,fe,ge);return f[0]=ie*d/je,f[1]=fe*d/je,f[2]=ge*d/je,!1}{const te=(-q-Math.sqrt(X))/(2*F);if(te<0){const ie=Math.hypot(E,N,M);return f[0]=E*d/ie,f[1]=N*d/ie,f[2]=M*d/ie,!1}return f[0]=E+y*te,f[1]=N+_*te,f[2]=M+k*te,!0}}}class zE{constructor(s,d,f,y,_){this.TL=s,this.TR=d,this.BR=f,this.BL=y,this.horizon=_}static fromInvProjectionMatrix(s,d,f){const y=[-1,1,1],_=[1,1,1],k=[1,-1,1],E=[-1,-1,1],N=ui(y,y,s),M=ui(_,_,s),F=ui(k,k,s),q=ui(E,E,s);return new zE(N,M,F,q,d/f)}}class $E{constructor(s,d){this.points=s,this.planes=d}static fromInvProjectionMatrix(s,d,f,y){const _=Math.pow(2,f),k=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const M=Bf([],N,s),F=1/M[3]/d*_;return function(q,X,te){return q[0]=X[0]*te[0],q[1]=X[1]*te[1],q[2]=X[2]*te[2],q[3]=X[3]*te[3],q}(M,M,[F,F,y?1/M[3]:F,F])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const M=Za([],RE([],Rl([],k[N[0]],k[N[1]]),Rl([],k[N[2]],k[N[1]]))),F=-Wo(M,k[N[1]]);return M.concat(F)});return new $E(k,E)}}class Xa{static fromPoints(s){const d=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const y of s)$y(d,d,y),Fy(f,f,y);return new Xa(d,f)}static applyTransform(s,d){const f=s.getCorners();for(let y=0;y<f.length;++y)ui(f[y],f[y],d);return Xa.fromPoints(f)}constructor(s,d){this.min=s,this.max=d,this.center=go([],Du([],this.min,this.max),.5)}quadrant(s){const d=[s%2==0,s<2],f=rD(this.min),y=rD(this.max);for(let _=0;_<d.length;_++)f[_]=d[_]?this.min[_]:this.center[_],y[_]=d[_]?this.center[_]:this.max[_];return y[2]=this.max[2],new Xa(f,y)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,d=this.max;return[[s[0],s[1],s[2]],[d[0],s[1],s[2]],[d[0],d[1],s[2]],[s[0],d[1],s[2]],[s[0],s[1],d[2]],[d[0],s[1],d[2]],[d[0],d[1],d[2]],[s[0],d[1],d[2]]]}intersects(s){const d=this.getCorners();let f=!0;for(let y=0;y<s.planes.length;y++){const _=s.planes[y];let k=0;for(let E=0;E<d.length;E++)k+=Wo(_,d[E])+_[3]>=0;if(k===0)return 0;k!==d.length&&(f=!1)}if(f)return 2;for(let y=0;y<3;y++){let _=Number.MAX_VALUE,k=-Number.MAX_VALUE;for(let E=0;E<s.points.length;E++){const N=s.points[E][y]-this.min[y];_=Math.min(_,N),k=Math.max(k,N)}if(k<0||_>this.max[y]-this.min[y])return 0}return 1}}const FE=5,fD=6,jc=cr/Math.PI/2,nJ=16383,Vf=64,qy=[Vf,32,16],Ho=-jc,Ko=jc,iJ=[new Xa([Ho,Ho,Ho],[Ko,Ko,Ko]),new Xa([Ho,Ho,Ho],[0,0,Ko]),new Xa([0,Ho,Ho],[Ko,0,Ko]),new Xa([Ho,0,Ho],[0,Ko,Ko]),new Xa([0,0,Ho],[Ko,Ko,Ko])];function c1(c){return c*jc/Hy}function pD(c,s,d,f=!0){const y=go([],c._camera.position,c.worldSize),_=[s,d,1,1];Bf(_,_,c.pixelMatrixInverse),aD(_,_,1/_[3]);const k=Za([],Rl([],_,y)),E=c.globeMatrix,N=[E[12],E[13],E[14]],M=Rl([],N,y),F=zy(M),q=Za([],M),X=c.worldSize/(2*Math.PI),te=Wo(q,k),ie=Math.asin(X/F);if(ie<Math.acos(te)){if(!f)return null;const Nt=[],st=[];go(Nt,k,F/te),Za(st,Rl(st,Nt,M)),Za(k,Du(k,M,go(k,st,Math.tan(ie)*F)))}const fe=[];new LE(y,k).closestPointOnSphere(N,X,fe);const ge=Za([],tr(E,0)),je=Za([],tr(E,1)),Re=Za([],tr(E,2)),Ae=Wo(ge,fe),Oe=Wo(je,fe),Be=Wo(Re,fe),Fe=ne(Math.asin(-Oe/X));let nt=ne(Math.atan2(Ae,Be));nt=c.center.lng+function(Nt,st){const yt=(st-Nt+180)%360-180;return yt<-180?yt+360:yt}(c.center.lng,nt);const Qe=Nc(nt),dt=ye(Cc(Fe),0,1);return new Cm(Qe,dt)}class aJ{constructor(s,d,f){this.a=Rl([],s,f),this.b=Rl([],d,f),this.center=f;const y=Za([],this.a),_=Za([],this.b);this.angle=Math.acos(Wo(y,_))}}function BE(c,s){if(c.angle===0)return null;let d;return d=c.a[s]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[s]/c.a[s]/Math.sin(c.angle)-1/Math.tan(c.angle)),d<0||d>1?null:function(f,y,_,k){const E=Math.sin(_);return f*(Math.sin((1-k)*_)/E)+y*(Math.sin(k*_)/E)}(c.a[s],c.b[s],c.angle,ye(d,0,1))+c.center[s]}function Ac(c){if(c.z<=1)return iJ[c.z+2*c.y+c.x];const s=VE(u1(c));return Xa.fromPoints(s)}function Uf(c,s,d){return go(c,c,1-d),By(c,c,s,d)}function mD(c,s){const d=Nm(s.zoom);if(d===0)return Ac(c);const f=u1(c),y=VE(f),_=Nc(f.getWest())*s.worldSize,k=Nc(f.getEast())*s.worldSize,E=Cc(f.getNorth())*s.worldSize,N=Cc(f.getSouth())*s.worldSize,M=[_,E,0],F=[k,E,0],q=[_,N,0],X=[k,N,0],te=IE([],s.globeMatrix);return ui(M,M,te),ui(F,F,te),ui(q,q,te),ui(X,X,te),y[0]=Uf(y[0],q,d),y[1]=Uf(y[1],X,d),y[2]=Uf(y[2],F,d),y[3]=Uf(y[3],M,d),Xa.fromPoints(y)}function gD(c,s,d){for(const f of c)ui(f,f,s),go(f,f,d)}function sJ(c,s,d){const f=s/c.worldSize,y=c.globeMatrix;if(d.z<=1){const Qe=Ac(d).getCorners();return gD(Qe,y,f),Xa.fromPoints(Qe)}const _=u1(d),k=VE(_);gD(k,y,f);const E=Number.MAX_VALUE,N=[-E,-E,-E],M=[E,E,E];if(_.contains(c.center)){for(const Nt of k)$y(M,M,Nt),Fy(N,N,Nt);N[2]=0;const Qe=c.point,dt=[Qe.x*f,Qe.y*f,0];return $y(M,M,dt),Fy(N,N,dt),new Xa(M,N)}const F=[y[12]*f,y[13]*f,y[14]*f],q=_.getCenter(),X=ye(c.center.lat,-Ta,Ta),te=ye(q.lat,-Ta,Ta),ie=Nc(c.center.lng),fe=Cc(X);let ge=ie-Nc(q.lng);const je=fe-Cc(te);ge>.5?ge-=1:ge<-.5&&(ge+=1);let Re=0;Math.abs(ge)>Math.abs(je)?Re=ge>=0?1:3:(Re=je>=0?0:2,By(F,F,[y[4]*f,y[5]*f,y[6]*f],-Math.sin(ce(je>=0?_.getSouth():_.getNorth()))*jc));const Ae=k[Re],Oe=k[(Re+1)%4],Be=new aJ(Ae,Oe,F),Fe=[BE(Be,0)||Ae[0],BE(Be,1)||Ae[1],BE(Be,2)||Ae[2]],nt=Nm(c.zoom);if(nt>0){const Qe=function({x:Nt,y:st,z:yt},xt,kt,Ot,ct){const Ut=1/(1<<yt);let er=Nt*Ut,Wt=er+Ut,br=st*Ut,Rt=br+Ut,sr=0;const wr=(er+Wt)/2-Ot;return wr>.5?sr=-1:wr<-.5&&(sr=1),er=((er+sr)*xt-(Ot*=xt))*kt+Ot,Wt=((Wt+sr)*xt-Ot)*kt+Ot,br=(br*xt-(ct*=xt))*kt+ct,Rt=(Rt*xt-ct)*kt+ct,[[er,Rt,0],[Wt,Rt,0],[Wt,br,0],[er,br,0]]}(d,s,c._pixelsPerMercatorPixel,ie,fe);for(let Nt=0;Nt<k.length;Nt++)Uf(k[Nt],Qe[Nt],nt);const dt=Du([],Qe[Re],Qe[(Re+1)%4]);go(dt,dt,.5),Uf(Fe,dt,nt)}for(const Qe of k)$y(M,M,Qe),Fy(N,N,Qe);return M[2]=Math.min(Ae[2],Oe[2]),$y(M,M,Fe),Fy(N,N,Fe),new Xa(M,N)}function u1({x:c,y:s,z:d}){const f=1/(1<<d),y=new yn(yo(c*f),ka((s+1)*f)),_=new yn(yo((c+1)*f),ka(s*f));return new Zd(y,_)}function VE(c){const s=ce(c.getNorth()),d=ce(c.getSouth()),f=Math.cos(s),y=Math.cos(d),_=Math.sin(s),k=Math.sin(d),E=c.getWest(),N=c.getEast();return[jm(y,k,E),jm(y,k,N),jm(f,_,N),jm(f,_,E)]}function jm(c,s,d,f=jc){return d=ce(d),[c*Math.sin(d)*f,-s*f,c*Math.cos(d)*f]}function Am(c,s,d){return jm(Math.cos(ce(c)),Math.sin(ce(c)),s,d)}function Gy(c,s,d,f){const y=1<<d.z,_=(c/cr+d.x)/y;return Am(ka((s/cr+d.y)/y),yo(_),f)}function d1({min:c,max:s}){return nJ/Math.max(s[0]-c[0],s[1]-c[1],s[2]-c[2])}const yD=new Float64Array(16);function Wy(c){const s=d1(c),d=eD(yD,[s,s,s]);return Ly(d,d,((f=[])[0]=-(y=c.min)[0],f[1]=-y[1],f[2]=-y[2],f));var f,y}function UE(c){const s=(f=c.min,(d=yD)[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=f[0],d[13]=f[1],d[14]=f[2],d[15]=1,d);var d,f;const y=1/d1(c);return Ff(s,s,[y,y,y])}function xD(c,s,d,f,y){const _=function(N){const M=cr/(2*Math.PI);return N/(2*Math.PI)/M}(d),k=[c,s,-d/(2*Math.PI)],E=Ol(new Float64Array(16));return Ly(E,E,k),Ff(E,E,[_,_,_]),ME(E,E,ce(-y)),l1(E,E,ce(-f)),E}function Nm(c){return Se(FE,fD,c)}function vD(c,s){const d=Am(s.lat,s.lng),f=function(ie){const fe=Am(ie._center.lat,ie._center.lng);let ge=RE([],Em(0,1,0),fe);const je=tD([],-ie.angle,fe);ge=ui(ge,ge,je),tD(je,-ie._pitch,ge);const Re=Za([],fe);return go(Re,Re,c1(ie.cameraToCenterDistance/ie.pixelsPerMeter)),ui(Re,Re,je),Du([],fe,Re)}(c);return k=(y=OE([],f,d))[0],E=y[1],N=y[2],M=(_=d)[0],F=_[1],q=_[2],te=(X=Math.sqrt(k*k+E*E+N*N)*Math.sqrt(M*M+F*F+q*q))&&Wo(y,_)/X,Math.acos(Math.min(Math.max(te,-1),1));var y,_,k,E,N,M,F,q,X,te}function qE(c,s){return vD(c,s)>Math.PI/2*1.01}const _D=ce(85),oJ=Math.cos(_D),lJ=Math.sin(_D),Hy=63710088e-1,bD=2*Math.PI*Hy;class Xd{constructor(s,d){if(isNaN(s)||isNaN(d))throw new Error(`Invalid LngLat object: (${s}, ${d})`);if(this.lng=+s,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Xd(be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const d=Math.PI/180,f=this.lat*d,y=s.lat*d,_=Math.sin(f)*Math.sin(y)+Math.cos(f)*Math.cos(y)*Math.cos((s.lng-this.lng)*d);return Hy*Math.acos(Math.min(_,1))}toBounds(s=0){const d=360*s/40075017,f=d/Math.cos(Math.PI/180*this.lat);return new Zd(new Xd(this.lng-f,this.lat-d),new Xd(this.lng+f,this.lat+d))}toEcef(s){const d=c1(s);return Am(this.lat,this.lng,jc+d)}static convert(s){if(s instanceof Xd)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Xd(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Xd(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var yn=Xd;function GE(c){return bD*Math.cos(c*Math.PI/180)}function Nc(c){return(180+c)/360}function Cc(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Ll(c,s){return c/GE(s)}function yo(c){return 360*c-180}function ka(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function wD(c,s){return c*GE(ka(s))}const Ta=85.051129;function kD(c){return 1/Math.cos(c*Math.PI/180)}class Cm{constructor(s,d,f=0){this.x=+s,this.y=+d,this.z=+f}static fromLngLat(s,d=0){const f=yn.convert(s);return new Cm(Nc(f.lng),Cc(f.lat),Ll(d,f.lat))}toLngLat(){return new yn(yo(this.x),ka(this.y))}toAltitude(){return wD(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/bD*kD(ka(this.y))}}function WE(c,s,d,f,y,_,k,E,N){const M=(s+f)/2,F=(d+y)/2,q=new V(M,F);E(q),function(X,te,ie,fe,ge,je){const Re=ie-ge,Ae=fe-je;return Math.abs((fe-te)*Re-(ie-X)*Ae)/Math.hypot(Re,Ae)}(q.x,q.y,_.x,_.y,k.x,k.y)>=N?(WE(c,s,d,M,F,_,q,E,N),WE(c,M,F,f,y,q,k,E,N)):c.push(k)}function TD(c,s,d){let f=c[0],y=f.x,_=f.y;s(f);const k=[f];for(let E=1;E<c.length;E++){const N=c[E],{x:M,y:F}=N;s(N),WE(k,y,_,M,F,f,N,s,d),y=M,_=F,f=N}return k}function HE(c,s,d,f){if(f(s,d)){const y=s.add(d)._mult(.5);HE(c,s,y,f),HE(c,y,d,f)}else c.push(d)}function cJ(c,s){let d=c[0];const f=[d];for(let y=1;y<c.length;y++){const _=c[y];HE(f,d,_,s),d=_}return f}const KE=Math.pow(2,14)-1,SD=-KE-1;function uJ(c,s){const d=Math.round(c.x*s),f=Math.round(c.y*s);return c.x=ye(d,SD,KE),c.y=ye(f,SD,KE),(d<c.x||d>c.x+1||f<c.y||f>c.y+1)&&Lt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function Ou(c,s,d){const f=c.loadGeometry(),y=c.extent,_=cr/y;if(s&&d&&d.projection.isReprojectedInTileSpace){const k=1<<s.z,{scale:E,x:N,y:M,projection:F}=d,q=X=>{const te=yo((s.x+X.x/y)/k),ie=ka((s.y+X.y/y)/k),fe=F.project(te,ie);X.x=(fe.x*E-N)*y,X.y=(fe.y*E-M)*y};for(let X=0;X<f.length;X++)if(c.type!==1)f[X]=TD(f[X],q,1);else{const te=[];for(const ie of f[X])ie.x<0||ie.x>=y||ie.y<0||ie.y>=y||(q(ie),te.push(ie));f[X]=te}}for(const k of f)for(const E of k)uJ(E,_);return f}function qf(c,s){return{type:c.type,id:c.id,properties:c.properties,geometry:s?Ou(c):[]}}function h1(c,s,d,f,y){c.emplaceBack(2*s+(f+1)/2,2*d+(y+1)/2)}function f1(c,s,d){c.emplaceBack(s.x,s.y,s.z,d[0]*16384,d[1]*16384,d[2]*16384)}class ZE{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.id),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new At,this.indexArray=new rr,this.segments=new vi,this.programConfigurations=new zf(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(s,d,f,y){const _=this.layers[0],k=[];let E=null;_.type==="circle"&&(E=_.layout.get("circle-sort-key"));for(const{feature:M,id:F,index:q,sourceLayerIndex:X}of s){const te=this.layers[0]._featureFilter.needGeometry,ie=qf(M,te);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),ie,f))continue;const fe=E?E.evaluate(ie,{},f):void 0,ge={id:F,properties:M.properties,type:M.type,sourceLayerIndex:X,index:q,geometry:te?ie.geometry:Ou(M,f,y),patterns:{},sortKey:fe};k.push(ge)}E&&k.sort((M,F)=>M.sortKey-F.sortKey);let N=null;y.projection.name==="globe"&&(this.globeExtVertexArray=new Pt,N=y.projection);for(const M of k){const{geometry:F,index:q,sourceLayerIndex:X}=M,te=s[q].feature;this.addFeature(M,F,q,d.availableImages,f,N),d.featureIndex.insert(te,F,q,X,this.index)}}update(s,d,f,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,d,this.stateDependentLayers,f,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,XY.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,YY.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,d,f,y,_,k){for(const E of d)for(const N of E){const M=N.x,F=N.y;if(M<0||M>=cr||F<0||F>=cr)continue;if(k){const te=k.projectTilePoint(M,F,_),ie=k.upVector(_,M,F),fe=this.globeExtVertexArray;f1(fe,te,ie),f1(fe,te,ie),f1(fe,te,ie),f1(fe,te,ie)}const q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),X=q.vertexLength;h1(this.layoutVertexArray,M,F,-1,-1),h1(this.layoutVertexArray,M,F,1,-1),h1(this.layoutVertexArray,M,F,1,1),h1(this.layoutVertexArray,M,F,-1,1),this.indexArray.emplaceBack(X,X+1,X+2),this.indexArray.emplaceBack(X,X+2,X+3),q.vertexLength+=4,q.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,{},y,_)}}function ED(c,s){for(let d=0;d<c.length;d++)if(Gf(s,c[d]))return!0;for(let d=0;d<s.length;d++)if(Gf(c,s[d]))return!0;return!!XE(c,s)}function dJ(c,s,d){return!!Gf(c,s)||!!YE(s,c,d)}function jD(c,s){if(c.length===1)return ND(s,c[0]);for(let d=0;d<s.length;d++){const f=s[d];for(let y=0;y<f.length;y++)if(Gf(c,f[y]))return!0}for(let d=0;d<c.length;d++)if(ND(s,c[d]))return!0;for(let d=0;d<s.length;d++)if(XE(c,s[d]))return!0;return!1}function hJ(c,s,d){if(c.length>1){if(XE(c,s))return!0;for(let f=0;f<s.length;f++)if(YE(s[f],c,d))return!0}for(let f=0;f<c.length;f++)if(YE(c[f],s,d))return!0;return!1}function XE(c,s){if(c.length===0||s.length===0)return!1;for(let d=0;d<c.length-1;d++){const f=c[d],y=c[d+1];for(let _=0;_<s.length-1;_++)if(fJ(f,y,s[_],s[_+1]))return!0}return!1}function fJ(c,s,d,f){return dr(c,d,f)!==dr(s,d,f)&&dr(c,s,d)!==dr(c,s,f)}function YE(c,s,d){const f=d*d;if(s.length===1)return c.distSqr(s[0])<f;for(let y=1;y<s.length;y++)if(AD(c,s[y-1],s[y])<f)return!0;return!1}function AD(c,s,d){const f=s.distSqr(d);if(f===0)return c.distSqr(s);const y=((c.x-s.x)*(d.x-s.x)+(c.y-s.y)*(d.y-s.y))/f;return c.distSqr(y<0?s:y>1?d:d.sub(s)._mult(y)._add(s))}function ND(c,s){let d,f,y,_=!1;for(let k=0;k<c.length;k++){d=c[k];for(let E=0,N=d.length-1;E<d.length;N=E++)f=d[E],y=d[N],f.y>s.y!=y.y>s.y&&s.x<(y.x-f.x)*(s.y-f.y)/(y.y-f.y)+f.x&&(_=!_)}return _}function Gf(c,s){let d=!1;for(let f=0,y=c.length-1;f<c.length;y=f++){const _=c[f],k=c[y];_.y>s.y!=k.y>s.y&&s.x<(k.x-_.x)*(s.y-_.y)/(k.y-_.y)+_.x&&(d=!d)}return d}function CD(c,s,d,f,y){for(const k of c)if(s<=k.x&&d<=k.y&&f>=k.x&&y>=k.y)return!0;const _=[new V(s,d),new V(s,y),new V(f,y),new V(f,d)];if(c.length>2){for(const k of _)if(Gf(c,k))return!0}for(let k=0;k<c.length-1;k++)if(pJ(c[k],c[k+1],_))return!0;return!1}function pJ(c,s,d){const f=d[0],y=d[2];if(c.x<f.x&&s.x<f.x||c.x>y.x&&s.x>y.x||c.y<f.y&&s.y<f.y||c.y>y.y&&s.y>y.y)return!1;const _=dr(c,s,d[0]);return _!==dr(c,s,d[1])||_!==dr(c,s,d[2])||_!==dr(c,s,d[3])}function Pm(c,s,d){const f=s.paint.get(c).value;return f.kind==="constant"?f.value:d.programConfigurations.get(s.id).getMaxValue(c)}function p1(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function PD(c,s,d,f,y){if(!s[0]&&!s[1])return c;const _=V.convert(s)._mult(y);d==="viewport"&&_._rotate(-f);const k=[];for(let E=0;E<c.length;E++)k.push(c[E].sub(_));return k}function ID(c,s,d,f){const y=V.convert(c)._mult(f);return s==="viewport"&&y._rotate(-d),y}Xt(ZE,"CircleBucket",{omit:["layers"]});const mJ=new Ie({"circle-sort-key":new ve(lt.layout_circle["circle-sort-key"])});var gJ={paint:new Ie({"circle-radius":new ve(lt.paint_circle["circle-radius"]),"circle-color":new ve(lt.paint_circle["circle-color"]),"circle-blur":new ve(lt.paint_circle["circle-blur"]),"circle-opacity":new ve(lt.paint_circle["circle-opacity"]),"circle-translate":new he(lt.paint_circle["circle-translate"]),"circle-translate-anchor":new he(lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new he(lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new he(lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ve(lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ve(lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ve(lt.paint_circle["circle-stroke-opacity"])}),layout:mJ};function MD(c,s,d,f,y,_,k,E,N){if(_&&c.queryGeometry.isAboveHorizon)return!1;_&&(N*=c.pixelToTileUnitsFactor);const M=c.tileID.canonical,F=d.projection.upVectorScale(M,d.center.lat,d.worldSize).metersToTile;for(const q of s)for(const X of q){const te=X.add(E),ie=y&&d.elevation?d.elevation.exaggeration()*y.getElevationAt(te.x,te.y,!0):0,fe=d.projection.projectTilePoint(te.x,te.y,M);if(ie>0){const Ae=d.projection.upVector(M,te.x,te.y);fe.x+=Ae[0]*F*ie,fe.y+=Ae[1]*F*ie,fe.z+=Ae[2]*F*ie}const ge=_?te:yJ(fe.x,fe.y,fe.z,f),je=_?c.tilespaceRays.map(Ae=>vJ(Ae,ie)):c.queryGeometry.screenGeometry,Re=Bf([],[fe.x,fe.y,fe.z,1],f);if(!k&&_?N*=Re[3]/d.cameraToCenterDistance:k&&!_&&(N*=d.cameraToCenterDistance/Re[3]),_){const Ae=ka((X.y/cr+M.y)/(1<<M.z));N/=d.projection.pixelsPerMeter(Ae,1)/Ll(1,Ae)}if(dJ(je,ge,N))return!0}return!1}function yJ(c,s,d,f){const y=Bf([],[c,s,d,1],f);return new V(y[0]/y[3],y[1]/y[3])}const DD=Em(0,0,0),xJ=Em(0,0,1);function vJ(c,s){const d=DE();return DD[2]=s,c.intersectsPlane(DD,xJ,d),new V(d[0],d[1])}class OD extends ZE{}function RD(c,{width:s,height:d},f,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==s*d*f)throw new RangeError("mismatched image size")}else y=new Uint8Array(s*d*f);return c.width=s,c.height=d,c.data=y,c}function LD(c,s,d){const{width:f,height:y}=s;f===c.width&&y===c.height||(JE(c,s,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,f),height:Math.min(c.height,y)},d),c.width=f,c.height=y,c.data=s.data)}function JE(c,s,d,f,y,_){if(y.width===0||y.height===0)return s;if(y.width>c.width||y.height>c.height||d.x>c.width-y.width||d.y>c.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>s.width||y.height>s.height||f.x>s.width-y.width||f.y>s.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const k=c.data,E=s.data;for(let N=0;N<y.height;N++){const M=((d.y+N)*c.width+d.x)*_,F=((f.y+N)*s.width+f.x)*_;for(let q=0;q<y.width*_;q++)E[F+q]=k[M+q]}return s}Xt(OD,"HeatmapBucket",{omit:["layers"]});class Ru{constructor(s,d){RD(this,s,1,d)}resize(s){LD(this,new Ru(s),1)}clone(){return new Ru({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,d,f,y,_){JE(s,d,f,y,_,1)}}class Us{constructor(s,d){RD(this,s,4,d)}resize(s){LD(this,new Us(s),4)}replace(s,d){d?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Us({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,d,f,y,_){JE(s,d,f,y,_,4)}}Xt(Ru,"AlphaImage"),Xt(Us,"RGBAImage");var _J={paint:new Ie({"heatmap-radius":new ve(lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ve(lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new he(lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Pe(lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new he(lt.paint_heatmap["heatmap-opacity"])})};function QE(c){const s={},d=c.resolution||256,f=c.clips?c.clips.length:1,y=c.image||new Us({width:d,height:f}),_=(k,E,N)=>{s[c.evaluationKey]=N;const M=c.expression.evaluate(s);y.data[k+E+0]=Math.floor(255*M.r/M.a),y.data[k+E+1]=Math.floor(255*M.g/M.a),y.data[k+E+2]=Math.floor(255*M.b/M.a),y.data[k+E+3]=Math.floor(255*M.a)};if(c.clips)for(let k=0,E=0;k<f;++k,E+=4*d)for(let N=0,M=0;N<d;N++,M+=4){const F=N/(d-1),{start:q,end:X}=c.clips[k];_(E,M,q*(1-F)+X*F)}else for(let k=0,E=0;k<d;k++,E+=4)_(0,E,k/(d-1));return y}var bJ={paint:new Ie({"hillshade-illumination-direction":new he(lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new he(lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new he(lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new he(lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new he(lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new he(lt.paint_hillshade["hillshade-accent-color"])})};const wJ=He([{name:"a_pos",components:2,type:"Int16"}],4),{members:kJ}=wJ;var ej={exports:{}};function m1(c,s,d){d=d||2;var f,y,_,k,E,N,M,F=s&&s.length,q=F?s[0]*d:c.length,X=zD(c,0,q,d,!0),te=[];if(!X||X.next===X.prev)return te;if(F&&(X=function(fe,ge,je,Re){var Ae,Oe,Be,Fe=[];for(Ae=0,Oe=ge.length;Ae<Oe;Ae++)(Be=zD(fe,ge[Ae]*Re,Ae<Oe-1?ge[Ae+1]*Re:fe.length,Re,!1))===Be.next&&(Be.steiner=!0),Fe.push(PJ(Be));for(Fe.sort(AJ),Ae=0;Ae<Fe.length;Ae++)je=NJ(Fe[Ae],je);return je}(c,s,X,d)),c.length>80*d){f=_=c[0],y=k=c[1];for(var ie=d;ie<q;ie+=d)(E=c[ie])<f&&(f=E),(N=c[ie+1])<y&&(y=N),E>_&&(_=E),N>k&&(k=N);M=(M=Math.max(_-f,k-y))!==0?32767/M:0}return Ky(X,te,d,f,y,M,0),te}function zD(c,s,d,f,y){var _,k;if(y===nj(c,s,d,f)>0)for(_=s;_<d;_+=f)k=BD(_,c[_],c[_+1],k);else for(_=d-f;_>=s;_-=f)k=BD(_,c[_],c[_+1],k);return k&&g1(k,k.next)&&(Xy(k),k=k.next),k}function Wf(c,s){if(!c)return c;s||(s=c);var d,f=c;do if(d=!1,f.steiner||!g1(f,f.next)&&_i(f.prev,f,f.next)!==0)f=f.next;else{if(Xy(f),(f=s=f.prev)===f.next)break;d=!0}while(d||f!==s);return s}function Ky(c,s,d,f,y,_,k){if(c){!k&&_&&function(F,q,X,te){var ie=F;do ie.z===0&&(ie.z=tj(ie.x,ie.y,q,X,te)),ie.prevZ=ie.prev,ie.nextZ=ie.next,ie=ie.next;while(ie!==F);ie.prevZ.nextZ=null,ie.prevZ=null,function(fe){var ge,je,Re,Ae,Oe,Be,Fe,nt,Qe=1;do{for(je=fe,fe=null,Oe=null,Be=0;je;){for(Be++,Re=je,Fe=0,ge=0;ge<Qe&&(Fe++,Re=Re.nextZ);ge++);for(nt=Qe;Fe>0||nt>0&&Re;)Fe!==0&&(nt===0||!Re||je.z<=Re.z)?(Ae=je,je=je.nextZ,Fe--):(Ae=Re,Re=Re.nextZ,nt--),Oe?Oe.nextZ=Ae:fe=Ae,Ae.prevZ=Oe,Oe=Ae;je=Re}Oe.nextZ=null,Qe*=2}while(Be>1)}(ie)}(c,f,y,_);for(var E,N,M=c;c.prev!==c.next;)if(E=c.prev,N=c.next,_?SJ(c,f,y,_):TJ(c))s.push(E.i/d|0),s.push(c.i/d|0),s.push(N.i/d|0),Xy(c),c=N.next,M=N.next;else if((c=N)===M){k?k===1?Ky(c=EJ(Wf(c),s,d),s,d,f,y,_,2):k===2&&jJ(c,s,d,f,y,_):Ky(Wf(c),s,d,f,y,_,1);break}}}function TJ(c){var s=c.prev,d=c,f=c.next;if(_i(s,d,f)>=0)return!1;for(var y=s.x,_=d.x,k=f.x,E=s.y,N=d.y,M=f.y,F=y<_?y<k?y:k:_<k?_:k,q=E<N?E<M?E:M:N<M?N:M,X=y>_?y>k?y:k:_>k?_:k,te=E>N?E>M?E:M:N>M?N:M,ie=f.next;ie!==s;){if(ie.x>=F&&ie.x<=X&&ie.y>=q&&ie.y<=te&&Im(y,E,_,N,k,M,ie.x,ie.y)&&_i(ie.prev,ie,ie.next)>=0)return!1;ie=ie.next}return!0}function SJ(c,s,d,f){var y=c.prev,_=c,k=c.next;if(_i(y,_,k)>=0)return!1;for(var E=y.x,N=_.x,M=k.x,F=y.y,q=_.y,X=k.y,te=E<N?E<M?E:M:N<M?N:M,ie=F<q?F<X?F:X:q<X?q:X,fe=E>N?E>M?E:M:N>M?N:M,ge=F>q?F>X?F:X:q>X?q:X,je=tj(te,ie,s,d,f),Re=tj(fe,ge,s,d,f),Ae=c.prevZ,Oe=c.nextZ;Ae&&Ae.z>=je&&Oe&&Oe.z<=Re;){if(Ae.x>=te&&Ae.x<=fe&&Ae.y>=ie&&Ae.y<=ge&&Ae!==y&&Ae!==k&&Im(E,F,N,q,M,X,Ae.x,Ae.y)&&_i(Ae.prev,Ae,Ae.next)>=0||(Ae=Ae.prevZ,Oe.x>=te&&Oe.x<=fe&&Oe.y>=ie&&Oe.y<=ge&&Oe!==y&&Oe!==k&&Im(E,F,N,q,M,X,Oe.x,Oe.y)&&_i(Oe.prev,Oe,Oe.next)>=0))return!1;Oe=Oe.nextZ}for(;Ae&&Ae.z>=je;){if(Ae.x>=te&&Ae.x<=fe&&Ae.y>=ie&&Ae.y<=ge&&Ae!==y&&Ae!==k&&Im(E,F,N,q,M,X,Ae.x,Ae.y)&&_i(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.prevZ}for(;Oe&&Oe.z<=Re;){if(Oe.x>=te&&Oe.x<=fe&&Oe.y>=ie&&Oe.y<=ge&&Oe!==y&&Oe!==k&&Im(E,F,N,q,M,X,Oe.x,Oe.y)&&_i(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}function EJ(c,s,d){var f=c;do{var y=f.prev,_=f.next.next;!g1(y,_)&&$D(y,f,f.next,_)&&Zy(y,_)&&Zy(_,y)&&(s.push(y.i/d|0),s.push(f.i/d|0),s.push(_.i/d|0),Xy(f),Xy(f.next),f=c=_),f=f.next}while(f!==c);return Wf(f)}function jJ(c,s,d,f,y,_){var k=c;do{for(var E=k.next.next;E!==k.prev;){if(k.i!==E.i&&IJ(k,E)){var N=FD(k,E);return k=Wf(k,k.next),N=Wf(N,N.next),Ky(k,s,d,f,y,_,0),void Ky(N,s,d,f,y,_,0)}E=E.next}k=k.next}while(k!==c)}function AJ(c,s){return c.x-s.x}function NJ(c,s){var d=function(y,_){var k,E=_,N=y.x,M=y.y,F=-1/0;do{if(M<=E.y&&M>=E.next.y&&E.next.y!==E.y){var q=E.x+(M-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(q<=N&&q>F&&(F=q,k=E.x<E.next.x?E:E.next,q===N))return k}E=E.next}while(E!==_);if(!k)return null;var X,te=k,ie=k.x,fe=k.y,ge=1/0;E=k;do N>=E.x&&E.x>=ie&&N!==E.x&&Im(M<fe?N:F,M,ie,fe,M<fe?F:N,M,E.x,E.y)&&(X=Math.abs(M-E.y)/(N-E.x),Zy(E,y)&&(X<ge||X===ge&&(E.x>k.x||E.x===k.x&&CJ(k,E)))&&(k=E,ge=X)),E=E.next;while(E!==te);return k}(c,s);if(!d)return s;var f=FD(d,c);return Wf(f,f.next),Wf(d,d.next)}function CJ(c,s){return _i(c.prev,c,s.prev)<0&&_i(s.next,c,c.next)<0}function tj(c,s,d,f,y){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-d)*y|0)|c<<8))|c<<4))|c<<2))|c<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-f)*y|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function PJ(c){var s=c,d=c;do(s.x<d.x||s.x===d.x&&s.y<d.y)&&(d=s),s=s.next;while(s!==c);return d}function Im(c,s,d,f,y,_,k,E){return(y-k)*(s-E)>=(c-k)*(_-E)&&(c-k)*(f-E)>=(d-k)*(s-E)&&(d-k)*(_-E)>=(y-k)*(f-E)}function IJ(c,s){return c.next.i!==s.i&&c.prev.i!==s.i&&!function(d,f){var y=d;do{if(y.i!==d.i&&y.next.i!==d.i&&y.i!==f.i&&y.next.i!==f.i&&$D(y,y.next,d,f))return!0;y=y.next}while(y!==d);return!1}(c,s)&&(Zy(c,s)&&Zy(s,c)&&function(d,f){var y=d,_=!1,k=(d.x+f.x)/2,E=(d.y+f.y)/2;do y.y>E!=y.next.y>E&&y.next.y!==y.y&&k<(y.next.x-y.x)*(E-y.y)/(y.next.y-y.y)+y.x&&(_=!_),y=y.next;while(y!==d);return _}(c,s)&&(_i(c.prev,c,s.prev)||_i(c,s.prev,s))||g1(c,s)&&_i(c.prev,c,c.next)>0&&_i(s.prev,s,s.next)>0)}function _i(c,s,d){return(s.y-c.y)*(d.x-s.x)-(s.x-c.x)*(d.y-s.y)}function g1(c,s){return c.x===s.x&&c.y===s.y}function $D(c,s,d,f){var y=x1(_i(c,s,d)),_=x1(_i(c,s,f)),k=x1(_i(d,f,c)),E=x1(_i(d,f,s));return y!==_&&k!==E||!(y!==0||!y1(c,d,s))||!(_!==0||!y1(c,f,s))||!(k!==0||!y1(d,c,f))||!(E!==0||!y1(d,s,f))}function y1(c,s,d){return s.x<=Math.max(c.x,d.x)&&s.x>=Math.min(c.x,d.x)&&s.y<=Math.max(c.y,d.y)&&s.y>=Math.min(c.y,d.y)}function x1(c){return c>0?1:c<0?-1:0}function Zy(c,s){return _i(c.prev,c,c.next)<0?_i(c,s,c.next)>=0&&_i(c,c.prev,s)>=0:_i(c,s,c.prev)<0||_i(c,c.next,s)<0}function FD(c,s){var d=new rj(c.i,c.x,c.y),f=new rj(s.i,s.x,s.y),y=c.next,_=s.prev;return c.next=s,s.prev=c,d.next=y,y.prev=d,f.next=d,d.prev=f,_.next=f,f.prev=_,f}function BD(c,s,d,f){var y=new rj(c,s,d);return f?(y.next=f.next,y.prev=f,f.next.prev=y,f.next=y):(y.prev=y,y.next=y),y}function Xy(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function rj(c,s,d){this.i=c,this.x=s,this.y=d,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function nj(c,s,d,f){for(var y=0,_=s,k=d-f;_<d;_+=f)y+=(c[k]-c[_])*(c[_+1]+c[k+1]),k=_;return y}ej.exports=m1,ej.exports.default=m1,m1.deviation=function(c,s,d,f){var y=s&&s.length,_=Math.abs(nj(c,0,y?s[0]*d:c.length,d));if(y)for(var k=0,E=s.length;k<E;k++)_-=Math.abs(nj(c,s[k]*d,k<E-1?s[k+1]*d:c.length,d));var N=0;for(k=0;k<f.length;k+=3){var M=f[k]*d,F=f[k+1]*d,q=f[k+2]*d;N+=Math.abs((c[M]-c[q])*(c[F+1]-c[M+1])-(c[M]-c[F])*(c[q+1]-c[M+1]))}return _===0&&N===0?0:Math.abs((N-_)/_)},m1.flatten=function(c){for(var s=c[0][0].length,d={vertices:[],holes:[],dimensions:s},f=0,y=0;y<c.length;y++){for(var _=0;_<c[y].length;_++)for(var k=0;k<s;k++)d.vertices.push(c[y][_][k]);y>0&&d.holes.push(f+=c[y-1].length)}return d};var ij=$(ej.exports);function MJ(c,s,d,f,y){VD(c,s,d||0,f||c.length-1,y||DJ)}function VD(c,s,d,f,y){for(;f>d;){if(f-d>600){var _=f-d+1,k=s-d+1,E=Math.log(_),N=.5*Math.exp(2*E/3),M=.5*Math.sqrt(E*N*(_-N)/_)*(k-_/2<0?-1:1);VD(c,s,Math.max(d,Math.floor(s-k*N/_+M)),Math.min(f,Math.floor(s+(_-k)*N/_+M)),y)}var F=c[s],q=d,X=f;for(Yy(c,d,s),y(c[f],F)>0&&Yy(c,d,f);q<X;){for(Yy(c,q,X),q++,X--;y(c[q],F)<0;)q++;for(;y(c[X],F)>0;)X--}y(c[d],F)===0?Yy(c,d,X):Yy(c,++X,f),X<=s&&(d=X+1),s<=X&&(f=X-1)}}function Yy(c,s,d){var f=c[s];c[s]=c[d],c[d]=f}function DJ(c,s){return c<s?-1:c>s?1:0}function aj(c,s){const d=c.length;if(d<=1)return[c];const f=[];let y,_;for(let k=0;k<d;k++){const E=Gr(c[k]);E!==0&&(c[k].area=Math.abs(E),_===void 0&&(_=E<0),_===E<0?(y&&f.push(y),y=[c[k]]):y.push(c[k]))}if(y&&f.push(y),s>1)for(let k=0;k<f.length;k++)f[k].length<=s||(MJ(f[k],s,1,f[k].length-1,OJ),f[k]=f[k].slice(0,s));return f}function OJ(c,s){return s.area-c.area}function sj(c,s,d){const f=d.patternDependencies;let y=!1;for(const _ of s){const k=_.paint.get(`${c}-pattern`);k.isConstant()||(y=!0);const E=k.constantOr(null);E&&(y=!0,f[E]=!0)}return y}function oj(c,s,d,f,y){const _=y.patternDependencies;for(const k of s){const E=k.paint.get(`${c}-pattern`).value;if(E.kind!=="constant"){let N=E.evaluate({zoom:f},d,{},y.availableImages);N=N&&N.name?N.name:N,_[N]=!0,d.patterns[k.id]=N}}return d}class v1{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new At,this.indexArray=new rr,this.indexArray2=new Ki,this.programConfigurations=new zf(s.layers,s.zoom),this.segments=new vi,this.segments2=new vi,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.projection=s.projection}populate(s,d,f,y){this.hasPattern=sj("fill",this.layers,d);const _=this.layers[0].layout.get("fill-sort-key"),k=[];for(const{feature:E,id:N,index:M,sourceLayerIndex:F}of s){const q=this.layers[0]._featureFilter.needGeometry,X=qf(E,q);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),X,f))continue;const te=_?_.evaluate(X,{},f,d.availableImages):void 0,ie={id:N,properties:E.properties,type:E.type,sourceLayerIndex:F,index:M,geometry:q?X.geometry:Ou(E,f,y),patterns:{},sortKey:te};k.push(ie)}_&&k.sort((E,N)=>E.sortKey-N.sortKey);for(const E of k){const{geometry:N,index:M,sourceLayerIndex:F}=E;if(this.hasPattern){const q=oj("fill",this.layers,E,this.zoom,d);this.patternFeatures.push(q)}else this.addFeature(E,N,M,f,{},d.availableImages);d.featureIndex.insert(s[M].feature,N,M,F,this.index)}}update(s,d,f,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,d,this.stateDependentLayers,f,y)}addFeatures(s,d,f,y,_){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,d,f,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,kJ),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,d,f,y,_,k=[]){for(const E of aj(d,500)){let N=0;for(const ie of E)N+=ie.length;const M=this.segments.prepareSegment(N,this.layoutVertexArray,this.indexArray),F=M.vertexLength,q=[],X=[];for(const ie of E){if(ie.length===0)continue;ie!==E[0]&&X.push(q.length/2);const fe=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),ge=fe.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(ge+ie.length-1,ge),q.push(ie[0].x),q.push(ie[0].y);for(let je=1;je<ie.length;je++)this.layoutVertexArray.emplaceBack(ie[je].x,ie[je].y),this.indexArray2.emplaceBack(ge+je-1,ge+je),q.push(ie[je].x),q.push(ie[je].y);fe.vertexLength+=ie.length,fe.primitiveLength+=ie.length}const te=ij(q,X);for(let ie=0;ie<te.length;ie+=3)this.indexArray.emplaceBack(F+te[ie],F+te[ie+1],F+te[ie+2]);M.vertexLength+=N,M.primitiveLength+=te.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,_,k,y)}}Xt(v1,"FillBucket",{omit:["layers","patternFeatures"]});const RJ=new Ie({"fill-sort-key":new ve(lt.layout_fill["fill-sort-key"])});var LJ={paint:new Ie({"fill-antialias":new he(lt.paint_fill["fill-antialias"]),"fill-opacity":new ve(lt.paint_fill["fill-opacity"]),"fill-color":new ve(lt.paint_fill["fill-color"]),"fill-outline-color":new ve(lt.paint_fill["fill-outline-color"]),"fill-translate":new he(lt.paint_fill["fill-translate"]),"fill-translate-anchor":new he(lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ve(lt.paint_fill["fill-pattern"])}),layout:RJ};const zJ=He([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),$J=He([{name:"a_centroid_pos",components:2,type:"Uint16"}]),FJ=He([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:BJ}=zJ;var _1={},VJ=W,UD=Mm;function Mm(c,s,d,f,y){this.properties={},this.extent=d,this.type=0,this._pbf=c,this._geometry=-1,this._keys=f,this._values=y,c.readFields(UJ,this,s)}function UJ(c,s,d){c==1?s.id=d.readVarint():c==2?function(f,y){for(var _=f.readVarint()+f.pos;f.pos<_;){var k=y._keys[f.readVarint()],E=y._values[f.readVarint()];y.properties[k]=E}}(d,s):c==3?s.type=d.readVarint():c==4&&(s._geometry=d.pos)}function qJ(c){for(var s,d,f=0,y=0,_=c.length,k=_-1;y<_;k=y++)f+=((d=c[k]).x-(s=c[y]).x)*(s.y+d.y);return f}Mm.types=["Unknown","Point","LineString","Polygon"],Mm.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var s,d=c.readVarint()+c.pos,f=1,y=0,_=0,k=0,E=[];c.pos<d;){if(y<=0){var N=c.readVarint();f=7&N,y=N>>3}if(y--,f===1||f===2)_+=c.readSVarint(),k+=c.readSVarint(),f===1&&(s&&E.push(s),s=[]),s.push(new VJ(_,k));else{if(f!==7)throw new Error("unknown command "+f);s&&s.push(s[0].clone())}}return s&&E.push(s),E},Mm.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var s=c.readVarint()+c.pos,d=1,f=0,y=0,_=0,k=1/0,E=-1/0,N=1/0,M=-1/0;c.pos<s;){if(f<=0){var F=c.readVarint();d=7&F,f=F>>3}if(f--,d===1||d===2)(y+=c.readSVarint())<k&&(k=y),y>E&&(E=y),(_+=c.readSVarint())<N&&(N=_),_>M&&(M=_);else if(d!==7)throw new Error("unknown command "+d)}return[k,N,E,M]},Mm.prototype.toGeoJSON=function(c,s,d){var f,y,_=this.extent*Math.pow(2,d),k=this.extent*c,E=this.extent*s,N=this.loadGeometry(),M=Mm.types[this.type];function F(te){for(var ie=0;ie<te.length;ie++){var fe=te[ie];te[ie]=[360*(fe.x+k)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(fe.y+E)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var q=[];for(f=0;f<N.length;f++)q[f]=N[f][0];F(N=q);break;case 2:for(f=0;f<N.length;f++)F(N[f]);break;case 3:for(N=function(te){var ie=te.length;if(ie<=1)return[te];for(var fe,ge,je=[],Re=0;Re<ie;Re++){var Ae=qJ(te[Re]);Ae!==0&&(ge===void 0&&(ge=Ae<0),ge===Ae<0?(fe&&je.push(fe),fe=[te[Re]]):fe.push(te[Re]))}return fe&&je.push(fe),je}(N),f=0;f<N.length;f++)for(y=0;y<N[f].length;y++)F(N[f][y])}N.length===1?N=N[0]:M="Multi"+M;var X={type:"Feature",geometry:{type:M,coordinates:N},properties:this.properties};return"id"in this&&(X.id=this.id),X};var GJ=UD,qD=GD;function GD(c,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(WJ,this,s),this.length=this._features.length}function WJ(c,s,d){c===15?s.version=d.readVarint():c===1?s.name=d.readString():c===5?s.extent=d.readVarint():c===2?s._features.push(d.pos):c===3?s._keys.push(d.readString()):c===4&&s._values.push(function(f){for(var y=null,_=f.readVarint()+f.pos;f.pos<_;){var k=f.readVarint()>>3;y=k===1?f.readString():k===2?f.readFloat():k===3?f.readDouble():k===4?f.readVarint64():k===5?f.readVarint():k===6?f.readSVarint():k===7?f.readBoolean():null}return y}(d))}GD.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var s=this._pbf.readVarint()+this._pbf.pos;return new GJ(this._pbf,s,this.extent,this._keys,this._values)};var HJ=qD;function KJ(c,s,d){if(c===3){var f=new HJ(d,d.readVarint()+d.pos);f.length&&(s[f.name]=f)}}var lj=_1.VectorTile=function(c,s){this.layers=c.readFields(KJ,{},s)},b1=_1.VectorTileFeature=UD;function w1(c,s,d,f){const y=[],_=f===0?(k,E,N,M,F,q)=>{k.push(new V(q,N+(q-E)/(M-E)*(F-N)))}:(k,E,N,M,F,q)=>{k.push(new V(E+(q-N)/(F-N)*(M-E),q))};for(const k of c){const E=[];for(const N of k){if(N.length<=2)continue;const M=[];for(let X=0;X<N.length-1;X++){const te=N[X].x,ie=N[X].y,fe=N[X+1].x,ge=N[X+1].y,je=f===0?te:ie,Re=f===0?fe:ge;je<s?Re>s&&_(M,te,ie,fe,ge,s):je>d?Re<d&&_(M,te,ie,fe,ge,d):M.push(N[X]),Re<s&&je>=s&&_(M,te,ie,fe,ge,s),Re>d&&je<=d&&_(M,te,ie,fe,ge,d)}let F=N[N.length-1];const q=f===0?F.x:F.y;q>=s&&q<=d&&M.push(F),M.length&&(F=M[M.length-1],M[0].x===F.x&&M[0].y===F.y||M.push(M[0]),E.push(M))}E.length&&y.push(E)}return y}_1.VectorTileLayer=qD;const ZJ=b1.types,XJ=Math.pow(2,13);function Jy(c,s,d,f,y,_,k,E){c.emplaceBack((s<<1)+k,(d<<1)+_,(Math.floor(f*XJ)<<1)+y,Math.round(E))}function Qy(c,s,d){c.emplaceBack(s.x,s.y,s.z,d[0]*16384,d[1]*16384,d[2]*16384)}class WD{constructor(){this.acc=new V(0,0),this.polyCount=[]}startRing(s){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new V(s.x,s.y),this.max=new V(s.x,s.y))}append(s,d){this.currentPolyCount.edges++,this.acc._add(s);const f=this.min,y=this.max;s.x<f.x?f.x=s.x:s.x>y.x&&(y.x=s.x),s.y<f.y?f.y=s.y:s.y>y.y&&(y.y=s.y),((s.x===0||s.x===cr)&&s.x===d.x)!=((s.y===0||s.y===cr)&&s.y===d.y)&&this.processBorderOverlap(s,d),d.x<0!=s.x<0&&this.addBorderIntersection(0,Z(d.y,s.y,(0-d.x)/(s.x-d.x))),d.x>cr!=s.x>cr&&this.addBorderIntersection(1,Z(d.y,s.y,(cr-d.x)/(s.x-d.x))),d.y<0!=s.y<0&&this.addBorderIntersection(2,Z(d.x,s.x,(0-d.y)/(s.y-d.y))),d.y>cr!=s.y>cr&&this.addBorderIntersection(3,Z(d.x,s.x,(cr-d.y)/(s.y-d.y)))}addBorderIntersection(s,d){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[s];d<f[0]&&(f[0]=d),d>f[1]&&(f[1]=d)}processBorderOverlap(s,d){if(s.x===d.x){if(s.y===d.y)return;const f=s.x===0?0:1;this.addBorderIntersection(f,d.y),this.addBorderIntersection(f,s.y)}else{const f=s.y===0?2:3;this.addBorderIntersection(f,d.x),this.addBorderIntersection(f,s.x)}}centroid(){const s=this.polyCount.reduce((d,f)=>d+f.edges,0);return s!==0?this.acc.div(s)._round():new V(0,0)}span(){return new V(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((s,d)=>s+ +(d[0]!==Number.MAX_VALUE),0)}}class ex{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.id),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.layoutVertexArray=new pt,this.centroidVertexArray=new Il,this.indexArray=new rr,this.programConfigurations=new zf(s.layers,s.zoom),this.segments=new vi,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.enableTerrain=s.enableTerrain}populate(s,d,f,y){this.features=[],this.hasPattern=sj("fill-extrusion",this.layers,d),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const k=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*k/(k*k+1)/cr/(1<<_.z)}(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:k,index:E,sourceLayerIndex:N}of s){const M=this.layers[0]._featureFilter.needGeometry,F=qf(_,M);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),F,f))continue;const q={id:k,sourceLayerIndex:N,index:E,geometry:M?F.geometry:Ou(_,f,y),properties:_.properties,type:_.type,patterns:{}},X=this.layoutVertexArray.length;this.hasPattern?this.features.push(oj("fill-extrusion",this.layers,q,this.zoom,d)):this.addFeature(q,q.geometry,E,f,{},d.availableImages,y),d.featureIndex.insert(_,q.geometry,E,N,this.index,X)}this.sortBorders()}addFeatures(s,d,f,y,_){for(const k of this.features){const{geometry:E}=k;this.addFeature(k,E,k.index,d,f,y,_)}this.sortBorders()}update(s,d,f,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,d,this.stateDependentLayers,f,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,BJ),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,FJ.members,!0))),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,$J.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,d,f,y,_,k,E){const N=[new V(0,0),new V(cr,cr)],M=E.projection,F=M.name==="globe",q=this.enableTerrain&&!F?new WD:null,X=ZJ[s.type]==="Polygon";F&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Pt);const te=aj(d,500);for(let je=te.length-1;je>=0;je--){const Re=te[je];(Re.length===0||(ie=Re[0]).every(Ae=>Ae.x<=0)||ie.every(Ae=>Ae.x>=cr)||ie.every(Ae=>Ae.y<=0)||ie.every(Ae=>Ae.y>=cr))&&te.splice(je,1)}var ie;let fe;if(F)fe=QD(te,N,y);else{fe=[];for(const je of te)fe.push({polygon:je,bounds:N})}const ge=X?this.edgeRadius:0;for(const{polygon:je,bounds:Re}of fe){let Ae=0,Oe=0;for(const Fe of je)X&&!Fe[0].equals(Fe[Fe.length-1])&&Fe.push(Fe[0]),Oe+=X?Fe.length-1:Fe.length;const Be=this.segments.prepareSegment((X?5:4)*Oe,this.layoutVertexArray,this.indexArray);if(X){const Fe=[],nt=[];Ae=Be.vertexLength;for(const dt of je){let Nt,st;dt.length&&dt!==je[0]&&nt.push(Fe.length/2),Nt=dt[1].sub(dt[0])._perp()._unit();for(let yt=1;yt<dt.length;yt++){const xt=dt[yt],kt=dt[yt===dt.length-1?1:yt+1];let{x:Ot,y:ct}=xt;if(ge){st=kt.sub(xt)._perp()._unit();const Ut=Nt.add(st)._unit(),er=ge*Math.min(4,1/(Nt.x*Ut.x+Nt.y*Ut.y));Ot+=er*Ut.x,ct+=er*Ut.y,Nt=st}Jy(this.layoutVertexArray,Ot,ct,0,0,1,1,0),Be.vertexLength++,Fe.push(xt.x,xt.y),F&&Qy(this.layoutVertexExtArray,M.projectTilePoint(Ot,ct,y),M.upVector(y,Ot,ct))}}const Qe=ij(Fe,nt);for(let dt=0;dt<Qe.length;dt+=3)this.indexArray.emplaceBack(Ae+Qe[dt],Ae+Qe[dt+2],Ae+Qe[dt+1]),Be.primitiveLength++}for(const Fe of je){q&&Fe.length&&q.startRing(Fe[0]);let nt,Qe,dt,Nt=Fe.length>4&&XD(Fe[Fe.length-2],Fe[0],Fe[1]),st=ge?YJ(Fe[Fe.length-2],Fe[0],Fe[1],ge):0;Qe=Fe[1].sub(Fe[0])._perp()._unit();let yt=!0;for(let xt=1,kt=0;xt<Fe.length;xt++){let Ot=Fe[xt-1],ct=Fe[xt];const Ut=Fe[xt===Fe.length-1?1:xt+1];if(q&&X&&q.currentPolyCount.top++,ZD(ct,Ot,Re)){ge&&(Qe=Ut.sub(ct)._perp()._unit(),yt=!yt);continue}q&&q.append(ct,Ot);const er=ct.sub(Ot)._perp(),Wt=er.x/(Math.abs(er.x)+Math.abs(er.y)),br=er.y>0?1:0,Rt=Ot.dist(ct);if(kt+Rt>32768&&(kt=0),ge){dt=Ut.sub(ct)._perp()._unit();let kr=KD(Ot,ct,Ut,HD(Qe,dt),ge);isNaN(kr)&&(kr=0);const hr=ct.sub(Ot)._unit();Ot=Ot.add(hr.mult(st))._round(),ct=ct.add(hr.mult(-kr))._round(),st=kr,Qe=dt}const sr=Be.vertexLength,wr=Fe.length>4&&XD(Ot,ct,Ut);let Zr=YD(kt,Nt,yt);if(Jy(this.layoutVertexArray,Ot.x,Ot.y,Wt,br,0,0,Zr),Jy(this.layoutVertexArray,Ot.x,Ot.y,Wt,br,0,1,Zr),kt+=Rt,Zr=YD(kt,wr,!yt),Nt=wr,Jy(this.layoutVertexArray,ct.x,ct.y,Wt,br,0,0,Zr),Jy(this.layoutVertexArray,ct.x,ct.y,Wt,br,0,1,Zr),Be.vertexLength+=4,this.indexArray.emplaceBack(sr+0,sr+1,sr+2),this.indexArray.emplaceBack(sr+1,sr+3,sr+2),Be.primitiveLength+=2,ge){const kr=Ae+(xt===1?Fe.length-2:xt-2),hr=xt===1?Ae:kr+1;if(this.indexArray.emplaceBack(sr+1,kr,sr+3),this.indexArray.emplaceBack(kr,hr,sr+3),Be.primitiveLength+=2,nt===void 0&&(nt=sr),!ZD(Ut,Fe[xt],Re)){const An=xt===Fe.length-1?nt:Be.vertexLength;this.indexArray.emplaceBack(sr+2,sr+3,An),this.indexArray.emplaceBack(sr+3,An+1,An),this.indexArray.emplaceBack(sr+3,hr,An+1),Be.primitiveLength+=3}yt=!yt}if(F){const kr=this.layoutVertexExtArray,hr=M.projectTilePoint(Ot.x,Ot.y,y),An=M.projectTilePoint(ct.x,ct.y,y),Er=M.upVector(y,Ot.x,Ot.y),jr=M.upVector(y,ct.x,ct.y);Qy(kr,hr,Er),Qy(kr,hr,Er),Qy(kr,An,jr),Qy(kr,An,jr)}}X&&(Ae+=Fe.length-1)}}if(q&&q.polyCount.length>0){if(q.borders){q.vertexArrayOffset=this.centroidVertexArray.length;const je=q.borders,Re=this.featuresOnBorder.push(q)-1;for(let Ae=0;Ae<4;Ae++)je[Ae][0]!==Number.MAX_VALUE&&this.borders[Ae].push(Re)}this.encodeCentroid(q.borders?void 0:q.centroid(),q)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,_,k,y)}sortBorders(){for(let s=0;s<4;s++)this.borders[s].sort((d,f)=>this.featuresOnBorder[d].borders[s][0]-this.featuresOnBorder[f].borders[s][0])}encodeCentroid(s,d,f=!0){let y,_;if(s)if(s.y!==0){const E=d.span()._mult(this.tileToMeter);y=(Math.max(s.x,1)<<3)+Math.min(7,Math.round(E.x/10)),_=(Math.max(s.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else y=Math.ceil(7*(s.x+450)),_=0;else y=0,_=+f;let k=f?this.centroidVertexArray.length:d.vertexArrayOffset;for(const E of d.polyCount){f&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let N=0;N<E.top;N++)this.centroidVertexArray.emplace(k++,y,_);for(let N=0;N<2*E.edges;N++)this.centroidVertexArray.emplace(k++,0,_),this.centroidVertexArray.emplace(k++,y,_)}}}function HD(c,s){const d=c.add(s)._unit();return c.x*d.x+c.y*d.y}function YJ(c,s,d,f){const y=s.sub(c)._perp()._unit(),_=d.sub(s)._perp()._unit();return KD(c,s,d,HD(y,_),f)}function KD(c,s,d,f,y){const _=Math.sqrt(1-f*f);return Math.min(c.dist(s)/3,s.dist(d)/3,y*_/f)}function ZD(c,s,d){return c.x<d[0].x&&s.x<d[0].x||c.x>d[1].x&&s.x>d[1].x||c.y<d[0].y&&s.y<d[0].y||c.y>d[1].y&&s.y>d[1].y}function XD(c,s,d){if(c.x<0||c.x>=cr||s.x<0||s.x>=cr||d.x<0||d.x>=cr)return!1;const f=d.sub(s),y=f.perp(),_=c.sub(s);return(f.x*_.x+f.y*_.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(_.x*_.x+_.y*_.y))>-.866&&y.x*_.x+y.y*_.y<0}function YD(c,s,d){const f=s?2|c:-3&c;return d?1|f:-2&f}function JD(){const c=Math.PI/32,s=Math.tan(c),d=Hy;return d*Math.sqrt(1+2*s*s)-d}function QD(c,s,d){const f=1<<d.z,y=yo(d.x/f),_=yo((d.x+1)/f),k=ka(d.y/f),E=ka((d.y+1)/f);return function(N,M,F,q,X=0,te){const ie=[];if(!N.length||!F||!q)return ie;const fe=(Fe,nt)=>{for(const Qe of Fe)ie.push({polygon:Qe,bounds:nt})},ge=Math.ceil(Math.log2(F)),je=Math.ceil(Math.log2(q)),Re=ge-je,Ae=[];for(let Fe=0;Fe<Math.abs(Re);Fe++)Ae.push(Re>0?0:1);for(let Fe=0;Fe<Math.min(ge,je);Fe++)Ae.push(0),Ae.push(1);let Oe=N;if(Oe=w1(Oe,M[0].y-X,M[1].y+X,1),Oe=w1(Oe,M[0].x-X,M[1].x+X,0),!Oe.length)return ie;const Be=[];for(Ae.length?Be.push({polygons:Oe,bounds:M,depth:0}):fe(Oe,M);Be.length;){const Fe=Be.pop(),nt=Fe.depth,Qe=Ae[nt],dt=Fe.bounds[0],Nt=Fe.bounds[1],st=Qe===0?dt.x:dt.y,yt=Qe===0?Nt.x:Nt.y,xt=te?te(Qe,st,yt):.5*(st+yt),kt=w1(Fe.polygons,st-X,xt+X,Qe),Ot=w1(Fe.polygons,xt-X,yt+X,Qe);if(kt.length){const ct=[dt,new V(Qe===0?xt:Nt.x,Qe===1?xt:Nt.y)];Ae.length>nt+1?Be.push({polygons:kt,bounds:ct,depth:nt+1}):fe(kt,ct)}if(Ot.length){const ct=[new V(Qe===0?xt:dt.x,Qe===1?xt:dt.y),Nt];Ae.length>nt+1?Be.push({polygons:Ot,bounds:ct,depth:nt+1}):fe(Ot,ct)}}return ie}(c,s,Math.ceil((_-y)/11.25),Math.ceil((k-E)/11.25),1,(N,M,F)=>{if(N===0)return .5*(M+F);{const q=ka((d.y+M/cr)/f);return(Cc(.5*(ka((d.y+F/cr)/f)+q))*f-d.y)*cr}})}Xt(ex,"FillExtrusionBucket",{omit:["layers","features"]}),Xt(WD,"PartMetadata");const JJ=new Ie({"fill-extrusion-edge-radius":new he(lt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var QJ={paint:new Ie({"fill-extrusion-opacity":new he(lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ve(lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new he(lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new he(lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ve(lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ve(lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ve(lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new he(lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new he(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new he(lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new he(lt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:JJ};function eO(c,s,d){var f=2*Math.PI*6378137/256/Math.pow(2,d);return[c*f-2*Math.PI*6378137/2,s*f-2*Math.PI*6378137/2]}class k1{constructor(s,d,f){this.z=s,this.x=d,this.y=f,this.key=tx(0,s,s,d,f)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,d){const f=function(_,k,E){var N=eO(256*_,256*(k=Math.pow(2,E)-k-1),E),M=eO(256*(_+1),256*(k+1),E);return N[0]+","+N[1]+","+M[0]+","+M[1]}(this.x,this.y,this.z),y=function(_,k,E){let N,M="";for(let F=_;F>0;F--)N=1<<F-1,M+=(k&N?1:0)+(E&N?2:0);return M}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",y).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class tO{constructor(s,d){this.wrap=s,this.canonical=d,this.key=tx(s,d.z,d.z,d.x,d.y)}}class Ya{constructor(s,d,f,y,_){this.overscaledZ=s,this.wrap=d,this.canonical=new k1(f,+y,+_),this.key=d===0&&s===f?this.canonical.key:tx(d,s,f,y,_)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const d=this.canonical.z-s;return s>this.canonical.z?new Ya(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ya(s,this.wrap,s,this.canonical.x>>d,this.canonical.y>>d)}calculateScaledKey(s,d=!0){if(this.overscaledZ===s&&d)return this.key;if(s>this.canonical.z)return tx(this.wrap*+d,s,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-s;return tx(this.wrap*+d,s,s,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const d=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>d&&s.canonical.y===this.canonical.y>>d}children(s){if(this.overscaledZ>=s)return[new Ya(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,f=2*this.canonical.x,y=2*this.canonical.y;return[new Ya(d,this.wrap,d,f,y),new Ya(d,this.wrap,d,f+1,y),new Ya(d,this.wrap,d,f,y+1),new Ya(d,this.wrap,d,f+1,y+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Ya(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Ya(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new tO(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function tx(c,s,d,f,y){const _=1<<Math.min(d,22);let k=_*(y%_)+f%_;return c&&d<22&&(k+=_*_*((c<0?-2*c-1:2*c)%(1<<2*(22-d)))),16*(32*k+d)+(s-d)}Xt(k1,"CanonicalTileID"),Xt(Ya,"OverscaledTileID",{omit:["projMatrix"]});class Dm extends V{constructor(s,d,f){super(s,d),this.z=f}}function rx(c,s){return c.x*s.x+c.y*s.y}function rO(c,s){if(c.length===1){let d=0;const f=s[d++];let y;for(;!y||f.equals(y);)if(y=s[d++],!y)return 1/0;for(;d<s.length;d++){const _=s[d],k=c[0],E=y.sub(f),N=_.sub(f),M=k.sub(f),F=rx(E,E),q=rx(E,N),X=rx(N,N),te=rx(M,E),ie=rx(M,N),fe=F*X-q*q,ge=(X*te-q*ie)/fe,je=(F*ie-q*te)/fe,Re=f.z*(1-ge-je)+y.z*ge+_.z*je;if(isFinite(Re))return Re}return 1/0}{let d=1/0;for(const f of s)d=Math.min(d,f.z);return d}}function nO(c,s,d,f,y,_,k,E){const N=k*y.getElevationAt(c,s,!0,!0),M=_[0]!==0,F=M?_[1]===0?k*(_[0]/7-450):k*function(q,X,te){const ie=Math.floor(X[0]/8),fe=Math.floor(X[1]/8),ge=10*(X[0]-8*ie),je=10*(X[1]-8*fe),Re=q.getElevationAt(ie,fe,!0,!0),Ae=q.getMeterToDEM(te),Oe=Math.floor(.5*(ge*Ae-1)),Be=Math.floor(.5*(je*Ae-1)),Fe=q.tileCoordToPixel(ie,fe),nt=2*Oe+1,Qe=2*Be+1,dt=function(Ot,ct,Ut,er,Wt){return[Ot.getElevationAtPixel(ct,Ut,!0),Ot.getElevationAtPixel(ct+Wt,Ut,!0),Ot.getElevationAtPixel(ct,Ut+Wt,!0),Ot.getElevationAtPixel(ct+er,Ut+Wt,!0)]}(q,Fe.x-Oe,Fe.y-Be,nt,Qe),Nt=Math.abs(dt[0]-dt[1]),st=Math.abs(dt[2]-dt[3]),yt=Math.abs(dt[0]-dt[2])+Math.abs(dt[1]-dt[3]),xt=Math.min(.25,.5*Ae*(Nt+st)/nt),kt=Math.min(.25,.5*Ae*yt/Qe);return Re+Math.max(xt*ge,kt*je)}(y,_,E):N;return{base:N+(d===0)?-1:d,top:M?Math.max(F+f,N+d+2):N+f}}const eQ=He([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:tQ}=eQ,rQ=He([{name:"a_packed",components:4,type:"Float32"}]),{members:nQ}=rQ,iQ=b1.types,aQ=Math.cos(Math.PI/180*37.5);class T1{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.id),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(d=>{this.gradients[d.id]={}}),this.layoutVertexArray=new at,this.layoutVertexArray2=new Et,this.indexArray=new rr,this.programConfigurations=new zf(s.layers,s.zoom),this.segments=new vi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(s,d,f,y){this.hasPattern=sj("line",this.layers,d);const _=this.layers[0].layout.get("line-sort-key"),k=[];for(const{feature:F,id:q,index:X,sourceLayerIndex:te}of s){const ie=this.layers[0]._featureFilter.needGeometry,fe=qf(F,ie);if(!this.layers[0]._featureFilter.filter(new U(this.zoom),fe,f))continue;const ge=_?_.evaluate(fe,{},f):void 0,je={id:q,properties:F.properties,type:F.type,sourceLayerIndex:te,index:X,geometry:ie?fe.geometry:Ou(F,f,y),patterns:{},sortKey:ge};k.push(je)}_&&k.sort((F,q)=>F.sortKey-q.sortKey);const{lineAtlas:E,featureIndex:N}=d,M=this.addConstantDashes(E);for(const F of k){const{geometry:q,index:X,sourceLayerIndex:te}=F;if(M&&this.addFeatureDashes(F,E),this.hasPattern){const ie=oj("line",this.layers,F,this.zoom,d);this.patternFeatures.push(ie)}else this.addFeature(F,q,X,f,E.positions,d.availableImages);N.insert(s[X].feature,q,X,te,this.index)}}addConstantDashes(s){let d=!1;for(const f of this.layers){const y=f.paint.get("line-dasharray").value,_=f.layout.get("line-cap").value;if(y.kind!=="constant"||_.kind!=="constant")d=!0;else{const k=_.value,E=y.value;if(!E)continue;s.addDash(E,k)}}return d}addFeatureDashes(s,d){const f=this.zoom;for(const y of this.layers){const _=y.paint.get("line-dasharray").value,k=y.layout.get("line-cap").value;if(_.kind==="constant"&&k.kind==="constant")continue;let E,N;if(_.kind==="constant"){if(E=_.value,!E)continue}else E=_.evaluate({zoom:f},s);N=k.kind==="constant"?k.value:k.evaluate({zoom:f},s),d.addDash(E,N),s.patterns[y.id]=d.getKey(E,N)}}update(s,d,f,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,d,this.stateDependentLayers,f,y)}addFeatures(s,d,f,y,_){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,d,f,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,nQ)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,tQ),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,d,f,y,_,k){const E=this.layers[0].layout,N=E.get("line-join").evaluate(s,{}),M=E.get("line-cap").evaluate(s,{}),F=E.get("line-miter-limit"),q=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const X of d)this.addLine(X,s,N,M,F,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,_,k,y)}addLine(s,d,f,y,_,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let je=0;je<s.length-1;je++)this.totalDistance+=s[je].dist(s[je+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=iQ[d.type]==="Polygon";let N=s.length;for(;N>=2&&s[N-1].equals(s[N-2]);)N--;let M=0;for(;M<N-1&&s[M].equals(s[M+1]);)M++;if(N<(E?3:2))return;f==="bevel"&&(_=1.05);const F=this.overscaling<=16?15*cr/(512*this.overscaling):0,q=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let X,te,ie,fe,ge;this.e1=this.e2=-1,E&&(X=s[N-2],ge=s[M].sub(X)._unit()._perp());for(let je=M;je<N;je++){if(ie=je===N-1?E?s[M+1]:void 0:s[je+1],ie&&s[je].equals(ie))continue;ge&&(fe=ge),X&&(te=X),X=s[je],ge=ie?ie.sub(X)._unit()._perp():fe,fe=fe||ge;let Re=fe.add(ge);Re.x===0&&Re.y===0||Re._unit();const Ae=fe.x*ge.x+fe.y*ge.y,Oe=Re.x*ge.x+Re.y*ge.y,Be=Oe!==0?1/Oe:1/0,Fe=2*Math.sqrt(2-2*Oe),nt=Oe<aQ&&te&&ie,Qe=fe.x*ge.y-fe.y*ge.x>0;if(nt&&je>M){const st=X.dist(te);if(st>2*F){const yt=X.sub(X.sub(te)._mult(F/st)._round());this.updateDistance(te,yt),this.addCurrentVertex(yt,fe,0,0,q),te=yt}}const dt=te&&ie;let Nt=dt?f:E?"butt":y;if(dt&&Nt==="round"&&(Be<k?Nt="miter":Be<=2&&(Nt="fakeround")),Nt==="miter"&&Be>_&&(Nt="bevel"),Nt==="bevel"&&(Be>2&&(Nt="flipbevel"),Be<_&&(Nt="miter")),te&&this.updateDistance(te,X),Nt==="miter")Re._mult(Be),this.addCurrentVertex(X,Re,0,0,q);else if(Nt==="flipbevel"){if(Be>100)Re=ge.mult(-1);else{const st=Be*fe.add(ge).mag()/fe.sub(ge).mag();Re._perp()._mult(st*(Qe?-1:1))}this.addCurrentVertex(X,Re,0,0,q),this.addCurrentVertex(X,Re.mult(-1),0,0,q)}else if(Nt==="bevel"||Nt==="fakeround"){const st=-Math.sqrt(Be*Be-1),yt=Qe?st:0,xt=Qe?0:st;if(te&&this.addCurrentVertex(X,fe,yt,xt,q),Nt==="fakeround"){const kt=Math.round(180*Fe/Math.PI/20);for(let Ot=1;Ot<kt;Ot++){let ct=Ot/kt;if(ct!==.5){const er=ct-.5;ct+=ct*er*(ct-1)*((1.0904+Ae*(Ae*(3.55645-1.43519*Ae)-3.2452))*er*er+(.848013+Ae*(.215638*Ae-1.06021)))}const Ut=ge.sub(fe)._mult(ct)._add(fe)._unit()._mult(Qe?-1:1);this.addHalfVertex(X,Ut.x,Ut.y,!1,Qe,0,q)}}ie&&this.addCurrentVertex(X,ge,-yt,-xt,q)}else if(Nt==="butt")this.addCurrentVertex(X,Re,0,0,q);else if(Nt==="square"){const st=te?1:-1;te||this.addCurrentVertex(X,Re,st,st,q),this.addCurrentVertex(X,Re,0,0,q),te&&this.addCurrentVertex(X,Re,st,st,q)}else Nt==="round"&&(te&&(this.addCurrentVertex(X,fe,0,0,q),this.addCurrentVertex(X,fe,1,1,q,!0)),ie&&(this.addCurrentVertex(X,ge,-1,-1,q,!0),this.addCurrentVertex(X,ge,0,0,q)));if(nt&&je<N-1){const st=X.dist(ie);if(st>2*F){const yt=X.add(ie.sub(X)._mult(F/st)._round());this.updateDistance(X,yt),this.addCurrentVertex(yt,ge,0,0,q),X=yt}}}}addCurrentVertex(s,d,f,y,_,k=!1){const E=d.y*y-d.x,N=-d.y-d.x*y;this.addHalfVertex(s,d.x+d.y*f,d.y-d.x*f,k,!1,f,_),this.addHalfVertex(s,E,N,k,!0,-y,_)}addHalfVertex({x:s,y:d},f,y,_,k,E,N){this.layoutVertexArray.emplaceBack((s<<1)+(_?1:0),(d<<1)+(k?1:0),Math.round(63*f)+128,Math.round(63*y)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),N.primitiveLength++),k?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,d){this.distance+=s.dist(d),this.updateScaledDistance()}}Xt(T1,"LineBucket",{omit:["layers","patternFeatures"]});const sQ=new Ie({"line-cap":new ve(lt.layout_line["line-cap"]),"line-join":new ve(lt.layout_line["line-join"]),"line-miter-limit":new he(lt.layout_line["line-miter-limit"]),"line-round-limit":new he(lt.layout_line["line-round-limit"]),"line-sort-key":new ve(lt.layout_line["line-sort-key"])});var iO={paint:new Ie({"line-opacity":new ve(lt.paint_line["line-opacity"]),"line-color":new ve(lt.paint_line["line-color"]),"line-translate":new he(lt.paint_line["line-translate"]),"line-translate-anchor":new he(lt.paint_line["line-translate-anchor"]),"line-width":new ve(lt.paint_line["line-width"]),"line-gap-width":new ve(lt.paint_line["line-gap-width"]),"line-offset":new ve(lt.paint_line["line-offset"]),"line-blur":new ve(lt.paint_line["line-blur"]),"line-dasharray":new ve(lt.paint_line["line-dasharray"]),"line-pattern":new ve(lt.paint_line["line-pattern"]),"line-gradient":new Pe(lt.paint_line["line-gradient"]),"line-trim-offset":new he(lt.paint_line["line-trim-offset"])}),layout:sQ};const aO=new class extends ve{possiblyEvaluate(c,s){return s=new U(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(c,s)}evaluate(c,s,d,f){return s=Ye({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(c,s,d,f)}}(iO.paint.properties["line-width"].specification);function sO(c,s){return s>0?s+2*c:c}aO.useIntegerZoom=!0;const oQ=He([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),lQ=He([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),cQ=He([{name:"a_projected_pos",components:4,type:"Float32"}],4);He([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const uQ=He([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),dQ=He([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);He([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const oO=He([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),hQ=He([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);He([{name:"triangle",components:3,type:"Uint16"}]),He([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),He([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),He([{type:"Float32",name:"offsetX"}]),He([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var la=24;const zl=128;function cj(c,s){const{expression:d}=s;if(d.kind==="constant")return{kind:"constant",layoutSize:d.evaluate(new U(c+1))};if(d.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:y}=d;let _=0;for(;_<f.length&&f[_]<=c;)_++;_=Math.max(0,_-1);let k=_;for(;k<f.length&&f[k]<c+1;)k++;k=Math.min(f.length-1,k);const E=f[_],N=f[k];return d.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:N,interpolationType:y}:{kind:"camera",minZoom:E,maxZoom:N,minSize:d.evaluate(new U(E)),maxSize:d.evaluate(new U(N)),interpolationType:y}}}function S1(c,{uSize:s,uSizeT:d},{lowerSize:f,upperSize:y}){return c.kind==="source"?f/zl:c.kind==="composite"?Z(f/zl,y/zl,d):s}function Om(c,s){let d=0,f=0;if(c.kind==="constant")f=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:y,minZoom:_,maxZoom:k}=c,E=y?ye(Uo.interpolationFactor(y,s,_,k),0,1):0;c.kind==="camera"?f=Z(c.minSize,c.maxSize,E):d=E}return{uSizeT:d,uSize:f}}var fQ=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:zl,evaluateSizeForFeature:S1,evaluateSizeForZoom:Om,getSizeData:cj});function pQ(c,s,d){return c.sections.forEach(f=>{f.text=function(y,_,k){const E=_.layout.get("text-transform").evaluate(k,{});return E==="uppercase"?y=y.toLocaleUpperCase():E==="lowercase"&&(y=y.toLocaleLowerCase()),z.applyArabicShaping&&(y=z.applyArabicShaping(y)),y}(f.text,s,d)}),c}const nx={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function mQ(c){return c==="︶"||c==="﹈"||c==="︸"||c==="﹄"||c==="﹂"||c==="︾"||c==="︼"||c==="︺"||c==="︘"||c==="﹀"||c==="︐"||c==="︓"||c==="︔"||c==="｀"||c==="￣"||c==="︑"||c==="︒"}function gQ(c){return c==="︵"||c==="﹇"||c==="︷"||c==="﹃"||c==="﹁"||c==="︽"||c==="︻"||c==="︹"||c==="︗"||c==="︿"}var lO=kn,cO=function(c,s,d,f,y){var _,k,E=8*y-f-1,N=(1<<E)-1,M=N>>1,F=-7,q=d?y-1:0,X=d?-1:1,te=c[s+q];for(q+=X,_=te&(1<<-F)-1,te>>=-F,F+=E;F>0;_=256*_+c[s+q],q+=X,F-=8);for(k=_&(1<<-F)-1,_>>=-F,F+=f;F>0;k=256*k+c[s+q],q+=X,F-=8);if(_===0)_=1-M;else{if(_===N)return k?NaN:1/0*(te?-1:1);k+=Math.pow(2,f),_-=M}return(te?-1:1)*k*Math.pow(2,_-f)},uO=function(c,s,d,f,y,_){var k,E,N,M=8*_-y-1,F=(1<<M)-1,q=F>>1,X=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,te=f?0:_-1,ie=f?1:-1,fe=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(E=isNaN(s)?1:0,k=F):(k=Math.floor(Math.log(s)/Math.LN2),s*(N=Math.pow(2,-k))<1&&(k--,N*=2),(s+=k+q>=1?X/N:X*Math.pow(2,1-q))*N>=2&&(k++,N/=2),k+q>=F?(E=0,k=F):k+q>=1?(E=(s*N-1)*Math.pow(2,y),k+=q):(E=s*Math.pow(2,q-1)*Math.pow(2,y),k=0));y>=8;c[d+te]=255&E,te+=ie,E/=256,y-=8);for(k=k<<y|E,M+=y;M>0;c[d+te]=255&k,te+=ie,k/=256,M-=8);c[d+te-ie]|=128*fe};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function kn(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}kn.Varint=0,kn.Fixed64=1,kn.Bytes=2,kn.Fixed32=5;var uj=4294967296,dO=1/uj,hO=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Lu(c){return c.type===kn.Bytes?c.readVarint()+c.pos:c.pos+1}function Rm(c,s,d){return d?4294967296*s+(c>>>0):4294967296*(s>>>0)+(c>>>0)}function fO(c,s,d){var f=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));d.realloc(f);for(var y=d.pos-1;y>=c;y--)d.buf[y+f]=d.buf[y]}function yQ(c,s){for(var d=0;d<c.length;d++)s.writeVarint(c[d])}function xQ(c,s){for(var d=0;d<c.length;d++)s.writeSVarint(c[d])}function vQ(c,s){for(var d=0;d<c.length;d++)s.writeFloat(c[d])}function _Q(c,s){for(var d=0;d<c.length;d++)s.writeDouble(c[d])}function bQ(c,s){for(var d=0;d<c.length;d++)s.writeBoolean(c[d])}function wQ(c,s){for(var d=0;d<c.length;d++)s.writeFixed32(c[d])}function kQ(c,s){for(var d=0;d<c.length;d++)s.writeSFixed32(c[d])}function TQ(c,s){for(var d=0;d<c.length;d++)s.writeFixed64(c[d])}function SQ(c,s){for(var d=0;d<c.length;d++)s.writeSFixed64(c[d])}function E1(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+16777216*c[s+3]}function Lm(c,s,d){c[d]=s,c[d+1]=s>>>8,c[d+2]=s>>>16,c[d+3]=s>>>24}function pO(c,s){return(c[s]|c[s+1]<<8|c[s+2]<<16)+(c[s+3]<<24)}kn.prototype={destroy:function(){this.buf=null},readFields:function(c,s,d){for(d=d||this.length;this.pos<d;){var f=this.readVarint(),y=f>>3,_=this.pos;this.type=7&f,c(y,s,this),this.pos===_&&this.skip(f)}return s},readMessage:function(c,s){return this.readFields(c,s,this.readVarint()+this.pos)},readFixed32:function(){var c=E1(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=pO(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=E1(this.buf,this.pos)+E1(this.buf,this.pos+4)*uj;return this.pos+=8,c},readSFixed64:function(){var c=E1(this.buf,this.pos)+pO(this.buf,this.pos+4)*uj;return this.pos+=8,c},readFloat:function(){var c=cO(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=cO(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var s,d,f=this.buf;return s=127&(d=f[this.pos++]),d<128?s:(s|=(127&(d=f[this.pos++]))<<7,d<128?s:(s|=(127&(d=f[this.pos++]))<<14,d<128?s:(s|=(127&(d=f[this.pos++]))<<21,d<128?s:function(y,_,k){var E,N,M=k.buf;if(E=(112&(N=M[k.pos++]))>>4,N<128||(E|=(127&(N=M[k.pos++]))<<3,N<128)||(E|=(127&(N=M[k.pos++]))<<10,N<128)||(E|=(127&(N=M[k.pos++]))<<17,N<128)||(E|=(127&(N=M[k.pos++]))<<24,N<128)||(E|=(1&(N=M[k.pos++]))<<31,N<128))return Rm(y,E,_);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(d=f[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,s=this.pos;return this.pos=c,c-s>=12&&hO?function(d,f,y){return hO.decode(d.subarray(f,y))}(this.buf,s,c):function(d,f,y){for(var _="",k=f;k<y;){var E,N,M,F=d[k],q=null,X=F>239?4:F>223?3:F>191?2:1;if(k+X>y)break;X===1?F<128&&(q=F):X===2?(192&(E=d[k+1]))==128&&(q=(31&F)<<6|63&E)<=127&&(q=null):X===3?(N=d[k+2],(192&(E=d[k+1]))==128&&(192&N)==128&&((q=(15&F)<<12|(63&E)<<6|63&N)<=2047||q>=55296&&q<=57343)&&(q=null)):X===4&&(N=d[k+2],M=d[k+3],(192&(E=d[k+1]))==128&&(192&N)==128&&(192&M)==128&&((q=(15&F)<<18|(63&E)<<12|(63&N)<<6|63&M)<=65535||q>=1114112)&&(q=null)),q===null?(q=65533,X=1):q>65535&&(q-=65536,_+=String.fromCharCode(q>>>10&1023|55296),q=56320|1023&q),_+=String.fromCharCode(q),k+=X}return _}(this.buf,s,c)},readBytes:function(){var c=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,c);return this.pos=c,s},readPackedVarint:function(c,s){if(this.type!==kn.Bytes)return c.push(this.readVarint(s));var d=Lu(this);for(c=c||[];this.pos<d;)c.push(this.readVarint(s));return c},readPackedSVarint:function(c){if(this.type!==kn.Bytes)return c.push(this.readSVarint());var s=Lu(this);for(c=c||[];this.pos<s;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==kn.Bytes)return c.push(this.readBoolean());var s=Lu(this);for(c=c||[];this.pos<s;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==kn.Bytes)return c.push(this.readFloat());var s=Lu(this);for(c=c||[];this.pos<s;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==kn.Bytes)return c.push(this.readDouble());var s=Lu(this);for(c=c||[];this.pos<s;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==kn.Bytes)return c.push(this.readFixed32());var s=Lu(this);for(c=c||[];this.pos<s;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==kn.Bytes)return c.push(this.readSFixed32());var s=Lu(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==kn.Bytes)return c.push(this.readFixed64());var s=Lu(this);for(c=c||[];this.pos<s;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==kn.Bytes)return c.push(this.readSFixed64());var s=Lu(this);for(c=c||[];this.pos<s;)c.push(this.readSFixed64());return c},skip:function(c){var s=7&c;if(s===kn.Varint)for(;this.buf[this.pos++]>127;);else if(s===kn.Bytes)this.pos=this.readVarint()+this.pos;else if(s===kn.Fixed32)this.pos+=4;else{if(s!==kn.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(c,s){this.writeVarint(c<<3|s)},realloc:function(c){for(var s=this.length||16;s<this.pos+c;)s*=2;if(s!==this.length){var d=new Uint8Array(s);d.set(this.buf),this.buf=d,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),Lm(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),Lm(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),Lm(this.buf,-1&c,this.pos),Lm(this.buf,Math.floor(c*dO),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),Lm(this.buf,-1&c,this.pos),Lm(this.buf,Math.floor(c*dO),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(s,d){var f,y;if(s>=0?(f=s%4294967296|0,y=s/4294967296|0):(y=~(-s/4294967296),4294967295^(f=~(-s%4294967296))?f=f+1|0:(f=0,y=y+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");d.realloc(10),function(_,k,E){E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,_>>>=7,E.buf[E.pos++]=127&_|128,E.buf[E.pos]=127&(_>>>=7)}(f,0,d),function(_,k){var E=(7&_)<<4;k.buf[k.pos++]|=E|((_>>>=3)?128:0),_&&(k.buf[k.pos++]=127&_|((_>>>=7)?128:0),_&&(k.buf[k.pos++]=127&_|((_>>>=7)?128:0),_&&(k.buf[k.pos++]=127&_|((_>>>=7)?128:0),_&&(k.buf[k.pos++]=127&_|((_>>>=7)?128:0),_&&(k.buf[k.pos++]=127&_)))))}(y,d)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var s=this.pos;this.pos=function(f,y,_){for(var k,E,N=0;N<y.length;N++){if((k=y.charCodeAt(N))>55295&&k<57344){if(!E){k>56319||N+1===y.length?(f[_++]=239,f[_++]=191,f[_++]=189):E=k;continue}if(k<56320){f[_++]=239,f[_++]=191,f[_++]=189,E=k;continue}k=E-55296<<10|k-56320|65536,E=null}else E&&(f[_++]=239,f[_++]=191,f[_++]=189,E=null);k<128?f[_++]=k:(k<2048?f[_++]=k>>6|192:(k<65536?f[_++]=k>>12|224:(f[_++]=k>>18|240,f[_++]=k>>12&63|128),f[_++]=k>>6&63|128),f[_++]=63&k|128)}return _}(this.buf,c,this.pos);var d=this.pos-s;d>=128&&fO(s,d,this),this.pos=s-1,this.writeVarint(d),this.pos+=d},writeFloat:function(c){this.realloc(4),uO(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),uO(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var s=c.length;this.writeVarint(s),this.realloc(s);for(var d=0;d<s;d++)this.buf[this.pos++]=c[d]},writeRawMessage:function(c,s){this.pos++;var d=this.pos;c(s,this);var f=this.pos-d;f>=128&&fO(d,f,this),this.pos=d-1,this.writeVarint(f),this.pos+=f},writeMessage:function(c,s,d){this.writeTag(c,kn.Bytes),this.writeRawMessage(s,d)},writePackedVarint:function(c,s){s.length&&this.writeMessage(c,yQ,s)},writePackedSVarint:function(c,s){s.length&&this.writeMessage(c,xQ,s)},writePackedBoolean:function(c,s){s.length&&this.writeMessage(c,bQ,s)},writePackedFloat:function(c,s){s.length&&this.writeMessage(c,vQ,s)},writePackedDouble:function(c,s){s.length&&this.writeMessage(c,_Q,s)},writePackedFixed32:function(c,s){s.length&&this.writeMessage(c,wQ,s)},writePackedSFixed32:function(c,s){s.length&&this.writeMessage(c,kQ,s)},writePackedFixed64:function(c,s){s.length&&this.writeMessage(c,TQ,s)},writePackedSFixed64:function(c,s){s.length&&this.writeMessage(c,SQ,s)},writeBytesField:function(c,s){this.writeTag(c,kn.Bytes),this.writeBytes(s)},writeFixed32Field:function(c,s){this.writeTag(c,kn.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(c,s){this.writeTag(c,kn.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(c,s){this.writeTag(c,kn.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(c,s){this.writeTag(c,kn.Fixed64),this.writeSFixed64(s)},writeVarintField:function(c,s){this.writeTag(c,kn.Varint),this.writeVarint(s)},writeSVarintField:function(c,s){this.writeTag(c,kn.Varint),this.writeSVarint(s)},writeStringField:function(c,s){this.writeTag(c,kn.Bytes),this.writeString(s)},writeFloatField:function(c,s){this.writeTag(c,kn.Fixed32),this.writeFloat(s)},writeDoubleField:function(c,s){this.writeTag(c,kn.Fixed64),this.writeDouble(s)},writeBooleanField:function(c,s){this.writeVarintField(c,!!s)}};var j1=$(lO);const dj=3;function EQ(c,s,d){s.glyphs=[],c===1&&d.readMessage(jQ,s)}function jQ(c,s,d){if(c===3){const{id:f,bitmap:y,width:_,height:k,left:E,top:N,advance:M}=d.readMessage(AQ,{});s.glyphs.push({id:f,bitmap:new Ru({width:_+2*dj,height:k+2*dj},y),metrics:{width:_,height:k,left:E,top:N,advance:M}})}else c===4?s.ascender=d.readSVarint():c===5&&(s.descender=d.readSVarint())}function AQ(c,s,d){c===1?s.id=d.readVarint():c===2?s.bitmap=d.readBytes():c===3?s.width=d.readVarint():c===4?s.height=d.readVarint():c===5?s.left=d.readSVarint():c===6?s.top=d.readSVarint():c===7&&(s.advance=d.readVarint())}const mO=dj;function hj(c){let s=0,d=0;for(const k of c)s+=k.w*k.h,d=Math.max(d,k.w);c.sort((k,E)=>E.h-k.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),d),h:1/0}];let y=0,_=0;for(const k of c)for(let E=f.length-1;E>=0;E--){const N=f[E];if(!(k.w>N.w||k.h>N.h)){if(k.x=N.x,k.y=N.y,_=Math.max(_,k.y+k.h),y=Math.max(y,k.x+k.w),k.w===N.w&&k.h===N.h){const M=f.pop();E<f.length&&(f[E]=M)}else k.h===N.h?(N.x+=k.w,N.w-=k.w):k.w===N.w?(N.y+=k.h,N.h-=k.h):(f.push({x:N.x+k.w,y:N.y,w:N.w-k.w,h:k.h}),N.y+=k.h,N.h-=k.h);break}}return{w:y,h:_,fill:s/(y*_)||0}}const ws=1;class fj{constructor(s,{pixelRatio:d,version:f,stretchX:y,stretchY:_,content:k}){this.paddedRect=s,this.pixelRatio=d,this.stretchX=y,this.stretchY=_,this.content=k,this.version=f}get tl(){return[this.paddedRect.x+ws,this.paddedRect.y+ws]}get br(){return[this.paddedRect.x+this.paddedRect.w-ws,this.paddedRect.y+this.paddedRect.h-ws]}get displaySize(){return[(this.paddedRect.w-2*ws)/this.pixelRatio,(this.paddedRect.h-2*ws)/this.pixelRatio]}}class gO{constructor(s,d){const f={},y={};this.haveRenderCallbacks=[];const _=[];this.addImages(s,f,_),this.addImages(d,y,_);const{w:k,h:E}=hj(_),N=new Us({width:k||1,height:E||1});for(const M in s){const F=s[M],q=f[M].paddedRect;Us.copy(F.data,N,{x:0,y:0},{x:q.x+ws,y:q.y+ws},F.data)}for(const M in d){const F=d[M],q=y[M].paddedRect,X=q.x+ws,te=q.y+ws,ie=F.data.width,fe=F.data.height;Us.copy(F.data,N,{x:0,y:0},{x:X,y:te},F.data),Us.copy(F.data,N,{x:0,y:fe-1},{x:X,y:te-1},{width:ie,height:1}),Us.copy(F.data,N,{x:0,y:0},{x:X,y:te+fe},{width:ie,height:1}),Us.copy(F.data,N,{x:ie-1,y:0},{x:X-1,y:te},{width:1,height:fe}),Us.copy(F.data,N,{x:0,y:0},{x:X+ie,y:te},{width:1,height:fe})}this.image=N,this.iconPositions=f,this.patternPositions=y}addImages(s,d,f){for(const y in s){const _=s[y],k={x:0,y:0,w:_.data.width+2*ws,h:_.data.height+2*ws};f.push(k),d[y]=new fj(k,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(s,d){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>s.hasImage(f)),s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in s.updatedImages)this.patchUpdatedImage(this.iconPositions[f],s.getImage(f),d),this.patchUpdatedImage(this.patternPositions[f],s.getImage(f),d)}patchUpdatedImage(s,d,f){if(!s||!d||s.version===d.version)return;s.version=d.version;const[y,_]=s.tl;f.update(d.data,void 0,{x:y,y:_})}}Xt(fj,"ImagePosition"),Xt(gO,"ImageAtlas");const xo={horizontal:1,vertical:2,horizontalOnly:3},yO=-17;class ix{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,d){const f=new ix;return f.scale=s||1,f.fontStack=d,f}static forImage(s){const d=new ix;return d.imageName=s,d}}class zm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,d){const f=new zm;for(let y=0;y<s.sections.length;y++){const _=s.sections[y];_.image?f.addImageSection(_):f.addTextSection(_,d)}return f}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(s){this.text=function(d,f){let y="";for(let _=0;_<d.length;_++){const k=d.charCodeAt(_+1)||null,E=d.charCodeAt(_-1)||null;y+=!f&&(k&&r1(k)&&!nx[d[_+1]]||E&&r1(E)&&!nx[d[_-1]])||!nx[d[_]]?d[_]:nx[d[_]]}return y}(this.text,s)}trim(){let s=0;for(let f=0;f<this.text.length&&A1[this.text.charCodeAt(f)];f++)s++;let d=this.text.length;for(let f=this.text.length-1;f>=0&&f>=s&&A1[this.text.charCodeAt(f)];f--)d--;this.text=this.text.substring(s,d),this.sectionIndex=this.sectionIndex.slice(s,d)}substring(s,d){const f=new zm;return f.text=this.text.substring(s,d),f.sectionIndex=this.sectionIndex.slice(s,d),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,d)=>Math.max(s,this.sections[d].scale),0)}addTextSection(s,d){this.text+=s.text,this.sections.push(ix.forText(s.scale,s.fontStack||d));const f=this.sections.length-1;for(let y=0;y<s.text.length;++y)this.sectionIndex.push(f)}addImageSection(s){const d=s.image?s.image.name:"";if(d.length===0)return void Lt("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(ix.forImage(d)),this.sectionIndex.push(this.sections.length-1)):Lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function pj(c,s,d,f,y,_,k,E,N,M,F,q,X,te,ie){const fe=zm.fromFeature(c,y);q===xo.vertical&&fe.verticalizePunctuation(X);let ge=[];const je=function(Fe,nt,Qe,dt,Nt,st){if(!Fe)return[];const yt=[],xt=function(Ut,er,Wt,br,Rt,sr){let wr=0;for(let Zr=0;Zr<Ut.length();Zr++){const kr=Ut.getSection(Zr);wr+=xO(Ut.getCharCode(Zr),kr,br,Rt,er,sr)}return wr/Math.max(1,Math.ceil(wr/Wt))}(Fe,nt,Qe,dt,Nt,st),kt=Fe.text.indexOf("​")>=0;let Ot=0;for(let Ut=0;Ut<Fe.length();Ut++){const er=Fe.getSection(Ut),Wt=Fe.getCharCode(Ut);if(A1[Wt]||(Ot+=xO(Wt,er,dt,Nt,nt,st)),Ut<Fe.length()-1){const br=!((ct=Wt)<11904||!(Ht["Bopomofo Extended"](ct)||Ht.Bopomofo(ct)||Ht["CJK Compatibility Forms"](ct)||Ht["CJK Compatibility Ideographs"](ct)||Ht["CJK Compatibility"](ct)||Ht["CJK Radicals Supplement"](ct)||Ht["CJK Strokes"](ct)||Ht["CJK Symbols and Punctuation"](ct)||Ht["CJK Unified Ideographs Extension A"](ct)||Ht["CJK Unified Ideographs"](ct)||Ht["Enclosed CJK Letters and Months"](ct)||Ht["Halfwidth and Fullwidth Forms"](ct)||Ht.Hiragana(ct)||Ht["Ideographic Description Characters"](ct)||Ht["Kangxi Radicals"](ct)||Ht["Katakana Phonetic Extensions"](ct)||Ht.Katakana(ct)||Ht["Vertical Forms"](ct)||Ht["Yi Radicals"](ct)||Ht["Yi Syllables"](ct)));(NQ[Wt]||br||er.imageName)&&yt.push(_O(Ut+1,Ot,xt,yt,CQ(Wt,Fe.getCharCode(Ut+1),br&&kt),!1))}}var ct;return bO(_O(Fe.length(),Ot,xt,yt,0,!0))}(fe,M,_,s,f,te),{processBidirectionalText:Re,processStyledBidirectionalText:Ae}=z;if(Re&&fe.sections.length===1){const Fe=Re(fe.toString(),je);for(const nt of Fe){const Qe=new zm;Qe.text=nt,Qe.sections=fe.sections;for(let dt=0;dt<nt.length;dt++)Qe.sectionIndex.push(0);ge.push(Qe)}}else if(Ae){const Fe=Ae(fe.text,fe.sectionIndex,je);for(const nt of Fe){const Qe=new zm;Qe.text=nt[0],Qe.sectionIndex=nt[1],Qe.sections=fe.sections,ge.push(Qe)}}else ge=function(Fe,nt){const Qe=[],dt=Fe.text;let Nt=0;for(const st of nt)Qe.push(Fe.substring(Nt,st)),Nt=st;return Nt<dt.length&&Qe.push(Fe.substring(Nt,dt.length)),Qe}(fe,je);const Oe=[],Be={positionedLines:Oe,text:fe.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:q,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Fe,nt,Qe,dt,Nt,st,yt,xt,kt,Ot,ct,Ut){let er=0,Wt=0,br=0;const Rt=xt==="right"?1:xt==="left"?0:.5;let sr=!1;for(const Er of Nt){const jr=Er.getSections();for(const xn of jr){if(xn.imageName)continue;const Tn=nt[xn.fontStack];if(Tn&&(sr=Tn.ascender!==void 0&&Tn.descender!==void 0,!sr))break}if(!sr)break}let wr=0;for(const Er of Nt){Er.trim();const jr=Er.getMaxScale(),xn=(jr-1)*la,Tn={positionedGlyphs:[],lineOffset:0};Fe.positionedLines[wr]=Tn;const Sn=Tn.positionedGlyphs;let vn=0;if(!Er.length()){Wt+=st,++wr;continue}let Bn=0,Qn=0;for(let _n=0;_n<Er.length();_n++){const Mi=Er.getSection(_n),wi=Er.getSectionIndex(_n),Gn=Er.getCharCode(_n);let Yr=Mi.scale,ki=null,En=null,Ja=null,Ti=la,ca=0;const Zi=!(kt===xo.horizontal||!ct&&!Py(Gn)||ct&&(A1[Gn]||(Zr=Gn,Ht.Arabic(Zr)||Ht["Arabic Supplement"](Zr)||Ht["Arabic Extended-A"](Zr)||Ht["Arabic Presentation Forms-A"](Zr)||Ht["Arabic Presentation Forms-B"](Zr))));if(Mi.imageName){const Qa=dt[Mi.imageName];if(!Qa)continue;Ja=Mi.imageName,Fe.iconsInText=Fe.iconsInText||!0,En=Qa.paddedRect;const Xi=Qa.displaySize;Yr=Yr*la/Ut,ki={width:Xi[0],height:Xi[1],left:ws,top:-mO,advance:Zi?Xi[1]:Xi[0],localGlyph:!1},ca=sr?-ki.height*Yr:yO+jr*la-Xi[1]*Yr,Ti=ki.advance;const Bl=(Zi?Xi[0]:Xi[1])*Yr-la*jr;Bl>0&&Bl>vn&&(vn=Bl)}else{const Qa=Qe[Mi.fontStack];if(!Qa)continue;Qa[Gn]&&(En=Qa[Gn]);const Xi=nt[Mi.fontStack];if(!Xi)continue;const Bl=Xi.glyphs[Gn];if(!Bl)continue;if(ki=Bl.metrics,Ti=Gn!==8203?la:0,sr){const Gm=Xi.ascender!==void 0?Math.abs(Xi.ascender):0,px=Xi.descender!==void 0?Math.abs(Xi.descender):0,mx=(Gm+px)*Yr;Bn<mx&&(Bn=mx,Qn=(Gm-px)/2*Yr),ca=-Gm*Yr}else ca=yO+(jr-Yr)*la}Zi?(Fe.verticalizable=!0,Sn.push({glyph:Gn,imageName:Ja,x:er,y:Wt+ca,vertical:Zi,scale:Yr,localGlyph:ki.localGlyph,fontStack:Mi.fontStack,sectionIndex:wi,metrics:ki,rect:En}),er+=Ti*Yr+Ot):(Sn.push({glyph:Gn,imageName:Ja,x:er,y:Wt+ca,vertical:Zi,scale:Yr,localGlyph:ki.localGlyph,fontStack:Mi.fontStack,sectionIndex:wi,metrics:ki,rect:En}),er+=ki.advance*Yr+Ot)}Sn.length!==0&&(br=Math.max(er-Ot,br),sr?wO(Sn,Rt,vn,Qn,st*jr/2):wO(Sn,Rt,vn,0,st/2)),er=0;const bi=st*jr+vn;Tn.lineOffset=Math.max(vn,xn),Wt+=bi,++wr}var Zr;const kr=Wt,{horizontalAlign:hr,verticalAlign:An}=mj(yt);(function(Er,jr,xn,Tn,Sn,vn){const Bn=(jr-xn)*Sn,Qn=-vn*Tn;for(const bi of Er)for(const _n of bi.positionedGlyphs)_n.x+=Bn,_n.y+=Qn})(Fe.positionedLines,Rt,hr,An,br,kr),Fe.top+=-An*kr,Fe.bottom=Fe.top+kr,Fe.left+=-hr*br,Fe.right=Fe.left+br,Fe.hasBaseline=sr}(Be,s,d,f,ge,k,E,N,q,M,X,ie),!function(Fe){for(const nt of Fe)if(nt.positionedGlyphs.length!==0)return!1;return!0}(Oe)&&Be}const A1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},NQ={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function xO(c,s,d,f,y,_){if(s.imageName){const k=f[s.imageName];return k?k.displaySize[0]*s.scale*la/_+y:0}{const k=d[s.fontStack],E=k&&k.glyphs[c];return E?E.metrics.advance*s.scale+y:0}}function vO(c,s,d,f){const y=Math.pow(c-s,2);return f?c<s?y/2:2*y:y+Math.abs(d)*d}function CQ(c,s,d){let f=0;return c===10&&(f-=1e4),d&&(f+=150),c!==40&&c!==65288||(f+=50),s!==41&&s!==65289||(f+=50),f}function _O(c,s,d,f,y,_){let k=null,E=vO(s,d,y,_);for(const N of f){const M=vO(s-N.x,d,y,_)+N.badness;M<=E&&(k=N,E=M)}return{index:c,x:s,priorBreak:k,badness:E}}function bO(c){return c?bO(c.priorBreak).concat(c.index):[]}function mj(c){let s=.5,d=.5;switch(c){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:s,verticalAlign:d}}function wO(c,s,d,f,y){if(!(s||d||f||y))return;const _=c.length-1,k=c[_],E=(k.x+k.metrics.advance*k.scale)*s;for(let N=0;N<=_;N++)c[N].x-=E,c[N].y+=d+f+y}function PQ(c,s,d){const{horizontalAlign:f,verticalAlign:y}=mj(d),_=s[0]-c.displaySize[0]*f,k=s[1]-c.displaySize[1]*y;return{image:c,top:k,bottom:k+c.displaySize[1],left:_,right:_+c.displaySize[0]}}function kO(c,s,d,f,y,_){const k=c.image;let E;if(k.content){const ge=k.content,je=k.pixelRatio||1;E=[ge[0]/je,ge[1]/je,k.displaySize[0]-ge[2]/je,k.displaySize[1]-ge[3]/je]}const N=s.left*_,M=s.right*_;let F,q,X,te;d==="width"||d==="both"?(te=y[0]+N-f[3],q=y[0]+M+f[1]):(te=y[0]+(N+M-k.displaySize[0])/2,q=te+k.displaySize[0]);const ie=s.top*_,fe=s.bottom*_;return d==="height"||d==="both"?(F=y[1]+ie-f[0],X=y[1]+fe+f[2]):(F=y[1]+(ie+fe-k.displaySize[1])/2,X=F+k.displaySize[1]),{image:k,top:F,right:q,bottom:X,left:te,collisionPadding:E}}class zu extends V{constructor(s,d,f,y,_){super(s,d),this.angle=y,this.z=f,_!==void 0&&(this.segment=_)}clone(){return new zu(this.x,this.y,this.z,this.angle,this.segment)}}function TO(c,s,d,f,y){if(s.segment===void 0)return!0;let _=s,k=s.segment+1,E=0;for(;E>-d/2;){if(k--,k<0)return!1;E-=c[k].dist(_),_=c[k]}E+=c[k].dist(c[k+1]),k++;const N=[];let M=0;for(;E<d/2;){const F=c[k],q=c[k+1];if(!q)return!1;let X=c[k-1].angleTo(F)-F.angleTo(q);for(X=Math.abs((X+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:E,angleDelta:X}),M+=X;E-N[0].distance>f;)M-=N.shift().angleDelta;if(M>y)return!1;k++,E+=F.dist(q)}return!0}function SO(c){let s=0;for(let d=0;d<c.length-1;d++)s+=c[d].dist(c[d+1]);return s}function EO(c,s,d){return c?.6*s*d:0}function jO(c,s){return Math.max(c?c.right-c.left:0,s?s.right-s.left:0)}function IQ(c,s,d,f,y,_){const k=EO(d,y,_),E=jO(d,f)*_;let N=0;const M=SO(c)/2;for(let F=0;F<c.length-1;F++){const q=c[F],X=c[F+1],te=q.dist(X);if(N+te>M){const ie=(M-N)/te,fe=Z(q.x,X.x,ie),ge=Z(q.y,X.y,ie),je=new zu(fe,ge,0,X.angleTo(q),F);return!k||TO(c,je,E,k,s)?je:void 0}N+=te}}function MQ(c,s,d,f,y,_,k,E,N){const M=EO(f,_,k),F=jO(f,y),q=F*k,X=c[0].x===0||c[0].x===N||c[0].y===0||c[0].y===N;return s-q<s/4&&(s=q+s/4),AO(c,X?s/2*E%s:(F/2+2*_)*k*E%s,s,M,d,q,X,!1,N)}function AO(c,s,d,f,y,_,k,E,N){const M=_/2,F=SO(c);let q=0,X=s-d,te=[];for(let ie=0;ie<c.length-1;ie++){const fe=c[ie],ge=c[ie+1],je=fe.dist(ge),Re=ge.angleTo(fe);for(;X+d<q+je;){X+=d;const Ae=(X-q)/je,Oe=Z(fe.x,ge.x,Ae),Be=Z(fe.y,ge.y,Ae);if(Oe>=0&&Oe<N&&Be>=0&&Be<N&&X-M>=0&&X+M<=F){const Fe=new zu(Oe,Be,0,Re,ie);Fe._round(),f&&!TO(c,Fe,_,f,y)||te.push(Fe)}}q+=je}return E||te.length||k||(te=AO(c,q/2,d,f,y,_,k,!0,N)),te}function NO(c,s,d,f,y){const _=[];for(let k=0;k<c.length;k++){const E=c[k];let N;for(let M=0;M<E.length-1;M++){let F=E[M],q=E[M+1];F.x<s&&q.x<s||(F.x<s?F=new V(s,F.y+(s-F.x)/(q.x-F.x)*(q.y-F.y))._round():q.x<s&&(q=new V(s,F.y+(s-F.x)/(q.x-F.x)*(q.y-F.y))._round()),F.y<d&&q.y<d||(F.y<d?F=new V(F.x+(d-F.y)/(q.y-F.y)*(q.x-F.x),d)._round():q.y<d&&(q=new V(F.x+(d-F.y)/(q.y-F.y)*(q.x-F.x),d)._round()),F.x>=f&&q.x>=f||(F.x>=f?F=new V(f,F.y+(f-F.x)/(q.x-F.x)*(q.y-F.y))._round():q.x>=f&&(q=new V(f,F.y+(f-F.x)/(q.x-F.x)*(q.y-F.y))._round()),F.y>=y&&q.y>=y||(F.y>=y?F=new V(F.x+(y-F.y)/(q.y-F.y)*(q.x-F.x),y)._round():q.y>=y&&(q=new V(F.x+(y-F.y)/(q.y-F.y)*(q.x-F.x),y)._round()),N&&F.equals(N[N.length-1])||(N=[F],_.push(N)),N.push(q)))))}}return _}Xt(zu,"Anchor");const ax=1e20;function CO(c,s,d,f,y,_,k,E,N){for(let M=s;M<s+f;M++)PO(c,d*_+M,_,y,k,E,N);for(let M=d;M<d+y;M++)PO(c,M*_+s,1,f,k,E,N)}function PO(c,s,d,f,y,_,k){_[0]=0,k[0]=-ax,k[1]=ax,y[0]=c[s];for(let E=1,N=0,M=0;E<f;E++){y[E]=c[s+E*d];const F=E*E;do{const q=_[N];M=(y[E]-y[q]+F-q*q)/(E-q)/2}while(M<=k[N]&&--N>-1);N++,_[N]=E,k[N]=M,k[N+1]=ax}for(let E=0,N=0;E<f;E++){for(;k[N+1]<E;)N++;const M=_[N],F=E-M;c[s+E*d]=y[M]+F*F}}const $l=2,gj={none:0,ideographs:1,all:2};class $m{constructor(s,d,f){this.requestManager=s,this.localGlyphMode=d,this.localFontFamily=f,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s){this.url=s}getGlyphs(s,d){const f=[];for(const y in s)for(const _ of s[y])f.push({stack:y,id:_});Ce(f,({stack:y,id:_},k)=>{let E=this.entries[y];E||(E=this.entries[y]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let N=E.glyphs[_];if(N!==void 0)return void k(null,{stack:y,id:_,glyph:N});if(N=this._tinySDF(E,y,_),N)return E.glyphs[_]=N,void k(null,{stack:y,id:_,glyph:N});const M=Math.floor(_/256);if(256*M>65535)return void k(new Error("glyphs > 65535 not supported"));if(E.ranges[M])return void k(null,{stack:y,id:_,glyph:N});let F=E.requests[M];F||(F=E.requests[M]=[],$m.loadGlyphRange(y,M,this.url,this.requestManager,(q,X)=>{if(X){E.ascender=X.ascender,E.descender=X.descender;for(const te in X.glyphs)this._doesCharSupportLocalGlyph(+te)||(E.glyphs[+te]=X.glyphs[+te]);E.ranges[M]=!0}for(const te of F)te(q,X);delete E.requests[M]})),F.push((q,X)=>{q?k(q):X&&k(null,{stack:y,id:_,glyph:X.glyphs[_]||null})})},(y,_)=>{if(y)d(y);else if(_){const k={};for(const{stack:E,id:N,glyph:M}of _)k[E]===void 0&&(k[E]={}),k[E].glyphs===void 0&&(k[E].glyphs={}),k[E].glyphs[N]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},k[E].ascender=this.entries[E].ascender,k[E].descender=this.entries[E].descender;d(null,k)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==gj.none&&(this.localGlyphMode===gj.all?!!this.localFontFamily:!!this.localFontFamily&&(Ht["CJK Unified Ideographs"](s)||Ht["Hangul Syllables"](s)||Ht.Hiragana(s)||Ht.Katakana(s)||Ht["CJK Symbols and Punctuation"](s)))}_tinySDF(s,d,f){const y=this.localFontFamily;if(!y||!this._doesCharSupportLocalGlyph(f))return;let _=s.tinySDF;if(!_){let fe="400";/bold/i.test(d)?fe="900":/medium/i.test(d)?fe="500":/light/i.test(d)&&(fe="200"),_=s.tinySDF=new $m.TinySDF({fontFamily:y,fontWeight:fe,fontSize:24*$l,buffer:3*$l,radius:8*$l}),_.fontWeight=fe}if(this.localGlyphs[_.fontWeight][f])return this.localGlyphs[_.fontWeight][f];const k=String.fromCharCode(f),{data:E,width:N,height:M,glyphWidth:F,glyphHeight:q,glyphLeft:X,glyphTop:te,glyphAdvance:ie}=_.draw(k);return this.localGlyphs[_.fontWeight][f]={id:f,bitmap:new Ru({width:N,height:M},E),metrics:{width:F/$l,height:q/$l,left:X/$l,top:te/$l-27,advance:ie/$l,localGlyph:!0}}}}$m.loadGlyphRange=function(c,s,d,f,y){const _=256*s,k=_+255,E=f.transformRequest(f.normalizeGlyphsURL(d).replace("{fontstack}",c).replace("{range}",`${_}-${k}`),va.Glyphs);oo(E,(N,M)=>{if(N)y(N);else if(M){const F={},q=function(X){return new j1(X).readFields(EQ,{})}(M);for(const X of q.glyphs)F[X.id]=X;y(null,{glyphs:F,ascender:q.ascender,descender:q.descender})}})},$m.TinySDF=class{constructor({fontSize:c=24,buffer:s=3,radius:d=8,cutoff:f=.25,fontFamily:y="sans-serif",fontWeight:_="normal",fontStyle:k="normal"}={}){this.buffer=s,this.cutoff=f,this.radius=d;const E=this.size=c+4*s,N=this._createCanvas(E),M=this.ctx=N.getContext("2d",{willReadFrequently:!0});M.font=`${k} ${_} ${c}px ${y}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(c){const s=document.createElement("canvas");return s.width=s.height=c,s}draw(c){const{width:s,actualBoundingBoxAscent:d,actualBoundingBoxDescent:f,actualBoundingBoxLeft:y,actualBoundingBoxRight:_}=this.ctx.measureText(c),k=Math.ceil(d),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-y))),N=Math.min(this.size-this.buffer,k+Math.ceil(f)),M=E+2*this.buffer,F=N+2*this.buffer,q=Math.max(M*F,0),X=new Uint8ClampedArray(q),te={data:X,width:M,height:F,glyphWidth:E,glyphHeight:N,glyphTop:k,glyphLeft:0,glyphAdvance:s};if(E===0||N===0)return te;const{ctx:ie,buffer:fe,gridInner:ge,gridOuter:je}=this;ie.clearRect(fe,fe,E,N),ie.fillText(c,fe,fe+k);const Re=ie.getImageData(fe,fe,E,N);je.fill(ax,0,q),ge.fill(0,0,q);for(let Ae=0;Ae<N;Ae++)for(let Oe=0;Oe<E;Oe++){const Be=Re.data[4*(Ae*E+Oe)+3]/255;if(Be===0)continue;const Fe=(Ae+fe)*M+Oe+fe;if(Be===1)je[Fe]=0,ge[Fe]=ax;else{const nt=.5-Be;je[Fe]=nt>0?nt*nt:0,ge[Fe]=nt<0?nt*nt:0}}CO(je,0,0,M,F,M,this.f,this.v,this.z),CO(ge,fe,fe,E,N,M,this.f,this.v,this.z);for(let Ae=0;Ae<q;Ae++){const Oe=Math.sqrt(je[Ae])-Math.sqrt(ge[Ae]);X[Ae]=Math.round(255-255*(Oe/this.radius+this.cutoff))}return te}};const Fm=ws;function IO(c,s,d,f){const y=[],_=c.image,k=_.pixelRatio,E=_.paddedRect.w-2*Fm,N=_.paddedRect.h-2*Fm,M=c.right-c.left,F=c.bottom-c.top,q=_.stretchX||[[0,E]],X=_.stretchY||[[0,N]],te=(st,yt)=>st+yt[1]-yt[0],ie=q.reduce(te,0),fe=X.reduce(te,0),ge=E-ie,je=N-fe;let Re=0,Ae=ie,Oe=0,Be=fe,Fe=0,nt=ge,Qe=0,dt=je;if(_.content&&f){const st=_.content;Re=N1(q,0,st[0]),Oe=N1(X,0,st[1]),Ae=N1(q,st[0],st[2]),Be=N1(X,st[1],st[3]),Fe=st[0]-Re,Qe=st[1]-Oe,nt=st[2]-st[0]-Ae,dt=st[3]-st[1]-Be}const Nt=(st,yt,xt,kt)=>{const Ot=C1(st.stretch-Re,Ae,M,c.left),ct=P1(st.fixed-Fe,nt,st.stretch,ie),Ut=C1(yt.stretch-Oe,Be,F,c.top),er=P1(yt.fixed-Qe,dt,yt.stretch,fe),Wt=C1(xt.stretch-Re,Ae,M,c.left),br=P1(xt.fixed-Fe,nt,xt.stretch,ie),Rt=C1(kt.stretch-Oe,Be,F,c.top),sr=P1(kt.fixed-Qe,dt,kt.stretch,fe),wr=new V(Ot,Ut),Zr=new V(Wt,Ut),kr=new V(Wt,Rt),hr=new V(Ot,Rt),An=new V(ct/k,er/k),Er=new V(br/k,sr/k),jr=s*Math.PI/180;if(jr){const Sn=Math.sin(jr),vn=Math.cos(jr),Bn=[vn,-Sn,Sn,vn];wr._matMult(Bn),Zr._matMult(Bn),hr._matMult(Bn),kr._matMult(Bn)}const xn=st.stretch+st.fixed,Tn=yt.stretch+yt.fixed;return{tl:wr,tr:Zr,bl:hr,br:kr,tex:{x:_.paddedRect.x+Fm+xn,y:_.paddedRect.y+Fm+Tn,w:xt.stretch+xt.fixed-xn,h:kt.stretch+kt.fixed-Tn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:An,pixelOffsetBR:Er,minFontScaleX:nt/k/M,minFontScaleY:dt/k/F,isSDF:d}};if(f&&(_.stretchX||_.stretchY)){const st=MO(q,ge,ie),yt=MO(X,je,fe);for(let xt=0;xt<st.length-1;xt++){const kt=st[xt],Ot=st[xt+1];for(let ct=0;ct<yt.length-1;ct++)y.push(Nt(kt,yt[ct],Ot,yt[ct+1]))}}else y.push(Nt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:N+1}));return y}function N1(c,s,d){let f=0;for(const y of c)f+=Math.max(s,Math.min(d,y[1]))-Math.max(s,Math.min(d,y[0]));return f}function MO(c,s,d){const f=[{fixed:-Fm,stretch:0}];for(const[y,_]of c){const k=f[f.length-1];f.push({fixed:y-k.stretch,stretch:k.stretch}),f.push({fixed:y-k.stretch,stretch:k.stretch+(_-y)})}return f.push({fixed:s+Fm,stretch:d}),f}function C1(c,s,d,f){return c/s*d+f}function P1(c,s,d,f){return c-s*d/f}function DQ(c,s,d,f){const y=s+c.positionedLines[f].lineOffset;return f===0?d+y/2:d+(y+(s+c.positionedLines[f-1].lineOffset))/2}class OQ{constructor(s=[],d=RQ){if(this.data=s,this.length=this.data.length,this.compare=d,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:d,compare:f}=this,y=d[s];for(;s>0;){const _=s-1>>1,k=d[_];if(f(y,k)>=0)break;d[s]=k,s=_}d[s]=y}_down(s){const{data:d,compare:f}=this,y=this.length>>1,_=d[s];for(;s<y;){let k=1+(s<<1),E=d[k];const N=k+1;if(N<this.length&&f(d[N],E)<0&&(k=N,E=d[N]),f(E,_)>=0)break;d[s]=E,s=k}d[s]=_}}function RQ(c,s){return c<s?-1:c>s?1:0}function LQ(c,s=1,d=!1){let f=1/0,y=1/0,_=-1/0,k=-1/0;const E=c[0];for(let te=0;te<E.length;te++){const ie=E[te];(!te||ie.x<f)&&(f=ie.x),(!te||ie.y<y)&&(y=ie.y),(!te||ie.x>_)&&(_=ie.x),(!te||ie.y>k)&&(k=ie.y)}const N=Math.min(_-f,k-y);let M=N/2;const F=new OQ([],zQ);if(N===0)return new V(f,y);for(let te=f;te<_;te+=N)for(let ie=y;ie<k;ie+=N)F.push(new Bm(te+M,ie+M,M,c));let q=function(te){let ie=0,fe=0,ge=0;const je=te[0];for(let Re=0,Ae=je.length,Oe=Ae-1;Re<Ae;Oe=Re++){const Be=je[Re],Fe=je[Oe],nt=Be.x*Fe.y-Fe.x*Be.y;fe+=(Be.x+Fe.x)*nt,ge+=(Be.y+Fe.y)*nt,ie+=3*nt}return new Bm(fe/ie,ge/ie,0,te)}(c),X=F.length;for(;F.length;){const te=F.pop();(te.d>q.d||!q.d)&&(q=te,d&&console.log("found best %d after %d probes",Math.round(1e4*te.d)/1e4,X)),te.max-q.d<=s||(M=te.h/2,F.push(new Bm(te.p.x-M,te.p.y-M,M,c)),F.push(new Bm(te.p.x+M,te.p.y-M,M,c)),F.push(new Bm(te.p.x-M,te.p.y+M,M,c)),F.push(new Bm(te.p.x+M,te.p.y+M,M,c)),X+=4)}return d&&(console.log(`num probes: ${X}`),console.log(`best distance: ${q.d}`)),q.p}function zQ(c,s){return s.max-c.max}class Bm{constructor(s,d,f,y){this.p=new V(s,d),this.h=f,this.d=function(_,k){let E=!1,N=1/0;for(let M=0;M<k.length;M++){const F=k[M];for(let q=0,X=F.length,te=X-1;q<X;te=q++){const ie=F[q],fe=F[te];ie.y>_.y!=fe.y>_.y&&_.x<(fe.x-ie.x)*(_.y-ie.y)/(fe.y-ie.y)+ie.x&&(E=!E),N=Math.min(N,AD(_,ie,fe))}}return(E?1:-1)*Math.sqrt(N)}(this.p,y),this.max=this.d+this.h*Math.SQRT2}}const Vm=7,yj=Number.POSITIVE_INFINITY,$Q=Math.sqrt(2);function DO(c,[s,d]){let f=0,y=0;if(d===yj){s<0&&(s=0);const _=s/$Q;switch(c){case"top-right":case"top-left":y=_-Vm;break;case"bottom-right":case"bottom-left":y=-_+Vm;break;case"bottom":y=-s+Vm;break;case"top":y=s-Vm}switch(c){case"top-right":case"bottom-right":f=-_;break;case"top-left":case"bottom-left":f=_;break;case"left":f=s;break;case"right":f=-s}}else{switch(s=Math.abs(s),d=Math.abs(d),c){case"top-right":case"top-left":case"top":y=d-Vm;break;case"bottom-right":case"bottom-left":case"bottom":y=-d+Vm}switch(c){case"top-right":case"bottom-right":case"right":f=-s;break;case"top-left":case"bottom-left":case"left":f=s}}return[f,y]}function FQ(c,s,d,f,y,_,k,E,N,M){c.createArrays(),c.tilePixelRatio=cr/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const F=c.layers[0].layout,q=c.layers[0]._unevaluatedLayout._values,X={};if(c.textSizeData.kind==="composite"){const{minZoom:fe,maxZoom:ge}=c.textSizeData;X.compositeTextSizes=[q["text-size"].possiblyEvaluate(new U(fe),E),q["text-size"].possiblyEvaluate(new U(ge),E)]}if(c.iconSizeData.kind==="composite"){const{minZoom:fe,maxZoom:ge}=c.iconSizeData;X.compositeIconSizes=[q["icon-size"].possiblyEvaluate(new U(fe),E),q["icon-size"].possiblyEvaluate(new U(ge),E)]}X.layoutTextSize=q["text-size"].possiblyEvaluate(new U(N+1),E),X.layoutIconSize=q["icon-size"].possiblyEvaluate(new U(N+1),E),X.textMaxSize=q["text-size"].possiblyEvaluate(new U(18),E);const te=F.get("text-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",ie=F.get("text-size");for(const fe of c.features){const ge=F.get("text-font").evaluate(fe,{},E).join(","),je=ie.evaluate(fe,{},E),Re=X.layoutTextSize.evaluate(fe,{},E),Ae=(X.layoutIconSize.evaluate(fe,{},E),{horizontal:{},vertical:void 0}),Oe=fe.text;let Be,Fe=[0,0];if(Oe){const dt=Oe.toString(),Nt=F.get("text-letter-spacing").evaluate(fe,{},E)*la,st=F.get("text-line-height").evaluate(fe,{},E)*la,yt=EE(dt)?Nt:0,xt=F.get("text-anchor").evaluate(fe,{},E),kt=F.get("text-variable-anchor");if(!kt){const Wt=F.get("text-radial-offset").evaluate(fe,{},E);Fe=Wt?DO(xt,[Wt*la,yj]):F.get("text-offset").evaluate(fe,{},E).map(br=>br*la)}let Ot=te?"center":F.get("text-justify").evaluate(fe,{},E);const ct=F.get("symbol-placement")==="point",Ut=ct?F.get("text-max-width").evaluate(fe,{},E)*la:1/0,er=Wt=>{c.allowVerticalPlacement&&Cy(dt)&&(Ae.vertical=pj(Oe,s,d,y,ge,Ut,st,xt,Wt,yt,Fe,xo.vertical,!0,Re,je))};if(!te&&kt){const Wt=Ot==="auto"?kt.map(Rt=>xj(Rt)):[Ot];let br=!1;for(let Rt=0;Rt<Wt.length;Rt++){const sr=Wt[Rt];if(!Ae.horizontal[sr])if(br)Ae.horizontal[sr]=Ae.horizontal[0];else{const wr=pj(Oe,s,d,y,ge,Ut,st,"center",sr,yt,Fe,xo.horizontal,!1,Re,je);wr&&(Ae.horizontal[sr]=wr,br=wr.positionedLines.length===1)}}er("left")}else{if(Ot==="auto"&&(Ot=xj(xt)),ct||F.get("text-writing-mode").indexOf("horizontal")>=0||!Cy(dt)){const Wt=pj(Oe,s,d,y,ge,Ut,st,xt,Ot,yt,Fe,xo.horizontal,!1,Re,je);Wt&&(Ae.horizontal[Ot]=Wt)}er(ct?"left":Ot)}}let nt=!1;if(fe.icon&&fe.icon.name){const dt=f[fe.icon.name];dt&&(Be=PQ(y[fe.icon.name],F.get("icon-offset").evaluate(fe,{},E),F.get("icon-anchor").evaluate(fe,{},E)),nt=dt.sdf,c.sdfIcons===void 0?c.sdfIcons=dt.sdf:c.sdfIcons!==dt.sdf&&Lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(dt.pixelRatio!==c.pixelRatio||F.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const Qe=RO(Ae.horizontal)||Ae.vertical;c.iconsInText||(c.iconsInText=!!Qe&&Qe.iconsInText),(Qe||Be)&&BQ(c,fe,Ae,Be,f,X,Re,0,Fe,nt,k,E,M)}_&&c.generateCollisionDebugBuffers(N,c.collisionBoxArray)}function xj(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function BQ(c,s,d,f,y,_,k,E,N,M,F,q,X){let te=_.textMaxSize.evaluate(s,{},q);te===void 0&&(te=k);const ie=c.layers[0].layout,fe=ie.get("icon-offset").evaluate(s,{},q),ge=RO(d.horizontal)||d.vertical,je=X.name==="globe",Re=la,Ae=k/Re,Oe=c.tilePixelRatio*te/Re,Be=(xt=c.overscaling,c.zoom>18&&xt>2&&(xt>>=1),Math.max(cr/(512*xt),1)*ie.get("symbol-spacing")),Fe=ie.get("text-padding")*c.tilePixelRatio,nt=ie.get("icon-padding")*c.tilePixelRatio,Qe=ce(ie.get("text-max-angle")),dt=ie.get("text-rotation-alignment")==="map"&&ie.get("symbol-placement")!=="point",Nt=ie.get("icon-rotation-alignment")==="map"&&ie.get("symbol-placement")!=="point",st=ie.get("symbol-placement"),yt=Be/2;var xt;const kt=ie.get("icon-text-fit");let Ot;f&&kt!=="none"&&(c.allowVerticalPlacement&&d.vertical&&(Ot=kO(f,d.vertical,kt,ie.get("icon-text-fit-padding"),fe,Ae)),ge&&(f=kO(f,ge,kt,ie.get("icon-text-fit-padding"),fe,Ae)));const ct=(Ut,er,Wt)=>{if(er.x<0||er.x>=cr||er.y<0||er.y>=cr)return;let br=null;if(je){const{x:Rt,y:sr,z:wr}=X.projectTilePoint(er.x,er.y,Wt);br={anchor:new zu(Rt,sr,wr,0,void 0),up:X.upVector(Wt,er.x,er.y)}}(function(Rt,sr,wr,Zr,kr,hr,An,Er,jr,xn,Tn,Sn,vn,Bn,Qn,bi,_n,Mi,wi,Gn,Yr,ki,En,Ja,Ti){const ca=Rt.addToLineVertexArray(sr,Zr);let Zi,Qa,Xi,Bl,Gm,px,mx,mR=0,gR=0,yR=0,xR=0,Mj=-1,Dj=-1;const Dc={};let vR=NE("");const Zf=wr?wr.anchor:sr;let Oj=0,Rj=0;if(jr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Oj,Rj]=jr.layout.get("text-offset").evaluate(Yr,{},Ti).map(qs=>qs*la):(Oj=jr.layout.get("text-radial-offset").evaluate(Yr,{},Ti)*la,Rj=yj),Rt.allowVerticalPlacement&&kr.vertical){const qs=kr.vertical;if(Qn)px=vj(qs),Er&&(mx=vj(Er));else{const Gs=jr.layout.get("text-rotate").evaluate(Yr,{},Ti)+90;Xi=I1(xn,Zf,sr,Tn,Sn,vn,qs,Bn,Gs,bi),Er&&(Bl=I1(xn,Zf,sr,Tn,Sn,vn,Er,Mi,Gs))}}if(hr){const qs=jr.layout.get("icon-rotate").evaluate(Yr,{},Ti),Gs=jr.layout.get("icon-text-fit")!=="none",gx=IO(hr,qs,En,Gs),zj=Er?IO(Er,qs,En,Gs):void 0;Qa=I1(xn,Zf,sr,Tn,Sn,vn,hr,Mi,qs),mR=4*gx.length;const _R=Rt.iconSizeData;let Xf=null;_R.kind==="source"?(Xf=[zl*jr.layout.get("icon-size").evaluate(Yr,{},Ti)],Xf[0]>Yd&&Lt(`${Rt.layerIds[0]}: Value for "icon-size" is >= ${sx}. Reduce your "icon-size".`)):_R.kind==="composite"&&(Xf=[zl*ki.compositeIconSizes[0].evaluate(Yr,{},Ti),zl*ki.compositeIconSizes[1].evaluate(Yr,{},Ti)],(Xf[0]>Yd||Xf[1]>Yd)&&Lt(`${Rt.layerIds[0]}: Value for "icon-size" is >= ${sx}. Reduce your "icon-size".`)),Rt.addSymbols(Rt.icon,gx,Xf,Gn,wi,Yr,!1,wr,sr,ca.lineStartIndex,ca.lineLength,-1,Ja,Ti),Mj=Rt.icon.placedSymbolArray.length-1,zj&&(gR=4*zj.length,Rt.addSymbols(Rt.icon,zj,Xf,Gn,wi,Yr,xo.vertical,wr,sr,ca.lineStartIndex,ca.lineLength,-1,Ja,Ti),Dj=Rt.icon.placedSymbolArray.length-1)}for(const qs in kr.horizontal){const Gs=kr.horizontal[qs];Zi||(vR=NE(Gs.text),Qn?Gm=vj(Gs):Zi=I1(xn,Zf,sr,Tn,Sn,vn,Gs,Bn,jr.layout.get("text-rotate").evaluate(Yr,{},Ti),bi));const gx=Gs.positionedLines.length===1;if(yR+=OO(Rt,wr,sr,Gs,An,jr,Qn,Yr,bi,ca,kr.vertical?xo.horizontal:xo.horizontalOnly,gx?Object.keys(kr.horizontal):[qs],Dc,Mj,ki,Ja,Ti),gx)break}kr.vertical&&(xR+=OO(Rt,wr,sr,kr.vertical,An,jr,Qn,Yr,bi,ca,xo.vertical,["vertical"],Dc,Dj,ki,Ja,Ti));let nh=-1;const Lj=(qs,Gs)=>qs?Math.max(qs,Gs):Gs;nh=Lj(Gm,nh),nh=Lj(px,nh),nh=Lj(mx,nh);const mee=nh>-1?1:0;Rt.glyphOffsetArray.length>=Qd.MAX_GLYPHS&&Lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Yr.sortKey!==void 0&&Rt.addToSortKeyRanges(Rt.symbolInstances.length,Yr.sortKey),Rt.symbolInstances.emplaceBack(Zf.x,Zf.y,Zf.z,sr.x,sr.y,Dc.right>=0?Dc.right:-1,Dc.center>=0?Dc.center:-1,Dc.left>=0?Dc.left:-1,Dc.vertical>=0?Dc.vertical:-1,Mj,Dj,vR,Zi!==void 0?Zi:Rt.collisionBoxArray.length,Zi!==void 0?Zi+1:Rt.collisionBoxArray.length,Xi!==void 0?Xi:Rt.collisionBoxArray.length,Xi!==void 0?Xi+1:Rt.collisionBoxArray.length,Qa!==void 0?Qa:Rt.collisionBoxArray.length,Qa!==void 0?Qa+1:Rt.collisionBoxArray.length,Bl||Rt.collisionBoxArray.length,Bl?Bl+1:Rt.collisionBoxArray.length,Tn,yR,xR,mR,gR,mee,0,Oj,Rj,nh)})(c,er,br,Ut,d,f,y,Ot,c.layers[0],c.collisionBoxArray,s.index,s.sourceLayerIndex,c.index,Fe,dt,N,0,nt,Nt,fe,s,_,M,F,q)};if(st==="line")for(const Ut of NO(s.geometry,0,0,cr,cr)){const er=MQ(Ut,Be,Qe,d.vertical||ge,f,Re,Oe,c.overscaling,cr);for(const Wt of er)ge&&VQ(c,ge.text,yt,Wt)||ct(Ut,Wt,q)}else if(st==="line-center"){for(const Ut of s.geometry)if(Ut.length>1){const er=IQ(Ut,Qe,d.vertical||ge,f,Re,Oe);er&&ct(Ut,er,q)}}else if(s.type==="Polygon")for(const Ut of aj(s.geometry,0)){const er=LQ(Ut,16);ct(Ut[0],new zu(er.x,er.y,0,0,void 0),q)}else if(s.type==="LineString")for(const Ut of s.geometry)ct(Ut,new zu(Ut[0].x,Ut[0].y,0,0,void 0),q);else if(s.type==="Point")for(const Ut of s.geometry)for(const er of Ut)ct([er],new zu(er.x,er.y,0,0,void 0),q)}const sx=255,Yd=sx*zl;function OO(c,s,d,f,y,_,k,E,N,M,F,q,X,te,ie,fe,ge){const je=function(Oe,Be,Fe,nt,Qe,dt,Nt,st){const yt=[];if(Be.positionedLines.length===0)return yt;const xt=nt.layout.get("text-rotate").evaluate(dt,{})*Math.PI/180,kt=function(Wt){const br=Wt[0],Rt=Wt[1],sr=br*Rt;return sr>0?[br,-Rt]:sr<0?[-br,Rt]:br===0?[Rt,br]:[Rt,-br]}(Fe);let Ot=Math.abs(Be.top-Be.bottom);for(const Wt of Be.positionedLines)Ot-=Wt.lineOffset;const ct=Be.positionedLines.length,Ut=Ot/ct;let er=Be.top-Fe[1];for(let Wt=0;Wt<ct;++Wt){const br=Be.positionedLines[Wt];er=DQ(Be,Ut,er,Wt);for(const Rt of br.positionedGlyphs){if(!Rt.rect)continue;const sr=Rt.rect||{};let wr=mO+1,Zr=!0,kr=1,hr=0;if(Rt.imageName){const En=Nt[Rt.imageName];if(!En)continue;if(En.sdf){Lt("SDF images are not supported in formatted text and will be ignored.");continue}Zr=!1,kr=En.pixelRatio,wr=ws/kr}const An=(Qe||st)&&Rt.vertical,Er=Rt.metrics.advance*Rt.scale/2,jr=Rt.metrics,xn=Rt.rect;if(xn===null)continue;st&&Be.verticalizable&&(hr=Rt.imageName?Er-Rt.metrics.width*Rt.scale/2:0);const Tn=Qe?[Rt.x+Er,Rt.y]:[0,0];let Sn=[0,0],vn=[0,0],Bn=!1;Qe||(An?(vn=[Rt.x+Er+kt[0],Rt.y+kt[1]-hr],Bn=!0):Sn=[Rt.x+Er+Fe[0],Rt.y+Fe[1]-hr]);const Qn=xn.w*Rt.scale/(kr*(Rt.localGlyph?$l:1)),bi=xn.h*Rt.scale/(kr*(Rt.localGlyph?$l:1));let _n,Mi,wi,Gn;if(An){const En=Rt.y-er,Ja=new V(-Er,Er-En),Ti=-Math.PI/2,ca=new V(...vn);_n=new V(-Er+Sn[0],Sn[1]),_n._rotateAround(Ti,Ja)._add(ca),_n.x+=-En+Er,_n.y-=(jr.left-wr)*Rt.scale;const Zi=Rt.imageName?jr.advance*Rt.scale:la*Rt.scale,Qa=String.fromCharCode(Rt.glyph);mQ(Qa)?_n.x+=(1-wr)*Rt.scale:gQ(Qa)?_n.x+=Zi-jr.height*Rt.scale+(-wr-1)*Rt.scale:_n.x+=Rt.imageName||jr.width+2*wr===xn.w&&jr.height+2*wr===xn.h?(Zi-bi)/2:(Zi-(jr.height+2*wr)*Rt.scale)/2,Mi=new V(_n.x,_n.y-Qn),wi=new V(_n.x+bi,_n.y),Gn=new V(_n.x+bi,_n.y-Qn)}else{const En=(jr.left-wr)*Rt.scale-Er+Sn[0],Ja=(-jr.top-wr)*Rt.scale+Sn[1],Ti=En+Qn,ca=Ja+bi;_n=new V(En,Ja),Mi=new V(Ti,Ja),wi=new V(En,ca),Gn=new V(Ti,ca)}if(xt){let En;En=Qe?new V(0,0):Bn?new V(kt[0],kt[1]):new V(Fe[0],Fe[1]),_n._rotateAround(xt,En),Mi._rotateAround(xt,En),wi._rotateAround(xt,En),Gn._rotateAround(xt,En)}const Yr=new V(0,0),ki=new V(0,0);yt.push({tl:_n,tr:Mi,bl:wi,br:Gn,tex:sr,writingMode:Be.writingMode,glyphOffset:Tn,sectionIndex:Rt.sectionIndex,isSDF:Zr,pixelOffsetTL:Yr,pixelOffsetBR:ki,minFontScaleX:0,minFontScaleY:0})}}return yt}(0,f,N,_,k,E,y,c.allowVerticalPlacement),Re=c.textSizeData;let Ae=null;Re.kind==="source"?(Ae=[zl*_.layout.get("text-size").evaluate(E,{},ge)],Ae[0]>Yd&&Lt(`${c.layerIds[0]}: Value for "text-size" is >= ${sx}. Reduce your "text-size".`)):Re.kind==="composite"&&(Ae=[zl*ie.compositeTextSizes[0].evaluate(E,{},ge),zl*ie.compositeTextSizes[1].evaluate(E,{},ge)],(Ae[0]>Yd||Ae[1]>Yd)&&Lt(`${c.layerIds[0]}: Value for "text-size" is >= ${sx}. Reduce your "text-size".`)),c.addSymbols(c.text,je,Ae,N,k,E,F,s,d,M.lineStartIndex,M.lineLength,te,fe,ge);for(const Oe of q)X[Oe]=c.text.placedSymbolArray.length-1;return 4*je.length}function RO(c){for(const s in c)return c[s];return null}function I1(c,s,d,f,y,_,k,E,N,M){let F=k.top,q=k.bottom,X=k.left,te=k.right;const ie=k.collisionPadding;if(ie&&(X-=ie[0],F-=ie[1],te+=ie[2],q+=ie[3]),N){const fe=new V(X,F),ge=new V(te,F),je=new V(X,q),Re=new V(te,q),Ae=ce(N);let Oe=new V(0,0);M&&(Oe=new V(M[0],M[1])),fe._rotateAround(Ae,Oe),ge._rotateAround(Ae,Oe),je._rotateAround(Ae,Oe),Re._rotateAround(Ae,Oe),X=Math.min(fe.x,ge.x,je.x,Re.x),te=Math.max(fe.x,ge.x,je.x,Re.x),F=Math.min(fe.y,ge.y,je.y,Re.y),q=Math.max(fe.y,ge.y,je.y,Re.y)}return c.emplaceBack(s.x,s.y,s.z,d.x,d.y,X,F,te,q,E,f,y,_),c.length-1}function vj(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const s=c.bottom-c.top;return s>0?Math.max(10,s):null}function VQ(c,s,d,f){const y=c.compareText;if(s in y){const _=y[s];for(let k=_.length-1;k>=0;k--)if(f.dist(_[k])<d)return!0}else y[s]=[];return y[s].push(f),!1}function LO(c,s){const d=c.fovAboveCenter,f=c.elevation?c.elevation.getMinElevationBelowMSL()*s:0,y=(c._camera.position[2]*c.worldSize-f)/Math.cos(c._pitch),_=Math.sin(d)*y/Math.sin(Math.max(Math.PI/2-c._pitch-d,.01)),k=Math.sin(c._pitch)*_+y;return Math.min(1.01*k,y*(1/c._horizonShift))}function Hf(c,s){if(!s.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:s};const d=Math.pow(2,-c.z),f=c.x*d,y=(c.x+1)*d,_=c.y*d,k=(c.y+1)*d,E=yo(f),N=yo(y),M=ka(_),F=ka(k),q=s.project(E,M),X=s.project(N,M),te=s.project(N,F),ie=s.project(E,F);let fe=Math.min(q.x,X.x,te.x,ie.x),ge=Math.min(q.y,X.y,te.y,ie.y),je=Math.max(q.x,X.x,te.x,ie.x),Re=Math.max(q.y,X.y,te.y,ie.y);const Ae=d/16;function Oe(Fe,nt,Qe,dt,Nt,st){const yt=(Qe+Nt)/2,xt=(dt+st)/2,kt=s.project(yo(yt),ka(xt)),Ot=Math.max(0,fe-kt.x,ge-kt.y,kt.x-je,kt.y-Re);fe=Math.min(fe,kt.x),je=Math.max(je,kt.x),ge=Math.min(ge,kt.y),Re=Math.max(Re,kt.y),Ot>Ae&&(Oe(Fe,kt,Qe,dt,yt,xt),Oe(kt,nt,yt,xt,Nt,st))}Oe(q,X,f,_,y,_),Oe(X,te,y,_,y,k),Oe(te,ie,y,k,f,k),Oe(ie,q,f,k,f,_),fe-=Ae,ge-=Ae,je+=Ae,Re+=Ae;const Be=1/Math.max(je-fe,Re-ge);return{scale:Be,x:fe*Be,y:ge*Be,x2:je*Be,y2:Re*Be,projection:s}}const UQ=Ol(new Float32Array(16));class Jd{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,d){return{x:0,y:0,z:0}}unproject(s,d){return new yn(0,0)}projectTilePoint(s,d,f){return{x:s,y:d,z:0}}locationPoint(s,d,f=!0){return s._coordinatePoint(s.locationCoordinate(d),f)}pixelsPerMeter(s,d){return Ll(1,s)*d}pixelSpaceConversion(s,d,f){return 1}farthestPixelDistance(s){return LO(s,s.pixelsPerMeter)}pointCoordinate(s,d,f,y){const _=s.horizonLineFromTop(!1),k=new V(d,Math.max(_,f));return s.rayIntersectionCoordinate(s.pointRayIntersection(k,y))}pointCoordinate3D(s,d,f){const y=new V(d,f);if(s.elevation)return s.elevation.pointCoordinate(y);{const _=this.pointCoordinate(s,y.x,y.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(s,d){if(s.elevation)return!this.pointCoordinate3D(s,d.x,d.y);const f=s.horizonLineFromTop();return d.y<f}createInversionMatrix(s,d){return UQ}createTileMatrix(s,d,f){let y,_,k;const E=f.canonical,N=Ol(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=Hf(E,this);y=1,_=M.x+f.wrap*M.scale,k=M.y,Ff(N,N,[y/M.scale,y/M.scale,s.pixelsPerMeter/d])}else y=d/s.zoomScale(E.z),_=(E.x+Math.pow(2,E.z)*f.wrap)*y,k=E.y*y;return Ly(N,N,[_,k,0]),Ff(N,N,[y/cr,y/cr,1]),N}upVector(s,d,f){return[0,0,1]}upVectorScale(s,d,f){return{metersToTile:1}}}class qQ extends Jd{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[d,f]=this.parallels=s.parallels||[29.5,45.5],y=Math.sin(ce(d));this.n=(y+Math.sin(ce(f)))/2,this.c=1+y*(2*this.n-y),this.r0=Math.sqrt(this.c)/this.n}project(s,d){const{n:f,c:y,r0:_}=this,k=ce(s-this.center[0]),E=ce(d),N=Math.sqrt(y-2*f*Math.sin(E))/f;return{x:N*Math.sin(k*f),y:N*Math.cos(k*f)-_,z:0}}unproject(s,d){const{n:f,c:y,r0:_}=this,k=_+d;let E=Math.atan2(s,Math.abs(k))*Math.sign(k);k*f<0&&(E-=Math.PI*Math.sign(s)*Math.sign(k));const N=ce(this.center[0])*f;E=be(E,-Math.PI-N,Math.PI-N);const M=ye(ne(E/f)+this.center[0],-180,180),F=Math.asin(ye((y-(s*s+k*k)*f*f)/(2*f),-1,1)),q=ye(ne(F),-Ta,Ta);return new yn(M,q)}}const ox=1.340264,lx=-.081106,cx=893e-6,ux=.003796,M1=Math.sqrt(3)/2;class GQ extends Jd{project(s,d){d=d/180*Math.PI,s=s/180*Math.PI;const f=Math.asin(M1*Math.sin(d)),y=f*f,_=y*y*y;return{x:.5*(s*Math.cos(f)/(M1*(ox+3*lx*y+_*(7*cx+9*ux*y)))/Math.PI+.5),y:1-.5*(f*(ox+lx*y+_*(cx+ux*y))/Math.PI+1),z:0}}unproject(s,d){s=(2*s-.5)*Math.PI;let f=d=(2*(1-d)-1)*Math.PI,y=f*f,_=y*y*y;for(let F,q,X,te=0;te<12&&(q=f*(ox+lx*y+_*(cx+ux*y))-d,X=ox+3*lx*y+_*(7*cx+9*ux*y),F=q/X,f=ye(f-F,-Math.PI/3,Math.PI/3),y=f*f,_=y*y*y,!(Math.abs(F)<1e-12));++te);const k=M1*s*(ox+3*lx*y+_*(7*cx+9*ux*y))/Math.cos(f),E=Math.asin(Math.sin(f)/M1),N=ye(180*k/Math.PI,-180,180),M=ye(180*E/Math.PI,-Ta,Ta);return new yn(N,M)}}class WQ extends Jd{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,d){return{x:.5+s/360,y:.5-d/360,z:0}}unproject(s,d){const f=360*(s-.5),y=ye(360*(.5-d),-Ta,Ta);return new yn(f,y)}}const Um=Math.PI/2;function D1(c){return Math.tan((Um+c)/2)}class HQ extends Jd{constructor(s){super(s),this.center=s.center||[0,30];const[d,f]=this.parallels=s.parallels||[30,30];let y=ce(d),_=ce(f);this.southernCenter=y+_<0,this.southernCenter&&(y=-y,_=-_);const k=Math.cos(y),E=D1(y);this.n=y===_?Math.sin(y):Math.log(k/Math.cos(_))/Math.log(D1(_)/E),this.f=k*Math.pow(D1(y),this.n)/this.n}project(s,d){d=ce(d),this.southernCenter&&(d=-d),s=ce(s-this.center[0]);const f=1e-6,{n:y,f:_}=this;_>0?d<-Um+f&&(d=-Um+f):d>Um-f&&(d=Um-f);const k=_/Math.pow(D1(d),y);let E=k*Math.sin(y*s),N=_-k*Math.cos(y*s);return E=.5*(E/Math.PI+.5),N=.5*(N/Math.PI+.5),{x:E,y:this.southernCenter?N:1-N,z:0}}unproject(s,d){s=(2*s-.5)*Math.PI,this.southernCenter&&(d=1-d),d=(2*(1-d)-.5)*Math.PI;const{n:f,f:y}=this,_=y-d,k=Math.sign(_),E=Math.sign(f)*Math.sqrt(s*s+_*_);let N=Math.atan2(s,Math.abs(_))*k;_*f<0&&(N-=Math.PI*Math.sign(s)*k);const M=ye(ne(N/f)+this.center[0],-180,180),F=ye(ne(2*Math.atan(Math.pow(y/E,1/f))-Um),-Ta,Ta);return new yn(M,this.southernCenter?-F:F)}}class zO extends Jd{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,d){return{x:Nc(s),y:Cc(d),z:0}}unproject(s,d){const f=yo(s),y=ka(d);return new yn(f,y)}}const $O=ce(Ta);class KQ extends Jd{project(s,d){const f=(d=ce(d))*d,y=f*f;return{x:.5*((s=ce(s))*(.8707-.131979*f+y*(y*(.003971*f-.001529*y)-.013791))/Math.PI+.5),y:1-.5*(d*(1.007226+f*(.015085+y*(.028874*f-.044475-.005916*y)))/Math.PI+1),z:0}}unproject(s,d){s=(2*s-.5)*Math.PI;let f=d=(2*(1-d)-1)*Math.PI,y=25,_=0,k=f*f;do{k=f*f;const M=k*k;_=(f*(1.007226+k*(.015085+M*(.028874*k-.044475-.005916*M)))-d)/(1.007226+k*(.045255+M*(.259866*k-.311325-.005916*11*M))),f=ye(f-_,-$O,$O)}while(Math.abs(_)>1e-6&&--y>0);k=f*f;const E=ye(ne(s/(.8707+k*(k*(k*k*k*(.003971-.001529*k)-.013791)-.131979))),-180,180),N=ne(f);return new yn(E,N)}}const FO=ce(Ta);class ZQ extends Jd{project(s,d){d=ce(d),s=ce(s);const f=Math.cos(d),y=2/Math.PI,_=Math.acos(f*Math.cos(s/2)),k=Math.sin(_)/_,E=.5*(s*y+2*f*Math.sin(s/2)/k)||0,N=.5*(d+Math.sin(d)/k)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(N/Math.PI+1),z:0}}unproject(s,d){let f=s=(2*s-.5)*Math.PI,y=d=(2*(1-d)-1)*Math.PI,_=25;const k=1e-6;let E=0,N=0;do{const M=Math.cos(y),F=Math.sin(y),q=2*F*M,X=F*F,te=M*M,ie=Math.cos(f/2),fe=Math.sin(f/2),ge=2*ie*fe,je=fe*fe,Re=1-te*ie*ie,Ae=Re?1/Re:0,Oe=Re?Math.acos(M*ie)*Math.sqrt(1/Re):0,Be=.5*(2*Oe*M*fe+2*f/Math.PI)-s,Fe=.5*(Oe*F+y)-d,nt=.5*Ae*(te*je+Oe*M*ie*X)+1/Math.PI,Qe=Ae*(ge*q/4-Oe*F*fe),dt=.125*Ae*(q*fe-Oe*F*te*ge),Nt=.5*Ae*(X*ie+Oe*je*M)+.5,st=Qe*dt-Nt*nt;E=(Fe*Qe-Be*Nt)/st,N=(Be*dt-Fe*nt)/st,f=ye(f-E,-Math.PI,Math.PI),y=ye(y-N,-FO,FO)}while((Math.abs(E)>k||Math.abs(N)>k)&&--_>0);return new yn(ne(f),ne(y))}}class BO extends Jd{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ce(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,d){const{scale:f,cosPhi:y}=this;return{x:ce(s)*y*f+.5,y:-Math.sin(ce(d))/y*f+.5,z:0}}unproject(s,d){const{scale:f,cosPhi:y}=this,_=-(d-.5)/f,k=ye(ne((s-.5)/f)/y,-180,180),E=Math.asin(ye(_*y,-1,1)),N=ye(ne(E),-Ta,Ta);return new yn(k,N)}}class XQ extends zO{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,d,f){const y=Gy(s,d,f);return ui(y,y,Wy(Ac(f))),{x:y[0],y:y[1],z:y[2]}}locationPoint(s,d){const f=Am(d.lat,d.lng),y=Za([],f),_=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(d),s._centerAltitude):s._centerAltitude;By(f,f,y,Ll(1,0)*cr*_);const k=Ol(new Float64Array(16));return $f(k,s.pixelMatrix,s.globeMatrix),ui(f,f,k),new V(f[0],f[1])}pixelsPerMeter(s,d){return Ll(1,0)*d}pixelSpaceConversion(s,d,f){const y=Ll(1,s)*d,_=Z(Ll(1,45)*d,y,f);return this.pixelsPerMeter(s,d)/_}createTileMatrix(s,d,f){const y=UE(Ac(f.canonical));return $f(new Float64Array(16),s.globeMatrix,y)}createInversionMatrix(s,d){const{center:f}=s,y=Wy(Ac(d));return l1(y,y,ce(f.lng)),ME(y,y,ce(f.lat)),Ff(y,y,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(y)}pointCoordinate(s,d,f,y){return pD(s,d,f,!0)||new Cm(0,0)}pointCoordinate3D(s,d,f){const y=this.pointCoordinate(s,d,f,0);return[y.x,y.y,y.z]}isPointAboveHorizon(s,d){return!pD(s,d.x,d.y,!1)}farthestPixelDistance(s){const d=function(y,_){const k=y.cameraToCenterDistance,E=y._centerAltitude*_,N=y._camera,M=y._camera.forward(),F=Du([],go([],M,-k),[0,0,E]),q=y.worldSize/(2*Math.PI),X=[0,0,-q],te=y.width/y.height,ie=Math.tan(y.fovAboveCenter),fe=go([],N.up(),ie),ge=go([],N.right(),ie*te),je=Za([],Du([],Du([],M,fe),ge)),Re=[];let Ae;if(new LE(F,je).closestPointOnSphere(X,q,Re)){const Oe=Du([],Re,X),Be=Rl([],Oe,F);Ae=Math.cos(y.fovAboveCenter)*zy(Be)}else{const Oe=Rl([],F,X),Be=Rl([],X,F);Za(Be,Be);const Fe=zy(Oe)-q;Ae=Math.sqrt(Fe*(Fe+2*q));const nt=Math.acos(Ae/(q+Fe))-Math.acos(Wo(M,Be));Ae*=Math.cos(nt)}return 1.01*Ae}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),f=Nm(s.zoom);if(f>0){const y=LO(s,Ll(1,s.center.lat)*s.worldSize),_=s.worldSize/(2*Math.PI),k=Math.max(s.width,s.height)/s.worldSize*Math.PI;return Z(d,y+_*(1-Math.cos(k)),Math.pow(f,10))}return d}upVector(s,d,f){return Gy(d,f,s,1)}upVectorScale(s){return{metersToTile:c1(d1(Ac(s)))}}}function VO(c){const s=c.parallels,d=!!s&&Math.abs(s[0]+s[1])<.01;switch(c.name){case"mercator":return new zO(c);case"equirectangular":return new WQ(c);case"naturalEarth":return new KQ(c);case"equalEarth":return new GQ(c);case"winkelTripel":return new ZQ(c);case"albers":return d?new BO(c):new qQ(c);case"lambertConformalConic":return d?new BO(c):new HQ(c);case"globe":return new XQ(c)}throw new Error(`Invalid projection name: ${c.name}`)}const YQ=b1.types,JQ=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function O1(c,s,d,f,y,_,k,E,N,M,F,q,X){const te=E?Math.min(Yd,Math.round(E[0])):0,ie=E?Math.min(Yd,Math.round(E[1])):0;c.emplaceBack(s,d,Math.round(32*f),Math.round(32*y),_,k,(te<<1)+(N?1:0),ie,16*M,16*F,256*q,256*X)}function R1(c,s,d,f,y,_,k){c.emplaceBack(s,d,f,y,_,k)}function L1(c,s,d,f,y){c.emplaceBack(s,d,f,y),c.emplaceBack(s,d,f,y),c.emplaceBack(s,d,f,y),c.emplaceBack(s,d,f,y)}function QQ(c){for(const s of c.sections)if(AE(s.text))return!0;return!1}class _j{constructor(s){this.layoutVertexArray=new _t,this.indexArray=new rr,this.programConfigurations=s,this.segments=new vi,this.dynamicLayoutVertexArray=new Et,this.opacityVertexArray=new ir,this.placedSymbolArray=new xi,this.globeExtVertexArray=new Mt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,d,f,y){this.isEmpty()||(f&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,oQ.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,cQ.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,JQ,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,lQ.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||y)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Xt(_j,"SymbolBuffers");class bj{constructor(s,d,f){this.layoutVertexArray=new s,this.layoutAttributes=d,this.indexArray=new f,this.segments=new vi,this.collisionVertexArray=new Rr,this.collisionVertexArrayExt=new Or}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,uQ.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,dQ.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Xt(bj,"CollisionBuffers");class Qd{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(k=>k.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ol([]),this.placementViewportMatrix=Ol([]);const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=cj(this.zoom,d["text-size"]),this.iconSizeData=cj(this.zoom,d["icon-size"]);const f=this.layers[0].layout,y=f.get("symbol-sort-key"),_=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&y.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(k=>xo[k]),this.stateDependentLayerIds=this.layers.filter(k=>k.isStateDependent()).map(k=>k.id),this.sourceID=s.sourceID,this.projection=s.projection}createArrays(){this.text=new _j(new zf(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new _j(new zf(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new Ka,this.lineVertexArray=new km,this.symbolInstances=new Mn}calculateGlyphDependencies(s,d,f,y,_){for(let k=0;k<s.length;k++)if(d[s.charCodeAt(k)]=!0,y&&_){const E=nx[s.charAt(k)];E&&(d[E.charCodeAt(0)]=!0)}}populate(s,d,f,y){const _=this.layers[0],k=_.layout,E=this.projection.name==="globe",N=k.get("text-font"),M=k.get("text-field"),F=k.get("icon-image"),q=(M.value.kind!=="constant"||M.value.value instanceof _a&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),X=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,te=k.get("symbol-sort-key");if(this.features=[],!q&&!X)return;const ie=d.iconDependencies,fe=d.glyphDependencies,ge=d.availableImages,je=new U(this.zoom);for(const{feature:Re,id:Ae,index:Oe,sourceLayerIndex:Be}of s){const Fe=_._featureFilter.needGeometry,nt=qf(Re,Fe);if(!_._featureFilter.filter(je,nt,f))continue;if(Fe||(nt.geometry=Ou(Re,f,y)),E&&Re.type!==1&&f.z<=5){const st=nt.geometry,yt=.98078528056,xt=(kt,Ot)=>Wo(Gy(kt.x,kt.y,f,1),Gy(Ot.x,Ot.y,f,1))<yt;for(let kt=0;kt<st.length;kt++)st[kt]=cJ(st[kt],xt)}let Qe,dt;if(q){const st=_.getValueAndResolveTokens("text-field",nt,f,ge),yt=_a.factory(st);QQ(yt)&&(this.hasRTLText=!0),(!this.hasRTLText||j()==="unavailable"||this.hasRTLText&&z.isParsed())&&(Qe=pQ(yt,_,nt))}if(X){const st=_.getValueAndResolveTokens("icon-image",nt,f,ge);dt=st instanceof Wa?st:Wa.fromString(st)}if(!Qe&&!dt)continue;const Nt=this.sortFeaturesByKey?te.evaluate(nt,{},f):void 0;if(this.features.push({id:Ae,text:Qe,icon:dt,index:Oe,sourceLayerIndex:Be,geometry:nt.geometry,properties:Re.properties,type:YQ[Re.type],sortKey:Nt}),dt&&(ie[dt.name]=!0),Qe){const st=N.evaluate(nt,{},f).join(","),yt=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(xo.vertical)>=0;for(const xt of Qe.sections)if(xt.image)ie[xt.image.name]=!0;else{const kt=Cy(Qe.toString()),Ot=xt.fontStack||st,ct=fe[Ot]=fe[Ot]||{};this.calculateGlyphDependencies(xt.text,ct,yt,this.allowVerticalPlacement,kt)}}}k.get("symbol-placement")==="line"&&(this.features=function(Re){const Ae={},Oe={},Be=[];let Fe=0;function nt(st){Be.push(Re[st]),Fe++}function Qe(st,yt,xt){const kt=Oe[st];return delete Oe[st],Oe[yt]=kt,Be[kt].geometry[0].pop(),Be[kt].geometry[0]=Be[kt].geometry[0].concat(xt[0]),kt}function dt(st,yt,xt){const kt=Ae[yt];return delete Ae[yt],Ae[st]=kt,Be[kt].geometry[0].shift(),Be[kt].geometry[0]=xt[0].concat(Be[kt].geometry[0]),kt}function Nt(st,yt,xt){const kt=xt?yt[0][yt[0].length-1]:yt[0][0];return`${st}:${kt.x}:${kt.y}`}for(let st=0;st<Re.length;st++){const yt=Re[st],xt=yt.geometry,kt=yt.text?yt.text.toString():null;if(!kt){nt(st);continue}const Ot=Nt(kt,xt),ct=Nt(kt,xt,!0);if(Ot in Oe&&ct in Ae&&Oe[Ot]!==Ae[ct]){const Ut=dt(Ot,ct,xt),er=Qe(Ot,ct,Be[Ut].geometry);delete Ae[Ot],delete Oe[ct],Oe[Nt(kt,Be[er].geometry,!0)]=er,Be[Ut].geometry=null}else Ot in Oe?Qe(Ot,ct,xt):ct in Ae?dt(Ot,ct,xt):(nt(st),Ae[Ot]=Fe-1,Oe[ct]=Fe-1)}return Be.filter(st=>st.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Re,Ae)=>Re.sortKey-Ae.sortKey)}update(s,d,f,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,d,this.layers,f,y),this.icon.programConfigurations.updatePaintArrays(s,d,this.layers,f,y))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=VO(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,d){const f=this.lineVertexArray.length;if(s.segment!==void 0)for(const{x:y,y:_}of d)this.lineVertexArray.emplaceBack(y,_);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(s,d,f,y,_,k,E,N,M,F,q,X,te,ie){const fe=s.indexArray,ge=s.layoutVertexArray,je=s.globeExtVertexArray,Re=s.segments.prepareSegment(4*d.length,ge,fe,this.canOverlap?k.sortKey:void 0),Ae=this.glyphOffsetArray.length,Oe=Re.vertexLength,Be=this.allowVerticalPlacement&&E===xo.vertical?Math.PI/2:0,Fe=k.text&&k.text.sections;for(let Qe=0;Qe<d.length;Qe++){const{tl:dt,tr:Nt,bl:st,br:yt,tex:xt,pixelOffsetTL:kt,pixelOffsetBR:Ot,minFontScaleX:ct,minFontScaleY:Ut,glyphOffset:er,isSDF:Wt,sectionIndex:br}=d[Qe],Rt=Re.vertexLength,sr=er[1];if(O1(ge,M.x,M.y,dt.x,sr+dt.y,xt.x,xt.y,f,Wt,kt.x,kt.y,ct,Ut),O1(ge,M.x,M.y,Nt.x,sr+Nt.y,xt.x+xt.w,xt.y,f,Wt,Ot.x,kt.y,ct,Ut),O1(ge,M.x,M.y,st.x,sr+st.y,xt.x,xt.y+xt.h,f,Wt,kt.x,Ot.y,ct,Ut),O1(ge,M.x,M.y,yt.x,sr+yt.y,xt.x+xt.w,xt.y+xt.h,f,Wt,Ot.x,Ot.y,ct,Ut),N){const{x:wr,y:Zr,z:kr}=N.anchor,[hr,An,Er]=N.up;R1(je,wr,Zr,kr,hr,An,Er),R1(je,wr,Zr,kr,hr,An,Er),R1(je,wr,Zr,kr,hr,An,Er),R1(je,wr,Zr,kr,hr,An,Er),L1(s.dynamicLayoutVertexArray,wr,Zr,kr,Be)}else L1(s.dynamicLayoutVertexArray,M.x,M.y,M.z,Be);fe.emplaceBack(Rt,Rt+1,Rt+2),fe.emplaceBack(Rt+1,Rt+2,Rt+3),Re.vertexLength+=4,Re.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(er[0]),Qe!==d.length-1&&br===d[Qe+1].sectionIndex||s.programConfigurations.populatePaintArrays(ge.length,k,k.index,{},te,ie,Fe&&Fe[br])}const nt=N?N.anchor:M;s.placedSymbolArray.emplaceBack(nt.x,nt.y,nt.z,M.x,M.y,Ae,this.glyphOffsetArray.length-Ae,Oe,F,q,M.segment,f?f[0]:0,f?f[1]:0,y[0],y[1],E,0,!1,0,X,0)}_commitLayoutVertex(s,d,f,y,_,k,E){s.emplaceBack(d,f,y,_,k,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(s,d,f,y,_,k,E){const N=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),M=N.vertexLength,F=E.tileAnchorX,q=E.tileAnchorY;for(let te=0;te<4;te++)f.collisionVertexArray.emplaceBack(0,0,0,0);f.collisionVertexArrayExt.emplaceBack(d,-s.padding,-s.padding),f.collisionVertexArrayExt.emplaceBack(d,s.padding,-s.padding),f.collisionVertexArrayExt.emplaceBack(d,s.padding,s.padding),f.collisionVertexArrayExt.emplaceBack(d,-s.padding,s.padding),this._commitLayoutVertex(f.layoutVertexArray,y,_,k,F,q,new V(s.x1,s.y1)),this._commitLayoutVertex(f.layoutVertexArray,y,_,k,F,q,new V(s.x2,s.y1)),this._commitLayoutVertex(f.layoutVertexArray,y,_,k,F,q,new V(s.x2,s.y2)),this._commitLayoutVertex(f.layoutVertexArray,y,_,k,F,q,new V(s.x1,s.y2)),N.vertexLength+=4;const X=f.indexArray;X.emplaceBack(M,M+1),X.emplaceBack(M+1,M+2),X.emplaceBack(M+2,M+3),X.emplaceBack(M+3,M),N.primitiveLength+=4}_addTextDebugCollisionBoxes(s,d,f,y,_,k){for(let E=y;E<_;E++){const N=f.get(E),M=this.getSymbolInstanceTextSize(s,k,d,E);this._addCollisionDebugVertices(N,M,this.textCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,k)}}_addIconDebugCollisionBoxes(s,d,f,y,_,k){for(let E=y;E<_;E++){const N=f.get(E),M=this.getSymbolInstanceIconSize(s,d,k.placedIconSymbolIndex);this._addCollisionDebugVertices(N,M,this.iconCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,k)}}generateCollisionDebugBuffers(s,d){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bj(Qt,oO.members,Ki),this.iconCollisionBox=new bj(Qt,oO.members,Ki);const f=Om(this.iconSizeData,s),y=Om(this.textSizeData,s);for(let _=0;_<this.symbolInstances.length;_++){const k=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(y,s,d,k.textBoxStartIndex,k.textBoxEndIndex,k),this._addTextDebugCollisionBoxes(y,s,d,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k),this._addIconDebugCollisionBoxes(f,s,d,k.iconBoxStartIndex,k.iconBoxEndIndex,k),this._addIconDebugCollisionBoxes(f,s,d,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex,k)}}getSymbolInstanceTextSize(s,d,f,y){const _=this.text.placedSymbolArray.get(d.rightJustifiedTextSymbolIndex>=0?d.rightJustifiedTextSymbolIndex:d.centerJustifiedTextSymbolIndex>=0?d.centerJustifiedTextSymbolIndex:d.leftJustifiedTextSymbolIndex>=0?d.leftJustifiedTextSymbolIndex:d.verticalPlacedTextSymbolIndex>=0?d.verticalPlacedTextSymbolIndex:y),k=S1(this.textSizeData,s,_)/la;return this.tilePixelRatio*k}getSymbolInstanceIconSize(s,d,f){const y=this.icon.placedSymbolArray.get(f),_=S1(this.iconSizeData,s,y);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(s,d,f){s.emplaceBack(d,-f,-f),s.emplaceBack(d,f,-f),s.emplaceBack(d,f,f),s.emplaceBack(d,-f,f)}_updateTextDebugCollisionBoxes(s,d,f,y,_,k){for(let E=y;E<_;E++){const N=f.get(E),M=this.getSymbolInstanceTextSize(s,k,d,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,N.padding)}}_updateIconDebugCollisionBoxes(s,d,f,y,_,k){for(let E=y;E<_;E++){const N=f.get(E),M=this.getSymbolInstanceIconSize(s,d,k);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,N.padding)}}updateCollisionDebugBuffers(s,d){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=Om(this.iconSizeData,s),y=Om(this.textSizeData,s);for(let _=0;_<this.symbolInstances.length;_++){const k=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(y,s,d,k.textBoxStartIndex,k.textBoxEndIndex,k),this._updateTextDebugCollisionBoxes(y,s,d,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k),this._updateIconDebugCollisionBoxes(f,s,d,k.iconBoxStartIndex,k.iconBoxEndIndex,k.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(f,s,d,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex,k.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,d,f,y,_,k,E,N,M){const F={};if(d<f){const{x1:q,y1:X,x2:te,y2:ie,padding:fe,projectedAnchorX:ge,projectedAnchorY:je,projectedAnchorZ:Re,tileAnchorX:Ae,tileAnchorY:Oe,featureIndex:Be}=s.get(d);F.textBox={x1:q,y1:X,x2:te,y2:ie,padding:fe,projectedAnchorX:ge,projectedAnchorY:je,projectedAnchorZ:Re,tileAnchorX:Ae,tileAnchorY:Oe},F.textFeatureIndex=Be}if(y<_){const{x1:q,y1:X,x2:te,y2:ie,padding:fe,projectedAnchorX:ge,projectedAnchorY:je,projectedAnchorZ:Re,tileAnchorX:Ae,tileAnchorY:Oe,featureIndex:Be}=s.get(y);F.verticalTextBox={x1:q,y1:X,x2:te,y2:ie,padding:fe,projectedAnchorX:ge,projectedAnchorY:je,projectedAnchorZ:Re,tileAnchorX:Ae,tileAnchorY:Oe},F.verticalTextFeatureIndex=Be}if(k<E){const{x1:q,y1:X,x2:te,y2:ie,padding:fe,projectedAnchorX:ge,projectedAnchorY:je,projectedAnchorZ:Re,tileAnchorX:Ae,tileAnchorY:Oe,featureIndex:Be}=s.get(k);F.iconBox={x1:q,y1:X,x2:te,y2:ie,padding:fe,projectedAnchorX:ge,projectedAnchorY:je,projectedAnchorZ:Re,tileAnchorX:Ae,tileAnchorY:Oe},F.iconFeatureIndex=Be}if(N<M){const{x1:q,y1:X,x2:te,y2:ie,padding:fe,projectedAnchorX:ge,projectedAnchorY:je,projectedAnchorZ:Re,tileAnchorX:Ae,tileAnchorY:Oe,featureIndex:Be}=s.get(N);F.verticalIconBox={x1:q,y1:X,x2:te,y2:ie,padding:fe,projectedAnchorX:ge,projectedAnchorY:je,projectedAnchorZ:Re,tileAnchorX:Ae,tileAnchorY:Oe},F.verticalIconFeatureIndex=Be}return F}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,d){const f=s.placedSymbolArray.get(d),y=f.vertexStartIndex+4*f.numGlyphs;for(let _=f.vertexStartIndex;_<y;_+=4)s.indexArray.emplaceBack(_,_+1,_+2),s.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const d=Math.sin(s),f=Math.cos(s),y=[],_=[],k=[];for(let E=0;E<this.symbolInstances.length;++E){k.push(E);const N=this.symbolInstances.get(E);y.push(0|Math.round(d*N.tileAnchorX+f*N.tileAnchorY)),_.push(N.featureIndex)}return k.sort((E,N)=>y[E]-y[N]||_[N]-_[E]),k}addToSortKeyRanges(s,d){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===d?f.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const f=this.symbolInstances.get(d);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:y,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:N,verticalPlacedIconSymbolIndex:M}=f;y>=0&&this.addIndicesForPlacedSymbol(this.text,y),_>=0&&_!==y&&this.addIndicesForPlacedSymbol(this.text,_),k>=0&&k!==_&&k!==y&&this.addIndicesForPlacedSymbol(this.text,k),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),N>=0&&this.addIndicesForPlacedSymbol(this.icon,N),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Xt(Qd,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Qd.MAX_GLYPHS=65535,Qd.addDynamicAttributes=L1;const eee=new Ie({"symbol-placement":new he(lt.layout_symbol["symbol-placement"]),"symbol-spacing":new he(lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new he(lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ve(lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new he(lt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new he(lt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new he(lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new he(lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new he(lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ve(lt.layout_symbol["icon-size"]),"icon-text-fit":new he(lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new he(lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ve(lt.layout_symbol["icon-image"]),"icon-rotate":new ve(lt.layout_symbol["icon-rotate"]),"icon-padding":new he(lt.layout_symbol["icon-padding"]),"icon-keep-upright":new he(lt.layout_symbol["icon-keep-upright"]),"icon-offset":new ve(lt.layout_symbol["icon-offset"]),"icon-anchor":new ve(lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new he(lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new he(lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new he(lt.layout_symbol["text-rotation-alignment"]),"text-field":new ve(lt.layout_symbol["text-field"]),"text-font":new ve(lt.layout_symbol["text-font"]),"text-size":new ve(lt.layout_symbol["text-size"]),"text-max-width":new ve(lt.layout_symbol["text-max-width"]),"text-line-height":new ve(lt.layout_symbol["text-line-height"]),"text-letter-spacing":new ve(lt.layout_symbol["text-letter-spacing"]),"text-justify":new ve(lt.layout_symbol["text-justify"]),"text-radial-offset":new ve(lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new he(lt.layout_symbol["text-variable-anchor"]),"text-anchor":new ve(lt.layout_symbol["text-anchor"]),"text-max-angle":new he(lt.layout_symbol["text-max-angle"]),"text-writing-mode":new he(lt.layout_symbol["text-writing-mode"]),"text-rotate":new ve(lt.layout_symbol["text-rotate"]),"text-padding":new he(lt.layout_symbol["text-padding"]),"text-keep-upright":new he(lt.layout_symbol["text-keep-upright"]),"text-transform":new ve(lt.layout_symbol["text-transform"]),"text-offset":new ve(lt.layout_symbol["text-offset"]),"text-allow-overlap":new he(lt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new he(lt.layout_symbol["text-ignore-placement"]),"text-optional":new he(lt.layout_symbol["text-optional"])});var wj={paint:new Ie({"icon-opacity":new ve(lt.paint_symbol["icon-opacity"]),"icon-color":new ve(lt.paint_symbol["icon-color"]),"icon-halo-color":new ve(lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ve(lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ve(lt.paint_symbol["icon-halo-blur"]),"icon-translate":new he(lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new he(lt.paint_symbol["icon-translate-anchor"]),"text-opacity":new ve(lt.paint_symbol["text-opacity"]),"text-color":new ve(lt.paint_symbol["text-color"],{runtimeType:gi,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new ve(lt.paint_symbol["text-halo-color"]),"text-halo-width":new ve(lt.paint_symbol["text-halo-width"]),"text-halo-blur":new ve(lt.paint_symbol["text-halo-blur"]),"text-translate":new he(lt.paint_symbol["text-translate"]),"text-translate-anchor":new he(lt.paint_symbol["text-translate-anchor"])}),layout:eee};class UO{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:gc,this.defaultValue=s}evaluate(s){if(s.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(s.formattedSection))return d.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Xt(UO,"FormatSectionOverride",{omit:["defaultValue"]});class z1 extends Dl{constructor(s){super(s,wj)}recalculate(s,d){super.recalculate(s,d),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const y=[];for(const _ of f)y.indexOf(_)<0&&y.push(_);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(s,d,f,y){const _=this.layout.get(s).evaluate(d,{},f,y),k=this._unevaluatedLayout._values[s];return k.isDataDriven()||Bd(k.value)||!_?_:function(E,N){return N.replace(/{([^{}]+)}/g,(M,F)=>F in E?String(E[F]):"")}(d.properties,_)}createBucket(s){return new Qd(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of wj.paint.overridableProperties){if(!z1.hasPaintOverride(this.layout,s))continue;const d=this.paint.get(s),f=new UO(d),y=new mm(f,d.property.specification);let _=null;_=d.value.kind==="constant"||d.value.kind==="source"?new vy("source",y):new Nf("composite",y,d.value.zoomStops,d.value._interpolationType),this.paint._values[s]=new we(d.property,_,d.parameters)}}_handleOverridablePaintPropertyUpdate(s,d,f){return!(!this.layout||d.isDataDriven()||f.isDataDriven())&&z1.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,d){const f=s.get("text-field"),y=wj.paint.properties[d];let _=!1;const k=E=>{for(const N of E)if(y.overrides&&y.overrides.hasOverride(N))return void(_=!0)};if(f.value.kind==="constant"&&f.value.value instanceof _a)k(f.value.value.sections);else if(f.value.kind==="source"){const E=M=>{_||(M instanceof Lo&&Fn(M.value)===yc?k(M.value.sections):M instanceof cn?k(M.sections):M.eachChild(E))},N=f.value;N._styleExpression&&E(N._styleExpression.expression)}return _}getProgramConfiguration(s){return new Kd(this,s)}}var tee={paint:new Ie({"background-color":new he(lt.paint_background["background-color"]),"background-pattern":new he(lt.paint_background["background-pattern"]),"background-opacity":new he(lt.paint_background["background-opacity"])})},ree={paint:new Ie({"raster-opacity":new he(lt.paint_raster["raster-opacity"]),"raster-hue-rotate":new he(lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new he(lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new he(lt.paint_raster["raster-brightness-max"]),"raster-saturation":new he(lt.paint_raster["raster-saturation"]),"raster-contrast":new he(lt.paint_raster["raster-contrast"]),"raster-resampling":new he(lt.paint_raster["raster-resampling"]),"raster-fade-duration":new he(lt.paint_raster["raster-fade-duration"])})};class nee extends Dl{constructor(s){super(s,{}),this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}var iee={paint:new Ie({"sky-type":new he(lt.paint_sky["sky-type"]),"sky-atmosphere-sun":new he(lt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new he(lt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new he(lt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new he(lt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Pe(lt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new he(lt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new he(lt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new he(lt.paint_sky["sky-opacity"])})};function kj(c,s,d){const f=[0,0,1],y=lD([]);return uD(y,y,d?-ce(c)+Math.PI:ce(c)),cD(y,y,-ce(s)),iD(f,f,y),Za(f,f)}const aee={circle:class extends Dl{constructor(c){super(c,gJ)}createBucket(c){return new ZE(c)}queryRadius(c){const s=c;return Pm("circle-radius",this,s)+Pm("circle-stroke-width",this,s)+p1(this.paint.get("circle-translate"))}queryIntersectsFeature(c,s,d,f,y,_,k,E){const N=ID(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(s,d)+this.paint.get("circle-stroke-width").evaluate(s,d);return MD(c,f,_,k,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",N,M)}getProgramIds(){return["circle"]}getProgramConfiguration(c){return new Kd(this,c)}},heatmap:class extends Dl{createBucket(c){return new OD(c)}constructor(c){super(c,_J),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=QE({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Pm("heatmap-radius",this,c)}queryIntersectsFeature(c,s,d,f,y,_,k,E){const N=this.paint.get("heatmap-radius").evaluate(s,d);return MD(c,f,_,k,E,!0,!0,new V(0,0),N)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(c){return new Kd(this,c)}},hillshade:class extends Dl{constructor(c){super(c,bJ)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Dl{constructor(c){super(c,LJ)}getProgramIds(){const c=this.paint.get("fill-pattern"),s=c&&c.constantOr(1),d=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&d.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),d}getProgramConfiguration(c){return new Kd(this,c)}recalculate(c,s){super.recalculate(c,s);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new v1(c)}queryRadius(){return p1(this.paint.get("fill-translate"))}queryIntersectsFeature(c,s,d,f,y,_){return!c.queryGeometry.isAboveHorizon&&jD(PD(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends Dl{constructor(c){super(c,QJ)}createBucket(c){return new ex(c)}queryRadius(){return p1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(c){return new Kd(this,c)}queryIntersectsFeature(c,s,d,f,y,_,k,E,N){const M=ID(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),F=this.paint.get("fill-extrusion-height").evaluate(s,d),q=this.paint.get("fill-extrusion-base").evaluate(s,d),X=[0,0],te=E&&_.elevation,ie=_.elevation?_.elevation.exaggeration():1,fe=c.tile.getBucket(this);if(te&&fe instanceof ex){const Oe=fe.centroidVertexArray,Be=N+1;Be<Oe.length&&(X[0]=Oe.geta_centroid_pos0(Be),X[1]=Oe.geta_centroid_pos1(Be))}if(X[0]===0&&X[1]===1)return!1;_.projection.name==="globe"&&(f=QD([f],[new V(0,0),new V(cr,cr)],c.tileID.canonical).map(Oe=>Oe.polygon).flat());const ge=te?E:null,[je,Re]=function(Oe,Be,Fe,nt,Qe,dt,Nt,st,yt,xt,kt){return Oe.projection.name==="globe"?function(Ot,ct,Ut,er,Wt,br,Rt,sr,wr,Zr,kr){const hr=[],An=[],Er=Ot.projection.upVectorScale(kr,Ot.center.lat,Ot.worldSize).metersToTile,jr=[0,0,0,1],xn=[0,0,0,1],Tn=(vn,Bn,Qn,bi)=>{vn[0]=Bn,vn[1]=Qn,vn[2]=bi,vn[3]=1},Sn=JD();Ut>0&&(Ut+=Sn),er+=Sn;for(const vn of ct){const Bn=[],Qn=[];for(const bi of vn){const _n=bi.x+Wt.x,Mi=bi.y+Wt.y,wi=Ot.projection.projectTilePoint(_n,Mi,kr),Gn=Ot.projection.upVector(kr,bi.x,bi.y);let Yr=Ut,ki=er;if(Rt){const En=nO(_n,Mi,Ut,er,Rt,sr,wr,Zr);Yr+=En.base,ki+=En.top}Ut!==0?Tn(jr,wi.x+Gn[0]*Er*Yr,wi.y+Gn[1]*Er*Yr,wi.z+Gn[2]*Er*Yr):Tn(jr,wi.x,wi.y,wi.z),Tn(xn,wi.x+Gn[0]*Er*ki,wi.y+Gn[1]*Er*ki,wi.z+Gn[2]*Er*ki),ui(jr,jr,br),ui(xn,xn,br),Bn.push(new Dm(jr[0],jr[1],jr[2])),Qn.push(new Dm(xn[0],xn[1],xn[2]))}hr.push(Bn),An.push(Qn)}return[hr,An]}(Oe,Be,Fe,nt,Qe,dt,Nt,st,yt,xt,kt):Nt?function(Ot,ct,Ut,er,Wt,br,Rt,sr,wr){const Zr=[],kr=[],hr=[0,0,0,1];for(const An of Ot){const Er=[],jr=[];for(const xn of An){const Tn=xn.x+er.x,Sn=xn.y+er.y,vn=nO(Tn,Sn,ct,Ut,br,Rt,sr,wr);hr[0]=Tn,hr[1]=Sn,hr[2]=vn.base,hr[3]=1,Bf(hr,hr,Wt),hr[3]=Math.max(hr[3],1e-5);const Bn=new Dm(hr[0]/hr[3],hr[1]/hr[3],hr[2]/hr[3]);hr[0]=Tn,hr[1]=Sn,hr[2]=vn.top,hr[3]=1,Bf(hr,hr,Wt),hr[3]=Math.max(hr[3],1e-5);const Qn=new Dm(hr[0]/hr[3],hr[1]/hr[3],hr[2]/hr[3]);Er.push(Bn),jr.push(Qn)}Zr.push(Er),kr.push(jr)}return[Zr,kr]}(Be,Fe,nt,Qe,dt,Nt,st,yt,xt):function(Ot,ct,Ut,er,Wt){const br=[],Rt=[],sr=Wt[8]*ct,wr=Wt[9]*ct,Zr=Wt[10]*ct,kr=Wt[11]*ct,hr=Wt[8]*Ut,An=Wt[9]*Ut,Er=Wt[10]*Ut,jr=Wt[11]*Ut;for(const xn of Ot){const Tn=[],Sn=[];for(const vn of xn){const Bn=vn.x+er.x,Qn=vn.y+er.y,bi=Wt[0]*Bn+Wt[4]*Qn+Wt[12],_n=Wt[1]*Bn+Wt[5]*Qn+Wt[13],Mi=Wt[2]*Bn+Wt[6]*Qn+Wt[14],wi=Wt[3]*Bn+Wt[7]*Qn+Wt[15],Gn=bi+sr,Yr=_n+wr,ki=Mi+Zr,En=Math.max(wi+kr,1e-5),Ja=bi+hr,Ti=_n+An,ca=Mi+Er,Zi=Math.max(wi+jr,1e-5);Tn.push(new Dm(Gn/En,Yr/En,ki/En)),Sn.push(new Dm(Ja/Zi,Ti/Zi,ca/Zi))}br.push(Tn),Rt.push(Sn)}return[br,Rt]}(Be,Fe,nt,Qe,dt)}(_,f,q,F,M,k,ge,X,ie,_.center.lat,c.tileID.canonical),Ae=c.queryGeometry;return function(Oe,Be,Fe){let nt=1/0;jD(Fe,Be)&&(nt=rO(Fe,Be[0]));for(let Qe=0;Qe<Be.length;Qe++){const dt=Be[Qe],Nt=Oe[Qe];for(let st=0;st<dt.length-1;st++){const yt=dt[st],xt=[yt,dt[st+1],Nt[st+1],Nt[st],yt];ED(Fe,xt)&&(nt=Math.min(nt,rO(Fe,xt)))}}return nt!==1/0&&nt}(je,Re,Ae.isPointQuery()?Ae.screenBounds:Ae.screenGeometry)}},line:class extends Dl{constructor(c){super(c,iO),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof C,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,s){super.recalculate(c,s),this.paint._values["line-floorwidth"]=aO.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new T1(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(c){return new Kd(this,c)}queryRadius(c){const s=c,d=sO(Pm("line-width",this,s),Pm("line-gap-width",this,s)),f=Pm("line-offset",this,s);return d/2+Math.abs(f)+p1(this.paint.get("line-translate"))}queryIntersectsFeature(c,s,d,f,y,_){if(c.queryGeometry.isAboveHorizon)return!1;const k=PD(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),E=c.pixelToTileUnitsFactor/2*sO(this.paint.get("line-width").evaluate(s,d),this.paint.get("line-gap-width").evaluate(s,d)),N=this.paint.get("line-offset").evaluate(s,d);return N&&(f=function(M,F){const q=[],X=new V(0,0);for(let te=0;te<M.length;te++){const ie=M[te],fe=[];for(let ge=0;ge<ie.length;ge++){const je=ie[ge],Re=ie[ge+1],Ae=ge===0?X:je.sub(ie[ge-1])._unit()._perp(),Oe=ge===ie.length-1?X:Re.sub(je)._unit()._perp(),Be=Ae._add(Oe)._unit();Be._mult(1/(Be.x*Oe.x+Be.y*Oe.y)),fe.push(Be._mult(F)._add(je))}q.push(fe)}return q}(f,N*c.pixelToTileUnitsFactor)),function(M,F,q){for(let X=0;X<F.length;X++){const te=F[X];if(M.length>=3){for(let ie=0;ie<te.length;ie++)if(Gf(M,te[ie]))return!0}if(hJ(M,te,q))return!0}return!1}(k,f,E)}isTileClipped(){return!0}},symbol:z1,background:class extends Dl{constructor(c){super(c,tee)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Dl{constructor(c){super(c,ree)}getProgramIds(){return["raster"]}},sky:class extends Dl{constructor(c){super(c,iee),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=QE({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(c,s){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),y=!f,_=c.style.light,k=_.properties.get("position");return y&&_.properties.get("anchor")==="viewport"&&Lt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),y?kj(k.azimuthal,90-k.polar,s):kj(f[0],90-f[1],s)}const d=this.paint.get("sky-gradient-center");return kj(d[0],90-d[1],s)}is3D(){return!1}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}}};class dx{constructor(s,d,f,y){this.context=s,this.format=f,this.texture=s.gl.createTexture(),this.update(d,y)}update(s,d,f){const{width:y,height:_}=s,{context:k}=this,{gl:E}=k,{HTMLImageElement:N,HTMLCanvasElement:M,HTMLVideoElement:F,ImageData:q,ImageBitmap:X}=p;if(E.bindTexture(E.TEXTURE_2D,this.texture),k.pixelStoreUnpackFlipY.set(!1),k.pixelStoreUnpack.set(1),k.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!d||d.premultiply!==!1)),f||this.size&&this.size[0]===y&&this.size[1]===_){const{x:te,y:ie}=f||{x:0,y:0};s instanceof N||s instanceof M||s instanceof F||s instanceof q||X&&s instanceof X?E.texSubImage2D(E.TEXTURE_2D,0,te,ie,E.RGBA,E.UNSIGNED_BYTE,s):E.texSubImage2D(E.TEXTURE_2D,0,te,ie,y,_,E.RGBA,E.UNSIGNED_BYTE,s.data)}else this.size=[y,_],s instanceof N||s instanceof M||s instanceof F||s instanceof q||X&&s instanceof X?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,s):E.texImage2D(E.TEXTURE_2D,0,this.format,y,_,0,this.format,E.UNSIGNED_BYTE,s.data);this.useMipmap=!!(d&&d.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&E.generateMipmap(E.TEXTURE_2D)}bind(s,d){const{context:f}=this,{gl:y}=f;y.bindTexture(y.TEXTURE_2D,this.texture),s!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,s),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap?s===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_NEAREST:s),this.filter=s),d!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,d),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class see{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class oee{constructor(){this.tasks={},this.taskQueue=[],gt(["process"],this),this.invoker=new see(this.process),this.nextId=0}add(s,d){const f=this.nextId++,y=function({type:_,isSymbolTile:k,zoom:E}){return E=E||0,_==="message"?0:_!=="maybePrepare"||k?_!=="parseTile"||k?_==="parseTile"&&k?300-E:_==="maybePrepare"&&k?400-E:500:200-E:100-E}(d);if(y===0){qr();try{s()}finally{}return{cancel:()=>{}}}return this.tasks[f]={fn:s,metadata:d,priority:y,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){qr();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const s=this.pick();if(s===null)return;const d=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!d)return;d.fn()}finally{}}pick(){let s=null,d=1/0;for(let y=0;y<this.taskQueue.length;y++){const _=this.tasks[this.taskQueue[y]];_.priority<d&&(d=_.priority,s=y)}if(s===null)return null;const f=this.taskQueue[s];return this.taskQueue.splice(s,1),f}remove(){this.invoker.remove()}}class qO{constructor(s){this._stringToNumber={},this._numberToString=[];for(let d=0;d<s.length;d++){const f=s[d];this._stringToNumber[f]=d,this._numberToString[d]=f}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const lee=["tile","layer","source","sourceLayer","state"];class GO{constructor(s,d,f,y,_){this.type="Feature",this._vectorTileFeature=s,this._z=d,this._x=f,this._y=y,this.properties=s.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(s.id=this.id);for(const d of lee)this[d]!==void 0&&(s[d]=this[d]);return s}}const Zo=32,Pc=33,eh=new Uint16Array(8184);for(let c=0;c<2046;c++){let s=c+2,d=0,f=0,y=0,_=0,k=0,E=0;for(1&s?y=_=k=Zo:d=f=E=Zo;(s>>=1)>1;){const M=d+y>>1,F=f+_>>1;1&s?(y=d,_=f,d=k,f=E):(d=y,f=_,y=k,_=E),k=M,E=F}const N=4*c;eh[N+0]=d,eh[N+1]=f,eh[N+2]=y,eh[N+3]=_}const Ic=new Uint16Array(2178),th=new Uint8Array(1089),$1=new Uint16Array(1089);function WO(c){return c===0?-.03125:c===32?.03125:0}var HO=He([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const KO={type:2,extent:cr,loadGeometry:()=>[[new V(0,0),new V(cr+1,0),new V(cr+1,cr+1),new V(0,cr+1),new V(0,0)]]};class Tj{constructor(s,d,f,y,_){this.tileID=s,this.uid=Me(),this.uses=0,this.tileSize=d,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",y&&y.transform&&(this.projection=y.transform.projection)}registerFadeDuration(s){const d=s+this.timeAdded;d<Rs.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Hf(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,d,f){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(y,_){const k={};if(!_)return k;for(const E of y){const N=E.layerIds.map(M=>_.getLayer(M)).filter(Boolean);if(N.length!==0){E.layers=N,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(M=>N.filter(F=>F.id===M)[0]));for(const M of N)k[M.id]=E}}return k}(s.buckets,d.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const _=this.buckets[y];if(_ instanceof Qd){if(this.hasSymbolBuckets=!0,!f)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const _=this.buckets[y];if(_ instanceof Qd&&_.hasRTLText){this.hasRTLText=!0,z.isLoading()||z.isLoaded()||j()!=="deferred"||R();break}}this.queryPadding=0;for(const y in this.buckets){const _=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(y).queryRadius(_))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas)}else this.collisionBoxArray=new gn}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(s){return this.buckets[s.id]}upload(s){for(const f in this.buckets){const y=this.buckets[f];y.uploadPending()&&y.upload(s)}const d=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new dx(s,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new dx(s,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new dx(s,this.lineAtlas.image,d.ALPHA),this.lineAtlas.uploaded=!0)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,d,f,y,_,k,E,N){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:y,pixelPosMatrix:E,transform:k,params:_,tileTransform:this.tileTransform},s,d,f):{}}querySourceFeatures(s,d){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const y=f.loadVTLayers(),_=d?d.sourceLayer:"",k=y._geojsonTileLayer||y[_];if(!k)return;const E=vm(d&&d.filter),{z:N,x:M,y:F}=this.tileID.canonical,q={z:N,x:M,y:F};for(let X=0;X<k.length;X++){const te=k.feature(X);if(E.needGeometry){const ge=qf(te,!0);if(!E.filter(new U(this.tileID.overscaledZ),ge,this.tileID.canonical))continue}else if(!E.filter(new U(this.tileID.overscaledZ),te))continue;const ie=f.getId(te,_),fe=new GO(te,N,M,F,ie);fe.tile=q,s.push(fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const d=this.expirationTime;if(s.cacheControl){const f=ln(s.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const f=Date.now();let y=!1;if(this.expirationTime>f)y=!1;else if(d)if(this.expirationTime<d)y=!0;else{const _=this.expirationTime-d;_?this.expirationTime=f+Math.max(_,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0||!d)return;const f=this.latestFeatureIndex.loadVTLayers(),y=d.style.listImages();for(const _ in this.buckets){if(!d.style.hasLayer(_))continue;const k=this.buckets[_],E=k.layers[0].sourceLayer||"_geojsonTileLayer",N=f[E],M=s[E];if(!N||!M||Object.keys(M).length===0)continue;if(k.update(M,N,y,this.imageAtlas&&this.imageAtlas.patternPositions||{}),k instanceof T1||k instanceof v1){const q=d.style._getSourceCache(k.layers[0].source);d._terrain&&d._terrain.enabled&&q&&k.programConfigurations.needsUpload&&d._terrain._clearRenderCacheForTile(q.id,this.tileID)}const F=d&&d.style&&d.style.getLayer(_);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(k)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Rs.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=Rs.now()+s}setTexture(s,d){const f=d.context,y=f.gl;this.texture=this.texture||d.getTileTexture(s.width),this.texture?this.texture.update(s,{useMipmap:!0}):(this.texture=new dx(f,s,y.RGBA,{useMipmap:!0}),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE))}setDependencies(s,d){const f={};for(const y of d)f[y]=!0;this.dependencies[s]=f}hasDependency(s,d){for(const f of s){const y=this.dependencies[f];if(y){for(const _ of d)if(y[_])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,d){if(!d||d.name==="mercator"||this._tileDebugBuffer)return;const f=Ou(KO,this.tileID.canonical,this.tileTransform)[0],y=new At,_=new Bs;for(let k=0;k<f.length;k++){const{x:E,y:N}=f[k];y.emplaceBack(E,N),_.emplaceBack(k)}_.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(_),this._tileDebugBuffer=s.createVertexBuffer(y,Uy.members),this._tileDebugSegments=vi.simpleSegment(0,0,y.length,_.length)}_makeTileBoundsBuffers(s,d){if(this._tileBoundsBuffer||!d||d.name==="mercator")return;const f=Ou(KO,this.tileID.canonical,this.tileTransform)[0];let y,_;if(this.isRaster){const k=function(E,N){const M=Hf(E,N),F=Math.pow(2,E.z);for(let ge=0;ge<Pc;ge++)for(let je=0;je<Pc;je++){const Re=yo((E.x+(je+WO(je))/Zo)/F),Ae=ka((E.y+(ge+WO(ge))/Zo)/F),Oe=N.project(Re,Ae),Be=ge*Pc+je;Ic[2*Be+0]=Math.round((Oe.x*M.scale-M.x)*cr),Ic[2*Be+1]=Math.round((Oe.y*M.scale-M.y)*cr)}th.fill(0),$1.fill(0);for(let ge=2045;ge>=0;ge--){const je=4*ge,Re=eh[je+0],Ae=eh[je+1],Oe=eh[je+2],Be=eh[je+3],Fe=Re+Oe>>1,nt=Ae+Be>>1,Qe=Fe+nt-Ae,dt=nt+Re-Fe,Nt=Ae*Pc+Re,st=Be*Pc+Oe,yt=nt*Pc+Fe,xt=Math.hypot((Ic[2*Nt+0]+Ic[2*st+0])/2-Ic[2*yt+0],(Ic[2*Nt+1]+Ic[2*st+1])/2-Ic[2*yt+1])>=16;th[yt]=th[yt]||(xt?1:0),ge<1022&&(th[yt]=th[yt]||th[(Ae+dt>>1)*Pc+(Re+Qe>>1)]||th[(Be+dt>>1)*Pc+(Oe+Qe>>1)])}const q=new pt,X=new rr;let te=0;function ie(ge,je){const Re=je*Pc+ge;return $1[Re]===0&&(q.emplaceBack(Ic[2*Re+0],Ic[2*Re+1],ge*cr/Zo,je*cr/Zo),$1[Re]=++te),$1[Re]-1}function fe(ge,je,Re,Ae,Oe,Be){const Fe=ge+Re>>1,nt=je+Ae>>1;if(Math.abs(ge-Oe)+Math.abs(je-Be)>1&&th[nt*Pc+Fe])fe(Oe,Be,ge,je,Fe,nt),fe(Re,Ae,Oe,Be,Fe,nt);else{const Qe=ie(ge,je),dt=ie(Re,Ae),Nt=ie(Oe,Be);X.emplaceBack(Qe,dt,Nt)}}return fe(0,0,Zo,Zo,Zo,0),fe(Zo,Zo,0,0,0,Zo),{vertices:q,indices:X}}(this.tileID.canonical,d);y=k.vertices,_=k.indices}else{y=new pt,_=new rr;for(const{x:E,y:N}of f)y.emplaceBack(E,N,0,0);const k=ij(y.int16,void 0,4);for(let E=0;E<k.length;E+=3)_.emplaceBack(k[E],k[E+1],k[E+2])}this._tileBoundsBuffer=s.createVertexBuffer(y,HO.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(_),this._tileBoundsSegments=vi.simpleSegment(0,0,y.length,_.length)}_makeGlobeTileDebugBuffers(s,d){const f=d.projection;if(!f||f.name!=="globe"||d.freezeTileCoverage)return;const y=this.tileID.canonical,_=Wy(mD(y,d)),k=Nm(d.zoom);let E;k>0&&(E=IE(new Float64Array(16),d.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,y,d,_,E,k),this._makeGlobeTileDebugTextBuffer(s,y,d,_,E,k)}_globePoint(s,d,f,y,_,k,E){let N=Gy(s,d,f);if(k){const M=1<<f.z,F=Nc(y.center.lng),q=Cc(y.center.lat),X=(f.x+.5)/M-F;let te=0;X>.5?te=-1:X<-.5&&(te=1);let ie=(s/cr+f.x)/M+te,fe=(d/cr+f.y)/M;ie=(ie-F)*y._pixelsPerMercatorPixel+F,fe=(fe-q)*y._pixelsPerMercatorPixel+q;const ge=[ie*y.worldSize,fe*y.worldSize,0];ui(ge,ge,k),N=Uf(N,ge,E)}return ui(N,N,_)}_makeGlobeTileDebugBorderBuffer(s,d,f,y,_,k){const E=new At,N=new Bs,M=new Je,F=(X,te,ie,fe,ge)=>{const je=(ie-X)/(ge-1),Re=(fe-te)/(ge-1),Ae=E.length;for(let Oe=0;Oe<ge;Oe++){const Be=X+Oe*je,Fe=te+Oe*Re;E.emplaceBack(Be,Fe);const nt=this._globePoint(Be,Fe,d,f,y,_,k);M.emplaceBack(nt[0],nt[1],nt[2]),N.emplaceBack(Ae+Oe)}},q=cr;F(0,0,q,0,16),F(q,0,q,q,16),F(q,q,0,q,16),F(0,q,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(N),this._tileDebugBuffer=s.createVertexBuffer(E,Uy.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(M,hD.members),this._tileDebugSegments=vi.simpleSegment(0,0,E.length,N.length)}_makeGlobeTileDebugTextBuffer(s,d,f,y,_,k){const E=cr/4,N=new At,M=new rr,F=new Je,q=25;M.reserve(32),N.reserve(q),F.reserve(q);const X=(te,ie)=>q*te+ie;for(let te=0;te<q;te++){const ie=te*E;for(let fe=0;fe<q;fe++){const ge=fe*E;N.emplaceBack(ge,ie);const je=this._globePoint(ge,ie,d,f,y,_,k);F.emplaceBack(je[0],je[1],je[2])}}for(let te=0;te<4;te++)for(let ie=0;ie<4;ie++){const fe=X(te,ie),ge=X(te,ie+1),je=X(te+1,ie),Re=X(te+1,ie+1);M.emplaceBack(fe,ge,je),M.emplaceBack(je,ge,Re)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(M),this._tileDebugTextBuffer=s.createVertexBuffer(N,Uy.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(F,hD.members),this._tileDebugTextSegments=vi.simpleSegment(0,0,q,32)}}class cee{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,d,f){const y=String(d);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][y]=this.stateChanges[s][y]||{},Ye(this.stateChanges[s][y],f),this.deletedStates[s]===null){this.deletedStates[s]={};for(const _ in this.state[s])_!==y&&(this.deletedStates[s][_]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][y]===null){this.deletedStates[s][y]={};for(const _ in this.state[s][y])f[_]||(this.deletedStates[s][y][_]=null)}else for(const _ in f)this.deletedStates[s]&&this.deletedStates[s][y]&&this.deletedStates[s][y][_]===null&&delete this.deletedStates[s][y][_]}removeFeatureState(s,d,f){if(this.deletedStates[s]===null)return;const y=String(d);if(this.deletedStates[s]=this.deletedStates[s]||{},f&&d!==void 0)this.deletedStates[s][y]!==null&&(this.deletedStates[s][y]=this.deletedStates[s][y]||{},this.deletedStates[s][y][f]=null);else if(d!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][y])for(f in this.deletedStates[s][y]={},this.stateChanges[s][y])this.deletedStates[s][y][f]=null;else this.deletedStates[s][y]=null;else this.deletedStates[s]=null}getState(s,d){const f=String(d),y=Ye({},(this.state[s]||{})[f],(this.stateChanges[s]||{})[f]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const _=this.deletedStates[s][d];if(_===null)return{};for(const k in _)delete y[k]}return y}initializeTileState(s,d){s.setFeatureState(this.state,d)}coalesceChanges(s,d){const f={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const _={};for(const k in this.stateChanges[y])this.state[y][k]||(this.state[y][k]={}),Ye(this.state[y][k],this.stateChanges[y][k]),_[k]=this.state[y][k];f[y]=_}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const _={};if(this.deletedStates[y]===null)for(const k in this.state[y])_[k]={},this.state[y][k]={};else for(const k in this.deletedStates[y]){if(this.deletedStates[y][k]===null)this.state[y][k]={};else if(this.state[y][k])for(const E of Object.keys(this.deletedStates[y][k]))delete this.state[y][k][E];_[k]=this.state[y][k]}f[y]=f[y]||{},Ye(f[y],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const y in s)s[y].setFeatureState(f,d)}}class ZO{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,d){const f=this.toIdx(s,d);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(s,d){return this.leaves[this.toIdx(s,d)]}toIdx(s,d){return d*this.size+s}}function XO(c,s,d,f){let y=0,_=Number.MAX_VALUE;for(let k=0;k<3;k++)if(Math.abs(f[k])<1e-15){if(d[k]<c[k]||d[k]>s[k])return null}else{const E=1/f[k];let N=(c[k]-d[k])*E,M=(s[k]-d[k])*E;if(N>M){const F=N;N=M,M=F}if(N>y&&(y=N),M<_&&(_=M),y>_)return null}return y}function YO(c,s,d,f,y,_,k,E,N,M,F){const q=f-c,X=y-s,te=_-d,ie=k-c,fe=E-s,ge=N-d,je=F[1]*ge-F[2]*fe,Re=F[2]*ie-F[0]*ge,Ae=F[0]*fe-F[1]*ie,Oe=q*je+X*Re+te*Ae;if(Math.abs(Oe)<1e-15)return null;const Be=1/Oe,Fe=M[0]-c,nt=M[1]-s,Qe=M[2]-d,dt=(Fe*je+nt*Re+Qe*Ae)*Be;if(dt<0||dt>1)return null;const Nt=nt*te-Qe*X,st=Qe*q-Fe*te,yt=Fe*X-nt*q,xt=(F[0]*Nt+F[1]*st+F[2]*yt)*Be;return xt<0||dt+xt>1?null:(ie*Nt+fe*st+ge*yt)*Be}function JO(c,s,d){return(c-s)/(d-s)}function QO(c,s,d,f,y,_,k,E,N){const M=1<<d,F=_-f,q=k-y,X=(c+1)/M*F+f,te=(s+0)/M*q+y,ie=(s+1)/M*q+y;E[0]=(c+0)/M*F+f,E[1]=te,N[0]=X,N[1]=ie}class eR{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const d=function(_){const k=Math.ceil(Math.log2(_.dim/8)),E=[];let N=Math.ceil(Math.pow(2,k));const M=1/N,F=(te,ie,fe,ge,je)=>{const Re=ge?1:0,Ae=(te+1)*fe-Re,Oe=ie*fe,Be=(ie+1)*fe-Re;je[0]=te*fe,je[1]=Oe,je[2]=Ae,je[3]=Be};let q=new ZO(N);const X=[];for(let te=0;te<N*N;te++){F(te%N,Math.floor(te/N),M,!1,X);const ie=rh(X[0],X[1],_),fe=rh(X[2],X[1],_),ge=rh(X[2],X[3],_),je=rh(X[0],X[3],_);q.minimums.push(Math.min(ie,fe,ge,je)),q.maximums.push(Math.max(ie,fe,ge,je)),q.leaves.push(1)}for(E.push(q),N/=2;N>=1;N/=2){const te=E[E.length-1];q=new ZO(N);for(let ie=0;ie<N*N;ie++){F(ie%N,Math.floor(ie/N),2,!0,X);const fe=te.getElevation(X[0],X[1]),ge=te.getElevation(X[2],X[1]),je=te.getElevation(X[2],X[3]),Re=te.getElevation(X[0],X[3]),Ae=te.isLeaf(X[0],X[1]),Oe=te.isLeaf(X[2],X[1]),Be=te.isLeaf(X[2],X[3]),Fe=te.isLeaf(X[0],X[3]),nt=Math.min(fe.min,ge.min,je.min,Re.min),Qe=Math.max(fe.max,ge.max,je.max,Re.max),dt=Ae&&Oe&&Be&&Fe;q.maximums.push(Qe),q.minimums.push(nt),q.leaves.push(Qe-nt<=5&&dt?1:0)}E.push(q)}return E}(this.dem),f=d.length-1,y=d[f];this._addNode(y.minimums[0],y.maximums[0],y.leaves[0]),this._construct(d,0,0,f,0)}raycastRoot(s,d,f,y,_,k,E=1){return XO([s,d,-100],[f,y,this.maximums[0]*E],_,k)}raycast(s,d,f,y,_,k,E=1){if(!this.nodeCount)return null;const N=this.raycastRoot(s,d,f,y,_,k,E);if(N==null)return null;const M=[],F=[],q=[],X=[],te=[{idx:0,t:N,nodex:0,nodey:0,depth:0}];for(;te.length>0;){const{idx:ie,t:fe,nodex:ge,nodey:je,depth:Re}=te.pop();if(this.leaves[ie]){QO(ge,je,Re,s,d,f,y,q,X);const Oe=1<<Re,Be=(ge+0)/Oe,Fe=(ge+1)/Oe,nt=(je+0)/Oe,Qe=(je+1)/Oe,dt=rh(Be,nt,this.dem)*E,Nt=rh(Fe,nt,this.dem)*E,st=rh(Fe,Qe,this.dem)*E,yt=rh(Be,Qe,this.dem)*E,xt=YO(q[0],q[1],dt,X[0],q[1],Nt,X[0],X[1],st,_,k),kt=YO(X[0],X[1],st,q[0],X[1],yt,q[0],q[1],dt,_,k),Ot=Math.min(xt!==null?xt:Number.MAX_VALUE,kt!==null?kt:Number.MAX_VALUE);if(Ot!==Number.MAX_VALUE)return Ot;{const ct=By([],_,k,fe);if(tR(dt,Nt,yt,st,JO(ct[0],q[0],X[0]),JO(ct[1],q[1],X[1]))>=ct[2])return fe}continue}let Ae=0;for(let Oe=0;Oe<this._siblingOffset.length;Oe++){QO((ge<<1)+this._siblingOffset[Oe][0],(je<<1)+this._siblingOffset[Oe][1],Re+1,s,d,f,y,q,X),q[2]=-100,X[2]=this.maximums[this.childOffsets[ie]+Oe]*E;const Be=XO(q,X,_,k);if(Be!=null){const Fe=Be;M[Oe]=Fe;let nt=!1;for(let Qe=0;Qe<Ae&&!nt;Qe++)Fe>=M[F[Qe]]&&(F.splice(Qe,0,Oe),nt=!0);nt||(F[Ae]=Oe),Ae++}}for(let Oe=0;Oe<Ae;Oe++){const Be=F[Oe];te.push({idx:this.childOffsets[ie]+Be,t:M[Be],nodex:(ge<<1)+this._siblingOffset[Be][0],nodey:(je<<1)+this._siblingOffset[Be][1],depth:Re+1})}}return null}_addNode(s,d,f){return this.minimums.push(s),this.maximums.push(d),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(s,d,f,y,_){if(s[y].isLeaf(d,f)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const k=y-1,E=s[k];let N=0,M=0;for(let F=0;F<this._siblingOffset.length;F++){const q=2*d+this._siblingOffset[F][0],X=2*f+this._siblingOffset[F][1],te=E.getElevation(q,X),ie=E.isLeaf(q,X),fe=this._addNode(te.min,te.max,ie);ie&&(N|=1<<F),M||(M=fe)}for(let F=0;F<this._siblingOffset.length;F++)N&1<<F||this._construct(s,2*d+this._siblingOffset[F][0],2*f+this._siblingOffset[F][1],k,M+F)}}function tR(c,s,d,f,y,_){return Z(Z(c,d,_),Z(s,f,_),y)}function rh(c,s,d){const f=d.dim,y=ye(c*f-.5,0,f-1),_=ye(s*f-.5,0,f-1),k=Math.floor(y),E=Math.floor(_),N=Math.min(k+1,f-1),M=Math.min(E+1,f-1);return tR(d.get(k,E),d.get(N,E),d.get(k,M),d.get(N,M),y-k,_-E)}const rR={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function uee(c,s,d){return(256*c*256+256*s+d)/10-1e4}function dee(c,s,d){return 256*c+s+d/256-32768}class F1{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,d,f,y=!1,_=!1){if(this.uid=s,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return Lt(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=d.height;const k=this.dim=d.height-2,E=new Uint32Array(d.data.buffer);if(this.pixels=new Uint8Array(d.data.buffer),this.encoding=f||"mapbox",this.borderReady=y,!y){for(let N=0;N<k;N++)E[this._idx(-1,N)]=E[this._idx(0,N)],E[this._idx(k,N)]=E[this._idx(k-1,N)],E[this._idx(N,-1)]=E[this._idx(N,0)],E[this._idx(N,k)]=E[this._idx(N,k-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(k,-1)]=E[this._idx(k-1,0)],E[this._idx(-1,k)]=E[this._idx(0,k-1)],E[this._idx(k,k)]=E[this._idx(k-1,k-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new eR(this)}get(s,d,f=!1){f&&(s=ye(s,-1,this.dim),d=ye(d,-1,this.dim));const y=4*this._idx(s,d);return(this.encoding==="terrarium"?dee:uee)(this.pixels[y],this.pixels[y+1],this.pixels[y+2])}static getUnpackVector(s){return rR[s]}get unpackVector(){return rR[this.encoding]}_idx(s,d){if(s<-1||s>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(s+1)}static pack(s,d){const f=[0,0,0,0],y=F1.getUnpackVector(d);let _=Math.floor((s+y[3])/y[2]);return f[2]=_%256,_=Math.floor(_/256),f[1]=_%256,_=Math.floor(_/256),f[0]=_,f}getPixels(){return new Us({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,d,f){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let y=d*this.dim,_=d*this.dim+this.dim,k=f*this.dim,E=f*this.dim+this.dim;switch(d){case-1:y=_-1;break;case 1:_=y+1}switch(f){case-1:k=E-1;break;case 1:E=k+1}const N=-d*this.dim,M=-f*this.dim;for(let F=k;F<E;F++)for(let q=y;q<_;q++){const X=4*this._idx(q,F),te=4*this._idx(q+N,F+M);this.pixels[X+0]=s.pixels[te+0],this.pixels[X+1]=s.pixels[te+1],this.pixels[X+2]=s.pixels[te+2],this.pixels[X+3]=s.pixels[te+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Xt(F1,"DEMData"),Xt(eR,"DemMinMaxQuadTree",{omit:["dem"]});class hee{constructor(s,d){this.max=s,this.onRemove=d,this.reset()}reset(){for(const s in this.data)for(const d of this.data[s])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(s,d,f){const y=s.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const _={value:d,timeout:void 0};if(f!==void 0&&(_.timeout=setTimeout(()=>{this.remove(s,_)},f)),this.data[y].push(_),this.order.push(y),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const d=this.data[s].shift();return d.timeout&&clearTimeout(d.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),d.value}getByKey(s){const d=this.data[s];return d?d[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,d){if(!this.has(s))return this;const f=s.wrapped().key,y=d===void 0?0:this.data[f].indexOf(d),_=this.data[f][y];return this.data[f].splice(y,1),_.timeout&&clearTimeout(_.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(_.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(s){const d=[];for(const f in this.data)for(const y of this.data[f])s(y.value)||d.push(y);for(const f of d)this.remove(f.value.tileID,f)}}class qm{constructor(s,d,f){this.func=s,this.mask=d,this.range=f}}qm.ReadOnly=!1,qm.ReadWrite=!0,qm.disabled=new qm(519,qm.ReadOnly,[0,1]);const Sj=7680;class Ej{constructor(s,d,f,y,_,k){this.test=s,this.ref=d,this.mask=f,this.fail=y,this.depthFail=_,this.pass=k}}Ej.disabled=new Ej({func:519,mask:0},0,0,Sj,Sj,Sj);class Mc{constructor(s,d,f){this.blendFunction=s,this.blendColor=d,this.mask=f}}Mc.Replace=[1,0],Mc.disabled=new Mc(Mc.Replace,$n.transparent,[!1,!1,!1,!1]),Mc.unblended=new Mc(Mc.Replace,$n.transparent,[!0,!0,!0,!0]),Mc.alphaBlended=new Mc([1,771],$n.transparent,[!0,!0,!0,!0]);const jj=1029,Aj=2305;class Fl{constructor(s,d,f){this.enable=s,this.mode=d,this.frontFace=f}}Fl.disabled=new Fl(!1,jj,Aj),Fl.backCCW=new Fl(!0,jj,Aj),Fl.backCW=new Fl(!0,jj,2304),Fl.frontCW=new Fl(!0,1028,2304),Fl.frontCCW=new Fl(!0,1028,Aj);class Kf extends yu{constructor(s,d,f){super(),this.id=s,this._onlySymbols=f,d.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),d.on("error",()=>{this._sourceErrored=!0}),this._source=d,this._tiles={},this._cache=new hee(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new cee,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const d=this._tiles[s];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,d){return s.isSymbolTile=this._onlySymbols,this._source.loadTile(s,d)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s,()=>{})}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const f=this._tiles[d];f.upload(s),f.prepare(this.map.style.imageManager)}}getIds(){return $e(this._tiles).map(s=>s.tileID).sort(nR).map(s=>s.key)}getRenderableIds(s){const d=[];for(const f in this._tiles)this._isIdRenderable(+f,s)&&d.push(this._tiles[f]);return s?d.sort((f,y)=>{const _=f.tileID,k=y.tileID,E=new V(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),N=new V(k.canonical.x,k.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-k.overscaledZ||N.y-E.y||N.x-E.x}).map(f=>f.tileID.key):d.map(f=>f.tileID).sort(nR).map(f=>f.key)}hasRenderableParent(s){const d=this.findLoadedParent(s,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(s,d){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(d||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,d){const f=this._tiles[s];f&&(f.state!=="loading"&&(f.state=d),this._loadTile(f,this._tileLoaded.bind(this,f,s,d)))}_tileLoaded(s,d,f,y){if(y)if(s.state="errored",y.status!==404)this._source.fire(new ys(y,{tile:s}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else s.timeAdded=Rs.now(),f==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(d,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new Ma("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const d=this.getRenderableIds();for(let y=0;y<d.length;y++){const _=d[y];if(s.neighboringTiles&&s.neighboringTiles[_]){const k=this.getTileByID(_);f(s,k),f(k,s)}}function f(y,_){if(!y.dem||y.dem.borderReady)return;y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0;let k=_.tileID.canonical.x-y.tileID.canonical.x;const E=_.tileID.canonical.y-y.tileID.canonical.y,N=Math.pow(2,y.tileID.canonical.z),M=_.tileID.key;k===0&&E===0||Math.abs(E)>1||(Math.abs(k)>1&&(Math.abs(k+N)===1?k+=N:Math.abs(k-N)===1&&(k-=N)),_.dem&&y.dem&&(y.dem.backfillBorder(_.dem,k,E),y.neighboringTiles&&y.neighboringTiles[M]&&(y.neighboringTiles[M].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,d,f,y){for(const _ in this._tiles){let k=this._tiles[_];if(y[_]||!k.hasData()||k.tileID.overscaledZ<=d||k.tileID.overscaledZ>f)continue;let E=k.tileID;for(;k&&k.tileID.overscaledZ>d+1;){const M=k.tileID.scaledTo(k.tileID.overscaledZ-1);k=this._tiles[M.key],k&&k.hasData()&&(E=M)}let N=E;for(;N.overscaledZ>d;)if(N=N.scaledTo(N.overscaledZ-1),s[N.key]){y[E.key]=E;break}}}findLoadedParent(s,d){if(s.key in this._loadedParentTiles){const f=this._loadedParentTiles[s.key];return f&&f.tileID.overscaledZ>=d?f:null}for(let f=s.overscaledZ-1;f>=d;f--){const y=s.scaledTo(f),_=this._getLoadedTile(y);if(_)return _}}_getLoadedTile(s){const d=this._tiles[s.key];return d&&d.hasData()?d:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,d){d=d||this._source.tileSize;const f=Math.ceil(s.width/d)+1,y=Math.ceil(s.height/d)+1,_=Math.floor(f*y*5),k=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,_):_,E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,k):k;this._cache.setMaxSize(E)}handleWrapJump(s){const d=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,d){const f={};for(const y in this._tiles){const _=this._tiles[y];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+d),f[_.tileID.key]=_}this._tiles=f;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(+y,this._tiles[y])}}update(s,d,f){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;let y;this.updateCacheSize(s,d),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?y=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new Ya(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(y=s.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(y=y.filter(E=>this._source.hasTile(E)))):y=[];const _=this._updateRetainedTiles(y);if(iR(this._source.type)&&y.length!==0){const E={},N={},M=Object.keys(_);for(const q of M){const X=_[q],te=this._tiles[q];if(!te||te.fadeEndTime&&te.fadeEndTime<=Rs.now())continue;const ie=this.findLoadedParent(X,Math.max(X.overscaledZ-Kf.maxOverzooming,this._source.minzoom));ie&&(this._addTile(ie.tileID),E[ie.tileID.key]=ie.tileID),N[q]=X}const F=y[y.length-1].overscaledZ;for(const q in this._tiles){const X=this._tiles[q];if(_[q]||!X.hasData())continue;let te=X.tileID;for(;te.overscaledZ>F;){te=te.scaledTo(te.overscaledZ-1);const ie=this._tiles[te.key];if(ie&&ie.hasData()&&N[te.key]){_[q]=X.tileID;break}}}for(const q in E)_[q]||(this._coveredTiles[q]=!0,_[q]=E[q])}for(const E in _)this._tiles[E].clearFadeHold();const k=function(E,N){const M=[];for(const F in E)F in N||M.push(F);return M}(this._tiles,_);for(const E of k){const N=this._tiles[E];N.hasSymbolBuckets&&!N.holdingForFade()?N.setHoldDuration(this.map._fadeDuration):N.hasSymbolBuckets&&!N.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const d={};if(s.length===0)return d;const f={},y=s.reduce((M,F)=>Math.min(M,F.overscaledZ),1/0),_=s[0].overscaledZ,k=Math.max(_-Kf.maxOverzooming,this._source.minzoom),E=Math.max(_+Kf.maxUnderzooming,this._source.minzoom),N={};for(const M of s){const F=this._addTile(M);d[M.key]=M,F.hasData()||y<this._source.maxzoom&&(N[M.key]=M)}this._retainLoadedChildren(N,y,E,d);for(const M of s){let F=this._tiles[M.key];if(F.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const X=M.children(this._source.maxzoom)[0],te=this.getTile(X);if(te&&te.hasData()){d[X.key]=X;continue}}else{const X=M.children(this._source.maxzoom);if(d[X[0].key]&&d[X[1].key]&&d[X[2].key]&&d[X[3].key])continue}let q=F.wasRequested();for(let X=M.overscaledZ-1;X>=k;--X){const te=M.scaledTo(X);if(f[te.key]||(f[te.key]=!0,F=this.getTile(te),!F&&q&&(F=this._addTile(te)),F&&(d[te.key]=te,q=F.wasRequested(),F.hasData())))break}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const d=[];let f,y=this._tiles[s].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){f=this._loadedParentTiles[y.key];break}d.push(y.key);const _=y.scaledTo(y.overscaledZ-1);if(f=this._getLoadedTile(_),f)break;y=_}for(const _ of d)this._loadedParentTiles[_]=f}}_addTile(s){let d=this._tiles[s.key];if(d)return d;d=this._cache.getAndRemove(s),d&&(this._setTileReloadTimer(s.key,d),d.tileID=s,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,d)));const f=!!d;if(!f){const y=this.map?this.map.painter:null;d=new Tj(s,this._source.tileSize*s.overscaleFactor(),this.transform.tileZoom,y,this._isRaster),this._loadTile(d,this._tileLoaded.bind(this,d,s.key,d.state))}return d?(d.uses++,this._tiles[s.key]=d,f||this._source.fire(new Ma("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d):null}_setTileReloadTimer(s,d){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const f=d.getExpiryTimeout();f&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},f))}_removeTile(s){const d=this._tiles[s];d&&(d.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,d,f){const y=[],_=this.transform;if(!_)return y;const k=_.projection.name==="globe",E=Nc(_.center.lng);for(const N in this._tiles){const M=this._tiles[N];if(f&&M.clearQueryDebugViz(),M.holdingForFade())continue;let F;if(k){const q=M.tileID.canonical;if(q.z===0){const X=[Math.abs(ye(E,...hx(q,-1))-E),Math.abs(ye(E,...hx(q,1))-E)];F=[0,2*X.indexOf(Math.min(...X))-1]}else{const X=[Math.abs(ye(E,...hx(q,-1))-E),Math.abs(ye(E,...hx(q,0))-E),Math.abs(ye(E,...hx(q,1))-E)];F=[X.indexOf(Math.min(...X))-1]}}else F=[0];for(const q of F){const X=s.containsTile(M,_,d,q);X&&y.push(X)}}return y}getVisibleCoordinates(s){const d=this.getRenderableIds(s).map(f=>this._tiles[f].tileID);for(const f of d)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(iR(this._source.type))for(const s in this._tiles){const d=this._tiles[s];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=Rs.now())return!0}return!1}setFeatureState(s,d,f){this._state.updateState(s=s||"_geojsonTileLayer",d,f)}removeFeatureState(s,d,f){this._state.removeFeatureState(s=s||"_geojsonTileLayer",d,f)}getFeatureState(s,d){return this._state.getState(s=s||"_geojsonTileLayer",d)}setDependencies(s,d,f){const y=this._tiles[s];y&&y.setDependencies(d,f)}reloadTilesForDependencies(s,d){for(const f in this._tiles)this._tiles[f].hasDependency(s,d)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(s,d))}_preloadTiles(s,d){if(!this._sourceLoaded){const E=()=>{this._sourceLoaded&&(this._source.off("data",E),this._preloadTiles(s,d))};return void this._source.on("data",E)}const f=new Map,y=Array.isArray(s)?s:[s],_=this.map.painter.terrain,k=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const E of y){const N=E.coveringTiles({tileSize:k,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of N)f.set(M.key,M);this.usedForTerrain&&E.updateElevation(!1)}Ce(Array.from(f.values()),(E,N)=>{const M=new Tj(E,this._source.tileSize*E.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,F=>{this._source.type==="raster-dem"&&M.dem&&this._backfillDEM(M),N(F,M)})},d)}}function nR(c,s){const d=Math.abs(2*c.wrap)-+(c.wrap<0),f=Math.abs(2*s.wrap)-+(s.wrap<0);return c.overscaledZ-s.overscaledZ||f-d||s.canonical.y-c.canonical.y||s.canonical.x-c.canonical.x}function iR(c){return c==="raster"||c==="image"||c==="video"||c==="custom"}function hx(c,s){const d=1<<c.z;return[c.x/d+s,(c.x+1)/d+s]}Kf.maxOverzooming=10,Kf.maxUnderzooming=3;class B1{constructor(s,d,f){this._demTile=s,this._dem=this._demTile.dem,this._scale=d,this._offset=f}static create(s,d,f){const y=f||s.findDEMTileFor(d);if(!y||!y.dem)return;const _=y.dem,k=y.tileID,E=1<<d.canonical.z-k.canonical.z;return new B1(y,y.tileSize/cr/E,[(d.canonical.x/E-k.canonical.x)*_.dim,(d.canonical.y/E-k.canonical.y)*_.dim])}tileCoordToPixel(s,d){const f=d*this._scale+this._offset[1],y=Math.floor(s*this._scale+this._offset[0]),_=Math.floor(f);return new V(y,_)}getElevationAt(s,d,f,y){const _=s*this._scale+this._offset[0],k=d*this._scale+this._offset[1],E=Math.floor(_),N=Math.floor(k),M=this._dem;return y=!!y,f?Z(Z(M.get(E,N,y),M.get(E,N+1,y),k-N),Z(M.get(E+1,N,y),M.get(E+1,N+1,y),k-N),_-E):M.get(E,N,y)}getElevationAtPixel(s,d,f){return this._dem.get(s,d,!!f)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Ll(1,s)*this._dem.stride}}class aR{constructor(s,d){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Au(cr,16,0),this.featureIndexArray=new Rf,this.promoteId=d}insert(s,d,f,y,_,k=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,y,_,k);const N=this.grid;for(let M=0;M<d.length;M++){const F=d[M],q=[1/0,1/0,-1/0,-1/0];for(let X=0;X<F.length;X++){const te=F[X];q[0]=Math.min(q[0],te.x),q[1]=Math.min(q[1],te.y),q[2]=Math.max(q[2],te.x),q[3]=Math.max(q[3],te.y)}q[0]<cr&&q[1]<cr&&q[2]>=0&&q[3]>=0&&N.insert(E,q[0],q[1],q[2],q[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new lj(new j1(this.rawTileData)).layers,this.sourceLayerCoder=new qO(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,d,f,y){this.loadVTLayers();const _=s.params||{},k=vm(_.filter),E=s.tileResult,N=s.transform,M=E.bufferedTilespaceBounds,F=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(ie,fe,ge,je)=>CD(E.bufferedTilespaceGeometry,ie,fe,ge,je));F.sort(fee);let q=null;N.elevation&&F.length>0&&(q=B1.create(N.elevation,this.tileID));const X={};let te;for(let ie=0;ie<F.length;ie++){const fe=F[ie];if(fe===te)continue;te=fe;const ge=this.featureIndexArray.get(fe);let je=null;this.loadMatchingFeature(X,ge,k,_.layers,_.availableImages,d,f,y,(Re,Ae,Oe,Be=0)=>(je||(je=Ou(Re,this.tileID.canonical,s.tileTransform)),Ae.queryIntersectsFeature(E,Re,Oe,je,this.z,s.transform,s.pixelPosMatrix,q,Be)))}return X}loadMatchingFeature(s,d,f,y,_,k,E,N,M){const{featureIndex:F,bucketIndex:q,sourceLayerIndex:X,layoutVertexArrayOffset:te}=d,ie=this.bucketLayerIDs[q];if(y&&!function(Re,Ae){for(let Oe=0;Oe<Re.length;Oe++)if(Ae.indexOf(Re[Oe])>=0)return!0;return!1}(y,ie))return;const fe=this.sourceLayerCoder.decode(X),ge=this.vtLayers[fe].feature(F);if(f.needGeometry){const Re=qf(ge,!0);if(!f.filter(new U(this.tileID.overscaledZ),Re,this.tileID.canonical))return}else if(!f.filter(new U(this.tileID.overscaledZ),ge))return;const je=this.getId(ge,fe);for(let Re=0;Re<ie.length;Re++){const Ae=ie[Re];if(y&&y.indexOf(Ae)<0)continue;const Oe=k[Ae];if(!Oe)continue;let Be={};je!==void 0&&N&&(Be=N.getState(Oe.sourceLayer||"_geojsonTileLayer",je));const Fe=Ye({},E[Ae]);Fe.paint=sR(Fe.paint,Oe.paint,ge,Be,_),Fe.layout=sR(Fe.layout,Oe.layout,ge,Be,_);const nt=!M||M(ge,Oe,Be,te);if(!nt)continue;const Qe=new GO(ge,this.z,this.x,this.y,je);Qe.layer=Fe;let dt=s[Ae];dt===void 0&&(dt=s[Ae]=[]),dt.push({featureIndex:F,feature:Qe,intersectionZ:nt})}}lookupSymbolFeatures(s,d,f,y,_,k,E,N){const M={};this.loadVTLayers();const F=vm(_);for(const q of s)this.loadMatchingFeature(M,{bucketIndex:f,sourceLayerIndex:y,featureIndex:q,layoutVertexArrayOffset:0},F,k,E,N,d);return M}loadFeature(s){const{featureIndex:d,sourceLayerIndex:f}=s;this.loadVTLayers();const y=this.sourceLayerCoder.decode(f),_=this.vtFeatures[y];if(_[d])return _[d];const k=this.vtLayers[y].feature(d);return _[d]=k,k}hasLayer(s){for(const d of this.bucketLayerIDs)for(const f of d)if(s===f)return!0;return!1}getId(s,d){let f=s.id;if(this.promoteId){const y=typeof this.promoteId=="string"?this.promoteId:this.promoteId[d];y!=null&&(f=s.properties[y]),typeof f=="boolean"&&(f=Number(f))}return f}}function sR(c,s,d,f,y){return Tt(c,(_,k)=>{const E=s instanceof Ee?s.get(k):null;return E&&E.evaluate?E.evaluate(d,f,y):E})}function fee(c,s){return s-c}Xt(aR,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class oR{constructor(s,d){this.width=s,this.height=d,this.nextRow=0,this.image=new Ru({width:s,height:d}),this.positions={},this.uploaded=!1}getDash(s,d){const f=this.getKey(s,d);return this.positions[f]}trim(){const s=this.width,d=this.height=Ct(this.nextRow);this.image.resize({width:s,height:d})}getKey(s,d){return s.join(",")+d}getDashRanges(s,d,f){const y=[];let _=s.length%2==1?-s[s.length-1]*f:0,k=s[0]*f,E=!0;y.push({left:_,right:k,isDash:E,zeroLength:s[0]===0});let N=s[0];for(let M=1;M<s.length;M++){E=!E;const F=s[M];_=N*f,N+=F,k=N*f,y.push({left:_,right:k,isDash:E,zeroLength:F===0})}return y}addRoundDash(s,d,f){const y=d/2;for(let _=-f;_<=f;_++){const k=this.width*(this.nextRow+f+_);let E=0,N=s[E];for(let M=0;M<this.width;M++){M/N.right>1&&(N=s[++E]);const F=Math.abs(M-N.left),q=Math.abs(M-N.right),X=Math.min(F,q);let te;const ie=_/f*(y+1);if(N.isDash){const fe=y-Math.abs(ie);te=Math.sqrt(X*X+fe*fe)}else te=y-Math.sqrt(X*X+ie*ie);this.image.data[k+M]=Math.max(0,Math.min(255,te+128))}}}addRegularDash(s,d){for(let N=s.length-1;N>=0;--N){const M=s[N],F=s[N+1];M.zeroLength?s.splice(N,1):F&&F.isDash===M.isDash&&(F.left=M.left,s.splice(N,1))}const f=s[0],y=s[s.length-1];f.isDash===y.isDash&&(f.left=y.left-this.width,y.right=f.right+this.width);const _=this.width*this.nextRow;let k=0,E=s[k];for(let N=0;N<this.width;N++){N/E.right>1&&(E=s[++k]);const M=Math.abs(N-E.left),F=Math.abs(N-E.right),q=Math.min(M,F);this.image.data[_+N]=Math.max(0,Math.min(255,(E.isDash?q:-q)+d+128))}}addDash(s,d){const f=this.getKey(s,d);if(this.positions[f])return this.positions[f];const y=d==="round",_=y?7:0,k=2*_+1;if(this.nextRow+k>this.height)return Lt("LineAtlas out of space"),null;s.length===0&&s.push(1);let E=0;for(let F=0;F<s.length;F++)s[F]<0&&(Lt("Negative value is found in line dasharray, replacing values with 0"),s[F]=0),E+=s[F];if(E!==0){const F=this.width/E,q=this.getDashRanges(s,this.width,F);y?this.addRoundDash(q,F,_):this.addRegularDash(q,d==="square"?.5*F:0)}const N=this.nextRow+_;this.nextRow+=k;const M={tl:[N,_],br:[E,0]};return this.positions[f]=M,M}}Xt(oR,"LineAtlas");const lR=1*$l;class cR{constructor(s){const d={},f=[];for(const E in s){const N=s[E],M=d[E]={};for(const F in N.glyphs){const q=N.glyphs[+F];if(!q||q.bitmap.width===0||q.bitmap.height===0)continue;const X=q.metrics.localGlyph?lR:1,te={x:0,y:0,w:q.bitmap.width+2*X,h:q.bitmap.height+2*X};f.push(te),M[F]=te}}const{w:y,h:_}=hj(f),k=new Ru({width:y||1,height:_||1});for(const E in s){const N=s[E];for(const M in N.glyphs){const F=N.glyphs[+M];if(!F||F.bitmap.width===0||F.bitmap.height===0)continue;const q=d[E][M],X=F.metrics.localGlyph?lR:1;Ru.copy(F.bitmap,k,{x:0,y:0},{x:q.x+X,y:q.y+X},F.bitmap)}}this.image=k,this.positions=d}}Xt(cR,"GlyphAtlas");class pee{constructor(s){this.tileID=new Ya(s.tileID.overscaledZ,s.tileID.wrap,s.tileID.canonical.z,s.tileID.canonical.x,s.tileID.canonical.y),this.tileZoom=s.tileZoom,this.uid=s.uid,this.zoom=s.zoom,this.canonical=s.tileID.canonical,this.pixelRatio=s.pixelRatio,this.tileSize=s.tileSize,this.source=s.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=s.showCollisionBoxes,this.collectResourceTiming=!!s.collectResourceTiming,this.returnDependencies=!!s.returnDependencies,this.promoteId=s.promoteId,this.enableTerrain=!!s.enableTerrain,this.isSymbolTile=s.isSymbolTile,this.tileTransform=Hf(s.tileID.canonical,s.projection),this.projection=s.projection}parse(s,d,f,y,_){this.status="parsing",this.data=s,this.collisionBoxArray=new gn;const k=new qO(Object.keys(s.layers).sort()),E=new aR(this.tileID,this.promoteId);E.bucketLayerIDs=[];const N={},M=new oR(256,256),F={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:f},q=d.familiesBySource[this.source];for(const Be in q){const Fe=s.layers[Be];if(!Fe)continue;let nt=!1,Qe=!1;for(const st of q[Be])st[0].type==="symbol"?nt=!0:Qe=!0;if(this.isSymbolTile===!0&&!nt||this.isSymbolTile===!1&&!Qe)continue;Fe.version===1&&Lt(`Vector tile source "${this.source}" layer "${Be}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const dt=k.encode(Be),Nt=[];for(let st=0;st<Fe.length;st++){const yt=Fe.feature(st),xt=E.getId(yt,Be);Nt.push({feature:yt,id:xt,index:st,sourceLayerIndex:dt})}for(const st of q[Be]){const yt=st[0];this.isSymbolTile!==void 0&&yt.type==="symbol"!==this.isSymbolTile||yt.minzoom&&this.zoom<Math.floor(yt.minzoom)||yt.maxzoom&&this.zoom>=yt.maxzoom||yt.visibility!=="none"&&(Nj(st,this.zoom,f),(N[yt.id]=yt.createBucket({index:E.bucketLayerIDs.length,layers:st,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:dt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:f})).populate(Nt,F,this.tileID.canonical,this.tileTransform),E.bucketLayerIDs.push(st.map(xt=>xt.id)))}}let X,te,ie,fe;M.trim();const ge={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},je=()=>{if(X)return _(X);if(te&&ie&&fe){const Be=new cR(te),Fe=new gO(ie,fe);for(const nt in N){const Qe=N[nt];Qe instanceof Qd?(Nj(Qe.layers,this.zoom,f),FQ(Qe,te,Be.positions,ie,Fe.iconPositions,this.showCollisionBoxes,f,this.tileID.canonical,this.tileZoom,this.projection)):Qe.hasPattern&&(Qe instanceof T1||Qe instanceof v1||Qe instanceof ex)&&(Nj(Qe.layers,this.zoom,f),Qe.addFeatures(F,this.tileID.canonical,Fe.patternPositions,f,this.tileTransform))}this.status="done",_(null,{buckets:$e(N).filter(nt=>!nt.isEmpty()),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Be.image,lineAtlas:M,imageAtlas:Fe,glyphMap:this.returnDependencies?te:null,iconMap:this.returnDependencies?ie:null,glyphPositions:this.returnDependencies?Be.positions:null})}},Re=Tt(F.glyphDependencies,Be=>Object.keys(Be).map(Number));Object.keys(Re).length?y.send("getGlyphs",{uid:this.uid,stacks:Re},(Be,Fe)=>{X||(X=Be,te=Fe,je())},void 0,!1,ge):te={};const Ae=Object.keys(F.iconDependencies);Ae.length?y.send("getImages",{icons:Ae,source:this.source,tileID:this.tileID,type:"icons"},(Be,Fe)=>{X||(X=Be,ie=Fe,je())},void 0,!1,ge):ie={};const Oe=Object.keys(F.patternDependencies);Oe.length?y.send("getImages",{icons:Oe,source:this.source,tileID:this.tileID,type:"patterns"},(Be,Fe)=>{X||(X=Be,fe=Fe,je())},void 0,!1,ge):fe={},je()}}function Nj(c,s,d){const f=new U(s);for(const y of c)y.recalculate(f,d)}class uR{constructor(s){this.entries={},this.scheduler=s}request(s,d,f,y){const _=this.entries[s]=this.entries[s]||{callbacks:[]};if(_.result){const[k,E]=_.result;return this.scheduler?this.scheduler.add(()=>{y(k,E)},d):y(k,E),()=>{}}return _.callbacks.push(y),_.cancel||(_.cancel=f((k,E)=>{_.result=[k,E];for(const N of _.callbacks)this.scheduler?this.scheduler.add(()=>{N(k,E)},d):N(k,E);setTimeout(()=>delete this.entries[s],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(k=>k!==y),_.callbacks.length||(_.cancel(),delete this.entries[s]))}}}function dR(c,s,d){const f=JSON.stringify(c.request);return c.data&&(this.deduped.entries[f]={result:[null,c.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},y=>{const _=oo(c.request,(k,E,N,M)=>{k?y(k):E&&y(null,{vectorTile:d?void 0:new lj(new j1(E)),rawData:E,cacheControl:N,expires:M})});return()=>{_.cancel(),y()}},s)}const hR=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Cj{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[d,f]=new Uint8Array(s,0,2);if(d!==219)throw new Error("Data does not appear to be in a KDBush format.");const y=f>>4;if(y!==1)throw new Error(`Got v${y} data when expected v1.`);const _=hR[15&f];if(!_)throw new Error("Unrecognized array type.");const[k]=new Uint16Array(s,2,1),[E]=new Uint32Array(s,4,1);return new Cj(E,k,_,s)}constructor(s,d=64,f=Float64Array,y){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+d,2),65535),this.ArrayType=f,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const _=hR.indexOf(this.ArrayType),k=2*s*this.ArrayType.BYTES_PER_ELEMENT,E=s*this.IndexArrayType.BYTES_PER_ELEMENT,N=(8-E%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${f}.`);y&&y instanceof ArrayBuffer?(this.data=y,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+E+N,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+k+E+N),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+E+N,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=d,new Uint32Array(this.data,4,1)[0]=s)}add(s,d){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=s,this.coords[this._pos++]=d,f}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return Pj(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,d,f,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:k,nodeSize:E}=this,N=[0,_.length-1,0],M=[];for(;N.length;){const F=N.pop()||0,q=N.pop()||0,X=N.pop()||0;if(q-X<=E){for(let ge=X;ge<=q;ge++){const je=k[2*ge],Re=k[2*ge+1];je>=s&&je<=f&&Re>=d&&Re<=y&&M.push(_[ge])}continue}const te=X+q>>1,ie=k[2*te],fe=k[2*te+1];ie>=s&&ie<=f&&fe>=d&&fe<=y&&M.push(_[te]),(F===0?s<=ie:d<=fe)&&(N.push(X),N.push(te-1),N.push(1-F)),(F===0?f>=ie:y>=fe)&&(N.push(te+1),N.push(q),N.push(1-F))}return M}within(s,d,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:_,nodeSize:k}=this,E=[0,y.length-1,0],N=[],M=f*f;for(;E.length;){const F=E.pop()||0,q=E.pop()||0,X=E.pop()||0;if(q-X<=k){for(let ge=X;ge<=q;ge++)pR(_[2*ge],_[2*ge+1],s,d)<=M&&N.push(y[ge]);continue}const te=X+q>>1,ie=_[2*te],fe=_[2*te+1];pR(ie,fe,s,d)<=M&&N.push(y[te]),(F===0?s-f<=ie:d-f<=fe)&&(E.push(X),E.push(te-1),E.push(1-F)),(F===0?s+f>=ie:d+f>=fe)&&(E.push(te+1),E.push(q),E.push(1-F))}return N}}function Pj(c,s,d,f,y,_){if(y-f<=d)return;const k=f+y>>1;fR(c,s,k,f,y,_),Pj(c,s,d,f,k-1,1-_),Pj(c,s,d,k+1,y,1-_)}function fR(c,s,d,f,y,_){for(;y>f;){if(y-f>600){const M=y-f+1,F=d-f+1,q=Math.log(M),X=.5*Math.exp(2*q/3),te=.5*Math.sqrt(q*X*(M-X)/M)*(F-M/2<0?-1:1);fR(c,s,d,Math.max(f,Math.floor(d-F*X/M+te)),Math.min(y,Math.floor(d+(M-F)*X/M+te)),_)}const k=s[2*d+_];let E=f,N=y;for(fx(c,s,f,d),s[2*y+_]>k&&fx(c,s,f,y);E<N;){for(fx(c,s,E,N),E++,N--;s[2*E+_]<k;)E++;for(;s[2*N+_]>k;)N--}s[2*f+_]===k?fx(c,s,f,N):(N++,fx(c,s,N,y)),N<=d&&(f=N+1),d<=N&&(y=N-1)}}function fx(c,s,d,f){Ij(c,d,f),Ij(s,2*d,2*f),Ij(s,2*d+1,2*f+1)}function Ij(c,s,d){const f=c[s];c[s]=c[d],c[d]=f}function pR(c,s,d,f){const y=c-d,_=s-f;return y*y+_*_}a.ARRAY_TYPE=Vs,a.AUTH_ERR_MSG=ze,a.Aabb=Xa,a.Actor=class{constructor(c,s,d){this.target=c,this.parent=s,this.mapId=d,this.callbacks={},this.cancelCallbacks={},gt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=qr()?c:p,this.scheduler=new oee}send(c,s,d,f,y=!1,_){const k=Math.round(1e18*Math.random()).toString(36).substring(0,10);d&&(d.metadata=_,this.callbacks[k]=d);const E=ht(this.globalScope)?void 0:[];return this.target.postMessage({id:k,type:c,hasCallback:!!d,targetMapId:f,mustQueue:y,sourceMapId:this.mapId,data:Gd(s,E)},E),{cancel:()=>{d&&delete this.callbacks[k],this.target.postMessage({id:k,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(c){const s=c.data,d=s.id;if(d&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const f=this.cancelCallbacks[d];delete this.cancelCallbacks[d],f&&f.cancel()}else if(s.mustQueue||qr()){const f=this.callbacks[d];this.cancelCallbacks[d]=this.scheduler.add(()=>this.processTask(d,s),f&&f.metadata||{type:"message"})}else this.processTask(d,s)}processTask(c,s){if(s.type==="<response>"){const d=this.callbacks[c];delete this.callbacks[c],d&&(s.error?d(Nu(s.error)):d(null,Nu(s.data)))}else{const d=ht(this.globalScope)?void 0:[],f=s.hasCallback?(_,k)=>{delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:_?Gd(_):null,data:Gd(k,d)},d)}:_=>{},y=Nu(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,y,f);else if(this.parent.getWorkerSource){const _=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,_[0],y.source)[_[1]](y,f)}else f(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=k1,a.Color=$n,a.ColorMode=Mc,a.CullFaceMode=Fl,a.DEMData=F1,a.DataConstantProperty=he,a.DedupedRequest=uR,a.DepthMode=qm,a.EXTENT=cr,a.Elevation=class{isDataAvailableAtPoint(c){const s=this._source();if(this.isUsingMockSource()||!s||c.y<0||c.y>1)return!1;const d=s.getSource().maxzoom,f=1<<d,y=Math.floor(c.x),_=Math.floor((c.x-y)*f),k=Math.floor(c.y*f),E=this.findDEMTileFor(new Ya(d,y,d,_,k));return!(!E||!E.dem)}getAtPointOrZero(c,s=0){return this.getAtPoint(c,s)||0}getAtPoint(c,s,d=!0){if(this.isUsingMockSource())return null;s==null&&(s=null);const f=this._source();if(!f||c.y<0||c.y>1)return s;const y=f.getSource().maxzoom,_=1<<y,k=Math.floor(c.x),E=c.x-k,N=new Ya(y,k,y,Math.floor(E*_),Math.floor(c.y*_)),M=this.findDEMTileFor(N);if(!M||!M.dem)return s;const F=M.dem,q=1<<M.tileID.canonical.z,X=(E*q-M.tileID.canonical.x)*F.dim,te=(c.y*q-M.tileID.canonical.y)*F.dim,ie=Math.floor(X),fe=Math.floor(te);return(d?this.exaggeration():1)*Z(Z(F.get(ie,fe),F.get(ie,fe+1),te-fe),Z(F.get(ie+1,fe),F.get(ie+1,fe+1),te-fe),X-ie)}getAtTileOffset(c,s,d){const f=1<<c.canonical.z;return this.getAtPointOrZero(new Cm(c.wrap+(c.canonical.x+s/cr)/f,(c.canonical.y+d/cr)/f))}getAtTileOffsetFunc(c,s,d,f){return y=>{const _=this.getAtTileOffset(c,y.x,y.y),k=f.upVector(c.canonical,y.x,y.y);return go(k,k,_*f.upVectorScale(c.canonical,s,d).metersToTile),k}}getForTilePoints(c,s,d,f){if(this.isUsingMockSource())return!1;const y=B1.create(this,c,f);return!!y&&(s.forEach(_=>{_[2]=this.exaggeration()*y.getElevationAt(_[0],_[1],d)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(c);if(!s||!s.dem)return null;const d=s.dem.tree,f=s.tileID,y=1<<c.canonical.z-f.canonical.z;let _=c.canonical.x/y-f.canonical.x,k=c.canonical.y/y-f.canonical.y,E=0;for(let N=0;N<c.canonical.z-f.canonical.z&&!d.leaves[E];N++){_*=2,k*=2;const M=2*Math.floor(k)+Math.floor(_);E=d.childOffsets[E]+M,_%=1,k%=1}return{min:this.exaggeration()*d.minimums[E],max:this.exaggeration()*d.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,s,d){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=ys,a.EvaluationParameters=U,a.Event=Ma,a.Evented=yu,a.FillExtrusionBucket=ex,a.Frustum=$E,a.FrustumCorners=zE,a.GLOBE_RADIUS=jc,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=fD,a.GLOBE_ZOOM_THRESHOLD_MIN=FE,a.GlobeSharedBuffers=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const c of this._wireframeSegments)c.destroy()}}_fillGridMeshWithLods(c,s){const d=new At,f=new rr,y=[],_=c+1+2,k=s[0]+1,E=s[0]+1+(1+s.length),N=(M,F,q)=>{let X=M===_-1?M-2:M===0?M:M-1;return X+=q?24575:0,[X,F]};for(let M=0;M<_;++M)d.emplaceBack(...N(M,0,!0));for(let M=0;M<k;++M)for(let F=0;F<_;++F)d.emplaceBack(...N(F,M,(F===0||F===_-1)&&!0));for(let M=0;M<s.length;++M){const F=s[M];for(let q=0;q<_;++q)d.emplaceBack(...N(q,F,!0))}for(let M=0;M<s.length;++M){const F=f.length,q=s[M]+1+2,X=new rr;for(let fe=0;fe<q-1;fe++){const ge=fe===q-2,je=ge?_*(E-s.length+M-fe):_;for(let Re=0;Re<_-1;Re++){const Ae=fe*_+Re;fe===0||ge||Re===0||Re===_-2?(X.emplaceBack(Ae+1,Ae,Ae+je),X.emplaceBack(Ae+je,Ae+je+1,Ae+1)):(f.emplaceBack(Ae+1,Ae,Ae+je),f.emplaceBack(Ae+je,Ae+je+1,Ae+1))}}const te=vi.simpleSegment(0,F,d.length,f.length-F);for(let fe=0;fe<X.uint16.length;fe+=3)f.emplaceBack(X.uint16[fe],X.uint16[fe+1],X.uint16[fe+2]);const ie=vi.simpleSegment(0,F,d.length,f.length-F);y.push({withoutSkirts:te,withSkirts:ie})}return{vertices:d,indices:f,segments:y}}_createGrid(c){const s=this._fillGridMeshWithLods(Vf,qy);this._gridSegments=s.segments,this._gridBuffer=c.createVertexBuffer(s.vertices,Uy.members),this._gridIndexBuffer=c.createIndexBuffer(s.indices,!0)}_createPoles(c){const s=new rr;for(let y=0;y<=Vf;y++)s.emplaceBack(0,y+1,y+2);this._poleIndexBuffer=c.createIndexBuffer(s,!0);const d=new mn,f=new mn;this._poleSegments=[];for(let y=0,_=0;y<FE;y++){const k=360/(1<<y);d.emplaceBack(0,-jc,0,.5,0),f.emplaceBack(0,-jc,0,.5,1);for(let E=0;E<=Vf;E++){const N=E/Vf,M=Z(0,k,N),[F,q,X]=jm(oJ,lJ,M,jc);d.emplaceBack(F,q,X,N,0),f.emplaceBack(F,q,X,N,1)}this._poleSegments.push(vi.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(d,dD,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(f,dD,!1)}getGridBuffers(c,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}getWirefameBuffers(c,s){if(!this._wireframeSegments){const d=new Ki,f=Vf,y=f+1+2,_=1;this._wireframeSegments=[];for(let k=0,E=0;k<qy.length;k++){const N=qy[k];for(let F=_;F<N+_;F++)for(let q=_;q<f+_;q++){const X=F*y+q;d.emplaceBack(X,X+1),d.emplaceBack(X,X+y),d.emplaceBack(X,X+y+1)}const M=N*f*3;this._wireframeSegments.push(vi.simpleSegment(0,E,(N+1)*y,M)),E+=M}this._wireframeIndexBuffer=c.createIndexBuffer(d)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[s]]}},a.GlyphManager=$m,a.ImagePosition=fj,a.KDBush=Cj,a.LivePerformanceUtils=tm,a.LngLat=yn,a.LngLatBounds=Zd,a.LocalGlyphMode=gj,a.MAX_MERCATOR_LATITUDE=Ta,a.MercatorCoordinate=Cm,a.ONE_EM=la,a.OverscaledTileID=Ya,a.PerformanceMarkers=Pa,a.Point=V,a.Properties=Ie,a.RGBAImage=Us,a.Ray=LE,a.RequestManager=class{constructor(c,s,d){this._transformRequestFn=c,this._customAccessToken=s,this._silenceAuthErrors=!!d,this._createSkuToken()}_createSkuToken(){const c=function(){let s="";for(let d=0;d<10;d++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",O,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,s){return this._transformRequestFn&&this._transformRequestFn(c,s)||{url:c}}normalizeStyleURL(c,s){if(!Ge(c))return c;const d=zt(c);return d.path=`/styles/v1${d.path}`,this._makeAPIURL(d,this._customAccessToken||s)}normalizeGlyphsURL(c,s){if(!Ge(c))return c;const d=zt(c);return d.path=`/fonts/v1${d.path}`,this._makeAPIURL(d,this._customAccessToken||s)}normalizeSourceURL(c,s,d,f){if(!Ge(c))return c;const y=zt(c);return y.path=`/v4/${y.authority}.json`,y.params.push("secure"),d&&y.params.push(`language=${d}`),f&&y.params.push(`worldview=${f}`),this._makeAPIURL(y,this._customAccessToken||s)}normalizeSpriteURL(c,s,d,f){const y=zt(c);return Ge(c)?(y.path=`/styles/v1${y.path}/sprite${s}${d}`,this._makeAPIURL(y,this._customAccessToken||f)):(y.path+=`${s}${d}`,vt(y))}normalizeTileURL(c,s,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!Ge(c))return c;const f=zt(c);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||d&&f.authority!=="raster"&&d===512?"@2x":""}${T.supported?".webp":"$1"}`),f.authority==="raster"?f.path=`/${w.RASTER_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${w.TILE_URL_VERSION}${f.path}`);const y=this._customAccessToken||function(_){for(const k of _){const E=k.match(/^access_token=(.*)$/);if(E)return E[1]}return null}(f.params)||w.ACCESS_TOKEN;return w.REQUIRE_ACCESS_TOKEN&&y&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,y)}canonicalizeTileURL(c,s){const d=zt(c);if(!d.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!d.path.match(/\.[\w]+$/))return c;let f="mapbox://";d.path.match(/^\/raster\/v1\//)?f+=`raster/${d.path.replace(`/${w.RASTER_URL_PREFIX}/`,"")}`:f+=`tiles/${d.path.replace(`/${w.TILE_URL_VERSION}/`,"")}`;let y=d.params;return s&&(y=y.filter(_=>!_.match(/^access_token=/))),y.length&&(f+=`?${y.join("&")}`),f}canonicalizeTileset(c,s){const d=!!s&&Ge(s),f=[];for(const y of c.tiles||[])Ze(y)?f.push(this.canonicalizeTileURL(y,d)):f.push(y);return f}_makeAPIURL(c,s){const d="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=zt(w.API_URL);if(c.protocol=f.protocol,c.authority=f.authority,c.protocol==="http"){const y=c.params.indexOf("secure");y>=0&&c.params.splice(y,1)}if(f.path!=="/"&&(c.path=`${f.path}${c.path}`),!w.REQUIRE_ACCESS_TOKEN)return vt(c);if(s=s||w.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${d}`);if(s[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${d}`)}return c.params=c.params.filter(y=>y.indexOf("access_token")===-1),c.params.push(`access_token=${s||""}`),vt(c)}},a.ResourceType=va,a.SegmentVector=vi,a.SourceCache=Kf,a.StencilMode=Ej,a.StructArrayLayout1ui2=Bs,a.StructArrayLayout2f1f2i16=ur,a.StructArrayLayout2i4=At,a.StructArrayLayout2ui4=Ki,a.StructArrayLayout3f12=Or,a.StructArrayLayout3ui6=rr,a.StructArrayLayout4i8=pt,a.StructArrayLayout5f20=mn,a.Texture=dx,a.Tile=Tj,a.Transitionable=ue,a.Uniform1f=s1,a.Uniform1i=class extends Iu{constructor(c){super(c),this.current=0}set(c,s,d){this.fetchUniformLocation(c,s)&&this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}},a.Uniform2f=class extends Iu{constructor(c){super(c),this.current=[0,0]}set(c,s,d){this.fetchUniformLocation(c,s)&&(d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1])))}},a.Uniform3f=class extends Iu{constructor(c){super(c),this.current=[0,0,0]}set(c,s,d){this.fetchUniformLocation(c,s)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2])))}},a.Uniform4f=K5,a.UniformColor=Z5,a.UniformMatrix2f=class extends Iu{constructor(c){super(c),this.current=GY}set(c,s,d){if(this.fetchUniformLocation(c,s)){for(let f=0;f<4;f++)if(d[f]!==this.current[f]){this.current=d,this.gl.uniformMatrix2fv(this.location,!1,d);break}}}},a.UniformMatrix3f=class extends Iu{constructor(c){super(c),this.current=qY}set(c,s,d){if(this.fetchUniformLocation(c,s)){for(let f=0;f<9;f++)if(d[f]!==this.current[f]){this.current=d,this.gl.uniformMatrix3fv(this.location,!1,d);break}}}},a.UniformMatrix4f=class extends Iu{constructor(c){super(c),this.current=UY}set(c,s,d){if(this.fetchUniformLocation(c,s)){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let f=1;f<16;f++)if(d[f]!==this.current[f]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}}},a.UnwrappedTileID=tO,a.ValidationError=Kt,a.VectorTileFeature=b1,a.VectorTileWorkerSource=class extends yu{constructor(c,s,d,f,y){super(),this.actor=c,this.layerIndex=s,this.availableImages=d,this.loadVectorData=y||dR,this.loading={},this.loaded={},this.deduped=new uR(c.scheduler),this.isSpriteLoaded=f,this.scheduler=c.scheduler}loadTile(c,s){const d=c.uid,f=c&&c.request,y=f&&f.collectResourceTiming,_=this.loading[d]=new pee(c);_.abort=this.loadVectorData(c,(k,E)=>{const N=!this.loading[d];if(delete this.loading[d],N||k||!E)return _.status="done",N||(this.loaded[d]=_),s(k);const M=E.rawData,F={};E.expires&&(F.expires=E.expires),E.cacheControl&&(F.cacheControl=E.cacheControl),_.vectorTile=E.vectorTile||new lj(new j1(M));const q=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(X,te)=>{if(X||!te)return s(X);const ie={};if(y){const fe=mu(f);fe.length>0&&(ie.resourceTiming=JSON.parse(JSON.stringify(fe)))}s(null,Ye({rawTileData:M.slice(0)},te,F,ie))})};this.isSpriteLoaded?q():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(q,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom}):q()}),this.loaded=this.loaded||{},this.loaded[d]=_})}reloadTile(c,s){const d=this.loaded,f=c.uid,y=this;if(d&&d[f]){const _=d[f];_.showCollisionBoxes=c.showCollisionBoxes,_.enableTerrain=!!c.enableTerrain,_.projection=c.projection,_.tileTransform=Hf(c.tileID.canonical,c.projection);const k=(E,N)=>{const M=_.reloadCallback;M&&(delete _.reloadCallback,_.parse(_.vectorTile,y.layerIndex,this.availableImages,y.actor,M)),s(E,N)};_.status==="parsing"?_.reloadCallback=k:_.status==="done"&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,k):k())}}abortTile(c,s){const d=c.uid,f=this.loading[d];f&&(f.abort&&f.abort(),delete this.loading[d]),s()}removeTile(c,s){const d=this.loaded,f=c.uid;d&&d[f]&&delete d[f],s()}},a.WritingMode=xo,a.ZoomDependentExpression=Nf,a.add=Du,a.addDynamicAttributes=L1,a.adjoint=function(c,s){var d=s[0],f=s[1],y=s[2],_=s[3],k=s[4],E=s[5],N=s[6],M=s[7],F=s[8];return c[0]=k*F-E*M,c[1]=y*M-f*F,c[2]=f*E-y*k,c[3]=E*N-_*F,c[4]=d*F-y*N,c[5]=y*_-d*E,c[6]=_*M-k*N,c[7]=f*N-d*M,c[8]=d*k-f*_,c},a.asyncAll=Ce,a.bezier=ae,a.bindAll=gt,a.boundsAttributes=HO,a.bufferConvexPolygon=function(c,s){const d=[];for(let f=0;f<c.length;f++){const y=be(f-1,-1,c.length-1),_=be(f+1,-1,c.length-1),k=c[f],E=c[_],N=c[y].sub(k).unit(),M=E.sub(k).unit(),F=M.angleWithSep(N.x,N.y),q=N.add(M).unit().mult(-1*s/Math.sin(F/2));d.push(k.add(q))}return d},a.cacheEntryPossiblyAdded=function(c){Do++,Do>In&&(c.getActor().send("enforceCacheSizeLimit",yr),Do=0)},a.calculateGlobeLabelMatrix=function(c,s){const{x:d,y:f}=c.point,y=xD(d,f,c.worldSize/c._pixelsPerMercatorPixel,0,0);return $f(y,y,UE(Ac(s)))},a.calculateGlobeMatrix=function(c){const{x:s,y:d}=c.point,{lng:f,lat:y}=c._center;return xD(s,d,c.worldSize,f,y)},a.calculateGlobeMercatorMatrix=function(c){const s=c.pixelsPerMeter,d=s/Ll(1,c.center.lat),f=Ol(new Float64Array(16));return Ly(f,f,[c.point.x,c.point.y,0]),Ff(f,f,[d,d,s]),Float32Array.from(f)},a.circumferenceAtLatitude=GE,a.clamp=ye,a.clearTileCache=function(c){if(!fs())return;const s=p.caches.delete(zr);c&&s.catch(c).then(()=>c())},a.clipLine=NO,a.clone=function(c){var s=new Vs(16);return s[0]=c[0],s[1]=c[1],s[2]=c[2],s[3]=c[3],s[4]=c[4],s[5]=c[5],s[6]=c[6],s[7]=c[7],s[8]=c[8],s[9]=c[9],s[10]=c[10],s[11]=c[11],s[12]=c[12],s[13]=c[13],s[14]=c[14],s[15]=c[15],s},a.clone$1=ar,a.collisionCircleLayout=hQ,a.config=w,a.conjugate=function(c,s){return c[0]=-s[0],c[1]=-s[1],c[2]=-s[2],c[3]=s[3],c},a.create=function(){var c=new Vs(16);return Vs!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},a.create$1=J5,a.createExpression=Vd,a.createLayout=He,a.createStyleLayer=function(c){return c.type==="custom"?new nee(c):new aee[c.type](c)},a.cross=RE,a.degToRad=ce,a.distance=function(c,s){return Math.hypot(s[0]-c[0],s[1]-c[1],s[2]-c[2])},a.div=function(c,s,d){return c[0]=s[0]/d[0],c[1]=s[1]/d[1],c[2]=s[2]/d[2],c},a.dot=Wo,a.earthRadius=Hy,a.ease=xe,a.easeCubicInOut=oe,a.ecefToLatLng=function([c,s,d]){const f=Math.hypot(c,s,d),y=Math.atan2(c,d),_=.5*Math.PI-Math.acos(-s/f);return new yn(ne(y),ne(_))},a.emitValidationErrors=e1,a.endsWith=Zt,a.enforceCacheSizeLimit=function(c){ps(),Cr&&Cr.then(s=>{s.keys().then(d=>{for(let f=0;f<d.length-c;f++)s.delete(d[f])})})},a.evaluateSizeForFeature=S1,a.evaluateSizeForZoom=Om,a.evaluateVariableOffset=DO,a.evented=S,a.exactEquals=function(c,s){return c[0]===s[0]&&c[1]===s[1]&&c[2]===s[2]&&c[3]===s[3]},a.exactEquals$1=function(c,s){return c[0]===s[0]&&c[1]===s[1]&&c[2]===s[2]},a.exported=Rs,a.exported$1=T,a.extend=Ye,a.extend$1=Ls,a.fillExtrusionHeightLift=JD,a.filterObject=ot,a.fromMat4=function(c,s){return c[0]=s[0],c[1]=s[1],c[2]=s[2],c[3]=s[4],c[4]=s[5],c[5]=s[6],c[6]=s[8],c[7]=s[9],c[8]=s[10],c},a.fromQuat=function(c,s){var d=s[0],f=s[1],y=s[2],_=s[3],k=d+d,E=f+f,N=y+y,M=d*k,F=f*k,q=f*E,X=y*k,te=y*E,ie=y*N,fe=_*k,ge=_*E,je=_*N;return c[0]=1-q-ie,c[1]=F+je,c[2]=X-ge,c[3]=0,c[4]=F-je,c[5]=1-M-ie,c[6]=te+fe,c[7]=0,c[8]=X+ge,c[9]=te-fe,c[10]=1-M-q,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},a.fromRotation=function(c,s){var d=Math.sin(s),f=Math.cos(s);return c[0]=f,c[1]=d,c[2]=0,c[3]=-d,c[4]=f,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},a.fromScaling=eD,a.furthestTileCorner=function(c){const s=Math.round((c+45+360)%360/90)%4;return re[s]},a.getAABBPointSquareDist=function(c,s,d){let f=0;for(let y=0;y<2;++y){const _=d?d[y]:0;c[y]>_&&(f+=(c[y]-_)*(c[y]-_)),s[y]<_&&(f+=(_-s[y])*(_-s[y]))}return f},a.getAnchorAlignment=mj,a.getAnchorJustification=xj,a.getBounds=function(c){let s=1/0,d=1/0,f=-1/0,y=-1/0;for(const _ of c)s=Math.min(s,_.x),d=Math.min(d,_.y),f=Math.max(f,_.x),y=Math.max(y,_.y);return{min:new V(s,d),max:new V(f,y)}},a.getColumn=tr,a.getDefaultExportFromCjs=$,a.getGridMatrix=function(c,s,d,f){const y=s.getNorth(),_=s.getSouth(),k=s.getWest(),E=s.getEast(),N=1<<c.z,M=E-k,F=y-_,q=M/Vf,X=-F/qy[d],te=[0,q,0,X,0,0,y,k,0];if(c.z>0){const ie=180/f;Q5(te,te,[ie/M+1,0,0,0,ie/F+1,0,-.5*ie/q,.5*ie/X,1])}return te[2]=N,te[5]=c.x,te[8]=c.y,te},a.getImage=Ne,a.getJSON=function(c,s){return Ga(Ye(c,{type:"json"}),s)},a.getLatitudinalLod=function(c){const s=Ta-5;c=ye(c,-s,s)/s*90;const d=Math.pow(Math.abs(Math.sin(ce(c))),3);return Math.round(d*(qy.length-1))},a.getMapSessionAPI=li,a.getPerformanceMeasurement=mu,a.getProjection=VO,a.getRTLTextPluginStatus=j,a.getReferrer=ms,a.getTilePoint=function(c,{x:s,y:d},f=0){return new V(((s-f)*c.scale-c.x)*cr,(d*c.scale-c.y)*cr)},a.getTileVec3=function(c,s,d=0){return Em(((s.x-d)*c.scale-c.x)*cr,(s.y*c.scale-c.y)*cr,wD(s.z,s.y))},a.getVideo=function(c,s){const d=p.document.createElement("video");d.muted=!0,d.onloadstart=function(){s(null,d)};for(let f=0;f<c.length;f++){const y=p.document.createElement("source");_l(c[f])||(d.crossOrigin="Anonymous"),y.src=c[f],d.appendChild(y)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(c){const s=[0,0,0],d=Ol(new Float64Array(16));return $f(d,c.pixelMatrix,c.globeMatrix),ui(s,s,d),new V(s[0],s[1])},a.globeDenormalizeECEF=UE,a.globeECEFOrigin=function(c,s){const d=[0,0,0];return ui(d,d,Wy(Ac(s.canonical))),ui(d,d,c),d},a.globeMetersToEcef=c1,a.globeNormalizeECEF=Wy,a.globePixelsToTileUnits=function(c,s){return cr/(512*Math.pow(2,c))*d1(Ac(s))},a.globePoleMatrixForTile=function(c,s,d){const f=Ol(new Float64Array(16)),y=(s/(1<<c)-.5)*Math.PI*2;return l1(f,d.globeMatrix,y),Float32Array.from(f)},a.globeTileBounds=Ac,a.globeTiltAtLngLat=vD,a.globeToMercatorTransition=Nm,a.globeUseCustomAntiAliasing=function(c,s,d){const f=Nm(d.zoom),y=c.style.map._antialias,_=!!s.extStandardDerivatives,k=s.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return f===0&&!y&&!k&&_},a.identity=Ol,a.identity$1=lD,a.invert=IE,a.isFullscreen=function(){return!!p.document.fullscreenElement||!!p.document.webkitFullscreenElement},a.isLngLatBehindGlobe=qE,a.isMapAuthenticated=function(c){return Pi.has(c)},a.isMapboxURL=Ge,a.isSafariWithAntialiasingBug=function(c){const s=c.navigator?c.navigator.userAgent:null;return!!ht(c)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=ka,a.latLngToECEF=Am,a.len=eJ,a.length=zy,a.length$1=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},a.lngFromMercatorX=yo,a.loadVectorTile=dR,a.makeRequest=Ga,a.mapValue=function(c,s,d,f,y){return ye((c-s)/(d-s)*(y-f)+f,f,y)},a.mercatorScale=kD,a.mercatorXfromLng=Nc,a.mercatorYfromLat=Cc,a.mercatorZfromAltitude=Ll,a.mul=JY,a.mul$1=QY,a.multiply=$f,a.multiply$1=Q5,a.multiply$2=nD,a.nextPowerOfTwo=Ct,a.normalize=Za,a.normalize$1=tJ,a.normalize$2=sD,a.number=Z,a.ortho=function(c,s,d,f,y,_,k){var E=1/(s-d),N=1/(f-y),M=1/(_-k);return c[0]=-2*E,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*N,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*M,c[11]=0,c[12]=(s+d)*E,c[13]=(y+f)*N,c[14]=(k+_)*M,c[15]=1,c},a.pbf=lO,a.perspective=function(c,s,d,f,y){var _,k=1/Math.tan(s/2);return c[0]=k/d,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=k,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,y!=null&&y!==1/0?(c[10]=(y+f)*(_=1/(f-y)),c[14]=2*y*f*_):(c[10]=-1,c[14]=-2*f),c},a.pick=function(c,s){const d={};for(let f=0;f<s.length;f++){const y=s[f];y in c&&(d[y]=c[y])}return d},a.plugin=z,a.pointGeometry=W,a.polesInViewport=function(c){const s=Ol(new Float64Array(16));$f(s,c.pixelMatrix,c.globeMatrix);const d=[0,Ho,0],f=[0,Ko,0];return ui(d,d,s),ui(f,f,s),[d[0]>0&&d[0]<=c.width&&d[1]>0&&d[1]<=c.height&&!qE(c,new yn(c.center.lat,90)),f[0]>0&&f[0]<=c.width&&f[1]>0&&f[1]<=c.height&&!qE(c,new yn(c.center.lat,-90))]},a.polygonContainsPoint=Gf,a.polygonIntersectsBox=CD,a.polygonIntersectsPolygon=ED,a.polygonizeBounds=function(c,s,d=0,f=!0){const y=new V(d,d),_=c.sub(y),k=s.add(y),E=[_,new V(k.x,_.y),k,new V(_.x,k.y)];return f&&E.push(_.clone()),E},a.posAttributes=Uy,a.postMapLoadEvent=Yn,a.postPerformanceEvent=zn,a.postTurnstileEvent=$r,a.potpack=hj,a.prevPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},a.radToDeg=ne,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(c){return c({pluginStatus:x,pluginURL:h}),S.on("pluginStateChange",c),c},a.removeAuthState=function(c){Pi.delete(c)},a.renderColorRamp=QE,a.resample=TD,a.rotateX=ME,a.rotateX$1=cD,a.rotateY=l1,a.rotateY$1=uD,a.rotateZ=function(c,s,d){var f=Math.sin(d),y=Math.cos(d),_=s[0],k=s[1],E=s[2],N=s[3],M=s[4],F=s[5],q=s[6],X=s[7];return s!==c&&(c[8]=s[8],c[9]=s[9],c[10]=s[10],c[11]=s[11],c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15]),c[0]=_*y+M*f,c[1]=k*y+F*f,c[2]=E*y+q*f,c[3]=N*y+X*f,c[4]=M*y-_*f,c[5]=F*y-k*f,c[6]=q*y-E*f,c[7]=X*y-N*f,c},a.rotateZ$1=function(c,s,d){d*=.5;var f=s[0],y=s[1],_=s[2],k=s[3],E=Math.sin(d),N=Math.cos(d);return c[0]=f*N+y*E,c[1]=y*N-f*E,c[2]=_*N+k*E,c[3]=k*N-_*E,c},a.scale=Ff,a.scale$1=aD,a.scale$2=go,a.scaleAndAdd=By,a.set=function(c,s,d,f){return c[0]=s,c[1]=d,c[2]=f,c},a.setCacheLimits=function(c,s){yr=c,In=s},a.setColumn=function(c,s,d){c[4*s+0]=d[0],c[4*s+1]=d[1],c[4*s+2]=d[2],c[4*s+3]=d[3]},a.setRTLTextPlugin=function(c,s,d=!1){if(x===Iy||x===My||x===Dy)throw new Error("setRTLTextPlugin cannot be called multiple times.");h=Rs.resolveURL(c),x=Iy,Wd=s,b(),d||R()},a.smoothstep=Se,a.spec=lt,a.squaredLength=function(c){var s=c[0],d=c[1],f=c[2];return s*s+d*d+f*f},a.storeAuthState=function(c,s){s?Pi.add(c):Pi.delete(c)},a.sub=Rl,a.subtract=OE,a.symbolSize=fQ,a.tileAABB=function(c,s,d,f,y,_,k,E,N){if(N.name==="globe")return sJ(c,s,new k1(d,f,y));const M=Hf({z:d,x:f,y},N);return new Xa([(_+M.x/M.scale)*s,s*(M.y/M.scale),k],[(_+M.x2/M.scale)*s,s*(M.y2/M.scale),E])},a.tileCornersToBounds=u1,a.tileTransform=Hf,a.transformMat3=function(c,s,d){var f=s[0],y=s[1],_=s[2];return c[0]=f*d[0]+y*d[3]+_*d[6],c[1]=f*d[1]+y*d[4]+_*d[7],c[2]=f*d[2]+y*d[5]+_*d[8],c},a.transformMat4=ui,a.transformMat4$1=Bf,a.transformQuat=iD,a.transitionTileAABBinECEF=mD,a.translate=Ly,a.transpose=function(c,s){if(c===s){var d=s[1],f=s[2],y=s[5];c[1]=s[3],c[2]=s[6],c[3]=d,c[5]=s[7],c[6]=f,c[7]=y}else c[0]=s[0],c[1]=s[3],c[2]=s[6],c[3]=s[1],c[4]=s[4],c[5]=s[7],c[6]=s[2],c[7]=s[5],c[8]=s[8];return c},a.triggerPluginCompletionEvent=m,a.uniqueId=Me,a.updateGlobeVertexNormal=function(c,s,d,f,y){const _=5*s+2;c.float32[_+0]=d,c.float32[_+1]=f,c.float32[_+2]=y},a.validateCustomStyleLayer=function(c){const s=[],d=c.id;return d===void 0&&s.push({message:`layers.${d}: missing required property "id"`}),c.render===void 0&&s.push({message:`layers.${d}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&s.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),s},a.validateFilter=c=>Fs(Df(c)),a.validateFog=c=>Fs(Yb(c)),a.validateLayer=c=>Fs(Hb(c)),a.validateLight=c=>Fs(Xb(c)),a.validateSource=c=>Fs(Zb(c)),a.validateStyle=Qb,a.validateTerrain=c=>Fs(jy(c)),a.values=$e,a.vectorTile=_1,a.version=g,a.warnOnce=Lt,a.window=p,a.wrap=be}),o(["./shared"],function(a){function p(De){if(typeof De=="number"||typeof De=="boolean"||typeof De=="string"||De==null)return JSON.stringify(De);if(Array.isArray(De)){let le="[";for(const Ne of De)le+=`${p(Ne)},`;return`${le}]`}let pe="{";for(const le of Object.keys(De).sort())pe+=`${le}:${p(De[le])},`;return`${pe}}`}function g(De){let pe="";for(const le of a.refProperties)pe+=`/${p(De[le])}`;return pe}class v{constructor(pe){this.keyCache={},pe&&this.replace(pe)}replace(pe){this._layerConfigs={},this._layers={},this.update(pe,[])}update(pe,le){for(const ze of pe)this._layerConfigs[ze.id]=ze,(this._layers[ze.id]=a.createStyleLayer(ze)).compileFilter(),this.keyCache[ze.id]&&delete this.keyCache[ze.id];for(const ze of le)delete this.keyCache[ze],delete this._layerConfigs[ze],delete this._layers[ze];this.familiesBySource={};const Ne=function(ze,Ge){const Ze={};for(let We=0;We<ze.length;We++){const it=Ge&&Ge[ze[We].id]||g(ze[We]);Ge&&(Ge[ze[We].id]=it);let It=Ze[it];It||(It=Ze[it]=[]),It.push(ze[We])}const Xe=[];for(const We in Ze)Xe.push(Ze[We]);return Xe}(a.values(this._layerConfigs),this.keyCache);for(const ze of Ne){const Ge=ze.map(zt=>this._layers[zt.id]),Ze=Ge[0];if(Ze.visibility==="none")continue;const Xe=Ze.source||"";let We=this.familiesBySource[Xe];We||(We=this.familiesBySource[Xe]={});const it=Ze.sourceLayer||"_geojsonTileLayer";let It=We[it];It||(It=We[it]=[]),It.push(Ge)}}}class w{loadTile(pe,le){const{uid:Ne,encoding:ze,rawImageData:Ge,padding:Ze,buildQuadTree:Xe}=pe,We=a.window.ImageBitmap&&Ge instanceof a.window.ImageBitmap?this.getImageData(Ge,Ze):Ge;le(null,new a.DEMData(Ne,We,ze,Ze<1,Xe))}getImageData(pe,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(pe.width,pe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=pe.width,this.offscreenCanvas.height=pe.height,this.offscreenCanvasContext.drawImage(pe,0,0,pe.width,pe.height);const Ne=this.offscreenCanvasContext.getImageData(-le,-le,pe.width+2*le,pe.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ne}}function T(De,pe){if(De.length!==0){A(De[0],pe);for(var le=1;le<De.length;le++)A(De[le],!pe)}}function A(De,pe){for(var le=0,Ne=0,ze=0,Ge=De.length,Ze=Ge-1;ze<Ge;Ze=ze++){var Xe=(De[ze][0]-De[Ze][0])*(De[Ze][1]+De[ze][1]),We=le+Xe;Ne+=Math.abs(le)>=Math.abs(Xe)?le-We+Xe:Xe-We+le,le=We}le+Ne>=0!=!!pe&&De.reverse()}var I=a.getDefaultExportFromCjs(function De(pe,le){var Ne,ze=pe&&pe.type;if(ze==="FeatureCollection")for(Ne=0;Ne<pe.features.length;Ne++)De(pe.features[Ne],le);else if(ze==="GeometryCollection")for(Ne=0;Ne<pe.geometries.length;Ne++)De(pe.geometries[Ne],le);else if(ze==="Feature")De(pe.geometry,le);else if(ze==="Polygon")T(pe.coordinates,le);else if(ze==="MultiPolygon")for(Ne=0;Ne<pe.coordinates.length;Ne++)T(pe.coordinates[Ne],le);return pe});const P=a.VectorTileFeature.prototype.toGeoJSON;var D={exports:{}},L=a.pointGeometry,O=a.vectorTile.VectorTileFeature,$=G;function G(De,pe){this.options=pe||{},this.features=De,this.length=De.length}function B(De,pe){this.id=typeof De.id=="number"?De.id:void 0,this.type=De.type,this.rawGeometry=De.type===1?[De.geometry]:De.geometry,this.properties=De.tags,this.extent=pe||4096}G.prototype.feature=function(De){return new B(this.features[De],this.options.extent)},B.prototype.loadGeometry=function(){var De=this.rawGeometry;this.geometry=[];for(var pe=0;pe<De.length;pe++){for(var le=De[pe],Ne=[],ze=0;ze<le.length;ze++)Ne.push(new L(le[ze][0],le[ze][1]));this.geometry.push(Ne)}return this.geometry},B.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var De=this.geometry,pe=1/0,le=-1/0,Ne=1/0,ze=-1/0,Ge=0;Ge<De.length;Ge++)for(var Ze=De[Ge],Xe=0;Xe<Ze.length;Xe++){var We=Ze[Xe];pe=Math.min(pe,We.x),le=Math.max(le,We.x),Ne=Math.min(Ne,We.y),ze=Math.max(ze,We.y)}return[pe,Ne,le,ze]},B.prototype.toGeoJSON=O.prototype.toGeoJSON;var J=a.pbf,W=$;function H(De){var pe=new J;return function(le,Ne){for(var ze in le.layers)Ne.writeMessage(3,V,le.layers[ze])}(De,pe),pe.finish()}function V(De,pe){var le;pe.writeVarintField(15,De.version||1),pe.writeStringField(1,De.name||""),pe.writeVarintField(5,De.extent||4096);var Ne={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<De.length;le++)Ne.feature=De.feature(le),pe.writeMessage(2,se,Ne);var ze=Ne.keys;for(le=0;le<ze.length;le++)pe.writeStringField(3,ze[le]);var Ge=Ne.values;for(le=0;le<Ge.length;le++)pe.writeMessage(4,oe,Ge[le])}function se(De,pe){var le=De.feature;le.id!==void 0&&pe.writeVarintField(1,le.id),pe.writeMessage(2,K,De),pe.writeVarintField(3,le.type),pe.writeMessage(4,re,le)}function K(De,pe){var le=De.feature,Ne=De.keys,ze=De.values,Ge=De.keycache,Ze=De.valuecache;for(var Xe in le.properties){var We=le.properties[Xe],it=Ge[Xe];if(We!==null){it===void 0&&(Ne.push(Xe),Ge[Xe]=it=Ne.length-1),pe.writeVarint(it);var It=typeof We;It!=="string"&&It!=="boolean"&&It!=="number"&&(We=JSON.stringify(We));var zt=It+":"+We,vt=Ze[zt];vt===void 0&&(ze.push(We),Ze[zt]=vt=ze.length-1),pe.writeVarint(vt)}}}function ce(De,pe){return(pe<<3)+(7&De)}function ne(De){return De<<1^De>>31}function re(De,pe){for(var le=De.loadGeometry(),Ne=De.type,ze=0,Ge=0,Ze=le.length,Xe=0;Xe<Ze;Xe++){var We=le[Xe],it=1;Ne===1&&(it=We.length),pe.writeVarint(ce(1,it));for(var It=Ne===3?We.length-1:We.length,zt=0;zt<It;zt++){zt===1&&Ne!==1&&pe.writeVarint(ce(2,It-1));var vt=We[zt].x-ze,xr=We[zt].y-Ge;pe.writeVarint(ne(vt)),pe.writeVarint(ne(xr)),ze+=vt,Ge+=xr}Ne===3&&pe.writeVarint(ce(7,1))}}function oe(De,pe){var le=typeof De;le==="string"?pe.writeStringField(1,De):le==="boolean"?pe.writeBooleanField(7,De):le==="number"&&(De%1!=0?pe.writeDoubleField(3,De):De<0?pe.writeSVarintField(6,De):pe.writeVarintField(5,De))}D.exports=H,D.exports.fromVectorTileJs=H,D.exports.fromGeojsonVt=function(De,pe){pe=pe||{};var le={};for(var Ne in De)le[Ne]=new W(De[Ne].features,pe),le[Ne].name=Ne,le[Ne].version=pe.version,le[Ne].extent=pe.extent;return H({layers:le})},D.exports.GeoJSONWrapper=W;var ae=a.getDefaultExportFromCjs(D.exports);const xe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:De=>De},ye=Math.fround||(Se=new Float32Array(1),De=>(Se[0]=+De,Se[0]));var Se;const be=3,Ce=5,$e=6;class Ye{constructor(pe){this.options=Object.assign(Object.create(xe),pe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(pe){const{log:le,minZoom:Ne,maxZoom:ze}=this.options;le&&console.time("total time");const Ge=`prepare ${pe.length} points`;le&&console.time(Ge),this.points=pe;const Ze=[];for(let We=0;We<pe.length;We++){const it=pe[We];if(!it.geometry)continue;const[It,zt]=it.geometry.coordinates,vt=ye(St(It)),xr=ye(Ct(zt));Ze.push(vt,xr,1/0,We,-1,1),this.options.reduce&&Ze.push(0)}let Xe=this.trees[ze+1]=this._createTree(Ze);le&&console.timeEnd(Ge);for(let We=ze;We>=Ne;We--){const it=+Date.now();Xe=this.trees[We]=this._createTree(this._cluster(Xe,We)),le&&console.log("z%d: %d clusters in %dms",We,Xe.numItems,+Date.now()-it)}return le&&console.timeEnd("total time"),this}getClusters(pe,le){let Ne=((pe[0]+180)%360+360)%360-180;const ze=Math.max(-90,Math.min(90,pe[1]));let Ge=pe[2]===180?180:((pe[2]+180)%360+360)%360-180;const Ze=Math.max(-90,Math.min(90,pe[3]));if(pe[2]-pe[0]>=360)Ne=-180,Ge=180;else if(Ne>Ge){const zt=this.getClusters([Ne,ze,180,Ze],le),vt=this.getClusters([-180,ze,Ge,Ze],le);return zt.concat(vt)}const Xe=this.trees[this._limitZoom(le)],We=Xe.range(St(Ne),Ct(Ze),St(Ge),Ct(ze)),it=Xe.data,It=[];for(const zt of We){const vt=this.stride*zt;It.push(it[vt+Ce]>1?jt(it,vt,this.clusterProps):this.points[it[vt+be]])}return It}getChildren(pe){const le=this._getOriginId(pe),Ne=this._getOriginZoom(pe),ze="No cluster with the specified id.",Ge=this.trees[Ne];if(!Ge)throw new Error(ze);const Ze=Ge.data;if(le*this.stride>=Ze.length)throw new Error(ze);const Xe=this.options.radius/(this.options.extent*Math.pow(2,Ne-1)),We=Ge.within(Ze[le*this.stride],Ze[le*this.stride+1],Xe),it=[];for(const It of We){const zt=It*this.stride;Ze[zt+4]===pe&&it.push(Ze[zt+Ce]>1?jt(Ze,zt,this.clusterProps):this.points[Ze[zt+be]])}if(it.length===0)throw new Error(ze);return it}getLeaves(pe,le,Ne){const ze=[];return this._appendLeaves(ze,pe,le=le||10,Ne=Ne||0,0),ze}getTile(pe,le,Ne){const ze=this.trees[this._limitZoom(pe)],Ge=Math.pow(2,pe),{extent:Ze,radius:Xe}=this.options,We=Xe/Ze,it=(Ne-We)/Ge,It=(Ne+1+We)/Ge,zt={features:[]};return this._addTileFeatures(ze.range((le-We)/Ge,it,(le+1+We)/Ge,It),ze.data,le,Ne,Ge,zt),le===0&&this._addTileFeatures(ze.range(1-We/Ge,it,1,It),ze.data,Ge,Ne,Ge,zt),le===Ge-1&&this._addTileFeatures(ze.range(0,it,We/Ge,It),ze.data,-1,Ne,Ge,zt),zt.features.length?zt:null}getClusterExpansionZoom(pe){let le=this._getOriginZoom(pe)-1;for(;le<=this.options.maxZoom;){const Ne=this.getChildren(pe);if(le++,Ne.length!==1)break;pe=Ne[0].properties.cluster_id}return le}_appendLeaves(pe,le,Ne,ze,Ge){const Ze=this.getChildren(le);for(const Xe of Ze){const We=Xe.properties;if(We&&We.cluster?Ge+We.point_count<=ze?Ge+=We.point_count:Ge=this._appendLeaves(pe,We.cluster_id,Ne,ze,Ge):Ge<ze?Ge++:pe.push(Xe),pe.length===Ne)break}return Ge}_createTree(pe){const le=new a.KDBush(pe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ne=0;Ne<pe.length;Ne+=this.stride)le.add(pe[Ne],pe[Ne+1]);return le.finish(),le.data=pe,le}_addTileFeatures(pe,le,Ne,ze,Ge,Ze){for(const Xe of pe){const We=Xe*this.stride,it=le[We+Ce]>1;let It,zt,vt;if(it)It=Me(le,We,this.clusterProps),zt=le[We],vt=le[We+1];else{const mr=this.points[le[We+be]];It=mr.properties;const[Pr,$r]=mr.geometry.coordinates;zt=St(Pr),vt=Ct($r)}const xr={type:1,geometry:[[Math.round(this.options.extent*(zt*Ge-Ne)),Math.round(this.options.extent*(vt*Ge-ze))]],tags:It};let vr;vr=it||this.options.generateId?le[We+be]:this.points[le[We+be]].id,vr!==void 0&&(xr.id=vr),Ze.features.push(xr)}}_limitZoom(pe){return Math.max(this.options.minZoom,Math.min(Math.floor(+pe),this.options.maxZoom+1))}_cluster(pe,le){const{radius:Ne,extent:ze,reduce:Ge,minPoints:Ze}=this.options,Xe=Ne/(ze*Math.pow(2,le)),We=pe.data,it=[],It=this.stride;for(let zt=0;zt<We.length;zt+=It){if(We[zt+2]<=le)continue;We[zt+2]=le;const vt=We[zt],xr=We[zt+1],vr=pe.within(We[zt],We[zt+1],Xe),mr=We[zt+Ce];let Pr=mr;for(const $r of vr){const nn=$r*It;We[nn+2]>le&&(Pr+=We[nn+Ce])}if(Pr>mr&&Pr>=Ze){let $r,nn=vt*mr,Yn=xr*mr,qi=-1;const zn=((zt/It|0)<<5)+(le+1)+this.points.length;for(const gs of vr){const li=gs*It;if(We[li+2]<=le)continue;We[li+2]=le;const Pi=We[li+Ce];nn+=We[li]*Pi,Yn+=We[li+1]*Pi,We[li+4]=zn,Ge&&($r||($r=this._map(We,zt,!0),qi=this.clusterProps.length,this.clusterProps.push($r)),Ge($r,this._map(We,li)))}We[zt+4]=zn,it.push(nn/Pr,Yn/Pr,1/0,zn,-1,Pr),Ge&&it.push(qi)}else{for(let $r=0;$r<It;$r++)it.push(We[zt+$r]);if(Pr>1)for(const $r of vr){const nn=$r*It;if(!(We[nn+2]<=le)){We[nn+2]=le;for(let Yn=0;Yn<It;Yn++)it.push(We[nn+Yn])}}}}return it}_getOriginId(pe){return pe-this.points.length>>5}_getOriginZoom(pe){return(pe-this.points.length)%32}_map(pe,le,Ne){if(pe[le+Ce]>1){const Ze=this.clusterProps[pe[le+$e]];return Ne?Object.assign({},Ze):Ze}const ze=this.points[pe[le+be]].properties,Ge=this.options.map(ze);return Ne&&Ge===ze?Object.assign({},Ge):Ge}}function jt(De,pe,le){return{type:"Feature",id:De[pe+be],properties:Me(De,pe,le),geometry:{type:"Point",coordinates:[(Ne=De[pe],360*(Ne-.5)),Ft(De[pe+1])]}};var Ne}function Me(De,pe,le){const Ne=De[pe+Ce],ze=Ne>=1e4?`${Math.round(Ne/1e3)}k`:Ne>=1e3?Math.round(Ne/100)/10+"k":Ne,Ge=De[pe+$e],Ze=Ge===-1?{}:Object.assign({},le[Ge]);return Object.assign(Ze,{cluster:!0,cluster_id:De[pe+be],point_count:Ne,point_count_abbreviated:ze})}function St(De){return De/360+.5}function Ct(De){const pe=Math.sin(De*Math.PI/180),le=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return le<0?0:le>1?1:le}function Ft(De){const pe=(180-360*De)*Math.PI/180;return 360*Math.atan(Math.exp(pe))/Math.PI-90}function gt(De,pe,le,Ne){for(var ze,Ge=Ne,Ze=le-pe>>1,Xe=le-pe,We=De[pe],it=De[pe+1],It=De[le],zt=De[le+1],vt=pe+3;vt<le;vt+=3){var xr=Zt(De[vt],De[vt+1],We,it,It,zt);if(xr>Ge)ze=vt,Ge=xr;else if(xr===Ge){var vr=Math.abs(vt-Ze);vr<Xe&&(ze=vt,Xe=vr)}}Ge>Ne&&(ze-pe>3&&gt(De,pe,ze,Ne),De[ze+2]=Ge,le-ze>3&&gt(De,ze,le,Ne))}function Zt(De,pe,le,Ne,ze,Ge){var Ze=ze-le,Xe=Ge-Ne;if(Ze!==0||Xe!==0){var We=((De-le)*Ze+(pe-Ne)*Xe)/(Ze*Ze+Xe*Xe);We>1?(le=ze,Ne=Ge):We>0&&(le+=Ze*We,Ne+=Xe*We)}return(Ze=De-le)*Ze+(Xe=pe-Ne)*Xe}function Tt(De,pe,le,Ne){var ze={id:De===void 0?null:De,type:pe,geometry:le,tags:Ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ge){var Ze=Ge.geometry,Xe=Ge.type;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")ot(Ge,Ze);else if(Xe==="Polygon"||Xe==="MultiLineString")for(var We=0;We<Ze.length;We++)ot(Ge,Ze[We]);else if(Xe==="MultiPolygon")for(We=0;We<Ze.length;We++)for(var it=0;it<Ze[We].length;it++)ot(Ge,Ze[We][it])}(ze),ze}function ot(De,pe){for(var le=0;le<pe.length;le+=3)De.minX=Math.min(De.minX,pe[le]),De.minY=Math.min(De.minY,pe[le+1]),De.maxX=Math.max(De.maxX,pe[le]),De.maxY=Math.max(De.maxY,pe[le+1])}function ar(De,pe,le,Ne){if(pe.geometry){var ze=pe.geometry.coordinates,Ge=pe.geometry.type,Ze=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),Xe=[],We=pe.id;if(le.promoteId?We=pe.properties[le.promoteId]:le.generateId&&(We=Ne||0),Ge==="Point")mt(ze,Xe);else if(Ge==="MultiPoint")for(var it=0;it<ze.length;it++)mt(ze[it],Xe);else if(Ge==="LineString")Lt(ze,Xe,Ze,!1);else if(Ge==="MultiLineString"){if(le.lineMetrics){for(it=0;it<ze.length;it++)Lt(ze[it],Xe=[],Ze,!1),De.push(Tt(We,"LineString",Xe,pe.properties));return}dr(ze,Xe,Ze,!1)}else if(Ge==="Polygon")dr(ze,Xe,Ze,!0);else{if(Ge!=="MultiPolygon"){if(Ge==="GeometryCollection"){for(it=0;it<pe.geometry.geometries.length;it++)ar(De,{id:We,geometry:pe.geometry.geometries[it],properties:pe.properties},le,Ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(it=0;it<ze.length;it++){var It=[];dr(ze[it],It,Ze,!0),Xe.push(It)}}De.push(Tt(We,Ge,Xe,pe.properties))}}function mt(De,pe){pe.push(Gr(De[0])),pe.push(qr(De[1])),pe.push(0)}function Lt(De,pe,le,Ne){for(var ze,Ge,Ze=0,Xe=0;Xe<De.length;Xe++){var We=Gr(De[Xe][0]),it=qr(De[Xe][1]);pe.push(We),pe.push(it),pe.push(0),Xe>0&&(Ze+=Ne?(ze*it-We*Ge)/2:Math.sqrt(Math.pow(We-ze,2)+Math.pow(it-Ge,2))),ze=We,Ge=it}var It=pe.length-3;pe[2]=1,gt(pe,0,It,le),pe[It+2]=1,pe.size=Math.abs(Ze),pe.start=0,pe.end=pe.size}function dr(De,pe,le,Ne){for(var ze=0;ze<De.length;ze++){var Ge=[];Lt(De[ze],Ge,le,Ne),pe.push(Ge)}}function Gr(De){return De/360+.5}function qr(De){var pe=Math.sin(De*Math.PI/180),le=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return le<0?0:le>1?1:le}function ln(De,pe,le,Ne,ze,Ge,Ze,Xe){if(Ne/=pe,Ge>=(le/=pe)&&Ze<Ne)return De;if(Ze<le||Ge>=Ne)return null;for(var We=[],it=0;it<De.length;it++){var It=De[it],zt=It.geometry,vt=It.type,xr=ze===0?It.minX:It.minY,vr=ze===0?It.maxX:It.maxY;if(xr>=le&&vr<Ne)We.push(It);else if(!(vr<le||xr>=Ne)){var mr=[];if(vt==="Point"||vt==="MultiPoint")Ui(zt,mr,le,Ne,ze);else if(vt==="LineString")ht(zt,mr,le,Ne,ze,!1,Xe.lineMetrics);else if(vt==="MultiLineString")tr(zt,mr,le,Ne,ze,!1);else if(vt==="Polygon")tr(zt,mr,le,Ne,ze,!0);else if(vt==="MultiPolygon")for(var Pr=0;Pr<zt.length;Pr++){var $r=[];tr(zt[Pr],$r,le,Ne,ze,!0),$r.length&&mr.push($r)}if(mr.length){if(Xe.lineMetrics&&vt==="LineString"){for(Pr=0;Pr<mr.length;Pr++)We.push(Tt(It.id,vt,mr[Pr],It.tags));continue}vt!=="LineString"&&vt!=="MultiLineString"||(mr.length===1?(vt="LineString",mr=mr[0]):vt="MultiLineString"),vt!=="Point"&&vt!=="MultiPoint"||(vt=mr.length===3?"Point":"MultiPoint"),We.push(Tt(It.id,vt,mr,It.tags))}}}return We.length?We:null}function Ui(De,pe,le,Ne,ze){for(var Ge=0;Ge<De.length;Ge+=3){var Ze=De[Ge+ze];Ze>=le&&Ze<=Ne&&(pe.push(De[Ge]),pe.push(De[Ge+1]),pe.push(De[Ge+2]))}}function ht(De,pe,le,Ne,ze,Ge,Ze){for(var Xe,We,it=Jt(De),It=ze===0?yr:In,zt=De.start,vt=0;vt<De.length-3;vt+=3){var xr=De[vt],vr=De[vt+1],mr=De[vt+2],Pr=De[vt+3],$r=De[vt+4],nn=ze===0?xr:vr,Yn=ze===0?Pr:$r,qi=!1;Ze&&(Xe=Math.sqrt(Math.pow(xr-Pr,2)+Math.pow(vr-$r,2))),nn<le?Yn>le&&(We=It(it,xr,vr,Pr,$r,le),Ze&&(it.start=zt+Xe*We)):nn>Ne?Yn<Ne&&(We=It(it,xr,vr,Pr,$r,Ne),Ze&&(it.start=zt+Xe*We)):zr(it,xr,vr,mr),Yn<le&&nn>=le&&(We=It(it,xr,vr,Pr,$r,le),qi=!0),Yn>Ne&&nn<=Ne&&(We=It(it,xr,vr,Pr,$r,Ne),qi=!0),!Ge&&qi&&(Ze&&(it.end=zt+Xe*We),pe.push(it),it=Jt(De)),Ze&&(zt+=Xe)}var zn=De.length-3;xr=De[zn],vr=De[zn+1],mr=De[zn+2],(nn=ze===0?xr:vr)>=le&&nn<=Ne&&zr(it,xr,vr,mr),zn=it.length-3,Ge&&zn>=3&&(it[zn]!==it[0]||it[zn+1]!==it[1])&&zr(it,it[0],it[1],it[2]),it.length&&pe.push(it)}function Jt(De){var pe=[];return pe.size=De.size,pe.start=De.start,pe.end=De.end,pe}function tr(De,pe,le,Ne,ze,Ge){for(var Ze=0;Ze<De.length;Ze++)ht(De[Ze],pe,le,Ne,ze,Ge,!1)}function zr(De,pe,le,Ne){De.push(pe),De.push(le),De.push(Ne)}function yr(De,pe,le,Ne,ze,Ge){var Ze=(Ge-pe)/(Ne-pe);return De.push(Ge),De.push(le+(ze-le)*Ze),De.push(1),Ze}function In(De,pe,le,Ne,ze,Ge){var Ze=(Ge-le)/(ze-le);return De.push(pe+(Ne-pe)*Ze),De.push(Ge),De.push(1),Ze}function Cr(De,pe){for(var le=[],Ne=0;Ne<De.length;Ne++){var ze,Ge=De[Ne],Ze=Ge.type;if(Ze==="Point"||Ze==="MultiPoint"||Ze==="LineString")ze=hn(Ge.geometry,pe);else if(Ze==="MultiLineString"||Ze==="Polygon"){ze=[];for(var Xe=0;Xe<Ge.geometry.length;Xe++)ze.push(hn(Ge.geometry[Xe],pe))}else if(Ze==="MultiPolygon")for(ze=[],Xe=0;Xe<Ge.geometry.length;Xe++){for(var We=[],it=0;it<Ge.geometry[Xe].length;it++)We.push(hn(Ge.geometry[Xe][it],pe));ze.push(We)}le.push(Tt(Ge.id,Ze,ze,Ge.tags))}return le}function hn(De,pe){var le=[];le.size=De.size,De.start!==void 0&&(le.start=De.start,le.end=De.end);for(var Ne=0;Ne<De.length;Ne+=3)le.push(De[Ne]+pe,De[Ne+1],De[Ne+2]);return le}function fs(De,pe){if(De.transformed)return De;var le,Ne,ze,Ge=1<<De.z,Ze=De.x,Xe=De.y;for(le=0;le<De.features.length;le++){var We=De.features[le],it=We.geometry,It=We.type;if(We.geometry=[],It===1)for(Ne=0;Ne<it.length;Ne+=2)We.geometry.push(ps(it[Ne],it[Ne+1],pe,Ge,Ze,Xe));else for(Ne=0;Ne<it.length;Ne++){var zt=[];for(ze=0;ze<it[Ne].length;ze+=2)zt.push(ps(it[Ne][ze],it[Ne][ze+1],pe,Ge,Ze,Xe));We.geometry.push(zt)}}return De.transformed=!0,De}function ps(De,pe,le,Ne,ze,Ge){return[Math.round(le*(De*Ne-ze)),Math.round(le*(pe*Ne-Ge))]}function Os(De,pe,le,Ne,ze){for(var Ge=pe===ze.maxZoom?0:ze.tolerance/((1<<pe)*ze.extent),Ze={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:Ne,z:pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Xe=0;Xe<De.length;Xe++){Ze.numFeatures++,Do(Ze,De[Xe],Ge,ze);var We=De[Xe].minX,it=De[Xe].minY,It=De[Xe].maxX,zt=De[Xe].maxY;We<Ze.minX&&(Ze.minX=We),it<Ze.minY&&(Ze.minY=it),It>Ze.maxX&&(Ze.maxX=It),zt>Ze.maxY&&(Ze.maxY=zt)}return Ze}function Do(De,pe,le,Ne){var ze=pe.geometry,Ge=pe.type,Ze=[];if(Ge==="Point"||Ge==="MultiPoint")for(var Xe=0;Xe<ze.length;Xe+=3)Ze.push(ze[Xe]),Ze.push(ze[Xe+1]),De.numPoints++,De.numSimplified++;else if(Ge==="LineString")va(Ze,ze,De,le,!1,!1);else if(Ge==="MultiLineString"||Ge==="Polygon")for(Xe=0;Xe<ze.length;Xe++)va(Ze,ze[Xe],De,le,Ge==="Polygon",Xe===0);else if(Ge==="MultiPolygon")for(var We=0;We<ze.length;We++){var it=ze[We];for(Xe=0;Xe<it.length;Xe++)va(Ze,it[Xe],De,le,!0,Xe===0)}if(Ze.length){var It=pe.tags||null;if(Ge==="LineString"&&Ne.lineMetrics){for(var zt in It={},pe.tags)It[zt]=pe.tags[zt];It.mapbox_clip_start=ze.start/ze.size,It.mapbox_clip_end=ze.end/ze.size}var vt={geometry:Ze,type:Ge==="Polygon"||Ge==="MultiPolygon"?3:Ge==="LineString"||Ge==="MultiLineString"?2:1,tags:It};pe.id!==null&&(vt.id=pe.id),De.features.push(vt)}}function va(De,pe,le,Ne,ze,Ge){var Ze=Ne*Ne;if(Ne>0&&pe.size<(ze?Ze:Ne))le.numPoints+=pe.length/3;else{for(var Xe=[],We=0;We<pe.length;We+=3)(Ne===0||pe[We+2]>Ze)&&(le.numSimplified++,Xe.push(pe[We]),Xe.push(pe[We+1])),le.numPoints++;ze&&function(it,It){for(var zt=0,vt=0,xr=it.length,vr=xr-2;vt<xr;vr=vt,vt+=2)zt+=(it[vt]-it[vr])*(it[vt+1]+it[vr+1]);if(zt>0===It)for(vt=0,xr=it.length;vt<xr/2;vt+=2){var mr=it[vt],Pr=it[vt+1];it[vt]=it[xr-2-vt],it[vt+1]=it[xr-1-vt],it[xr-2-vt]=mr,it[xr-1-vt]=Pr}}(Xe,Ge),De.push(Xe)}}function qa(De,pe){var le=(pe=this.options=function(ze,Ge){for(var Ze in Ge)ze[Ze]=Ge[Ze];return ze}(Object.create(this.options),pe)).debug;if(le&&console.time("preprocess data"),pe.maxZoom<0||pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pe.promoteId&&pe.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ne=function(ze,Ge){var Ze=[];if(ze.type==="FeatureCollection")for(var Xe=0;Xe<ze.features.length;Xe++)ar(Ze,ze.features[Xe],Ge,Xe);else ar(Ze,ze.type==="Feature"?ze:{geometry:ze},Ge);return Ze}(De,pe);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pe.indexMaxZoom,pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ne=function(ze,Ge){var Ze=Ge.buffer/Ge.extent,Xe=ze,We=ln(ze,1,-1-Ze,Ze,0,-1,2,Ge),it=ln(ze,1,1-Ze,2+Ze,0,-1,2,Ge);return(We||it)&&(Xe=ln(ze,1,-Ze,1+Ze,0,-1,2,Ge)||[],We&&(Xe=Cr(We,1).concat(Xe)),it&&(Xe=Xe.concat(Cr(it,-1)))),Xe}(Ne,pe),Ne.length&&this.splitTile(Ne,0,0,0),le&&(Ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ms(De,pe,le){return 32*((1<<De)*le+pe)+De}function Ga(De,pe){const le=De.tileID.canonical;if(!this._geoJSONIndex)return pe(null,null);const Ne=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!Ne)return pe(null,null);const ze=new class{constructor(Ze){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=Ze.length,this._features=Ze}feature(Ze){return new class{constructor(Xe){this._feature=Xe,this.extent=a.EXTENT,this.type=Xe.type,this.properties=Xe.tags,"id"in Xe&&!isNaN(Xe.id)&&(this.id=parseInt(Xe.id,10))}loadGeometry(){if(this._feature.type===1){const Xe=[];for(const We of this._feature.geometry)Xe.push([new a.Point(We[0],We[1])]);return Xe}{const Xe=[];for(const We of this._feature.geometry){const it=[];for(const It of We)it.push(new a.Point(It[0],It[1]));Xe.push(it)}return Xe}}toGeoJSON(Xe,We,it){return P.call(this,Xe,We,it)}}(this._features[Ze])}}(Ne.features);let Ge=ae(ze);Ge.byteOffset===0&&Ge.byteLength===Ge.buffer.byteLength||(Ge=new Uint8Array(Ge)),pe(null,{vectorTile:ze,rawData:Ge.buffer})}qa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},qa.prototype.splitTile=function(De,pe,le,Ne,ze,Ge,Ze){for(var Xe=[De,pe,le,Ne],We=this.options,it=We.debug;Xe.length;){Ne=Xe.pop(),le=Xe.pop(),pe=Xe.pop(),De=Xe.pop();var It=1<<pe,zt=ms(pe,le,Ne),vt=this.tiles[zt];if(!vt&&(it>1&&console.time("creation"),vt=this.tiles[zt]=Os(De,pe,le,Ne,We),this.tileCoords.push({z:pe,x:le,y:Ne}),it)){it>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pe,le,Ne,vt.numFeatures,vt.numPoints,vt.numSimplified),console.timeEnd("creation"));var xr="z"+pe;this.stats[xr]=(this.stats[xr]||0)+1,this.total++}if(vt.source=De,ze){if(pe===We.maxZoom||pe===ze)continue;var vr=1<<ze-pe;if(le!==Math.floor(Ge/vr)||Ne!==Math.floor(Ze/vr))continue}else if(pe===We.indexMaxZoom||vt.numPoints<=We.indexMaxPoints)continue;if(vt.source=null,De.length!==0){it>1&&console.time("clipping");var mr,Pr,$r,nn,Yn,qi,zn=.5*We.buffer/We.extent,gs=.5-zn,li=.5+zn,Pi=1+zn;mr=Pr=$r=nn=null,Yn=ln(De,It,le-zn,le+li,0,vt.minX,vt.maxX,We),qi=ln(De,It,le+gs,le+Pi,0,vt.minX,vt.maxX,We),De=null,Yn&&(mr=ln(Yn,It,Ne-zn,Ne+li,1,vt.minY,vt.maxY,We),Pr=ln(Yn,It,Ne+gs,Ne+Pi,1,vt.minY,vt.maxY,We),Yn=null),qi&&($r=ln(qi,It,Ne-zn,Ne+li,1,vt.minY,vt.maxY,We),nn=ln(qi,It,Ne+gs,Ne+Pi,1,vt.minY,vt.maxY,We),qi=null),it>1&&console.timeEnd("clipping"),Xe.push(mr||[],pe+1,2*le,2*Ne),Xe.push(Pr||[],pe+1,2*le,2*Ne+1),Xe.push($r||[],pe+1,2*le+1,2*Ne),Xe.push(nn||[],pe+1,2*le+1,2*Ne+1)}}},qa.prototype.getTile=function(De,pe,le){var Ne=this.options,ze=Ne.extent,Ge=Ne.debug;if(De<0||De>24)return null;var Ze=1<<De,Xe=ms(De,pe=(pe%Ze+Ze)%Ze,le);if(this.tiles[Xe])return fs(this.tiles[Xe],ze);Ge>1&&console.log("drilling down to z%d-%d-%d",De,pe,le);for(var We,it=De,It=pe,zt=le;!We&&it>0;)it--,It=Math.floor(It/2),zt=Math.floor(zt/2),We=this.tiles[ms(it,It,zt)];return We&&We.source?(Ge>1&&console.log("found parent tile z%d-%d-%d",it,It,zt),Ge>1&&console.time("drilling down"),this.splitTile(We.source,it,It,zt,De,pe,le),Ge>1&&console.timeEnd("drilling down"),this.tiles[Xe]?fs(this.tiles[Xe],ze):null):null};class oo extends a.VectorTileWorkerSource{constructor(pe,le,Ne,ze,Ge){super(pe,le,Ne,ze,Ga),Ge&&(this.loadGeoJSON=Ge)}loadData(pe,le){const Ne=pe&&pe.request,ze=Ne&&Ne.collectResourceTiming;this.loadGeoJSON(pe,(Ge,Ze)=>{if(Ge||!Ze)return le(Ge);if(typeof Ze!="object")return le(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));{I(Ze,!0);try{if(pe.filter){const We=a.createExpression(pe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(We.result==="error")throw new Error(We.value.map(It=>`${It.key}: ${It.message}`).join(", "));Ze={type:"FeatureCollection",features:Ze.features.filter(It=>We.value.evaluate({zoom:0},It))}}this._geoJSONIndex=pe.cluster?new Ye(function({superclusterOptions:We,clusterProperties:it}){if(!it||!We)return We;const It={},zt={},vt={accumulated:null,zoom:0},xr={properties:null},vr=Object.keys(it);for(const mr of vr){const[Pr,$r]=it[mr],nn=a.createExpression($r),Yn=a.createExpression(typeof Pr=="string"?[Pr,["accumulated"],["get",mr]]:Pr);It[mr]=nn.value,zt[mr]=Yn.value}return We.map=mr=>{xr.properties=mr;const Pr={};for(const $r of vr)Pr[$r]=It[$r].evaluate(vt,xr);return Pr},We.reduce=(mr,Pr)=>{xr.properties=Pr;for(const $r of vr)vt.accumulated=mr[$r],mr[$r]=zt[$r].evaluate(vt,xr)},We}(pe)).load(Ze.features):function(We,it){return new qa(We,it)}(Ze,pe.geojsonVtOptions)}catch(We){return le(We)}this.loaded={};const Xe={};if(ze){const We=a.getPerformanceMeasurement(Ne);We&&(Xe.resourceTiming={},Xe.resourceTiming[pe.source]=JSON.parse(JSON.stringify(We)))}le(null,Xe)}})}reloadTile(pe,le){const Ne=this.loaded;return Ne&&Ne[pe.uid]?super.reloadTile(pe,le):this.loadTile(pe,le)}loadGeoJSON(pe,le){if(pe.request)a.getJSON(pe.request,le);else{if(typeof pe.data!="string")return le(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));try{return le(null,JSON.parse(pe.data))}catch{return le(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(pe,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(pe.clusterId))}catch(Ne){le(Ne)}}getClusterChildren(pe,le){try{le(null,this._geoJSONIndex.getChildren(pe.clusterId))}catch(Ne){le(Ne)}}getClusterLeaves(pe,le){try{le(null,this._geoJSONIndex.getLeaves(pe.clusterId,pe.limit,pe.offset))}catch(Ne){le(Ne)}}}class _l{constructor(pe){this.self=pe,this.actor=new a.Actor(pe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:oo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(le,Ne)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=Ne},this.self.registerRTLTextPlugin=le=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=le.applyArabicShaping,a.plugin.processBidirectionalText=le.processBidirectionalText,a.plugin.processStyledBidirectionalText=le.processStyledBidirectionalText}}clearCaches(pe,le,Ne){delete this.layerIndexes[pe],delete this.availableImages[pe],delete this.workerSources[pe],delete this.demWorkerSources[pe],Ne()}checkIfReady(pe,le,Ne){Ne()}setReferrer(pe,le){this.referrer=le}spriteLoaded(pe,le){this.isSpriteLoaded[pe]=le;for(const Ne in this.workerSources[pe]){const ze=this.workerSources[pe][Ne];for(const Ge in ze)ze[Ge]instanceof a.VectorTileWorkerSource&&(ze[Ge].isSpriteLoaded=le,ze[Ge].fire(new a.Event("isSpriteLoaded")))}}setImages(pe,le,Ne){this.availableImages[pe]=le;for(const ze in this.workerSources[pe]){const Ge=this.workerSources[pe][ze];for(const Ze in Ge)Ge[Ze].availableImages=le}Ne()}enableTerrain(pe,le,Ne){this.terrain=le,Ne()}setProjection(pe,le){this.projections[pe]=a.getProjection(le)}setLayers(pe,le,Ne){this.getLayerIndex(pe).replace(le),Ne()}updateLayers(pe,le,Ne){this.getLayerIndex(pe).update(le.layers,le.removedIds),Ne()}loadTile(pe,le,Ne){const ze=this.enableTerrain?a.extend({enableTerrain:this.terrain},le):le;ze.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,le.type,le.source).loadTile(ze,Ne)}loadDEMTile(pe,le,Ne){const ze=this.enableTerrain?a.extend({buildQuadTree:this.terrain},le):le;this.getDEMWorkerSource(pe,le.source).loadTile(ze,Ne)}reloadTile(pe,le,Ne){const ze=this.enableTerrain?a.extend({enableTerrain:this.terrain},le):le;ze.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,le.type,le.source).reloadTile(ze,Ne)}abortTile(pe,le,Ne){this.getWorkerSource(pe,le.type,le.source).abortTile(le,Ne)}removeTile(pe,le,Ne){this.getWorkerSource(pe,le.type,le.source).removeTile(le,Ne)}removeSource(pe,le,Ne){if(!this.workerSources[pe]||!this.workerSources[pe][le.type]||!this.workerSources[pe][le.type][le.source])return;const ze=this.workerSources[pe][le.type][le.source];delete this.workerSources[pe][le.type][le.source],ze.removeSource!==void 0?ze.removeSource(le,Ne):Ne()}loadWorkerSource(pe,le,Ne){try{this.self.importScripts(le.url),Ne()}catch(ze){Ne(ze.toString())}}syncRTLPluginState(pe,le,Ne){try{a.plugin.setState(le);const ze=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&ze!=null){this.self.importScripts(ze);const Ge=a.plugin.isParsed();Ne(Ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ze}`),Ge)}}catch(ze){Ne(ze.toString())}}getAvailableImages(pe){let le=this.availableImages[pe];return le||(le=[]),le}getLayerIndex(pe){let le=this.layerIndexes[pe];return le||(le=this.layerIndexes[pe]=new v),le}getWorkerSource(pe,le,Ne){if(this.workerSources[pe]||(this.workerSources[pe]={}),this.workerSources[pe][le]||(this.workerSources[pe][le]={}),!this.workerSources[pe][le][Ne]){const ze={send:(Ge,Ze,Xe,We,it,It)=>{this.actor.send(Ge,Ze,Xe,pe,it,It)},scheduler:this.actor.scheduler};this.workerSources[pe][le][Ne]=new this.workerSourceTypes[le](ze,this.getLayerIndex(pe),this.getAvailableImages(pe),this.isSpriteLoaded[pe])}return this.workerSources[pe][le][Ne]}getDEMWorkerSource(pe,le){return this.demWorkerSources[pe]||(this.demWorkerSources[pe]={}),this.demWorkerSources[pe][le]||(this.demWorkerSources[pe][le]=new w),this.demWorkerSources[pe][le]}enforceCacheSizeLimit(pe,le){a.enforceCacheSizeLimit(le)}getWorkerPerformanceMetrics(pe,le,Ne){Ne(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new _l(self)),_l}),o(["./shared"],function(a){function p(x,h){if(Array.isArray(x)){if(!Array.isArray(h)||x.length!==h.length)return!1;for(let m=0;m<x.length;m++)if(!p(x[m],h[m]))return!1;return!0}if(typeof x=="object"&&x!==null&&h!==null){if(typeof h!="object"||Object.keys(x).length!==Object.keys(h).length)return!1;for(const m in x)if(!p(x[m],h[m]))return!1;return!0}return x===h}var g=v;function v(x){return!function(h){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,S,j=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(j);try{S=new Worker(R),b=!0}catch{b=!1}return S&&S.terminate(),URL.revokeObjectURL(R),b}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var b=document.createElement("canvas");b.width=b.height=1;var S=b.getContext("2d");if(!S)return!1;var j=S.getImageData(0,0,1,1);return j&&j.width===b.width}()?(w[m=h&&h.failIfMajorPerformanceCaveat]===void 0&&(w[m]=function(b){var S,j=function(R){var z=document.createElement("canvas"),U=Object.create(v.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=R,z.getContext("webgl",U)||z.getContext("experimental-webgl",U)}(b);if(!j)return!1;try{S=j.createShader(j.VERTEX_SHADER)}catch{return!1}return!(!S||j.isContextLost())&&(j.shaderSource(S,"void main() {}"),j.compileShader(S),j.getShaderParameter(S,j.COMPILE_STATUS)===!0)}(m)),w[m]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}(x)}var w={};function T(x,h,m){const b=a.window.document.createElement(x);return h!==void 0&&(b.className=h),m&&m.appendChild(b),b}function A(x,h,m){const b=a.window.document.createElementNS("http://www.w3.org/2000/svg",x);for(const S of Object.keys(h))b.setAttributeNS(null,S,h[S]);return m&&m.appendChild(b),b}v.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const I=a.window.document&&a.window.document.documentElement.style,P=I&&I.userSelect!==void 0?"userSelect":"WebkitUserSelect";let D;function L(){I&&P&&(D=I[P],I[P]="none")}function O(){I&&P&&(I[P]=D)}function $(x){x.preventDefault(),x.stopPropagation(),a.window.removeEventListener("click",$,!0)}function G(){a.window.addEventListener("click",$,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",$,!0)},0)}function B(x,h){const m=x.getBoundingClientRect();return H(x,m,h)}function J(x,h){const m=x.getBoundingClientRect(),b=[];for(let S=0;S<h.length;S++)b.push(H(x,m,h[S]));return b}function W(x){return a.window.InstallTrigger!==void 0&&x.button===2&&x.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:x.button}function H(x,h,m){const b=x.offsetWidth===h.width?1:x.offsetWidth/h.width;return new a.Point((m.clientX-h.left)*b,(m.clientY-h.top)*b)}function V(x,h){var m=h[0],b=h[1],S=h[2],j=h[3],R=m*j-S*b;return R?(x[0]=j*(R=1/R),x[1]=-b*R,x[2]=-S*R,x[3]=m*R,x):null}function se(x){const{userImage:h}=x;return!!(h&&h.render&&h.render())&&(x.data.replace(new Uint8Array(h.data.buffer)),!0)}class K extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(h){if(this.loaded!==h&&(this.loaded=h,h)){for(const{ids:m,callback:b}of this.requestors)this._notify(m,b);this.requestors=[]}}hasImage(h){return!!this.getImage(h)}getImage(h){return this.images[h]}addImage(h,m){this._validate(h,m)&&(this.images[h]=m)}_validate(h,m){let b=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${h}" has invalid "stretchX" value`))),b=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${h}" has invalid "stretchY" value`))),b=!1),this._validateContent(m.content,m)||(this.fire(new a.ErrorEvent(new Error(`Image "${h}" has invalid "content" value`))),b=!1),b}_validateStretch(h,m){if(!h)return!0;let b=0;for(const S of h){if(S[0]<b||S[1]<S[0]||m<S[1])return!1;b=S[1]}return!0}_validateContent(h,m){return!(h&&(h.length!==4||h[0]<0||m.data.width<h[0]||h[1]<0||m.data.height<h[1]||h[2]<0||m.data.width<h[2]||h[3]<0||m.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))}updateImage(h,m){m.version=this.images[h].version+1,this.images[h]=m,this.updatedImages[h]=!0}removeImage(h){const m=this.images[h];delete this.images[h],delete this.patterns[h],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(h,m){let b=!0;if(!this.isLoaded())for(const S of h)this.images[S]||(b=!1);this.isLoaded()||b?this._notify(h,m):this.requestors.push({ids:h,callback:m})}_notify(h,m){const b={};for(const S of h){this.images[S]||this.fire(new a.Event("styleimagemissing",{id:S}));const j=this.images[S];j?b[S]={data:j.data.clone(),pixelRatio:j.pixelRatio,sdf:j.sdf,version:j.version,stretchX:j.stretchX,stretchY:j.stretchY,content:j.content,hasRenderCallback:!!(j.userImage&&j.userImage.render)}:a.warnOnce(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,b)}getPixelSize(){const{width:h,height:m}=this.atlasImage;return{width:h,height:m}}getPattern(h){const m=this.patterns[h],b=this.getImage(h);if(!b)return null;if(m&&m.position.version===b.version)return m.position;if(m)m.position.version=b.version;else{const S={w:b.data.width+2,h:b.data.height+2,x:0,y:0},j=new a.ImagePosition(S,b);this.patterns[h]={bin:S,position:j}}return this._updatePatternAtlas(),this.patterns[h].position}bind(h){const m=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(h,this.atlasImage,m.RGBA),this.atlasTexture&&this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const h=[];for(const j in this.patterns)h.push(this.patterns[j].bin);const{w:m,h:b}=a.potpack(h),S=this.atlasImage;S.resize({width:m||1,height:b||1});for(const j in this.patterns){const{bin:R}=this.patterns[j],z=R.x+1,U=R.y+1,ee=this.images[j].data,Q=ee.width,ue=ee.height;a.RGBAImage.copy(ee,S,{x:0,y:0},{x:z,y:U},{width:Q,height:ue}),a.RGBAImage.copy(ee,S,{x:0,y:ue-1},{x:z,y:U-1},{width:Q,height:1}),a.RGBAImage.copy(ee,S,{x:0,y:0},{x:z,y:U+ue},{width:Q,height:1}),a.RGBAImage.copy(ee,S,{x:Q-1,y:0},{x:z-1,y:U},{width:1,height:ue}),a.RGBAImage.copy(ee,S,{x:0,y:0},{x:z+Q,y:U},{width:1,height:ue})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(h){for(const m of h){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const b=this.images[m];se(b)&&this.updateImage(m,b)}}}const ce=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(x,h){return function([m,b,S]){const j=a.degToRad(b+90),R=a.degToRad(S);return{x:m*Math.cos(j)*Math.sin(R),y:m*Math.sin(j)*Math.sin(R),z:m*Math.cos(R),azimuthal:b,polar:S}}(x.expression.evaluate(h))}interpolate(x,h,m){return{x:a.number(x.x,h.x,m),y:a.number(x.y,h.y,m),z:a.number(x.z,h.z,m),azimuthal:a.number(x.azimuthal,h.azimuthal,m),polar:a.number(x.polar,h.polar,m)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)});class ne extends a.Evented{constructor(h){super(),this._transitionable=new a.Transitionable(ce),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(h,m={}){if(!this._validate(a.validateLight,h,m))for(const b in h){const S=h[b];a.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-11),S):this._transitionable.setValue(b,S)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,m,b){return(!b||b.validate!==!1)&&a.emitValidationErrors(this,h.call(a.validateStyle,a.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const re=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)});let oe=class extends a.Evented{constructor(x,h){super(),this._transitionable=new a.Transitionable(re),this.set(x),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=h}get(){return this._transitionable.serialize()}set(x){for(const h in x){const m=x[h];a.endsWith(h,"-transition")?this._transitionable.setTransition(h.slice(0,-11),m):this._transitionable.setValue(h,m)}}updateTransitions(x){this._transitioning=this._transitionable.transitioned(x,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(x){this.properties=this._transitioning.possiblyEvaluate(x)}};function ae(x,h,m,b){const S=a.smoothstep(45,65,m),[j,R]=xe(x,b),z=a.length(h);let U=1-Math.min(1,Math.exp((z-j)/(R-j)*-6));return U*=U*U,U=Math.min(1,1.00747*U),U*S*x.alpha}function xe(x,h){const m=.5/Math.tan(.5*h);return[x.range[0]+m,x.range[1]+m]}const ye=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])});class Se extends a.Evented{constructor(h,m){super(),this._transitionable=new a.Transitionable(ye),this.set(h),this._transitioning=this._transitionable.untransitioned(),this._transform=m}get state(){const h=this._transform,m=h.projection.name==="globe",b=a.globeToMercatorTransition(h.zoom),S=this.properties.get("range"),j=[.5,3];return{range:m?[a.number(j[0],S[0],b),a.number(j[1],S[1],b)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(h,m={}){if(!this._validate(a.validateFog,h,m)){for(const b of Object.keys(a.spec.fog))h&&h[b]===void 0&&(h[b]=a.spec.fog[b].default);for(const b in h){const S=h[b];a.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-11),S):this._transitionable.setValue(b,S)}}}getOpacity(h){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.smoothstep(45,65,h))*m.a}getOpacityAtLatLng(h,m){return this._transform.projection.supportsFog?function(b,S,j){const R=a.MercatorCoordinate.fromLngLat(S),z=j.elevation?j.elevation.getAtPointOrZero(R):0,U=[R.x,R.y,z];return a.transformMat4(U,U,j.mercatorFogMatrix),ae(b,U,j.pitch,j._fov)}(this.state,h,m):0}getFovAdjustedRange(h){return this._transform.projection.supportsFog?xe(this.state,h):[0,1]}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,m,b){return(!b||b.validate!==!1)&&a.emitValidationErrors(this,h.call(a.validateStyle,a.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class be{constructor(h,m){this.workerPool=h,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const b=this.workerPool.acquire(this.id);for(let S=0;S<b.length;S++){const j=new be.Actor(b[S],m,this.id);j.name=`Worker ${S}`,this.actors.push(j)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(h,m,b){a.asyncAll(this.actors,(S,j)=>{S.send(h,m,j)},b=b||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(h=>{h.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ce(x,h,m){return h*(a.EXTENT/(x.tileSize*Math.pow(2,m-x.tileID.overscaledZ)))}be.Actor=a.Actor;class $e{constructor(h,m,b,S){this.screenBounds=h,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=b,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(h,m){let b,S;if(h instanceof a.Point||typeof h[0]=="number"){const j=a.Point.convert(h);b=[j],S=m.isPointAboveHorizon(j)}else{const j=a.Point.convert(h[0]),R=a.Point.convert(h[1]);b=[j,R],S=a.polygonizeBounds(j,R).every(z=>m.isPointAboveHorizon(z))}return new $e(b,m.getCameraPoint(),S,m)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(h){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],h)}bufferedCameraGeometry(h){const m=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],S=a.polygonizeBounds(m,b,0,!1);return this.cameraPoint.y>b.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<b.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=b.x?S[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(S[3]=this.cameraPoint)),a.bufferConvexPolygon(S,h)}bufferedCameraGeometryGlobe(h){const m=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],S=a.polygonizeBounds(m,b,h),j=this.cameraPoint.clone();switch(3*((j.y>m.y)+(j.y>b.y))+((j.x>m.x)+(j.x>b.x))){case 0:S[0]=j,S[4]=j.clone();break;case 1:S.splice(1,0,j);break;case 2:S[1]=j;break;case 3:S.splice(4,0,j);break;case 5:S.splice(2,0,j);break;case 6:S[3]=j;break;case 7:S.splice(3,0,j);break;case 8:S[2]=j}return S}containsTile(h,m,b,S=0){const j=h.queryPadding/m._pixelsPerMercatorPixel+1,R=b?this._bufferedCameraMercator(j,m):this._bufferedScreenMercator(j,m);let z=h.tileID.wrap+(R.unwrapped?S:0);const U=R.polygon.map(Ee=>a.getTilePoint(h.tileTransform,Ee,z));if(!a.polygonIntersectsBox(U,0,0,a.EXTENT,a.EXTENT))return;z=h.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const ee=this.screenGeometryMercator.polygon.map(Ee=>a.getTileVec3(h.tileTransform,Ee,z)),Q=ee.map(Ee=>new a.Point(Ee[0],Ee[1])),ue=m.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),me=a.getTileVec3(h.tileTransform,ue,z),_e=ee.map(Ee=>{const he=a.sub(Ee,Ee,me);return a.normalize(he,he),new a.Ray(me,he)}),Te=Ce(h,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Q,tilespaceRays:_e,bufferedTilespaceGeometry:U,bufferedTilespaceBounds:(we=a.getBounds(U),we.min.x=a.clamp(we.min.x,0,a.EXTENT),we.min.y=a.clamp(we.min.y,0,a.EXTENT),we.max.x=a.clamp(we.max.x,0,a.EXTENT),we.max.y=a.clamp(we.max.y,0,a.EXTENT),we),tile:h,tileID:h.tileID,pixelToTileUnitsFactor:Te};var we}_bufferedScreenMercator(h,m){const b=Me(h);if(this._screenRaycastCache[b])return this._screenRaycastCache[b];{let S;return S=m.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(h),m):{polygon:this.bufferedScreenGeometry(h).map(j=>m.pointCoordinate3D(j)),unwrapped:!0},this._screenRaycastCache[b]=S,S}}_bufferedCameraMercator(h,m){const b=Me(h);if(this._cameraRaycastCache[b])return this._cameraRaycastCache[b];{let S;return S=m.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(h),m):{polygon:this.bufferedCameraGeometry(h).map(j=>m.pointCoordinate3D(j)),unwrapped:!0},this._cameraRaycastCache[b]=S,S}}_projectAndResample(h,m){const b=function(j,R){const z=a.multiply([],R.pixelMatrix,R.globeMatrix),U=[0,-a.GLOBE_RADIUS,0,1],ee=[0,a.GLOBE_RADIUS,0,1],Q=[0,0,0,1];a.transformMat4$1(U,U,z),a.transformMat4$1(ee,ee,z),a.transformMat4$1(Q,Q,z);const ue=new a.Point(U[0]/U[3],U[1]/U[3]),me=new a.Point(ee[0]/ee[3],ee[1]/ee[3]),_e=a.polygonContainsPoint(j,ue)&&U[3]<Q[3],Te=a.polygonContainsPoint(j,me)&&ee[3]<Q[3];if(!_e&&!Te)return null;const we=function(Ue,Ke,He){for(let rt=1;rt<Ue.length;rt++){const At=jt(Ke.pointCoordinate3D(Ue[rt-1]).x),Je=jt(Ke.pointCoordinate3D(Ue[rt]).x);if(He<0){if(At<Je)return{idx:rt,t:-At/(Je-1-At)}}else if(Je<At)return{idx:rt,t:(1-At)/(Je+1-At)}}return null}(j,R,_e?-1:1);if(!we)return null;const{idx:Ee,t:he}=we;let ve=Ee>1?Ye(j.slice(0,Ee),R):[],Pe=Ee<j.length?Ye(j.slice(Ee),R):[];ve=ve.map(Ue=>new a.Point(jt(Ue.x),Ue.y)),Pe=Pe.map(Ue=>new a.Point(jt(Ue.x),Ue.y));const Ie=[...ve];Ie.length===0&&Ie.push(Pe[Pe.length-1]);const Ve=a.number(Ie[Ie.length-1].y,(Pe.length===0?ve[0]:Pe[0]).y,he);let qe;return qe=_e?[new a.Point(0,Ve),new a.Point(0,0),new a.Point(1,0),new a.Point(1,Ve)]:[new a.Point(1,Ve),new a.Point(1,1),new a.Point(0,1),new a.Point(0,Ve)],Ie.push(...qe),Pe.length===0?Ie.push(ve[0]):Ie.push(...Pe),{polygon:Ie.map(Ue=>new a.MercatorCoordinate(Ue.x,Ue.y)),unwrapped:!1}}(h,m);if(b)return b;const S=function(j,R){let z=!1,U=-1/0,ee=0;for(let ue=0;ue<j.length-1;ue++)j[ue].x>U&&(U=j[ue].x,ee=ue);for(let ue=0;ue<j.length-1;ue++){const me=(ee+ue)%(j.length-1),_e=j[me],Te=j[me+1];Math.abs(_e.x-Te.x)>.5&&(_e.x<Te.x?(_e.x+=1,me===0&&(j[j.length-1].x+=1)):(Te.x+=1,me+1===j.length-1&&(j[0].x+=1)),z=!0)}const Q=a.mercatorXfromLng(R.center.lng);return z&&Q<Math.abs(Q-1)&&j.forEach(ue=>{ue.x-=1}),{polygon:j,unwrapped:z}}(Ye(h,m).map(j=>new a.Point(jt(j.x),j.y)),m);return{polygon:S.polygon.map(j=>new a.MercatorCoordinate(j.x,j.y)),unwrapped:S.unwrapped}}}function Ye(x,h){return a.resample(x,m=>{const b=h.pointCoordinate3D(m);m.x=b.x,m.y=b.y},1/256)}function jt(x){return x<0?1+x%1:x%1}function Me(x){return 100*x|0}function St(x,h,m,b,S){const j=function(R,z){if(R)return S(R);if(z){x.url&&z.tiles&&x.tiles&&delete x.tiles;const U=a.pick(a.extend(z,x),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);z.vector_layers&&(U.vectorLayers=z.vector_layers,U.vectorLayerIds=U.vectorLayers.map(ee=>ee.id)),U.tiles=h.canonicalizeTileset(U,x.url),S(null,U)}};return x.url?a.getJSON(h.transformRequest(h.normalizeSourceURL(x.url,null,m,b),a.ResourceType.Source),j):a.exported.frame(()=>j(null,x))}class Ct{constructor(h,m,b){this.bounds=a.LngLatBounds.convert(this.validateBounds(h)),this.minzoom=m||0,this.maxzoom=b||24}validateBounds(h){return Array.isArray(h)&&h.length===4?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]}contains(h){const m=Math.pow(2,h.z),b=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*m),S=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*m),j=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*m),R=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*m);return h.x>=b&&h.x<j&&h.y>=S&&h.y<R}}class Ft{constructor(h,m,b){this.context=h;const S=h.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(h){const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const gt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zt{constructor(h,m,b,S){this.length=m.length,this.attributes=b,this.itemSize=m.bytesPerElement,this.dynamicDraw=S,this.context=h;const j=h.gl;this.buffer=j.createBuffer(),h.bindVertexBuffer.set(this.buffer),j.bufferData(j.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?j.DYNAMIC_DRAW:j.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(h){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,h.arrayBuffer)}enableAttributes(h,m){for(let b=0;b<this.attributes.length;b++){const S=m.attributes[this.attributes[b].name];S!==void 0&&h.enableVertexAttribArray(S)}}setVertexAttribPointers(h,m,b){for(let S=0;S<this.attributes.length;S++){const j=this.attributes[S],R=m.attributes[j.name];R!==void 0&&h.vertexAttribPointer(R,j.components,h[gt[j.type]],!1,this.itemSize,j.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Tt{constructor(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(h){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ot extends Tt{getDefault(){return a.Color.transparent}set(h){const m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class ar extends Tt{getDefault(){return 1}set(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)}}class mt extends Tt{getDefault(){return 0}set(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)}}class Lt extends Tt{getDefault(){return[!0,!0,!0,!0]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class dr extends Tt{getDefault(){return!0}set(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)}}class Gr extends Tt{getDefault(){return 255}set(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)}}class qr extends Tt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(h){const m=this.current;(h.func!==m.func||h.ref!==m.ref||h.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)}}class ln extends Tt{getDefault(){const h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)}}class Ui extends Tt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=h,this.dirty=!1}}class ht extends Tt{getDefault(){return[0,1]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)}}class Jt extends Tt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=h,this.dirty=!1}}class tr extends Tt{getDefault(){return this.gl.LESS}set(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)}}class zr extends Tt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.BLEND):m.disable(m.BLEND),this.current=h,this.dirty=!1}}class yr extends Tt{getDefault(){const h=this.gl;return[h.ONE,h.ZERO]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)}}class In extends Tt{getDefault(){return a.Color.transparent}set(h){const m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Cr extends Tt{getDefault(){return this.gl.FUNC_ADD}set(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)}}class hn extends Tt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=h,this.dirty=!1}}class fs extends Tt{getDefault(){return this.gl.BACK}set(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)}}class ps extends Tt{getDefault(){return this.gl.CCW}set(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)}}let Os,Do=class extends Tt{getDefault(){return null}set(x){(x!==this.current||this.dirty)&&(this.gl.useProgram(x),this.current=x,this.dirty=!1)}};class va extends Tt{getDefault(){return this.gl.TEXTURE0}set(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)}}class qa extends Tt{getDefault(){const h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class ms extends Tt{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,h),this.current=h,this.dirty=!1}}class Ga extends Tt{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class oo extends Tt{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,h),this.current=h,this.dirty=!1}}class _l extends Tt{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class De extends Tt{getDefault(){return null}set(h){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class pe extends Tt{constructor(h){super(h),this.vao=h.extVertexArrayObject}getDefault(){return null}set(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)}}class le extends Tt{getDefault(){return 4}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}}class Ne extends Tt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}}class ze extends Tt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}}class Ge extends Tt{constructor(h,m){super(h),this.context=h,this.parent=m}getDefault(){return null}}class Ze extends Ge{setDirty(){this.dirty=!0}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class Xe extends Ge{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class We extends Xe{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class it{constructor(h,m,b,S){this.context=h,this.width=m,this.height=b;const j=this.framebuffer=h.gl.createFramebuffer();this.colorAttachment=new Ze(h,j),S&&(this.depthAttachment=new Xe(h,j))}destroy(){const h=this.context.gl,m=this.colorAttachment.get();if(m&&h.deleteTexture(m),this.depthAttachment){const b=this.depthAttachment.get();b&&h.deleteRenderbuffer(b)}h.deleteFramebuffer(this.framebuffer)}}class It{constructor(h,m=!1){if(this.gl=h,this.isWebGL2=m,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),m){const b=h;this.extVertexArrayObject={createVertexArrayOES:b.createVertexArray.bind(h),deleteVertexArrayOES:b.deleteVertexArray.bind(h),bindVertexArrayOES:b.bindVertexArray.bind(h)}}this.clearColor=new ot(this),this.clearDepth=new ar(this),this.clearStencil=new mt(this),this.colorMask=new Lt(this),this.depthMask=new dr(this),this.stencilMask=new Gr(this),this.stencilFunc=new qr(this),this.stencilOp=new ln(this),this.stencilTest=new Ui(this),this.depthRange=new ht(this),this.depthTest=new Jt(this),this.depthFunc=new tr(this),this.blend=new zr(this),this.blendFunc=new yr(this),this.blendColor=new In(this),this.blendEquation=new Cr(this),this.cullFace=new hn(this),this.cullFaceSide=new fs(this),this.frontFace=new ps(this),this.program=new Do(this),this.activeTexture=new va(this),this.viewport=new qa(this),this.bindFramebuffer=new ms(this),this.bindRenderbuffer=new Ga(this),this.bindTexture=new oo(this),this.bindVertexBuffer=new _l(this),this.bindElementBuffer=new De(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new pe(this),this.pixelStoreUnpack=new le(this),this.pixelStoreUnpackPremultiplyAlpha=new Ne(this),this.pixelStoreUnpackFlipY=new ze(this),this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=h.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=h.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=h.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),m||(this.extTextureHalfFloat=h.getExtension("OES_texture_half_float")),(m||this.extTextureHalfFloat&&h.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=m||h.getExtension("OES_standard_derivatives"),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(h,m){return new Ft(this,h,m)}createVertexBuffer(h,m,b){return new Zt(this,h,m,b)}createRenderbuffer(h,m,b){const S=this.gl,j=S.createRenderbuffer();return this.bindRenderbuffer.set(j),S.renderbufferStorage(S.RENDERBUFFER,h,m,b),this.bindRenderbuffer.set(null),j}createFramebuffer(h,m,b){return new it(this,h,m,b)}clear({color:h,depth:m,stencil:b}){const S=this.gl;let j=0;h&&(j|=S.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(j|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),b!==void 0&&(j|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),S.clear(j)}setCullFace(h){h.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))}setDepthMode(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)}setStencilMode(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)}setColorMode(h){p(h.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor)),this.colorMask.set(h.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class zt extends a.Evented{constructor(h,m,b,S){if(super(),this.id=h,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(m,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(h){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const m=Array.isArray(this.map._language)?this.map._language.join():this.map._language,b=this.map._worldview;this._tileJSONRequest=St(this._options,this.map._requestManager,m,b,(S,j)=>{this._tileJSONRequest=null,this._loaded=!0,S?(m&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${m}`),b&&b.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${b}`),this.fire(new a.ErrorEvent(S))):j&&(a.extend(this,j),j.bounds&&(this.tileBounds=new Ct(j.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(j.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(S)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(h,m){const b=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(b,a.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(S.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=m:h.request=h.actor.send("reloadTile",S,j.bind(this));else if(h.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",S,j.bind(this),void 0,!0);else{const R=a.loadVectorTile.call({deduped:this._deduped},S,(z,U)=>{z||!U?j.call(this,z):(S.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},h.actor&&h.actor.send("loadTile",S,j.bind(this),void 0,!0))},!0);h.request={cancel:R}}function j(R,z){return delete h.request,h.aborted?m(null):R&&R.status!==404?m(R):(z&&z.resourceTiming&&(h.resourceTiming=z.resourceTiming),this.map._refreshExpiredTiles&&z&&h.setExpiryData(z),h.loadVectorData(z,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class vt extends a.Evented{constructor(h,m,b,S){super(),this.id=h,this.dispatcher=b,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},m),a.extend(this,a.pick(m,["url","scheme","tileSize"]))}load(h){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=St(this._options,this.map._requestManager,null,null,(m,b)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new a.ErrorEvent(m)):b&&(a.extend(this,b),b.bounds&&(this.tileBounds=new Ct(b.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(b.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(m)})}loaded(){return this._loaded}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,m){const b=a.exported.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),b,this.tileSize);h.request=a.getImage(this.map._requestManager.transformRequest(S,a.ResourceType.Tile),(j,R,z,U)=>(delete h.request,h.aborted?(h.state="unloaded",m(null)):j?(h.state="errored",m(j)):R?(this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:z,expires:U}),h.setTexture(R,this.map.painter),h.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void m(null)):m(null)))}static loadTileData(h,m,b){h.setTexture(m,b)}static unloadTileData(h,m){h.texture&&m.saveTileTexture(h.texture)}abortTile(h,m){h.request&&(h.request.cancel(),delete h.request),m()}unloadTile(h,m){h.texture&&this.map.painter.saveTileTexture(h.texture),m()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function xr(x,h,m,b,S,j,R,z){const U=[x,m,S,h,b,j,1,1,1],ee=[R,z,1],Q=a.adjoint([],U),[ue,me,_e]=a.transformMat3(ee,ee,a.transpose(Q,Q));return a.multiply$1(U,[ue,0,0,0,me,0,0,0,_e],U)}class vr extends a.Evented{constructor(h,m,b,S){super(),this.id=h,this.dispatcher=b,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=m,this._dirty=!1}load(h,m){this._loaded=m||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(b,S)=>{if(this._imageRequest=null,this._loaded=!0,b)this.fire(new a.ErrorEvent(b));else if(S){const{HTMLImageElement:j}=a.window;this.image=S instanceof j?a.exported.getImageData(S):S,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,h&&(this.coordinates=h),this._finishLoading()}})}loaded(){return this._loaded}updateImage(h){return this.image&&h.url?(this._imageRequest&&h.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=h.url,this.load(h.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(h){this.map=h,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(h){this.coordinates=h,this._boundsArray=void 0;const m=h.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(b){let S=1/0,j=1/0,R=-1/0,z=-1/0;for(const ue of b)S=Math.min(S,ue.x),j=Math.min(j,ue.y),R=Math.max(R,ue.x),z=Math.max(z,ue.y);const U=Math.max(R-S,z-j),ee=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),Q=Math.pow(2,ee);return new a.CanonicalTileID(ee,Math.floor((S+R)/2*Q),Math.floor((j+z)/2*Q))}(m),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(h){for(const U in this.tiles){const ee=this.tiles[U];ee.state!=="loaded"&&(ee.state="loaded",ee.texture=this.texture)}if(this._boundsArray)return;const m=a.tileTransform(this.tileID,this.map.transform.projection),[b,S,j,R]=this.coordinates.map(U=>{const ee=m.projection.project(U[0],U[1]);return a.getTilePoint(m,ee)._round()});this.perspectiveTransform=function(U,ee,Q,ue,me,_e,Te,we,Ee,he){const ve=xr(0,0,U,0,0,ee,U,ee),Pe=xr(Q,ue,me,_e,Te,we,Ee,he);return a.multiply$1(Pe,a.adjoint(ve,ve),Pe),[Pe[6]/Pe[8]*U/a.EXTENT,Pe[7]/Pe[8]*ee/a.EXTENT]}(this.width,this.height,b.x,b.y,S.x,S.y,R.x,R.y,j.x,j.y);const z=this._boundsArray=new a.StructArrayLayout4i8;z.emplaceBack(b.x,b.y,0,0),z.emplaceBack(S.x,S.y,a.EXTENT,0),z.emplaceBack(R.x,R.y,0,a.EXTENT),z.emplaceBack(j.x,j.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=h.createVertexBuffer(z,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const h=this.map.painter.context,m=h.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(h,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(h)}loadTile(h,m){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},m(null)):(h.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const mr={vector:zt,raster:vt,"raster-dem":class extends vt{constructor(x,h,m,b){super(x,h,m,b),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}loadTile(x,h){const m=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function b(S,j){S&&(x.state="errored",h(S)),j&&(x.dem=j,x.dem.onDeserialize(),x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0,x.state="loaded",h(null))}x.request=a.getImage(this.map._requestManager.transformRequest(m,a.ResourceType.Tile),(function(S,j,R,z){if(delete x.request,x.aborted)x.state="unloaded",h(null);else if(S)x.state="errored",h(S);else if(j){this.map._refreshExpiredTiles&&x.setExpiryData({cacheControl:R,expires:z});const U=a.window.ImageBitmap&&j instanceof a.window.ImageBitmap&&(Os==null&&(Os=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),Os),ee=1-(j.width-a.prevPowerOfTwo(j.width))/2;ee<1||x.neighboringTiles||(x.neighboringTiles=this._getNeighboringTiles(x.tileID));const Q=U?j:a.exported.getImageData(j,ee),ue={uid:x.uid,coord:x.tileID,source:this.id,rawImageData:Q,encoding:this.encoding,padding:ee};x.actor&&x.state!=="expired"||(x.actor=this.dispatcher.getActor(),x.actor.send("loadDEMTile",ue,b.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(x){const h=x.canonical,m=Math.pow(2,h.z),b=(h.x-1+m)%m,S=h.x===0?x.wrap-1:x.wrap,j=(h.x+1+m)%m,R=h.x+1===m?x.wrap+1:x.wrap,z={};return z[new a.OverscaledTileID(x.overscaledZ,S,h.z,b,h.y).key]={backfilled:!1},z[new a.OverscaledTileID(x.overscaledZ,R,h.z,j,h.y).key]={backfilled:!1},h.y>0&&(z[new a.OverscaledTileID(x.overscaledZ,S,h.z,b,h.y-1).key]={backfilled:!1},z[new a.OverscaledTileID(x.overscaledZ,x.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},z[new a.OverscaledTileID(x.overscaledZ,R,h.z,j,h.y-1).key]={backfilled:!1}),h.y+1<m&&(z[new a.OverscaledTileID(x.overscaledZ,S,h.z,b,h.y+1).key]={backfilled:!1},z[new a.OverscaledTileID(x.overscaledZ,x.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},z[new a.OverscaledTileID(x.overscaledZ,R,h.z,j,h.y+1).key]={backfilled:!1}),z}unloadTile(x){x.demTexture&&this.map.painter.saveTileTexture(x.demTexture),x.fbo&&(x.fbo.destroy(),delete x.fbo),x.dem&&delete x.dem,delete x.neighboringTiles,x.state="unloaded"}},geojson:class extends a.Evented{constructor(x,h,m,b){super(),this.id=x,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(b),this._data=h.data,this._options=a.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*S,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:a.EXTENT,radius:(h.clusterRadius!==void 0?h.clusterRadius:50)*S,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}onAdd(x){this.map=x,this.setData(this._data)}setData(x){return this._data=x,this._updateWorkerData(),this}getClusterExpansionZoom(x,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:x,source:this.id},h),this}getClusterChildren(x,h){return this.actor.send("geojson.getClusterChildren",{clusterId:x,source:this.id},h),this}getClusterLeaves(x,h,m,b){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:x,limit:h,offset:m},b),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const x=a.extend({},this.workerOptions),h=this._data;typeof h=="string"?(x.request=this.map._requestManager.transformRequest(a.exported.resolveURL(h),a.ResourceType.Source),x.request.collectResourceTiming=this._collectResourceTiming):x.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,x,(m,b)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new a.ErrorEvent(m));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(S.resourceTiming=b.resourceTiming[this.id]),this.fire(new a.Event("data",S)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(x,h){const m=x.actor?"reloadTile":"loadTile";x.actor=this.actor,x.request=this.actor.send(m,{type:this.type,uid:x.uid,tileID:x.tileID,tileZoom:x.tileZoom,zoom:x.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(b,S)=>(delete x.request,x.unloadVectorData(),x.aborted?h(null):b?h(b):(x.loadVectorData(S,this.map.painter,m==="reloadTile"),h(null))),void 0,m==="loadTile")}abortTile(x){x.request&&(x.request.cancel(),delete x.request),x.aborted=!0}unloadTile(x){x.unloadVectorData(),this.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends vr{constructor(x,h,m,b){super(x,h,m,b),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const x=this.options;this.urls=[];for(const h of x.urls)this.urls.push(this.map._requestManager.transformRequest(h,a.ResourceType.Source).url);a.getVideo(this.urls,(h,m)=>{this._loaded=!0,h?this.fire(new a.ErrorEvent(h)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(x){if(this.video){const h=this.video.seekable;x<h.start(0)||x>h.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=x}}getVideo(){return this.video}onAdd(x){this.map||(this.map=x,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const x=this.map.painter.context,h=x.gl;this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(x,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(x)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:vr,canvas:class extends vr{constructor(x,h,m,b){super(x,h,m,b),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(j=>typeof j!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${x}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${x}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${x}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${x}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${x}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(x){this.map=x,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let x=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,x=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,x=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context;this.texture?(x||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(h,this.canvas,h.gl.RGBA,{premultiply:!0}),this._prepareData(h)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const x of[this.canvas.width,this.canvas.height])if(isNaN(x)||x<=0)return!0;return!1}},custom:class extends a.Evented{constructor(x,h,m,b){super(),this.id=x,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=h,this.setEventedParent(b),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ct(this._implementation.bounds,this.minzoom,this.maxzoom)),h.update=this._update.bind(this),h.clearTiles=this._clearTiles.bind(this),h.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(h,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(x){this._map=x,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(x),this.load()}onRemove(x){this._implementation.onRemove&&this._implementation.onRemove(x)}hasTile(x){if(this._implementation.hasTile){const{x:h,y:m,z:b}=x.canonical;return this._implementation.hasTile({x:h,y:m,z:b})}return!this.tileBounds||this.tileBounds.contains(x.canonical)}loadTile(x,h){const{x:m,y:b,z:S}=x.tileID.canonical,j=new a.window.AbortController;x.request=Promise.resolve(this._implementation.loadTile({x:m,y:b,z:S},{signal:j.signal})).then((function(R){return delete x.request,x.aborted?(x.state="unloaded",h(null)):R===void 0?(x.state="errored",h(null)):R===null?(this.loadTileData(x,{width:this.tileSize,height:this.tileSize,data:null}),x.state="loaded",h(null)):function(z){return z instanceof a.window.ImageData||z instanceof a.window.HTMLCanvasElement||z instanceof a.window.ImageBitmap||z instanceof a.window.HTMLImageElement}(R)?(this.loadTileData(x,R),x.state="loaded",void h(null)):(x.state="errored",h(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(R=>{R.code!==20&&(x.state="errored",h(R))}),x.request.cancel=()=>j.abort()}loadTileData(x,h){vt.loadTileData(x,h,this._map.painter)}unloadTileData(x){vt.unloadTileData(x,this._map.painter)}unloadTile(x,h){if(this.unloadTileData(x),this._implementation.unloadTile){const{x:m,y:b,z:S}=x.tileID.canonical;this._implementation.unloadTile({x:m,y:b,z:S})}h()}abortTile(x,h){x.request&&x.request.cancel&&(x.request.cancel(),delete x.request),h()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(x=>({x:x.canonical.x,y:x.canonical.y,z:x.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Pr=function(x,h,m,b){const S=new mr[h.type](x,h,m,b);if(S.id!==x)throw new Error(`Expected Source id to be ${x} instead of ${S.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],S),S};function $r(x,h){const m=a.identity([]);return a.scale(m,m,[.5*x.width,.5*-x.height,1]),a.translate(m,m,[1,-1,0]),a.multiply(m,m,x.calculateProjMatrix(h.toUnwrapped())),Float32Array.from(m)}function nn(x,h,m,b,S,j,R,z=!1){const U=x.tilesIn(b,R,z);U.sort(qi);const ee=[];for(const ue of U)ee.push({wrappedTileID:ue.tile.tileID.wrapped().key,queryResults:ue.tile.queryRenderedFeatures(h,m,x._state,ue,S,j,$r(x.transform,ue.tile.tileID),z)});const Q=function(ue){const me={},_e={};for(const Te of ue){const we=Te.queryResults,Ee=Te.wrappedTileID,he=_e[Ee]=_e[Ee]||{};for(const ve in we){const Pe=we[ve],Ie=he[ve]=he[ve]||{},Ve=me[ve]=me[ve]||[];for(const qe of Pe)Ie[qe.featureIndex]||(Ie[qe.featureIndex]=!0,Ve.push(qe))}}return me}(ee);for(const ue in Q)Q[ue].forEach(me=>{const _e=me.feature,Te=_e.layer;Te&&Te.type!=="background"&&Te.type!=="sky"&&(_e.source=Te.source,Te["source-layer"]&&(_e.sourceLayer=Te["source-layer"]),_e.state=_e.id!==void 0?x.getFeatureState(Te["source-layer"],_e.id):{})});return Q}function Yn(x,h){const m=x.getRenderableIds().map(j=>x.getTileByID(j)),b=[],S={};for(let j=0;j<m.length;j++){const R=m[j],z=R.tileID.canonical.key;S[z]||(S[z]=!0,R.querySourceFeatures(b,h))}return b}function qi(x,h){const m=x.tileID,b=h.tileID;return m.overscaledZ-b.overscaledZ||m.canonical.y-b.canonical.y||m.wrap-b.wrap||m.canonical.x-b.canonical.x}function zn(){return Wd.workerClass!=null?new Wd.workerClass:new a.window.Worker(Wd.workerUrl)}const gs="mapboxgl_preloaded_worker_pool";class li{constructor(){this.active={}}acquire(h){if(!this.workers)for(this.workers=[];this.workers.length<li.workerCount;)this.workers.push(new zn);return this.active[h]=!0,this.workers.slice()}release(h){delete this.active[h],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[gs]}numActive(){return Object.keys(this.active).length}}let Pi;function Pa(){return Pi||(Pi=new li),Pi}function tm(x,h){const m={};for(const b in x)b!=="ref"&&(m[b]=x[b]);return a.refProperties.forEach(b=>{b in h&&(m[b]=h[b])}),m}function yf(x){x=x.slice();const h=Object.create(null);for(let m=0;m<x.length;m++)h[x[m].id]=x[m];for(let m=0;m<x.length;m++)"ref"in x[m]&&(x[m]=tm(x[m],h[x[m].ref]));return x}li.workerCount=2;const Wr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function mu(x,h,m){m.push({command:Wr.addSource,args:[x,h[x]]})}function mc(x,h,m){h.push({command:Wr.removeSource,args:[x]}),m[x]=!0}function Sd(x,h,m,b){mc(x,m,b),mu(x,h,m)}function Ed(x,h,m){let b;for(b in x[m])if(x[m].hasOwnProperty(b)&&b!=="data"&&!p(x[m][b],h[m][b]))return!1;for(b in h[m])if(h[m].hasOwnProperty(b)&&b!=="data"&&!p(x[m][b],h[m][b]))return!1;return!0}function Ia(x,h,m,b,S,j){let R;for(R in h=h||{},x=x||{})x.hasOwnProperty(R)&&(p(x[R],h[R])||m.push({command:j,args:[b,R,h[R],S]}));for(R in h)h.hasOwnProperty(R)&&!x.hasOwnProperty(R)&&(p(x[R],h[R])||m.push({command:j,args:[b,R,h[R],S]}))}function Rs(x){return x.id}function gu(x,h){return x[h.id]=h,x}class bl{constructor(h,m){this.reset(h,m)}reset(h,m){this.points=h||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(h){if(this.points.length===1)return this.points[0];h=a.clamp(h,0,1);let m=1,b=this._distances[m];const S=h*this.paddedLength+this.padding;for(;b<S&&m<this._distances.length;)b=this._distances[++m];const j=m-1,R=this._distances[j],z=b-R,U=z>0?(S-R)/z:0;return this.points[j].mult(1-U).add(this.points[m].mult(U))}}class Ma{constructor(h,m,b){const S=this.boxCells=[],j=this.circleCells=[];this.xCellCount=Math.ceil(h/b),this.yCellCount=Math.ceil(m/b);for(let R=0;R<this.xCellCount*this.yCellCount;R++)S.push([]),j.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=m,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(h,m,b,S,j){this._forEachCell(m,b,S,j,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(m),this.bboxes.push(b),this.bboxes.push(S),this.bboxes.push(j)}insertCircle(h,m,b,S){this._forEachCell(m-S,b-S,m+S,b+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(m),this.circles.push(b),this.circles.push(S)}_insertBoxCell(h,m,b,S,j,R){this.boxCells[j].push(R)}_insertCircleCell(h,m,b,S,j,R){this.circleCells[j].push(R)}_query(h,m,b,S,j,R){if(b<0||h>this.width||S<0||m>this.height)return!j&&[];const z=[];if(h<=0&&m<=0&&this.width<=b&&this.height<=S){if(j)return!0;for(let U=0;U<this.boxKeys.length;U++)z.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const ee=this.circles[3*U],Q=this.circles[3*U+1],ue=this.circles[3*U+2];z.push({key:this.circleKeys[U],x1:ee-ue,y1:Q-ue,x2:ee+ue,y2:Q+ue})}return R?z.filter(R):z}return this._forEachCell(h,m,b,S,this._queryCell,z,{hitTest:j,seenUids:{box:{},circle:{}}},R),j?z.length>0:z}_queryCircle(h,m,b,S,j){const R=h-b,z=h+b,U=m-b,ee=m+b;if(z<0||R>this.width||ee<0||U>this.height)return!S&&[];const Q=[];return this._forEachCell(R,U,z,ee,this._queryCellCircle,Q,{hitTest:S,circle:{x:h,y:m,radius:b},seenUids:{box:{},circle:{}}},j),S?Q.length>0:Q}query(h,m,b,S,j){return this._query(h,m,b,S,!1,j)}hitTest(h,m,b,S,j){return this._query(h,m,b,S,!0,j)}hitTestCircle(h,m,b,S){return this._queryCircle(h,m,b,!0,S)}_queryCell(h,m,b,S,j,R,z,U){const ee=z.seenUids,Q=this.boxCells[j];if(Q!==null){const me=this.bboxes;for(const _e of Q)if(!ee.box[_e]){ee.box[_e]=!0;const Te=4*_e;if(h<=me[Te+2]&&m<=me[Te+3]&&b>=me[Te+0]&&S>=me[Te+1]&&(!U||U(this.boxKeys[_e]))){if(z.hitTest)return R.push(!0),!0;R.push({key:this.boxKeys[_e],x1:me[Te],y1:me[Te+1],x2:me[Te+2],y2:me[Te+3]})}}}const ue=this.circleCells[j];if(ue!==null){const me=this.circles;for(const _e of ue)if(!ee.circle[_e]){ee.circle[_e]=!0;const Te=3*_e;if(this._circleAndRectCollide(me[Te],me[Te+1],me[Te+2],h,m,b,S)&&(!U||U(this.circleKeys[_e]))){if(z.hitTest)return R.push(!0),!0;{const we=me[Te],Ee=me[Te+1],he=me[Te+2];R.push({key:this.circleKeys[_e],x1:we-he,y1:Ee-he,x2:we+he,y2:Ee+he})}}}}}_queryCellCircle(h,m,b,S,j,R,z,U){const ee=z.circle,Q=z.seenUids,ue=this.boxCells[j];if(ue!==null){const _e=this.bboxes;for(const Te of ue)if(!Q.box[Te]){Q.box[Te]=!0;const we=4*Te;if(this._circleAndRectCollide(ee.x,ee.y,ee.radius,_e[we+0],_e[we+1],_e[we+2],_e[we+3])&&(!U||U(this.boxKeys[Te])))return R.push(!0),!0}}const me=this.circleCells[j];if(me!==null){const _e=this.circles;for(const Te of me)if(!Q.circle[Te]){Q.circle[Te]=!0;const we=3*Te;if(this._circlesCollide(_e[we],_e[we+1],_e[we+2],ee.x,ee.y,ee.radius)&&(!U||U(this.circleKeys[Te])))return R.push(!0),!0}}}_forEachCell(h,m,b,S,j,R,z,U){const ee=this._convertToXCellCoord(h),Q=this._convertToYCellCoord(m),ue=this._convertToXCellCoord(b),me=this._convertToYCellCoord(S);for(let _e=ee;_e<=ue;_e++)for(let Te=Q;Te<=me;Te++)if(j.call(this,h,m,b,S,this.xCellCount*Te+_e,R,z,U))return}_convertToXCellCoord(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))}_convertToYCellCoord(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))}_circlesCollide(h,m,b,S,j,R){const z=S-h,U=j-m,ee=b+R;return ee*ee>z*z+U*U}_circleAndRectCollide(h,m,b,S,j,R,z){const U=(R-S)/2,ee=Math.abs(h-(S+U));if(ee>U+b)return!1;const Q=(z-j)/2,ue=Math.abs(m-(j+Q));if(ue>Q+b)return!1;if(ee<=U||ue<=Q)return!0;const me=ee-U,_e=ue-Q;return me*me+_e*_e<=b*b}}const ys={unknown:0,flipRequired:1,flipNotRequired:2},yu=Math.tan(85*Math.PI/180);function lt(x,h,m,b,S,j,R){const z=a.create();if(m)if(j.name==="globe"){const U=a.calculateGlobeLabelMatrix(S,h);a.multiply(z,z,U)}else{const U=V([],R);z[0]=U[0],z[1]=U[1],z[4]=U[2],z[5]=U[3],b||a.rotateZ(z,z,S.angle)}else a.multiply(z,S.labelPlaneMatrix,x);return z}function Ls(x,h,m,b,S,j,R){const z=lt(x,h,m,b,S,j,R);return j.name==="globe"&&m||(z[2]=z[6]=z[10]=z[14]=0),z}function qn(x,h,m,b,S,j,R){if(m){if(j.name==="globe"){const z=lt(x,h,m,b,S,j,R);return a.invert(z,z),a.multiply(z,x,z),z}{const z=a.clone(x),U=a.identity([]);return U[0]=R[0],U[1]=R[1],U[4]=R[2],U[5]=R[3],a.multiply(z,z,U),b||a.rotateZ(z,z,-S.angle),z}}return S.glCoordMatrix}function ci(x,h,m,b){const S=[x,h,m,1];m?a.transformMat4$1(S,S,b):Sr(S,S,b);const j=S[3];return S[0]/=j,S[1]/=j,S[2]/=j,S}function jd(x,h){return Math.min(.5+x/h*.5,1.5)}function xs(x,h){const m=x[0]/x[3],b=x[1]/x[3];return m>=-h[0]&&m<=h[0]&&b>=-h[1]&&b<=h[1]}function Ad(x,h,m,b,S,j,R,z,U,ee){const Q=m.transform,ue=b?x.textSizeData:x.iconSizeData,me=a.evaluateSizeForZoom(ue,m.transform.zoom),_e=Q.projection.name==="globe",Te=[256/m.width*2+1,256/m.height*2+1],we=b?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;we.clear();let Ee=null;_e&&(Ee=b?x.text.globeExtVertexArray:x.icon.globeExtVertexArray);const he=x.lineVertexArray,ve=b?x.text.placedSymbolArray:x.icon.placedSymbolArray,Pe=m.transform.width/m.transform.height;let Ie,Ve=!1;for(let qe=0;qe<ve.length;qe++){const Ue=ve.get(qe),{numGlyphs:Ke,writingMode:He}=Ue;if(He!==a.WritingMode.vertical||Ve||Ie===a.WritingMode.horizontal||(Ve=!0),Ie=He,(Ue.hidden||He===a.WritingMode.vertical)&&!Ve){yi(Ke,we);continue}Ve=!1;const rt=new a.Point(Ue.tileAnchorX,Ue.tileAnchorY);let{x:At,y:Je,z:pt}=Q.projection.projectTilePoint(rt.x,rt.y,ee.canonical);if(U){const[gr,Qt,ur]=U(rt);At+=gr,Je+=Qt,pt+=ur}const at=[At,Je,pt,1];if(a.transformMat4$1(at,at,h),!xs(at,Te)){yi(Ke,we);continue}const Et=jd(m.transform.cameraToCenterDistance,at[3]),tt=a.evaluateSizeForFeature(ue,me,Ue),ft=R?tt/Et:tt*Et,Pt=ci(At,Je,pt,S);if(Pt[3]<=0){yi(Ke,we);continue}let _t={};const Mt=R?null:U,ir=qt(Ue,ft,!1,z,h,S,j,x.glyphOffsetArray,he,we,Ee,Pt,rt,_t,Pe,Mt,Q.projection,ee,R);Ve=ir.useVertical,Mt&&ir.needsFlipping&&(_t={}),(ir.notEnoughRoom||Ve||ir.needsFlipping&&qt(Ue,ft,!0,z,h,S,j,x.glyphOffsetArray,he,we,Ee,Pt,rt,_t,Pe,Mt,Q.projection,ee,R).notEnoughRoom)&&yi(Ke,we)}b?(x.text.dynamicLayoutVertexBuffer.updateData(we),Ee&&x.text.globeExtVertexBuffer.updateData(Ee)):(x.icon.dynamicLayoutVertexBuffer.updateData(we),Ee&&x.icon.globeExtVertexBuffer.updateData(Ee))}function rm(x,h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te,we){const{lineStartIndex:Ee,glyphStartIndex:he,segment:ve}=z,Pe=he+z.numGlyphs,Ie=Ee+z.lineLength,Ve=h.getoffsetX(he),qe=h.getoffsetX(Pe-1),Ue=gi(x*Ve,m,b,S,j,R,ve,Ee,Ie,U,ee,Q,ue,me,!0,_e,Te,we);if(!Ue)return null;const Ke=gi(x*qe,m,b,S,j,R,ve,Ee,Ie,U,ee,Q,ue,me,!0,_e,Te,we);return Ke?{first:Ue,last:Ke}:null}function gc(x,h,m,b){return x===a.WritingMode.horizontal&&Math.abs(b)>Math.abs(m)?{useVertical:!0}:x===a.WritingMode.vertical?b>0?{needsFlipping:!0}:null:h!==ys.unknown&&function(S,j){return S===0||Math.abs(j/S)>yu}(m,b)?h===ys.flipRequired?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null}function qt(x,h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te,we,Ee,he,ve){const Pe=h/24,Ie=x.lineOffsetX*Pe,Ve=x.lineOffsetY*Pe,{lineStartIndex:qe,glyphStartIndex:Ue,numGlyphs:Ke,segment:He,writingMode:rt,flipState:At}=x,Je=qe+x.lineLength,pt=at=>{if(Q){const[Pt,_t,Mt]=at.up,ir=ee.length;a.updateGlobeVertexNormal(Q,ir+0,Pt,_t,Mt),a.updateGlobeVertexNormal(Q,ir+1,Pt,_t,Mt),a.updateGlobeVertexNormal(Q,ir+2,Pt,_t,Mt),a.updateGlobeVertexNormal(Q,ir+3,Pt,_t,Mt)}const[Et,tt,ft]=at.point;a.addDynamicAttributes(ee,Et,tt,ft,at.angle)};if(Ke>1){const at=rm(Pe,z,Ie,Ve,m,ue,me,x,U,j,_e,we,!1,Ee,he,ve);if(!at)return{notEnoughRoom:!0};if(b&&!m){let[Et,tt,ft]=at.first.point,[Pt,_t,Mt]=at.last.point;[Et,tt]=ci(Et,tt,ft,R),[Pt,_t]=ci(Pt,_t,Mt,R);const ir=gc(rt,At,(Pt-Et)*Te,_t-tt);if(x.flipState=ir&&ir.needsFlipping?ys.flipRequired:ys.flipNotRequired,ir)return ir}pt(at.first);for(let Et=Ue+1;Et<Ue+Ke-1;Et++){const tt=gi(Pe*z.getoffsetX(Et),Ie,Ve,m,ue,me,He,qe,Je,U,j,_e,we,!1,!1,Ee,he,ve);if(!tt)return ee.length-=4*(Et-Ue),{notEnoughRoom:!0};pt(tt)}pt(at.last)}else{if(b&&!m){const Et=ci(me.x,me.y,0,S),tt=qe+He+1,ft=new a.Point(U.getx(tt),U.gety(tt)),Pt=ci(ft.x,ft.y,0,S),_t=Pt[3]>0?Pt:Mr(me,ft,Et,1,S,void 0,Ee,he.canonical),Mt=gc(rt,At,(_t[0]-Et[0])*Te,_t[1]-Et[1]);if(x.flipState=Mt&&Mt.needsFlipping?ys.flipRequired:ys.flipNotRequired,Mt)return Mt}const at=gi(Pe*z.getoffsetX(Ue),Ie,Ve,m,ue,me,He,qe,Je,U,j,_e,we,!1,!1,Ee,he,ve);if(!at)return{notEnoughRoom:!0};pt(at)}return{}}function Dr(x,h,m,b,S){const{x:j,y:R,z}=b.projectTilePoint(x.x,x.y,h);if(!S)return ci(j,R,z,m);const[U,ee,Q]=S(x);return ci(j+U,R+ee,z+Q,m)}function Mr(x,h,m,b,S,j,R,z){const U=Dr(x.sub(h)._unit()._add(x),z,S,R,j);return a.sub(U,m,U),a.normalize(U,U),a.scaleAndAdd(U,m,U,b)}function gi(x,h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te,we,Ee,he){const ve=b?x-h:x+h;let Pe=ve>0?1:-1,Ie=0;b&&(Pe*=-1,Ie=Math.PI),Pe<0&&(Ie+=Math.PI);let Ve=z+R+(Pe>0?0:1)|0,qe=S,Ue=S,Ke=0,He=0;const rt=Math.abs(ve),At=[],Je=[];let pt=j,at=pt;const Et=()=>Mr(at,pt,Ue,rt-Ke+1,Q,me,we,Ee.canonical);for(;Ke+He<=rt;){if(Ve+=Pe,Ve<z||Ve>=U)return null;if(Ue=qe,at=pt,At.push(Ue),_e&&Je.push(at),pt=new a.Point(ee.getx(Ve),ee.gety(Ve)),qe=ue[Ve],!qe){const ur=Dr(pt,Ee.canonical,Q,we,me);qe=ur[3]>0?ue[Ve]=ur:Et()}Ke+=He,He=a.distance(Ue,qe)}Te&&me&&(ue[Ve]&&(qe=Et(),He=a.distance(Ue,qe)),ue[Ve]=qe);const tt=(rt-Ke)/He,ft=pt.sub(at)._mult(tt)._add(at),Pt=a.sub([],qe,Ue),_t=a.scaleAndAdd([],Ue,Pt,tt);let Mt=[0,0,1],ir=Pt[0],gr=Pt[1];if(he&&(Mt=we.upVector(Ee.canonical,ft.x,ft.y),Mt[0]!==0||Mt[1]!==0||Mt[2]!==1)){const ur=[Mt[2],0,-Mt[0]],Rr=a.cross([],Mt,ur);a.normalize(ur,ur),a.normalize(Rr,Rr),ir=a.dot(Pt,ur),gr=a.dot(Pt,Rr)}if(m){const ur=a.cross([],Mt,Pt);a.normalize(ur,ur),a.scaleAndAdd(_t,_t,ur,m*Pe)}const Qt=Ie+Math.atan2(gr,ir);return At.push(_t),_e&&Je.push(ft),{point:_t,angle:Qt,path:At,tilePath:Je,up:Mt}}function yi(x,h){const m=h.length,b=m+4*x;h.resize(b),h.float32.fill(-1/0,4*m,4*b)}function Sr(x,h,m){const b=h[0],S=h[1];return x[0]=m[0]*b+m[4]*S+m[12],x[1]=m[1]*b+m[5]*S+m[13],x[3]=m[3]*b+m[7]*S+m[15],x}const Gi=100;class yc{constructor(h,m,b=new Ma(h.width+200,h.height+200,25),S=new Ma(h.width+200,h.height+200,25)){this.transform=h,this.grid=b,this.ignoredGrid=S,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+Gi,this.screenBottomBoundary=h.height+Gi,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200,this.fogState=m}placeCollisionBox(h,m,b,S,j,R,z,U){let ee=b.projectedAnchorX,Q=b.projectedAnchorY,ue=b.projectedAnchorZ;const me=b.elevation,_e=b.tileID,Te=h.getProjection();if(me&&_e){const[qe,Ue,Ke]=Te.upVector(_e.canonical,b.tileAnchorX,b.tileAnchorY),He=Te.upVectorScale(_e.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;ee+=qe*me*He,Q+=Ue*me*He,ue+=Ke*me*He}const we=this.projectAndGetPerspectiveRatio(z,ee,Q,ue,b.tileID,Te.name==="globe"||!!me||this.transform.pitch>0,Te),Ee=R*we.perspectiveRatio,he=(b.x1*m+S.x-b.padding)*Ee+we.point.x,ve=(b.y1*m+S.y-b.padding)*Ee+we.point.y,Pe=(b.x2*m+S.x+b.padding)*Ee+we.point.x,Ie=(b.y2*m+S.y+b.padding)*Ee+we.point.y,Ve=we.perspectiveRatio<=.55||we.occluded;return!this.isInsideGrid(he,ve,Pe,Ie)||!j&&this.grid.hitTest(he,ve,Pe,Ie,U)||Ve?{box:[],offscreen:!1,occluded:we.occluded}:{box:[he,ve,Pe,Ie],offscreen:this.isOffscreen(he,ve,Pe,Ie),occluded:!1}}placeCollisionCircles(h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te,we){const Ee=[],he=this.transform.elevation,ve=h.getProjection(),Pe=he?he.getAtTileOffsetFunc(we,this.transform.center.lat,this.transform.worldSize,ve):null,Ie=new a.Point(b.tileAnchorX,b.tileAnchorY);let{x:Ve,y:qe,z:Ue}=ve.projectTilePoint(Ie.x,Ie.y,we.canonical);if(Pe){const[ft,Pt,_t]=Pe(Ie);Ve+=ft,qe+=Pt,Ue+=_t}const Ke=ve.name==="globe",He=this.projectAndGetPerspectiveRatio(z,Ve,qe,Ue,we,Ke||!!he||this.transform.pitch>0,ve),{perspectiveRatio:rt}=He,At=(ue?R/rt:R*rt)/a.ONE_EM,Je=ci(Ve,qe,Ue,U),pt=He.signedDistanceFromCamera>0?rm(At,j,b.lineOffsetX*At,b.lineOffsetY*At,!1,Je,Ie,b,S,U,{},he&&!ue?Pe:null,ue&&!!he,ve,we,ue):null;let at=!1,Et=!1,tt=!0;if(pt&&!He.occluded){const ft=.5*_e*rt+Te,Pt=new a.Point(-100,-100),_t=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),Mt=new bl,{first:ir,last:gr}=pt,Qt=ir.path.length;let ur=[];for(let rr=Qt-1;rr>=1;rr--)ur.push(ir.path[rr]);for(let rr=1;rr<gr.path.length;rr++)ur.push(gr.path[rr]);const Rr=2.5*ft;ee&&(ur=ur.map(([rr,rn,fn],pn)=>(Pe&&!Ke&&(fn=Pe(pn<Qt-1?ir.tilePath[Qt-1-pn]:gr.tilePath[pn-Qt+2])[2]),ci(rr,rn,fn,ee))),ur.some(rr=>rr[3]<=0)&&(ur=[]));let Or=[];if(ur.length>0){let rr=1/0,rn=-1/0,fn=1/0,pn=-1/0;for(const mn of ur)rr=Math.min(rr,mn[0]),fn=Math.min(fn,mn[1]),rn=Math.max(rn,mn[0]),pn=Math.max(pn,mn[1]);rn>=Pt.x&&rr<=_t.x&&pn>=Pt.y&&fn<=_t.y&&(Or=[ur.map(mn=>new a.Point(mn[0],mn[1]))],(rr<Pt.x||rn>_t.x||fn<Pt.y||pn>_t.y)&&(Or=a.clipLine(Or,Pt.x,Pt.y,_t.x,_t.y)))}for(const rr of Or){Mt.reset(rr,.25*ft);let rn=0;rn=Mt.length<=.5*ft?1:Math.ceil(Mt.paddedLength/Rr)+1;for(let fn=0;fn<rn;fn++){const pn=fn/Math.max(rn-1,1),mn=Mt.lerp(pn),wa=mn.x+Gi,Ki=mn.y+Gi;Ee.push(wa,Ki,ft,0);const Bs=wa-ft,Go=Ki-ft,Rn=wa+ft,gn=Ki+ft;if(tt=tt&&this.isOffscreen(Bs,Go,Rn,gn),Et=Et||this.isInsideGrid(Bs,Go,Rn,gn),!m&&this.grid.hitTestCircle(wa,Ki,ft,me)&&(at=!0,!Q))return{circles:[],offscreen:!1,collisionDetected:at,occluded:!1}}}}return{circles:!Q&&at||!Et?[]:Ee,offscreen:tt,collisionDetected:at,occluded:He.occluded}}queryRenderedSymbols(h){if(h.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let b=1/0,S=1/0,j=-1/0,R=-1/0;for(const Q of h){const ue=new a.Point(Q.x+Gi,Q.y+Gi);b=Math.min(b,ue.x),S=Math.min(S,ue.y),j=Math.max(j,ue.x),R=Math.max(R,ue.y),m.push(ue)}const z=this.grid.query(b,S,j,R).concat(this.ignoredGrid.query(b,S,j,R)),U={},ee={};for(const Q of z){const ue=Q.key;if(U[ue.bucketInstanceId]===void 0&&(U[ue.bucketInstanceId]={}),U[ue.bucketInstanceId][ue.featureIndex])continue;const me=[new a.Point(Q.x1,Q.y1),new a.Point(Q.x2,Q.y1),new a.Point(Q.x2,Q.y2),new a.Point(Q.x1,Q.y2)];a.polygonIntersectsPolygon(m,me)&&(U[ue.bucketInstanceId][ue.featureIndex]=!0,ee[ue.bucketInstanceId]===void 0&&(ee[ue.bucketInstanceId]=[]),ee[ue.bucketInstanceId].push(ue.featureIndex))}return ee}insertCollisionBox(h,m,b,S,j){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:S,collisionGroupID:j},h[0],h[1],h[2],h[3])}insertCollisionCircles(h,m,b,S,j){const R=m?this.ignoredGrid:this.grid,z={bucketInstanceId:b,featureIndex:S,collisionGroupID:j};for(let U=0;U<h.length;U+=4)R.insertCircle(z,h[U],h[U+1],h[U+2])}projectAndGetPerspectiveRatio(h,m,b,S,j,R,z){const U=[m,b,S,1];let ee=!1;S||this.transform.pitch>0?(a.transformMat4$1(U,U,h),this.fogState&&j&&z.name!=="globe"&&(ee=function(me,_e,Te,we,Ee,he){const ve=he.calculateFogTileMatrix(Ee),Pe=[_e,Te,we];return a.transformMat4(Pe,Pe,ve),ae(me,Pe,he.pitch,he._fov)}(this.fogState,m,b,S,j.toUnwrapped(),this.transform)>.9)):Sr(U,U,h);const Q=U[3];return{point:new a.Point((U[0]/Q+1)/2*this.transform.width+Gi,(-U[1]/Q+1)/2*this.transform.height+Gi),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(z)/Q*.5,1.5),signedDistanceFromCamera:Q,occluded:R&&U[2]>Q||ee}}isOffscreen(h,m,b,S){return b<Gi||h>=this.screenRightBoundary||S<Gi||m>this.screenBottomBoundary}isInsideGrid(h,m,b,S){return b>=0&&h<this.gridRightBoundary&&S>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const h=a.identity([]);return a.translate(h,h,[-100,-100,0]),h}}function tn(x,h,m){const b=h.createTileMatrix(x,x.worldSize,m.toUnwrapped());return a.multiply(new Float32Array(16),x.projMatrix,b)}function aa(x,h,m){if(h.projection.name===m.projection.name)return x.projMatrix;const b=m.clone();return b.setProjection(h.projection),tn(b,h.getProjection(),x)}function an(x,h,m){return h.name===m.projection.name?x.projMatrix:tn(m,h,x)}class xc{constructor(h,m,b,S){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?m:-m))):S&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class lo{constructor(h,m,b,S,j,R=!1){this.text=new xc(h?h.text:null,m,b,j),this.icon=new xc(h?h.icon:null,m,S,j),this.clipped=R}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class vc{constructor(h,m,b,S=!1){this.text=h,this.icon=m,this.skipFade=b,this.clipped=S}}class xu{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class xf{constructor(h,m,b,S,j){this.bucketInstanceId=h,this.featureIndex=m,this.sourceLayerIndex=b,this.bucketIndex=S,this.tileID=j}}class nm{constructor(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}}get(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){const m=++this.maxGroupID;this.collisionGroups[h]={ID:m,predicate:b=>b.collisionGroupID===m}}return this.collisionGroups[h]}}function vu(x,h,m,b,S){const{horizontalAlign:j,verticalAlign:R}=a.getAnchorAlignment(x),z=-(j-.5)*h,U=-(R-.5)*m,ee=a.evaluateVariableOffset(x,b);return new a.Point(z+ee[0]*S,U+ee[1]*S)}function co(x,h,m,b,S){const j=new a.Point(x,h);return m&&j._rotate(b?S:-S),j}class vs{constructor(h,m,b,S,j){this.transform=h.clone(),this.projection=h.projection.name,this.collisionIndex=new yc(this.transform,j),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new nm(b),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(h,m,b,S){const j=b.getBucket(m),R=b.latestFeatureIndex;if(!j||!R||m.id!==j.layerIds[0])return;const z=j.layers[0].layout,U=b.collisionBoxArray,ee=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),Q=b.tileSize/a.EXTENT,ue=b.tileID.toUnwrapped();this.transform.setProjection(j.projection);const me=(_e=b.tileID,Te=j.getProjection(),we=this.transform,Te.name===this.projection?we.calculateProjMatrix(_e.toUnwrapped()):tn(we,Te,_e));var _e,Te,we;const Ee=z.get("text-pitch-alignment")==="map",he=z.get("text-rotation-alignment")==="map";m.compileFilter();const ve=m.dynamicFilter(),Pe=m.dynamicFilterNeedsFeature(),Ie=this.transform.calculatePixelsToTileUnitsMatrix(b),Ve=Ls(me,b.tileID.canonical,Ee,he,this.transform,j.getProjection(),Ie);let qe=null;if(Ee){const He=qn(me,b.tileID.canonical,Ee,he,this.transform,j.getProjection(),Ie);qe=a.multiply([],this.transform.labelPlaneMatrix,He)}let Ue=null;ve&&b.latestFeatureIndex&&(Ue={unwrappedTileID:ue,dynamicFilter:ve,dynamicFilterNeedsFeature:Pe,featureIndex:b.latestFeatureIndex}),this.retainedQueryData[j.bucketInstanceId]=new xf(j.bucketInstanceId,R,j.sourceLayerIndex,j.index,b.tileID);const Ke={bucket:j,layout:z,posMatrix:me,textLabelPlaneMatrix:Ve,labelToScreenMatrix:qe,clippingData:Ue,scale:ee,textPixelRatio:Q,holdingForFade:b.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(j.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(j.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(j.sourceID)};if(S)for(const He of j.sortKeyRanges){const{sortKey:rt,symbolInstanceStart:At,symbolInstanceEnd:Je}=He;h.push({sortKey:rt,symbolInstanceStart:At,symbolInstanceEnd:Je,parameters:Ke})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:j.symbolInstances.length,parameters:Ke})}attemptAnchorPlacement(h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te,we,Ee,he,ve){const{textOffset0:Pe,textOffset1:Ie,crossTileID:Ve}=me,qe=[Pe,Ie],Ue=vu(h,b,S,qe,j),Ke=this.collisionIndex.placeCollisionBox(Te,j,m,co(Ue.x,Ue.y,R,z,this.transform.angle),ue,U,ee,Q.predicate);if(Ee){const He=Te.getSymbolInstanceIconSize(ve,this.transform.zoom,me.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Te,He,Ee,co(Ue.x,Ue.y,R,z,this.transform.angle),ue,U,ee,Q.predicate).box.length===0)return}if(Ke.box.length>0){let He;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ve]&&this.prevPlacement.placements[Ve]&&this.prevPlacement.placements[Ve].text&&(He=this.prevPlacement.variableOffsets[Ve].anchor),this.variableOffsets[Ve]={textOffset:qe,width:b,height:S,anchor:h,textScale:j,prevAnchor:He},this.markUsedJustification(Te,h,me,we),Te.allowVerticalPlacement&&(this.markUsedOrientation(Te,we,me),this.placedOrientations[Ve]=we),{shift:Ue,placedGlyphBoxes:Ke}}}placeLayerBucketPart(h,m,b,S){const{bucket:j,layout:R,posMatrix:z,textLabelPlaneMatrix:U,labelToScreenMatrix:ee,clippingData:Q,textPixelRatio:ue,holdingForFade:me,collisionBoxArray:_e,partiallyEvaluatedTextSize:Te,partiallyEvaluatedIconSize:we,collisionGroup:Ee}=h.parameters,he=R.get("text-optional"),ve=R.get("icon-optional"),Pe=R.get("text-allow-overlap"),Ie=R.get("icon-allow-overlap"),Ve=R.get("text-rotation-alignment")==="map",qe=R.get("text-pitch-alignment")==="map",Ue=R.get("icon-text-fit")!=="none",Ke=R.get("symbol-z-order")==="viewport-y";this.transform.setProjection(j.projection);let He=Pe&&(Ie||!j.hasIconData()||ve),rt=Ie&&(Pe||!j.hasTextData()||he);!j.collisionArrays&&_e&&j.deserializeCollisionBoxes(_e),b&&S&&j.updateCollisionDebugBuffers(this.transform.zoom,_e);const At=(Je,pt,at)=>{const{crossTileID:Et,numVerticalGlyphVertices:tt}=Je;if(Q){const Rn={zoom:this.transform.zoom,pitch:this.transform.pitch};let gn=null;if(Q.dynamicFilterNeedsFeature){const Xr=this.retainedQueryData[j.bucketInstanceId];gn=Q.featureIndex.loadFeature({featureIndex:Je.featureIndex,bucketIndex:Xr.bucketIndex,sourceLayerIndex:Xr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,Q.dynamicFilter)(Rn,gn,this.retainedQueryData[j.bucketInstanceId].tileID.canonical,new a.Point(Je.tileAnchorX,Je.tileAnchorY),this.transform.calculateDistanceTileData(Q.unwrappedTileID)))return this.placements[Et]=new vc(!1,!1,!1,!0),void m.add(Et)}if(m.has(Et))return;if(me)return void(this.placements[Et]=new vc(!1,!1,!1));let ft=!1,Pt=!1,_t=!0,Mt=!1,ir=!1,gr=null,Qt={box:null,offscreen:null,occluded:null},ur={box:null,offscreen:null,occluded:null},Rr=null,Or=null,rr=null,rn=0,fn=0,pn=0;at.textFeatureIndex?rn=at.textFeatureIndex:Je.useRuntimeCollisionCircles&&(rn=Je.featureIndex),at.verticalTextFeatureIndex&&(fn=at.verticalTextFeatureIndex);const mn=Rn=>{Rn.tileID=this.retainedQueryData[j.bucketInstanceId].tileID;const gn=this.transform.elevation;(gn||Rn.elevation)&&(Rn.elevation=gn?gn.getAtTileOffset(Rn.tileID,Rn.tileAnchorX,Rn.tileAnchorY):0)},wa=at.textBox;if(wa){mn(wa);const Rn=Xr=>{let xi=a.WritingMode.horizontal;if(j.allowVerticalPlacement&&!Xr&&this.prevPlacement){const Oa=this.prevPlacement.placedOrientations[Et];Oa&&(this.placedOrientations[Et]=Oa,xi=Oa,this.markUsedOrientation(j,xi,Je))}return xi},gn=(Xr,xi)=>{if(j.allowVerticalPlacement&&tt>0&&at.verticalTextBox){for(const Oa of j.writingModes)if(Oa===a.WritingMode.vertical?(Qt=xi(),ur=Qt):Qt=Xr(),Qt&&Qt.box&&Qt.box.length)break}else Qt=Xr()};if(R.get("text-variable-anchor")){let Xr=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Et]){const Mn=this.prevPlacement.variableOffsets[Et];Xr.indexOf(Mn.anchor)>0&&(Xr=Xr.filter(Ka=>Ka!==Mn.anchor),Xr.unshift(Mn.anchor))}const xi=(Mn,Ka,km)=>{const Cu=j.getSymbolInstanceTextSize(Te,Je,this.transform.zoom,pt),Rf=(Mn.x2-Mn.x1)*Cu+2*Mn.padding,Il=(Mn.y2-Mn.y1)*Cu+2*Mn.padding,Ec=Ue&&!Ie?Ka:null;Ec&&mn(Ec);let Pu={box:[],offscreen:!1,occluded:!1};const Tm=Pe?2*Xr.length:Xr.length;for(let Lf=0;Lf<Tm;++Lf){const Oy=this.attemptAnchorPlacement(Xr[Lf%Xr.length],Mn,Rf,Il,Cu,Ve,qe,ue,z,Ee,Lf>=Xr.length,Je,pt,j,km,Ec,Te,we);if(Oy&&(Pu=Oy.placedGlyphBoxes,Pu&&Pu.box&&Pu.box.length)){ft=!0,gr=Oy.shift;break}}return Pu};gn(()=>xi(wa,at.iconBox,a.WritingMode.horizontal),()=>{const Mn=at.verticalTextBox;return Mn&&mn(Mn),j.allowVerticalPlacement&&!(Qt&&Qt.box&&Qt.box.length)&&tt>0&&Mn?xi(Mn,at.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Qt&&(ft=Qt.box,_t=Qt.offscreen,Mt=Qt.occluded);const Oa=Rn(!(!Qt||!Qt.box));if(!ft&&this.prevPlacement){const Mn=this.prevPlacement.variableOffsets[Et];Mn&&(this.variableOffsets[Et]=Mn,this.markUsedJustification(j,Mn.anchor,Je,Oa))}}else{const Xr=(xi,Oa)=>{const Mn=j.getSymbolInstanceTextSize(Te,Je,this.transform.zoom,pt),Ka=this.collisionIndex.placeCollisionBox(j,Mn,xi,new a.Point(0,0),Pe,ue,z,Ee.predicate);return Ka&&Ka.box&&Ka.box.length&&(this.markUsedOrientation(j,Oa,Je),this.placedOrientations[Et]=Oa),Ka};gn(()=>Xr(wa,a.WritingMode.horizontal),()=>{const xi=at.verticalTextBox;return j.allowVerticalPlacement&&tt>0&&xi?(mn(xi),Xr(xi,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Rn(!!(Qt&&Qt.box&&Qt.box.length))}}if(Rr=Qt,ft=Rr&&Rr.box&&Rr.box.length>0,_t=Rr&&Rr.offscreen,Mt=Rr&&Rr.occluded,Je.useRuntimeCollisionCircles){const Rn=j.text.placedSymbolArray.get(Je.centerJustifiedTextSymbolIndex>=0?Je.centerJustifiedTextSymbolIndex:Je.verticalPlacedTextSymbolIndex),gn=a.evaluateSizeForFeature(j.textSizeData,Te,Rn),Xr=R.get("text-padding");Or=this.collisionIndex.placeCollisionCircles(j,Pe,Rn,j.lineVertexArray,j.glyphOffsetArray,gn,z,U,ee,b,qe,Ee.predicate,Je.collisionCircleDiameter*gn/a.ONE_EM,Xr,this.retainedQueryData[j.bucketInstanceId].tileID),ft=Pe||Or.circles.length>0&&!Or.collisionDetected,_t=_t&&Or.offscreen,Mt=Or.occluded}if(at.iconFeatureIndex&&(pn=at.iconFeatureIndex),at.iconBox){const Rn=gn=>{mn(gn);const Xr=Ue&&gr?co(gr.x,gr.y,Ve,qe,this.transform.angle):new a.Point(0,0),xi=j.getSymbolInstanceIconSize(we,this.transform.zoom,Je.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(j,xi,gn,Xr,Ie,ue,z,Ee.predicate)};ur&&ur.box&&ur.box.length&&at.verticalIconBox?(rr=Rn(at.verticalIconBox),Pt=rr.box.length>0):(rr=Rn(at.iconBox),Pt=rr.box.length>0),_t=_t&&rr.offscreen,ir=rr.occluded}const Ki=he||Je.numHorizontalGlyphVertices===0&&tt===0,Bs=ve||Je.numIconVertices===0;if(Ki||Bs?Bs?Ki||(Pt=Pt&&ft):ft=Pt&&ft:Pt=ft=Pt&&ft,ft&&Rr&&Rr.box&&this.collisionIndex.insertCollisionBox(Rr.box,R.get("text-ignore-placement"),j.bucketInstanceId,ur&&ur.box&&fn?fn:rn,Ee.ID),Pt&&rr&&this.collisionIndex.insertCollisionBox(rr.box,R.get("icon-ignore-placement"),j.bucketInstanceId,pn,Ee.ID),Or&&(ft&&this.collisionIndex.insertCollisionCircles(Or.circles,R.get("text-ignore-placement"),j.bucketInstanceId,rn,Ee.ID),b)){const Rn=j.bucketInstanceId;let gn=this.collisionCircleArrays[Rn];gn===void 0&&(gn=this.collisionCircleArrays[Rn]=new xu);for(let Xr=0;Xr<Or.circles.length;Xr+=4)gn.circles.push(Or.circles[Xr+0]),gn.circles.push(Or.circles[Xr+1]),gn.circles.push(Or.circles[Xr+2]),gn.circles.push(Or.collisionDetected?1:0)}const Go=j.projection.name!=="globe";He=He&&(Go||!Mt),rt=rt&&(Go||!ir),this.placements[Et]=new vc(ft||He,Pt||rt,_t||j.justReloaded),m.add(Et)};if(Ke){const Je=j.getSortedSymbolIndexes(this.transform.angle);for(let pt=Je.length-1;pt>=0;--pt){const at=Je[pt];At(j.symbolInstances.get(at),at,j.collisionArrays[at])}}else for(let Je=h.symbolInstanceStart;Je<h.symbolInstanceEnd;Je++)At(j.symbolInstances.get(Je),Je,j.collisionArrays[Je]);if(b&&j.bucketInstanceId in this.collisionCircleArrays){const Je=this.collisionCircleArrays[j.bucketInstanceId];a.invert(Je.invProjMatrix,z),Je.viewportMatrix=this.collisionIndex.getViewportMatrix()}j.justReloaded=!1}markUsedJustification(h,m,b,S){const{leftJustifiedTextSymbolIndex:j,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:U,crossTileID:ee}=b,Q=a.getAnchorJustification(m),ue=S===a.WritingMode.vertical?U:Q==="left"?j:Q==="center"?R:Q==="right"?z:-1;j>=0&&(h.text.placedSymbolArray.get(j).crossTileID=ue>=0&&j!==ue?0:ee),R>=0&&(h.text.placedSymbolArray.get(R).crossTileID=ue>=0&&R!==ue?0:ee),z>=0&&(h.text.placedSymbolArray.get(z).crossTileID=ue>=0&&z!==ue?0:ee),U>=0&&(h.text.placedSymbolArray.get(U).crossTileID=ue>=0&&U!==ue?0:ee)}markUsedOrientation(h,m,b){const S=m===a.WritingMode.horizontal||m===a.WritingMode.horizontalOnly?m:0,j=m===a.WritingMode.vertical?m:0,{leftJustifiedTextSymbolIndex:R,centerJustifiedTextSymbolIndex:z,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:ee}=b,Q=h.text.placedSymbolArray;R>=0&&(Q.get(R).placedOrientation=S),z>=0&&(Q.get(z).placedOrientation=S),U>=0&&(Q.get(U).placedOrientation=S),ee>=0&&(Q.get(ee).placedOrientation=j)}commit(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let b=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const S=m?m.symbolFadeChange(h):1,j=m?m.opacities:{},R=m?m.variableOffsets:{},z=m?m.placedOrientations:{};for(const U in this.placements){const ee=this.placements[U],Q=j[U];Q?(this.opacities[U]=new lo(Q,S,ee.text,ee.icon,null,ee.clipped),b=b||ee.text!==Q.text.placed||ee.icon!==Q.icon.placed):(this.opacities[U]=new lo(null,S,ee.text,ee.icon,ee.skipFade,ee.clipped),b=b||ee.text||ee.icon)}for(const U in j){const ee=j[U];if(!this.opacities[U]){const Q=new lo(ee,S,!1,!1);Q.isHidden()||(this.opacities[U]=Q,b=b||ee.text.placed||ee.icon.placed)}}for(const U in R)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=R[U]);for(const U in z)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=z[U]);b?this.lastPlacementChangeTime=h:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:h)}updateLayerOpacities(h,m){const b=new Set;for(const S of m){const j=S.getBucket(h);j&&S.latestFeatureIndex&&h.id===j.layerIds[0]&&this.updateBucketOpacities(j,b,S.collisionBoxArray)}}updateBucketOpacities(h,m,b){h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();const S=h.layers[0].layout,j=!!h.layers[0].dynamicFilter(),R=new lo(null,0,!1,!1,!0),z=S.get("text-allow-overlap"),U=S.get("icon-allow-overlap"),ee=S.get("text-variable-anchor"),Q=S.get("text-rotation-alignment")==="map",ue=S.get("text-pitch-alignment")==="map",me=S.get("icon-text-fit")!=="none",_e=new lo(null,0,z&&(U||!h.hasIconData()||S.get("icon-optional")),U&&(z||!h.hasTextData()||S.get("text-optional")),!0);!h.collisionArrays&&b&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(b);const Te=(Ee,he,ve)=>{for(let Pe=0;Pe<he/4;Pe++)Ee.opacityVertexArray.emplaceBack(ve)};let we=0;for(let Ee=0;Ee<h.symbolInstances.length;Ee++){const he=h.symbolInstances.get(Ee),{numHorizontalGlyphVertices:ve,numVerticalGlyphVertices:Pe,crossTileID:Ie,numIconVertices:Ve}=he,qe=m.has(Ie);let Ue=this.opacities[Ie];qe?Ue=R:Ue||(Ue=_e,this.opacities[Ie]=Ue),m.add(Ie);const Ke=ve>0||Pe>0,He=Ve>0,rt=this.placedOrientations[Ie],At=rt===a.WritingMode.vertical,Je=rt===a.WritingMode.horizontal||rt===a.WritingMode.horizontalOnly;if(!Ke&&!He||Ue.isHidden()||we++,Ke){const pt=_u(Ue.text);Te(h.text,ve,At?Fn:pt),Te(h.text,Pe,Je?Fn:pt);const at=Ue.text.isHidden(),{leftJustifiedTextSymbolIndex:Et,centerJustifiedTextSymbolIndex:tt,rightJustifiedTextSymbolIndex:ft,verticalPlacedTextSymbolIndex:Pt}=he,_t=h.text.placedSymbolArray,Mt=at||At?1:0;Et>=0&&(_t.get(Et).hidden=Mt),tt>=0&&(_t.get(tt).hidden=Mt),ft>=0&&(_t.get(ft).hidden=Mt),Pt>=0&&(_t.get(Pt).hidden=at||Je?1:0);const ir=this.variableOffsets[Ie];ir&&this.markUsedJustification(h,ir.anchor,he,rt);const gr=this.placedOrientations[Ie];gr&&(this.markUsedJustification(h,"left",he,gr),this.markUsedOrientation(h,gr,he))}if(He){const pt=_u(Ue.icon),{placedIconSymbolIndex:at,verticalPlacedIconSymbolIndex:Et}=he,tt=h.icon.placedSymbolArray,ft=Ue.icon.isHidden()?1:0;at>=0&&(Te(h.icon,Ve,At?Fn:pt),tt.get(at).hidden=ft),Et>=0&&(Te(h.icon,he.numVerticalIconVertices,Je?Fn:pt),tt.get(Et).hidden=ft)}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){const pt=h.collisionArrays[Ee];if(pt){let at=new a.Point(0,0),Et=!0;if(pt.textBox||pt.verticalTextBox){if(ee){const ft=this.variableOffsets[Ie];ft?(at=vu(ft.anchor,ft.width,ft.height,ft.textOffset,ft.textScale),Q&&at._rotate(ue?this.transform.angle:-this.transform.angle)):Et=!1}j&&(Et=!Ue.clipped),pt.textBox&&wl(h.textCollisionBox.collisionVertexArray,Ue.text.placed,!Et||At,at.x,at.y),pt.verticalTextBox&&wl(h.textCollisionBox.collisionVertexArray,Ue.text.placed,!Et||Je,at.x,at.y)}const tt=Et&&!!(!Je&&pt.verticalIconBox);pt.iconBox&&wl(h.iconCollisionBox.collisionVertexArray,Ue.icon.placed,tt,me?at.x:0,me?at.y:0),pt.verticalIconBox&&wl(h.iconCollisionBox.collisionVertexArray,Ue.icon.placed,!tt,me?at.x:0,me?at.y:0)}}}if(h.fullyClipped=we===0,h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){const Ee=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=Ee.invProjMatrix,h.placementViewportMatrix=Ee.viewportMatrix,h.collisionCircleArray=Ee.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}}symbolFadeChange(h){return this.fadeDuration===0?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(h){return Math.max(0,(this.transform.zoom-h)/1.5)}hasTransitions(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(h,m){const b=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*b>h}setStale(){this.stale=!0}}function wl(x,h,m,b,S){x.emplaceBack(h?1:0,m?1:0,b||0,S||0),x.emplaceBack(h?1:0,m?1:0,b||0,S||0),x.emplaceBack(h?1:0,m?1:0,b||0,S||0),x.emplaceBack(h?1:0,m?1:0,b||0,S||0)}const sa=Math.pow(2,25),$n=Math.pow(2,24),Oo=Math.pow(2,17),vf=Math.pow(2,16),_a=Math.pow(2,9),Wa=Math.pow(2,8),uo=Math.pow(2,1);function _u(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;const h=x.placed?1:0,m=Math.floor(127*x.opacity);return m*sa+h*$n+m*Oo+h*vf+m*_a+h*Wa+m*uo+h}const Fn=0;class Ro{constructor(h){this._sortAcrossTiles=h.layout.get("symbol-z-order")!=="viewport-y"&&h.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(h,m,b,S,j){const R=this._bucketParts;for(;this._currentTileIndex<h.length;)if(m.getBucketParts(R,S,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,j())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((z,U)=>z.sortKey-U.sortKey));this._currentPartIndex<R.length;){const z=R[this._currentPartIndex];if(m.placeLayerBucketPart(z,this._seenCrossTileIDs,b,z.symbolInstanceStart===0),this._currentPartIndex++,j())return!0}return!1}}class _c{constructor(h,m,b,S,j,R,z,U){this.placement=new vs(h,j,R,z,U),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(h,m,b){const S=a.exported.now(),j=()=>{const R=a.exported.now()-S;return!this._forceFullPlacement&&R>2};for(;this._currentPlacementIndex>=0;){const R=m[h[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=z)&&(!R.maxzoom||R.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Ro(R)),this._inProgressLayer.continuePlacement(b[R.source],this.placement,this._showCollisionBoxes,R,j))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(h){return this.placement.commit(h),this.placement}}const Lo=512/a.EXTENT/2;class Jn{constructor(h,m,b){this.tileID=h,this.bucketInstanceId=b,this.index=new a.KDBush(m.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=h.canonical.x*a.EXTENT,j=h.canonical.y*a.EXTENT;for(let R=0;R<m.length;R++){const{key:z,crossTileID:U,tileAnchorX:ee,tileAnchorY:Q}=m.get(R),ue=Math.floor((S+ee)*Lo),me=Math.floor((j+Q)*Lo);this.index.add(ue,me),this.keys.push(z),this.crossTileIDs.push(U)}this.index.finish()}findMatches(h,m,b){const S=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z),j=Lo/Math.pow(2,m.canonical.z-this.tileID.canonical.z),R=m.canonical.x*a.EXTENT,z=m.canonical.y*a.EXTENT;for(let U=0;U<h.length;U++){const ee=h.get(U);if(ee.crossTileID)continue;const{key:Q,tileAnchorX:ue,tileAnchorY:me}=ee,_e=Math.floor((R+ue)*j),Te=Math.floor((z+me)*j),we=this.index.range(_e-S,Te-S,_e+S,Te+S);for(const Ee of we){const he=this.crossTileIDs[Ee];if(this.keys[Ee]===Q&&!b.has(he)){b.add(he),ee.crossTileID=he;break}}}}}class kl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Nd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(h){const m=Math.round((h-this.lng)/360);if(m!==0)for(const b in this.indexes){const S=this.indexes[b],j={};for(const R in S){const z=S[R];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+m),j[z.tileID.key]=z}this.indexes[b]=j}this.lng=h}addBucket(h,m,b){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(let j=0;j<m.symbolInstances.length;j++)m.symbolInstances.get(j).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]=new Set);const S=this.usedCrossTileIDs[h.overscaledZ];for(const j in this.indexes){const R=this.indexes[j];if(Number(j)>h.overscaledZ)for(const z in R){const U=R[z];U.tileID.isChildOf(h)&&U.findMatches(m.symbolInstances,h,S)}else{const z=R[h.scaledTo(Number(j)).key];z&&z.findMatches(m.symbolInstances,h,S)}}for(let j=0;j<m.symbolInstances.length;j++){const R=m.symbolInstances.get(j);R.crossTileID||(R.crossTileID=b.generate(),S.add(R.crossTileID))}return this.indexes[h.overscaledZ]===void 0&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new Jn(h,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(h,m){for(const b of m.crossTileIDs)this.usedCrossTileIDs[h].delete(b)}removeStaleBuckets(h){let m=!1;for(const b in this.indexes){const S=this.indexes[b];for(const j in S)h[S[j].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,S[j]),delete S[j],m=!0)}return m}}class _s{constructor(){this.layerIndexes={},this.crossTileIDs=new kl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(h,m,b,S){let j=this.layerIndexes[h.id];j===void 0&&(j=this.layerIndexes[h.id]=new Nd);let R=!1;const z={};S.name!=="globe"&&j.handleWrapJump(b);for(const U of m){const ee=U.getBucket(h);ee&&h.id===ee.layerIds[0]&&(ee.bucketInstanceId||(ee.bucketInstanceId=++this.maxBucketInstanceId),j.addBucket(U.tileID,ee,this.crossTileIDs)&&(R=!0),z[ee.bucketInstanceId]=!0)}return j.removeStaleBuckets(z)&&(R=!0),R}pruneUnusedLayers(h){const m={};h.forEach(b=>{m[b]=!0});for(const b in this.layerIndexes)m[b]||delete this.layerIndexes[b]}}const cn=(x,h)=>a.emitValidationErrors(x,h&&h.filter(m=>m.identifier!=="source.canvas")),Cd=a.pick(Wr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),dy=a.pick(Wr,["setCenter","setZoom","setBearing","setPitch"]),Pd={version:8,layers:[],sources:{}},Tl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class bs extends a.Evented{constructor(h,m={}){super(),this.map=h,this.dispatcher=new be(Pa(),this),this.imageManager=new K,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(h._requestManager,m.localFontFamily?a.LocalGlyphMode.all:m.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,m.localFontFamily||m.localIdeographFontFamily),this.crossTileSymbolIndex=new _s,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const b=this;this._rtlTextPluginCallback=bs.registerForPluginStateChange(S=>{b.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(j,R)=>{if(a.triggerPluginCompletionEvent(j),R&&R.every(z=>z))for(const z in b._sourceCaches){const U=b._sourceCaches[z],ee=U.getSource().type;ee!=="vector"&&ee!=="geojson"||U.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const j=this.getSource(S.sourceId);if(j&&j.vectorLayerIds)for(const R in this._layers){const z=this._layers[R];z.source===j.id&&this._validateLayer(z)}})}loadURL(h,m={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const b=typeof m.validate=="boolean"?m.validate:!a.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,m.accessToken);const S=this.map._requestManager.transformRequest(h,a.ResourceType.Style);this._request=a.getJSON(S,(j,R)=>{this._request=null,j?this.fire(new a.ErrorEvent(j)):R&&this._load(R,b)})}loadJSON(h,m={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(h,m.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Pd,!1)}_updateLayerCount(h,m){const b=m?1:-1;h.is3D()&&(this._num3DLayers+=b),h.type==="circle"&&(this._numCircleLayers+=b),h.type==="symbol"&&(this._numSymbolLayers+=b)}_load(h,m){if(m&&cn(this,a.validateStyle(h)))return;this._loaded=!0,this.stylesheet=a.clone$1(h),this._updateMapProjection();for(const S in h.sources)this.addSource(S,h.sources[S],{validate:!1});this._changed=!1,h.sprite?this._loadSprite(h.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(h.glyphs);const b=yf(this.stylesheet.layers);this._order=b.map(S=>S.id),this._layers={},this._serializedLayers={};for(const S of b){const j=a.createStyleLayer(S);j.setEventedParent(this,{layer:{id:j.id}}),this._layers[j.id]=j,this._serializedLayers[j.id]=j.serialize(),this._updateLayerCount(j,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ne(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(h){h?this.stylesheet.projection=h:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(h){this._spriteRequest=function(m,b,S){let j,R,z;const U=a.exported.devicePixelRatio>1?"@2x":"";let ee=a.getJSON(b.transformRequest(b.normalizeSpriteURL(m,U,".json"),a.ResourceType.SpriteJSON),(me,_e)=>{ee=null,z||(z=me,j=_e,ue())}),Q=a.getImage(b.transformRequest(b.normalizeSpriteURL(m,U,".png"),a.ResourceType.SpriteImage),(me,_e)=>{Q=null,z||(z=me,R=_e,ue())});function ue(){if(z)S(z);else if(j&&R){const me=a.exported.getImageData(R),_e={};for(const Te in j){const{width:we,height:Ee,x:he,y:ve,sdf:Pe,pixelRatio:Ie,stretchX:Ve,stretchY:qe,content:Ue}=j[Te],Ke=new a.RGBAImage({width:we,height:Ee});a.RGBAImage.copy(me,Ke,{x:he,y:ve},{x:0,y:0},{width:we,height:Ee}),_e[Te]={data:Ke,pixelRatio:Ie,sdf:Pe,stretchX:Ve,stretchY:qe,content:Ue}}S(null,_e)}}return{cancel(){ee&&(ee.cancel(),ee=null),Q&&(Q.cancel(),Q=null)}}}(h,this.map._requestManager,(m,b)=>{if(this._spriteRequest=null,m)this.fire(new a.ErrorEvent(m));else if(b)for(const S in b)this.imageManager.addImage(S,b[S]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(h){const m=this.getSource(h.source);if(!m)return;const b=h.sourceLayer;b&&(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(b)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${b}" does not exist on source "${m.id}" as specified by style layer "${h.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const h in this._sourceCaches)if(!this._sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(h){const m=[];for(const b of h){const S=this._layers[b];S.type!=="custom"&&m.push(S.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const h in this._sourceCaches)if(this._sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(h){return!!this.terrain&&(typeof h.isLayerDraped=="function"?h.isLayerDraped():Tl[h.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(h){if(!this._loaded)return;const m=this._changed;if(this._changed){const S=Object.keys(this._updatedLayers),j=Object.keys(this._removedLayers);(S.length||j.length)&&this._updateWorkerLayers(S,j);for(const R in this._updatedSources){const z=this._updatedSources[R];z==="reload"?this._reloadSource(R):z==="clear"&&this._clearSource(R)}this._updateTilesForChangedImages();for(const R in this._updatedPaintProps)this._layers[R].updateTransitions(h);this.light.updateTransitions(h),this.fog&&this.fog.updateTransitions(h),this._resetUpdates()}const b={};for(const S in this._sourceCaches){const j=this._sourceCaches[S];b[S]=j.used,j.used=!1}for(const S of this._order){const j=this._layers[S];if(j.recalculate(h,this._availableImages),!j.isHidden(h.zoom)){const z=this._getLayerSourceCache(j);z&&(z.used=!0)}const R=this.map.painter;if(R){const z=j.getProgramIds();if(!z)continue;const U=j.getProgramConfiguration(h.zoom);for(const ee of z)R.useProgram(ee,U)}}for(const S in b){const j=this._sourceCaches[S];b[S]!==j.used&&j.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:j.getSource().id}))}this.light.recalculate(h),this.terrain&&this.terrain.recalculate(h),this.fog&&this.fog.recalculate(h),this.z=h.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const h=Object.keys(this._changedImages);if(h.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}}_updateWorkerLayers(h,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(h){if(this._checkLoaded(),cn(this,a.validateStyle(h)))return!1;(h=a.clone$1(h)).layers=yf(h.layers);const m=function(S,j){if(!S)return[{command:Wr.setStyle,args:[j]}];let R=[];try{if(!p(S.version,j.version))return[{command:Wr.setStyle,args:[j]}];p(S.center,j.center)||R.push({command:Wr.setCenter,args:[j.center]}),p(S.zoom,j.zoom)||R.push({command:Wr.setZoom,args:[j.zoom]}),p(S.bearing,j.bearing)||R.push({command:Wr.setBearing,args:[j.bearing]}),p(S.pitch,j.pitch)||R.push({command:Wr.setPitch,args:[j.pitch]}),p(S.sprite,j.sprite)||R.push({command:Wr.setSprite,args:[j.sprite]}),p(S.glyphs,j.glyphs)||R.push({command:Wr.setGlyphs,args:[j.glyphs]}),p(S.transition,j.transition)||R.push({command:Wr.setTransition,args:[j.transition]}),p(S.light,j.light)||R.push({command:Wr.setLight,args:[j.light]}),p(S.fog,j.fog)||R.push({command:Wr.setFog,args:[j.fog]}),p(S.projection,j.projection)||R.push({command:Wr.setProjection,args:[j.projection]});const z={},U=[];(function(ue,me,_e,Te){let we;for(we in me=me||{},ue=ue||{})ue.hasOwnProperty(we)&&(me.hasOwnProperty(we)||mc(we,_e,Te));for(we in me){if(!me.hasOwnProperty(we))continue;const Ee=me[we];ue.hasOwnProperty(we)?p(ue[we],Ee)||(ue[we].type==="geojson"&&Ee.type==="geojson"&&Ed(ue,me,we)?_e.push({command:Wr.setGeoJSONSourceData,args:[we,Ee.data]}):Sd(we,me,_e,Te)):mu(we,me,_e)}})(S.sources,j.sources,U,z);const ee=[];S.layers&&S.layers.forEach(ue=>{ue.source&&z[ue.source]?R.push({command:Wr.removeLayer,args:[ue.id]}):ee.push(ue)});let Q=S.terrain;Q&&z[Q.source]&&(R.push({command:Wr.setTerrain,args:[void 0]}),Q=void 0),R=R.concat(U),p(Q,j.terrain)||R.push({command:Wr.setTerrain,args:[j.terrain]}),function(ue,me,_e){me=me||[];const Te=(ue=ue||[]).map(Rs),we=me.map(Rs),Ee=ue.reduce(gu,{}),he=me.reduce(gu,{}),ve=Te.slice(),Pe=Object.create(null);let Ie,Ve,qe,Ue,Ke,He,rt;for(Ie=0,Ve=0;Ie<Te.length;Ie++)qe=Te[Ie],he.hasOwnProperty(qe)?Ve++:(_e.push({command:Wr.removeLayer,args:[qe]}),ve.splice(ve.indexOf(qe,Ve),1));for(Ie=0,Ve=0;Ie<we.length;Ie++)qe=we[we.length-1-Ie],ve[ve.length-1-Ie]!==qe&&(Ee.hasOwnProperty(qe)?(_e.push({command:Wr.removeLayer,args:[qe]}),ve.splice(ve.lastIndexOf(qe,ve.length-Ve),1)):Ve++,He=ve[ve.length-Ie],_e.push({command:Wr.addLayer,args:[he[qe],He]}),ve.splice(ve.length-Ie,0,qe),Pe[qe]=!0);for(Ie=0;Ie<we.length;Ie++)if(qe=we[Ie],Ue=Ee[qe],Ke=he[qe],!Pe[qe]&&!p(Ue,Ke))if(p(Ue.source,Ke.source)&&p(Ue["source-layer"],Ke["source-layer"])&&p(Ue.type,Ke.type)){for(rt in Ia(Ue.layout,Ke.layout,_e,qe,null,Wr.setLayoutProperty),Ia(Ue.paint,Ke.paint,_e,qe,null,Wr.setPaintProperty),p(Ue.filter,Ke.filter)||_e.push({command:Wr.setFilter,args:[qe,Ke.filter]}),p(Ue.minzoom,Ke.minzoom)&&p(Ue.maxzoom,Ke.maxzoom)||_e.push({command:Wr.setLayerZoomRange,args:[qe,Ke.minzoom,Ke.maxzoom]}),Ue)Ue.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&(rt.indexOf("paint.")===0?Ia(Ue[rt],Ke[rt],_e,qe,rt.slice(6),Wr.setPaintProperty):p(Ue[rt],Ke[rt])||_e.push({command:Wr.setLayerProperty,args:[qe,rt,Ke[rt]]}));for(rt in Ke)Ke.hasOwnProperty(rt)&&!Ue.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&(rt.indexOf("paint.")===0?Ia(Ue[rt],Ke[rt],_e,qe,rt.slice(6),Wr.setPaintProperty):p(Ue[rt],Ke[rt])||_e.push({command:Wr.setLayerProperty,args:[qe,rt,Ke[rt]]}))}else _e.push({command:Wr.removeLayer,args:[qe]}),He=ve[ve.lastIndexOf(qe)+1],_e.push({command:Wr.addLayer,args:[Ke,He]})}(ee,j.layers,R)}catch(z){console.warn("Unable to compute style diff:",z),R=[{command:Wr.setStyle,args:[j]}]}return R}(this.serialize(),h).filter(S=>!(S.command in dy));if(m.length===0)return!1;const b=m.filter(S=>!(S.command in Cd));if(b.length>0)throw new Error(`Unimplemented: ${b.map(S=>S.command).join(", ")}.`);return m.forEach(S=>{S.command!=="setTransition"&&S.command!=="setProjection"&&this[S.command].apply(this,S.args)}),this.stylesheet=h,this._updateMapProjection(),!0}addImage(h,m){return this.getImage(h)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(h,m),this._afterImageUpdated(h),this)}updateImage(h,m){this.imageManager.updateImage(h,m)}getImage(h){return this.imageManager.getImage(h)}removeImage(h){return this.getImage(h)?(this.imageManager.removeImage(h),this._afterImageUpdated(h),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(h,m,b={}){if(this._checkLoaded(),this.getSource(h)!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(a.validateSource,`sources.${h}`,m,null,b))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const S=Pr(h,m,this.dispatcher,this);S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(h),source:S.serialize(),sourceId:h}));const j=R=>{const z=(R?"symbol:":"other:")+h,U=this._sourceCaches[z]=new a.SourceCache(z,S,R);(R?this._symbolSourceCaches:this._otherSourceCaches)[h]=U,U.style=this,U.onAdd(this.map)};j(!1),m.type!=="vector"&&m.type!=="geojson"||j(!0),S.onAdd&&S.onAdd(this.map),this._changed=!0}removeSource(h){this._checkLoaded();const m=this.getSource(h);if(!m)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===h)return this.fire(new a.ErrorEvent(new Error(`Source "${h}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.get().source===h)return this.fire(new a.ErrorEvent(new Error(`Source "${h}" cannot be removed while terrain is using it.`)));const b=this._getSourceCaches(h);for(const S of b)delete this._sourceCaches[S.id],delete this._updatedSources[S.id],S.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles();return delete this._otherSourceCaches[h],delete this._symbolSourceCaches[h],m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(h,m){this._checkLoaded(),this.getSource(h).setData(m),this._changed=!0}getSource(h){const m=this._getSourceCache(h);return m&&m.getSource()}_getSources(){const h=[];for(const m in this._otherSourceCaches){const b=this._getSourceCache(m);b&&h.push(b.getSource())}return h}addLayer(h,m,b={}){this._checkLoaded();const S=h.id;if(this.getLayer(S))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${S}" already exists on this map`)));let j;if(h.type==="custom"){if(cn(this,a.validateCustomStyleLayer(h)))return;j=a.createStyleLayer(h)}else{if(typeof h.source=="object"&&(this.addSource(S,h.source),h=a.clone$1(h),h=a.extend(h,{source:S})),this._validate(a.validateLayer,`layers.${S}`,h,{arrayIndex:-1},b))return;j=a.createStyleLayer(h),this._validateLayer(j),j.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[j.id]=j.serialize(),this._updateLayerCount(j,!0)}const R=m?this._order.indexOf(m):this._order.length;if(m&&R===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`)));this._order.splice(R,0,S),this._layerOrderChanged=!0,this._layers[S]=j;const z=this._getLayerSourceCache(j);if(this._removedLayers[S]&&j.source&&z&&j.type!=="custom"){const U=this._removedLayers[S];delete this._removedLayers[S],U.type!==j.type?this._updatedSources[j.source]="clear":(this._updatedSources[j.source]="reload",z.pause())}this._updateLayer(j),j.onAdd&&j.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(h,m){if(this._checkLoaded(),this._changed=!0,!this._layers[h])return void this.fire(new a.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be moved.`)));if(h===m)return;const b=this._order.indexOf(h);this._order.splice(b,1);const S=m?this._order.indexOf(m):this._order.length;m&&S===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`))):(this._order.splice(S,0,h),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(h){this._checkLoaded();const m=this._layers[h];if(!m)return void this.fire(new a.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be removed.`)));m.setEventedParent(null),this._updateLayerCount(m,!1);const b=this._order.indexOf(h);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=m,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],m.onRemove&&m.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(h){return this._layers[h]}hasLayer(h){return h in this._layers}hasLayerType(h){for(const m in this._layers)if(this._layers[m].type===h)return!0;return!1}setLayerZoomRange(h,m,b){this._checkLoaded();const S=this.getLayer(h);S?S.minzoom===m&&S.maxzoom===b||(m!=null&&(S.minzoom=m),b!=null&&(S.maxzoom=b),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(h,m,b={}){this._checkLoaded();const S=this.getLayer(h);if(S){if(!p(S.filter,m))return m==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(a.validateFilter,`layers.${S.id}.filter`,m,{layerType:S.type},b)||(S.filter=a.clone$1(m),this._updateLayer(S)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be filtered.`)))}getFilter(h){const m=this.getLayer(h);return m&&a.clone$1(m.filter)}setLayoutProperty(h,m,b,S={}){this._checkLoaded();const j=this.getLayer(h);j?p(j.getLayoutProperty(m),b)||(j.setLayoutProperty(m,b,S),this._updateLayer(j)):this.fire(new a.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(h,m){const b=this.getLayer(h);if(b)return b.getLayoutProperty(m);this.fire(new a.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style.`)))}setPaintProperty(h,m,b,S={}){this._checkLoaded();const j=this.getLayer(h);j?p(j.getPaintProperty(m),b)||(j.setPaintProperty(m,b,S)&&this._updateLayer(j),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(h,m){const b=this.getLayer(h);return b&&b.getPaintProperty(m)}setFeatureState(h,m){this._checkLoaded();const b=h.source,S=h.sourceLayer,j=this.getSource(b);if(!j)return void this.fire(new a.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const R=j.type;if(R==="geojson"&&S)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(R==="vector"&&!S)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));h.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const z=this._getSourceCaches(b);for(const U of z)U.setFeatureState(S,h.id,m)}removeFeatureState(h,m){this._checkLoaded();const b=h.source,S=this.getSource(b);if(!S)return void this.fire(new a.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const j=S.type,R=j==="vector"?h.sourceLayer:void 0;if(j==="vector"&&!R)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&typeof h.id!="string"&&typeof h.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const z=this._getSourceCaches(b);for(const U of z)U.removeFeatureState(R,h.id,m)}getFeatureState(h){this._checkLoaded();const m=h.source,b=h.sourceLayer,S=this.getSource(m);if(S){if(S.type!=="vector"||b)return h.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(m)[0].getFeatureState(b,h.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const h={};for(const m in this._sourceCaches){const b=this._sourceCaches[m].getSource();h[b.id]||(h[b.id]=b.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:h,layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateLayer(h){this._updatedLayers[h.id]=!0;const m=this._getLayerSourceCache(h);h.source&&!this._updatedSources[h.source]&&m&&m.getSource().type!=="raster"&&(this._updatedSources[h.source]="reload",m.pause()),this._changed=!0,h.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(h){const m=R=>this._layers[R].type==="fill-extrusion",b={},S=[];for(let R=this._order.length-1;R>=0;R--){const z=this._order[R];if(m(z)){b[z]=R;for(const U of h){const ee=U[z];if(ee)for(const Q of ee)S.push(Q)}}}S.sort((R,z)=>z.intersectionZ-R.intersectionZ);const j=[];for(let R=this._order.length-1;R>=0;R--){const z=this._order[R];if(m(z))for(let U=S.length-1;U>=0;U--){const ee=S[U].feature;if(b[ee.layer.id]<R)break;j.push(ee),S.pop()}else for(const U of h){const ee=U[z];if(ee)for(const Q of ee)j.push(Q.feature)}}return j}queryRenderedFeatures(h,m,b){m&&m.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",m.filter,null,m);const S={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of m.layers){const ee=this._layers[U];if(!ee)return this.fire(new a.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];S[ee.source]=!0}}const j=[];m.availableImages=this._availableImages;const R=m&&m.layers?m.layers.some(U=>{const ee=this.getLayer(U);return ee&&ee.is3D()}):this.has3DLayers(),z=$e.createFromScreenPoints(h,b);for(const U in this._sourceCaches){const ee=this._sourceCaches[U].getSource().id;m.layers&&!S[ee]||j.push(nn(this._sourceCaches[U],this._layers,this._serializedLayers,z,m,b,R,!!this.map._showQueryGeometry))}return this.placement&&j.push(function(U,ee,Q,ue,me,_e,Te){const we={},Ee=_e.queryRenderedSymbols(ue),he=[];for(const ve of Object.keys(Ee).map(Number))he.push(Te[ve]);he.sort(qi);for(const ve of he){const Pe=ve.featureIndex.lookupSymbolFeatures(Ee[ve.bucketInstanceId],ee,ve.bucketIndex,ve.sourceLayerIndex,me.filter,me.layers,me.availableImages,U);for(const Ie in Pe){const Ve=we[Ie]=we[Ie]||[],qe=Pe[Ie];qe.sort((Ue,Ke)=>{const He=ve.featureSortOrder;if(He){const rt=He.indexOf(Ue.featureIndex);return He.indexOf(Ke.featureIndex)-rt}return Ke.featureIndex-Ue.featureIndex});for(const Ue of qe)Ve.push(Ue)}}for(const ve in we)we[ve].forEach(Pe=>{const Ie=Pe.feature,Ve=Q(U[ve]);if(!Ve)return;const qe=Ve.getFeatureState(Ie.layer["source-layer"],Ie.id);Ie.source=Ie.layer.source,Ie.layer["source-layer"]&&(Ie.sourceLayer=Ie.layer["source-layer"]),Ie.state=qe});return we}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),z.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(j)}querySourceFeatures(h,m){m&&m.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",m.filter,null,m);const b=this._getSourceCaches(h);let S=[];for(const j of b)S=S.concat(Yn(j,m));return S}addSourceType(h,m,b){return bs.getSourceType(h)?b(new Error(`A source type called "${h}" already exists.`)):(bs.setSourceType(h,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:m.workerSourceURL},b):b(null,null))}getLight(){return this.light.getLight()}setLight(h,m={}){this._checkLoaded();const b=this.light.getLight();let S=!1;for(const R in h)if(!p(h[R],b[R])){S=!0;break}if(!S)return;const j=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(h,m),this.light.updateTransitions(j)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(h,m=1){if(this._checkLoaded(),!h)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let b=h;if(m===1){if(typeof b.source=="object"){const S="terrain-dem-src";this.addSource(S,b.source),b=a.clone$1(b),b=a.extend(b,{source:S})}if(this._validate(a.validateTerrain,"terrain",b))return}if(!this.terrain||this.terrain&&m!==this.terrain.drapeRenderMode){if(!b)return;this._createTerrain(b,m)}else{const S=this.terrain,j=S.get();for(const R of Object.keys(a.spec.terrain))!b.hasOwnProperty(R)&&a.spec.terrain[R].default&&(b[R]=a.spec.terrain[R].default);for(const R in b)if(!p(b[R],j[R])){S.set(b),this.stylesheet.terrain=b;const z=this._setTransitionParameters({duration:0});S.updateTransitions(z);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(h){const m=this.fog=new Se(h,this.map.transform);this.stylesheet.fog=h;const b=this._setTransitionParameters({duration:0});m.updateTransitions(b)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const h of this.map._markers)h._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(h){if(this._checkLoaded(),!h)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog,b=m.get();Object.keys(h).length===0&&m.set(h);for(const S in h)if(!p(h[S],b[S])){m.set(h),this.stylesheet.fog=h;const j=this._setTransitionParameters({duration:0});m.updateTransitions(j);break}}else this._createFog(h);this._markersNeedUpdate=!0}_setTransitionParameters(h){return{now:a.exported.now(),transition:a.extend(h,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const h=this._order.filter(b=>this.isLayerDraped(this._layers[b])),m=this._order.filter(b=>!this.isLayerDraped(this._layers[b]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...h),this._drapedFirstOrder.push(...m)}_createTerrain(h,m){const b=this.terrain=new oe(h,m);this.stylesheet.terrain=h,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const S=this._setTransitionParameters({duration:0});b.updateTransitions(S)}_force3DLayerUpdate(){for(const h in this._layers){const m=this._layers[h];m.type==="fill-extrusion"&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const h in this._layers){const m=this._layers[h];m.type==="symbol"&&this._updateLayer(m)}}_validate(h,m,b,S,j={}){return(!j||j.validate!==!1)&&cn(this,h.call(a.validateStyle,a.extend({key:m,style:this.serialize(),value:b,styleSpec:a.spec},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this._sourceCaches)this._sourceCaches[h].clearTiles(),this._sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(h){const m=this._getSourceCaches(h);for(const b of m)b.clearTiles()}_reloadSource(h){const m=this._getSourceCaches(h);for(const b of m)b.resume(),b.reload()}_reloadSources(){for(const h of this._getSources())h.reload&&h.reload()}_updateSources(h){for(const m in this._sourceCaches)this._sourceCaches[m].update(h)}_generateCollisionBoxes(){for(const h in this._sourceCaches){const m=this._sourceCaches[h];m.resume(),m.reload()}}_updatePlacement(h,m,b,S,j=!1){let R=!1,z=!1;const U={};for(const ee of this._order){const Q=this._layers[ee];if(Q.type!=="symbol")continue;if(!U[Q.source]){const me=this._getLayerSourceCache(Q);if(!me)continue;U[Q.source]=me.getRenderableIds(!0).map(_e=>me.getTileByID(_e)).sort((_e,Te)=>Te.tileID.overscaledZ-_e.tileID.overscaledZ||(_e.tileID.isLessThan(Te.tileID)?-1:1))}const ue=this.crossTileSymbolIndex.addLayer(Q,U[Q.source],h.center.lng,h.projection);R=R||ue}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),j=j||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(j||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),h.zoom))&&(this.pauseablePlacement=new _c(h,this._order,j,m,b,S,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),z=!0),R&&this.pauseablePlacement.placement.setStale()),z||R)for(const ee of this._order){const Q=this._layers[ee];Q.type==="symbol"&&this.placement.updateLayerOpacities(Q,U[Q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const h in this._sourceCaches)this._sourceCaches[h].releaseSymbolFadeTiles()}getImages(h,m,b){this.imageManager.getImages(m.icons,b),this._updateTilesForChangedImages();const S=j=>{j&&j.setDependencies(m.tileID.key,m.type,m.icons)};S(this._otherSourceCaches[m.source]),S(this._symbolSourceCaches[m.source])}getGlyphs(h,m,b){this.glyphManager.getGlyphs(m.stacks,b)}getResource(h,m,b){return a.makeRequest(m,b)}_getSourceCache(h){return this._otherSourceCaches[h]}_getLayerSourceCache(h){return h.type==="symbol"?this._symbolSourceCaches[h.source]:this._otherSourceCaches[h.source]}_getSourceCaches(h){const m=[];return this._otherSourceCaches[h]&&m.push(this._otherSourceCaches[h]),this._symbolSourceCaches[h]&&m.push(this._symbolSourceCaches[h]),m}_isSourceCacheLoaded(h){const m=this._getSourceCaches(h);return m.length===0?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${h}'`))),!1):m.every(b=>b.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}bs.getSourceType=function(x){return mr[x]},bs.setSourceType=function(x,h){mr[x]=h},bs.registerForPluginStateChange=a.registerForPluginStateChange;var bc=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,zo="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",zi=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,wc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ho=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let $o={},Sl={};const El=[];jl(bc,El),jl(zi,El),jl(wc,El),jl(ho,El),$o=Vr("",zi),Sl=Vr(ho,wc);const bu=Vr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),wu=bc,kc=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var _f={background:Vr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Vr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Vr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Vr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Vr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Vr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Vr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Vr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Vr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Vr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Vr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Vr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Vr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Vr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Vr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Vr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Vr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Vr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Vr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Vr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Vr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Vr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Vr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Vr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Vr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Vr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zo),skyboxGradient:Vr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zo),skyboxCapture:Vr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Vr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Vr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function jl(x,h){const m=x.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let b of m)if(b=b.trim(),b[0]==="#"&&b.includes("if")&&!b.includes("endif")){b=b.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=b.split(" ");for(const j of S)h.includes(j)||h.push(j)}}function Vr(x,h){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=h.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),S={},j=[...El];return jl(x,j),jl(h,j),{fragmentSource:x=x.replace(m,(R,z,U,ee,Q)=>(S[Q]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
varying ${U} ${ee} ${Q};
#else
uniform ${U} ${ee} u_${Q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Q}
    ${U} ${ee} ${Q} = u_${Q};
#endif
`)),vertexSource:h=h.replace(m,(R,z,U,ee,Q)=>{const ue=ee==="float"?"vec2":"vec4",me=Q.match(/color/)?"color":ue;return S[Q]?z==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
attribute ${U} ${ue} a_${Q};
varying ${U} ${ee} ${Q};
#else
uniform ${U} ${ee} u_${Q};
#endif
`:me==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = a_${Q};
#else
    ${U} ${ee} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = unpack_mix_${me}(a_${Q}, u_${Q}_t);
#else
    ${U} ${ee} ${Q} = u_${Q};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
attribute ${U} ${ue} a_${Q};
#else
uniform ${U} ${ee} u_${Q};
#endif
`:me==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${U} ${ee} ${Q} = a_${Q};
#else
    ${U} ${ee} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${U} ${ee} ${Q} = unpack_mix_${me}(a_${Q}, u_${Q}_t);
#else
    ${U} ${ee} ${Q} = u_${Q};
#endif
`}),staticAttributes:b,usedDefines:j}}class im{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(h,m,b,S,j,R,z){this.context=h;let U=this.boundPaintVertexBuffers.length!==S.length;for(let Q=0;!U&&Q<S.length;Q++)this.boundPaintVertexBuffers[Q]!==S[Q]&&(U=!0);let ee=this.boundDynamicVertexBuffers.length!==z.length;for(let Q=0;!ee&&Q<z.length;Q++)this.boundDynamicVertexBuffers[Q]!==z[Q]&&(ee=!0);if(!h.extVertexArrayObject||!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==b||U||ee||this.boundIndexBuffer!==j||this.boundVertexOffset!==R)this.freshBind(m,b,S,j,R,z);else{h.bindVertexArrayOES.set(this.vao);for(const Q of z)Q&&Q.bind();j&&j.dynamicDraw&&j.bind()}}freshBind(h,m,b,S,j,R){let z;const U=h.numAttributes,ee=this.context,Q=ee.gl;if(ee.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ee.extVertexArrayObject.createVertexArrayOES(),ee.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=h,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=S,this.boundVertexOffset=j,this.boundDynamicVertexBuffers=R;else{z=ee.currentNumAttributes||0;for(let ue=U;ue<z;ue++)Q.disableVertexAttribArray(ue)}m.enableAttributes(Q,h),m.bind(),m.setVertexAttribPointers(Q,h,j);for(const ue of b)ue.enableAttributes(Q,h),ue.bind(),ue.setVertexAttribPointers(Q,h,j);for(const ue of R)ue&&(ue.enableAttributes(Q,h),ue.bind(),ue.setVertexAttribPointers(Q,h,j));S&&S.bind(),ee.currentNumAttributes=U}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Id(x,h){const m=Math.pow(2,h.canonical.z),b=h.canonical.y;return[new a.MercatorCoordinate(0,b/m).toLngLat().lat,new a.MercatorCoordinate(0,(b+1)/m).toLngLat().lat]}function Md(x,h,m,b,S,j,R){const z=x.context,U=z.gl,ee=m.fbo;if(!ee)return;x.prepareDrawTile();const Q=x.useProgram("hillshade");z.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,ee.colorAttachment.get());const ue=((we,Ee,he,ve)=>{const Pe=he.paint.get("hillshade-shadow-color"),Ie=he.paint.get("hillshade-highlight-color"),Ve=he.paint.get("hillshade-accent-color");let qe=he.paint.get("hillshade-illumination-direction")*(Math.PI/180);he.paint.get("hillshade-illumination-anchor")==="viewport"&&(qe-=we.transform.angle);const Ue=!we.options.moving;return{u_matrix:ve||we.transform.calculateProjMatrix(Ee.tileID.toUnwrapped(),Ue),u_image:0,u_latrange:Id(0,Ee.tileID),u_light:[he.paint.get("hillshade-exaggeration"),qe],u_shadow:Pe,u_highlight:Ie,u_accent:Ve}})(x,m,b,x.terrain?h.projMatrix:null);x.prepareDrawProgram(z,Q,h.toUnwrapped());const{tileBoundsBuffer:me,tileBoundsIndexBuffer:_e,tileBoundsSegments:Te}=x.getTileBoundsBuffers(m);Q.draw(z,U.TRIANGLES,S,j,R,a.CullFaceMode.disabled,ue,b.id,me,_e,Te)}function ku(x,h,m){if(!h.needsDEMTextureUpload)return;const b=x.context,S=b.gl;b.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||x.getTileTexture(m.stride);const j=m.getPixels();h.demTexture?h.demTexture.update(j,{premultiply:!1}):h.demTexture=new a.Texture(b,j,S.RGBA,{premultiply:!1}),h.needsDEMTextureUpload=!1}function bf(x,h,m,b,S,j){const R=x.context,z=R.gl;if(!h.dem)return;const U=h.dem;if(R.activeTexture.set(z.TEXTURE1),ku(x,h,U),!h.demTexture)return;h.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);const ee=U.dim;R.activeTexture.set(z.TEXTURE0);let Q=h.fbo;if(!Q){const Te=new a.Texture(R,{width:ee,height:ee,data:null},z.RGBA);Te.bind(z.LINEAR,z.CLAMP_TO_EDGE),Q=h.fbo=R.createFramebuffer(ee,ee,!0),Q.colorAttachment.set(Te.texture)}R.bindFramebuffer.set(Q.framebuffer),R.viewport.set([0,0,ee,ee]);const{tileBoundsBuffer:ue,tileBoundsIndexBuffer:me,tileBoundsSegments:_e}=x.getMercatorTileBoundsBuffers();x.useProgram("hillshadePrepare").draw(R,z.TRIANGLES,b,S,j,a.CullFaceMode.disabled,((Te,we)=>{const Ee=we.stride,he=a.create();return a.ortho(he,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(he,he,[0,-a.EXTENT,0]),{u_matrix:he,u_image:1,u_dimension:[Ee,Ee],u_zoom:Te.overscaledZ,u_unpack:we.unpackVector}})(h.tileID,U),m.id,ue,me,_e),h.needsHillshadePrepare=!1}const Tc=x=>({u_matrix:new a.UniformMatrix4f(x),u_image0:new a.Uniform1i(x),u_skirt_height:new a.Uniform1f(x)}),Al=(x,h)=>({u_matrix:x,u_image0:0,u_skirt_height:h}),Tu=(x,h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te)=>({u_proj_matrix:Float32Array.from(x),u_globe_matrix:h,u_normalize_matrix:Float32Array.from(b),u_merc_matrix:m,u_zoom_transition:S,u_merc_center:j,u_image0:0,u_frustum_tl:R,u_frustum_tr:z,u_frustum_br:U,u_frustum_bl:ee,u_globe_pos:Q,u_globe_radius:ue,u_viewport:me,u_grid_matrix:Te?Float32Array.from(Te):new Float32Array(9),u_skirt_height:_e});function Ha(x,h){return x!=null&&h!=null&&!(!x.hasData()||!h.hasData())&&x.demTexture!=null&&h.demTexture!=null&&x.tileID.key!==h.tileID.key}const zs=new class{constructor(){this.operations={}}newMorphing(x,h,m,b,S){if(x in this.operations){const j=this.operations[x];j.to.tileID.key!==m.tileID.key&&(j.queued=m)}else this.operations[x]={startTime:b,phase:0,duration:S,from:h,to:m,queued:null}}getMorphValuesForProxy(x){if(!(x in this.operations))return null;const h=this.operations[x];return{from:h.from,to:h.to,phase:h.phase}}update(x){for(const h in this.operations){const m=this.operations[h];for(m.phase=(x-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,x)){delete this.operations[h];break}}}_nextOp(x,h){return!!x.queued&&(x.from=x.to,x.to=x.queued,x.queued=null,x.phase=0,x.startTime=h,!0)}_validOp(x){return x.from.hasData()&&x.to.hasData()}},Fo={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Su(x){return 6*Math.pow(1.5,22-x)}function wf(x,h){const m=1<<x.z;return!h&&(x.x===0||x.x===m-1)||x.y===0||x.y===m-1}const Bo=x=>({u_matrix:x});function oa(x,h,m,b,S){if(S>0){const j=a.exported.now(),R=(j-x.timeAdded)/S,z=h?(j-h.timeAdded)/S:-1,U=m.getSource(),ee=b.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),Q=!h||Math.abs(h.tileID.overscaledZ-ee)>Math.abs(x.tileID.overscaledZ-ee),ue=Q&&x.refreshedUponExpiration?1:a.clamp(Q?R:1-z,0,1);return x.refreshedUponExpiration&&R>=1&&(x.refreshedUponExpiration=!1),h?{opacity:1,mix:1-ue}:{opacity:ue,mix:0}}return{opacity:1,mix:0}}class Dd extends a.SourceCache{constructor(h){const m={type:"raster-dem",maxzoom:h.transform.maxZoom},b=new be(Pa(),null),S=Pr("mock-dem",m,b,h.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(h,m){h.state="loaded",m(null)}}class Eu extends a.SourceCache{constructor(h){const m=Pr("proxy",{type:"geojson",maxzoom:h.transform.maxZoom},new be(Pa(),null),h.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=h,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(h,m,b){if(h.freezeTileCoverage)return;this.transform=h;const S=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((j,R)=>{if(j[R.key]="",!this._tiles[R.key]){const z=new a.Tile(R,this._source.tileSize*R.overscaleFactor(),h.tileZoom);z.state="loaded",this._tiles[R.key]=z}return j},{});for(const j in this._tiles)j in S||(this.freeFBO(j),this._tiles[j].unloadVectorData(),delete this._tiles[j])}freeFBO(h){const m=this.proxyCachedFBO[h];if(m!==void 0){const b=Object.values(m);this.renderCachePool.push(...b),delete this.proxyCachedFBO[h]}}deallocRenderCache(){this.renderCache.forEach(h=>h.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class fo extends a.OverscaledTileID{constructor(h,m,b){super(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y),this.proxyTileKey=m,this.projMatrix=b}}class C extends a.Elevation{constructor(h,m){super(),this.painter=h,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[b,S,j]=function(U){const ee=new a.StructArrayLayout2i4,Q=new a.StructArrayLayout3ui6,ue=131;ee.reserve(17161),Q.reserve(33800);const me=a.EXTENT/128,_e=a.EXTENT+me/2,Te=_e+me;for(let Ee=-me;Ee<Te;Ee+=me)for(let he=-me;he<Te;he+=me){const ve=he<0||he>_e||Ee<0||Ee>_e?24575:0,Pe=a.clamp(Math.round(he),0,a.EXTENT),Ie=a.clamp(Math.round(Ee),0,a.EXTENT);ee.emplaceBack(Pe+ve,Ie)}const we=(Ee,he)=>{const ve=he*ue+Ee;Q.emplaceBack(ve+1,ve,ve+ue),Q.emplaceBack(ve+ue,ve+ue+1,ve+1)};for(let Ee=1;Ee<129;Ee++)for(let he=1;he<129;he++)we(he,Ee);return[0,129].forEach(Ee=>{for(let he=0;he<130;he++)we(he,Ee),we(Ee,he)}),[ee,Q,32768]}(),R=h.context;this.gridBuffer=R.createVertexBuffer(b,a.posAttributes.members),this.gridIndexBuffer=R.createIndexBuffer(S),this.gridSegments=a.SegmentVector.simpleSegment(0,0,b.length,S.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,b.length,j),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Eu(m.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.EXTENT,0,a.EXTENT,0,1);const z=R.gl;this._overlapStencilMode=new a.StencilMode({func:z.GEQUAL,mask:255},0,255,z.KEEP,z.KEEP,z.REPLACE),this._previousZoom=h.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Dd(m.map)}set style(h){h.on("data",this._onStyleDataEvent.bind(this)),h.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=h,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(h,m,b){if(h&&h.terrain){this._style!==h&&(this.style=h),this.enabled=!0;const S=h.terrain.properties;this.sourceCache=h.terrain.drapeRenderMode===0?this._mockSourceCache:h._getSourceCache(S.get("source")),this._exaggeration=S.get("exaggeration");const j=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const R=this.getScaledDemTileSize();this.sourceCache.update(m,R,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,j(),this._initializing=!0),j(),m.updateElevation(!0,b),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(h){this._findCoveringTileCache[h]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const h=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||h.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${h.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${h.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(h){h.coord&&h.dataType==="source"?this._clearRenderCacheForTile(h.sourceCacheId,h.coord):h.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const h in this._style._sourceCaches)this._style._sourceCaches[h].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(h=>h.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const h=2*this.proxySourceCache.getSource().tileSize;return[h,h]}set useVertexMorphing(h){this._useVertexMorphing=h}updateTileBinding(h){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,b=this.painter.transform;this._initializing&&(this._initializing=b._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(b.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=m.getIds().map(U=>{const ee=m.getTileByID(U).tileID;return ee.projMatrix=b.calculateProjMatrix(ee.toUnwrapped()),ee});(function(U,ee){const Q=ee.transform.pointCoordinate(ee.transform.getCameraPoint()),ue=new a.Point(Q.x,Q.y);U.sort((me,_e)=>{if(_e.overscaledZ-me.overscaledZ)return _e.overscaledZ-me.overscaledZ;const Te=new a.Point(me.canonical.x+(1<<me.canonical.z)*me.wrap,me.canonical.y),we=new a.Point(_e.canonical.x+(1<<_e.canonical.z)*_e.wrap,_e.canonical.y),Ee=ue.mult(1<<me.canonical.z);return Ee.x-=.5,Ee.y-=.5,Ee.distSqr(Te)-Ee.distSqr(we)})})(S,this.painter),this._previousZoom=b.zoom;const j=this.proxyToSource||{};this.proxyToSource={},S.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const R=this._style._sourceCaches;for(const U in R){const ee=R[U];if(!ee.used||(ee!==this.sourceCache&&this.resetTileLookupCache(ee.id),this._setupProxiedCoordsForOrtho(ee,h[U],j),ee.usedForTerrain))continue;const Q=h[U];ee.getSource().reparseOverscaled&&this._assignTerrainTiles(Q)}this.proxiedCoords[m.id]=S.map(U=>new fo(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(j),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const z={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const ee=this.terrainTileForTile[U.key];if(!ee)continue;const Q=ee.tileID.key;Q in z||(this._visibleDemTiles.push(ee),z[Q]=Q)}}_assignTerrainTiles(h){this._initializing||h.forEach(m=>{if(this.terrainTileForTile[m.key])return;const b=this._findTileCoveringTileID(m,this.sourceCache);b&&(this.terrainTileForTile[m.key]=b)})}_prepareDEMTextures(){const h=this.painter.context,m=h.gl;for(const b in this.terrainTileForTile){const S=this.terrainTileForTile[b],j=S.dem;!j||S.demTexture&&!S.needsDEMTextureUpload||(h.activeTexture.set(m.TEXTURE1),ku(this.painter,S,j))}}_prepareDemTileUniforms(h,m,b,S){if(!m||m.demTexture==null)return!1;const j=h.tileID.canonical,R=Math.pow(2,m.tileID.canonical.z-j.z),z=S||"";return b[`u_dem_tl${z}`]=[j.x*R%1,j.y*R%1],b[`u_dem_scale${z}`]=R,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const h=this.painter.context,m=h.gl;if(!this._emptyDepthBufferTexture){const b=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(h,b,m.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let h=0;const m=this._visibleDemTiles.reduce((b,S)=>{if(!S.dem)return b;const j=S.dem.tree.minimums[0];return j>0&&h++,b+j},0);return h?m/h:0}_updateEmptyDEMTexture(){const h=this.painter.context,m=h.gl;h.activeTexture.set(m.TEXTURE2);const b=this._getLoadedAreaMinimum(),S=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(b,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let j=this._emptyDEMTexture;return j?j.update(S,{premultiply:!1}):j=this._emptyDEMTexture=new a.Texture(h,S,m.RGBA,{premultiply:!1}),j}setupElevationDraw(h,m,b){const S=this.painter.context,j=S.gl,R=(z=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(z),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var z;R.u_dem_size=this.sourceCache.getSource().tileSize,R.u_exaggeration=this.exaggeration();let U=null,ee=null,Q=1;if(b&&b.morphing&&this._useVertexMorphing){const ue=b.morphing.srcDemTile,me=b.morphing.dstDemTile;Q=b.morphing.phase,ue&&me&&(this._prepareDemTileUniforms(h,ue,R,"_prev")&&(ee=ue),this._prepareDemTileUniforms(h,me,R)&&(U=me))}if(ee&&U?(S.activeTexture.set(j.TEXTURE2),U.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE,j.NEAREST),S.activeTexture.set(j.TEXTURE4),ee.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE,j.NEAREST),R.u_dem_lerp=Q):(U=this.terrainTileForTile[h.tileID.key],S.activeTexture.set(j.TEXTURE2),(this._prepareDemTileUniforms(h,U,R)?U.demTexture:this.emptyDEMTexture).bind(j.NEAREST,j.CLAMP_TO_EDGE)),S.activeTexture.set(j.TEXTURE3),b&&b.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE),this._depthFBO&&(R.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE),R.u_depth_size_inv=[1,1]),b&&b.useMeterToDem&&U){const ue=(1<<U.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;R.u_meter_to_dem=ue}if(b&&b.labelPlaneMatrixInv&&(R.u_label_plane_matrix_inv=b.labelPlaneMatrixInv),m.setTerrainUniformValues(S,R),this.painter.transform.projection.name==="globe"){const ue=this.globeUniformValues(this.painter.transform,h.tileID.canonical,b&&b.useDenormalizedUpVectorScale);m.setGlobeUniformValues(S,ue)}}globeUniformValues(h,m,b){const S=h.projection;return{u_tile_tl_up:S.upVector(m,0,0),u_tile_tr_up:S.upVector(m,a.EXTENT,0),u_tile_br_up:S.upVector(m,a.EXTENT,a.EXTENT),u_tile_bl_up:S.upVector(m,0,a.EXTENT),u_tile_up_scale:b?a.globeMetersToEcef(1):S.upVectorScale(m,h.center.lat,h.worldSize).metersToTile}}renderToBackBuffer(h){const m=this.painter,b=this.painter.context;h.length!==0&&(b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,j,R,z,U){if(S.transform.projection.name==="globe")(function(ee,Q,ue,me,_e){const Te=ee.context,we=Te.gl;let Ee,he;const ve=ee.options.showTerrainWireframe?2:0,Pe=ee.transform,Ie=a.globeUseCustomAntiAliasing(ee,Te,Pe),Ve=(Et,tt)=>{if(he===Et)return;const ft=[Fo[Et],"PROJECTION_GLOBE_VIEW"];Ie&&ft.push("CUSTOM_ANTIALIASING"),tt&&ft.push(Fo[ve]),Ee=ee.useProgram("globeRaster",null,ft),he=Et},qe=ee.colorModeForRenderPass(),Ue=new a.DepthMode(we.LEQUAL,a.DepthMode.ReadWrite,ee.depthRangeFor3D);zs.update(_e);const Ke=a.calculateGlobeMercatorMatrix(Pe),He=[a.mercatorXfromLng(Pe.center.lng),a.mercatorYfromLat(Pe.center.lat)],rt=ve?[!1,!0]:[!1],At=ee.globeSharedBuffers,Je=[Pe.width*a.exported.devicePixelRatio,Pe.height*a.exported.devicePixelRatio],pt=Float32Array.from(Pe.globeMatrix),at={useDenormalizedUpVectorScale:!0};if(rt.forEach(Et=>{const tt=ee.transform,ft=Su(tt.zoom)*Q.exaggeration();he=-1;const Pt=Et?we.LINES:we.TRIANGLES;for(const _t of me){const Mt=ue.getTile(_t),ir=a.StencilMode.disabled,gr=Q.prevTerrainTileForTile[_t.key],Qt=Q.terrainTileForTile[_t.key];Ha(gr,Qt)&&zs.newMorphing(_t.key,gr,Qt,_e,250),Te.activeTexture.set(we.TEXTURE0),Mt.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE);const ur=zs.getMorphValuesForProxy(_t.key),Rr=ur?1:0;ur&&a.extend$1(at,{morphing:{srcDemTile:ur.from,dstDemTile:ur.to,phase:a.easeCubicInOut(ur.phase)}});const Or=a.tileCornersToBounds(_t.canonical),rr=a.getLatitudinalLod(Or.getCenter().lat),rn=a.getGridMatrix(_t.canonical,Or,rr,tt.worldSize/tt._pixelsPerMercatorPixel),fn=a.globeNormalizeECEF(a.globeTileBounds(_t.canonical)),pn=Tu(tt.projMatrix,pt,Ke,fn,a.globeToMercatorTransition(tt.zoom),He,tt.frustumCorners.TL,tt.frustumCorners.TR,tt.frustumCorners.BR,tt.frustumCorners.BL,tt.globeCenterInViewSpace,tt.globeRadius,Je,ft,rn);if(Ve(Rr,Et),Q.setupElevationDraw(Mt,Ee,at),ee.prepareDrawProgram(Te,Ee,_t.toUnwrapped()),At){const[mn,wa,Ki]=Et?At.getWirefameBuffers(ee.context,rr):At.getGridBuffers(rr,ft!==0);Ee.draw(Te,Pt,Ue,ir,qe,a.CullFaceMode.backCCW,pn,"globe_raster",mn,wa,Ki)}}}),At){const Et=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ie&&Et.push("CUSTOM_ANTIALIASING"),Ee=ee.useProgram("globeRaster",null,Et);for(const tt of me){const{x:ft,y:Pt,z:_t}=tt.canonical,Mt=Pt===0,ir=Pt===(1<<_t)-1,[gr,Qt,ur,Rr]=At.getPoleBuffers(_t);if(Rr&&(Mt||ir)){const Or=ue.getTile(tt);Te.activeTexture.set(we.TEXTURE0),Or.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE);let rr=a.globePoleMatrixForTile(_t,ft,Pe);const rn=a.globeNormalizeECEF(a.globeTileBounds(tt.canonical)),fn=(pn,mn)=>pn.draw(Te,we.TRIANGLES,Ue,a.StencilMode.disabled,qe,a.CullFaceMode.disabled,Tu(Pe.projMatrix,rr,rr,rn,0,He,Pe.frustumCorners.TL,Pe.frustumCorners.TR,Pe.frustumCorners.BR,Pe.frustumCorners.BL,Pe.globeCenterInViewSpace,Pe.globeRadius,Je,0),"globe_pole_raster",mn,ur,Rr);Q.setupElevationDraw(Or,Ee,at),ee.prepareDrawProgram(Te,Ee,tt.toUnwrapped()),Mt&&fn(Ee,gr),ir&&(rr=a.scale(a.create(),rr,[1,-1,1]),fn(Ee,Qt))}}}})(S,j,R,z,U);else{const ee=S.context,Q=ee.gl;let ue,me;const _e=S.options.showTerrainWireframe?2:0,Te=(Pe,Ie)=>{if(me===Pe)return;const Ve=[Fo[Pe]];Ie&&Ve.push(Fo[_e]),ue=S.useProgram("terrainRaster",null,Ve),me=Pe},we=S.colorModeForRenderPass(),Ee=new a.DepthMode(Q.LEQUAL,a.DepthMode.ReadWrite,S.depthRangeFor3D);zs.update(U);const he=S.transform,ve=Su(he.zoom)*j.exaggeration();(_e?[!1,!0]:[!1]).forEach(Pe=>{me=-1;const Ie=Pe?Q.LINES:Q.TRIANGLES,[Ve,qe]=Pe?j.getWirefameBuffer():[j.gridIndexBuffer,j.gridSegments];for(const Ue of z){const Ke=R.getTile(Ue),He=a.StencilMode.disabled,rt=j.prevTerrainTileForTile[Ue.key],At=j.terrainTileForTile[Ue.key];Ha(rt,At)&&zs.newMorphing(Ue.key,rt,At,U,250),ee.activeTexture.set(Q.TEXTURE0),Ke.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE,Q.LINEAR_MIPMAP_NEAREST);const Je=zs.getMorphValuesForProxy(Ue.key),pt=Je?1:0;let at;Je&&(at={morphing:{srcDemTile:Je.from,dstDemTile:Je.to,phase:a.easeCubicInOut(Je.phase)}});const Et=Al(Ue.projMatrix,wf(Ue.canonical,he.renderWorldCopies)?ve/10:ve);Te(pt,Pe),j.setupElevationDraw(Ke,ue,at),S.prepareDrawProgram(ee,ue,Ue.toUnwrapped()),ue.draw(ee,Ie,Ee,He,we,a.CullFaceMode.backCCW,Et,"terrain_raster",j.gridBuffer,Ve,qe)}})}}(m,this,this.proxySourceCache,h,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),h.splice(0,h.length))}renderBatch(h){if(this._drapedRenderBatches.length===0)return h+1;this.renderingToTexture=!0;const m=this.painter,b=this.painter.context,S=this.proxySourceCache,j=this.proxiedCoords[S.id],R=this._drapedRenderBatches.shift(),z=[],U=m.style.order;let ee=0;for(const Q of j){const ue=S.getTileByID(Q.proxyTileKey),me=S.proxyCachedFBO[Q.key]?S.proxyCachedFBO[Q.key][h]:void 0,_e=me!==void 0?S.renderCache[me]:this.pool[ee++],Te=me!==void 0;if(ue.texture=_e.tex,Te&&!_e.dirty){z.push(ue.tileID);continue}let we;b.bindFramebuffer.set(_e.fb.framebuffer),this.renderedToTile=!1,_e.dirty&&(b.clear({color:a.Color.transparent,stencil:0}),_e.dirty=!1);for(let Ee=R.start;Ee<=R.end;++Ee){const he=m.style._layers[U[Ee]];if(he.isHidden(m.transform.zoom))continue;const ve=m.style._getLayerSourceCache(he),Pe=ve?this.proxyToSource[Q.key][ve.id]:[Q];if(!Pe)continue;const Ie=Pe;b.viewport.set([0,0,_e.fb.width,_e.fb.height]),we!==(ve?ve.id:null)&&(this._setupStencil(_e,Pe,he,ve),we=ve?ve.id:null),m.renderLayer(m,ve,he,Ie)}this.renderedToTile?(_e.dirty=!0,z.push(ue.tileID)):Te||--ee,ee===5&&(ee=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height]),R.end+1}postRender(){}renderCacheEfficiency(h){const m=h.order.length;if(m===0)return{efficiency:100};let b,S=0,j=0,R=!1;for(let z=0;z<m;++z){const U=h._layers[h.order[z]];this._style.isLayerDraped(U)?(R&&++S,++j):R||(R=!0,b=U.id)}return j===0?{efficiency:100}:{efficiency:100*(1-S/j),firstUndrapedLayer:b}}getMinElevationBelowMSL(){let h=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{h=Math.min(h,m.dem.tree.minimums[0])}),h===0?h:(h-30)*this._exaggeration}raycast(h,m,b){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(j=>j.dem).map(j=>{const R=j.tileID,z=1<<R.overscaledZ,{x:U,y:ee}=R.canonical,Q=U/z,ue=(U+1)/z,me=ee/z,_e=(ee+1)/z;return{minx:Q,miny:me,maxx:ue,maxy:_e,t:j.dem.tree.raycastRoot(Q,me,ue,_e,h,m,b),tile:j}});S.sort((j,R)=>(j.t!==null?j.t:Number.MAX_VALUE)-(R.t!==null?R.t:Number.MAX_VALUE));for(const j of S){if(j.t==null)return null;const R=j.tile.dem.tree.raycast(j.minx,j.miny,j.maxx,j.maxy,h,m,b);if(R!=null)return R}return null}_createFBO(){const h=this.painter.context,m=h.gl,b=this.drapeBufferSize;h.activeTexture.set(m.TEXTURE0);const S=new a.Texture(h,{width:b[0],height:b[1],data:null},m.RGBA);S.bind(m.LINEAR,m.CLAMP_TO_EDGE);const j=h.createFramebuffer(b[0],b[1],!1);return j.colorAttachment.set(S.texture),j.depthAttachment=new We(h,j.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=h.createRenderbuffer(h.gl.DEPTH_STENCIL,b[0],b[1]),this._stencilRef=0,j.depthAttachment.set(this._sharedDepthStencil),h.clear({stencil:0})):j.depthAttachment.set(this._sharedDepthStencil),h.extTextureFilterAnisotropic&&!h.extTextureFilterAnisotropicForceOff&&m.texParameterf(m.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax),{fb:j,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h].hasTransition())return!0;return this._style.order.some(h=>{const m=this._style._layers[h],b=m.isHidden(this.painter.transform.zoom);return m.type==="custom"?!b&&m.shouldRedrape():!b&&m.hasTransition()})}_clearLineLayersFromRenderCache(){let h=!1;for(const b of this._style._getSources())if(b instanceof zt){h=!0;break}if(!h)return;const m={};for(let b=0;b<this._style.order.length;++b){const S=this._style._layers[this._style.order[b]],j=this._style._getLayerSourceCache(S);if(j&&!m[j.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof a.ZoomDependentExpression){m[j.id]=!0;for(const R of this.proxyCoords){const z=this.proxyToSource[R.key][j.id];if(z)for(const U of z)this._clearRenderCacheForTile(j.id,U)}}}}_clearRasterLayersFromRenderCache(){let h=!1;for(const b in this._style._sourceCaches)if(this._style._sourceCaches[b]._source instanceof vt){h=!0;break}if(!h)return;const m={};for(let b=0;b<this._style.order.length;++b){const S=this._style._layers[this._style.order[b]],j=this._style._getLayerSourceCache(S);if(!j||m[j.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const R=S.paint.get("raster-fade-duration");for(const z of this.proxyCoords){const U=this.proxyToSource[z.key][j.id];if(U)for(const ee of U){const Q=oa(j.getTile(ee),j.findLoadedParent(ee,0),j,this.painter.transform,R);(Q.opacity!==1||Q.mix!==0)&&this._clearRenderCacheForTile(j.id,ee)}}}}_setupDrapedRenderBatches(){const h=this._style.order,m=h.length;if(m===0)return;const b=[];let S,j=0,R=this._style._layers[h[j]];for(;!this._style.isLayerDraped(R)&&R.isHidden(this.painter.transform.zoom)&&++j<m;)R=this._style._layers[h[j]];for(;j<m;++j){const z=this._style._layers[h[j]];z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(z)?S===void 0&&(S=j):S!==void 0&&(b.push({start:S,end:j-1}),S=void 0))}S!==void 0&&b.push({start:S,end:j-1}),this._drapedRenderBatches=b}_setupRenderCache(h){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const R=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let z=0;z<R.length;++z){const U=Object.values(R[z]);m.renderCachePool.push(...U)}}return}this._clearRasterLayersFromRenderCache();const b=this.proxyCoords,S=this._tilesDirty;for(let R=b.length-1;R>=0;R--){const z=b[R];if(m.getTileByID(z.key),m.proxyCachedFBO[z.key]!==void 0){const U=h[z.key],ee=this.proxyToSource[z.key];let Q=0;for(const ue in ee){const me=ee[ue],_e=U[ue];if(!_e||_e.length!==me.length||me.some((Te,we)=>Te!==_e[we]||S[ue]&&S[ue].hasOwnProperty(Te.key))){Q=-1;break}++Q}for(const ue in m.proxyCachedFBO[z.key])m.renderCache[m.proxyCachedFBO[z.key][ue]].dirty=Q<0||Q!==Object.values(U).length}}const j=[...this._drapedRenderBatches];j.sort((R,z)=>z.end-z.start-(R.end-R.start));for(const R of j)for(const z of b){if(m.proxyCachedFBO[z.key])continue;let U=m.renderCachePool.pop();U===void 0&&m.renderCache.length<50&&(U=m.renderCache.length,m.renderCache.push(this._createFBO())),U!==void 0&&(m.proxyCachedFBO[z.key]={},m.proxyCachedFBO[z.key][R.start]=U,m.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(h,m,b,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const j=this.painter.context,R=j.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let z;if(b.isTileClipped())z=m.length,this._overlapStencilMode.test={func:R.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);z=1,this._overlapStencilMode.test={func:R.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+z>255&&(j.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=z,this._overlapStencilMode.ref=this._stencilRef,b.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(h){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[h.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(h,m){const b=this.painter,S=this.painter.context,j=S.gl;b._tileClippingMaskIDs={},S.setColorMode(a.ColorMode.disabled),S.setDepthMode(a.DepthMode.disabled);const R=b.useProgram("clippingMask");for(const z of h){const U=b._tileClippingMaskIDs[z.key]=--m;R.draw(S,j.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:j.ALWAYS,mask:0},U,255,j.KEEP,j.KEEP,j.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Bo(z.projMatrix),"$clipping",b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}}pointCoordinate(h){const m=this.painter.transform;if(h.x<0||h.x>m.width||h.y<0||h.y>m.height)return null;const b=[h.x,h.y,1,1];a.transformMat4$1(b,b,m.pixelMatrixInverse),a.scale$1(b,b,1/b[3]),b[0]/=m.worldSize,b[1]/=m.worldSize;const S=m._camera.position,j=a.mercatorZfromAltitude(1,m.center.lat),R=[S[0],S[1],S[2]/j,0],z=a.subtract([],b.slice(0,3),R);a.normalize(z,z);const U=this.raycast(R,z,this._exaggeration);return U!==null&&U?(a.scaleAndAdd(R,R,z,U),R[3]=R[2],R[2]*=j,R):null}drawDepth(){const h=this.painter,m=h.context,b=this.proxySourceCache,S=Math.ceil(h.width),j=Math.ceil(h.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===j||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const R=m.gl,z=m.createFramebuffer(S,j,!0);m.activeTexture.set(R.TEXTURE0);const U=new a.Texture(m,{width:S,height:j,data:null},R.RGBA);U.bind(R.NEAREST,R.CLAMP_TO_EDGE),z.colorAttachment.set(U.texture);const ee=m.createRenderbuffer(m.gl.DEPTH_COMPONENT16,S,j);z.depthAttachment.set(ee),this._depthFBO=z,this._depthTexture=U}m.bindFramebuffer.set(this._depthFBO.framebuffer),m.viewport.set([0,0,S,j]),function(R,z,U,ee){if(R.transform.projection.name==="globe")return;const Q=R.context,ue=Q.gl;Q.clear({depth:1});const me=R.useProgram("terrainDepth"),_e=new a.DepthMode(ue.LESS,a.DepthMode.ReadWrite,R.depthRangeFor3D);for(const Te of ee){const we=U.getTile(Te),Ee=Al(Te.projMatrix,0);z.setupElevationDraw(we,me),me.draw(Q,ue.TRIANGLES,_e,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,Ee,"terrain_depth",z.gridBuffer,z.gridIndexBuffer,z.gridNoSkirtSegments)}}(h,this,b,this.proxyCoords)}_setupProxiedCoordsForOrtho(h,m,b){if(h.getSource()instanceof vr)return this._setupProxiedCoordsForImageSource(h,m,b);this._findCoveringTileCache[h.id]=this._findCoveringTileCache[h.id]||{};const S=this.proxiedCoords[h.id]=[],j=this.proxyCoords;for(let z=0;z<j.length;z++){const U=j[z],ee=this._findTileCoveringTileID(U,h);if(ee){const Q=this._createProxiedId(U,ee,b[U.key]&&b[U.key][h.id]);S.push(Q),this.proxyToSource[U.key][h.id]=[Q]}}let R=!1;for(let z=0;z<m.length;z++){const U=h.getTile(m[z]);if(!U||!U.hasData())continue;const ee=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(ee&&ee.tileID.canonical.z!==U.tileID.canonical.z){const Q=this.proxyToSource[ee.tileID.key][h.id],ue=this._createProxiedId(ee.tileID,U,b[ee.tileID.key]&&b[ee.tileID.key][h.id]);Q?Q.splice(Q.length-1,0,ue):this.proxyToSource[ee.tileID.key][h.id]=[ue],S.push(ue),R=!0}}this._sourceTilesOverlap[h.id]=R}_setupProxiedCoordsForImageSource(h,m,b){if(!h.getSource().loaded())return;const S=this.proxiedCoords[h.id]=[],j=this.proxyCoords,R=h.getSource(),z=new a.Point(R.tileID.x,R.tileID.y)._div(1<<R.tileID.z),U=R.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((Q,ue)=>(Q.min.x=Math.min(Q.min.x,ue.x-z.x),Q.min.y=Math.min(Q.min.y,ue.y-z.y),Q.max.x=Math.max(Q.max.x,ue.x-z.x),Q.max.y=Math.max(Q.max.y,ue.y-z.y),Q),{min:new a.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),ee=(Q,ue)=>{const me=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),_e=Q.canonical.y/(1<<Q.canonical.z),Te=a.EXTENT/(1<<Q.canonical.z),we=ue.wrap+ue.canonical.x/(1<<ue.canonical.z),Ee=ue.canonical.y/(1<<ue.canonical.z);return me+Te<we+U.min.x||me>we+U.max.x||_e+Te<Ee+U.min.y||_e>Ee+U.max.y};for(let Q=0;Q<j.length;Q++){const ue=j[Q];for(let me=0;me<m.length;me++){const _e=h.getTile(m[me]);if(!_e||!_e.hasData()||ee(ue,_e.tileID))continue;const Te=this._createProxiedId(ue,_e,b[ue.key]&&b[ue.key][h.id]),we=this.proxyToSource[ue.key][h.id];we?we.push(Te):this.proxyToSource[ue.key][h.id]=[Te],S.push(Te)}}}_createProxiedId(h,m,b){let S=this.orthoMatrix;if(b){const j=b.find(R=>R.key===m.tileID.key);if(j)return j}if(m.tileID.key!==h.key){const j=h.canonical.z-m.tileID.canonical.z;let R,z,U;S=a.create();const ee=m.tileID.wrap-h.wrap<<h.overscaledZ;j>0?(R=a.EXTENT>>j,z=R*((m.tileID.canonical.x<<j)-h.canonical.x+ee),U=R*((m.tileID.canonical.y<<j)-h.canonical.y)):(R=a.EXTENT<<-j,z=a.EXTENT*(m.tileID.canonical.x-(h.canonical.x+ee<<-j)),U=a.EXTENT*(m.tileID.canonical.y-(h.canonical.y<<-j))),a.ortho(S,0,R,0,R,0,1),a.translate(S,S,[z,U,0])}return new fo(m.tileID,h.key,S)}_findTileCoveringTileID(h,m){let b=m.getTile(h);if(b&&b.hasData())return b;const S=this._findCoveringTileCache[m.id],j=S[h.key];if(b=j?m.getTileByID(j):null,b&&b.hasData()||j===null)return b;let R=b?b.tileID:h,z=R.overscaledZ;const U=m.getSource().minzoom,ee=[];if(!j){const ue=m.getSource().maxzoom;if(h.canonical.z>=ue){const me=h.canonical.z-ue;m.getSource().reparseOverscaled?(z=Math.max(h.canonical.z+2,m.transform.tileZoom),R=new a.OverscaledTileID(z,h.wrap,ue,h.canonical.x>>me,h.canonical.y>>me)):me!==0&&(z=ue,R=new a.OverscaledTileID(z,h.wrap,ue,h.canonical.x>>me,h.canonical.y>>me))}R.key!==h.key&&(ee.push(R.key),b=m.getTile(R))}const Q=ue=>{ee.forEach(me=>{S[me]=ue}),ee.length=0};for(z-=1;z>=U&&(!b||!b.hasData());z--){b&&Q(b.tileID.key);const ue=R.calculateScaledKey(z);if(b=m.getTileByID(ue),b&&b.hasData())break;const me=S[ue];if(me===null)break;me===void 0?ee.push(ue):b=m.getTileByID(me)}return Q(b?b.tileID.key:null),b&&b.hasData()?b:null}findDEMTileFor(h){return this.enabled?this._findTileCoveringTileID(h,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(h,m){let b=this._tilesDirty[h];b||(b=this._tilesDirty[h]={}),b[m.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const h=function(m){let b=0;const S=new a.StructArrayLayout2ui4,j=131;for(let R=1;R<129;R++){for(let z=1;z<129;z++)b=R*j+z,S.emplaceBack(b,b+1),S.emplaceBack(b,b+j),S.emplaceBack(b+1,b+j),R===128&&S.emplaceBack(b+j,b+j+1);S.emplaceBack(b+1,b+1+j)}return S}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(h),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,h.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Z{static cacheKey(h,m,b,S){let j=`${m}${S?S.cacheKey:""}`;for(const R of b)h.usedDefines.includes(R)&&(j+=`/${R}`);return j}constructor(h,m,b,S,j,R){const z=h.gl;this.program=z.createProgram();const U=function(he){const ve=[];for(let Pe=0;Pe<he.length;Pe++){if(he[Pe]===null)continue;const Ie=he[Pe].split(" ");ve.push(Ie.pop())}return ve}(b.staticAttributes),ee=S?S.getBinderAttributes():[],Q=U.concat(ee);let ue=S?S.defines():[];ue=ue.concat(R.map(he=>`#define ${he}`));const me=h.isWebGL2?`#version 300 es
`:"",_e=me+ue.concat(h.extStandardDerivatives&&me.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(kc):kc,kc,wu,bu.fragmentSource,Sl.fragmentSource,b.fragmentSource).join(`
`),Te=me+ue.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,wu,bu.vertexSource,Sl.vertexSource,$o.vertexSource,b.vertexSource).join(`
`),we=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);z.shaderSource(we,_e),z.compileShader(we),z.attachShader(this.program,we);const Ee=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(Ee,Te),z.compileShader(Ee),z.attachShader(this.program,Ee),this.attributes={},this.numAttributes=Q.length;for(let he=0;he<this.numAttributes;he++)Q[he]&&(z.bindAttribLocation(this.program,he,Q[he]),this.attributes[Q[he]]=he);z.linkProgram(this.program),z.deleteShader(Ee),z.deleteShader(we),this.fixedUniforms=j(h),this.binderUniforms=S?S.getUniforms(h):[],R.includes("TERRAIN")&&(this.terrainUniforms=(he=>({u_dem:new a.Uniform1i(he),u_dem_prev:new a.Uniform1i(he),u_dem_unpack:new a.Uniform4f(he),u_dem_tl:new a.Uniform2f(he),u_dem_scale:new a.Uniform1f(he),u_dem_tl_prev:new a.Uniform2f(he),u_dem_scale_prev:new a.Uniform1f(he),u_dem_size:new a.Uniform1f(he),u_dem_lerp:new a.Uniform1f(he),u_exaggeration:new a.Uniform1f(he),u_depth:new a.Uniform1i(he),u_depth_size_inv:new a.Uniform2f(he),u_meter_to_dem:new a.Uniform1f(he),u_label_plane_matrix_inv:new a.UniformMatrix4f(he)}))(h)),R.includes("GLOBE")&&(this.globeUniforms=(he=>({u_tile_tl_up:new a.Uniform3f(he),u_tile_tr_up:new a.Uniform3f(he),u_tile_br_up:new a.Uniform3f(he),u_tile_bl_up:new a.Uniform3f(he),u_tile_up_scale:new a.Uniform1f(he)}))(h)),R.includes("FOG")&&(this.fogUniforms=(he=>({u_fog_matrix:new a.UniformMatrix4f(he),u_fog_range:new a.Uniform2f(he),u_fog_color:new a.Uniform4f(he),u_fog_horizon_blend:new a.Uniform1f(he),u_fog_temporal_offset:new a.Uniform1f(he),u_frustum_tl:new a.Uniform3f(he),u_frustum_tr:new a.Uniform3f(he),u_frustum_br:new a.Uniform3f(he),u_frustum_bl:new a.Uniform3f(he),u_globe_pos:new a.Uniform3f(he),u_globe_radius:new a.Uniform1f(he),u_globe_transition:new a.Uniform1f(he),u_is_globe:new a.Uniform1i(he),u_viewport:new a.Uniform2f(he)}))(h))}}setTerrainUniformValues(h,m){if(!this.terrainUniforms)return;const b=this.terrainUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const S in m)b[S]&&b[S].set(this.program,S,m[S])}}setGlobeUniformValues(h,m){if(!this.globeUniforms)return;const b=this.globeUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const S in m)b[S]&&b[S].set(this.program,S,m[S])}}setFogUniformValues(h,m){if(!this.fogUniforms)return;const b=this.fogUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const S in m)b[S].set(this.program,S,m[S])}}draw(h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te,we){const Ee=h.gl;if(this.failedToCreate)return;h.program.set(this.program),h.setDepthMode(b),h.setStencilMode(S),h.setColorMode(j),h.setCullFace(R);for(const ve of Object.keys(this.fixedUniforms))this.fixedUniforms[ve].set(this.program,ve,z[ve]);Te&&Te.setUniforms(this.program,h,this.binderUniforms,me,{zoom:_e});const he={[Ee.LINES]:2,[Ee.TRIANGLES]:3,[Ee.LINE_STRIP]:1}[m];for(const ve of ue.get()){const Pe=ve.vaos||(ve.vaos={});(Pe[U]||(Pe[U]=new im)).bind(h,this,ee,Te?Te.getPaintVertexBuffers():[],Q,ve.vertexOffset,we||[]),Ee.drawElements(m,ve.primitiveLength*he,Ee.UNSIGNED_SHORT,ve.primitiveOffset*he*2)}}}function de(x,h){const m=Math.pow(2,h.tileID.overscaledZ),b=h.tileSize*Math.pow(2,x.transform.tileZoom)/m,S=b*(h.tileID.canonical.x+h.tileID.wrap*m),j=b*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_tile_units_to_pixels:1/Ce(h,1,x.transform.tileZoom),u_pixel_coord_upper:[S>>16,j>>16],u_pixel_coord_lower:[65535&S,65535&j]}}const ke=a.create(),et=(x,h,m,b,S,j,R,z,U,ee,Q)=>{const ue=h.style.light,me=ue.properties.get("position"),_e=[me.x,me.y,me.z],Te=a.create$1();ue.properties.get("anchor")==="viewport"&&(a.fromRotation(Te,-h.transform.angle),a.transformMat3(_e,_e,Te));const we=ue.properties.get("color"),Ee=h.transform,he={u_matrix:x,u_lightpos:_e,u_lightintensity:ue.properties.get("intensity"),u_lightcolor:[we.r,we.g,we.b],u_vertical_gradient:+m,u_opacity:b,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ke,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:j};return Ee.projection.name==="globe"&&(he.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],he.u_zoom_transition=U,he.u_inv_rot_matrix=Q,he.u_merc_center=ee,he.u_up_dir=Ee.projection.upVector(new a.CanonicalTileID(0,0,0),ee[0]*a.EXTENT,ee[1]*a.EXTENT),he.u_height_lift=z),he},ut=(x,h,m,b,S,j,R,z,U,ee,Q,ue)=>{const me=et(x,h,m,b,S,j,R,U,ee,Q,ue),_e={u_height_factor:-Math.pow(2,R.overscaledZ)/z.tileSize/8};return a.extend(me,de(h,z),_e)},Gt=x=>({u_matrix:x}),un=(x,h,m)=>a.extend(Gt(x),de(h,m)),$i=(x,h)=>({u_matrix:x,u_world:h}),Qr=(x,h,m,b)=>a.extend(un(x,h,m),{u_world:b}),Wi=a.create(),Ii=(x,h,m,b,S,j)=>{const R=x.transform,z=R.projection.name==="globe";let U;if(j.paint.get("circle-pitch-alignment")==="map")if(z){const Q=a.globePixelsToTileUnits(R.zoom,h.canonical)*R._pixelsPerMercatorPixel;U=Float32Array.from([Q,0,0,Q])}else U=R.calculatePixelsToTileUnitsMatrix(m);else U=new Float32Array([R.pixelsToGLUnits[0],0,0,R.pixelsToGLUnits[1]]);const ee={u_camera_to_center_distance:R.cameraToCenterDistance,u_matrix:x.translatePosMatrix(h.projMatrix,m,j.paint.get("circle-translate"),j.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:U,u_inv_rot_matrix:Wi,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){ee.u_inv_rot_matrix=b,ee.u_merc_center=S,ee.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],ee.u_zoom_transition=a.globeToMercatorTransition(R.zoom);const Q=S[0]*a.EXTENT,ue=S[1]*a.EXTENT;ee.u_up_dir=R.projection.upVector(new a.CanonicalTileID(0,0,0),Q,ue)}return ee},Vo=x=>{const h=[];return x.paint.get("circle-pitch-alignment")==="map"&&h.push("PITCH_WITH_MAP"),x.paint.get("circle-pitch-scale")==="map"&&h.push("SCALE_WITH_MAP"),h},Da=(x,h,m,b)=>{const S=a.EXTENT/m.tileSize;return{u_matrix:x,u_camera_to_center_distance:h.getCameraToCenterDistance(b),u_extrude_scale:[h.pixelsToGLUnits[0]/S,h.pixelsToGLUnits[1]/S]}},Nl=(x,h,m=1)=>({u_matrix:x,u_color:h,u_overlay:0,u_overlay_scale:m}),Od=a.create(),Cb=(x,h,m,b,S,j,R)=>{const z=x.transform,U=z.projection.name==="globe",ee=U?a.globePixelsToTileUnits(z.zoom,h.canonical)*z._pixelsPerMercatorPixel:Ce(m,1,j),Q={u_matrix:h.projMatrix,u_extrude_scale:ee,u_intensity:R,u_inv_rot_matrix:Od,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){Q.u_inv_rot_matrix=b,Q.u_merc_center=S,Q.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],Q.u_zoom_transition=a.globeToMercatorTransition(z.zoom);const ue=S[0]*a.EXTENT,me=S[1]*a.EXTENT;Q.u_up_dir=z.projection.upVector(new a.CanonicalTileID(0,0,0),ue,me)}return Q},hE=(x,h,m,b,S,j,R)=>{const z=x.transform,U=z.calculatePixelsToTileUnitsMatrix(h);return{u_matrix:hy(x,h,m,b),u_pixels_to_tile_units:U,u_device_pixel_ratio:j,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:Tf(m)?h.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Rd(h,x.transform),u_alpha_discard_threshold:0,u_trim_offset:R}},kf=(x,h,m,b,S)=>{const j=x.transform;return{u_matrix:hy(x,h,m,b),u_texsize:h.imageAtlasTexture.size,u_pixels_to_tile_units:j.calculatePixelsToTileUnitsMatrix(h),u_device_pixel_ratio:S,u_image:0,u_tile_units_to_pixels:Rd(h,j),u_units_to_pixels:[1/j.pixelsToGLUnits[0],1/j.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Rd(x,h){return 1/Ce(x,1,h.tileZoom)}function hy(x,h,m,b){return x.translatePosMatrix(b||h.tileID.projMatrix,h,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function Tf(x){const h=x.paint.get("line-dasharray").value;return h.value||h.kind!=="constant"}const fy=(x,h,m,b,S,j)=>{return{u_matrix:x,u_tl_parent:h,u_scale_parent:m,u_fade_t:b.mix,u_opacity:b.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(z=S.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(R=S.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:Uo(S.paint.get("raster-hue-rotate")),u_perspective_transform:j};var R,z};function Uo(x){x*=Math.PI/180;const h=Math.sin(x),m=Math.cos(x);return[(2*m+1)/3,(-Math.sqrt(3)*h-m+1)/3,(Math.sqrt(3)*h-m+1)/3]}const am=a.create(),py=(x,h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te,we)=>{const Ee=S.transform,he={u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:Ee.cameraToCenterDistance,u_rotate_symbol:+m,u_aspect_ratio:Ee.width/Ee.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:j,u_label_plane_matrix:R,u_coord_matrix:z,u_is_text:+U,u_pitch_with_map:+b,u_texsize:ee,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:am,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:am,u_up_vector:[0,-1,0]};return we.name==="globe"&&(he.u_tile_id=[Q.canonical.x,Q.canonical.y,1<<Q.canonical.z],he.u_zoom_transition=ue,he.u_inv_rot_matrix=_e,he.u_merc_center=me,he.u_camera_forward=Ee._camera.forward(),he.u_ecef_origin=a.globeECEFOrigin(Ee.globeMatrix,Q.toUnwrapped()),he.u_tile_matrix=Float32Array.from(Ee.globeMatrix),he.u_up_vector=Te),he},sm=(x,h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te,we,Ee)=>a.extend(py(x,h,m,b,S,j,R,z,U,ee,ue,me,_e,Te,we,Ee),{u_gamma_scale:b?S.transform.cameraToCenterDistance*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+Q}),Pb=(x,h,m,b,S,j,R,z,U,ee,Q,ue,me,_e,Te,we)=>a.extend(sm(x,h,m,b,S,j,R,z,!0,U,!0,Q,ue,me,_e,Te,we),{u_texsize_icon:ee,u_texture_icon:1}),my=(x,h,m)=>({u_matrix:x,u_opacity:h,u_color:m}),fE=(x,h,m,b,S)=>a.extend(function(j,R,z){const U=R.imageManager.getPattern(j.toString()),{width:ee,height:Q}=R.imageManager.getPixelSize(),ue=Math.pow(2,z.tileID.overscaledZ),me=z.tileSize*Math.pow(2,R.transform.tileZoom)/ue,_e=me*(z.tileID.canonical.x+z.tileID.wrap*ue),Te=me*z.tileID.canonical.y;return{u_image:0,u_pattern_tl:U.tl,u_pattern_br:U.br,u_texsize:[ee,Q],u_pattern_size:U.displaySize,u_tile_units_to_pixels:1/Ce(z,1,R.transform.tileZoom),u_pixel_coord_upper:[_e>>16,Te>>16],u_pixel_coord_lower:[65535&_e,65535&Te]}}(b,m,S),{u_matrix:x,u_opacity:h}),gy={fillExtrusion:x=>({u_matrix:new a.UniformMatrix4f(x),u_lightpos:new a.Uniform3f(x),u_lightintensity:new a.Uniform1f(x),u_lightcolor:new a.Uniform3f(x),u_vertical_gradient:new a.Uniform1f(x),u_opacity:new a.Uniform1f(x),u_edge_radius:new a.Uniform1f(x),u_ao:new a.Uniform2f(x),u_tile_id:new a.Uniform3f(x),u_zoom_transition:new a.Uniform1f(x),u_inv_rot_matrix:new a.UniformMatrix4f(x),u_merc_center:new a.Uniform2f(x),u_up_dir:new a.Uniform3f(x),u_height_lift:new a.Uniform1f(x)}),fillExtrusionPattern:x=>({u_matrix:new a.UniformMatrix4f(x),u_lightpos:new a.Uniform3f(x),u_lightintensity:new a.Uniform1f(x),u_lightcolor:new a.Uniform3f(x),u_vertical_gradient:new a.Uniform1f(x),u_height_factor:new a.Uniform1f(x),u_edge_radius:new a.Uniform1f(x),u_ao:new a.Uniform2f(x),u_tile_id:new a.Uniform3f(x),u_zoom_transition:new a.Uniform1f(x),u_inv_rot_matrix:new a.UniformMatrix4f(x),u_merc_center:new a.Uniform2f(x),u_up_dir:new a.Uniform3f(x),u_height_lift:new a.Uniform1f(x),u_image:new a.Uniform1i(x),u_texsize:new a.Uniform2f(x),u_pixel_coord_upper:new a.Uniform2f(x),u_pixel_coord_lower:new a.Uniform2f(x),u_tile_units_to_pixels:new a.Uniform1f(x),u_opacity:new a.Uniform1f(x)}),fill:x=>({u_matrix:new a.UniformMatrix4f(x)}),fillPattern:x=>({u_matrix:new a.UniformMatrix4f(x),u_image:new a.Uniform1i(x),u_texsize:new a.Uniform2f(x),u_pixel_coord_upper:new a.Uniform2f(x),u_pixel_coord_lower:new a.Uniform2f(x),u_tile_units_to_pixels:new a.Uniform1f(x)}),fillOutline:x=>({u_matrix:new a.UniformMatrix4f(x),u_world:new a.Uniform2f(x)}),fillOutlinePattern:x=>({u_matrix:new a.UniformMatrix4f(x),u_world:new a.Uniform2f(x),u_image:new a.Uniform1i(x),u_texsize:new a.Uniform2f(x),u_pixel_coord_upper:new a.Uniform2f(x),u_pixel_coord_lower:new a.Uniform2f(x),u_tile_units_to_pixels:new a.Uniform1f(x)}),circle:x=>({u_camera_to_center_distance:new a.Uniform1f(x),u_extrude_scale:new a.UniformMatrix2f(x),u_device_pixel_ratio:new a.Uniform1f(x),u_matrix:new a.UniformMatrix4f(x),u_inv_rot_matrix:new a.UniformMatrix4f(x),u_merc_center:new a.Uniform2f(x),u_tile_id:new a.Uniform3f(x),u_zoom_transition:new a.Uniform1f(x),u_up_dir:new a.Uniform3f(x)}),collisionBox:x=>({u_matrix:new a.UniformMatrix4f(x),u_camera_to_center_distance:new a.Uniform1f(x),u_extrude_scale:new a.Uniform2f(x)}),collisionCircle:x=>({u_matrix:new a.UniformMatrix4f(x),u_inv_matrix:new a.UniformMatrix4f(x),u_camera_to_center_distance:new a.Uniform1f(x),u_viewport_size:new a.Uniform2f(x)}),debug:x=>({u_color:new a.UniformColor(x),u_matrix:new a.UniformMatrix4f(x),u_overlay:new a.Uniform1i(x),u_overlay_scale:new a.Uniform1f(x)}),clippingMask:x=>({u_matrix:new a.UniformMatrix4f(x)}),heatmap:x=>({u_extrude_scale:new a.Uniform1f(x),u_intensity:new a.Uniform1f(x),u_matrix:new a.UniformMatrix4f(x),u_inv_rot_matrix:new a.UniformMatrix4f(x),u_merc_center:new a.Uniform2f(x),u_tile_id:new a.Uniform3f(x),u_zoom_transition:new a.Uniform1f(x),u_up_dir:new a.Uniform3f(x)}),heatmapTexture:x=>({u_image:new a.Uniform1i(x),u_color_ramp:new a.Uniform1i(x),u_opacity:new a.Uniform1f(x)}),hillshade:x=>({u_matrix:new a.UniformMatrix4f(x),u_image:new a.Uniform1i(x),u_latrange:new a.Uniform2f(x),u_light:new a.Uniform2f(x),u_shadow:new a.UniformColor(x),u_highlight:new a.UniformColor(x),u_accent:new a.UniformColor(x)}),hillshadePrepare:x=>({u_matrix:new a.UniformMatrix4f(x),u_image:new a.Uniform1i(x),u_dimension:new a.Uniform2f(x),u_zoom:new a.Uniform1f(x),u_unpack:new a.Uniform4f(x)}),line:x=>({u_matrix:new a.UniformMatrix4f(x),u_pixels_to_tile_units:new a.UniformMatrix2f(x),u_device_pixel_ratio:new a.Uniform1f(x),u_units_to_pixels:new a.Uniform2f(x),u_dash_image:new a.Uniform1i(x),u_gradient_image:new a.Uniform1i(x),u_image_height:new a.Uniform1f(x),u_texsize:new a.Uniform2f(x),u_tile_units_to_pixels:new a.Uniform1f(x),u_alpha_discard_threshold:new a.Uniform1f(x),u_trim_offset:new a.Uniform2f(x)}),linePattern:x=>({u_matrix:new a.UniformMatrix4f(x),u_texsize:new a.Uniform2f(x),u_pixels_to_tile_units:new a.UniformMatrix2f(x),u_device_pixel_ratio:new a.Uniform1f(x),u_image:new a.Uniform1i(x),u_units_to_pixels:new a.Uniform2f(x),u_tile_units_to_pixels:new a.Uniform1f(x),u_alpha_discard_threshold:new a.Uniform1f(x)}),raster:x=>({u_matrix:new a.UniformMatrix4f(x),u_tl_parent:new a.Uniform2f(x),u_scale_parent:new a.Uniform1f(x),u_fade_t:new a.Uniform1f(x),u_opacity:new a.Uniform1f(x),u_image0:new a.Uniform1i(x),u_image1:new a.Uniform1i(x),u_brightness_low:new a.Uniform1f(x),u_brightness_high:new a.Uniform1f(x),u_saturation_factor:new a.Uniform1f(x),u_contrast_factor:new a.Uniform1f(x),u_spin_weights:new a.Uniform3f(x),u_perspective_transform:new a.Uniform2f(x)}),symbolIcon:x=>({u_is_size_zoom_constant:new a.Uniform1i(x),u_is_size_feature_constant:new a.Uniform1i(x),u_size_t:new a.Uniform1f(x),u_size:new a.Uniform1f(x),u_camera_to_center_distance:new a.Uniform1f(x),u_rotate_symbol:new a.Uniform1i(x),u_aspect_ratio:new a.Uniform1f(x),u_fade_change:new a.Uniform1f(x),u_matrix:new a.UniformMatrix4f(x),u_label_plane_matrix:new a.UniformMatrix4f(x),u_coord_matrix:new a.UniformMatrix4f(x),u_is_text:new a.Uniform1i(x),u_pitch_with_map:new a.Uniform1i(x),u_texsize:new a.Uniform2f(x),u_tile_id:new a.Uniform3f(x),u_zoom_transition:new a.Uniform1f(x),u_inv_rot_matrix:new a.UniformMatrix4f(x),u_merc_center:new a.Uniform2f(x),u_camera_forward:new a.Uniform3f(x),u_tile_matrix:new a.UniformMatrix4f(x),u_up_vector:new a.Uniform3f(x),u_ecef_origin:new a.Uniform3f(x),u_texture:new a.Uniform1i(x)}),symbolSDF:x=>({u_is_size_zoom_constant:new a.Uniform1i(x),u_is_size_feature_constant:new a.Uniform1i(x),u_size_t:new a.Uniform1f(x),u_size:new a.Uniform1f(x),u_camera_to_center_distance:new a.Uniform1f(x),u_rotate_symbol:new a.Uniform1i(x),u_aspect_ratio:new a.Uniform1f(x),u_fade_change:new a.Uniform1f(x),u_matrix:new a.UniformMatrix4f(x),u_label_plane_matrix:new a.UniformMatrix4f(x),u_coord_matrix:new a.UniformMatrix4f(x),u_is_text:new a.Uniform1i(x),u_pitch_with_map:new a.Uniform1i(x),u_texsize:new a.Uniform2f(x),u_texture:new a.Uniform1i(x),u_gamma_scale:new a.Uniform1f(x),u_device_pixel_ratio:new a.Uniform1f(x),u_tile_id:new a.Uniform3f(x),u_zoom_transition:new a.Uniform1f(x),u_inv_rot_matrix:new a.UniformMatrix4f(x),u_merc_center:new a.Uniform2f(x),u_camera_forward:new a.Uniform3f(x),u_tile_matrix:new a.UniformMatrix4f(x),u_up_vector:new a.Uniform3f(x),u_ecef_origin:new a.Uniform3f(x),u_is_halo:new a.Uniform1i(x)}),symbolTextAndIcon:x=>({u_is_size_zoom_constant:new a.Uniform1i(x),u_is_size_feature_constant:new a.Uniform1i(x),u_size_t:new a.Uniform1f(x),u_size:new a.Uniform1f(x),u_camera_to_center_distance:new a.Uniform1f(x),u_rotate_symbol:new a.Uniform1i(x),u_aspect_ratio:new a.Uniform1f(x),u_fade_change:new a.Uniform1f(x),u_matrix:new a.UniformMatrix4f(x),u_label_plane_matrix:new a.UniformMatrix4f(x),u_coord_matrix:new a.UniformMatrix4f(x),u_is_text:new a.Uniform1i(x),u_pitch_with_map:new a.Uniform1i(x),u_texsize:new a.Uniform2f(x),u_texsize_icon:new a.Uniform2f(x),u_texture:new a.Uniform1i(x),u_texture_icon:new a.Uniform1i(x),u_gamma_scale:new a.Uniform1f(x),u_device_pixel_ratio:new a.Uniform1f(x),u_is_halo:new a.Uniform1i(x)}),background:x=>({u_matrix:new a.UniformMatrix4f(x),u_opacity:new a.Uniform1f(x),u_color:new a.UniformColor(x)}),backgroundPattern:x=>({u_matrix:new a.UniformMatrix4f(x),u_opacity:new a.Uniform1f(x),u_image:new a.Uniform1i(x),u_pattern_tl:new a.Uniform2f(x),u_pattern_br:new a.Uniform2f(x),u_texsize:new a.Uniform2f(x),u_pattern_size:new a.Uniform2f(x),u_pixel_coord_upper:new a.Uniform2f(x),u_pixel_coord_lower:new a.Uniform2f(x),u_tile_units_to_pixels:new a.Uniform1f(x)}),terrainRaster:Tc,terrainDepth:Tc,skybox:x=>({u_matrix:new a.UniformMatrix4f(x),u_sun_direction:new a.Uniform3f(x),u_cubemap:new a.Uniform1i(x),u_opacity:new a.Uniform1f(x),u_temporal_offset:new a.Uniform1f(x)}),skyboxGradient:x=>({u_matrix:new a.UniformMatrix4f(x),u_color_ramp:new a.Uniform1i(x),u_center_direction:new a.Uniform3f(x),u_radius:new a.Uniform1f(x),u_opacity:new a.Uniform1f(x),u_temporal_offset:new a.Uniform1f(x)}),skyboxCapture:x=>({u_matrix_3f:new a.UniformMatrix3f(x),u_sun_direction:new a.Uniform3f(x),u_sun_intensity:new a.Uniform1f(x),u_color_tint_r:new a.Uniform4f(x),u_color_tint_m:new a.Uniform4f(x),u_luminance:new a.Uniform1f(x)}),globeRaster:x=>({u_proj_matrix:new a.UniformMatrix4f(x),u_globe_matrix:new a.UniformMatrix4f(x),u_normalize_matrix:new a.UniformMatrix4f(x),u_merc_matrix:new a.UniformMatrix4f(x),u_zoom_transition:new a.Uniform1f(x),u_merc_center:new a.Uniform2f(x),u_image0:new a.Uniform1i(x),u_grid_matrix:new a.UniformMatrix3f(x),u_skirt_height:new a.Uniform1f(x),u_frustum_tl:new a.Uniform3f(x),u_frustum_tr:new a.Uniform3f(x),u_frustum_br:new a.Uniform3f(x),u_frustum_bl:new a.Uniform3f(x),u_globe_pos:new a.Uniform3f(x),u_globe_radius:new a.Uniform1f(x),u_viewport:new a.Uniform2f(x)}),globeAtmosphere:x=>({u_frustum_tl:new a.Uniform3f(x),u_frustum_tr:new a.Uniform3f(x),u_frustum_br:new a.Uniform3f(x),u_frustum_bl:new a.Uniform3f(x),u_horizon:new a.Uniform1f(x),u_transition:new a.Uniform1f(x),u_fadeout_range:new a.Uniform1f(x),u_color:new a.Uniform4f(x),u_high_color:new a.Uniform4f(x),u_space_color:new a.Uniform4f(x),u_star_intensity:new a.Uniform1f(x),u_star_density:new a.Uniform1f(x),u_star_size:new a.Uniform1f(x),u_temporal_offset:new a.Uniform1f(x),u_horizon_angle:new a.Uniform1f(x),u_rotation_matrix:new a.UniformMatrix4f(x)})};let om;function Sf(x,h,m,b,S,j,R){const z=x.context,U=z.gl,ee=x.transform,Q=x.useProgram("collisionBox"),ue=[];let me=0,_e=0;for(let Ie=0;Ie<b.length;Ie++){const Ve=b[Ie],qe=h.getTile(Ve),Ue=qe.getBucket(m);if(!Ue)continue;const Ke=aa(Ve,Ue,ee);let He=Ke;S[0]===0&&S[1]===0||(He=x.translatePosMatrix(Ke,qe,S,j));const rt=R?Ue.textCollisionBox:Ue.iconCollisionBox,At=Ue.collisionCircleArray;if(At.length>0){const Je=a.create(),pt=He;a.mul(Je,Ue.placementInvProjMatrix,ee.glCoordMatrix),a.mul(Je,Je,Ue.placementViewportMatrix),ue.push({circleArray:At,circleOffset:_e,transform:pt,invTransform:Je,projection:Ue.getProjection()}),me+=At.length/4,_e=me}rt&&(x.terrain&&x.terrain.setupElevationDraw(qe,Q),Q.draw(z,U.LINES,a.DepthMode.disabled,a.StencilMode.disabled,x.colorModeForRenderPass(),a.CullFaceMode.disabled,Da(He,ee,qe,Ue.getProjection()),m.id,rt.layoutVertexBuffer,rt.indexBuffer,rt.segments,null,ee.zoom,null,[rt.collisionVertexBuffer,rt.collisionVertexBufferExt]))}if(!R||!ue.length)return;const Te=x.useProgram("collisionCircle"),we=new a.StructArrayLayout2f1f2i16;we.resize(4*me),we._trim();let Ee=0;for(const Ie of ue)for(let Ve=0;Ve<Ie.circleArray.length/4;Ve++){const qe=4*Ve,Ue=Ie.circleArray[qe+0],Ke=Ie.circleArray[qe+1],He=Ie.circleArray[qe+2],rt=Ie.circleArray[qe+3];we.emplace(Ee++,Ue,Ke,He,rt,0),we.emplace(Ee++,Ue,Ke,He,rt,1),we.emplace(Ee++,Ue,Ke,He,rt,2),we.emplace(Ee++,Ue,Ke,He,rt,3)}(!om||om.length<2*me)&&(om=function(Ie){const Ve=2*Ie,qe=new a.StructArrayLayout3ui6;qe.resize(Ve),qe._trim();for(let Ue=0;Ue<Ve;Ue++){const Ke=6*Ue;qe.uint16[Ke+0]=4*Ue+0,qe.uint16[Ke+1]=4*Ue+1,qe.uint16[Ke+2]=4*Ue+2,qe.uint16[Ke+3]=4*Ue+2,qe.uint16[Ke+4]=4*Ue+3,qe.uint16[Ke+5]=4*Ue+0}return qe}(me));const he=z.createIndexBuffer(om,!0),ve=z.createVertexBuffer(we,a.collisionCircleLayout.members,!0);for(const Ie of ue){const Ve={u_matrix:Ie.transform,u_inv_matrix:Ie.invTransform,u_camera_to_center_distance:(Pe=ee).getCameraToCenterDistance(Ie.projection),u_viewport_size:[Pe.width,Pe.height]};Te.draw(z,U.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,x.colorModeForRenderPass(),a.CullFaceMode.disabled,Ve,m.id,ve,he,a.SegmentVector.simpleSegment(0,2*Ie.circleOffset,Ie.circleArray.length,Ie.circleArray.length/2),null,ee.zoom)}var Pe;ve.destroy(),he.destroy()}const Ib=a.create();function yy({width:x,height:h,anchor:m,textOffset:b,textScale:S},j){const{horizontalAlign:R,verticalAlign:z}=a.getAnchorAlignment(m),U=-(R-.5)*x,ee=-(z-.5)*h,Q=a.evaluateVariableOffset(m,b);return new a.Point((U/S+Q[0])*j,(ee/S+Q[1])*j)}function pE(x,h,m,b,S,j,R,z,U,ee,Q){const ue=x.text.placedSymbolArray,me=x.text.dynamicLayoutVertexArray,_e=x.icon.dynamicLayoutVertexArray,Te={},we=x.getProjection(),Ee=an(z,we,j),he=j.elevation,ve=we.upVectorScale(z.canonical,j.center.lat,j.worldSize).metersToTile;me.clear();for(let Pe=0;Pe<ue.length;Pe++){const Ie=ue.get(Pe),{tileAnchorX:Ve,tileAnchorY:qe,numGlyphs:Ue}=Ie,Ke=Ie.hidden||!Ie.crossTileID||x.allowVerticalPlacement&&!Ie.placedOrientation?null:b[Ie.crossTileID];if(Ke){let He=0,rt=0,At=0;if(he){const Mt=he?he.getAtTileOffset(z,Ve,qe):0,[ir,gr,Qt]=we.upVector(z.canonical,Ve,qe);He=Mt*ir*ve,rt=Mt*gr*ve,At=Mt*Qt*ve}let[Je,pt,at,Et]=ci(Ie.projectedAnchorX+He,Ie.projectedAnchorY+rt,Ie.projectedAnchorZ+At,m?Ee:R);const tt=jd(j.getCameraToCenterDistance(we),Et);let ft=S.evaluateSizeForFeature(x.textSizeData,ee,Ie)*tt/a.ONE_EM;m&&(ft*=x.tilePixelRatio/U);const Pt=yy(Ke,ft);m?({x:Je,y:pt,z:at}=we.projectTilePoint(Ve+Pt.x,qe+Pt.y,z.canonical),[Je,pt,at]=ci(Je+He,pt+rt,at+At,R)):(h&&Pt._rotate(-j.angle),Je+=Pt.x,pt+=Pt.y,at=0);const _t=x.allowVerticalPlacement&&Ie.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let Mt=0;Mt<Ue;Mt++)a.addDynamicAttributes(me,Je,pt,at,_t);Q&&Ie.associatedIconIndex>=0&&(Te[Ie.associatedIconIndex]={x:Je,y:pt,z:at,angle:_t})}else yi(Ue,me)}if(Q){_e.clear();const Pe=x.icon.placedSymbolArray;for(let Ie=0;Ie<Pe.length;Ie++){const Ve=Pe.get(Ie),{numGlyphs:qe}=Ve,Ue=Te[Ie];if(Ve.hidden||!Ue)yi(qe,_e);else{const{x:Ke,y:He,z:rt,angle:At}=Ue;for(let Je=0;Je<qe;Je++)a.addDynamicAttributes(_e,Ke,He,rt,At)}}x.icon.dynamicLayoutVertexBuffer.updateData(_e)}x.text.dynamicLayoutVertexBuffer.updateData(me)}function xy(x,h,m){return m.iconsInText&&h?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function Mb(x,h,m,b,S,j,R,z,U,ee,Q,ue){const me=x.context,_e=me.gl,Te=x.transform,we=z==="map",Ee=U==="map",he=we&&m.layout.get("symbol-placement")!=="point",ve=we&&!Ee&&!he,Pe=m.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Ie=!1;const Ve=x.depthModeForSublayer(0,a.DepthMode.ReadOnly),qe=[a.mercatorXfromLng(Te.center.lng),a.mercatorYfromLat(Te.center.lat)],Ue=m.layout.get("text-variable-anchor"),Ke=Te.projection.name==="globe",He=[],rt=[0,-1,0];let At=rt;!Ke&&!Te.mercatorFromTransition||we||(At=function(Je){const pt=Je._camera.getWorldToCamera(Je.worldSize,1),at=a.multiply([],pt,Je.globeMatrix);a.invert(at,at);const Et=[0,0,0],tt=[0,1,0,0];return a.transformMat4$1(tt,tt,at),Et[0]=tt[0],Et[1]=tt[1],Et[2]=tt[2],a.normalize(Et,Et),Et}(Te));for(const Je of b){const pt=h.getTile(Je),at=pt.getBucket(m);if(!at||at.projection.name==="mercator"&&Ke)continue;const Et=S?at.text:at.icon;if(!Et||at.fullyClipped||!Et.segments.get().length)continue;const tt=Et.programConfigurations.get(m.id),ft=S||at.sdfIcons,Pt=S?at.textSizeData:at.iconSizeData,_t=Ee||Te.pitch!==0,Mt=a.evaluateSizeForZoom(Pt,Te.zoom);let ir,gr,Qt,ur,Rr=[0,0],Or=null;if(S)gr=pt.glyphAtlasTexture,Qt=_e.LINEAR,ir=pt.glyphAtlasTexture.size,at.iconsInText&&(Rr=pt.imageAtlasTexture.size,Or=pt.imageAtlasTexture,ur=_t||x.options.rotating||x.options.zooming||Pt.kind==="composite"||Pt.kind==="camera"?_e.LINEAR:_e.NEAREST);else{const Il=m.layout.get("icon-size").constantOr(0)!==1||at.iconsNeedLinear;gr=pt.imageAtlasTexture,Qt=ft||x.options.rotating||x.options.zooming||Il||_t?_e.LINEAR:_e.NEAREST,ir=pt.imageAtlasTexture.size}const rr=at.projection.name==="globe",rn=rr?At:rt,fn=rr?a.globeToMercatorTransition(Te.zoom):0,pn=an(Je,at.getProjection(),Te),mn=Te.calculatePixelsToTileUnitsMatrix(pt),wa=lt(pn,pt.tileID.canonical,Ee,we,Te,at.getProjection(),mn),Ki=x.terrain&&Ee&&he?a.invert(a.create(),wa):Ib,Bs=qn(pn,pt.tileID.canonical,Ee,we,Te,at.getProjection(),mn),Go=Ue&&at.hasTextData(),Rn=m.layout.get("icon-text-fit")!=="none"&&Go&&at.hasIconData();if(he){const Il=Te.elevation,Ec=Il?Il.getAtTileOffsetFunc(Je,Te.center.lat,Te.worldSize,at.getProjection()):null,Pu=Ls(pn,pt.tileID.canonical,Ee,we,Te,at.getProjection(),mn);Ad(at,pn,x,S,Pu,Bs,Ee,ee,Ec,Je)}const gn=he||S&&Ue||Rn,Xr=x.translatePosMatrix(pn,pt,j,R),xi=gn?Ib:wa,Oa=x.translatePosMatrix(Bs,pt,j,R,!0),Mn=at.getProjection().createInversionMatrix(Te,Je.canonical),Ka=[];x.terrainRenderModeElevated()&&Ee&&Ka.push("PITCH_WITH_MAP_TERRAIN"),rr&&Ka.push("PROJECTION_GLOBE_VIEW"),gn&&Ka.push("PROJECTED_POS_ON_VIEWPORT");const km=ft&&m.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Cu;Cu=ft?at.iconsInText?Pb(Pt.kind,Mt,ve,Ee,x,Xr,xi,Oa,ir,Rr,Je,fn,qe,Mn,rn,at.getProjection()):sm(Pt.kind,Mt,ve,Ee,x,Xr,xi,Oa,S,ir,!0,Je,fn,qe,Mn,rn,at.getProjection()):py(Pt.kind,Mt,ve,Ee,x,Xr,xi,Oa,S,ir,Je,fn,qe,Mn,rn,at.getProjection());const Rf={program:x.useProgram(xy(ft,S,at),tt,Ka),buffers:Et,uniformValues:Cu,atlasTexture:gr,atlasTextureIcon:Or,atlasInterpolation:Qt,atlasInterpolationIcon:ur,isSDF:ft,hasHalo:km,tile:pt,labelPlaneMatrixInv:Ki};if(Pe&&at.canOverlap){Ie=!0;const Il=Et.segments.get();for(const Ec of Il)He.push({segments:new a.SegmentVector([Ec]),sortKey:Ec.sortKey,state:Rf})}else He.push({segments:Et.segments,sortKey:0,state:Rf})}Ie&&He.sort((Je,pt)=>Je.sortKey-pt.sortKey);for(const Je of He){const pt=Je.state;if(x.terrain&&x.terrain.setupElevationDraw(pt.tile,pt.program,{useDepthForOcclusion:!Ke,labelPlaneMatrixInv:pt.labelPlaneMatrixInv}),me.activeTexture.set(_e.TEXTURE0),pt.atlasTexture.bind(pt.atlasInterpolation,_e.CLAMP_TO_EDGE),pt.atlasTextureIcon&&(me.activeTexture.set(_e.TEXTURE1),pt.atlasTextureIcon&&pt.atlasTextureIcon.bind(pt.atlasInterpolationIcon,_e.CLAMP_TO_EDGE)),pt.isSDF){const at=pt.uniformValues;pt.hasHalo&&(at.u_is_halo=1,Ef(pt.buffers,Je.segments,m,x,pt.program,Ve,Q,ue,at)),at.u_is_halo=0}Ef(pt.buffers,Je.segments,m,x,pt.program,Ve,Q,ue,pt.uniformValues)}}function Ef(x,h,m,b,S,j,R,z,U){const ee=b.context,Q=[x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer,x.globeExtVertexBuffer];S.draw(ee,ee.gl.TRIANGLES,j,R,z,a.CullFaceMode.disabled,U,m.id,x.layoutVertexBuffer,x.indexBuffer,h,m.paint,b.transform.zoom,x.programConfigurations.get(m.id),Q)}function Db(x,h,m,b,S,j,R){const z=x.context.gl,U=m.paint.get("fill-pattern"),ee=U&&U.constantOr(1);let Q,ue,me,_e,Te;R?(ue=ee&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Q=z.LINES):(ue=ee?"fillPattern":"fill",Q=z.TRIANGLES);for(const we of b){const Ee=h.getTile(we);if(ee&&!Ee.patternsLoaded())continue;const he=Ee.getBucket(m);if(!he)continue;x.prepareDrawTile();const ve=he.programConfigurations.get(m.id),Pe=x.useProgram(ue,ve);ee&&(x.context.activeTexture.set(z.TEXTURE0),Ee.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),ve.updatePaintBuffers());const Ie=U.constantOr(null);if(Ie&&Ee.imageAtlas){const qe=Ee.imageAtlas.patternPositions[Ie.toString()];qe&&ve.setConstantPatternPositions(qe)}const Ve=x.translatePosMatrix(we.projMatrix,Ee,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(R){_e=he.indexBuffer2,Te=he.segments2;const qe=x.terrain&&x.terrain.renderingToTexture?x.terrain.drapeBufferSize:[z.drawingBufferWidth,z.drawingBufferHeight];me=ue==="fillOutlinePattern"&&ee?Qr(Ve,x,Ee,qe):$i(Ve,qe)}else _e=he.indexBuffer,Te=he.segments,me=ee?un(Ve,x,Ee):Gt(Ve);x.prepareDrawProgram(x.context,Pe,we.toUnwrapped()),Pe.draw(x.context,Q,S,x.stencilModeForClipping(we),j,a.CullFaceMode.disabled,me,m.id,he.layoutVertexBuffer,_e,Te,m.paint,x.transform.zoom,ve)}}function lm(x,h,m,b,S,j,R){const z=x.context,U=z.gl,ee=x.transform,Q=m.paint.get("fill-extrusion-pattern"),ue=Q.constantOr(1),me=m.paint.get("fill-extrusion-opacity"),_e=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),m.paint.get("fill-extrusion-ambient-occlusion-radius")],Te=m.layout.get("fill-extrusion-edge-radius"),we=Te>0&&!m.paint.get("fill-extrusion-rounded-roof"),Ee=we?0:Te,he=ee.projection.name==="globe"?a.fillExtrusionHeightLift():0,ve=ee.projection.name==="globe",Pe=ve?a.globeToMercatorTransition(ee.zoom):0,Ie=[a.mercatorXfromLng(ee.center.lng),a.mercatorYfromLat(ee.center.lat)],Ve=[];ve&&Ve.push("PROJECTION_GLOBE_VIEW"),_e[0]>0&&Ve.push("FAUX_AO"),we&&Ve.push("ZERO_ROOF_RADIUS");for(const qe of b){const Ue=h.getTile(qe),Ke=Ue.getBucket(m);if(!Ke||Ke.projection.name!==ee.projection.name)continue;const He=Ke.programConfigurations.get(m.id),rt=x.useProgram(ue?"fillExtrusionPattern":"fillExtrusion",He,Ve);if(x.terrain){const ft=x.terrain;if(x.style.terrainSetForDrapingOnly())ft.setupElevationDraw(Ue,rt,{useMeterToDem:!0});else{if(!Ke.enableTerrain)continue;if(ft.setupElevationDraw(Ue,rt,{useMeterToDem:!0}),Ob(z,h,qe,Ke,m,ft),!Ke.centroidVertexBuffer){const Pt=rt.attributes.a_centroid_pos;Pt!==void 0&&U.vertexAttrib2f(Pt,0,0)}}}ue&&(x.context.activeTexture.set(U.TEXTURE0),Ue.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),He.updatePaintBuffers());const At=Q.constantOr(null);if(At&&Ue.imageAtlas){const ft=Ue.imageAtlas.patternPositions[At.toString()];ft&&He.setConstantPatternPositions(ft)}const Je=x.translatePosMatrix(qe.projMatrix,Ue,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),pt=ee.projection.createInversionMatrix(ee,qe.canonical),at=m.paint.get("fill-extrusion-vertical-gradient"),Et=ue?ut(Je,x,at,me,_e,Ee,qe,Ue,he,Pe,Ie,pt):et(Je,x,at,me,_e,Ee,qe,he,Pe,Ie,pt);x.prepareDrawProgram(z,rt,qe.toUnwrapped());const tt=[];x.terrain&&tt.push(Ke.centroidVertexBuffer),ve&&tt.push(Ke.layoutVertexExtBuffer),rt.draw(z,z.gl.TRIANGLES,S,j,R,a.CullFaceMode.backCCW,Et,m.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,m.paint,x.transform.zoom,He,tt)}}function Ob(x,h,m,b,S,j){const R=[he=>{let ve=he.canonical.x-1,Pe=he.wrap;return ve<0&&(ve=(1<<he.canonical.z)-1,Pe--),new a.OverscaledTileID(he.overscaledZ,Pe,he.canonical.z,ve,he.canonical.y)},he=>{let ve=he.canonical.x+1,Pe=he.wrap;return ve===1<<he.canonical.z&&(ve=0,Pe++),new a.OverscaledTileID(he.overscaledZ,Pe,he.canonical.z,ve,he.canonical.y)},he=>new a.OverscaledTileID(he.overscaledZ,he.wrap,he.canonical.z,he.canonical.x,(he.canonical.y===0?1<<he.canonical.z:he.canonical.y)-1),he=>new a.OverscaledTileID(he.overscaledZ,he.wrap,he.canonical.z,he.canonical.x,he.canonical.y===(1<<he.canonical.z)-1?0:he.canonical.y+1)],z=he=>{const ve=h.getSource().minzoom,Pe=Ve=>{const qe=h.getTileByID(Ve);if(qe&&qe.hasData())return qe.getBucket(S)},Ie=[0,-1,1];for(const Ve of Ie){if(he.overscaledZ+Ve<ve)continue;const qe=Pe(he.calculateScaledKey(he.overscaledZ+Ve));if(qe)return qe}},U=[0,0,0],ee=(he,ve)=>(U[0]=Math.min(he.min.y,ve.min.y),U[1]=Math.max(he.max.y,ve.max.y),U[2]=a.EXTENT-ve.min.x>he.max.x?ve.min.x-a.EXTENT:he.max.x,U),Q=(he,ve)=>(U[0]=Math.min(he.min.x,ve.min.x),U[1]=Math.max(he.max.x,ve.max.x),U[2]=a.EXTENT-ve.min.y>he.max.y?ve.min.y-a.EXTENT:he.max.y,U),ue=[(he,ve)=>ee(he,ve),(he,ve)=>ee(ve,he),(he,ve)=>Q(he,ve),(he,ve)=>Q(ve,he)],me=new a.Point(0,0);let _e,Te,we;const Ee=(he,ve,Pe,Ie,Ve)=>{const qe=[[Ie?Pe:he,Ie?he:Pe,0],[Ie?Pe:ve,Ie?ve:Pe,0]],Ue=Ve<0?a.EXTENT+Ve:Ve,Ke=[Ie?Ue:(he+ve)/2,Ie?(he+ve)/2:Ue,0];return Pe===0&&Ve<0||Pe!==0&&Ve>0?j.getForTilePoints(we,[Ke],!0,Te):qe.push(Ke),j.getForTilePoints(m,qe,!0,_e),Math.max(qe[0][2],qe[1][2],Ke[2])/j.exaggeration()};for(let he=0;he<4;he++){const ve=(he<2?1:5)-he,Pe=b.borders[he];if(Pe.length===0)continue;const Ie=we=R[he](m),Ve=z(Ie);if(!(Ve&&Ve instanceof a.FillExtrusionBucket&&Ve.enableTerrain)||b.borderDoneWithNeighborZ[he]===Ve.canonical.z&&Ve.borderDoneWithNeighborZ[ve]===b.canonical.z||(Te=j.findDEMTileFor(Ie),!Te||!Te.dem))continue;if(!_e){const He=j.findDEMTileFor(m);if(!He||!He.dem)return;_e=He}const qe=Ve.borders[ve];let Ue=0;const Ke=Ve.borderDoneWithNeighborZ[ve]!==b.canonical.z;if(b.canonical.z===Ve.canonical.z){for(let He=0;He<Pe.length;He++){const rt=b.featuresOnBorder[Pe[He]],At=rt.borders[he];let Je;for(;Ue<qe.length&&(Je=Ve.featuresOnBorder[qe[Ue]],!(Je.borders[ve][1]>At[0]+3));)Ke&&Ve.encodeCentroid(void 0,Je,!1),Ue++;if(Je&&Ue<qe.length){const pt=Ue;let at=0;for(;!(Je.borders[ve][0]>At[1]-3)&&(at++,++Ue!==qe.length);)Je=Ve.featuresOnBorder[qe[Ue]];if(Je=Ve.featuresOnBorder[qe[pt]],rt.intersectsCount()>1||Je.intersectsCount()>1||at!==1){at!==1&&(Ue=pt),b.encodeCentroid(void 0,rt,!1),Ke&&Ve.encodeCentroid(void 0,Je,!1);continue}const Et=ue[he](rt,Je),tt=he%2?a.EXTENT-1:0;me.x=Ee(Et[0],Math.min(a.EXTENT-1,Et[1]),tt,he<2,Et[2]),me.y=0,b.encodeCentroid(me,rt,!1),Ke&&Ve.encodeCentroid(me,Je,!1)}else b.encodeCentroid(void 0,rt,!1)}b.borderDoneWithNeighborZ[he]=Ve.canonical.z,b.needsCentroidUpdate=!0,Ke&&(Ve.borderDoneWithNeighborZ[ve]=b.canonical.z,Ve.needsCentroidUpdate=!0)}else{for(const He of Pe)b.encodeCentroid(void 0,b.featuresOnBorder[He],!1);if(Ke){for(const He of qe)Ve.encodeCentroid(void 0,Ve.featuresOnBorder[He],!1);Ve.borderDoneWithNeighborZ[ve]=b.canonical.z,Ve.needsCentroidUpdate=!0}b.borderDoneWithNeighborZ[he]=Ve.canonical.z,b.needsCentroidUpdate=!0}}(b.needsCentroidUpdate||!b.centroidVertexBuffer&&b.centroidVertexArray.length!==0)&&b.uploadCentroid(x)}const Ld=new a.Color(1,0,0,1),mE=new a.Color(0,1,0,1),gE=new a.Color(0,0,1,1),yE=new a.Color(1,0,1,1),xE=new a.Color(0,1,1,1);function vE(x,h,m){const b=x.context,S=x.transform,j=b.gl,R=S.projection.name==="globe",z=R?["PROJECTION_GLOBE_VIEW"]:null;let U=m.projMatrix;if(R&&a.globeToMercatorTransition(S.zoom)>0){const rt=a.transitionTileAABBinECEF(m.canonical,S),At=a.globeDenormalizeECEF(rt);U=a.multiply(new Float32Array(16),S.globeMatrix,At),a.multiply(U,S.projMatrix,U)}const ee=x.useProgram("debug",null,z),Q=h.getTileByID(m.key);x.terrain&&x.terrain.setupElevationDraw(Q,ee);const ue=a.DepthMode.disabled,me=a.StencilMode.disabled,_e=x.colorModeForRenderPass(),Te="$debug";b.activeTexture.set(j.TEXTURE0),x.emptyTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),R?Q._makeGlobeTileDebugBuffers(x.context,S):Q._makeDebugTileBoundsBuffers(x.context,S.projection);const we=Q._tileDebugBuffer||x.debugBuffer,Ee=Q._tileDebugIndexBuffer||x.debugIndexBuffer,he=Q._tileDebugSegments||x.debugSegments;ee.draw(b,j.LINE_STRIP,ue,me,_e,a.CullFaceMode.disabled,Nl(U,a.Color.red),Te,we,Ee,he,null,null,null,[Q._globeTileDebugBorderBuffer]);const ve=Q.latestRawTileData,Pe=Math.floor((ve&&ve.byteLength||0)/1024),Ie=h.getTile(m).tileSize,Ve=512/Math.min(Ie,512)*(m.overscaledZ/S.zoom)*.5;let qe=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(qe+=` => ${m.overscaledZ}`),qe+=` ${Pe}kb`,function(rt,At){rt.initDebugOverlayCanvas();const Je=rt.debugOverlayCanvas,pt=rt.context.gl,at=rt.debugOverlayCanvas.getContext("2d");at.clearRect(0,0,Je.width,Je.height),at.shadowColor="white",at.shadowBlur=2,at.lineWidth=1.5,at.strokeStyle="white",at.textBaseline="top",at.font="bold 36px Open Sans, sans-serif",at.fillText(At,5,5),at.strokeText(At,5,5),rt.debugOverlayTexture.update(Je),rt.debugOverlayTexture.bind(pt.LINEAR,pt.CLAMP_TO_EDGE)}(x,qe);const Ue=Q._tileDebugTextBuffer||x.debugBuffer,Ke=Q._tileDebugTextIndexBuffer||x.quadTriangleIndexBuffer,He=Q._tileDebugTextSegments||x.debugSegments;ee.draw(b,j.TRIANGLES,ue,me,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,Nl(U,a.Color.transparent,Ve),Te,Ue,Ke,He,null,null,null,[Q._globeTileDebugTextBuffer])}function Rb(x,h,m,b){zd(x,0,h+m/2,x.transform.width,m,b)}function cm(x,h,m,b){zd(x,h-m/2,0,m,x.transform.height,b)}function zd(x,h,m,b,S,j){const R=x.context,z=R.gl;z.enable(z.SCISSOR_TEST),z.scissor(h*a.exported.devicePixelRatio,m*a.exported.devicePixelRatio,b*a.exported.devicePixelRatio,S*a.exported.devicePixelRatio),R.clear({color:j}),z.disable(z.SCISSOR_TEST)}const Lb=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:zb}=Lb;function Cl(x,h,m,b){x.emplaceBack(h,m,b)}class um{constructor(h){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,Cl(this.vertexArray,-1,-1,1),Cl(this.vertexArray,1,-1,1),Cl(this.vertexArray,-1,1,1),Cl(this.vertexArray,1,1,1),Cl(this.vertexArray,-1,-1,-1),Cl(this.vertexArray,1,-1,-1),Cl(this.vertexArray,-1,1,-1),Cl(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=h.createVertexBuffer(this.vertexArray,zb),this.indexBuffer=h.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function $s(x,h,m,b,S,j){const R=x.gl,z=h.paint.get("sky-atmosphere-color"),U=h.paint.get("sky-atmosphere-halo-color"),ee=h.paint.get("sky-atmosphere-sun-intensity"),Q=((ue,me,_e,Te,we)=>({u_matrix_3f:ue,u_sun_direction:me,u_sun_intensity:_e,u_color_tint_r:[Te.r,Te.g,Te.b,Te.a],u_color_tint_m:[we.r,we.g,we.b,we.a],u_luminance:5e-5}))(a.fromMat4(a.create$1(),b),S,ee,z,U);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+j,h.skyboxTexture,0),m.draw(x,R.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,Q,"skyboxCapture",h.skyboxGeometry.vertexBuffer,h.skyboxGeometry.indexBuffer,h.skyboxGeometry.segment)}const jf=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class $b{constructor(h){const m=new a.StructArrayLayout5f20;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const b=new a.StructArrayLayout3ui6;b.emplaceBack(0,1,2),b.emplaceBack(2,3,0),this.vertexBuffer=h.createVertexBuffer(m,jf.members),this.indexBuffer=h.createIndexBuffer(b),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ju={symbol:function(x,h,m,b,S){if(x.renderPass!=="translucent")return;const j=a.StencilMode.disabled,R=x.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(z,U,ee,Q,ue,me,_e){const Te=U.transform,we=ue==="map",Ee=me==="map";for(const he of z){const ve=Q.getTile(he),Pe=ve.getBucket(ee);if(!Pe||!Pe.text||!Pe.text.segments.get().length)continue;const Ie=a.evaluateSizeForZoom(Pe.textSizeData,Te.zoom),Ve=an(he,Pe.getProjection(),Te),qe=Te.calculatePixelsToTileUnitsMatrix(ve),Ue=lt(Ve,ve.tileID.canonical,Ee,we,Te,Pe.getProjection(),qe),Ke=ee.layout.get("icon-text-fit")!=="none"&&Pe.hasIconData();if(Ie){const He=Math.pow(2,Te.zoom-ve.tileID.overscaledZ);pE(Pe,we,Ee,_e,a.symbolSize,Te,Ue,he,He,Ie,Ke)}}}(b,x,m,h,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),S),m.paint.get("icon-opacity").constantOr(1)!==0&&Mb(x,h,m,b,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),j,R),m.paint.get("text-opacity").constantOr(1)!==0&&Mb(x,h,m,b,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),j,R),h.map.showCollisionBoxes&&(Sf(x,h,m,b,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),Sf(x,h,m,b,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(x,h,m,b){if(x.renderPass!=="translucent")return;const S=m.paint.get("circle-opacity"),j=m.paint.get("circle-stroke-width"),R=m.paint.get("circle-stroke-opacity"),z=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(S.constantOr(1)===0&&(j.constantOr(1)===0||R.constantOr(1)===0))return;const U=x.context,ee=U.gl,Q=x.transform,ue=x.depthModeForSublayer(0,a.DepthMode.ReadOnly),me=a.StencilMode.disabled,_e=x.colorModeForRenderPass(),Te=Q.projection.name==="globe",we=[a.mercatorXfromLng(Q.center.lng),a.mercatorYfromLat(Q.center.lat)],Ee=[];for(let ve=0;ve<b.length;ve++){const Pe=b[ve],Ie=h.getTile(Pe),Ve=Ie.getBucket(m);if(!Ve||Ve.projection.name!==Q.projection.name)continue;const qe=Ve.programConfigurations.get(m.id),Ue=Vo(m);Te&&Ue.push("PROJECTION_GLOBE_VIEW");const Ke=x.useProgram("circle",qe,Ue),He=Ve.layoutVertexBuffer,rt=Ve.globeExtVertexBuffer,At=Ve.indexBuffer,Je=Q.projection.createInversionMatrix(Q,Pe.canonical),pt={programConfiguration:qe,program:Ke,layoutVertexBuffer:He,globeExtVertexBuffer:rt,indexBuffer:At,uniformValues:Ii(x,Pe,Ie,Je,we,m),tile:Ie};if(z){const at=Ve.segments.get();for(const Et of at)Ee.push({segments:new a.SegmentVector([Et]),sortKey:Et.sortKey,state:pt})}else Ee.push({segments:Ve.segments,sortKey:0,state:pt})}z&&Ee.sort((ve,Pe)=>ve.sortKey-Pe.sortKey);const he={useDepthForOcclusion:!Te};for(const ve of Ee){const{programConfiguration:Pe,program:Ie,layoutVertexBuffer:Ve,globeExtVertexBuffer:qe,indexBuffer:Ue,uniformValues:Ke,tile:He}=ve.state,rt=ve.segments;x.terrain&&x.terrain.setupElevationDraw(He,Ie,he),x.prepareDrawProgram(U,Ie,He.tileID.toUnwrapped()),Ie.draw(U,ee.TRIANGLES,ue,me,_e,a.CullFaceMode.disabled,Ke,m.id,Ve,Ue,rt,m.paint,Q.zoom,Pe,[qe])}},heatmap:function(x,h,m,b){if(m.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){const S=x.context,j=S.gl,R=a.StencilMode.disabled,z=new a.ColorMode([j.ONE,j.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(_e,Te,we,Ee){const he=_e.gl,ve=Te.width*Ee,Pe=Te.height*Ee;_e.activeTexture.set(he.TEXTURE1),_e.viewport.set([0,0,ve,Pe]);let Ie=we.heatmapFbo;if(!Ie||Ie&&(Ie.width!==ve||Ie.height!==Pe)){Ie&&Ie.destroy();const Ve=he.createTexture();he.bindTexture(he.TEXTURE_2D,Ve),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MAG_FILTER,he.LINEAR),Ie=we.heatmapFbo=_e.createFramebuffer(ve,Pe,!1),function(qe,Ue,Ke,He,rt,At){const Je=qe.gl;Je.texImage2D(Je.TEXTURE_2D,0,qe.isWebGL2&&qe.extRenderToTextureHalfFloat?Je.RGBA16F:Je.RGBA,rt,At,0,Je.RGBA,qe.extRenderToTextureHalfFloat?qe.isWebGL2?Je.HALF_FLOAT:qe.extTextureHalfFloat.HALF_FLOAT_OES:Je.UNSIGNED_BYTE,null),He.colorAttachment.set(Ke)}(_e,0,Ve,Ie,ve,Pe)}else he.bindTexture(he.TEXTURE_2D,Ie.colorAttachment.get()),_e.bindFramebuffer.set(Ie.framebuffer)})(S,x,m,x.transform.projection.name==="globe"?.5:.25),S.clear({color:a.Color.transparent});const U=x.transform,ee=U.projection.name==="globe",Q=ee?["PROJECTION_GLOBE_VIEW"]:null,ue=ee?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,me=[a.mercatorXfromLng(U.center.lng),a.mercatorYfromLat(U.center.lat)];for(let _e=0;_e<b.length;_e++){const Te=b[_e];if(h.hasRenderableParent(Te))continue;const we=h.getTile(Te),Ee=we.getBucket(m);if(!Ee||Ee.projection.name!==U.projection.name)continue;const he=Ee.programConfigurations.get(m.id),ve=x.useProgram("heatmap",he,Q),{zoom:Pe}=x.transform;x.terrain&&x.terrain.setupElevationDraw(we,ve),x.prepareDrawProgram(S,ve,Te.toUnwrapped());const Ie=U.projection.createInversionMatrix(U,Te.canonical);ve.draw(S,j.TRIANGLES,a.DepthMode.disabled,R,z,ue,Cb(x,Te,we,Ie,me,Pe,m.paint.get("heatmap-intensity")),m.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,m.paint,x.transform.zoom,he,ee?[Ee.globeExtVertexBuffer]:null)}S.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(S,j){const R=S.context,z=R.gl,U=j.heatmapFbo;if(!U)return;R.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,U.colorAttachment.get()),R.activeTexture.set(z.TEXTURE1);let ee=j.colorRampTexture;ee||(ee=j.colorRampTexture=new a.Texture(R,j.colorRamp,z.RGBA)),ee.bind(z.LINEAR,z.CLAMP_TO_EDGE),S.useProgram("heatmapTexture").draw(R,z.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,S.colorModeForRenderPass(),a.CullFaceMode.disabled,((Q,ue,me,_e)=>({u_image:0,u_color_ramp:1,u_opacity:ue.paint.get("heatmap-opacity")}))(0,j),j.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,j.paint,S.transform.zoom)}(x,m))},line:function(x,h,m,b){if(x.renderPass!=="translucent")return;const S=m.paint.get("line-opacity"),j=m.paint.get("line-width");if(S.constantOr(1)===0||j.constantOr(1)===0)return;const R=x.depthModeForSublayer(0,a.DepthMode.ReadOnly),z=x.colorModeForRenderPass(),U=x.terrain&&x.terrain.renderingToTexture?1:a.exported.devicePixelRatio,ee=m.paint.get("line-dasharray"),Q=ee.constantOr(1),ue=m.layout.get("line-cap"),me=m.paint.get("line-pattern"),_e=me.constantOr(1),Te=m.paint.get("line-gradient"),we=_e?"linePattern":"line",Ee=x.context,he=Ee.gl,ve=(Ie=>{const Ve=[];Tf(Ie)&&Ve.push("RENDER_LINE_DASH"),Ie.paint.get("line-gradient")&&Ve.push("RENDER_LINE_GRADIENT");const qe=Ie.paint.get("line-trim-offset");qe[0]===0&&qe[1]===0||Ve.push("RENDER_LINE_TRIM_OFFSET");const Ue=Ie.paint.get("line-pattern").constantOr(1),Ke=Ie.paint.get("line-opacity").constantOr(1)!==1;return!Ue&&Ke&&Ve.push("RENDER_LINE_ALPHA_DISCARD"),Ve})(m);let Pe=ve.includes("RENDER_LINE_ALPHA_DISCARD");x.terrain&&x.terrain.clipOrMaskOverlapStencilType()&&(Pe=!1);for(const Ie of b){const Ve=h.getTile(Ie);if(_e&&!Ve.patternsLoaded())continue;const qe=Ve.getBucket(m);if(!qe)continue;x.prepareDrawTile();const Ue=qe.programConfigurations.get(m.id),Ke=x.useProgram(we,Ue,ve),He=me.constantOr(null);if(He&&Ve.imageAtlas){const ft=Ve.imageAtlas.patternPositions[He.toString()];ft&&Ue.setConstantPatternPositions(ft)}const rt=ee.constantOr(null),At=ue.constantOr(null);if(!_e&&rt&&At&&Ve.lineAtlas){const ft=Ve.lineAtlas.getDash(rt,At);ft&&Ue.setConstantPatternPositions(ft)}let[Je,pt]=m.paint.get("line-trim-offset");(At==="round"||At==="square")&&Je!==pt&&(Je===0&&(Je-=1),pt===1&&(pt+=1));const at=x.terrain?Ie.projMatrix:null,Et=_e?kf(x,Ve,m,at,U):hE(x,Ve,m,at,qe.lineClipsArray.length,U,[Je,pt]);if(Te){const ft=qe.gradients[m.id];let Pt=ft.texture;if(m.gradientVersion!==ft.version){let _t=256;if(m.stepInterpolant){const Mt=h.getSource().maxzoom,ir=Ie.canonical.z===Mt?Math.ceil(1<<x.transform.maxZoom-Ie.canonical.z):1;_t=a.clamp(a.nextPowerOfTwo(qe.maxLineLength/a.EXTENT*1024*ir),256,Ee.maxTextureSize)}ft.gradient=a.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:_t,image:ft.gradient||void 0,clips:qe.lineClipsArray}),ft.texture?ft.texture.update(ft.gradient):ft.texture=new a.Texture(Ee,ft.gradient,he.RGBA),ft.version=m.gradientVersion,Pt=ft.texture}Ee.activeTexture.set(he.TEXTURE1),Pt.bind(m.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}Q&&(Ee.activeTexture.set(he.TEXTURE0),Ve.lineAtlasTexture.bind(he.LINEAR,he.REPEAT),Ue.updatePaintBuffers()),_e&&(Ee.activeTexture.set(he.TEXTURE0),Ve.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),Ue.updatePaintBuffers()),x.prepareDrawProgram(Ee,Ke,Ie.toUnwrapped());const tt=ft=>{Ke.draw(Ee,he.TRIANGLES,R,ft,z,a.CullFaceMode.disabled,Et,m.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,m.paint,x.transform.zoom,Ue,[qe.layoutVertexBuffer2])};if(Pe){const ft=x.stencilModeForClipping(Ie).ref;ft===0&&x.terrain&&Ee.clear({stencil:0});const Pt={func:he.EQUAL,mask:255};Et.u_alpha_discard_threshold=.8,tt(new a.StencilMode(Pt,ft,255,he.KEEP,he.KEEP,he.INVERT)),Et.u_alpha_discard_threshold=0,tt(new a.StencilMode(Pt,ft,255,he.KEEP,he.KEEP,he.KEEP))}else tt(x.stencilModeForClipping(Ie))}Pe&&(x.resetStencilClippingMasks(),x.terrain&&Ee.clear({stencil:0}))},fill:function(x,h,m,b){const S=m.paint.get("fill-color"),j=m.paint.get("fill-opacity");if(j.constantOr(1)===0)return;const R=x.colorModeForRenderPass(),z=m.paint.get("fill-pattern"),U=x.opaquePassEnabledForLayer()&&!z.constantOr(1)&&S.constantOr(a.Color.transparent).a===1&&j.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===U){const ee=x.depthModeForSublayer(1,x.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);Db(x,h,m,b,ee,R,!1)}if(x.renderPass==="translucent"&&m.paint.get("fill-antialias")){const ee=x.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);Db(x,h,m,b,ee,R,!0)}},"fill-extrusion":function(x,h,m,b){const S=m.paint.get("fill-extrusion-opacity");if(S!==0&&x.renderPass==="translucent"){const j=new a.DepthMode(x.context.gl.LEQUAL,a.DepthMode.ReadWrite,x.depthRangeFor3D);if(S!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))lm(x,h,m,b,j,a.StencilMode.disabled,a.ColorMode.disabled),lm(x,h,m,b,j,x.stencilModeFor3D(),x.colorModeForRenderPass()),x.resetStencilClippingMasks();else{const R=x.colorModeForRenderPass();lm(x,h,m,b,j,a.StencilMode.disabled,R)}}},hillshade:function(x,h,m,b){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const S=x.context,j=x.depthModeForSublayer(0,a.DepthMode.ReadOnly),R=x.colorModeForRenderPass(),z=x.terrain&&x.terrain.renderingToTexture,[U,ee]=x.renderPass!=="translucent"||z?[{},b]:x.stencilConfigForOverlap(b);for(const Q of ee){const ue=h.getTile(Q);if(ue.needsHillshadePrepare&&x.renderPass==="offscreen")bf(x,ue,m,j,a.StencilMode.disabled,R);else if(x.renderPass==="translucent"){const me=z&&x.terrain?x.terrain.stencilModeForRTTOverlap(Q):U[Q.overscaledZ];Md(x,Q,ue,m,j,me,R)}}S.viewport.set([0,0,x.width,x.height]),x.resetStencilClippingMasks()},raster:function(x,h,m,b,S,j){if(x.renderPass!=="translucent"||m.paint.get("raster-opacity")===0||!b.length)return;const R=x.context,z=R.gl,U=h.getSource(),ee=x.useProgram("raster"),Q=x.colorModeForRenderPass(),ue=x.terrain&&x.terrain.renderingToTexture,[me,_e]=U instanceof vr||ue?[{},b]:x.stencilConfigForOverlap(b),Te=_e[_e.length-1].overscaledZ,we=!x.options.moving;for(const Ee of _e){const he=ue?a.DepthMode.disabled:x.depthModeForSublayer(Ee.overscaledZ-Te,m.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,z.LESS),ve=Ee.toUnwrapped(),Pe=h.getTile(Ee);if(ue&&(!Pe||!Pe.hasData()))continue;const Ie=ue?Ee.projMatrix:x.transform.calculateProjMatrix(ve,we),Ve=x.terrain&&ue?x.terrain.stencilModeForRTTOverlap(Ee):me[Ee.overscaledZ],qe=j?0:m.paint.get("raster-fade-duration");Pe.registerFadeDuration(qe);const Ue=h.findLoadedParent(Ee,0),Ke=oa(Pe,Ue,h,x.transform,qe);let He,rt;x.terrain&&x.terrain.prepareDrawTile();const At=m.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;R.activeTexture.set(z.TEXTURE0),Pe.texture.bind(At,z.CLAMP_TO_EDGE),R.activeTexture.set(z.TEXTURE1),Ue?(Ue.texture.bind(At,z.CLAMP_TO_EDGE),He=Math.pow(2,Ue.tileID.overscaledZ-Pe.tileID.overscaledZ),rt=[Pe.tileID.canonical.x*He%1,Pe.tileID.canonical.y*He%1]):Pe.texture.bind(At,z.CLAMP_TO_EDGE),Pe.texture.useMipmap&&R.extTextureFilterAnisotropic&&x.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax);const Je=fy(Ie,rt||[0,0],He||1,Ke,m,U instanceof vr?U.perspectiveTransform:[0,0]);if(x.prepareDrawProgram(R,ee,ve),U instanceof vr)U.boundsBuffer&&U.boundsSegments&&ee.draw(R,z.TRIANGLES,he,a.StencilMode.disabled,Q,a.CullFaceMode.disabled,Je,m.id,U.boundsBuffer,x.quadTriangleIndexBuffer,U.boundsSegments);else{const{tileBoundsBuffer:pt,tileBoundsIndexBuffer:at,tileBoundsSegments:Et}=x.getTileBoundsBuffers(Pe);ee.draw(R,z.TRIANGLES,he,Ve,Q,a.CullFaceMode.disabled,Je,m.id,pt,at,Et)}}x.resetStencilClippingMasks()},background:function(x,h,m,b){const S=m.paint.get("background-color"),j=m.paint.get("background-opacity");if(j===0)return;const R=x.context,z=R.gl,U=x.transform,ee=U.tileSize,Q=m.paint.get("background-pattern");if(x.isPatternMissing(Q))return;const ue=!Q&&S.a===1&&j===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==ue)return;const me=a.StencilMode.disabled,_e=x.depthModeForSublayer(0,ue==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),Te=x.colorModeForRenderPass(),we=x.useProgram(Q?"backgroundPattern":"background");let Ee,he=b;he||(Ee=x.getBackgroundTiles(),he=Object.values(Ee).map(ve=>ve.tileID)),Q&&(R.activeTexture.set(z.TEXTURE0),x.imageManager.bind(x.context));for(const ve of he){const Pe=ve.toUnwrapped(),Ie=b?ve.projMatrix:x.transform.calculateProjMatrix(Pe);x.prepareDrawTile();const Ve=h?h.getTile(ve):Ee?Ee[ve.key]:new a.Tile(ve,ee,U.zoom,x),qe=Q?fE(Ie,j,x,Q,{tileID:ve,tileSize:ee}):my(Ie,j,S);x.prepareDrawProgram(R,we,Pe);const{tileBoundsBuffer:Ue,tileBoundsIndexBuffer:Ke,tileBoundsSegments:He}=x.getTileBoundsBuffers(Ve);we.draw(R,z.TRIANGLES,_e,me,Te,a.CullFaceMode.disabled,qe,m.id,Ue,Ke,He)}},sky:function(x,h,m){const b=x.transform,S=b.projection.name==="mercator"||b.projection.name==="globe"?1:a.smoothstep(7,8,b.zoom),j=m.paint.get("sky-opacity")*S;if(j===0)return;const R=x.context,z=m.paint.get("sky-type"),U=new a.DepthMode(R.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),ee=x.frameCounter/1e3%1;z==="atmosphere"?x.renderPass==="offscreen"?m.needsSkyboxCapture(x)&&(function(Q,ue,me,_e){const Te=Q.context,we=Te.gl;let Ee=ue.skyboxFbo;if(!Ee){Ee=ue.skyboxFbo=Te.createFramebuffer(32,32,!1),ue.skyboxGeometry=new um(Te),ue.skyboxTexture=Te.gl.createTexture(),we.bindTexture(we.TEXTURE_CUBE_MAP,ue.skyboxTexture),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_MAG_FILTER,we.LINEAR);for(let Ie=0;Ie<6;++Ie)we.texImage2D(we.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0,we.RGBA,32,32,0,we.RGBA,we.UNSIGNED_BYTE,null)}Te.bindFramebuffer.set(Ee.framebuffer),Te.viewport.set([0,0,32,32]);const he=ue.getCenter(Q,!0),ve=Q.useProgram("skyboxCapture"),Pe=new Float64Array(16);a.identity(Pe),a.rotateY(Pe,Pe,.5*-Math.PI),$s(Te,ue,ve,Pe,he,0),a.identity(Pe),a.rotateY(Pe,Pe,.5*Math.PI),$s(Te,ue,ve,Pe,he,1),a.identity(Pe),a.rotateX(Pe,Pe,.5*-Math.PI),$s(Te,ue,ve,Pe,he,2),a.identity(Pe),a.rotateX(Pe,Pe,.5*Math.PI),$s(Te,ue,ve,Pe,he,3),a.identity(Pe),$s(Te,ue,ve,Pe,he,4),a.identity(Pe),a.rotateY(Pe,Pe,Math.PI),$s(Te,ue,ve,Pe,he,5),Te.viewport.set([0,0,Q.width,Q.height])}(x,m),m.markSkyboxValid(x)):x.renderPass==="sky"&&function(Q,ue,me,_e,Te){const we=Q.context,Ee=we.gl,he=Q.transform,ve=Q.useProgram("skybox");we.activeTexture.set(Ee.TEXTURE0),Ee.bindTexture(Ee.TEXTURE_CUBE_MAP,ue.skyboxTexture);const Pe=((Ie,Ve,qe,Ue,Ke)=>({u_matrix:Ie,u_sun_direction:Ve,u_cubemap:0,u_opacity:Ue,u_temporal_offset:Ke}))(he.skyboxMatrix,ue.getCenter(Q,!1),0,_e,Te);Q.prepareDrawProgram(we,ve),ve.draw(we,Ee.TRIANGLES,me,a.StencilMode.disabled,Q.colorModeForRenderPass(),a.CullFaceMode.backCW,Pe,"skybox",ue.skyboxGeometry.vertexBuffer,ue.skyboxGeometry.indexBuffer,ue.skyboxGeometry.segment)}(x,m,U,j,ee):z==="gradient"&&x.renderPass==="sky"&&function(Q,ue,me,_e,Te){const we=Q.context,Ee=we.gl,he=Q.transform,ve=Q.useProgram("skyboxGradient");ue.skyboxGeometry||(ue.skyboxGeometry=new um(we)),we.activeTexture.set(Ee.TEXTURE0);let Pe=ue.colorRampTexture;Pe||(Pe=ue.colorRampTexture=new a.Texture(we,ue.colorRamp,Ee.RGBA)),Pe.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE);const Ie=((Ve,qe,Ue,Ke,He)=>({u_matrix:Ve,u_color_ramp:0,u_center_direction:qe,u_radius:a.degToRad(Ue),u_opacity:Ke,u_temporal_offset:He}))(he.skyboxMatrix,ue.getCenter(Q,!1),ue.paint.get("sky-gradient-radius"),_e,Te);Q.prepareDrawProgram(we,ve),ve.draw(we,Ee.TRIANGLES,me,a.StencilMode.disabled,Q.colorModeForRenderPass(),a.CullFaceMode.backCW,Ie,"skyboxGradient",ue.skyboxGeometry.vertexBuffer,ue.skyboxGeometry.indexBuffer,ue.skyboxGeometry.segment)}(x,m,U,j,ee)},debug:function(x,h,m){for(let b=0;b<m.length;b++)vE(x,h,m[b])},custom:function(x,h,m,b){const S=x.context,j=m.implementation;if(!x.transform.projection.unsupportedLayers||!x.transform.projection.unsupportedLayers.includes("custom")||x.terrain&&(x.terrain.renderingToTexture||x.renderPass==="offscreen")&&m.isLayerDraped()){if(x.renderPass==="offscreen"){const R=j.prerender;if(R){if(x.setCustomLayerDefaults(),S.setColorMode(x.colorModeForRenderPass()),x.transform.projection.name==="globe"){const z=x.transform.pointMerc;R.call(j,S.gl,x.transform.customLayerMatrix(),x.transform.getProjection(),x.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(x.transform.zoom),[z.x,z.y],x.transform.pixelsPerMeterRatio)}else R.call(j,S.gl,x.transform.customLayerMatrix());S.setDirty(),x.setBaseState()}}else if(x.renderPass==="translucent"){if(x.terrain&&x.terrain.renderingToTexture){const z=j.renderToTile;if(z){const U=b[0].canonical,ee=new a.MercatorCoordinate(U.x+b[0].wrap*(1<<U.z),U.y,U.z);S.setDepthMode(a.DepthMode.disabled),S.setStencilMode(a.StencilMode.disabled),S.setColorMode(x.colorModeForRenderPass()),x.setCustomLayerDefaults(),z.call(j,S.gl,ee),S.setDirty(),x.setBaseState()}return}x.setCustomLayerDefaults(),S.setColorMode(x.colorModeForRenderPass()),S.setStencilMode(a.StencilMode.disabled);const R=j.renderingMode==="3d"?new a.DepthMode(x.context.gl.LEQUAL,a.DepthMode.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(S.setDepthMode(R),x.transform.projection.name==="globe"){const z=x.transform.pointMerc;j.render(S.gl,x.transform.customLayerMatrix(),x.transform.getProjection(),x.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(x.transform.zoom),[z.x,z.y],x.transform.pixelsPerMeterRatio)}else j.render(S.gl,x.transform.customLayerMatrix());S.setDirty(),x.setBaseState(),S.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class $d{constructor(h,m,b=!1){this.context=new It(h,b),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(h,m){const b=!!h&&!!h.terrain&&this.transform.projection.supportsTerrain;if(!(b||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new C(this,h));const S=this._terrain;this.transform.elevation=b?S:null,S.update(h,this.transform,m)}_updateFog(h){const m=h.fog;if(!m||this.transform.projection.name==="globe"||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[b,S]=m.getFovAdjustedRange(this.transform._fov);if(b>S)return void(this.transform.fogCullDistSq=null);const j=b+.78*(S-b);this.transform.fogCullDistSq=j*j}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(h,m){if(this.width=h*a.exported.devicePixelRatio,this.height=m*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style.order)this.style._layers[b].resize()}setup(){const h=this.context,m=new a.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(a.EXTENT,0),m.emplaceBack(0,a.EXTENT),m.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=h.createVertexBuffer(m,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const b=new a.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(a.EXTENT,0),b.emplaceBack(0,a.EXTENT),b.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=h.createVertexBuffer(b,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const S=new a.StructArrayLayout2i4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(S,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const j=new a.StructArrayLayout4i8;j.emplaceBack(0,0,0,0),j.emplaceBack(a.EXTENT,0,a.EXTENT,0),j.emplaceBack(0,a.EXTENT,0,a.EXTENT),j.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=h.createVertexBuffer(j,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const R=new a.StructArrayLayout3ui6;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer(R);const z=new a.StructArrayLayout1ui2;for(const ee of[0,1,3,2,0])z.emplaceBack(ee);this.debugIndexBuffer=h.createIndexBuffer(z),this.emptyTexture=new a.Texture(h,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),h.gl.RGBA),this.identityMat=a.create();const U=this.context.gl;this.stencilClearMode=new a.StencilMode({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new $b(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(h){return h._makeTileBoundsBuffers(this.context,this.transform.projection),h._tileBoundsBuffer?{tileBoundsBuffer:h._tileBoundsBuffer,tileBoundsIndexBuffer:h._tileBoundsIndexBuffer,tileBoundsSegments:h._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const h=this.context,m=h.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(h,m.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,Bo(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(h,m,b){if(!m||this.currentStencilSource===m.id||!h.isTileClipped()||!b||b.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let z=!1;for(const U of b)if(this._tileClippingMaskIDs[U.key]===void 0){z=!0;break}if(!z)return}this.currentStencilSource=m.id;const S=this.context,j=S.gl;this.nextStencilID+b.length>256&&this.clearStencil(),S.setColorMode(a.ColorMode.disabled),S.setDepthMode(a.DepthMode.disabled);const R=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of b){const U=m.getTile(z),ee=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,{tileBoundsBuffer:Q,tileBoundsIndexBuffer:ue,tileBoundsSegments:me}=this.getTileBoundsBuffers(U);R.draw(S,j.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:j.ALWAYS,mask:0},ee,255,j.KEEP,j.KEEP,j.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Bo(z.projMatrix),"$clipping",Q,ue,me)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const h=this.nextStencilID++,m=this.context.gl;return new a.StencilMode({func:m.NOTEQUAL,mask:255},h,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(h){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(h);const m=this.context.gl;return new a.StencilMode({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(h){const m=this.context.gl,b=h.sort((R,z)=>z.overscaledZ-R.overscaledZ),S=b[b.length-1].overscaledZ,j=b[0].overscaledZ-S+1;if(j>1){this.currentStencilSource=void 0,this.nextStencilID+j>256&&this.clearStencil();const R={};for(let z=0;z<j;z++)R[z+S]=new a.StencilMode({func:m.GEQUAL,mask:255},z+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=j,[R,b]}return[{[S]:a.StencilMode.disabled},b]}colorModeForRenderPass(){const h=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([h.CONSTANT_COLOR,h.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(h,m,b){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new a.DepthMode(b||this.context.gl.LEQUAL,m,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(h,m){this.style=h,this.options=m,this.imageManager=h.imageManager,this.glyphManager=h.glyphManager,this.symbolFadeChange=h.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const b=this.style.order,S=this.style._sourceCaches;for(const ee in S){const Q=S[ee];Q.used&&Q.prepare(this.context)}const j={},R={},z={};for(const ee in S){const Q=S[ee];j[ee]=Q.getVisibleCoordinates(),R[ee]=j[ee].slice().reverse(),z[ee]=Q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ee=0;ee<b.length;ee++)if(this.style._layers[b[ee]].is3D()){this.opaquePassCutoff=ee;break}if(this.terrain&&(this.terrain.updateTileBinding(z),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const ee of b){const Q=this.style._layers[ee],ue=h._getLayerSourceCache(Q);if(!Q.hasOffscreenPass()||Q.isHidden(this.transform.zoom))continue;const me=ue?R[ue.id]:void 0;(Q.type==="custom"||Q.isSky()||me&&me.length)&&this.renderLayer(this,ue,Q,me)}this.depthRangeFor3D=[0,1-(h.order.length+2)*this.numSublayers*this.depthEpsilon];const U=this.terrain;if(U&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&U.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:m.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const ee=this.style._layers[b[this.currentLayer]],Q=h._getLayerSourceCache(ee);if(ee.isSky())continue;const ue=Q?R[Q.id]:void 0;this._renderTileClippingMasks(ee,Q,ue),this.renderLayer(this,Q,ee,ue)}if(this.style.fog&&this.transform.projection.supportsFog&&function(ee,Q){const ue=ee.context,me=ue.gl,_e=ee.transform,Te=new a.DepthMode(me.LEQUAL,a.DepthMode.ReadOnly,[0,1]),we=ee.useProgram("globeAtmosphere",null,_e.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Ee=a.globeToMercatorTransition(_e.zoom),he=Q.properties.get("color").toArray01(),ve=Q.properties.get("high-color").toArray01(),Pe=Q.properties.get("space-color").toArray01PremultipliedAlpha(),Ie=a.identity$1([]);a.rotateY$1(Ie,Ie,-a.degToRad(_e._center.lng)),a.rotateX$1(Ie,Ie,a.degToRad(_e._center.lat)),a.rotateZ$1(Ie,Ie,_e.angle),a.rotateX$1(Ie,Ie,-_e._pitch);const Ve=a.fromQuat(new Float32Array(16),Ie),qe=a.mapValue(Q.properties.get("star-intensity"),0,1,0,.25),Ue=5e-4,Ke=a.mapValue(Q.properties.get("horizon-blend"),0,1,Ue,.25),He=a.globeUseCustomAntiAliasing(ee,ue,_e)&&Ke===Ue?_e.worldSize/(2*Math.PI*1.025)-1:_e.globeRadius,rt=ee.frameCounter/1e3%1,At=a.length(_e.globeCenterInViewSpace),Je=Math.sqrt(Math.pow(At,2)-Math.pow(He,2)),pt=Math.acos(Je/At),at=((tt,ft,Pt,_t,Mt,ir,gr,Qt,ur,Rr,Or,rr,rn,fn)=>({u_frustum_tl:tt,u_frustum_tr:ft,u_frustum_br:Pt,u_frustum_bl:_t,u_horizon:Mt,u_transition:ir,u_fadeout_range:gr,u_color:Qt,u_high_color:ur,u_space_color:Rr,u_star_intensity:Or,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:rr,u_horizon_angle:rn,u_rotation_matrix:fn}))(_e.frustumCorners.TL,_e.frustumCorners.TR,_e.frustumCorners.BR,_e.frustumCorners.BL,_e.frustumCorners.horizon,Ee,Ke,he,ve,Pe,qe,rt,pt,Ve);ee.prepareDrawProgram(ue,we);const Et=ee.atmosphereBuffer;Et&&we.draw(ue,me.TRIANGLES,Te,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,at,"skybox",Et.vertexBuffer,Et.indexBuffer,Et.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const ee=this.style._layers[b[this.currentLayer]],Q=h._getLayerSourceCache(ee);ee.isSky()&&this.renderLayer(this,Q,ee,Q?R[Q.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<b.length;){const ee=this.style._layers[b[this.currentLayer]],Q=h._getLayerSourceCache(ee);if(ee.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(ee)){if(ee.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ue=Q?(ee.type==="symbol"?z:R)[Q.id]:void 0;this._renderTileClippingMasks(ee,Q,Q?j[Q.id]:void 0),this.renderLayer(this,Q,ee,ue),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ee=null;a.values(this.style._layers).forEach(Q=>{const ue=h._getLayerSourceCache(Q);ue&&!Q.isHidden(this.transform.zoom)&&(!ee||ee.getSource().maxzoom<ue.getSource().maxzoom)&&(ee=ue)}),ee&&this.options.showTileBoundaries&&ju.debug(this,ee,ee.getVisibleCoordinates())}this.options.showPadding&&function(ee){const Q=ee.transform.padding;Rb(ee,ee.transform.height-(Q.top||0),3,Ld),Rb(ee,Q.bottom||0,3,mE),cm(ee,Q.left||0,3,gE),cm(ee,ee.transform.width-(Q.right||0),3,yE);const ue=ee.transform.centerPoint;(function(me,_e,Te,we){zd(me,_e-1,Te-10,2,20,we),zd(me,_e-10,Te-1,20,2,we)})(ee,ue.x,ee.transform.height-ue.y,xE)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(h,m,b,S){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="sky"||b.type==="custom"||S&&S.length)&&(this.id=b.id,this.gpuTimingStart(b),(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes(b.type)||h.terrain&&b.type==="custom")&&ju[b.type](h,m,b,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(h){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let b=this.gpuTimers[h.id];b||(b=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),b.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const h=this.context.extTimerQuery,m=h.createQueryEXT();this.deferredRenderGpuTimeQueries.push(m),h.beginQueryEXT(h.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}collectGpuTimers(){const h=this.gpuTimers;return this.gpuTimers={},h}collectDeferredRenderGpuQueries(){const h=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],h}queryGpuTimers(h){const m={};for(const b in h){const S=h[b],j=this.context.extTimerQuery,R=j.getQueryObjectEXT(S.query,j.QUERY_RESULT_EXT)/1e6;j.deleteQueryEXT(S.query),m[b]=R}return m}queryGpuTimeDeferredRender(h){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery;let b=0;for(const S of h)b+=m.getQueryObjectEXT(S,m.QUERY_RESULT_EXT)/1e6,m.deleteQueryEXT(S);return b}translatePosMatrix(h,m,b,S,j){if(!b[0]&&!b[1])return h;const R=j?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(R){const ee=Math.sin(R),Q=Math.cos(R);b=[b[0]*Q-b[1]*ee,b[0]*ee+b[1]*Q]}const z=[j?b[0]:Ce(m,b[0],this.transform.zoom),j?b[1]:Ce(m,b[1],this.transform.zoom),0],U=new Float32Array(16);return a.translate(U,h,z),U}saveTileTexture(h){const m=this._tileTextures[h.size[0]];m?m.push(h):this._tileTextures[h.size[0]]=[h]}getTileTexture(h){const m=this._tileTextures[h];return m&&m.length>0?m.pop():null}isPatternMissing(h){return h===null||h!==void 0&&!this.imageManager.getPattern(h.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const h=this.terrain&&this.terrain.renderingToTexture,m=this.terrain&&this.terrain.exaggeration()===0,b=this.style&&this.style.fog,S=[];return this.terrainRenderModeElevated()&&S.push("TERRAIN"),this.transform.projection.name==="globe"&&S.push("GLOBE"),m&&S.push("ZERO_EXAGGERATION"),b&&!h&&b.getOpacity(this.transform.pitch)!==0&&S.push("FOG"),h&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}useProgram(h,m,b){this.cache=this.cache||{};const S=b||[],j=this.currentGlobalDefines().concat(S),R=Z.cacheKey(_f[h],h,j,m);return this.cache[R]||(this.cache[R]=new Z(this.context,h,_f[h],m,gy[h],j)),this.cache[R]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(h,m,b){if(this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const j=S.getOpacity(this.transform.pitch),R=((z,U,ee,Q,ue,me,_e,Te,we,Ee,he)=>{const ve=z.transform,Pe=U.properties.get("color").toArray01();Pe[3]=Q;const Ie=z.frameCounter/1e3%1;return{u_fog_matrix:ee?ve.calculateFogTileMatrix(ee):z.identityMat,u_fog_range:U.getFovAdjustedRange(ve._fov),u_fog_color:Pe,u_fog_horizon_blend:U.properties.get("horizon-blend"),u_fog_temporal_offset:Ie,u_frustum_tl:ue,u_frustum_tr:me,u_frustum_br:_e,u_frustum_bl:Te,u_globe_pos:we,u_globe_radius:Ee,u_viewport:he,u_globe_transition:a.globeToMercatorTransition(ve.zoom),u_is_globe:+(ve.projection.name==="globe")}})(this,S,b,j,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);m.setFogUniformValues(h,R)}}setTileLoadedFlag(h){this.tileLoaded=h}saveCanvasCopy(){const h=this.canvasCopy();h&&(this.frameCopies.push(h),this.tileLoaded=!1)}canvasCopy(){const h=this.context.gl,m=h.createTexture();return h.bindTexture(h.TEXTURE_2D,m),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,h.drawingBufferWidth,h.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const h=this.style&&this.style.fog;return!!h&&h.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const h=this._backgroundTiles,m=this._backgroundTiles={},b=this.transform.coveringTiles({tileSize:512});for(const S of b)m[S.key]=h[S.key]||new a.Tile(S,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}}class dm{constructor(h=0,m=0,b=0,S=0){if(isNaN(h)||h<0||isNaN(m)||m<0||isNaN(b)||b<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=m,this.left=b,this.right=S}interpolate(h,m,b){return m.top!=null&&h.top!=null&&(this.top=a.number(h.top,m.top,b)),m.bottom!=null&&h.bottom!=null&&(this.bottom=a.number(h.bottom,m.bottom,b)),m.left!=null&&h.left!=null&&(this.left=a.number(h.left,m.left,b)),m.right!=null&&h.right!=null&&(this.right=a.number(h.right,m.right,b)),this}getCenter(h,m){const b=a.clamp((this.left+h-this.right)/2,0,h),S=a.clamp((this.top+m-this.bottom)/2,0,m);return new a.Point(b,S)}equals(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right}clone(){return new dm(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function hm(x,h){const m=a.getColumn(x,3);a.fromQuat(x,h),a.setColumn(x,3,m)}function Kr(x,h){const m=a.identity$1([]);return a.rotateZ$1(m,m,-h),a.rotateX$1(m,m,-x),m}function Af(x,h){const m=[x[0],x[1],0],b=[h[0],h[1],0];if(a.length(m)>=1e-15){const R=a.normalize([],m);a.scale$2(b,R,a.dot(b,R)),h[0]=b[0],h[1]=b[1]}const S=a.cross([],h,x);if(a.len(S)<1e-15)return null;const j=Math.atan2(-S[1],S[0]);return Kr(Math.atan2(Math.sqrt(x[0]*x[0]+x[1]*x[1]),-x[2]),j)}class Fb{constructor(h,m){this.position=h,this.orientation=m}get position(){return this._position}set position(h){if(h){const m=h instanceof a.MercatorCoordinate?h:new a.MercatorCoordinate(h[0],h[1],h[2]);this._renderWorldCopies&&(m.x=a.wrap(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(h,m){if(this.orientation=null,!this.position)return;const b=this.position,S=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(h)):0,j=a.MercatorCoordinate.fromLngLat(h,S),R=[j.x-b.x,j.y-b.y,j.z-b.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=Af(R,m)}setPitchBearing(h,m){this.orientation=Kr(a.degToRad(h),a.degToRad(-m))}}class fm{constructor(h,m){this._transform=a.identity([]),this.orientation=m,this.position=h}get mercatorPosition(){const h=this.position;return new a.MercatorCoordinate(h[0],h[1],h[2])}get position(){const h=a.getColumn(this._transform,3);return[h[0],h[1],h[2]]}set position(h){var m;h&&a.setColumn(this._transform,3,[(m=h)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(h){this._orientation=h||a.identity$1([]),h&&hm(this._transform,this._orientation)}getPitchBearing(){const h=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2])}}setPitchBearing(h,m){this._orientation=Kr(h,m),hm(this._transform,this._orientation)}forward(){const h=a.getColumn(this._transform,2);return[-h[0],-h[1],-h[2]]}up(){const h=a.getColumn(this._transform,1);return[-h[0],-h[1],-h[2]]}right(){const h=a.getColumn(this._transform,0);return[h[0],h[1],h[2]]}getCameraToWorld(h,m){const b=new Float64Array(16);return a.invert(b,this.getWorldToCamera(h,m)),b}getWorldToCameraPosition(h,m,b){const S=this.position;a.scale$2(S,S,-h);const j=new Float64Array(16);return a.fromScaling(j,[b,b,b]),a.translate(j,j,S),j[10]*=m,j}getWorldToCamera(h,m){const b=new Float64Array(16),S=new Float64Array(4),j=this.position;return a.conjugate(S,this._orientation),a.scale$2(j,j,-h),a.fromQuat(b,S),a.translate(b,b,j),b[1]*=-1,b[5]*=-1,b[9]*=-1,b[13]*=-1,b[8]*=m,b[9]*=m,b[10]*=m,b[11]*=m,b}getCameraToClipPerspective(h,m,b,S){const j=new Float64Array(16);return a.perspective(j,h,m,b,S),j}getDistanceToElevation(h,m=!1){const b=h===0?0:a.mercatorZfromAltitude(h,m?a.latFromMercatorY(this.position[1]):this.position[1]),S=this.forward();return(b-this.position[2])/S[2]}clone(){return new fm([...this.position],[...this.orientation])}}function Fd(x,h){const m=pm(x.projection,x.zoom,x.width,x.height),b=function(j,R,z,U,ee){const Q=new a.LngLat(z.lng-180*Pl,z.lat),ue=new a.LngLat(z.lng+180*Pl,z.lat),me=j.project(Q.lng,Q.lat),_e=j.project(ue.lng,ue.lat),Te=-Math.atan2(_e.y-me.y,_e.x-me.x),we=a.MercatorCoordinate.fromLngLat(z);we.y=a.clamp(we.y,-1+Pl,1-Pl);const Ee=we.toLngLat(),he=j.project(Ee.lng,Ee.lat),ve=a.MercatorCoordinate.fromLngLat(Ee);ve.x+=Pl;const Pe=ve.toLngLat(),Ie=j.project(Pe.lng,Pe.lat),Ve=mm(Ie.x-he.x,Ie.y-he.y,Te),qe=a.MercatorCoordinate.fromLngLat(Ee);qe.y+=Pl;const Ue=qe.toLngLat(),Ke=j.project(Ue.lng,Ue.lat),He=mm(Ke.x-he.x,Ke.y-he.y,Te),rt=Math.abs(Ve.x)/Math.abs(He.y),At=a.identity([]);a.rotateZ(At,At,-Te*(1-(ee?0:U)));const Je=a.identity([]);return a.scale(Je,Je,[1,1-(1-rt)*U,1]),Je[4]=-He.x/He.y*U,a.rotateZ(Je,Je,Te),a.multiply(Je,At,Je),Je}(x.projection,0,x.center,m,h),S=Bb(x);return a.scale(b,b,[S,S,1]),b}function Bb(x){const h=x.projection,m=pm(x.projection,x.zoom,x.width,x.height),b=Vb(h,x.center),S=Vb(h,a.LngLat.convert(h.center));return Math.pow(2,b*m+(1-m)*S)}function pm(x,h,m,b,S=1/0){const j=x.range;if(!j)return 0;const R=Math.min(S,Math.max(m,b)),z=Math.log(R/1024)/Math.LN2;return a.smoothstep(j[0]+z,j[1]+z,h)}const Pl=1/4e4;function Vb(x,h){const m=a.clamp(h.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),b=new a.LngLat(h.lng-180*Pl,m),S=new a.LngLat(h.lng+180*Pl,m),j=x.project(b.lng,m),R=x.project(S.lng,m),z=a.MercatorCoordinate.fromLngLat(b),U=a.MercatorCoordinate.fromLngLat(S),ee=R.x-j.x,Q=R.y-j.y,ue=U.x-z.x,me=U.y-z.y,_e=Math.sqrt((ue*ue+me*me)/(ee*ee+Q*Q));return Math.log(_e)/Math.LN2}function mm(x,h,m){const b=Math.cos(m),S=Math.sin(m);return{x:x*b-h*S,y:x*S+h*b}}class Bd{constructor(h,m,b,S,j,R,z){this.tileSize=512,this._renderWorldCopies=j===void 0||j,this._minZoom=h||0,this._maxZoom=m||22,this._minPitch=b??0,this._maxPitch=S??60,this.setProjection(R),this.setMaxBounds(z),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new dm,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new fm,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const h=new Bd(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return h._elevation=this._elevation,h._centerAltitude=this._centerAltitude,h._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,h.tileSize=this.tileSize,h.mercatorFromTransition=this.mercatorFromTransition,h.width=this.width,h.height=this.height,h.cameraElevationReference=this.cameraElevationReference,h._center=this._center,h._setZoom(this.zoom),h._seaLevelZoom=this._seaLevelZoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._nearZ=this._nearZ,h._farZ=this._farZ,h._averageElevation=this._averageElevation,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._camera=this._camera.clone(),h._calcMatrices(),h.freezeTileCoverage=this.freezeTileCoverage,h.frustumCorners=this.frustumCorners,h}get elevation(){return this._elevation}set elevation(h){this._elevation!==h&&(this._elevation=h,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(h,m=!1){const b=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||b)&&this._updateCameraOnTerrain(),(h||b)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(h){this.projectionOptions=h||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const b=!p(m,this.getProjection());return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setMercatorFromTransition(){const h=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const m=h!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))}get maxZoom(){return this._maxZoom}set maxZoom(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))}get minPitch(){return this._minPitch}set minPitch(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))}get maxPitch(){return this._maxPitch}set maxPitch(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(h){h===void 0?h=!0:h===null&&(h=!1),this._renderWorldCopies=h}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get cameraWorldSize(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.Point(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(h){this.rotation=h}get rotation(){return-this.angle/Math.PI*180}set rotation(h){const m=-h*Math.PI/180;var b;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(b=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b),function(S,j,R){var z=j[0],U=j[1],ee=j[2],Q=j[3],ue=Math.sin(R),me=Math.cos(R);S[0]=z*me+ee*ue,S[1]=U*me+Q*ue,S[2]=z*-ue+ee*me,S[3]=U*-ue+Q*me}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(h){const m=a.clamp(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const h=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/h)}set fov(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=a.degToRad(h),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(h){this._averageElevation=h,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(h){const m=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(h){this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;this._centerAltitude=h.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=h.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const h=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],b=this.horizonLineFromTop();let S=0,j=0;for(let R=0;R<m.length;R++){const z=new a.Point(m[R][0]*this.width,b+m[R][1]*(this.height-b)),U=h.pointCoordinate(z);if(!U)continue;const ee=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);S+=U[3]*ee,j+=ee}return j===0?NaN:S/j}get center(){return this._center}set center(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const h=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),b=this.pixelsPerMeter/this.worldSize*m,S=this._mercatorZfromZoom(h),j=this._mercatorZfromZoom(this._maxZoom),R=Math.max(S-b,j);this._setZoom(this._zoomFromMercatorZ(R))}get padding(){return this._edgeInsets.toJSON()}set padding(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())}computeZoomRelativeTo(h){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,h.toAltitude()));let b;b=h.z<this._camera.position[2]?[m.x,m.y,m.z]:[h.x,h.y,h.z];const S=a.length(a.sub([],this._camera.position,b));return a.clamp(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(h){if(!this.height||!h.position&&!h.orientation)return;this._updateCameraState();let m=!1;if(h.orientation&&!a.exactEquals(h.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(h.orientation)),h.position){const b=[h.position.x,h.position.y,h.position.z];a.exactEquals$1(b,this._camera.position)||(this._setCameraPosition(b),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const h=this._camera.position,m=new Fb;return m.position=new a.MercatorCoordinate(h[0],h[1],h[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(h){if(!a.length$1(h))return!1;a.normalize$1(h,h);const m=a.transformQuat([],[0,0,-1],h),b=a.transformQuat([],[0,-1,0],h);if(b[2]<0)return!1;const S=Af(m,b);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(h){const m=this.zoomScale(this.minZoom)*this.tileSize,b=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;h[2]=a.clamp(h[2],S/b,S/m),this._camera.position=h}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(h){return this._edgeInsets.equals(h)}interpolatePadding(h,m,b){this._unmodified=!1,this._edgeInsets.interpolate(h,m,b),this._constrain(),this._calcMatrices()}coveringZoomLevel(h){const m=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(h){const m=[new a.UnwrappedTileID(0,h)];if(this.renderWorldCopies){const b=this.pointCoordinate(new a.Point(0,0)),S=this.pointCoordinate(new a.Point(this.width,0)),j=this.pointCoordinate(new a.Point(this.width,this.height)),R=this.pointCoordinate(new a.Point(0,this.height)),z=Math.floor(Math.min(b.x,S.x,j.x,R.x)),U=Math.floor(Math.max(b.x,S.x,j.x,R.x)),ee=1;for(let Q=z-ee;Q<=U+ee;Q++)Q!==0&&m.push(new a.UnwrappedTileID(Q,h))}return m}coveringTiles(h){let m=this.coveringZoomLevel(h);const b=m,S=this.elevation&&!h.isTerrainDEM,j=this.projection.name==="mercator";if(h.minzoom!==void 0&&m<h.minzoom)return[];h.maxzoom!==void 0&&m>h.maxzoom&&(m=h.maxzoom);const R=this.locationCoordinate(this.center),z=this.center.lat,U=1<<m,ee=[U*R.x,U*R.y,0],Q=this.projection.name==="globe",ue=!Q,me=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,ue),_e=Q?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Te=U*a.mercatorZfromAltitude(1,this.center.lat),we=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),Ee=[U*_e.x,U*_e.y,we*(ue?1:Te)],he=this.cameraToCenterDistance/h.tileSize*(h.roundZoom?1:.502),ve=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?m:0,Pe=h.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ie=h.isTerrainDEM?-Pe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ve=this.projection.isReprojectedInTileSpace?Bb(this):1,qe=tt=>{const Pt=new a.MercatorCoordinate(tt.x+25e-6,tt.y,tt.z),_t=new a.MercatorCoordinate(tt.x,tt.y+25e-6,tt.z),Mt=tt.toLngLat(),ir=Pt.toLngLat(),gr=_t.toLngLat(),Qt=this.locationCoordinate(Mt),ur=this.locationCoordinate(ir),Rr=this.locationCoordinate(gr),Or=Math.hypot(ur.x-Qt.x,ur.y-Qt.y),rr=Math.hypot(Rr.x-Qt.x,Rr.y-Qt.y);return Math.sqrt(Or*rr)*Ve/25e-6},Ue=tt=>{const ft=Pe,Pt=Ie;return{aabb:a.tileAABB(this,U,0,0,0,tt,Pt,ft,this.projection),zoom:0,x:0,y:0,minZ:Pt,maxZ:ft,wrap:tt,fullyVisible:!1}},Ke=[];let He=[];const rt=m,At=h.reparseOverscaled?b:m,Je=tt=>tt*tt,pt=Je((we-this._centerAltitude)*Te),at=tt=>{if(!this._elevation||!tt.tileID||!j)return;const ft=this._elevation.getMinMaxForTile(tt.tileID),Pt=tt.aabb;ft?(Pt.min[2]=ft.min,Pt.max[2]=ft.max,Pt.center[2]=(Pt.min[2]+Pt.max[2])/2):(tt.shouldSplit=Et(tt),tt.shouldSplit||(Pt.min[2]=Pt.max[2]=Pt.center[2]=this._centerAltitude))},Et=tt=>{if(tt.zoom<ve)return!0;if(tt.zoom===rt)return!1;if(tt.shouldSplit!=null)return tt.shouldSplit;const ft=tt.aabb.distanceX(Ee),Pt=tt.aabb.distanceY(Ee);let _t=pt,Mt=1;if(Q){_t=Je(tt.aabb.distanceZ(Ee));const Qt=Math.pow(2,tt.zoom),ur=a.latFromMercatorY((tt.y+1)/Qt),Rr=a.latFromMercatorY(tt.y/Qt),Or=Math.min(Math.max(z,ur),Rr),rr=a.circumferenceAtLatitude(Or)/a.circumferenceAtLatitude(z);if(Mt=Or===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,rr/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&tt.zoom===rt-1&&rr>=.9)return!0}else if(S&&(_t=Je(tt.aabb.distanceZ(Ee)*Te)),this.projection.isReprojectedInTileSpace&&b<=5){const Qt=Math.pow(2,tt.zoom),ur=qe(new a.MercatorCoordinate((tt.x+.5)/Qt,(tt.y+.5)/Qt));Mt=ur>.85?1:ur}const ir=ft*ft+Pt*Pt+_t,gr=Je((1<<rt-tt.zoom)*he*Mt*((Qt,ur)=>{if(ur*Je(.707)<Qt)return 1;const Rr=Math.sqrt(ur/Qt);return Rr/(1.4144271570014144+(Math.pow(1.1,Rr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(_t,pt),ir));return ir<gr};if(this.renderWorldCopies)for(let tt=1;tt<=3;tt++)Ke.push(Ue(-tt)),Ke.push(Ue(tt));for(Ke.push(Ue(0));Ke.length>0;){const tt=Ke.pop(),ft=tt.x,Pt=tt.y;let _t=tt.fullyVisible;if(!_t){const Mt=tt.aabb.intersects(me);if(Mt===0)continue;_t=Mt===2}if(tt.zoom!==rt&&Et(tt))for(let Mt=0;Mt<4;Mt++){const ir=(ft<<1)+Mt%2,gr=(Pt<<1)+(Mt>>1),Qt={aabb:j?tt.aabb.quadrant(Mt):a.tileAABB(this,U,tt.zoom+1,ir,gr,tt.wrap,tt.minZ,tt.maxZ,this.projection),zoom:tt.zoom+1,x:ir,y:gr,wrap:tt.wrap,fullyVisible:_t,tileID:void 0,shouldSplit:void 0,minZ:tt.minZ,maxZ:tt.maxZ};S&&!Q&&(Qt.tileID=new a.OverscaledTileID(tt.zoom+1===rt?At:tt.zoom+1,tt.wrap,tt.zoom+1,ir,gr),at(Qt)),Ke.push(Qt)}else{const Mt=tt.zoom===rt?At:tt.zoom;if(h.minzoom&&h.minzoom>Mt)continue;const ir=ee[0]-(.5+ft+(tt.wrap<<tt.zoom))*(1<<m-tt.zoom),gr=ee[1]-.5-Pt,Qt=tt.tileID?tt.tileID:new a.OverscaledTileID(Mt,tt.wrap,tt.zoom,ft,Pt);He.push({tileID:Qt,distanceSq:ir*ir+gr*gr})}}if(this.fogCullDistSq){const tt=this.fogCullDistSq,ft=this.horizonLineFromTop();He=He.filter(Pt=>{const _t=[0,0,0,1],Mt=[a.EXTENT,a.EXTENT,0,1],ir=this.calculateFogTileMatrix(Pt.tileID.toUnwrapped());a.transformMat4$1(_t,_t,ir),a.transformMat4$1(Mt,Mt,ir);const gr=a.getAABBPointSquareDist(_t,Mt);if(gr===0)return!0;let Qt=!1;const ur=this._elevation;if(ur&&gr>tt&&ft!==0){const Rr=this.calculateProjMatrix(Pt.tileID.toUnwrapped());let Or;h.isTerrainDEM||(Or=ur.getMinMaxForTile(Pt.tileID)),Or||(Or={min:Ie,max:Pe});const rr=a.furthestTileCorner(this.rotation),rn=[rr[0]*a.EXTENT,rr[1]*a.EXTENT,Or.max];a.transformMat4(rn,rn,Rr),Qt=(1-rn[1])*this.height*.5<ft}return gr<tt||Qt})}return He.sort((tt,ft)=>tt.distanceSq-ft.distanceSq).map(tt=>tt.tileID)}resize(h,m){this.width=h,this.height=m,this.pixelsToGLUnits=[2/h,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(h){return Math.pow(2,h)}scaleZoom(h){return Math.log(h)/Math.LN2}project(h){const m=a.clamp(h.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),b=this.projection.project(h.lng,m);return new a.Point(b.x*this.worldSize,b.y*this.worldSize)}unproject(h){return this.projection.unproject(h.x/this.worldSize,h.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(h,m){let b,S;const j=this.centerPoint;if(this.projection.name==="globe"){const z=this.worldSize;b=(m.x-j.x)/z,S=(m.y-j.y)/z}else{const z=this.pointCoordinate(m),U=this.pointCoordinate(j);b=z.x-U.x,S=z.y-U.y}const R=this.locationCoordinate(h);this.setLocation(new a.MercatorCoordinate(R.x-b,R.y-S))}setLocation(h){this.center=this.coordinateLocation(h),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(h){return this.projection.locationPoint(this,h)}locationPoint3D(h){return this.projection.locationPoint(this,h,!0)}pointLocation(h){return this.coordinateLocation(this.pointCoordinate(h))}pointLocation3D(h){return this.coordinateLocation(this.pointCoordinate3D(h))}locationCoordinate(h,m){const b=m?a.mercatorZfromAltitude(m,h.lat):void 0,S=this.projection.project(h.lng,h.lat);return new a.MercatorCoordinate(S.x,S.y,b)}coordinateLocation(h){return this.projection.unproject(h.x,h.y)}pointRayIntersection(h,m){const b=m??this._centerAltitude,S=[h.x,h.y,0,1],j=[h.x,h.y,1,1];a.transformMat4$1(S,S,this.pixelMatrixInverse),a.transformMat4$1(j,j,this.pixelMatrixInverse);const R=j[3];a.scale$1(S,S,1/S[3]),a.scale$1(j,j,1/R);const z=S[2],U=j[2];return{p0:S,p1:j,t:z===U?0:(b-z)/(U-z)}}screenPointToMercatorRay(h){const m=[h.x,h.y,0,1],b=[h.x,h.y,1,1];return a.transformMat4$1(m,m,this.pixelMatrixInverse),a.transformMat4$1(b,b,this.pixelMatrixInverse),a.scale$1(m,m,1/m[3]),a.scale$1(b,b,1/b[3]),m[2]=a.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,b[2]=a.mercatorZfromAltitude(b[2],this._center.lat)*this.worldSize,a.scale$1(m,m,1/this.worldSize),a.scale$1(b,b,1/this.worldSize),new a.Ray([m[0],m[1],m[2]],a.normalize([],a.sub([],b,m)))}rayIntersectionCoordinate(h){const{p0:m,p1:b,t:S}=h,j=a.mercatorZfromAltitude(m[2],this._center.lat),R=a.mercatorZfromAltitude(b[2],this._center.lat);return new a.MercatorCoordinate(a.number(m[0],b[0],S)/this.worldSize,a.number(m[1],b[1],S)/this.worldSize,a.number(j,R,S))}pointCoordinate(h,m=this._centerAltitude){return this.projection.pointCoordinate(this,h.x,h.y,m)}pointCoordinate3D(h){if(!this.elevation)return this.pointCoordinate(h);let m=this.projection.pointCoordinate3D(this,h.x,h.y);if(m)return new a.MercatorCoordinate(m[0],m[1],m[2]);let b=0,S=this.horizonLineFromTop();if(h.y>S)return this.pointCoordinate(h);const j=.02*S,R=h.clone();for(let z=0;z<10&&S-b>j;z++){R.y=a.number(b,S,.66);const U=this.projection.pointCoordinate3D(this,R.x,R.y);U?(S=R.y,m=U):b=R.y}return m?new a.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(h)}isPointAboveHorizon(h){return this.projection.isPointAboveHorizon(this,h)}isPointOnSurface(h){if(h.y<0||h.y>this.height||h.x<0||h.x>this.width)return!1;if(this.elevation||this.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(h);const m=this.pointCoordinate(h);return m.y>=0&&m.y<=1}_coordinatePoint(h,m){const b=m&&this.elevation?this.elevation.getAtPointOrZero(h,this._centerAltitude):this._centerAltitude,S=[h.x*this.worldSize,h.y*this.worldSize,b+h.toAltitude(),1];return a.transformMat4$1(S,S,this.pixelMatrix),S[3]>0?new a.Point(S[0]/S[3],S[1]/S[3]):new a.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:h,left:m}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,j=this.pointLocation3D(new a.Point(m,h)),R=this.pointLocation3D(new a.Point(S,h)),z=this.pointLocation3D(new a.Point(S,b)),U=this.pointLocation3D(new a.Point(m,b));let ee=Math.min(j.lng,R.lng,z.lng,U.lng),Q=Math.max(j.lng,R.lng,z.lng,U.lng),ue=Math.min(j.lat,R.lat,z.lat,U.lat),me=Math.max(j.lat,R.lat,z.lat,U.lat);const _e=Math.pow(2,-this.zoom)/16*270,Te=this.projection.name==="globe"?1:4,we=(Ee,he,ve,Pe,Ie)=>{const Ve=(Ee+ve)/2,qe=(he+Pe)/2,Ue=new a.Point(Ve,qe),{lng:Ke,lat:He}=this.pointLocation3D(Ue),rt=Math.max(0,ee-Ke,ue-He,Ke-Q,He-me);ee=Math.min(ee,Ke),Q=Math.max(Q,Ke),ue=Math.min(ue,He),me=Math.max(me,He),(Ie<Te||rt>_e)&&(we(Ee,he,Ve,qe,Ie+1),we(Ve,qe,ve,Pe,Ie+1))};if(we(m,h,S,h,1),we(S,h,S,b,1),we(S,b,m,b,1),we(m,b,m,h,1),this.projection.name==="globe"){const[Ee,he]=a.polesInViewport(this);Ee?(me=90,Q=180,ee=-180):he&&(ue=-90,Q=180,ee=-180)}return new a.LngLatBounds(new a.LngLat(ee,ue),new a.LngLat(Q,me))}_getBoundsRectangular(h,m){const{top:b,left:S}=this._edgeInsets,j=this.height-this._edgeInsets.bottom,R=this.width-this._edgeInsets.right,z=new a.Point(S,b),U=new a.Point(R,b),ee=new a.Point(R,j),Q=new a.Point(S,j);let ue=this.pointCoordinate(z,h),me=this.pointCoordinate(U,h);const _e=this.pointCoordinate(ee,m),Te=this.pointCoordinate(Q,m),we=(Ee,he)=>(he.y-Ee.y)/(he.x-Ee.x);return ue.y>1&&me.y>=0?ue=new a.MercatorCoordinate((1-Te.y)/we(Te,ue)+Te.x,1):ue.y<0&&me.y<=1&&(ue=new a.MercatorCoordinate(-Te.y/we(Te,ue)+Te.x,0)),me.y>1&&ue.y>=0?me=new a.MercatorCoordinate((1-_e.y)/we(_e,me)+_e.x,1):me.y<0&&ue.y<=1&&(me=new a.MercatorCoordinate(-_e.y/we(_e,me)+_e.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(me)).extend(this.coordinateLocation(Te)).extend(this.coordinateLocation(_e))}_getBoundsRectangularTerrain(){const h=this.elevation;if(!h.visibleDemTiles.length||h.isUsingMockSource())return this._getBoundsRectangular(0,0);const m=h.visibleDemTiles.reduce((b,S)=>{if(S.dem){const j=S.dem.tree;b.min=Math.min(b.min,j.minimums[0]),b.max=Math.max(b.max,j.maximums[0])}return b},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(m.min*h.exaggeration(),m.max*h.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(h=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,b=this.height/2-m*(1-this._horizonShift);return h?Math.max(0,b):b}getMaxBounds(){return this.maxBounds}setMaxBounds(h){this.maxBounds=h,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,h&&(this.minLat=h.getSouth(),this.maxLat=h.getNorth(),this.minLng=h.getWest(),this.maxLng=h.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(h,m){return this.projection.createTileMatrix(this,m,h)}calculateDistanceTileData(h){const m=h.key,b=this._distanceTileDataCache;if(b[m])return b[m];const S=h.canonical,j=1/this.height,R=this.cameraWorldSize,z=R/this.zoomScale(S.z),U=(S.x+Math.pow(2,S.z)*h.wrap)*z,ee=S.y*z,Q=this.point;Q.x*=R/this.worldSize,Q.y*=R/this.worldSize;const ue=this.angle,me=Math.sin(-ue),_e=-Math.cos(-ue);return b[m]={bearing:[me,_e],center:[(Q.x-U)*j,(Q.y-ee)*j],scale:z/a.EXTENT*j},b[m]}calculateFogTileMatrix(h){const m=h.key,b=this._fogTileMatrixCache;if(b[m])return b[m];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,h);return a.multiply(S,this.worldToFogMatrix,S),b[m]=new Float32Array(S),b[m]}calculateProjMatrix(h,m=!1){const b=h.key,S=m?this._alignedProjMatrixCache:this._projMatrixCache;if(S[b])return S[b];const j=this.calculatePosMatrix(h,this.worldSize);return a.multiply(j,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.alignedProjMatrix:this.projMatrix,j),S[b]=new Float32Array(j),S[b]}calculatePixelsToTileUnitsMatrix(h){const m=h.tileID.key,b=this._pixelsToTileUnitsCache;if(b[m])return b[m];const S=function(j,R){const{scale:z}=j.tileTransform,U=z*a.EXTENT/(j.tileSize*Math.pow(2,R.zoom-j.tileID.overscaledZ+j.tileID.canonical.z));return ee=new Float32Array(4),me=(Q=R.inverseAdjustmentMatrix)[1],_e=Q[2],Te=Q[3],Ee=(ue=[U,U])[1],ee[0]=Q[0]*(we=ue[0]),ee[1]=me*we,ee[2]=_e*Ee,ee[3]=Te*Ee,ee;var ee,Q,ue,me,_e,Te,we,Ee}(h,this);return b[m]=S,b[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const h=1/this.worldSize,m=a.fromScaling([],[h,h,h]);return a.multiply(m,m,this.globeMatrix),m}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const h=this._elevation;this._updateCameraState();const m=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(m),S=this._camera.forward(),j=a.mercatorZfromAltitude(1,this._center.lat);b[2]/=j,S[2]/=j,a.normalize(S,S);const R=h.raycast(b,S,h.exaggeration());if(R){const z=a.scaleAndAdd([],b,S,R),U=new a.MercatorCoordinate(z[0],z[1],a.mercatorZfromAltitude(z[2],a.latFromMercatorY(z[1]))),ee=(U.z+a.length([U.x-b[0],U.y-b[1],U.z-b[2]*j]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(ee),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(h=!1){if(!this._elevation)return;const m=this._elevation,b=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(b),j=m.getAtPointOrZero(new a.MercatorCoordinate(...S)),R=this.pixelsPerMeter/this.worldSize*j,z=this._minimumHeightOverTerrain(),U=S[2]-R;if(U<=z)if(U<0||h){const ee=this.locationCoordinate(this._center,this._centerAltitude),Q=[S[0],S[1],ee.z-S[2]],ue=a.length(Q);Q[2]-=(z-U)/this._pixelsPerMercatorPixel;const me=a.length(Q);if(me===0)return;a.scale$2(Q,Q,ue/me*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],ee.z*this._pixelsPerMercatorPixel-Q[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const h=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||h){const me=this.center;return me.lat=a.clamp(me.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!h)&&(me.lng=a.clamp(me.lng,this.minLng,this.maxLng)),this.center=me,void(this._constraining=!1)}const m=this._unmodified,{x:b,y:S}=this.point;let j=0,R=b,z=S;const U=this.width/2,ee=this.height/2,Q=this.worldMinY*this.scale,ue=this.worldMaxY*this.scale;if(S-ee<Q&&(z=Q+ee),S+ee>ue&&(z=ue-ee),ue-Q<this.height&&(j=Math.max(j,this.height/(ue-Q)),z=(ue+Q)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const me=this.worldMinX*this.scale,_e=this.worldMaxX*this.scale,Te=this.worldSize/2-(me+_e)/2;R=(b+Te+this.worldSize)%this.worldSize-Te,R-U<me&&(R=me+U),R+U>_e&&(R=_e-U),_e-me<this.width&&(j=Math.max(j,this.width/(_e-me)),R=(_e+me)/2)}R===b&&z===S||(this.center=this.unproject(new a.Point(R,z))),j&&(this.zoom+=this.scaleZoom(j)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let h=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(h=Math.max(h,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),h}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const h=this.centerOffset,m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const b=pm(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?m:1,j=this._camera.getWorldToCamera(this.worldSize,S),R=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);R[8]=2*-h.x/this.width,R[9]=2*h.y/this.height;let z=a.mul([],R,j);if(this.projection.isReprojectedInTileSpace){const qe=this.locationCoordinate(this.center),Ue=a.identity([]);a.translate(Ue,Ue,[qe.x*this.worldSize,qe.y*this.worldSize,0]),a.multiply(Ue,Ue,Fd(this)),a.translate(Ue,Ue,[-qe.x*this.worldSize,-qe.y*this.worldSize,0]),a.multiply(z,z,Ue),this.inverseAdjustmentMatrix=function(Ke){const He=Fd(Ke,!0);return V([],[He[0],He[1],He[4],He[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],z,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=z,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const U=a.invert([],R);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(U,this.horizonLineFromTop(),this.height);const ee=new Float32Array(16);a.identity(ee),a.scale(ee,ee,[1,-1,1]),a.rotateX(ee,ee,this._pitch),a.rotateZ(ee,ee,this.angle);const Q=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),ue=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Q[8]=2*-h.x/this.width,Q[9]=2*(h.y+ue)/this.height,this.skyboxMatrix=a.multiply(ee,Q,ee);const me=this.point,_e=me.x,Te=me.y,we=this.width%2/2,Ee=this.height%2/2,he=Math.cos(this.angle),ve=Math.sin(this.angle),Pe=_e-Math.round(_e)+he*we+ve*Ee,Ie=Te-Math.round(Te)+he*Ee+ve*we,Ve=new Float64Array(z);if(a.translate(Ve,Ve,[Pe>.5?Pe-1:Pe,Ie>.5?Ie-1:Ie,0]),this.alignedProjMatrix=Ve,z=a.create(),a.scale(z,z,[this.width/2,-this.height/2,1]),a.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=a.create(),a.scale(z,z,[1,-1,1]),a.translate(z,z,[-1,-1,0]),a.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},z=a.invert(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const qe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(qe,qe,j),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const h=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,b=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,j=[h,h,m];a.scale$2(j,j,S),a.scale$2(b,b,-1),a.multiply$2(b,b,j);const R=a.create();a.translate(R,R,b),a.scale(R,R,j),this.mercatorFogMatrix=R,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(h,m,S)}_computeCameraPosition(h){const m=(h=h||this.pixelsPerMeter)/this.pixelsPerMeter,b=this._camera.forward(),S=this.point,j=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-h/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-b[0]*j,S.y/this.worldSize-b[1]*j,h/this.worldSize*this._centerAltitude-b[2]*j]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(h){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),b=this._camera.position[2],S=h[2];let j=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(j=Math.min((m-b)/S,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,h,j),this._updateStateFromCamera()}_updateStateFromCamera(){const h=this._camera.position,m=this._camera.forward(),{pitch:b,bearing:S}=this._camera.getPitchBearing(),j=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,R=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),z=Math.max((h[2]-j)/Math.cos(b),R),U=this._zoomFromMercatorZ(z);a.scaleAndAdd(h,h,m,z),this._pitch=a.clamp(b,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(S,-Math.PI,Math.PI),this._setZoom(a.clamp(U,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(h[0],h[1],h[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(h){return Math.pow(2,h)*this.tileSize}_mercatorZfromZoom(h){return this.cameraToCenterDistance/this._worldSizeFromZoom(h)}_minimumHeightOverTerrain(){const h=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(h)}_zoomFromMercatorZ(h){return this.scaleZoom(this.cameraToCenterDistance/(h*this.tileSize))}zoomFromMercatorZAdjusted(h){let m=0,b=a.GLOBE_ZOOM_THRESHOLD_MAX,S=0,j=1/0;for(;b-m>1e-6&&b>m;){const R=m+.5*(b-m),z=this.tileSize*Math.pow(2,R),U=this.getCameraToCenterDistance(this.projection,R,z),ee=this.scaleZoom(U/(h*this.tileSize)),Q=Math.abs(R-ee);Q<j&&(j=Q,S=R),R<ee?m=R:b=R}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(h,m){const b=Math.min(h.x,m.x),S=Math.max(h.x,m.x),j=Math.min(h.y,m.y),R=Math.max(h.y,m.y);if(j<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const z=[new a.Point(b,j),new a.Point(S,R),new a.Point(b,R),new a.Point(S,j)],U=this.renderWorldCopies?-3:0,ee=this.renderWorldCopies?4:1;for(const Q of z){const ue=this.pointRayIntersection(Q);if(ue.t<0)return!0;const me=this.rayIntersectionCoordinate(ue);if(me.x<U||me.y<0||me.x>ee||me.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.Point(0,0),new a.Point(this.width,this.height))}zoomDeltaToMovement(h,m){const b=a.length(a.sub([],this._camera.position,h)),S=this._zoomFromMercatorZ(b)+m;return b-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const h=function([m,b,S],j){const R=[m,b,S,1];a.transformMat4$1(R,R,j);const z=R[3]=Math.max(R[3],1e-6);return R[0]/=z,R[1]/=z,R[2]/=z,R}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.Point(h[0],h[1])}{const h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,h))}}getCameraToCenterDistance(h,m=this.zoom,b=this.worldSize){const S=pm(h,m,this.width,this.height,1024),j=h.pixelSpaceConversion(this.center.lat,b,S);return .5/Math.tan(.5*this._fov)*this.height*j}getWorldToCameraMatrix(){const h=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.multiply(h,h,this.globeMatrix),h}}function Vd(x,h){let m=!1,b=null;const S=()=>{b=null,m&&(x(),b=setTimeout(S,h),m=!1)};return()=>(m=!0,b||S(),b)}class vy{constructor(h){this._hashName=h&&encodeURIComponent(h),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Vd(this._updateHashUnthrottled.bind(this),300)}addTo(h){return this._map=h,a.window.addEventListener("hashchange",this._onHashChange,!1),h.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const h=this._map;if(!h)return"";const m=Nf(h);if(this._hashName){const b=this._hashName;let S=!1;const j=a.window.location.hash.slice(1).split("&").map(R=>{const z=R.split("=")[0];return z===b?(S=!0,`${z}=${m}`):R}).filter(R=>R);return S||j.push(`${b}=${m}`),`#${j.join("&")}`}return`#${m}`}_getCurrentHash(){const h=a.window.location.hash.replace("#","");if(this._hashName){let m;return h.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(m=b)}),(m&&m[1]||"").split("/")}return h.split("/")}_onHashChange(){const h=this._map;if(!h)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(b=>isNaN(b))){const b=h.dragRotate.isEnabled()&&h.touchZoomRotate.isEnabled()?+(m[3]||0):h.getBearing();return h.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:b,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){const h=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,h)}}function Nf(x,h){const m=x.getCenter(),b=Math.round(100*x.getZoom())/100,S=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),j=Math.pow(10,S),R=Math.round(m.lng*j)/j,z=Math.round(m.lat*j)/j,U=x.getBearing(),ee=x.getPitch();let Q=h?`/${R}/${z}/${b}`:`${b}/${z}/${R}`;return(U||ee)&&(Q+="/"+Math.round(10*U)/10),ee&&(Q+=`/${Math.round(ee)}`),Q}const Cf={linearity:.3,easing:a.bezier(0,0,.3,1)},gm=a.extend({deceleration:2500,maxSpeed:1400},Cf),ym=a.extend({deceleration:20,maxSpeed:1400},Cf),Kt=a.extend({deceleration:1e3,maxSpeed:360},Cf),po=a.extend({deceleration:1e3,maxSpeed:90},Cf);class Ub{constructor(h){this._map=h,this.clear()}clear(){this._inertiaBuffer=[]}record(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:h})}_drainInertiaBuffer(){const h=this._inertiaBuffer,m=a.exported.now();for(;h.length>0&&m-h[0].time>160;)h.shift()}_onMoveEnd(h){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const m={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:j}of this._inertiaBuffer)m.zoom+=j.zoomDelta||0,m.bearing+=j.bearingDelta||0,m.pitch+=j.pitchDelta||0,j.panDelta&&m.pan._add(j.panDelta),j.around&&(m.around=j.around),j.pinchAround&&(m.pinchAround=j.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(m.pan.mag()){const j=If(m.pan.mag(),b,a.extend({},gm,h||{}));S.offset=m.pan.mult(j.amount/m.pan.mag()),S.center=this._map.transform.center,Pf(S,j)}if(m.zoom){const j=If(m.zoom,b,ym);S.zoom=this._map.transform.zoom+j.amount,Pf(S,j)}if(m.bearing){const j=If(m.bearing,b,Kt);S.bearing=this._map.transform.bearing+a.clamp(j.amount,-179,179),Pf(S,j)}if(m.pitch){const j=If(m.pitch,b,po);S.pitch=this._map.transform.pitch+j.amount,Pf(S,j)}if(S.zoom||S.bearing){const j=m.pinchAround===void 0?m.around:m.pinchAround;S.around=j?this._map.unproject(j):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Pf(x,h){(!x.duration||x.duration<h.duration)&&(x.duration=h.duration,x.easing=h.easing)}function If(x,h,m){const{maxSpeed:b,linearity:S,deceleration:j}=m,R=a.clamp(x*S/(h/1e3),-b,b),z=Math.abs(R)/(j*S);return{easing:m.easing,duration:1e3*z,amount:R*(z/2)}}class Hi extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,b,S={}){const j=B(m.getCanvasContainer(),b),R=m.unproject(j);super(h,a.extend({point:j,lngLat:R,originalEvent:b},S)),this._defaultPrevented=!1,this.target=m}}class Mf extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,b){const S=h==="touchend"?b.changedTouches:b.touches,j=J(m.getCanvasContainer(),S),R=j.map(U=>m.unproject(U)),z=j.reduce((U,ee,Q,ue)=>U.add(ee.div(ue.length)),new a.Point(0,0));super(h,{points:j,point:z,lngLats:R,lngLat:m.unproject(z),originalEvent:b}),this._defaultPrevented=!1}}class xm extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,b){super(h,{originalEvent:b}),this._defaultPrevented=!1}}class _y{constructor(h,m){this._map=h,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(h){return this._firePreventable(new xm(h.type,this._map,h))}mousedown(h,m){return this._mousedownPos=m,this._firePreventable(new Hi(h.type,this._map,h))}mouseup(h){this._map.fire(new Hi(h.type,this._map,h))}preclick(h){const m=a.extend({},h);m.type="preclick",this._map.fire(new Hi(m.type,this._map,m))}click(h,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(h),this._map.fire(new Hi(h.type,this._map,h)))}dblclick(h){return this._firePreventable(new Hi(h.type,this._map,h))}mouseover(h){this._map.fire(new Hi(h.type,this._map,h))}mouseout(h){this._map.fire(new Hi(h.type,this._map,h))}touchstart(h){return this._firePreventable(new Mf(h.type,this._map,h))}touchmove(h){this._map.fire(new Mf(h.type,this._map,h))}touchend(h){this._map.fire(new Mf(h.type,this._map,h))}touchcancel(h){this._map.fire(new Mf(h.type,this._map,h))}_firePreventable(h){if(this._map.fire(h),h.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vm{constructor(h){this._map=h}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(h){this._map.fire(new Hi(h.type,this._map,h))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Hi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new Hi(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qb{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(h,m){this.isEnabled()&&h.shiftKey&&h.button===0&&(L(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(h,m){if(!this._active)return;const b=m,S=this._startPos,j=this._lastPos;if(!S||!j||j.equals(b)||!this._box&&b.dist(S)<this._clickTolerance)return;this._lastPos=b,this._box||(this._box=T("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));const R=Math.min(S.x,b.x),z=Math.max(S.x,b.x),U=Math.min(S.y,b.y),ee=Math.max(S.y,b.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${R}px,${U}px)`,this._box.style.width=z-R+"px",this._box.style.height=ee-U+"px")})}mouseupWindow(h,m){if(!this._active)return;const b=this._startPos,S=m;if(b&&h.button===0){if(this.reset(),G(),b.x!==S.x||b.y!==S.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:h})),{cameraAnimation:j=>j.fitScreenCoordinates(b,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",h)}}keydown(h){this._active&&h.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",h))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),O(),delete this._startPos,delete this._lastPos}_fireEvent(h,m){return this._map.fire(new a.Event(h,{originalEvent:m}))}}function _m(x,h){const m={};for(let b=0;b<x.length;b++)m[x[b].identifier]=h[b];return m}class Ud{constructor(h){this.reset(),this.numTouches=h.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(h,m,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=h.timeStamp),b.length===this.numTouches&&(this.centroid=function(S){const j=new a.Point(0,0);for(const R of S)j._add(R);return j.div(S.length)}(m),this.touches=_m(b,m)))}touchmove(h,m,b){if(this.aborted||!this.centroid)return;const S=_m(b,m);for(const j in this.touches){const R=S[j];(!R||R.dist(this.touches[j])>30)&&(this.aborted=!0)}}touchend(h,m,b){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class by{constructor(h){this.singleTap=new Ud(h),this.numTaps=h.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(h,m,b){this.singleTap.touchstart(h,m,b)}touchmove(h,m,b){this.singleTap.touchmove(h,m,b)}touchend(h,m,b){const S=this.singleTap.touchend(h,m,b);if(S){const j=h.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(S)<30;if(j&&R||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class _E{constructor(){this._zoomIn=new by({numTouches:1,numTaps:2}),this._zoomOut=new by({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(h,m,b){this._zoomIn.touchstart(h,m,b),this._zoomOut.touchstart(h,m,b)}touchmove(h,m,b){this._zoomIn.touchmove(h,m,b),this._zoomOut.touchmove(h,m,b)}touchend(h,m,b){const S=this._zoomIn.touchend(h,m,b),j=this._zoomOut.touchend(h,m,b);return S?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()+1,around:R.unproject(S)},{originalEvent:h})}):j?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()-1,around:R.unproject(j)},{originalEvent:h})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Gb={0:1,2:2};class qd{constructor(h){this.reset(),this._clickTolerance=h.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(h,m){return!1}_move(h,m){return{}}mousedown(h,m){if(this._lastPoint)return;const b=W(h);this._correctButton(h,b)&&(this._lastPoint=m,this._eventButton=b)}mousemoveWindow(h,m){const b=this._lastPoint;if(b){if(h.preventDefault(),this._eventButton!=null&&function(S,j){const R=Gb[j];return S.buttons===void 0||(S.buttons&R)!==R}(h,this._eventButton))this.reset();else if(this._moved||!(m.dist(b)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(b,m)}}mouseupWindow(h){this._lastPoint&&W(h)===this._eventButton&&(this._moved&&G(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wy extends qd{mousedown(h,m){super.mousedown(h,m),this._lastPoint&&(this._active=!0)}_correctButton(h,m){return m===0&&!h.ctrlKey}_move(h,m){return{around:m,panDelta:m.sub(h)}}}class ky extends qd{_correctButton(h,m){return m===0&&h.ctrlKey||m===2}_move(h,m){const b=.8*(m.x-h.x);if(b)return this._active=!0,{bearingDelta:b}}contextmenu(h){h.preventDefault()}}class Ty extends qd{_correctButton(h,m){return m===0&&h.ctrlKey||m===2}_move(h,m){const b=-.5*(m.y-h.y);if(b)return this._active=!0,{pitchDelta:b}}contextmenu(h){h.preventDefault()}}class bm{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)}touchstart(h,m,b){return this._calculateTransform(h,m,b)}touchmove(h,m,b){if(this._active&&!(b.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(b.length===1&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return h.cancelable&&h.preventDefault(),this._calculateTransform(h,m,b)}}touchend(h,m,b){this._calculateTransform(h,m,b),this._active&&b.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(h,m,b){b.length>0&&(this._active=!0);const S=_m(b,m),j=new a.Point(0,0),R=new a.Point(0,0);let z=0;for(const ee in S){const Q=S[ee],ue=this._touches[ee];ue&&(j._add(Q),R._add(Q.sub(ue)),z++,S[ee]=Q)}if(this._touches=S,z<this._minTouches||!R.mag())return;const U=R.div(z);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:j.div(z),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=T("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Df{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(h){}_move(h,m,b){return{}}touchstart(h,m,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([m[0],m[1]]))}touchmove(h,m,b){const S=this._firstTwoTouches;if(!S)return;h.preventDefault();const[j,R]=S,z=Of(b,m,j),U=Of(b,m,R);if(!z||!U)return;const ee=this._aroundCenter?null:z.add(U).div(2);return this._move([z,U],ee,h)}touchend(h,m,b){if(!this._firstTwoTouches)return;const[S,j]=this._firstTwoTouches,R=Of(b,m,S),z=Of(b,m,j);R&&z||(this._active&&G(),this.reset())}touchcancel(){this.reset()}enable(h){this._enabled=!0,this._aroundCenter=!!h&&h.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Of(x,h,m){for(let b=0;b<x.length;b++)if(x[b].identifier===m)return h[b]}function Sy(x,h){return Math.log(x/h)/Math.LN2}class Wb extends Df{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(h){this._startDistance=this._distance=h[0].dist(h[1])}_move(h,m){const b=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(Sy(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sy(this._distance,b),pinchAround:m}}}function Ey(x,h){return 180*x.angleWith(h)/Math.PI}class Hb extends Df{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])}_move(h,m){const b=this._vector;if(this._vector=h[0].sub(h[1]),b&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ey(this._vector,b),pinchAround:m}}_isBelowThreshold(h){this._minDiameter=Math.min(this._minDiameter,h.mag());const m=25/(Math.PI*this._minDiameter)*360,b=this._startVector;if(!b)return!1;const S=Ey(h,b);return Math.abs(S)<m}}function Sc(x){return Math.abs(x.y)>Math.abs(x.x)}class Kb extends Df{constructor(h){super(),this._map=h}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(h){this._lastPoints=h,Sc(h[0].sub(h[1]))&&(this._valid=!1)}_move(h,m,b){const S=this._lastPoints;if(!S)return;const j=h[0].sub(S[0]),R=h[1].sub(S[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&b.touches.length<3||(this._valid=this.gestureBeginsVertically(j,R,b.timeStamp),!this._valid)?void 0:(this._lastPoints=h,this._active=!0,{pitchDelta:(j.y+R.y)/2*-.5})}gestureBeginsVertically(h,m,b){if(this._valid!==void 0)return this._valid;const S=h.mag()>=2,j=m.mag()>=2;if(!S&&!j)return;if(!S||!j)return this._firstMove==null&&(this._firstMove=b),b-this._firstMove<100&&void 0;const R=h.y>0==m.y>0;return Sc(h)&&Sc(m)&&R}}const Zb={panStep:100,bearingStep:15,pitchStep:10};class bE{constructor(){const h=Zb;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(h){if(h.altKey||h.ctrlKey||h.metaKey)return;let m=0,b=0,S=0,j=0,R=0;switch(h.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:h.shiftKey?b=-1:(h.preventDefault(),j=-1);break;case 39:h.shiftKey?b=1:(h.preventDefault(),j=1);break;case 38:h.shiftKey?S=1:(h.preventDefault(),R=-1);break;case 40:h.shiftKey?S=-1:(h.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(b=0,S=0),{cameraAnimation:z=>{const U=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:Xb,zoom:m?Math.round(U)+m*(h.shiftKey?2:1):U,bearing:z.getBearing()+b*this._bearingStep,pitch:z.getPitch()+S*this._pitchStep,offset:[-j*this._panStep,-R*this._panStep],center:z.getCenter()},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Xb(x){return x*(2-x)}const jy=4.000244140625;class Yb{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(h){this._defaultZoomRate=h}setWheelZoomRate(h){this._wheelZoomRate=h}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!h&&h.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(h){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(h.ctrlKey||h.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=h.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY;const b=a.exported.now(),S=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,m!==0&&m%jy==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(S*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),h.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=h,this._delta-=m,this._active||this._start(h)),h.preventDefault()}_onTimeout(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)}_start(h){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=B(this._el,h);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const h=this._map.transform;this._type==="wheel"&&h.projection.wrap&&(h._center.lng>=180||h._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>h._terrainEnabled()&&this._aroundCoord?h.computeZoomRelativeTo(this._aroundCoord):h.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>jy?this._wheelZoomRate:this._defaultZoomRate;let ee=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&ee!==0&&(ee=1/ee);const Q=m(),ue=Math.pow(2,Q),me=typeof this._targetZoom=="number"?h.zoomScale(this._targetZoom):ue;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(me*ee))),this._type==="wheel"&&(this._startZoom=Q,this._easing=this._smoothOutEasing(200)),this._delta=0}const b=typeof this._targetZoom=="number"?this._targetZoom:m(),S=this._startZoom,j=this._easing;let R,z=!1;if(this._type==="wheel"&&S&&j){const U=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),ee=j(U);R=a.number(S,b,ee),U<1?this._frameId||(this._frameId=!0):z=!0}else R=b,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:R-m(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(h){let m=a.ease;if(this._prevEase){const b=this._prevEase,S=(a.exported.now()-b.start)/b.duration,j=b.easing(S+.01)-b.easing(S),R=.27/Math.sqrt(j*j+1e-4)*.01,z=Math.sqrt(.0729-R*R);m=a.bezier(R,z,.25,1)}return this._prevEase={start:a.exported.now(),duration:h,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=T("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Jb{constructor(h,m){this._clickZoom=h,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ba{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(h,m){return h.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:b.getZoom()+(h.shiftKey?-1:1),around:b.unproject(m)},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wE{constructor(){this._tap=new by({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(h,m,b){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?b.length>0&&(this._swipePoint=m[0],this._swipeTouch=b[0].identifier):this._tap.touchstart(h,m,b))}touchmove(h,m,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const S=m[0],j=S.y-this._swipePoint.y;return this._swipePoint=S,h.preventDefault(),this._active=!0,{zoomDelta:j/128}}}else this._tap.touchmove(h,m,b)}touchend(h,m,b){this._tapTime?this._swipePoint&&b.length===0&&this.reset():this._tap.touchend(h,m,b)&&(this._tapTime=h.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qb{constructor(h,m,b){this._el=h,this._mousePan=m,this._touchPan=b}enable(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class kE{constructor(h,m,b){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=m,this._mousePitch=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class TE{constructor(h,m,b,S){this._el=h,this._touchZoom=m,this._touchRotate=b,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Fs=x=>x.zoom||x.drag||x.pitch||x.rotate;class e1 extends a.Event{}class SE{constructor(){this.constants=[1,1,.01],this.radius=0}setup(h,m){const b=a.sub([],m,h);this.radius=a.length(b[2]<0?a.div([],b,this.constants):[b[0],b[1],0])}projectRay(h){a.div(h,h,this.constants),a.normalize(h,h),a.mul$1(h,h,this.constants);const m=a.scale$2([],h,this.radius);if(m[2]>0){const b=a.scale$2([],[0,0,1],a.dot(m,[0,0,1])),S=a.scale$2([],a.normalize([],[m[0],m[1],0]),this.radius),j=a.add([],m,a.scale$2([],a.sub([],a.add([],S,b),m),2));m[0]=j[0],m[1]=j[1]}return m}}function mo(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}class qo{constructor(h,m){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ub(h),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new SE,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),a.bindAll(["handleEvent","handleWindowEvent"],this);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[S,j,R]of this._listeners)S.addEventListener(j,S===a.window.document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(const[h,m,b]of this._listeners)h.removeEventListener(m,h===a.window.document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(h){const m=this._map,b=m.getCanvasContainer();this._add("mapEvent",new _y(m,h));const S=m.boxZoom=new qb(m,h);this._add("boxZoom",S);const j=new _E,R=new ba;m.doubleClickZoom=new Jb(R,j),this._add("tapZoom",j),this._add("clickZoom",R);const z=new wE;this._add("tapDragZoom",z);const U=m.touchPitch=new Kb(m);this._add("touchPitch",U);const ee=new ky(h),Q=new Ty(h);m.dragRotate=new kE(h,ee,Q),this._add("mouseRotate",ee,["mousePitch"]),this._add("mousePitch",Q,["mouseRotate"]);const ue=new wy(h),me=new bm(m,h);m.dragPan=new Qb(b,ue,me),this._add("mousePan",ue),this._add("touchPan",me,["touchZoom","touchRotate"]);const _e=new Hb,Te=new Wb;m.touchZoomRotate=new TE(b,Te,_e,z),this._add("touchRotate",_e,["touchPan","touchZoom"]),this._add("touchZoom",Te,["touchPan","touchRotate"]),this._add("blockableMapEvent",new vm(m));const we=m.scrollZoom=new Yb(m,this);this._add("scrollZoom",we,["mousePan"]);const Ee=m.keyboard=new bE;this._add("keyboard",Ee);for(const he of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])h.interactive&&h[he]&&m[he].enable(h[he])}_add(h,m,b){this._handlers.push({handlerName:h,handler:m,allowed:b}),this._handlersById[h]=m}stop(h){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[]}}isActive(){for(const{handler:h}of this._handlers)if(h.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Fs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(h,m,b){for(const S in h)if(S!==b&&(!m||m.indexOf(S)<0))return!0;return!1}handleWindowEvent(h){this.handleEvent(h,`${h.type}Window`)}_getMapTouches(h){const m=[];for(const b of h)this._el.contains(b.target)&&m.push(b);return m}handleEvent(h,m){this._updatingCamera=!0;const b=h.type==="renderFrame",S=b?void 0:h,j={needsRenderFrame:!1},R={},z={},U=h.touches?this._getMapTouches(h.touches):void 0,ee=U?J(this._el,U):b?void 0:B(this._el,h);for(const{handlerName:me,handler:_e,allowed:Te}of this._handlers){if(!_e.isEnabled())continue;let we;this._blockedByActive(z,Te,me)?_e.reset():_e[m||h.type]&&(we=_e[m||h.type](h,ee,U),this.mergeHandlerResult(j,R,we,me,S),we&&we.needsRenderFrame&&this._triggerRenderFrame()),(we||_e.isActive())&&(z[me]=_e)}const Q={};for(const me in this._previousActiveHandlers)z[me]||(Q[me]=S);this._previousActiveHandlers=z,(Object.keys(Q).length||mo(j))&&(this._changes.push([j,R,Q]),this._triggerRenderFrame()),(Object.keys(z).length||mo(j))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ue}=j;ue&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ue(this._map))}mergeHandlerResult(h,m,b,S,j){if(!b)return;a.extend(h,b);const R={handlerName:S,originalEvent:b.originalEvent||j};b.zoomDelta!==void 0&&(m.zoom=R),b.panDelta!==void 0&&(m.drag=R),b.pitchDelta!==void 0&&(m.pitch=R),b.bearingDelta!==void 0&&(m.rotate=R)}_applyChanges(){const h={},m={},b={};for(const[S,j,R]of this._changes)S.panDelta&&(h.panDelta=(h.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(h.around=S.around),S.aroundCoord!==void 0&&(h.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(h.pinchAround=S.pinchAround),S.noInertia&&(h.noInertia=S.noInertia),a.extend(m,j),a.extend(b,R);this._updateMapTransform(h,m,b),this._changes=[]}_updateMapTransform(h,m,b){const S=this._map,j=S.transform,R=ve=>[ve.x,ve.y,ve.z];if((ve=>{const Pe=this._eventsInProgress.drag;return Pe&&!this._handlersById[Pe.handlerName].isActive()})()&&!mo(h)){const ve=j.zoom;j.cameraElevationReference="sea",j.recenterOnTerrain(),j.cameraElevationReference="ground",ve!==j.zoom&&this._map._update(!0)}if(j._isCameraConstrained&&S._stop(!0),!mo(h))return void this._fireEvents(m,b,!0);let{panDelta:z,zoomDelta:U,bearingDelta:ee,pitchDelta:Q,around:ue,aroundCoord:me,pinchAround:_e}=h;j._isCameraConstrained&&(U>0&&(U=0),j._isCameraConstrained=!1),_e!==void 0&&(ue=_e),(U||(ve=>m[ve]&&!this._eventsInProgress[ve])("drag"))&&ue&&(this._dragOrigin=R(j.pointCoordinate3D(ue)),this._trackingEllipsoid.setup(j._camera.position,this._dragOrigin)),j.cameraElevationReference="sea",S._stop(!0),ue=ue||S.transform.centerPoint,ee&&(j.bearing+=ee),Q&&(j.pitch+=Q),j._updateCameraState();const Te=[0,0,0];if(z)if(j.projection.name==="mercator"){const ve=this._trackingEllipsoid.projectRay(j.screenPointToMercatorRay(ue).dir),Pe=this._trackingEllipsoid.projectRay(j.screenPointToMercatorRay(ue.sub(z)).dir);Te[0]=Pe[0]-ve[0],Te[1]=Pe[1]-ve[1]}else{const ve=j.pointCoordinate(ue);if(j.projection.name==="globe"){z=z.rotate(-j.angle);const Pe=j._pixelsPerMercatorPixel/j.worldSize;Te[0]=-z.x*a.mercatorScale(a.latFromMercatorY(ve.y))*Pe,Te[1]=-z.y*a.mercatorScale(j.center.lat)*Pe}else{const Pe=j.pointCoordinate(ue.sub(z));ve&&Pe&&(Te[0]=Pe.x-ve.x,Te[1]=Pe.y-ve.y)}}const we=j.zoom,Ee=[0,0,0];if(U){const ve=R(me||j.pointCoordinate3D(ue)),Pe={dir:a.normalize([],a.sub([],ve,j._camera.position))};if(Pe.dir[2]<0){const Ie=j.zoomDeltaToMovement(ve,U);a.scale$2(Ee,Pe.dir,Ie)}}const he=a.add(Te,Te,Ee);j._translateCameraConstrained(he),U&&Math.abs(j.zoom-we)>1e-4&&j.recenterOnTerrain(),j.cameraElevationReference="ground",this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(m,b,!0)}_fireEvents(h,m,b){const S=Fs(this._eventsInProgress),j=Fs(h),R={};for(const Q in h){const{originalEvent:ue}=h[Q];this._eventsInProgress[Q]||(R[`${Q}start`]=ue),this._eventsInProgress[Q]=h[Q]}!S&&j&&this._fireEvent("movestart",j.originalEvent);for(const Q in R)this._fireEvent(Q,R[Q]);j&&this._fireEvent("move",j.originalEvent);for(const Q in h){const{originalEvent:ue}=h[Q];this._fireEvent(Q,ue)}const z={};let U;for(const Q in this._eventsInProgress){const{handlerName:ue,originalEvent:me}=this._eventsInProgress[Q];this._handlersById[ue].isActive()||(delete this._eventsInProgress[Q],U=m[ue]||me,z[`${Q}end`]=U)}for(const Q in z)this._fireEvent(Q,z[Q]);const ee=Fs(this._eventsInProgress);if(b&&(S||j)&&!ee){this._updatingCamera=!0;const Q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ue=me=>me!==0&&-this._bearingSnap<me&&me<this._bearingSnap;Q?(ue(Q.bearing||this._map.getBearing())&&(Q.bearing=0),this._map.easeTo(Q,{originalEvent:U})):(this._map.fire(new a.Event("moveend",{originalEvent:U})),ue(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(h,m){this._map.fire(new a.Event(h,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(h=>{this._frameId=void 0,this.handleEvent(new e1("renderFrame",{timeStamp:h})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Au="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class wm extends a.Evented{constructor(h,m){super(),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=m.bearingSnap,this._respectPrefersReducedMotion=m.respectPrefersReducedMotion!==!1,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(h,m){return this.jumpTo({center:h},m)}panBy(h,m,b){return h=a.Point.convert(h).mult(-1),this.panTo(this.transform.center,a.extend({offset:h},m),b)}panTo(h,m,b){return this.easeTo(a.extend({center:h},m),b)}getZoom(){return this.transform.zoom}setZoom(h,m){return this.jumpTo({zoom:h},m),this}zoomTo(h,m,b){return this.easeTo(a.extend({zoom:h},m),b)}zoomIn(h,m){return this.zoomTo(this.getZoom()+1,h,m),this}zoomOut(h,m){return this.zoomTo(this.getZoom()-1,h,m),this}getBearing(){return this.transform.bearing}setBearing(h,m){return this.jumpTo({bearing:h},m),this}getPadding(){return this.transform.padding}setPadding(h,m){return this.jumpTo({padding:h},m),this}rotateTo(h,m,b){return this.easeTo(a.extend({bearing:h},m),b)}resetNorth(h,m){return this.rotateTo(0,a.extend({duration:1e3},h),m),this}resetNorthPitch(h,m){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},h),m),this}snapToNorth(h,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,m):this}getPitch(){return this.transform.pitch}setPitch(h,m){return this.jumpTo({pitch:h},m),this}cameraForBounds(h,m){h=a.LngLatBounds.convert(h);const b=m&&m.bearing||0,S=m&&m.pitch||0,j=h.getNorthWest(),R=h.getSouthEast();return this._cameraForBounds(this.transform,j,R,b,S,m)}_extendCameraOptions(h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=a.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const b=h.padding;h.padding={top:b,bottom:b,right:b,left:b}}return h.padding=a.extend(m,h.padding),h}_minimumAABBFrustumDistance(h,m){const b=m.max[0]-m.min[0],S=m.max[1]-m.min[1];return b/S>h.aspect?b/(2*Math.tan(.5*h.fovX)*h.aspect):S/(2*Math.tan(.5*h.fovY)*h.aspect)}_cameraForBoundsOnGlobe(h,m,b,S,j,R){const z=h.clone(),U=this._extendCameraOptions(R);z.bearing=S,z.pitch=j;const ee=a.LngLat.convert(m),Q=a.LngLat.convert(b),ue=.5*(ee.lat+Q.lat),me=.5*(ee.lng+Q.lng),_e=a.latLngToECEF(ue,me),Te=a.normalize([],_e),we=a.normalize([],a.cross([],Te,[0,1,0])),Ee=a.cross([],we,Te),he=[we[0],we[1],we[2],0,Ee[0],Ee[1],Ee[2],0,Te[0],Te[1],Te[2],0,0,0,0,1],ve=[_e,a.latLngToECEF(ee.lat,ee.lng),a.latLngToECEF(Q.lat,ee.lng),a.latLngToECEF(Q.lat,Q.lng),a.latLngToECEF(ee.lat,Q.lng),a.latLngToECEF(ue,ee.lng),a.latLngToECEF(ue,Q.lng),a.latLngToECEF(ee.lat,me),a.latLngToECEF(Q.lat,me)];let Pe=a.Aabb.fromPoints(ve.map(_t=>[a.dot(we,_t),a.dot(Ee,_t),a.dot(Te,_t)]));const Ie=a.transformMat4([],Pe.center,he);a.squaredLength(Ie)===0&&a.set(Ie,0,0,1),a.normalize(Ie,Ie),a.scale$2(Ie,Ie,a.GLOBE_RADIUS),z.center=a.ecefToLatLng(Ie);const Ve=z.getWorldToCameraMatrix(),qe=a.invert(new Float64Array(16),Ve);Pe=a.Aabb.applyTransform(Pe,a.multiply([],Ve,he)),a.transformMat4(Ie,Ie,Ve);const Ue=.5*(Pe.max[2]-Pe.min[2]),Ke=this._minimumAABBFrustumDistance(z,Pe),He=a.scale$2([],[0,0,1],Ue),rt=a.add(He,Ie,He),At=Ke+(z.pitch===0?0:a.distance(Ie,rt)),Je=z.globeCenterInViewSpace,pt=a.sub([],Ie,[Je[0],Je[1],Je[2]]);a.normalize(pt,pt),a.scale$2(pt,pt,At);const at=a.add([],Ie,pt);a.transformMat4(at,at,qe);const Et=a.earthRadius/a.GLOBE_RADIUS,tt=a.length(at),ft=a.mercatorZfromAltitude(Math.max(tt*Et-a.earthRadius,Number.EPSILON),0),Pt=Math.min(z.zoomFromMercatorZAdjusted(ft),U.maxZoom);return Pt>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"mercator"}),z.zoom=Pt,this._cameraForBounds(z,m,b,S,j,R)):{center:z.center,zoom:Pt,bearing:S,pitch:j}}queryTerrainElevation(h,m){const b=this.transform.elevation;return b?(m=a.extend({},{exaggerated:!0},m),b.getAtPoint(a.MercatorCoordinate.fromLngLat(h),null,m.exaggerated)):null}_cameraForBounds(h,m,b,S,j,R){if(h.projection.name==="globe")return this._cameraForBoundsOnGlobe(h,m,b,S,j,R);const z=h.clone(),U=this._extendCameraOptions(R),ee=z.padding;z.bearing=S,z.pitch=j;const Q=a.LngLat.convert(m),ue=a.LngLat.convert(b),me=new a.LngLat(Q.lng,ue.lat),_e=new a.LngLat(ue.lng,Q.lat),Te=z.project(Q),we=z.project(ue),Ee=this.queryTerrainElevation(Q),he=this.queryTerrainElevation(ue),ve=this.queryTerrainElevation(me),Pe=this.queryTerrainElevation(_e),Ie=[[Te.x,Te.y,Math.min(Ee||0,he||0,ve||0,Pe||0)],[we.x,we.y,Math.max(Ee||0,he||0,ve||0,Pe||0)]];let Ve=a.Aabb.fromPoints(Ie);const qe=z.getWorldToCameraMatrix(),Ue=a.invert(new Float64Array(16),qe);Ve=a.Aabb.applyTransform(Ve,qe);const Ke=a.sub([],Ve.max,Ve.min),He=ee.left||0,rt=ee.right||0,At=ee.bottom||0,Je=ee.top||0,{left:pt,right:at,top:Et,bottom:tt}=U.padding,ft=.5*(He+rt),Pt=.5*(Je+At),_t=Math.min(z.scaleZoom(z.scale*Math.min((z.width-(He+rt+pt+at))/Ke[0],(z.height-(At+Je+tt+Et))/Ke[1])),U.maxZoom),Mt=z.scale/z.zoomScale(_t);Ve=new a.Aabb([Ve.min[0]-(pt+ft)*Mt,Ve.min[1]-(tt+Pt)*Mt,Ve.min[2]],[Ve.max[0]+(at+ft)*Mt,Ve.max[1]+(Et+Pt)*Mt,Ve.max[2]]);const ir=.5*Ke[2],gr=this._minimumAABBFrustumDistance(z,Ve),Qt=[0,0,1,0];a.transformMat4$1(Qt,Qt,qe),a.normalize$2(Qt,Qt);const ur=a.scale$2([],Qt,gr+ir),Rr=a.add([],Ve.center,ur),Or=(typeof U.offset.x=="number"&&typeof U.offset.y=="number"?new a.Point(U.offset.x,U.offset.y):a.Point.convert(U.offset)).rotate(-a.degToRad(S));Ve.center[0]-=Or.x*Mt,Ve.center[1]+=Or.y*Mt,a.transformMat4(Ve.center,Ve.center,Ue),a.transformMat4(Rr,Rr,Ue);const rr=[Ve.center[0],Ve.center[1],Rr[2]*z.pixelsPerMeter];a.scale$2(rr,rr,1/z.worldSize);const rn=a.lngFromMercatorX(rr[0]),fn=a.latFromMercatorY(rr[1]),pn=Math.min(z._zoomFromMercatorZ(rr[2]),U.maxZoom),mn=new a.LngLat(rn,fn);return z.mercatorFromTransition&&pn<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(z.setProjection({name:"globe"}),z.zoom=pn,this._cameraForBounds(z,m,b,S,j,R)):{center:mn,zoom:pn,bearing:S,pitch:j}}fitBounds(h,m,b){const S=this.cameraForBounds(h,m);return this._fitInternal(S,m,b)}fitScreenCoordinates(h,m,b,S,j){const R=a.Point.convert(h),z=a.Point.convert(m),U=new a.Point(Math.min(R.x,z.x),Math.min(R.y,z.y)),ee=new a.Point(Math.max(R.x,z.x),Math.max(R.y,z.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(R,z))return this;const Q=this.transform.pointLocation3D(U),ue=this.transform.pointLocation3D(ee),me=this.transform.pointLocation3D(new a.Point(U.x,ee.y)),_e=this.transform.pointLocation3D(new a.Point(ee.x,U.y)),Te=[Math.min(Q.lng,ue.lng,me.lng,_e.lng),Math.min(Q.lat,ue.lat,me.lat,_e.lat)],we=[Math.max(Q.lng,ue.lng,me.lng,_e.lng),Math.max(Q.lat,ue.lat,me.lat,_e.lat)],Ee=S&&S.pitch?S.pitch:this.getPitch(),he=this._cameraForBounds(this.transform,Te,we,b,Ee,S);return this._fitInternal(he,S,j)}_fitInternal(h,m,b){return h?(delete(m=a.extend(h,m)).padding,m.linear?this.easeTo(m,b):this.flyTo(m,b)):this}jumpTo(h,m){this.stop();const b=h.preloadOnly?this.transform.clone():this.transform;let S=!1,j=!1,R=!1;return"zoom"in h&&b.zoom!==+h.zoom&&(S=!0,b.zoom=+h.zoom),h.center!==void 0&&(b.center=a.LngLat.convert(h.center)),"bearing"in h&&b.bearing!==+h.bearing&&(j=!0,b.bearing=+h.bearing),"pitch"in h&&b.pitch!==+h.pitch&&(R=!0,b.pitch=+h.pitch),h.padding==null||b.isPaddingEqual(h.padding)||(b.padding=h.padding),h.preloadOnly?(this._preloadTiles(b),this):(this.fire(new a.Event("movestart",m)).fire(new a.Event("move",m)),S&&this.fire(new a.Event("zoomstart",m)).fire(new a.Event("zoom",m)).fire(new a.Event("zoomend",m)),j&&this.fire(new a.Event("rotatestart",m)).fire(new a.Event("rotate",m)).fire(new a.Event("rotateend",m)),R&&this.fire(new a.Event("pitchstart",m)).fire(new a.Event("pitch",m)).fire(new a.Event("pitchend",m)),this.fire(new a.Event("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Au),this.transform.getFreeCameraOptions()}setFreeCameraOptions(h,m){const b=this.transform;if(!b.projection.supportsFreeCamera)return a.warnOnce(Au),this;this.stop();const S=b.zoom,j=b.pitch,R=b.bearing;b.setFreeCameraOptions(h);const z=S!==b.zoom,U=j!==b.pitch,ee=R!==b.bearing;return this.fire(new a.Event("movestart",m)).fire(new a.Event("move",m)),z&&this.fire(new a.Event("zoomstart",m)).fire(new a.Event("zoom",m)).fire(new a.Event("zoomend",m)),ee&&this.fire(new a.Event("rotatestart",m)).fire(new a.Event("rotate",m)).fire(new a.Event("rotateend",m)),U&&this.fire(new a.Event("pitchstart",m)).fire(new a.Event("pitch",m)).fire(new a.Event("pitchend",m)),this.fire(new a.Event("moveend",m)),this}easeTo(h,m){this._stop(!1,h.easeId),((h=a.extend({offset:[0,0],duration:500,easing:a.ease},h)).animate===!1||this._prefersReducedMotion(h))&&(h.duration=0);const b=this.transform,S=this.getZoom(),j=this.getBearing(),R=this.getPitch(),z=this.getPadding(),U="zoom"in h?+h.zoom:S,ee="bearing"in h?this._normalizeBearing(h.bearing,j):j,Q="pitch"in h?+h.pitch:R,ue="padding"in h?h.padding:b.padding,me=a.Point.convert(h.offset);let _e,Te,we;if(b.projection.name==="globe"){const He=a.MercatorCoordinate.fromLngLat(b.center),rt=me.rotate(-b.angle);He.x+=rt.x/b.worldSize,He.y+=rt.y/b.worldSize;const At=He.toLngLat(),Je=a.LngLat.convert(h.center||At);this._normalizeCenter(Je),_e=b.centerPoint.add(rt),Te=new a.Point(He.x,He.y).mult(b.worldSize),we=new a.Point(a.mercatorXfromLng(Je.lng),a.mercatorYfromLat(Je.lat)).mult(b.worldSize).sub(Te)}else{_e=b.centerPoint.add(me);const He=b.pointLocation(_e),rt=a.LngLat.convert(h.center||He);this._normalizeCenter(rt),Te=b.project(He),we=b.project(rt).sub(Te)}const Ee=b.zoomScale(U-S);let he,ve;h.around&&(he=a.LngLat.convert(h.around),ve=b.locationPoint(he));const Pe=this._zooming||U!==S,Ie=this._rotating||j!==ee,Ve=this._pitching||Q!==R,qe=!b.isPaddingEqual(ue),Ue=He=>rt=>{if(Pe&&(He.zoom=a.number(S,U,rt)),Ie&&(He.bearing=a.number(j,ee,rt)),Ve&&(He.pitch=a.number(R,Q,rt)),qe&&(He.interpolatePadding(z,ue,rt),_e=He.centerPoint.add(me)),he)He.setLocationAtPoint(he,ve);else{const At=He.zoomScale(He.zoom-S),Je=U>S?Math.min(2,Ee):Math.max(.5,Ee),pt=Math.pow(Je,1-rt),at=He.unproject(Te.add(we.mult(rt*pt)).mult(At));He.setLocationAtPoint(He.renderWorldCopies?at.wrap():at,_e)}return h.preloadOnly||this._fireMoveEvents(m),He};if(h.preloadOnly){const He=this._emulate(Ue,h.duration,b);return this._preloadTiles(He),this}const Ke={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Pe,this._rotating=Ie,this._pitching=Ve,this._padding=qe,this._easeId=h.easeId,this._prepareEase(m,h.noMoveStart,Ke),this._ease(Ue(b),He=>{b.recenterOnTerrain(),this._afterEase(m,He)},h),this}_prepareEase(h,m,b={}){this._moving=!0,this.transform.cameraElevationReference="sea",m||b.moving||this.fire(new a.Event("movestart",h)),this._zooming&&!b.zooming&&this.fire(new a.Event("zoomstart",h)),this._rotating&&!b.rotating&&this.fire(new a.Event("rotatestart",h)),this._pitching&&!b.pitching&&this.fire(new a.Event("pitchstart",h))}_fireMoveEvents(h){this.fire(new a.Event("move",h)),this._zooming&&this.fire(new a.Event("zoom",h)),this._rotating&&this.fire(new a.Event("rotate",h)),this._pitching&&this.fire(new a.Event("pitch",h))}_afterEase(h,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const b=this._zooming,S=this._rotating,j=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new a.Event("zoomend",h)),S&&this.fire(new a.Event("rotateend",h)),j&&this.fire(new a.Event("pitchend",h)),this.fire(new a.Event("moveend",h))}flyTo(h,m){if(this._prefersReducedMotion(h)){const _t=a.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_t,m)}this.stop(),h=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},h);const b=this.transform,S=this.getZoom(),j=this.getBearing(),R=this.getPitch(),z=this.getPadding(),U="zoom"in h?a.clamp(+h.zoom,b.minZoom,b.maxZoom):S,ee="bearing"in h?this._normalizeBearing(h.bearing,j):j,Q="pitch"in h?+h.pitch:R,ue="padding"in h?h.padding:b.padding,me=b.zoomScale(U-S),_e=a.Point.convert(h.offset);let Te=b.centerPoint.add(_e);const we=b.pointLocation(Te),Ee=a.LngLat.convert(h.center||we);this._normalizeCenter(Ee);const he=b.project(we),ve=b.project(Ee).sub(he);let Pe=h.curve;const Ie=Math.max(b.width,b.height),Ve=Ie/me,qe=ve.mag();if("minZoom"in h){const _t=a.clamp(Math.min(h.minZoom,S,U),b.minZoom,b.maxZoom),Mt=Ie/b.zoomScale(_t-S);Pe=Math.sqrt(Mt/qe*2)}const Ue=Pe*Pe;function Ke(_t){const Mt=(Ve*Ve-Ie*Ie+(_t?-1:1)*Ue*Ue*qe*qe)/(2*(_t?Ve:Ie)*Ue*qe);return Math.log(Math.sqrt(Mt*Mt+1)-Mt)}function He(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function rt(_t){return(Math.exp(_t)+Math.exp(-_t))/2}const At=Ke(0);let Je=function(_t){return rt(At)/rt(At+Pe*_t)},pt=function(_t){return Ie*((rt(At)*(He(Mt=At+Pe*_t)/rt(Mt))-He(At))/Ue)/qe;var Mt},at=(Ke(1)-At)/Pe;if(Math.abs(qe)<1e-6||!isFinite(at)){if(Math.abs(Ie-Ve)<1e-6)return this.easeTo(h,m);const _t=Ve<Ie?-1:1;at=Math.abs(Math.log(Ve/Ie))/Pe,pt=function(){return 0},Je=function(Mt){return Math.exp(_t*Pe*Mt)}}h.duration="duration"in h?+h.duration:1e3*at/("screenSpeed"in h?+h.screenSpeed/Pe:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0);const Et=j!==ee,tt=Q!==R,ft=!b.isPaddingEqual(ue),Pt=_t=>Mt=>{const ir=Mt*at,gr=1/Je(ir);_t.zoom=Mt===1?U:S+_t.scaleZoom(gr),Et&&(_t.bearing=a.number(j,ee,Mt)),tt&&(_t.pitch=a.number(R,Q,Mt)),ft&&(_t.interpolatePadding(z,ue,Mt),Te=_t.centerPoint.add(_e));const Qt=Mt===1?Ee:_t.unproject(he.add(ve.mult(pt(ir))).mult(gr));return _t.setLocationAtPoint(_t.renderWorldCopies?Qt.wrap():Qt,Te),_t._updateCameraOnTerrain(),h.preloadOnly||this._fireMoveEvents(m),_t};if(h.preloadOnly){const _t=this._emulate(Pt,h.duration,b);return this._preloadTiles(_t),this}return this._zooming=!0,this._rotating=Et,this._pitching=tt,this._padding=ft,this._prepareEase(m,!1),this._ease(Pt(b),()=>this._afterEase(m),h),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(h,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const b=this._onEaseEnd;this._onEaseEnd=void 0,b.call(this,m)}if(!h){const b=this.handlers;b&&b.stop(!1)}return this}_ease(h,m,b){b.animate===!1||b.duration===0?(h(1),m()):(this._easeStart=a.exported.now(),this._easeOptions=b,this._onEaseFrame=h,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const h=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(h,m){h=a.wrap(h,-180,180);const b=Math.abs(h-m);return Math.abs(h-360-m)<b&&(h-=360),Math.abs(h+360-m)<b&&(h+=360),h}_normalizeCenter(h){const m=this.transform;if(!m.renderWorldCopies||m.maxBounds)return;const b=h.lng-m.center.lng;h.lng+=b>180?-360:b<-180?360:0}_prefersReducedMotion(h){return this._respectPrefersReducedMotion&&a.exported.prefersReducedMotion&&!(h&&h.essential)}_emulate(h,m,b){const S=Math.ceil(15*m/1e3),j=[],R=h(b.clone());for(let z=0;z<=S;z++){const U=R(z/S);j.push(U.clone())}return j}}class Xt{constructor(h={}){this.options=h,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(h){const m=this.options&&this.options.compact;return this._map=h,this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=T("button","mapboxgl-ctrl-attrib-button",this._container),T("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(h,m){const b=this._map._getUIString(`AttributionControl.${m}`);h.setAttribute("aria-label",b),h.removeAttribute("title"),h.firstElementChild&&h.firstElementChild.setAttribute("title",b)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(h){const b=m.reduce((S,j,R)=>(j.value&&(S+=`${j.key}=${j.value}${R<m.length-1?"&":""}`),S),"?");h.href=`${a.config.FEEDBACK_URL}/${b}#${Nf(this._map,!0)}`,h.rel="noopener nofollow",this._setElementTitle(h,"MapFeedback")}}_updateData(h){!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let h=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const m=this._map.style._sourceCaches;for(const S in m){const j=m[S];if(j.used){const R=j.getSource();R.attribution&&h.indexOf(R.attribution)<0&&h.push(R.attribution)}}h.sort((S,j)=>S.length-j.length),h=h.filter((S,j)=>{for(let R=j+1;R<h.length;R++)if(h[R].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=[...this.options.customAttribution,...h]:h.unshift(this.options.customAttribution));const b=h.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,h.length?(this._innerContainer.innerHTML=b,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ay{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(h){this._map=h,this._container=T("div","mapboxgl-ctrl");const m=T("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(h){h&&h.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const h=this._map.style._sourceCaches;if(Object.entries(h).length===0)return!0;for(const m in h){const b=h[m].getSource();if(b.hasOwnProperty("mapbox_logo")&&!b.mapbox_logo)return!1}return!0}_updateCompact(){const h=this._container.children;if(h.length){const m=h[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class Ny{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(h){const m=++this._id;return this._queue.push({callback:h,id:m,cancelled:!1}),m}remove(h){const m=this._currentlyRunning,b=m?this._queue.concat(m):this._queue;for(const S of b)if(S.id===h)return void(S.cancelled=!0)}run(h=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const b of m)if(!b.cancelled&&(b.callback(h),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Gd(x,h,m){if(x=new a.LngLat(x.lng,x.lat),h){const b=new a.LngLat(x.lng-360,x.lat),S=new a.LngLat(x.lng+360,x.lat),j=360*Math.ceil(Math.abs(x.lng-m.center.lng)/360),R=m.locationPoint(x).distSqr(h),z=h.x<0||h.y<0||h.x>m.width||h.y>m.height;m.locationPoint(b).distSqr(h)<R&&(z||Math.abs(b.lng-m.center.lng)<j)?x=b:m.locationPoint(S).distSqr(h)<R&&(z||Math.abs(S.lng-m.center.lng)<j)&&(x=S)}for(;Math.abs(x.lng-m.center.lng)>180;){const b=m.locationPoint(x);if(b.x>=0&&b.y>=0&&b.x<=m.width&&b.y<=m.height)break;x.lng>m.center.lng?x.lng-=360:x.lng+=360}return x}const Nu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ht extends a.Evented{constructor(h,m){if(super(),(h instanceof a.window.HTMLElement||m)&&(h=a.extend({element:h},m)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=h&&h.occludedOpacity||.2,h&&h.element)this._element=h.element,this._offset=a.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=T("div");const S=41,j=27,R=A("svg",{display:"block",height:S*this._scale+"px",width:j*this._scale+"px",viewBox:`0 0 ${j} ${S}`},this._element),z=A("radialGradient",{id:"shadowGradient"},A("defs",{},R));A("stop",{offset:"10%","stop-opacity":.4},z),A("stop",{offset:"100%","stop-opacity":.05},z),A("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},R),A("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},R),A("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},R),A("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},R),this._offset=a.Point.convert(h&&h.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const b=this._element.classList;for(const S in Nu)b.remove(`mapboxgl-marker-anchor-${S}`);b.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(h){return h===this._map||(this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._updateMoving),h.on("moveend",this._update),h.on("remove",this._clearFadeTimer),h._addMarker(this),this.setDraggable(this._draggable),this._update(),h.on("click",this._onMapClick)),this}remove(){const h=this._map;return h&&(h.off("click",this._onMapClick),h.off("move",this._updateMoving),h.off("moveend",this._update),h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler),h.off("mouseup",this._onUp),h.off("touchend",this._onUp),h.off("mousemove",this._onMove),h.off("touchmove",this._onMove),h.off("remove",this._clearFadeTimer),h._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=a.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=h,h._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(h){const m=h.code,b=h.charCode||h.keyCode;m!=="Space"&&m!=="Enter"&&b!==32&&b!==13||this.togglePopup()}_onMapClick(h){const m=h.originalEvent.target,b=this._element;this._popup&&(m===b||b.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const h=this._popup;return h?(h.isOpen()?(h.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(h.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const h=this._map,m=this._pos;if(!h||!m)return!1;const b=h.unproject(m),S=h.getFreeCameraOptions();if(!S.position)return!1;const j=S.position.toLngLat();return j.distanceTo(b)<.9*j.distanceTo(this._lngLat)}_evaluateOpacity(){const h=this._map;if(!h)return;const m=this._pos;if(!m||m.x<0||m.x>h.transform.width||m.y<0||m.y>h.transform.height)return void this._clearFadeTimer();const b=h.unproject(m);let S;h._showingGlobe()&&a.isLngLatBehindGlobe(h.transform,this._lngLat)?S=0:(S=1-h._queryFogOpacity(b),h.transform._terrainEnabled()&&h.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const h=this._pos;if(!h||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${h.x}px,${h.y}px)
            ${Nu[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${m.x}px,${m.y}px)
        `}_calculateXYTransform(){const h=this._pos,m=this._map,b=this.getPitchAlignment();if(!m||!h||b!=="map")return"";if(!m._showingGlobe()){const U=m.getPitch();return U?`rotateX(${U}deg)`:""}const S=a.radToDeg(a.globeTiltAtLngLat(m.transform,this._lngLat)),j=h.sub(a.globeCenterToScreenPoint(m.transform)),R=Math.abs(j.x)+Math.abs(j.y);if(R===0)return"";const z=S/R;return`rotateX(${-j.y*z}deg) rotateY(${j.x*z}deg)`}_calculateZTransform(){const h=this._pos,m=this._map;if(!m||!h)return"";let b=0;const S=this.getRotationAlignment();if(S==="map")if(m._showingGlobe()){const j=m.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),R=m.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(j);b=a.radToDeg(Math.atan2(R.y,R.x))-90}else b=-m.getBearing();else if(S==="horizon"){const j=a.smoothstep(4,6,m.getZoom()),R=a.globeCenterToScreenPoint(m.transform);R.y+=j*m.transform.height;const z=h.sub(R),U=a.radToDeg(Math.atan2(z.y,z.x));b=(U>90?U-270:U+90)*(1-j)}return b+=this._rotation,b?`rotateZ(${b}deg)`:""}_update(h){a.window.cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=Gd(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),h===!0?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(h){return this._offset=a.Point.convert(h),this._update(),this}_onMove(h){const m=this._map;if(!m)return;const b=this._pointerdownPos,S=this._positionDelta;if(b&&S){if(!this._isDragging){const j=this._clickTolerance||m._clickTolerance;if(h.point.dist(b)<j)return;this._isDragging=!0}this._pos=h.point.sub(S),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const h=this._map;h&&(h.off("mousemove",this._onMove),h.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(h){const m=this._map,b=this._pos;m&&b&&this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(b),this._pointerdownPos=h.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(h){this._draggable=!!h;const m=this._map;return m&&(h?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(h){return this._rotation=h||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(h){return this._rotationAlignment=h||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(h){return this._pitchAlignment=h||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(h){return this._occludedOpacity=h||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Cy={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},EE=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function t1(x=new a.Point(0,0),h="bottom"){if(typeof x=="number"){const m=Math.round(Math.sqrt(.5*Math.pow(x,2)));switch(h){case"top":return new a.Point(0,x);case"top-left":return new a.Point(m,m);case"top-right":return new a.Point(-m,m);case"bottom":return new a.Point(0,-x);case"bottom-left":return new a.Point(m,-m);case"bottom-right":return new a.Point(-m,-m);case"left":return new a.Point(x,0);case"right":return new a.Point(-x,0)}return new a.Point(0,0)}return x instanceof a.Point||Array.isArray(x)?a.Point.convert(x):a.Point.convert(x[h]||[0,0])}class Py{constructor(h){this.jumpTo(h)}getValue(h){if(h<=this._startTime)return this._start;if(h>=this._endTime)return this._end;const m=a.easeCubicInOut((h-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(h){return h>=this._startTime&&h<=this._endTime}jumpTo(h){this._startTime=-1/0,this._endTime=-1/0,this._start=h,this._end=h}easeTo(h,m,b){this._start=this.getValue(m),this._end=h,this._startTime=m,this._endTime=m+b}}const r1={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},n1={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},jE={showCompass:!0,showZoom:!0,visualizePitch:!1};class AE{constructor(h,m,b=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new ky({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,b&&(this.mousePitch=new Ty({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(h,m){this.mouseRotate.mousedown(h,m),this.mousePitch&&this.mousePitch.mousedown(h,m),L()}move(h,m){const b=this.map,S=this.mouseRotate.mousemoveWindow(h,m),j=S&&S.bearingDelta;if(j&&b.setBearing(b.getBearing()+j),this.mousePitch){const R=this.mousePitch.mousemoveWindow(h,m),z=R&&R.pitchDelta;z&&b.setPitch(b.getPitch()+z)}}off(){const h=this.element;h.removeEventListener("mousedown",this.mousedown),h.removeEventListener("touchstart",this.touchstart,{passive:!1}),h.removeEventListener("touchmove",this.touchmove),h.removeEventListener("touchend",this.touchend),h.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){O(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(h){this.down(a.extend({},h,{ctrlKey:!0,preventDefault:()=>h.preventDefault()}),B(this.element,h)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(h){this.move(h,B(this.element,h))}mouseup(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()}touchstart(h){h.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=J(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>h.preventDefault()},this._startPos))}touchmove(h){h.targetTouches.length!==1?this.reset():(this._lastPos=J(this.element,h.targetTouches)[0],this.move({preventDefault:()=>h.preventDefault()},this._lastPos))}touchend(h){h.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Iy={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},My={maxWidth:100,unit:"metric"},Dy={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Wd={version:a.version,supported:g,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends wm{constructor(x){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),(x=a.extend({},n1,x)).minZoom!=null&&x.maxZoom!=null&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(x.minPitch!=null&&x.maxPitch!=null&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(x.minPitch!=null&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(x.maxPitch!=null&&x.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(x.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(x.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Bd(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies),x),this._interactive=x.interactive,this._minTileCacheSize=x.minTileCacheSize,this._maxTileCacheSize=x.maxTileCacheSize,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._useWebGL2=x.useWebGL2,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=x.crossSourceCollisions,this._collectResourceTiming=x.collectResourceTiming,this._optimizeForTerrain=x.optimizeForTerrain,this._language=this._parseLanguage(x.language),this._worldview=x.worldview,this._renderTaskQueue=new Ny,this._domRenderTaskQueue=new Ny,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},r1,x.locale),this._clickTolerance=x.clickTolerance,this._cooperativeGestures=x.cooperativeGestures,this._performanceMetricsCollection=x.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Py(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(x.transformRequest,x.accessToken,x.testMode),this._silenceAuthErrors=!!x.testMode,typeof x.container=="string"){if(this._container=a.window.document.getElementById(x.container),!this._container)throw new Error(`Container '${x.container}' not found.`)}else{if(!(x.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),x.maxBounds&&this.setMaxBounds(x.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new qo(this,x),this._localFontFamily=x.localFontFamily,this._localIdeographFontFamily=x.localIdeographFontFamily,x.style&&this.setStyle(x.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),x.projection&&this.setProjection(x.projection),this._hash=x.hash&&new vy(typeof x.hash=="string"&&x.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch}),x.bounds&&(this.resize(),this.fitBounds(x.bounds,a.extend({},x.fitBoundsOptions,{duration:0})))),this.resize(),x.attributionControl&&this.addControl(new Xt({customAttribution:x.customAttribution})),this._logoControl=new Ay,this.addControl(this._logoControl,x.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new a.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new a.Event(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(x,h){if(h===void 0&&(h=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=x.onAdd(this);this._controls.push(x);const b=this._controlPositions[h];return h.indexOf("bottom")!==-1?b.insertBefore(m,b.firstChild):b.appendChild(m),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const h=this._controls.indexOf(x);return h>-1&&this._controls.splice(h,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(x){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const h=!this._moving;return h&&this.fire(new a.Event("movestart",x)).fire(new a.Event("move",x)),this.fire(new a.Event("resize",x)),h&&this.fire(new a.Event("moveend",x)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(x){return this.transform.setMaxBounds(a.LngLatBounds.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x?this.setZoom(x):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x?this.setZoom(x):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x?this.setPitch(x):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x?this.setPitch(x):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.renderWorldCopies=x,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(x){return x==="auto"?a.window.navigator.language:Array.isArray(x)?x.length===0?void 0:x.map(h=>h==="auto"?a.window.navigator.language:h):x}setLanguage(x){const h=this._parseLanguage(x);if(!this.style||h===this._language)return this;this._language=h,this.style._reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(x){return this.style&&x!==this._worldview?(this._worldview=x,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(x){return this._lazyInitEmptyStyle(),x?typeof x=="string"&&(x={name:x}):x=null,this._useExplicitProjection=!!x,this._prioritizeAndUpdateProjection(x,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const x=this.transform,h=x.projection.name;let m;h==="globe"&&x.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(x.setMercatorFromTransition(),m=!0):h==="mercator"&&x.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(x.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(x,h){return this._updateProjection(x||h||{name:"mercator"})}_updateProjection(x){let h;if(h=x.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(x),this.style.applyProjectionUpdate(),h){this.painter.clearBackgroundTiles();for(const m in this.style._sourceCaches)this.style._sourceCaches[m].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(x){return this.transform.locationPoint3D(a.LngLat.convert(x))}unproject(x){return this.transform.pointLocation3D(a.Point.convert(x))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(x,h,m){if(x==="mouseenter"||x==="mouseover"){let b=!1;const S=R=>{const z=h.filter(ee=>this.getLayer(ee)),U=z.length?this.queryRenderedFeatures(R.point,{layers:z}):[];U.length?b||(b=!0,m.call(this,new Hi(x,this,R.originalEvent,{features:U}))):b=!1},j=()=>{b=!1};return{layers:new Set(h),listener:m,delegates:{mousemove:S,mouseout:j}}}if(x==="mouseleave"||x==="mouseout"){let b=!1;const S=R=>{const z=h.filter(U=>this.getLayer(U));(z.length?this.queryRenderedFeatures(R.point,{layers:z}):[]).length?b=!0:b&&(b=!1,m.call(this,new Hi(x,this,R.originalEvent)))},j=R=>{b&&(b=!1,m.call(this,new Hi(x,this,R.originalEvent)))};return{layers:new Set(h),listener:m,delegates:{mousemove:S,mouseout:j}}}{const b=S=>{const j=h.filter(z=>this.getLayer(z)),R=j.length?this.queryRenderedFeatures(S.point,{layers:j}):[];R.length&&(S.features=R,m.call(this,S),delete S.features)};return{layers:new Set(h),listener:m,delegates:{[x]:b}}}}on(x,h,m){if(m===void 0)return super.on(x,h);Array.isArray(h)||(h=[h]);const b=this._createDelegatedListener(x,h,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(b);for(const S in b.delegates)this.on(S,b.delegates[S]);return this}once(x,h,m){if(m===void 0)return super.once(x,h);Array.isArray(h)||(h=[h]);const b=this._createDelegatedListener(x,h,m);for(const S in b.delegates)this.once(S,b.delegates[S]);return this}off(x,h,m){if(m===void 0)return super.off(x,h);h=new Set(Array.isArray(h)?h:[h]);const b=(j,R)=>{if(j.size!==R.size)return!1;for(const z of j)if(!R.has(z))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[x]:void 0;return S&&(j=>{for(let R=0;R<j.length;R++){const z=j[R];if(z.listener===m&&b(z.layers,h)){for(const U in z.delegates)this.off(U,z.delegates[U]);return j.splice(R,1),this}}})(S),this}queryRenderedFeatures(x,h){return this.style?(h!==void 0||x===void 0||x instanceof a.Point||Array.isArray(x)||(h=x,x=void 0),this.style.queryRenderedFeatures(x=x||[[0,0],[this.transform.width,this.transform.height]],h=h||{},this.transform)):[]}querySourceFeatures(x,h){return this.style.querySourceFeatures(x,h)}isPointOnSurface(x){const{name:h}=this.transform.projection;return h!=="globe"&&h!=="mercator"&&a.warnOnce(`${h} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.Point.convert(x))}setStyle(x,h){return(h=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},h)).diff!==!1&&h.localIdeographFontFamily===this._localIdeographFontFamily&&h.localFontFamily===this._localFontFamily&&this.style&&x?(this._diffStyle(x,h),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._localFontFamily=h.localFontFamily,this._updateStyle(x,h))}_getUIString(x){const h=this._locale[x];if(h==null)throw new Error(`Missing UI string '${x}'`);return h}_updateStyle(x,h){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),x&&(this.style=new bs(this,h||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x):this.style.loadJSON(x)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new bs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,h){if(typeof x=="string"){const m=this._requestManager.normalizeStyleURL(x),b=this._requestManager.transformRequest(m,a.ResourceType.Style);a.getJSON(b,(S,j)=>{S?this.fire(new a.ErrorEvent(S)):j&&this._updateDiff(j,h)})}else typeof x=="object"&&this._updateDiff(x,h)}_updateDiff(x,h){try{this.style.setState(x)&&this._update(!0)}catch(m){a.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(x,h)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(x,h){return this._lazyInitEmptyStyle(),this.style.addSource(x,h),this._update(!0)}isSourceLoaded(x){return!!this.style&&this.style._isSourceCacheLoaded(x)}areTilesLoaded(){const x=this.style&&this.style._sourceCaches;for(const h in x){const m=x[h]._tiles;for(const b in m){const S=m[b];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}addSourceType(x,h,m){this._lazyInitEmptyStyle(),this.style.addSourceType(x,h,m)}removeSource(x){return this.style.removeSource(x),this._updateTerrain(),this._update(!0)}getSource(x){return this.style.getSource(x)}addImage(x,h,{pixelRatio:m=1,sdf:b=!1,stretchX:S,stretchY:j,content:R}={}){if(this._lazyInitEmptyStyle(),h instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&h instanceof a.window.ImageBitmap){const{width:z,height:U,data:ee}=a.exported.getImageData(h);this.style.addImage(x,{data:new a.RGBAImage({width:z,height:U},ee),pixelRatio:m,stretchX:S,stretchY:j,content:R,sdf:b,version:0})}else if(h.width===void 0||h.height===void 0)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:U}=h,ee=h;this.style.addImage(x,{data:new a.RGBAImage({width:z,height:U},new Uint8Array(ee.data)),pixelRatio:m,stretchX:S,stretchY:j,content:R,sdf:b,version:0,userImage:ee}),ee.onAdd&&ee.onAdd(this,x)}}updateImage(x,h){const m=this.style.getImage(x);if(!m)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=h instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&h instanceof a.window.ImageBitmap?a.exported.getImageData(h):h,{width:S,height:j}=b;S!==void 0&&j!==void 0?S===m.data.width&&j===m.data.height?(m.data.replace(b.data,!(h instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&h instanceof a.window.ImageBitmap)),this.style.updateImage(x,m)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${S}, ${j})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(x){return x?!!this.style.getImage(x):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x,h){a.getImage(this._requestManager.transformRequest(x,a.ResourceType.Image),(m,b)=>{h(m,b instanceof a.window.HTMLImageElement?a.exported.getImageData(b):b)})}listImages(){return this.style.listImages()}addLayer(x,h){return this._lazyInitEmptyStyle(),this.style.addLayer(x,h),this._update(!0)}moveLayer(x,h){return this.style.moveLayer(x,h),this._update(!0)}removeLayer(x){return this.style.removeLayer(x),this._update(!0)}getLayer(x){return this.style.getLayer(x)}setLayerZoomRange(x,h,m){return this.style.setLayerZoomRange(x,h,m),this._update(!0)}setFilter(x,h,m={}){return this.style.setFilter(x,h,m),this._update(!0)}getFilter(x){return this.style.getFilter(x)}setPaintProperty(x,h,m,b={}){return this.style.setPaintProperty(x,h,m,b),this._update(!0)}getPaintProperty(x,h){return this.style.getPaintProperty(x,h)}setLayoutProperty(x,h,m,b={}){return this.style.setLayoutProperty(x,h,m,b),this._update(!0)}getLayoutProperty(x,h){return this.style.getLayoutProperty(x,h)}setLight(x,h={}){return this._lazyInitEmptyStyle(),this.style.setLight(x,h),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(x){return this._lazyInitEmptyStyle(),!x&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(x),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(x){return this._lazyInitEmptyStyle(),this.style.setFog(x),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(x){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(x),this.transform):0}setFeatureState(x,h){return this.style.setFeatureState(x,h),this._update()}removeFeatureState(x,h){return this.style.removeFeatureState(x,h),this._update()}getFeatureState(x){return this.style.getFeatureState(x)}_updateContainerDimensions(){if(!this._container)return;const x=this._container.getBoundingClientRect().width||400,h=this._container.getBoundingClientRect().height||300;let m,b,S,j=this._container;for(;j&&(!b||!S);){const R=a.window.getComputedStyle(j).transform;R&&R!=="none"&&(m=R.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&m[0]!=="0"&&m[0]!=="1"&&(b=m[0]),m[3]&&m[3]!=="0"&&m[3]!=="1"&&(S=m[3])),j=j.parentElement}this._containerWidth=b?Math.abs(x/b):x,this._containerHeight=S?Math.abs(h/S):h}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const x=this._container;x.classList.add("mapboxgl-map"),(this._missingCSSCanary=T("div","mapboxgl-canary",x)).style.visibility="hidden",this._detectMissingCSS();const h=this._canvasContainer=T("div","mapboxgl-canvas-container",x);this._interactive&&h.classList.add("mapboxgl-interactive"),this._canvas=T("canvas","mapboxgl-canvas",h),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=T("div","mapboxgl-control-container",x),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{b[S]=T("div",`mapboxgl-ctrl-${S}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(x,h){const m=a.exported.devicePixelRatio||1;this._canvas.width=m*Math.ceil(x),this._canvas.height=m*Math.ceil(h),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${h}px`}_addMarker(x){this._markers.push(x)}_removeMarker(x){const h=this._markers.indexOf(x);h!==-1&&this._markers.splice(h,1)}_addPopup(x){this._popups.push(x)}_removePopup(x){const h=this._popups.indexOf(x);h!==-1&&this._popups.splice(h,1)}_setupPainter(){const x=a.extend({},g.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._useWebGL2&&this._canvas.getContext("webgl2",x),m=h||this._canvas.getContext("webgl",x)||this._canvas.getContext("experimental-webgl",x);m?(this._useWebGL2&&!h&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(m,!0),this.painter=new $d(m,this.transform,!!h),this.on("data",b=>{b.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(m)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(x){x.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:x}))}_contextRestored(x){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:x}))}_onMapScroll(x){if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_requestDomTask(x){!this.loaded()||this.loaded()&&!this.isMoving()?x():this._domRenderTaskQueue.add(x)}_render(x){let h;const m=this.painter.context.extTimerQuery,b=a.exported.now();if(this.listens("gpu-timing-frame")&&(h=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,h)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(x),this._domRenderTaskQueue.run(x),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,U=this.transform.pitch,ee=a.exported.now(),Q=new a.EvaluationParameters(z,{now:ee,fadeDuration:S,pitch:U,transition:this.style.getTransition()});this.style.update(Q)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let j=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),j=this._updateAverageElevation(b),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):j=this._updateAverageElevation(b),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),h){const z=a.exported.now()-b;m.endQueryEXT(m.TIME_ELAPSED_EXT,h),setTimeout(()=>{const U=m.getQueryObjectEXT(h,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(h),this.fire(new a.Event("gpu-timing-frame",{cpuTime:z,gpuTime:U})),a.window.performance.mark("frame-gpu",{startTime:b,detail:{gpuTime:U}})},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const U=this.painter.queryGpuTimers(z);this.fire(new a.Event("gpu-timing-layer",{layerTimes:U}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const U=this.painter.queryGpuTimeDeferredRender(z);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:U}))},50)}const R=this._sourcesDirty||this._styleDirty||this._placementDirty||j;if(R||this._repaint)this.triggerRepaint();else{const z=!this.isMoving()&&this.loaded();if(z&&(j=this._updateAverageElevation(b,!0)),j)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const U=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:U})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||R||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(x){for(const h of this._markers)x&&!this.getRenderWorldCopies()&&(h._lngLat=h._lngLat.wrap()),h._update();for(const h of this._popups)!x||this.getRenderWorldCopies()||h._trackPointer||(h._lngLat=h._lngLat.wrap()),h._update()}_updateAverageElevation(x,h=!1){const m=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&m(0);if((h||x-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(x)){const b=this.transform.averageElevation;let S=this.transform.sampleAverageElevation(),j=!1;this.transform.elevation&&(j=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=x;const R=Math.abs(b-S);if(R>1){if(this._isInitialLoad||j)return this._averageElevation.jumpTo(S),m(S);this._averageElevation.easeTo(S,x,300)}else if(R>1e-4)return this._averageElevation.jumpTo(S),m(S)}return!!this._averageElevation.isEasing(x)&&m(this._averageElevation.getValue(x))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,x=>{if(x&&(x.message===a.AUTH_ERR_MSG||x.status===401)){const h=this.painter.context.gl;a.storeAuthState(h,!1),this._logoControl instanceof Ay&&this._logoControl._updateLogo(),h&&h.clear(h.DEPTH_BUFFER_BIT|h.COLOR_BUFFER_BIT|h.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const x=this._isDragging();this.painter.updateTerrain(this.style,x)}_calculateSpeedIndex(){const x=this.painter.canvasCopy(),h=this.painter.getCanvasCopiesAndTimestamps();h.timeStamps.push(performance.now());const m=this.painter.context.gl,b=m.createFramebuffer();function S(j){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,j,0);const R=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,R),R}return m.bindFramebuffer(m.FRAMEBUFFER,b),this._canvasPixelComparison(S(x),h.canvasCopies.map(S),h.timeStamps)}_canvasPixelComparison(x,h,m){let b=m[1]-m[0];const S=x.length/4;for(let j=0;j<h.length;j++){const R=h[j];let z=0;for(let U=0;U<R.length;U+=4)R[U]===x[U]&&R[U+1]===x[U+1]&&R[U+2]===x[U+2]&&R[U+3]===x[U+3]&&(z+=1);b+=(m[j+2]-m[j+1])*(1-z/S)}return b}remove(){this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const x=this.painter.context.gl.getExtension("WEBGL_lose_context");x&&x.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(x){this._renderNextFrame=this._renderNextFrame||x,this.style&&!this._frame&&(this._frame=a.exported.frame(h=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(h)}))}_preloadTiles(x){const h=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(h,(m,b)=>m._preloadTiles(x,b),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(x){this._trackResize&&this.resize({originalEvent:x})._update()}_onVisibilityChange(){a.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(x){this._showTerrainWireframe!==x&&(this._showTerrainWireframe=x,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(x){this._speedIndexTiming!==x&&(this._speedIndexTiming=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(x){this._showTileAABBs!==x&&(this._showTileAABBs=x,x&&this._update())}_setCacheLimits(x,h){a.setCacheLimits(x,h)}get version(){return a.version}},NavigationControl:class{constructor(x){this.options=a.extend({},jE,x),this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",h=>h.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",h=>{this._map&&this._map.zoomIn({},{originalEvent:h})}),T("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",h=>{this._map&&this._map.zoomOut({},{originalEvent:h})}),T("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",h=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:h}):m.resetNorth({},{originalEvent:h}))}),this._compassIcon=T("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const x=this._map;if(!x)return;const h=x.getZoom(),m=h===x.getMaxZoom(),b=h===x.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())}_rotateCompassArrow(){const x=this._map;if(!x)return;const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(x.transform.pitch*(Math.PI/180)),.5)}) rotateX(${x.transform.pitch}deg) rotateZ(${x.transform.angle*(180/Math.PI)}deg)`:`rotate(${x.transform.angle*(180/Math.PI)}deg)`;x._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),x.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&x.on("pitch",this._rotateCompassArrow),x.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new AE(x,this._compass,this.options.visualizePitch)),this._container}onRemove(){const x=this._map;x&&(this._container.remove(),this.options.showZoom&&x.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&x.off("pitch",this._rotateCompassArrow),x.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(x,h){const m=T("button",x,this._container);return m.type="button",m.addEventListener("click",h),m}_setButtonTitle(x,h){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${h}`);x.setAttribute("aria-label",m),x.firstElementChild&&x.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends a.Evented{constructor(x){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},Iy,x),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Vd(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(x){return this._map=x,this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(x){const h=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,x(m)};this._supportsGeolocation!==void 0?x(this._supportsGeolocation):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(m=>h(m.state!=="denied")).catch(()=>h()):h()}_isOutOfMapMaxBounds(x){const h=this._map.getMaxBounds(),m=x.coords;return!!h&&(m.longitude<h.getWest()||m.longitude>h.getEast()||m.latitude<h.getSouth()||m.latitude>h.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(x){if(this._map){if(this._isOutOfMapMaxBounds(x))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",x)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=x,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(x),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(x),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",x)),this._finish()}}_updateCamera(x){const h=new a.LngLat(x.coords.longitude,x.coords.latitude),m=x.coords.accuracy,b=this._map.getBearing(),S=a.extend({bearing:b},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(m),S,{geolocateSource:!0})}_updateMarker(x){if(x){const h=new a.LngLat(x.coords.longitude,x.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=x.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const x=this._map.transform,h=a.mercatorZfromAltitude(1,x._center.lat)*x.worldSize,m=Math.ceil(2*this._accuracy*h);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(x){if(this._map){if(this.options.trackUserLocation)if(x.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(x.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",x)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(x){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=T("button","mapboxgl-ctrl-geolocate",this._container),T("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",x===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T("div","mapboxgl-user-location"),this._dotElement.appendChild(T("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(T("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ht({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=T("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ht({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(x){this._userLocationDotMarker&&(x.webkitCompassHeading?this._heading=x.webkitCompassHeading:x.absolute===!0&&(this._heading=-1*x.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let x;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(x={maximumAge:6e5,timeout:0},this._noTimeout=!0):(x=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,x),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const x=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(h=>{h==="granted"&&x()}).catch(console.error):x()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Xt,ScaleControl:class{constructor(x){this.options=a.extend({},My,x),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const x=this.options.maxWidth||100,h=this._map,m=h._containerHeight/2,b=h._containerWidth/2-x/2,S=h.unproject([b,m]),j=h.unproject([b+x,m]),R=S.distanceTo(j);if(this.options.unit==="imperial"){const z=3.2808*R;z>5280?this._setScale(x,z/5280,"mile"):this._setScale(x,z,"foot")}else this.options.unit==="nautical"?this._setScale(x,R/1852,"nautical-mile"):R>=1e3?this._setScale(x,R/1e3,"kilometer"):this._setScale(x,R,"meter")}_setScale(x,h,m){this._map._requestDomTask(()=>{const b=function(j){const R=Math.pow(10,`${Math.floor(j)}`.length-1);let z=j/R;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(U){const ee=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*ee)/ee}(z),R*z}(h),S=b/h;this._container.innerHTML=this._isNumberFormatSupported&&m!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:m}).format(b):`${b}&nbsp;${Dy[m]}`,this._container.style.width=x*S+"px"})}onAdd(x){return this._map=x,this._language=x.getLanguage(),this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-scale",x.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(x){this._language=x,this._update()}setUnit(x){this.options.unit=x,this._update()}},FullscreenControl:class{constructor(x){this._fullscreen=!1,x&&x.container&&(x.container instanceof a.window.HTMLElement?this._container=x.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=T("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const x=this._fullscreenButton=T("button","mapboxgl-ctrl-fullscreen",this._controlContainer);T("span","mapboxgl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",x)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(x){super(),this.options=a.extend(Object.create(Cy),x),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(x&&x.className?x.className.trim().split(/\s+/):[])}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&x.on("preclick",this._onClose),this.options.closeOnMove&&x.on("move",this._onClose),x.on("remove",this.remove),this._update(),x._addPopup(this),this._focusFirstElement(),this._trackPointer?(x.on("mousemove",this._onMouseEvent),x.on("mouseup",this._onMouseEvent),x._canvasContainer.classList.add("mapboxgl-track-pointer")):x.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const x=this._map;return x&&(x.off("move",this._update),x.off("move",this._onClose),x.off("preclick",this._onClose),x.off("click",this._onClose),x.off("remove",this.remove),x.off("mousemove",this._onMouseEvent),x.off("mouseup",this._onMouseEvent),x.off("drag",this._onMouseEvent),x._canvasContainer&&x._canvasContainer.classList.remove("mapboxgl-track-pointer"),x._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(x){this._lngLat=a.LngLat.convert(x),this._pos=null,this._trackPointer=!1,this._update();const h=this._map;return h&&(h.on("move",this._update),h.off("mousemove",this._onMouseEvent),h._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const x=this._map;return x&&(x.off("move",this._update),x.on("mousemove",this._onMouseEvent),x.on("drag",this._onMouseEvent),x._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(a.window.document.createTextNode(x))}setHTML(x){const h=a.window.document.createDocumentFragment(),m=a.window.document.createElement("body");let b;for(m.innerHTML=x;b=m.firstChild,b;)h.appendChild(b);return this.setDOMContent(h)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){let h=this._content;if(h)for(;h.hasChildNodes();)h.firstChild&&h.removeChild(h.firstChild);else h=this._content=T("div","mapboxgl-popup-content",this._container||void 0);if(h.appendChild(x),this.options.closeButton){const m=this._closeButton=T("button","mapboxgl-popup-close-button",h);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(x){return this._classList.add(x),this._updateClassList(),this}removeClassName(x){return this._classList.delete(x),this._updateClassList(),this}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){let h;return this._classList.delete(x)?h=!1:(this._classList.add(x),h=!0),this._updateClassList(),h}_onMouseEvent(x){this._update(x.point)}_getAnchor(x){if(this.options.anchor)return this.options.anchor;const h=this._map,m=this._container,b=this._pos;if(!h||!m||!b)return"bottom";const S=m.offsetWidth,j=m.offsetHeight,R=b.x<S/2,z=b.x>h.transform.width-S/2;if(b.y+x<j)return R?"top-left":z?"top-right":"top";if(b.y>h.transform.height-j){if(R)return"bottom-left";if(z)return"bottom-right"}return R?"left":z?"right":"bottom"}_updateClassList(){const x=this._container;if(!x)return;const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),x.className=h.join(" ")}_update(x){const h=this._map,m=this._content;if(!h||!this._lngLat&&!this._trackPointer||!m)return;let b=this._container;if(b||(b=this._container=T("div","mapboxgl-popup",h.getContainer()),this._tip=T("div","mapboxgl-popup-tip",b),b.appendChild(m)),this.options.maxWidth&&b.style.maxWidth!==this.options.maxWidth&&(b.style.maxWidth=this.options.maxWidth),h.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Gd(this._lngLat,this._pos,h.transform)),!this._trackPointer||x){const S=this._pos=this._trackPointer&&x?x:h.project(this._lngLat),j=t1(this.options.offset),R=this._anchor=this._getAnchor(j.y),z=t1(this.options.offset,R),U=S.add(z).round();h._requestDomTask(()=>{this._container&&R&&(this._container.style.transform=`${Nu[R]} translate(${U.x}px,${U.y}px)`)})}if(!this._marker&&h._showingGlobe()){const S=a.isLngLatBehindGlobe(h.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(EE);x&&x.focus()}_onClose(){this.remove()}_setOpacity(x){this._container&&(this._container.style.opacity=`${x}`),this._content&&(this._content.style.pointerEvents=x?"auto":"none")}},Marker:Ht,Style:bs,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:Fb,Evented:a.Evented,config:a.config,prewarm:function(){Pa().acquire(gs)},clearPrewarmedResources:function(){const x=Pi;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(gs),Pi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(x){a.config.ACCESS_TOKEN=x},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(x){a.config.API_URL=x},get workerCount(){return li.workerCount},set workerCount(x){li.workerCount=x},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(x){a.config.MAX_PARALLEL_IMAGE_REQUESTS=x},clearStorage(x){a.clearTileCache(x)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return Wd});var u=i;return u})})(cX);var cLe=cX.exports;const ks=Pn(cLe);const cu=[{id:"kinshasa",name:"Kinshasa",center:[15.2663,-4.4419],population:143e5,area:9965,capital:"Kinshasa",riskLevel:"medium",coordinates:[[15.1,-4.2],[15.4,-4.2],[15.4,-4.7],[15.1,-4.7],[15.1,-4.2]]},{id:"nord-kivu",name:"Nord-Kivu",center:[29.2663,-1.4419],population:8147400,area:59483,capital:"Goma",riskLevel:"high",coordinates:[[28.8,-.8],[30.2,-.8],[30.2,-2.3],[28.8,-2.3],[28.8,-.8]]},{id:"sud-kivu",name:"Sud-Kivu",center:[28.7663,-2.8419],population:5772e3,area:65070,capital:"Bukavu",riskLevel:"high",coordinates:[[27.8,-2.3],[29.5,-2.3],[29.5,-4.2],[27.8,-4.2],[27.8,-2.3]]},{id:"katanga",name:"Katanga",center:[25.2663,-9.4419],population:5608683,area:496965,capital:"Lubumbashi",riskLevel:"medium",coordinates:[[21.8,-5.8],[29.5,-5.8],[29.5,-13.2],[21.8,-13.2],[21.8,-5.8]]}],uLe=Array.from({length:500},(t,e)=>{const r=cu,n=r[Math.floor(Math.random()*r.length)],i=["low","medium","high","critical"],o=["armed_clash","civil_unrest","kidnapping","terrorism","robbery","protest"],u=i[Math.floor(Math.random()*i.length)];return{id:`incident_${e}`,type:o[Math.floor(Math.random()*o.length)],severity:u,coordinates:[n.center[0]+(Math.random()-.5)*2,n.center[1]+(Math.random()-.5)*2],timestamp:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString(),casualties:Math.floor(Math.random()*20),description:`${o[Math.floor(Math.random()*o.length)]} incident in ${n.name}`,province:n.name,verified:Math.random()>.3,sources:Math.floor(Math.random()*5)+1,confidence:Math.random()*100}}),dLe=Array.from({length:1e3},(t,e)=>{const r=cu,n=r[Math.floor(Math.random()*r.length)],i=["positive","neutral","negative"],o=["politics","security","economy","social","health","education"],u=["twitter","facebook","whatsapp","telegram"];return{id:`post_${e}`,coordinates:[n.center[0]+(Math.random()-.5)*3,n.center[1]+(Math.random()-.5)*3],sentiment:i[Math.floor(Math.random()*i.length)],sentimentScore:(Math.random()-.5)*2,topic:o[Math.floor(Math.random()*o.length)],platform:u[Math.floor(Math.random()*u.length)],engagement:Math.floor(Math.random()*1e4),reach:Math.floor(Math.random()*1e5),timestamp:new Date(Date.now()-Math.random()*7*24*60*60*1e3).toISOString(),viralPotential:Math.random(),credibility:Math.random()*100,province:n.name}}),hLe={powerPlants:[{id:"inga1",name:"Inga I",coordinates:[-5.5167,13.6167],capacity:351,status:"operational",type:"hydro"},{id:"inga2",name:"Inga II",coordinates:[-5.5267,13.6267],capacity:1424,status:"operational",type:"hydro"},{id:"katende",name:"Katende",coordinates:[-11.6167,27.4833],capacity:60,status:"maintenance",type:"thermal"}],airports:[{id:"fih",name:"N'djili Airport",coordinates:[-4.3857,15.4446],type:"international",status:"operational"},{id:"gom",name:"Goma Airport",coordinates:[-1.6708,29.2384],type:"regional",status:"operational"},{id:"lub",name:"Lubumbashi Airport",coordinates:[-11.5913,27.5309],type:"international",status:"operational"}],miningsites:Array.from({length:50},(t,e)=>({id:`mine_${e}`,name:`Mining Site ${e+1}`,coordinates:[21+Math.random()*8,-13+Math.random()*8],resource:["copper","cobalt","gold","diamond","coltan"][Math.floor(Math.random()*5)],production:Math.floor(Math.random()*1e3),securityLevel:["low","medium","high"][Math.floor(Math.random()*3)],workers:Math.floor(Math.random()*500)+50}))},fLe=Array.from({length:100},(t,e)=>{const r=cu,n=r[Math.floor(Math.random()*r.length)],i=["political","media","religious","business","activist"];return{id:`influencer_${e}`,name:`Influencer ${e+1}`,coordinates:[n.center[0]+(Math.random()-.5)*2,n.center[1]+(Math.random()-.5)*2],type:i[Math.floor(Math.random()*i.length)],followers:Math.floor(Math.random()*1e6),influence:Math.random()*100,reach:Math.floor(Math.random()*50)+10,activity:Math.random()*100,credibility:Math.random()*100,connections:Array.from({length:Math.floor(Math.random()*10)},()=>`influencer_${Math.floor(Math.random()*100)}`)}}),pLe=cu.map(t=>({id:t.id,name:t.name,density:t.population/t.area,population:t.population,area:t.area,growthRate:(Math.random()-.5)*6,urbanization:Math.random()*60+20})),mLe=Array.from({length:80},(t,e)=>{const r=cu,n=r[Math.floor(Math.random()*r.length)];return{id:`displacement_${e}`,type:["refugee_camp","idp_site","transit_center"][Math.floor(Math.random()*3)],coordinates:[n.center[0]+(Math.random()-.5)*3,n.center[1]+(Math.random()-.5)*3],population:Math.floor(Math.random()*5e4)+1e3,origin:n.name,established:new Date(Date.now()-Math.random()*365*24*60*60*1e3).toISOString(),conditions:["poor","fair","good"][Math.floor(Math.random()*3)],assistance:Math.random()>.4}}),gLe=Array.from({length:200},(t,e)=>{const r=cu,n=r[Math.floor(Math.random()*r.length)],i=["market","factory","bank","port","border_crossing"];return{id:`economic_${e}`,type:i[Math.floor(Math.random()*i.length)],coordinates:[n.center[0]+(Math.random()-.5)*2.5,n.center[1]+(Math.random()-.5)*2.5],value:Math.floor(Math.random()*1e7),employees:Math.floor(Math.random()*1e3),activity:Math.random()*100,importance:Math.random()*100}}),yLe=Array.from({length:20},(t,e)=>{const r=cu[Math.floor(Math.random()*cu.length)],n=Array.from({length:24},(i,o)=>{const u=Math.sin(o/24*Math.PI*2)*50+50;return{hour:o,intensity:u,reach:o*10+Math.random()*50,coordinates:[r.center[0]+(Math.random()-.5)*(o*.1),r.center[1]+(Math.random()-.5)*(o*.1)]}});return{id:`viral_${e}`,contentId:`content_${e}`,topic:["election","security","economy","health"][Math.floor(Math.random()*4)],origin:r.center,spreadPattern:n,totalReach:Math.floor(Math.random()*1e6),sentiment:(Math.random()-.5)*2}}),xLe={roads:[{id:"n1",name:"Route Nationale 1",coordinates:[[-4.4,15.3],[-11.6,27.5]],condition:"good",traffic:"heavy"},{id:"n2",name:"Route Nationale 2",coordinates:[[-4.4,15.3],[-1.7,29.2]],condition:"fair",traffic:"medium"},{id:"n3",name:"Route Nationale 3",coordinates:[[-1.7,29.2],[-2.8,28.8]],condition:"poor",traffic:"light"}],rivers:[{id:"congo",name:"Congo River",coordinates:[[-4.4,15.3],[-5,16],[-6,18]],navigable:!0},{id:"kasai",name:"Kasai River",coordinates:[[-6,16.5],[-8,19],[-9,20.5]],navigable:!0}]},vLe=cu.map(t=>{const e={security:Math.random()*100,political:Math.random()*100,economic:Math.random()*100,social:Math.random()*100,environmental:Math.random()*100},r=Object.values(e).reduce((n,i)=>n+i,0)/5;return{province:t.name,coordinates:t.center,riskFactors:e,overallRisk:r,riskLevel:r>75?"critical":r>50?"high":r>25?"medium":"low",trend:Math.random()>.5?"increasing":"decreasing",lastUpdate:new Date().toISOString()}}),_Le=Array.from({length:30},(t,e)=>({date:new Date(Date.now()-(29-e)*24*60*60*1e3).toISOString().split("T")[0],incidents:Math.floor(Math.random()*50)+10,socialActivity:Math.floor(Math.random()*1e3)+200,sentiment:(Math.random()-.5)*2,economicActivity:Math.floor(Math.random()*100)+50})),zx={drcProvinces:cu,security:{incidents:uLe,riskAssessment:vLe},social:{posts:dLe,viralSpread:yLe,influence:fLe},infrastructure:hLe,demographic:{population:pLe,displacement:mLe},economic:{activity:gLe,transportation:xLe},temporal:_Le};function bLe({mapboxToken:t,activeLayers:e=[],onResize:r}){const n=Y.useRef(null),i=Y.useRef(null),[o,u]=Y.useState("satellite-streets-v12"),[a,p]=Y.useState({longitude:23.6566,latitude:-2.8419,zoom:5.5,bearing:0,pitch:0}),[g,v]=Y.useState({choropleth:{provinces:!0,riskLevels:!0},security:{incidents:!0,clusters:!0,heatmap:!1},social:{sentiment:!0,heatmap:!0,viral:!1},infrastructure:{power:!1,transport:!1,mining:!1},demographic:{population:!1,displacement:!1}});Y.useEffect(()=>{var re,oe,ae,xe,ye,Se,be,Ce,$e,Ye,jt,Me,St,Ct;if(e&&e.length>0){const Ft=e.find(ot=>ot.id==="security"),gt=e.find(ot=>ot.id==="social"),Zt=e.find(ot=>ot.id==="infrastructure"),Tt=e.find(ot=>ot.id==="population");v({choropleth:{provinces:!0,riskLevels:!0},security:{incidents:(Ft==null?void 0:Ft.active)||!1,clusters:!0,heatmap:((oe=(re=Ft==null?void 0:Ft.sublayers)==null?void 0:re.find(ot=>ot.id==="armed_clash"))==null?void 0:oe.active)||!1},social:{sentiment:(gt==null?void 0:gt.active)||!1,heatmap:((xe=(ae=gt==null?void 0:gt.sublayers)==null?void 0:ae.find(ot=>ot.id==="sentiment"))==null?void 0:xe.active)||!1,viral:((Se=(ye=gt==null?void 0:gt.sublayers)==null?void 0:ye.find(ot=>ot.id==="viral_content"))==null?void 0:Se.active)||!1},infrastructure:{power:((Ce=(be=Zt==null?void 0:Zt.sublayers)==null?void 0:be.find(ot=>ot.id==="power"))==null?void 0:Ce.active)||!1,transport:((Ye=($e=Zt==null?void 0:Zt.sublayers)==null?void 0:$e.find(ot=>ot.id==="transport"))==null?void 0:Ye.active)||!1,mining:!1},demographic:{population:((Me=(jt=Tt==null?void 0:Tt.sublayers)==null?void 0:jt.find(ot=>ot.id==="density"))==null?void 0:Me.active)||!1,displacement:((Ct=(St=Tt==null?void 0:Tt.sublayers)==null?void 0:St.find(ot=>ot.id==="displacement"))==null?void 0:Ct.active)||!1}})}},[e]);const[w,T]=Y.useState({provinces:.6,security:.8,"social-heatmap":.7,influence:.9});Y.useState("layers");const[A,I]=Y.useState(!1),[P,D]=Y.useState(!1),L=Y.useRef([]),O=Y.useRef(new Set),$=[{id:"satellite-streets-v12",name:"Satellite",icon:tae,description:"High-resolution satellite imagery with street overlays"},{id:"streets-v12",name:"Streets",icon:OT,description:"Detailed street map with navigation features"},{id:"outdoors-v12",name:"Terrain",icon:Yie,description:"Topographic map showing elevation and terrain"}];Y.useEffect(()=>{if(!t){I(!0);return}if(n.current&&!i.current)try{ks.accessToken=t,i.current=new ks.Map({container:n.current,style:`mapbox://styles/mapbox/${o}`,center:[a.longitude,a.latitude],zoom:a.zoom,bearing:a.bearing,pitch:a.pitch,antialias:!0}),i.current.on("load",()=>{D(!0),G()}),i.current.addControl(new ks.NavigationControl,"top-left"),i.current.addControl(new ks.ScaleControl,"bottom-left"),i.current.addControl(new ks.FullscreenControl,"top-left"),i.current.on("moveend",()=>{if(i.current){const re=i.current.getCenter(),oe=i.current.getZoom(),ae=i.current.getBearing(),xe=i.current.getPitch();p({longitude:re.lng,latitude:re.lat,zoom:oe,bearing:ae,pitch:xe})}})}catch(re){console.error("Error initializing Mapbox:",re),I(!0)}return()=>{i.current&&(i.current.remove(),i.current=null)}},[t]),Y.useEffect(()=>{i.current&&P&&(i.current.setStyle(`mapbox://styles/mapbox/${o}`),i.current.once("styledata",()=>{G()}))},[o,P]),Y.useEffect(()=>{i.current&&P&&G()},[g,P]),Y.useEffect(()=>{i.current&&P&&setTimeout(()=>{var re;(re=i.current)==null||re.resize()},350)},[r,P]);const G=()=>{!i.current||!P||(B(),g.choropleth.provinces&&J(),g.security.incidents&&(g.security.clusters?W():H()),g.social.sentiment&&se(),g.social.heatmap&&V(),K())},B=()=>{L.current.forEach(re=>re.remove()),L.current=[],O.current.forEach(re=>{i.current&&i.current.getLayer(re)&&i.current.removeLayer(re)}),["provinces","security-incidents","social-media","security-heatmap"].forEach(re=>{i.current&&i.current.getSource(re)&&i.current.removeSource(re)}),O.current.clear()},J=()=>{if(!i.current)return;const re={type:"FeatureCollection",features:zx.drcProvinces.map(oe=>({type:"Feature",properties:{name:oe.name,population:oe.population,riskLevel:oe.riskLevel,activityScore:Math.random()*100},geometry:{type:"Polygon",coordinates:[oe.coordinates]}}))};i.current.addSource("provinces",{type:"geojson",data:re}),i.current.addLayer({id:"provinces-fill",type:"fill",source:"provinces",paint:{"fill-color":["case",["==",["get","riskLevel"],"high"],"#dc2626",["==",["get","riskLevel"],"medium"],"#ea580c","#16a34a"],"fill-opacity":w.provinces||.3}}),i.current.addLayer({id:"provinces-border",type:"line",source:"provinces",paint:{"line-color":"#374151","line-width":2,"line-opacity":.8}}),i.current.addLayer({id:"provinces-labels",type:"symbol",source:"provinces",layout:{"text-field":["get","name"],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":14,"text-anchor":"center"},paint:{"text-color":"#1f2937","text-halo-color":"#ffffff","text-halo-width":2}}),O.current.add("provinces-fill"),O.current.add("provinces-border"),O.current.add("provinces-labels"),i.current.on("click","provinces-fill",oe=>{const ae=oe.features[0],xe=oe.lngLat,ye=ae.properties;new ks.Popup().setLngLat(xe).setHTML(`
          <div class="p-4 min-w-[200px]">
            <h3 class="font-bold text-lg mb-3 text-gray-900">${ye.name}</h3>
            <div class="space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-gray-600">Population:</span>
                <span class="font-medium">${(ye.population/1e6).toFixed(1)}M</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Risk Level:</span>
                <span class="font-medium capitalize ${ye.riskLevel==="high"?"text-red-600":ye.riskLevel==="medium"?"text-yellow-600":"text-green-600"}">${ye.riskLevel}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Activity Score:</span>
                <span class="font-medium">${ye.activityScore.toFixed(0)}%</span>
              </div>
            </div>
          </div>
        `).addTo(i.current)})},W=()=>{if(!i.current)return;const re={type:"FeatureCollection",features:zx.security.incidents.map(oe=>({type:"Feature",properties:{...oe,timestamp:oe.timestamp.toString()},geometry:{type:"Point",coordinates:oe.coordinates}}))};i.current.addSource("security-incidents",{type:"geojson",data:re,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),i.current.addLayer({id:"clusters",type:"circle",source:"security-incidents",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",20,"#f1f075",100,"#f28cb1"],"circle-radius":["step",["get","point_count"],20,100,30,750,40],"circle-opacity":w.security||.8}}),i.current.addLayer({id:"cluster-count",type:"symbol",source:"security-incidents",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}}),i.current.addLayer({id:"unclustered-point",type:"circle",source:"security-incidents",filter:["!",["has","point_count"]],paint:{"circle-color":["case",["==",["get","severity"],"critical"],"#dc2626",["==",["get","severity"],"high"],"#ea580c",["==",["get","severity"],"medium"],"#ca8a04","#16a34a"],"circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#fff","circle-opacity":w.security||.8}}),O.current.add("clusters"),O.current.add("cluster-count"),O.current.add("unclustered-point"),i.current.on("click","clusters",oe=>{const ae=i.current.queryRenderedFeatures(oe.point,{layers:["clusters"]}),xe=ae[0].properties.cluster_id;i.current.getSource("security-incidents").getClusterExpansionZoom(xe,(ye,Se)=>{ye||i.current.easeTo({center:ae[0].geometry.coordinates,zoom:Se})})}),i.current.on("click","unclustered-point",oe=>{const ae=oe.features[0],xe=ae.geometry.coordinates.slice(),ye=ae.properties;new ks.Popup().setLngLat(xe).setHTML(`
          <div class="p-4 min-w-[250px]">
            <h3 class="font-bold text-lg mb-3 capitalize">${ye.type.replace("_"," ")}</h3>
            <div class="space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-gray-600">Severity:</span>
                <span class="font-medium capitalize ${ye.severity==="critical"?"text-red-600":ye.severity==="high"?"text-orange-600":ye.severity==="medium"?"text-yellow-600":"text-green-600"}">${ye.severity}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Province:</span>
                <span class="font-medium">${ye.province}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Date:</span>
                <span class="font-medium">${new Date(ye.timestamp).toLocaleDateString()}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Casualties:</span>
                <span class="font-medium">${ye.casualties}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Verified:</span>
                <span class="font-medium ${ye.verified?"text-green-600":"text-red-600"}">
                  ${ye.verified?"Yes":"No"}
                </span>
              </div>
            </div>
            <p class="text-xs text-gray-600 mt-3 border-t pt-2">${ye.description}</p>
          </div>
        `).addTo(i.current)})},H=()=>{zx.security.incidents.forEach((re,oe)=>{if(oe<100){const ae=document.createElement("div");ae.className="security-marker",ae.innerHTML=`
          <div class="w-4 h-4 rounded-full border-2 border-white shadow-lg ${re.severity==="critical"?"bg-red-500":re.severity==="high"?"bg-orange-500":re.severity==="medium"?"bg-yellow-500":"bg-green-500"}"></div>
        `,ae.style.cursor="pointer";const xe=new ks.Marker(ae).setLngLat(re.coordinates).setPopup(new ks.Popup({offset:25}).setHTML(`
              <div class="p-3">
                <h3 class="font-bold capitalize">${re.type.replace("_"," ")}</h3>
                <p class="text-sm mt-1">${re.description}</p>
              </div>
            `)).addTo(i.current);L.current.push(xe)}})},V=()=>{if(!i.current)return;const re={type:"FeatureCollection",features:zx.social.posts.map(oe=>({type:"Feature",properties:{engagement:oe.engagement,sentiment:oe.sentiment,platform:oe.platform},geometry:{type:"Point",coordinates:oe.coordinates}}))};i.current.addSource("social-media",{type:"geojson",data:re}),i.current.addLayer({id:"social-heatmap",type:"heatmap",source:"social-media",maxzoom:9,paint:{"heatmap-weight":["interpolate",["linear"],["get","engagement"],0,0,1e4,1],"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,9,3],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,20],"heatmap-opacity":w["social-heatmap"]||.7}}),O.current.add("social-heatmap")},se=()=>{i.current&&(i.current.addLayer({id:"social-points",type:"circle",source:"social-media",minzoom:7,paint:{"circle-radius":["interpolate",["linear"],["zoom"],7,["interpolate",["linear"],["get","engagement"],0,2,1e4,6],16,["interpolate",["linear"],["get","engagement"],0,8,1e4,25]],"circle-color":["case",["==",["get","sentiment"],"positive"],"#16a34a",["==",["get","sentiment"],"negative"],"#dc2626","#6b7280"],"circle-opacity":.6,"circle-stroke-width":1,"circle-stroke-color":"white"}}),O.current.add("social-points"))},K=()=>{zx.social.influence.forEach((re,oe)=>{if(oe<50){const ae=document.createElement("div");ae.className="influence-marker",ae.innerHTML=`
          <div class="w-6 h-6 bg-purple-500 rounded-full border-2 border-white shadow-lg flex items-center justify-center relative">
            <div class="w-2 h-2 bg-white rounded-full"></div>
            <div class="absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full text-xs flex items-center justify-center text-black font-bold">
              ${Math.floor(re.influence/20)+1}
            </div>
          </div>
        `,ae.style.cursor="pointer";const xe=new ks.Marker(ae).setLngLat(re.coordinates).setPopup(new ks.Popup({offset:25}).setHTML(`
              <div class="p-4 min-w-[200px]">
                <h3 class="font-bold text-lg mb-3">Influence Network</h3>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span class="text-gray-600">Type:</span>
                    <span class="font-medium capitalize">${re.type}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">Influence:</span>
                    <span class="font-medium">${re.influence.toFixed(1)}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">Followers:</span>
                    <span class="font-medium">${re.followers.toLocaleString()}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">Reach:</span>
                    <span class="font-medium">${re.reach}km</span>
                  </div>
                </div>
                <div class="mt-3 pt-2 border-t">
                  <div class="flex items-center space-x-1">
                    ${re.connections.slice(0,3).map(()=>'<div class="w-2 h-2 bg-purple-400 rounded-full"></div>').join("")}
                    <span class="text-xs text-gray-500 ml-1">
                      ${re.connections.length} connections
                    </span>
                  </div>
                </div>
              </div>
            `)).addTo(i.current);L.current.push(xe)}})},ce=Y.useCallback((re,oe)=>{v(ae=>{const xe=ae[re];return{...ae,[re]:{...xe,[oe]:!xe[oe]}}}),setTimeout(()=>G(),100)},[]),ne=Y.useCallback((re,oe)=>{T(ae=>({...ae,[re]:oe})),i.current&&i.current.getLayer(re)&&(re.includes("fill")?i.current.setPaintProperty(re,"fill-opacity",oe):re.includes("circle")?i.current.setPaintProperty(re,"circle-opacity",oe):re.includes("heatmap")&&i.current.setPaintProperty(re,"heatmap-opacity",oe))},[]);return l.jsxs("div",{className:"relative w-full h-full bg-gray-100 dark:bg-gray-900 rounded-lg overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0",children:A?l.jsx("div",{className:"flex items-center justify-center h-full bg-gray-200 dark:bg-gray-700 rounded-lg",children:l.jsxs("div",{className:"text-center p-8 max-w-md",children:[l.jsx(oi,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),l.jsx("h3",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-2",children:"Mapbox Configuration Required"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Advanced mapping features require a valid Mapbox API key."}),l.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 text-left",children:[l.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"Quick Setup:"}),l.jsxs("ol",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-1 list-decimal list-inside",children:[l.jsxs("li",{children:["Get free API key from ",l.jsx("a",{href:"https://account.mapbox.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Mapbox"})]}),l.jsxs("li",{children:["Add to .env: ",l.jsx("code",{className:"bg-blue-100 dark:bg-blue-800 px-1 rounded",children:"VITE_MAPBOX_ACCESS_TOKEN=your_key"})]}),l.jsx("li",{children:"Restart development server"})]})]})]})}):l.jsx("div",{ref:n,className:"w-full h-full"})}),l.jsx("div",{className:"absolute top-4 left-4 z-20",children:l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"p-2",children:[l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2 px-2",children:"Map Style"}),l.jsx("div",{className:"flex space-x-1",children:$.map(re=>{const oe=re.icon;return l.jsx("button",{onClick:()=>u(re.id),className:`p-2 rounded transition-colors group relative ${o===re.id?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:re.description,children:l.jsx(oe,{className:"w-4 h-4"})},re.id)})})]})})}),l.jsx("div",{className:"absolute top-4 right-4 z-20",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 max-w-sm",children:[l.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Advanced Layers"}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Live"})]})]})}),l.jsxs("div",{className:"p-3 space-y-3 max-h-80 overflow-y-auto",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Choropleth"}),l.jsx("button",{onClick:()=>ce("choropleth","provinces"),className:`p-1 rounded ${g.choropleth.provinces?"text-blue-600":"text-gray-400"}`,children:g.choropleth.provinces?l.jsx(ul,{className:"w-3 h-3"}):l.jsx(mv,{className:"w-3 h-3"})})]}),g.choropleth.provinces&&l.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:w.provinces||.3,onChange:re=>ne("provinces-fill",parseFloat(re.target.value)),className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Security"}),l.jsx("button",{onClick:()=>ce("security","incidents"),className:`p-1 rounded ${g.security.incidents?"text-red-600":"text-gray-400"}`,children:g.security.incidents?l.jsx(ul,{className:"w-3 h-3"}):l.jsx(mv,{className:"w-3 h-3"})})]}),g.security.incidents&&l.jsxs("div",{className:"space-y-1",children:[l.jsxs("label",{className:"flex items-center space-x-2 text-xs",children:[l.jsx("input",{type:"checkbox",checked:g.security.clusters,onChange:()=>ce("security","clusters"),className:"w-3 h-3 rounded"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Clustering"})]}),l.jsxs("label",{className:"flex items-center space-x-2 text-xs",children:[l.jsx("input",{type:"checkbox",checked:g.security.heatmap,onChange:()=>ce("security","heatmap"),className:"w-3 h-3 rounded"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Heatmap"})]})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:"Social Media"}),l.jsx("button",{onClick:()=>ce("social","sentiment"),className:`p-1 rounded ${g.social.sentiment?"text-blue-600":"text-gray-400"}`,children:g.social.sentiment?l.jsx(ul,{className:"w-3 h-3"}):l.jsx(mv,{className:"w-3 h-3"})})]}),g.social.sentiment&&l.jsxs("div",{className:"space-y-1",children:[l.jsxs("label",{className:"flex items-center space-x-2 text-xs",children:[l.jsx("input",{type:"checkbox",checked:g.social.heatmap,onChange:()=>ce("social","heatmap"),className:"w-3 h-3 rounded"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Heatmap"})]}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:w["social-heatmap"]||.7,onChange:re=>ne("social-heatmap",parseFloat(re.target.value)),className:"w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]})]})]})]})}),l.jsx("div",{className:"absolute bottom-4 left-4 z-20",children:l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-3",children:l.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(nu,{className:"w-3 h-3 text-blue-600 dark:text-blue-400"}),l.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Zoom: ",a.zoom.toFixed(1)]})]}),l.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:[a.latitude.toFixed(3),", ",a.longitude.toFixed(3)]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Live Data"})]})]})})}),l.jsx("div",{className:"absolute bottom-4 right-4 z-20",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-2 flex space-x-1",children:[l.jsx("button",{className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"Export Map",children:l.jsx(Co,{className:"w-4 h-4"})}),l.jsx("button",{className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",title:"Bookmark View",children:l.jsx(IU,{className:"w-4 h-4"})})]})})]})}function wLe({mapboxToken:t}){const e=Y.useRef(null),r=Y.useRef(null),[n,i]=Y.useState("Initializing..."),[o,u]=Y.useState(0);return Y.useEffect(()=>{if(!t){i("No Mapbox token provided");return}if(e.current&&!r.current)try{ks.accessToken=t,i("Creating map..."),r.current=new ks.Map({container:e.current,style:"mapbox://styles/mapbox/streets-v12",center:[23.6566,-2.8419],zoom:5}),r.current.on("load",()=>{i("Map loaded! Adding test markers...");const a=[{lng:15.2663,lat:-4.4419,name:"Kinshasa"},{lng:29.2663,lat:-1.4419,name:"Nord-Kivu"},{lng:28.7663,lat:-2.8419,name:"Sud-Kivu"},{lng:25.2663,lat:-9.4419,name:"Katanga"}];let p=0;a.forEach(g=>{new ks.Marker({color:"#FF0000"}).setLngLat([g.lng,g.lat]).setPopup(new ks.Popup().setHTML(`<h3>${g.name}</h3>`)).addTo(r.current),p++}),u(p),i(`Map ready! Added ${p} test markers`)}),r.current.on("error",a=>{i(`Map error: ${a.error.message}`)})}catch(a){i(`Error: ${a}`)}return()=>{r.current&&(r.current.remove(),r.current=null)}},[t]),l.jsxs("div",{className:"relative w-full h-full",children:[l.jsxs("div",{className:"absolute top-4 left-4 z-10 bg-white p-4 rounded shadow-lg max-w-sm",children:[l.jsx("h3",{className:"font-bold mb-2",children:"Map Debug Info"}),l.jsxs("p",{className:"text-sm",children:["Status: ",n]}),l.jsxs("p",{className:"text-sm",children:["Token: ",t?"Present":"Missing"]}),l.jsxs("p",{className:"text-sm",children:["Markers: ",o]})]}),l.jsx("div",{ref:e,className:"w-full h-full"})]})}function S4(){var oe;const[t,e]=Y.useState(!0),[r,n]=Y.useState(!1),[i,o]=Y.useState(!1),[u,a]=Y.useState("layers"),[p,g]=Y.useState(!1),[v,w]=Y.useState(!0),[T,A]=Y.useState(""),[I,P]=Y.useState([]),[D,L]=Y.useState("24h"),[O,$]=Y.useState(!1),[G,B]=Y.useState("hotspots"),J="pk.eyJ1Ijoic2FudGlhZ29sZ2QiLCJhIjoiY2tpdngyY2lwMWNiOTJ2bW0wdTF6ZW52ZyJ9.ve7YzOLqoeUymHJfGhVGgA",W=[{icon:gl,label:"Security Incidents",value:"237",change:"+12%",trend:"up",color:"red",description:"Last 24h"},{icon:ea,label:"Social Mentions",value:"12.4K",change:"+8%",trend:"up",color:"blue",description:"Active discussions"},{icon:ds,label:"Alert Level",value:"Medium",change:"Stable",trend:"stable",color:"yellow",description:"National average"},{icon:Uh,label:"Provinces Monitored",value:"26",change:"100%",trend:"stable",color:"green",description:"Full coverage"}],[H,V]=Y.useState([{id:"security",name:"Security Incidents",icon:gl,color:"#dc2626",active:!0,count:237,sublayers:[{id:"armed_clash",name:"Armed Clashes",active:!0,count:45},{id:"civil_unrest",name:"Civil Unrest",active:!0,count:78},{id:"terrorism",name:"Terrorism",active:!1,count:12},{id:"kidnapping",name:"Kidnapping",active:!0,count:23}]},{id:"social",name:"Social Intelligence",icon:ea,color:"#2563eb",active:!0,count:12400,sublayers:[{id:"sentiment",name:"Sentiment Analysis",active:!0,count:8900},{id:"viral_content",name:"Viral Content",active:!1,count:156},{id:"influence_networks",name:"Influence Networks",active:!0,count:89}]},{id:"infrastructure",name:"Infrastructure",icon:Mh,color:"#7c3aed",active:!1,count:1240,sublayers:[{id:"power",name:"Power Grid",active:!1,count:45},{id:"transport",name:"Transport",active:!1,count:234},{id:"communications",name:"Communications",active:!1,count:123}]},{id:"population",name:"Demographics",icon:Uh,color:"#059669",active:!1,count:890,sublayers:[{id:"density",name:"Population Density",active:!1,count:26},{id:"displacement",name:"Displacement",active:!1,count:78},{id:"movements",name:"Population Movements",active:!1,count:234}]}]),se=ae=>{V(xe=>xe.map(ye=>ye.id===ae?{...ye,active:!ye.active}:ye))},K=(ae,xe)=>{V(ye=>ye.map(Se=>Se.id===ae?{...Se,sublayers:Se.sublayers.map(be=>be.id===xe?{...be,active:!be.active}:be)}:Se))},ce=[{id:"last_24h",label:"Last 24h",active:!0},{id:"last_week",label:"Last Week",active:!1},{id:"high_severity",label:"High Severity Only",active:!1},{id:"verified_only",label:"Verified Only",active:!0}];Y.useEffect(()=>{if(!v)return;const ae=setInterval(()=>{V(xe=>xe.map(ye=>({...ye,count:ye.count+Math.floor(Math.random()*3-1)})))},5e3);return()=>clearInterval(ae)},[v]);const ne=Y.useCallback(ae=>{if(A(ae),!ae.trim()){P([]);return}const xe=[{id:"1",type:"location",title:"Kinshasa",subtitle:"Province - 11.5M inhabitants",coordinates:[15.2663,-4.4419],icon:od},{id:"2",type:"incident",title:"Armed Clash in Goma",subtitle:"Security incident - 2 hours ago",coordinates:[29.2348,-1.6792],icon:oi},{id:"3",type:"social",title:"Viral Content in Lubumbashi",subtitle:"Social media activity spike",coordinates:[27.4794,-11.6609],icon:ii}].filter(ye=>ye.title.toLowerCase().includes(ae.toLowerCase())||ye.subtitle.toLowerCase().includes(ae.toLowerCase()));P(xe)},[]),re={hotspots:[{name:"Nord-Kivu",value:95,color:"#dc2626",incidents:45},{name:"Sud-Kivu",value:78,color:"#ea580c",incidents:32},{name:"Ituri",value:65,color:"#ca8a04",incidents:28},{name:"Kasaï",value:42,color:"#16a34a",incidents:18}],patterns:[{pattern:"Evening surge",frequency:"85%",time:"18:00-22:00"},{pattern:"Border clustering",frequency:"73%",location:"Eastern provinces"},{pattern:"Social correlation",frequency:"68%",type:"Security + Social media"}],predictions:[{metric:"Next hotspot",prediction:"Maniema Province",confidence:"76%"},{metric:"Peak activity",prediction:"Next 6 hours",confidence:"84%"},{metric:"Spread direction",prediction:"Northeast",confidence:"71%"}],networks:[{cluster:"Network A",nodes:23,influence:87,type:"Political"},{cluster:"Network B",nodes:18,influence:73,type:"Social"},{cluster:"Network C",nodes:31,influence:65,type:"Economic"}]};return l.jsxs("div",{className:"relative h-screen bg-gray-50 dark:bg-gray-900 overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 left-0 right-0 z-30 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Intelligence Géographique Avancée"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Analyse en temps réel • République Démocratique du Congo"})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"relative",children:[l.jsx(iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l.jsx("input",{type:"text",placeholder:"Rechercher lieux, incidents...",value:T,onChange:ae=>ne(ae.target.value),className:"w-64 pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),I.length>0&&l.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:I.map(ae=>{const xe=ae.icon;return l.jsxs("button",{className:"w-full flex items-center space-x-3 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",onClick:()=>{A(ae.title),P([])},children:[l.jsx(xe,{className:"w-4 h-4 text-gray-400"}),l.jsxs("div",{className:"text-left",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:ae.title}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:ae.subtitle})]})]},ae.id)})})]}),l.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[l.jsxs("button",{onClick:()=>w(!v),className:`flex items-center space-x-1 px-2 py-1 rounded text-xs font-medium transition-colors ${v?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"text-gray-600 dark:text-gray-400"}`,children:[v?l.jsx(qg,{className:"w-3 h-3"}):l.jsx(Ug,{className:"w-3 h-3"}),l.jsx("span",{children:v?"Live":"Paused"})]}),l.jsx("button",{className:"p-1 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:l.jsx(ro,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${v?"bg-green-500 animate-pulse":"bg-gray-400"}`}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:v?"Live":"Static"})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(nu,{className:"w-4 h-4 text-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[((oe=H.find(ae=>ae.active))==null?void 0:oe.count)||0," Active"]})]})]}),l.jsx("button",{onClick:()=>o(!i),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:i?"Exit Fullscreen":"Fullscreen Map",children:i?l.jsx(Kie,{className:"w-4 h-4"}):l.jsx(RT,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>e(!t),className:`p-2 rounded-lg transition-colors ${t?"text-blue-600 bg-blue-100 dark:bg-blue-900/30":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:"Toggle Controls Panel",children:l.jsx(YI,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>n(!r),className:`p-2 rounded-lg transition-colors ${r?"text-blue-600 bg-blue-100 dark:bg-blue-900/30":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:"Toggle Analysis Panel",children:l.jsx(No,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>g(!p),className:`p-2 rounded-lg transition-colors ${p?"text-orange-600 bg-orange-100 dark:bg-orange-900/30":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:"Toggle Debug Mode",children:l.jsx(V0,{className:"w-4 h-4"})})]})]})}),l.jsx("div",{className:`absolute inset-0 pt-16 transition-all duration-300 ${i?"":`${t?"left-80":"left-0"} ${r?"right-80":"right-0"}`}`,children:p?l.jsx(wLe,{mapboxToken:J}):l.jsx(bLe,{mapboxToken:J,activeLayers:H,onResize:t||r||i,realTimeUpdates:v,showHeatmap:O,selectedTimeRange:D})}),l.jsx("div",{className:`absolute left-0 top-16 bottom-0 w-80 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transform transition-transform duration-300 z-20 ${t&&!i?"translate-x-0":"-translate-x-full"}`,children:l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[l.jsx("button",{onClick:()=>a("metrics"),className:`px-3 py-1 text-xs rounded transition-colors ${u==="metrics"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:"Métriques"}),l.jsx("button",{onClick:()=>a("layers"),className:`px-3 py-1 text-xs rounded transition-colors ${u==="layers"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:"Couches"}),l.jsx("button",{onClick:()=>a("filters"),className:`px-3 py-1 text-xs rounded transition-colors ${u==="filters"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:"Filtres"}),l.jsx("button",{onClick:()=>a("analysis"),className:`px-3 py-1 text-xs rounded transition-colors ${u==="analysis"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:"Analyse"})]})}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[u==="metrics"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"Métriques Clés"}),W.map(ae=>{const xe=ae.icon;return l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(xe,{className:`w-4 h-4 text-${ae.color}-500`}),l.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:ae.label})]}),l.jsx(ii,{className:`w-3 h-3 ${ae.trend==="up"?"text-green-500":"text-gray-400"}`})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:ae.value}),l.jsx("span",{className:`text-xs px-2 py-1 rounded ${ae.trend==="up"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-600 dark:bg-gray-600 dark:text-gray-300"}`,children:ae.change})]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:ae.description})]},ae.label)})]}),u==="layers"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"Couches de Données"}),H.map(ae=>{const xe=ae.icon;return l.jsx("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg",children:l.jsxs("div",{className:"p-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(xe,{className:"w-4 h-4",style:{color:ae.color}}),l.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:ae.name}),l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",ae.count.toLocaleString(),")"]})]}),l.jsx("button",{onClick:()=>se(ae.id),className:`p-1 rounded ${ae.active?"text-blue-600 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`,children:ae.active?l.jsx(ul,{className:"w-4 h-4"}):l.jsx(mv,{className:"w-4 h-4"})})]}),ae.active&&l.jsx("div",{className:"space-y-1 mt-3 pl-6",children:ae.sublayers.map(ye=>l.jsxs("div",{className:"flex items-center justify-between py-1",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:ye.active,onChange:()=>K(ae.id,ye.id),className:"w-3 h-3 rounded"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:ye.name})]}),l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:ye.count})]},ye.id))})]})},ae.id)})]}),u==="filters"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"Filtres Rapides"}),l.jsx("div",{className:"space-y-2",children:ce.map(ae=>l.jsxs("label",{className:"flex items-center space-x-3 p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded",children:[l.jsx("input",{type:"checkbox",checked:ae.active,className:"w-4 h-4 rounded"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:ae.label})]},ae.id))}),l.jsxs("div",{className:"mt-6",children:[l.jsx("h4",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2 uppercase tracking-wide",children:"Filtres Avancés"}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2 block",children:"Niveau de Sévérité"}),l.jsx("div",{className:"space-y-1",children:["Critique","Élevé","Moyen","Faible"].map((ae,xe)=>l.jsxs("label",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",className:"w-3 h-3 rounded",defaultChecked:xe<2}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:ae})]},ae))})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2 block",children:"Période Temporelle"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("select",{value:D,onChange:ae=>L(ae.target.value),className:"w-full px-3 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[l.jsx("option",{value:"1h",children:"Dernière heure"}),l.jsx("option",{value:"6h",children:"Dernières 6h"}),l.jsx("option",{value:"24h",children:"Dernières 24h"}),l.jsx("option",{value:"7d",children:"Dernière semaine"}),l.jsx("option",{value:"30d",children:"Dernier mois"}),l.jsx("option",{value:"custom",children:"Personnalisé"})]}),D==="custom"&&l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsx("input",{type:"datetime-local",className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-xs"}),l.jsx("input",{type:"datetime-local",className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-xs"})]})]})]}),l.jsx("div",{className:"mb-4",children:l.jsxs("label",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded",children:[l.jsx("input",{type:"checkbox",checked:O,onChange:ae=>$(ae.target.checked),className:"w-4 h-4 rounded"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Affichage Heatmap"})]})}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2 block",children:"Provinces"}),l.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:["Kinshasa","Nord-Kivu","Sud-Kivu","Katanga","Kasaï"].map(ae=>l.jsxs("label",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",className:"w-3 h-3 rounded",defaultChecked:!0}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:ae})]},ae))})]})]})]}),u==="analysis"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-3",children:"Analyse Intelligente"}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[l.jsxs("button",{onClick:()=>B("hotspots"),className:`flex items-center space-x-2 p-2 rounded text-xs transition-colors ${G==="hotspots"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[l.jsx(Fie,{className:"w-3 h-3"}),l.jsx("span",{children:"Hotspots"})]}),l.jsxs("button",{onClick:()=>B("patterns"),className:`flex items-center space-x-2 p-2 rounded text-xs transition-colors ${G==="patterns"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[l.jsx(F6,{className:"w-3 h-3"}),l.jsx("span",{children:"Patterns"})]}),l.jsxs("button",{onClick:()=>B("predictions"),className:`flex items-center space-x-2 p-2 rounded text-xs transition-colors ${G==="predictions"?"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[l.jsx(cc,{className:"w-3 h-3"}),l.jsx("span",{children:"IA"})]}),l.jsxs("button",{onClick:()=>B("networks"),className:`flex items-center space-x-2 p-2 rounded text-xs transition-colors ${G==="networks"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[l.jsx(Wc,{className:"w-3 h-3"}),l.jsx("span",{children:"Réseaux"})]})]}),l.jsxs("div",{className:"space-y-3",children:[G==="hotspots"&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zones à Risque Élevé"}),re.hotspots.map(ae=>l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded p-3 mb-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:ae.name}),l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[ae.incidents," incidents"]})]}),l.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:l.jsx("div",{className:"h-2 rounded-full",style:{width:`${ae.value}%`,backgroundColor:ae.color}})}),l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Niveau de risque: ",ae.value,"%"]})]},ae.name))]}),G==="patterns"&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Modèles Détectés"}),re.patterns.map((ae,xe)=>l.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded p-3 mb-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:ae.pattern}),l.jsx("span",{className:"text-xs font-bold text-blue-600 dark:text-blue-400",children:ae.frequency})]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:ae.time||ae.location||ae.type})]},xe))]}),G==="predictions"&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Prédictions IA"}),re.predictions.map((ae,xe)=>l.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded p-3 mb-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-sm font-medium text-purple-900 dark:text-purple-100",children:ae.metric}),l.jsx("span",{className:"text-xs font-bold text-purple-600 dark:text-purple-400",children:ae.confidence})]}),l.jsx("div",{className:"text-xs text-purple-700 dark:text-purple-300",children:ae.prediction})]},xe))]}),G==="networks"&&l.jsxs("div",{children:[l.jsx("h4",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Réseaux d'Influence"}),re.networks.map((ae,xe)=>l.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded p-3 mb-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:ae.cluster}),l.jsx("span",{className:"text-xs px-2 py-1 rounded bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",children:ae.type})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Nœuds:"}),l.jsx("span",{className:"font-medium text-gray-900 dark:text-white ml-1",children:ae.nodes})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Influence:"}),l.jsxs("span",{className:"font-medium text-gray-900 dark:text-white ml-1",children:[ae.influence,"%"]})]})]})]},xe))]})]})]})]})]})}),l.jsx("div",{className:`absolute right-0 top-16 bottom-0 w-80 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 transform transition-transform duration-300 z-20 ${r&&!i?"translate-x-0":"translate-x-full"}`,children:l.jsxs("div",{className:"h-full flex flex-col p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Analyse en Temps Réel"}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${v?"bg-green-500 animate-pulse":"bg-gray-400"}`}),l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:v?"Live":"Statique"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[l.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-lg p-3 text-white",children:[l.jsx("div",{className:"text-xl font-bold",children:"237"}),l.jsx("div",{className:"text-xs opacity-90",children:"Incidents Actifs"}),l.jsx("div",{className:"text-xs opacity-75",children:"+12 depuis 1h"})]}),l.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-3 text-white",children:[l.jsx("div",{className:"text-xl font-bold",children:"89%"}),l.jsx("div",{className:"text-xs opacity-90",children:"Précision IA"}),l.jsx("div",{className:"text-xs opacity-75",children:"Modèle v2.1"})]})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto space-y-3",children:[l.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[l.jsx(oi,{className:"w-4 h-4 text-red-500"}),l.jsx("span",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:"Incident Critique"}),l.jsx("span",{className:"text-xs text-red-500",children:"Il y a 2 min"})]}),l.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mb-2",children:"Affrontements armés signalés près de Goma, Nord-Kivu."}),l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsx("span",{className:"text-red-500",children:"12 sources confirmées"}),l.jsx("button",{className:"text-red-600 hover:text-red-800 underline",children:"Voir détails"})]})]}),l.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[l.jsx(ii,{className:"w-4 h-4 text-blue-500"}),l.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Tendance Virale"}),l.jsx("span",{className:"text-xs text-blue-500",children:"Il y a 5 min"})]}),l.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mb-2",children:"#ElectionsRDC: +340% d'engagement en 2h"}),l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("span",{className:"bg-green-100 text-green-700 px-1 rounded",children:"67% Positif"}),l.jsx("span",{className:"bg-gray-100 text-gray-700 px-1 rounded",children:"23% Neutre"})]}),l.jsx("span",{className:"text-blue-600",children:"2.1M portée"})]})]}),l.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[l.jsx(cc,{className:"w-4 h-4 text-purple-500"}),l.jsx("span",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Prédiction IA"}),l.jsx("span",{className:"text-xs text-purple-500",children:"Il y a 8 min"})]}),l.jsx("p",{className:"text-xs text-purple-600 dark:text-purple-400 mb-2",children:"Probabilité élevée d'incident dans Maniema (76%)"}),l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsx("span",{className:"text-purple-500",children:"Modèle: Sécurité v2.1"}),l.jsx("span",{className:"bg-purple-100 text-purple-700 px-1 rounded",children:"6h fenêtre"})]})]}),l.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[l.jsx(Wc,{className:"w-4 h-4 text-yellow-500"}),l.jsx("span",{className:"text-sm font-medium text-yellow-700 dark:text-yellow-300",children:"Réseau Détecté"}),l.jsx("span",{className:"text-xs text-yellow-500",children:"Il y a 12 min"})]}),l.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 mb-2",children:"Nouveau cluster d'influence (23 nœuds) - Kasaï Oriental"}),l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsx("span",{className:"text-yellow-500",children:"Type: Politique"}),l.jsx("span",{className:"bg-yellow-100 text-yellow-700 px-1 rounded",children:"Influence: 73%"})]})]}),l.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[l.jsx(F6,{className:"w-4 h-4 text-green-500"}),l.jsx("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Pattern Identifié"}),l.jsx("span",{className:"text-xs text-green-500",children:"Il y a 15 min"})]}),l.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mb-2",children:"Corrélation activité social + incidents sécuritaires"}),l.jsxs("div",{className:"flex items-center justify-between text-xs",children:[l.jsx("span",{className:"text-green-500",children:"Confiance: 85%"}),l.jsx("span",{className:"bg-green-100 text-green-700 px-1 rounded",children:"Récurrent"})]})]})]}),l.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("button",{className:"flex items-center justify-center space-x-1 px-3 py-2 bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 rounded-lg text-xs hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors",children:[l.jsx(No,{className:"w-3 h-3"}),l.jsx("span",{children:"Rapport"})]}),l.jsxs("button",{className:"flex items-center justify-center space-x-1 px-3 py-2 bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded-lg text-xs hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors",children:[l.jsx(oi,{className:"w-3 h-3"}),l.jsx("span",{children:"Alerte"})]})]})})]})}),!i&&l.jsx("div",{className:"absolute bottom-4 left-4 right-4 z-10 pointer-events-none",children:l.jsxs("div",{className:"flex justify-between items-end",children:[l.jsxs("div",{className:"flex space-x-2 pointer-events-auto",children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 border border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Incidents Actifs"}),l.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:"23"})]})}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 border border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Sources Actives"}),l.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:"156"})]})})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-3 border border-gray-200 dark:border-gray-700 pointer-events-auto",children:[l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:"Légende"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Sécurité"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Social"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Influence"})]})]})]})]})})]})}function kLe(){const[t,e]=Y.useState("prediction"),r=[{time:"Maintenant",actual:100,predicted:100,confidence:95},{time:"+1h",actual:null,predicted:112,confidence:92},{time:"+2h",actual:null,predicted:125,confidence:88},{time:"+3h",actual:null,predicted:118,confidence:85},{time:"+4h",actual:null,predicted:132,confidence:82},{time:"+5h",actual:null,predicted:145,confidence:78},{time:"+6h",actual:null,predicted:139,confidence:75}],n=[{topic:"Sécurité",probability:80,impact:90,mitigation:"Renforcer surveillance"},{topic:"Économie",probability:60,impact:70,mitigation:"Communication proactive"},{topic:"Santé",probability:40,impact:60,mitigation:"Préparation ressources"},{topic:"Éducation",probability:30,impact:50,mitigation:"Dialogue continu"},{topic:"Transport",probability:50,impact:40,mitigation:"Plans alternatifs"},{topic:"Politique",probability:70,impact:85,mitigation:"Médiation active"}],i=[{pattern:"Escalade tensions",occurrences:23,accuracy:87,trend:"increasing"},{pattern:"Campagne désinformation",occurrences:15,accuracy:92,trend:"stable"},{pattern:"Mobilisation positive",occurrences:31,accuracy:78,trend:"increasing"},{pattern:"Crise émergente",occurrences:8,accuracy:95,trend:"decreasing"}],o=[{id:1,type:"Volume spike",severity:"high",time:"14:23",location:"Goma",description:"Augmentation 300% mentions"},{id:2,type:"Sentiment shift",severity:"medium",time:"15:45",location:"Kinshasa",description:"Baisse sentiment 45%"},{id:3,type:"New actor",severity:"low",time:"16:12",location:"Lubumbashi",description:"Nouvel influenceur détecté"}],u=[{id:"prediction",name:"Prédiction",icon:ii,accuracy:94.7},{id:"risk",name:"Analyse Risques",icon:oi,accuracy:89.2},{id:"pattern",name:"Reconnaissance",icon:$ie,accuracy:91.5},{id:"anomaly",name:"Anomalies",icon:Mh,accuracy:96.3}];return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Intelligence Artificielle"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Modèles prédictifs et analyse avancée"})]}),l.jsxs("div",{className:"flex items-center space-x-2 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-4 py-2 rounded-lg",children:[l.jsx(cc,{className:"w-5 h-5"}),l.jsx("span",{className:"font-medium",children:"4 modèles actifs"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:u.map(a=>{const p=a.icon,g=t===a.id;return l.jsxs("button",{onClick:()=>e(a.id),className:`p-6 rounded-xl transition-all ${g?"bg-gradient-to-br from-purple-500 to-purple-600 text-white shadow-lg":"bg-white dark:bg-gray-800 hover:shadow-md"}`,children:[l.jsx(p,{className:`w-8 h-8 mb-3 ${g?"text-white":"text-purple-600"}`}),l.jsx("h4",{className:`font-semibold mb-1 ${g?"text-white":"text-gray-800 dark:text-white"}`,children:a.name}),l.jsxs("p",{className:`text-sm ${g?"text-purple-100":"text-gray-500 dark:text-gray-400"}`,children:["Précision: ",a.accuracy,"%"]})]},a.id)})}),t==="prediction"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-6",children:"Prédictions Temporelles"}),l.jsx(Jg,{width:"100%",height:350,children:l.jsxs(YPe,{data:r,children:[l.jsx("defs",{children:l.jsxs("linearGradient",{id:"confidenceGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"5%",stopColor:"#8B5CF6",stopOpacity:.3}),l.jsx("stop",{offset:"95%",stopColor:"#8B5CF6",stopOpacity:.05})]})}),l.jsx(gb,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),l.jsx(Td,{dataKey:"time",stroke:"#6B7280"}),l.jsx(ou,{yAxisId:"left",stroke:"#6B7280"}),l.jsx(ou,{yAxisId:"right",orientation:"right",stroke:"#8B5CF6"}),l.jsx(as,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #E5E7EB",borderRadius:"8px"}}),l.jsx(Hc,{}),l.jsx(cs,{yAxisId:"right",type:"monotone",dataKey:"confidence",stroke:"#8B5CF6",fill:"url(#confidenceGradient)",name:"Confiance %"}),l.jsx(Hh,{yAxisId:"left",type:"monotone",dataKey:"actual",stroke:"#3B82F6",strokeWidth:3,dot:{fill:"#3B82F6",r:6},name:"Réel"}),l.jsx(Hh,{yAxisId:"left",type:"monotone",dataKey:"predicted",stroke:"#EC4899",strokeWidth:3,strokeDasharray:"5 5",dot:{fill:"#EC4899",r:6},name:"Prédit"})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx(Mie,{className:"w-8 h-8 text-green-600"}),l.jsx("span",{className:"text-2xl font-bold text-green-600",children:"94.7%"})]}),l.jsx("h5",{className:"font-semibold text-gray-800 dark:text-white",children:"Précision Modèle"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Sur 1000 prédictions"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx(il,{className:"w-8 h-8 text-blue-600"}),l.jsx("span",{className:"text-2xl font-bold text-blue-600",children:"87.3%"})]}),l.jsx("h5",{className:"font-semibold text-gray-800 dark:text-white",children:"Confiance Moyenne"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Prochaines 6 heures"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 rounded-xl p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx(ga,{className:"w-8 h-8 text-purple-600"}),l.jsx("span",{className:"text-2xl font-bold text-purple-600",children:"2.4s"})]}),l.jsx("h5",{className:"font-semibold text-gray-800 dark:text-white",children:"Temps Calcul"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Moyenne par prédiction"})]})]})]}),t==="risk"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-8",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-6",children:"Matrice des Risques"}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"grid grid-cols-5 gap-2",children:Array.from({length:25},(a,p)=>{const g=Math.floor(p/5),v=p%5,w=(g+v)/8,T=w>.7?"bg-gradient-to-br from-red-500 to-red-600":w>.5?"bg-gradient-to-br from-yellow-500 to-yellow-600":"bg-gradient-to-br from-green-500 to-green-600",A=n.find(I=>{const P=Math.floor(I.probability/20),D=Math.floor(I.impact/20);return P===4-g&&D===v});return l.jsx("div",{className:`h-24 ${T} rounded-lg flex items-center justify-center text-white font-medium text-sm cursor-pointer hover:opacity-80 transition-opacity`,children:A&&A.topic},p)})}),l.jsxs("div",{className:"absolute -left-20 top-0 bottom-0 flex flex-col justify-around text-sm text-gray-500 dark:text-gray-400",children:[l.jsx("span",{children:"Très élevé"}),l.jsx("span",{children:"Élevé"}),l.jsx("span",{children:"Moyen"}),l.jsx("span",{children:"Faible"}),l.jsx("span",{children:"Très faible"})]}),l.jsxs("div",{className:"mt-4 flex justify-around text-sm text-gray-500 dark:text-gray-400",children:[l.jsx("span",{children:"Très faible"}),l.jsx("span",{children:"Faible"}),l.jsx("span",{children:"Moyen"}),l.jsx("span",{children:"Élevé"}),l.jsx("span",{children:"Très élevé"})]})]}),l.jsxs("div",{className:"mt-6 text-center",children:[l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Impact →"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 transform -rotate-90 absolute left-0 top-1/2",children:"← Probabilité"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-6",children:"Détails des Risques"}),l.jsx("div",{className:"space-y-4",children:n.map(a=>{const p=a.probability*a.impact/100,g=p>60?"red":p>30?"yellow":"green";return l.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h5",{className:"font-semibold text-gray-800 dark:text-white",children:a.topic}),l.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${g==="red"?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":g==="yellow"?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300"}`,children:["Risque ",p>60?"Élevé":p>30?"Moyen":"Faible"]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Probabilité"}),l.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[l.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full bg-gradient-to-r ${a.probability>70?"from-red-500 to-red-600":a.probability>40?"from-yellow-500 to-yellow-600":"from-green-500 to-green-600"}`,style:{width:`${a.probability}%`}})}),l.jsxs("span",{className:"text-sm font-medium",children:[a.probability,"%"]})]})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Impact"}),l.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[l.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full bg-gradient-to-r ${a.impact>70?"from-red-500 to-red-600":a.impact>40?"from-yellow-500 to-yellow-600":"from-green-500 to-green-600"}`,style:{width:`${a.impact}%`}})}),l.jsxs("span",{className:"text-sm font-medium",children:[a.impact,"%"]})]})]})]}),l.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3",children:l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[l.jsx("span",{className:"font-medium",children:"Mitigation:"})," ",a.mitigation]})})]},a.topic)})})]})]}),t==="pattern"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-6",children:"Modèles Détectés"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:i.map(a=>l.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-6",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h5",{className:"font-semibold text-gray-800 dark:text-white",children:a.pattern}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[a.occurrences," occurrences détectées"]})]}),l.jsx("div",{className:`p-2 rounded-lg ${a.trend==="increasing"?"bg-red-100 dark:bg-red-900/30":a.trend==="decreasing"?"bg-green-100 dark:bg-green-900/30":"bg-gray-100 dark:bg-gray-700"}`,children:a.trend==="increasing"?l.jsx(ii,{className:"w-5 h-5 text-red-600"}):a.trend==="decreasing"?l.jsx(Qv,{className:"w-5 h-5 text-green-600"}):l.jsx(ds,{className:"w-5 h-5 text-gray-600"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Précision de détection"}),l.jsxs("span",{className:"font-medium",children:[a.accuracy,"%"]})]}),l.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600",style:{width:`${a.accuracy}%`}})})]}),l.jsx("div",{className:"pt-3 border-t border-gray-200 dark:border-gray-700",children:l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Dernière détection il y a ",Math.floor(Math.random()*60)," minutes"]})})]})]},a.pattern))})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-6",children:"Chronologie des Modèles"}),l.jsx("div",{className:"space-y-4",children:i.map((a,p)=>l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-semibold",children:p+1})}),l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[l.jsx("h5",{className:"font-medium text-gray-800 dark:text-white",children:a.pattern}),l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Détecté ",a.occurrences," fois avec ",a.accuracy,"% de précision"]})]})})]}),p<i.length-1&&l.jsx("div",{className:"absolute left-6 top-12 bottom-0 w-0.5 bg-gray-300 dark:bg-gray-600"})]},a.pattern))})]})]}),t==="anomaly"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Détection d'Anomalies"}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),l.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Analyse en temps réel"})]})]}),l.jsx("div",{className:"space-y-4",children:o.map(a=>{const p={high:"from-red-500 to-red-600",medium:"from-yellow-500 to-yellow-600",low:"from-blue-500 to-blue-600"},g={high:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",medium:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",low:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800"};return l.jsx("div",{className:`border rounded-lg p-4 ${g[a.severity]}`,children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("div",{className:`w-10 h-10 rounded-lg bg-gradient-to-br ${p[a.severity]} flex items-center justify-center`,children:l.jsx(Mh,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h5",{className:"font-semibold text-gray-800 dark:text-white",children:a.type}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a.description}),l.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500 dark:text-gray-400",children:[l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(ga,{className:"w-3 h-3"}),l.jsx("span",{children:a.time})]}),l.jsxs("span",{className:"flex items-center space-x-1",children:[l.jsx(od,{className:"w-3 h-3"}),l.jsx("span",{children:a.location})]})]})]})]}),l.jsx("button",{className:"text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-3 py-1 rounded-lg transition-colors text-sm",children:"Analyser"})]})},a.id)})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-4",children:"Distribution par Type"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm",children:"Volume spike"}),l.jsx("span",{className:"font-medium",children:"45%"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm",children:"Sentiment shift"}),l.jsx("span",{className:"font-medium",children:"30%"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm",children:"New actor"}),l.jsx("span",{className:"font-medium",children:"25%"})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-4",children:"Taux de Détection"}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-4xl font-bold text-purple-600",children:"96.3%"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Précision globale"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-4",children:"Temps de Réponse"}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-4xl font-bold text-green-600",children:"0.8s"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Moyenne détection"})]})]})]})]})]})}function TLe(){const[t,e]=Y.useState(null),[r,n]=Y.useState("7d"),i=[{id:1,name:"Radio Okapi",type:"news",credibility:92,volume:450,influence:85,reach:125e4,avgEngagement:3.2,status:"active",lastActive:"5 min"},{id:2,name:"Congo News Agency",type:"news",credibility:88,volume:380,influence:75,reach:98e4,avgEngagement:2.8,status:"active",lastActive:"12 min"},{id:3,name:"Facebook Pages",type:"social",credibility:45,volume:1200,influence:65,reach:345e4,avgEngagement:5.6,status:"active",lastActive:"1 min"},{id:4,name:"Twitter Accounts",type:"social",credibility:52,volume:890,influence:55,reach:21e5,avgEngagement:4.2,status:"active",lastActive:"2 min"},{id:5,name:"WhatsApp Groups",type:"social",credibility:30,volume:2e3,influence:45,reach:89e4,avgEngagement:8.9,status:"monitoring",lastActive:"8 min"},{id:6,name:"Blogs Indépendants",type:"blog",credibility:65,volume:320,influence:40,reach:45e4,avgEngagement:1.8,status:"active",lastActive:"45 min"}],o=[{platform:"Facebook",speed:95,reach:92,accuracy:45,engagement:88},{platform:"Twitter",speed:85,reach:78,accuracy:52,engagement:72},{platform:"News",speed:60,reach:85,accuracy:88,engagement:65},{platform:"Forums",speed:40,reach:45,accuracy:70,engagement:82}],u={Facebook:[{name:"Texte",value:40,color:"#3B82F6"},{name:"Image",value:35,color:"#10B981"},{name:"Vidéo",value:20,color:"#F59E0B"},{name:"Lien",value:5,color:"#EF4444"}],Twitter:[{name:"Texte",value:60,color:"#3B82F6"},{name:"Image",value:25,color:"#10B981"},{name:"Vidéo",value:10,color:"#F59E0B"},{name:"Lien",value:5,color:"#EF4444"}]};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Analyse des Sources"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Performance et fiabilité des sources d'information"})]}),l.jsxs("select",{value:r,onChange:a=>n(a.target.value),className:"px-4 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"24h",children:"24 heures"}),l.jsx("option",{value:"7d",children:"7 jours"}),l.jsx("option",{value:"30d",children:"30 jours"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(a=>{const p=gDe(a.type);return l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm hover:shadow-md transition-all p-6 cursor-pointer",onClick:()=>e(a),children:[l.jsx("div",{className:"flex items-start justify-between mb-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-xl flex items-center justify-center",children:l.jsx(p,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white",children:a.name}),l.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium mt-1 ${xDe(a.status)}`,children:a.status==="active"?"Actif":"Surveillance"})]})]})}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Crédibilité"}),l.jsxs("span",{className:`font-medium ${a.credibility>=70?"text-green-600":a.credibility>=50?"text-yellow-600":"text-red-600"}`,children:[a.credibility,"%"]})]}),l.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full transition-all duration-500 ${a.credibility>=70?"bg-green-500":a.credibility>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${a.credibility}%`}})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Volume"}),l.jsx("p",{className:"font-semibold text-gray-800 dark:text-white",children:a.volume})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Influence"}),l.jsxs("p",{className:"font-semibold text-gray-800 dark:text-white",children:[a.influence,"%"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Portée"}),l.jsxs("p",{className:"font-semibold text-gray-800 dark:text-white",children:[(a.reach/1e6).toFixed(1),"M"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Engagement"}),l.jsxs("p",{className:"font-semibold text-gray-800 dark:text-white",children:[a.avgEngagement,"%"]})]})]}),l.jsxs("div",{className:"pt-3 border-t border-gray-200 dark:border-gray-700 text-sm text-gray-500 dark:text-gray-400",children:["Dernière activité: ",a.lastActive]})]})]},a.id)})}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-6",children:"Comparaison des Plateformes"}),l.jsx("div",{className:"space-y-6",children:o.map(a=>l.jsxs("div",{className:"space-y-4",children:[l.jsx("h5",{className:"font-medium text-gray-800 dark:text-white",children:a.platform}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(a).filter(([p])=>p!=="platform").map(([p,g])=>l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2 capitalize",children:p}),l.jsxs("div",{className:"relative",children:[l.jsxs("svg",{className:"w-20 h-20 mx-auto",children:[l.jsx("circle",{cx:"40",cy:"40",r:"35",stroke:"currentColor",strokeWidth:"6",fill:"none",className:"text-gray-200 dark:text-gray-700"}),l.jsx("circle",{cx:"40",cy:"40",r:"35",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeDasharray:`${g*2.2} 220`,strokeDashoffset:"0",className:"text-blue-500 transform -rotate-90 origin-center transition-all duration-1000"})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsxs("span",{className:"text-lg font-bold text-gray-800 dark:text-white",children:[g,"%"]})})]})]},p))})]},a.platform))})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Object.entries(u).map(([a,p])=>l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-6",children:["Distribution de Contenu - ",a]}),l.jsx(Jg,{width:"100%",height:250,children:l.jsxs(h3,{children:[l.jsx(fc,{data:p,cx:"50%",cy:"50%",innerRadius:60,outerRadius:90,paddingAngle:5,dataKey:"value",children:p.map((g,v)=>l.jsx(Hp,{fill:g.color},`cell-${v}`))}),l.jsx(as,{})]})}),l.jsx("div",{className:"grid grid-cols-2 gap-2 mt-4",children:p.map(g=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:g.color}}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[g.name," (",g.value,"%)"]})]},g.name))})]},a))}),t&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:t.name}),l.jsx("button",{onClick:()=>e(null),className:"text-gray-400 hover:text-gray-600",children:l.jsx(no,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Performance Globale"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm",children:"Crédibilité"}),l.jsxs("span",{className:"font-medium",children:[t.credibility,"%"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm",children:"Volume quotidien"}),l.jsx("span",{className:"font-medium",children:t.volume})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm",children:"Score d'influence"}),l.jsxs("span",{className:"font-medium",children:[t.influence,"%"]})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Engagement"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm",children:"Portée totale"}),l.jsxs("span",{className:"font-medium",children:[(t.reach/1e6).toFixed(1),"M"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm",children:"Taux moyen"}),l.jsxs("span",{className:"font-medium",children:[t.avgEngagement,"%"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm",children:"Croissance"}),l.jsx("span",{className:"font-medium text-green-600",children:"+12.5%"})]})]})]})]}),l.jsxs("div",{className:"flex space-x-4 pt-6 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("button",{className:"flex-1 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Configurer alertes"}),l.jsx("button",{className:"flex-1 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Voir historique"})]})]})]})})]})}const bn=[{id:"acc1",platform:"social_media",username:"info_diffuseur",displayName:"InfoDiffuseur RDC",profileUrl:"https://twitter.com/info_diffuseur",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=info_diffuseur",verified:!0,followerCount:125e3,credibilityScore:.85,botProbability:.15,accountCreatedAt:"2019-03-15T00:00:00Z",previousActivity:{subjects:["elections2023","cobalt_mining","humanitarian_crisis"],narratives:["transparency","economic_development","human_rights"]}},{id:"acc2",platform:"news",username:"radiookapi",displayName:"Radio Okapi",profileUrl:"https://radiookapi.net",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=radiookapi",verified:!0,followerCount:45e4,credibilityScore:.95,botProbability:.02,accountCreatedAt:"2010-01-01T00:00:00Z"},{id:"acc3",platform:"social_media",username:"congo_activist",displayName:"Activiste Congo",profileUrl:"https://facebook.com/congo_activist",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=congo_activist",verified:!1,followerCount:35e3,credibilityScore:.65,botProbability:.25,accountCreatedAt:"2022-06-10T00:00:00Z"},{id:"acc4",platform:"messaging_app",username:"whatsapp_group_23",displayName:"Groupe WhatsApp Kinshasa Info",profileUrl:"whatsapp://group/23",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=whatsapp_group_23",verified:!1,followerCount:256,credibilityScore:.45,botProbability:.1},{id:"acc5",platform:"forum",username:"anonymous_leaker",displayName:"Anonymous RDC",profileUrl:"https://forum.example.com/u/anonymous_leaker",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=anonymous_leaker",verified:!1,followerCount:8900,credibilityScore:.55,botProbability:.35},{id:"acc6",platform:"social_media",username:"journaliste_kin",displayName:"Journaliste Kinshasa",profileUrl:"https://twitter.com/journaliste_kin",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=journaliste_kin",verified:!0,followerCount:78e3,credibilityScore:.88,botProbability:.05,accountCreatedAt:"2018-07-22T00:00:00Z"},{id:"acc7",platform:"social_media",username:"bot_suspect_123",displayName:"Citoyen Congolais",profileUrl:"https://twitter.com/bot_suspect_123",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=bot_suspect_123",verified:!1,followerCount:1500,credibilityScore:.25,botProbability:.85,accountCreatedAt:"2024-01-15T00:00:00Z"},{id:"acc8",platform:"social_media",username:"marie_lubumbashi",displayName:"Marie Mwamba",profileUrl:"https://facebook.com/marie_lubumbashi",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=marie_lubumbashi",verified:!1,followerCount:12400,credibilityScore:.72,botProbability:.15,accountCreatedAt:"2020-11-03T00:00:00Z"},{id:"acc9",platform:"news",username:"rfi_afrique",displayName:"RFI Afrique",profileUrl:"https://twitter.com/rfi_afrique",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=rfi_afrique",verified:!0,followerCount:89e4,credibilityScore:.92,botProbability:.01,accountCreatedAt:"2009-03-01T00:00:00Z"},{id:"acc10",platform:"social_media",username:"influence_net_rdc",displayName:"Réseau Influence RDC",profileUrl:"https://twitter.com/influence_net_rdc",profileImageUrl:"https://api.dicebear.com/7.x/avataaars/svg?seed=influence_net_rdc",verified:!1,followerCount:45e3,credibilityScore:.4,botProbability:.7,accountCreatedAt:"2023-08-14T00:00:00Z"}],SLe=[{id:"subj1",title:"Rumeurs sur la hausse des prix du carburant",description:"Des rumeurs circulent sur une augmentation imminente de 50% des prix du carburant, créant la panique dans plusieurs villes.",category:"Économie",tags:["carburant","inflation","rumeur","panique"],status:"viral",sentiment:"negative",createdAt:"2024-01-20T08:00:00Z",firstSeenAt:"2024-01-20T06:30:00Z",lastActivityAt:"2024-01-21T14:30:00Z",totalReach:45e4,spreadVelocity:85.5,engagementRate:.23,thumbnailUrl:"https://picsum.photos/400/300?random=1"},{id:"subj2",title:"Fausses allégations de fraude électorale",description:"Propagation de fausses informations concernant des irrégularités dans le processus électoral.",category:"Politique",tags:["élections","désinformation","politique","fraude"],status:"spreading",sentiment:"negative",createdAt:"2024-01-19T10:00:00Z",firstSeenAt:"2024-01-19T09:00:00Z",lastActivityAt:"2024-01-21T12:00:00Z",totalReach:28e4,spreadVelocity:62.3,engagementRate:.34},{id:"subj3",title:"Campagne positive sur la vaccination",description:"Initiative de sensibilisation sur l'importance de la vaccination contre la rougeole.",category:"Santé",tags:["vaccination","santé publique","sensibilisation","rougeole"],status:"spreading",sentiment:"positive",createdAt:"2024-01-18T14:00:00Z",firstSeenAt:"2024-01-18T13:00:00Z",lastActivityAt:"2024-01-21T10:00:00Z",totalReach:18e4,spreadVelocity:45.2,engagementRate:.41},{id:"subj4",title:"Tensions ethniques exagérées",description:"Amplification de tensions mineures entre communautés, créant un climat de méfiance.",category:"Sécurité",tags:["tensions","ethnique","désinformation","sécurité"],status:"emerging",sentiment:"negative",createdAt:"2024-01-21T06:00:00Z",firstSeenAt:"2024-01-21T05:30:00Z",lastActivityAt:"2024-01-21T15:00:00Z",totalReach:45e3,spreadVelocity:72.1,engagementRate:.29},{id:"subj5",title:"Success story: Jeunes entrepreneurs congolais",description:"Histoires inspirantes de jeunes entrepreneurs réussissant dans le secteur tech.",category:"Économie",tags:["entrepreneuriat","jeunesse","tech","inspiration"],status:"spreading",sentiment:"positive",createdAt:"2024-01-17T09:00:00Z",firstSeenAt:"2024-01-17T08:00:00Z",lastActivityAt:"2024-01-21T08:00:00Z",totalReach:95e3,spreadVelocity:38.7,engagementRate:.52},{id:"subj6",title:"Controverse autour du projet minier Kamoa-Kakula",description:"Débat intense sur l'impact environnemental et les bénéfices économiques du projet minier.",category:"Économie",tags:["mines","environnement","économie","cuivre","Kamoa"],status:"viral",sentiment:"mixed",createdAt:"2024-01-16T12:00:00Z",firstSeenAt:"2024-01-16T11:30:00Z",lastActivityAt:"2024-01-21T16:30:00Z",totalReach:68e4,spreadVelocity:92.3,engagementRate:.67,thumbnailUrl:"https://picsum.photos/400/300?random=6"},{id:"subj7",title:"Théorie du complot: 5G et contrôle des populations",description:"Diffusion de théories conspirationnistes sur la technologie 5G et ses prétendus effets.",category:"Technologie",tags:["5G","conspirations","santé","télécommunications"],status:"spreading",sentiment:"negative",createdAt:"2024-01-15T18:00:00Z",firstSeenAt:"2024-01-15T17:45:00Z",lastActivityAt:"2024-01-21T13:20:00Z",totalReach:156e3,spreadVelocity:58.9,engagementRate:.43},{id:"subj8",title:"Campagne de sensibilisation anti-corruption",description:"Initiative citoyenne pour promouvoir la transparence et lutter contre la corruption.",category:"Politique",tags:["corruption","transparence","citoyenneté","gouvernance"],status:"spreading",sentiment:"positive",createdAt:"2024-01-14T10:00:00Z",firstSeenAt:"2024-01-14T09:30:00Z",lastActivityAt:"2024-01-21T11:45:00Z",totalReach:234e3,spreadVelocity:66.1,engagementRate:.58},{id:"subj9",title:"Rumeurs sur la fermeture d'universités publiques",description:"Fausses informations sur la fermeture imminente d'universités publiques créant la panique.",category:"Éducation",tags:["universités","éducation","fermeture","étudiant"],status:"declining",sentiment:"negative",createdAt:"2024-01-12T14:00:00Z",firstSeenAt:"2024-01-12T13:45:00Z",lastActivityAt:"2024-01-20T09:15:00Z",totalReach:89e3,spreadVelocity:25.4,engagementRate:.31},{id:"subj10",title:"Découverte archéologique majeure au Kasaï",description:"Annonce d'une découverte archéologique importante générant enthousiasme et fierté nationale.",category:"Culture",tags:["archéologie","Kasaï","découverte","patrimoine","histoire"],status:"emerging",sentiment:"positive",createdAt:"2024-01-21T08:00:00Z",firstSeenAt:"2024-01-21T07:30:00Z",lastActivityAt:"2024-01-21T17:00:00Z",totalReach:67e3,spreadVelocity:78.2,engagementRate:.72}],dX=[{id:"evt1",subjectId:"subj1",timestamp:"2024-01-20T06:30:00Z",source:bn[4],content:"🚨 URGENT: Le gouvernement prépare une augmentation de 50% du prix du carburant dès lundi prochain! Partagez massivement!",type:"origin",reach:2500,engagement:{likes:450,shares:890,comments:234},sentiment:"negative",location:{country:"RDC",city:"Kinshasa"}},{id:"evt2",subjectId:"subj1",timestamp:"2024-01-20T08:15:00Z",source:bn[2],content:"Les prix du carburant vont exploser! Il faut se mobiliser contre cette décision injuste! #NonALaugmentation",type:"amplification",reach:35e3,engagement:{likes:4500,shares:2300,comments:890},sentiment:"negative",location:{country:"RDC",city:"Kinshasa"}},{id:"evt3",subjectId:"subj1",timestamp:"2024-01-20T10:00:00Z",source:bn[0],content:"Des sources confirment les rumeurs sur l'augmentation du carburant. Les stations-service déjà prises d'assaut.",type:"amplification",reach:125e3,engagement:{likes:15e3,shares:8900,comments:3400},sentiment:"negative",location:{country:"RDC",region:"Kinshasa"}},{id:"evt4",subjectId:"subj1",timestamp:"2024-01-20T14:30:00Z",source:bn[1],content:"DÉMENTI OFFICIEL: Le ministère de l'Économie dément formellement toute augmentation prévue des prix du carburant.",type:"debunk",reach:2e5,engagement:{likes:8e3,shares:12e3,comments:2100},sentiment:"neutral",location:{country:"RDC"}},{id:"evt5",subjectId:"subj2",timestamp:"2024-01-19T09:00:00Z",source:bn[3],content:"Photo exclusive: Des bulletins pré-remplis découverts dans un bureau de vote! La preuve de la fraude!",type:"origin",reach:256,engagement:{likes:0,shares:189,comments:0},sentiment:"negative",location:{country:"RDC",city:"Lubumbashi"}},{id:"evt6",subjectId:"subj2",timestamp:"2024-01-19T11:30:00Z",source:bn[2],content:"SCANDALE: Des preuves de fraude électorale massive circulent. Le peuple ne se laissera pas faire!",type:"amplification",reach:35e3,engagement:{likes:6700,shares:4500,comments:1200},sentiment:"negative"},{id:"evt7",subjectId:"subj3",timestamp:"2024-01-18T13:00:00Z",source:bn[1],content:"Lancement de la campagne nationale de vaccination contre la rougeole. Protégeons nos enfants!",type:"origin",reach:18e4,engagement:{likes:12e3,shares:5600,comments:890},sentiment:"positive",location:{country:"RDC"}},{id:"evt8",subjectId:"subj3",timestamp:"2024-01-18T15:30:00Z",source:bn[5],content:"Excellente initiative du ministère de la santé. La vaccination est cruciale pour nos enfants. #VaccinationRDC",type:"amplification",reach:78e3,engagement:{likes:8900,shares:3400,comments:567},sentiment:"positive",location:{country:"RDC",city:"Kinshasa"}},{id:"evt9",subjectId:"subj6",timestamp:"2024-01-16T11:30:00Z",source:bn[2],content:"Le projet Kamoa-Kakula détruit notre environnement! Les communautés locales ne voient aucun bénéfice!",type:"origin",reach:35e3,engagement:{likes:4500,shares:6700,comments:1200},sentiment:"negative",location:{country:"RDC",region:"Lualaba"}},{id:"evt10",subjectId:"subj6",timestamp:"2024-01-16T14:00:00Z",source:bn[0],content:"Kamoa-Kakula génère des milliers d'emplois et apporte des devises. Il faut équilibrer développement et environnement.",type:"contradicts",reach:125e3,engagement:{likes:15600,shares:8900,comments:2340},sentiment:"mixed",location:{country:"RDC"}},{id:"evt11",subjectId:"subj6",timestamp:"2024-01-16T18:45:00Z",source:bn[8],content:"ANALYSE: Le projet minier Kamoa-Kakula entre développement économique et préoccupations environnementales",type:"fact_check",reach:89e4,engagement:{likes:45e3,shares:23e3,comments:8900},sentiment:"neutral",location:{country:"France"}},{id:"evt12",subjectId:"subj6",timestamp:"2024-01-17T09:15:00Z",source:bn[9],content:"Les mines de cuivre sont l'avenir de la RDC! Ne laissons pas les écolos détruire notre économie! #DéveloppementRDC",type:"amplification",reach:45e3,engagement:{likes:3200,shares:8900,comments:456},sentiment:"positive",location:{country:"RDC"}},{id:"evt13",subjectId:"subj7",timestamp:"2024-01-15T17:45:00Z",source:bn[6],content:"ATTENTION! La 5G va contrôler vos pensées! Les antennes émettent des ondes dangereuses! Réveillez-vous!",type:"origin",reach:1500,engagement:{likes:234,shares:456,comments:89},sentiment:"negative",location:{country:"RDC",city:"Kinshasa"}},{id:"evt14",subjectId:"subj7",timestamp:"2024-01-15T20:30:00Z",source:bn[3],content:"Une amie médecin m'a dit que la 5G cause le cancer. On doit arrêter ça avant qu'il soit trop tard!",type:"amplification",reach:256,engagement:{likes:0,shares:189,comments:0},sentiment:"negative",location:{country:"RDC",city:"Kinshasa"}},{id:"evt15",subjectId:"subj7",timestamp:"2024-01-16T08:00:00Z",source:bn[5],content:"FACT-CHECK: Aucune preuve scientifique ne lie la 5G au contrôle mental. Les ondes sont régulées et sûres.",type:"debunk",reach:78e3,engagement:{likes:12e3,shares:4500,comments:890},sentiment:"neutral",location:{country:"RDC",city:"Kinshasa"}},{id:"evt16",subjectId:"subj8",timestamp:"2024-01-14T09:30:00Z",source:bn[7],content:"Lançons ensemble la campagne #TransparenceRDC! Chaque citoyen peut faire la différence contre la corruption.",type:"origin",reach:12400,engagement:{likes:2300,shares:4500,comments:678},sentiment:"positive",location:{country:"RDC",city:"Lubumbashi"}},{id:"evt17",subjectId:"subj8",timestamp:"2024-01-14T12:15:00Z",source:bn[0],content:"Bravo à cette initiative citoyenne! La transparence est la base d'une démocratie forte. #TransparenceRDC",type:"supports",reach:125e3,engagement:{likes:18e3,shares:12e3,comments:3400},sentiment:"positive",location:{country:"RDC"}},{id:"evt18",subjectId:"subj8",timestamp:"2024-01-14T16:45:00Z",source:bn[1],content:"La société civile lance une campagne de sensibilisation contre la corruption - Un élan citoyen prometteur",type:"amplification",reach:45e4,engagement:{likes:23e3,shares:15600,comments:5600},sentiment:"positive",location:{country:"RDC"}},{id:"evt19",subjectId:"subj10",timestamp:"2024-01-21T07:30:00Z",source:bn[1],content:"EXCLUSIF: Découverte d'artefacts vieux de 1000 ans au Kasaï - Une fenêtre sur notre riche passé",type:"origin",reach:45e4,engagement:{likes:34e3,shares:18e3,comments:6700},sentiment:"positive",location:{country:"RDC"}},{id:"evt20",subjectId:"subj10",timestamp:"2024-01-21T10:15:00Z",source:bn[5],content:"Quelle fierté! Cette découverte montre la richesse de notre patrimoine culturel. #PatrimoineRDC #Kasaï",type:"amplification",reach:78e3,engagement:{likes:12e3,shares:8900,comments:2100},sentiment:"positive",location:{country:"RDC",city:"Kinshasa"}},{id:"evt21",subjectId:"subj10",timestamp:"2024-01-21T14:30:00Z",source:bn[8],content:"RDC: Une découverte archéologique majeure révèle l'ancienneté des civilisations congolaises",type:"amplification",reach:89e4,engagement:{likes:56e3,shares:34e3,comments:12e3},sentiment:"positive",location:{country:"France"}}],ELe=[{id:"rel1",fromEventId:"evt1",toEventId:"evt2",type:"amplifies",strength:.9,confidence:.95,evidence:["Same narrative","Sequential timing","Content similarity"]},{id:"rel2",fromEventId:"evt2",toEventId:"evt3",type:"influences",strength:.85,confidence:.88},{id:"rel3",fromEventId:"evt3",toEventId:"evt4",type:"causes",strength:.95,confidence:.92,evidence:["Official response triggered by viral spread"]},{id:"rel4",fromEventId:"evt5",toEventId:"evt6",type:"amplifies",strength:.88,confidence:.9},{id:"rel5",fromEventId:"evt7",toEventId:"evt8",type:"supports",strength:.92,confidence:.95,evidence:["Positive reinforcement","Same topic","Supporting narrative"]},{id:"rel6",fromEventId:"evt9",toEventId:"evt10",type:"contradicts",strength:.85,confidence:.9,evidence:["Opposing viewpoints","Same subject","Direct contradiction"]},{id:"rel7",fromEventId:"evt10",toEventId:"evt11",type:"influences",strength:.75,confidence:.88,evidence:["Media coverage influenced by debate"]},{id:"rel8",fromEventId:"evt11",toEventId:"evt12",type:"causes",strength:.7,confidence:.82,evidence:["Reaction to factual analysis"]},{id:"rel9",fromEventId:"evt13",toEventId:"evt14",type:"amplifies",strength:.95,confidence:.92,evidence:["Same conspiracy theory","WhatsApp amplification"]},{id:"rel10",fromEventId:"evt14",toEventId:"evt15",type:"causes",strength:.88,confidence:.9,evidence:["Fact-check response to misinformation"]},{id:"rel11",fromEventId:"evt16",toEventId:"evt17",type:"supports",strength:.93,confidence:.95,evidence:["Support for citizen initiative"]},{id:"rel12",fromEventId:"evt17",toEventId:"evt18",type:"amplifies",strength:.9,confidence:.93,evidence:["Media amplification of campaign"]},{id:"rel13",fromEventId:"evt19",toEventId:"evt20",type:"amplifies",strength:.85,confidence:.88,evidence:["Social media amplification of news"]},{id:"rel14",fromEventId:"evt19",toEventId:"evt21",type:"influences",strength:.8,confidence:.85,evidence:["International media coverage"]},{id:"rel15",fromEventId:"evt4",toEventId:"evt15",type:"influences",strength:.6,confidence:.7,evidence:["Both are fact-checking efforts"]}],jLe=[{id:"ms1",timestamp:"2024-01-20T06:30:00Z",title:"Origine de la rumeur",description:"Première apparition de la rumeur sur les prix du carburant",significance:"major",eventIds:["evt1"]},{id:"ms2",timestamp:"2024-01-20T10:00:00Z",title:"Viralité atteinte",description:"La rumeur devient virale avec plus de 100k personnes atteintes",significance:"critical",eventIds:["evt3"]},{id:"ms3",timestamp:"2024-01-20T14:30:00Z",title:"Démenti officiel",description:"Le gouvernement publie un démenti officiel",significance:"critical",eventIds:["evt4"]}],ALe=[{id:"phase1",name:"Émergence",startTime:"2024-01-20T06:30:00Z",endTime:"2024-01-20T08:00:00Z",characteristics:{velocity:25.5,sentiment:"negative",dominantPlatforms:["forum","messaging_app"],keyNarratives:["Augmentation imminente","Source gouvernementale"]}},{id:"phase2",name:"Amplification",startTime:"2024-01-20T08:00:00Z",endTime:"2024-01-20T12:00:00Z",characteristics:{velocity:85.5,sentiment:"negative",dominantPlatforms:["social_media"],keyNarratives:["Panique","Mobilisation","Pénurie"]}},{id:"phase3",name:"Contre-narrative",startTime:"2024-01-20T12:00:00Z",characteristics:{velocity:45.2,sentiment:"mixed",dominantPlatforms:["news","social_media"],keyNarratives:["Démenti","Fact-checking","Apaisement"]}}],NLe=[{id:"pred1",subjectId:"subj1",createdAt:"2024-01-21T15:00:00Z",timeHorizon:"24h",predictions:{reachEstimate:{min:5e5,max:6e5,expected:55e4},sentimentShift:{direction:"improving",magnitude:.3},viralProbability:.25,declineTime:"2024-01-22T18:00:00Z"},confidence:"high",factors:["Démenti officiel publié","Médias traditionnels ont clarifié","Pas de hausse réelle observée"],recommendations:["Continuer la communication officielle","Surveiller les nouveaux foyers de désinformation","Engager les influenceurs pour diffuser la vérité"]},{id:"pred2",subjectId:"subj2",createdAt:"2024-01-21T15:00:00Z",timeHorizon:"7d",predictions:{reachEstimate:{min:4e5,max:8e5,expected:6e5},sentimentShift:{direction:"worsening",magnitude:.2},viralProbability:.65,peakTime:"2024-01-23T12:00:00Z"},confidence:"medium",factors:["Période électorale sensible","Absence de réponse coordonnée","Multiples sources d'amplification"]}],CLe={subjectId:"subj1",rootCauses:[{id:"cause1",type:"external_factor",description:"Instabilité économique et inflation récente",confidence:.85,evidence:["Inflation de 15% au cours des 6 derniers mois","Plusieurs augmentations de prix récentes"]},{id:"cause2",type:"actor",description:"Acteurs malveillants cherchant à déstabiliser",timestamp:"2024-01-20T06:00:00Z",confidence:.7,evidence:["Compte anonyme créé récemment","Pattern de désinformation similaire observé précédemment"]}],effects:[{id:"effect1",type:"behavioral",description:"Ruée vers les stations-service",measuredImpact:{metric:"Files d'attente",value:500,change:400},affectedGroups:["Automobilistes","Transporteurs"]},{id:"effect2",type:"economic",description:"Perturbation temporaire du marché",measuredImpact:{metric:"Ventes de carburant",value:150,change:50}},{id:"effect3",type:"sentiment",description:"Méfiance accrue envers les autorités",affectedGroups:["Population générale"]}],chains:[{id:"chain1",causes:["cause1","cause2"],effects:["effect1","effect2"],strength:.88,timeDelay:2},{id:"chain2",causes:["cause2"],effects:["effect3"],strength:.75,timeDelay:24}]},PLe=[{id:"raw1",subjectId:"subj1",source:bn[4],timestamp:"2024-01-20T06:30:00Z",rawContent:`🚨🚨🚨 URGENT URGENT URGENT 🚨🚨🚨

Je viens de recevoir l'info d'une source sûre au ministère...

Le carburant va augmenter de 50% dès LUNDI!!!

Faites le plein maintenant avant qu'il ne soit trop tard!

Partagez massivement pour sauver vos proches!!! 🚗⛽💸`,processedContent:"Alerte urgente concernant une augmentation de 50% du prix du carburant prévue pour lundi, selon une source ministérielle non vérifiée.",language:"fr",hasMedia:!1,isOriginal:!0,metadata:{emojis_count:12,caps_percentage:.35,exclamation_count:9}},{id:"raw2",subjectId:"subj1",source:bn[2],timestamp:"2024-01-20T08:15:00Z",rawContent:`C'est confirmé! Les prix du carburant vont exploser! 

Mes amis à la pompe me disent qu'ils ont déjà reçu les nouveaux tarifs.

Il faut se mobiliser contre cette décision injuste qui va écraser le peuple!

#NonALaugmentation #CongoPauvre #Mobilisation`,language:"fr",hasMedia:!0,mediaUrls:["https://example.com/fake-fuel-price-image.jpg"],isOriginal:!1,parentId:"raw1",metadata:{hashtags:["#NonALaugmentation","#CongoPauvre","#Mobilisation"]}},{id:"raw3",subjectId:"subj6",source:bn[2],timestamp:"2024-01-16T11:30:00Z",rawContent:`SCANDALE à Kamoa-Kakula! 😡

Les entreprises étrangères pillent nos ressources pendant que nos enfants meurent de faim!

Où sont les emplois promis? Où sont les écoles et hôpitaux?

Tout ce qu'on voit c'est la DESTRUCTION de notre environnement! 🌍💔

#StopKamoa #JusticeEnvironnementale #RDCPillée`,processedContent:"Critique du projet minier Kamoa-Kakula accusé de pillage des ressources et de destruction environnementale.",language:"fr",hasMedia:!0,mediaUrls:["https://example.com/environmental-damage.jpg"],isOriginal:!0,metadata:{emojis_count:4,caps_percentage:.15,hashtags:["#StopKamoa","#JusticeEnvironnementale","#RDCPillée"]}},{id:"raw4",subjectId:"subj7",source:bn[6],timestamp:"2024-01-15T17:45:00Z",rawContent:`🚨 ALERTE MONDIALE 🚨

La 5G n'est PAS pour améliorer internet!

C'est pour CONTRÔLER VOS CERVEAUX! 🧠⚡

Ils peuvent:
- Lire vos pensées
- Modifier vos émotions
- Vous rendre malade
- Manipuler vos décisions

RÉVEILLEZ-VOUS AVANT QU'IL SOIT TROP TARD!

Partagez cette vérité que "ILS" ne veulent pas que vous sachiez!

#5GDanger #ContrôleMental #Réveil`,processedContent:"Théorie conspirationniste accusant la technologie 5G de contrôle mental et manipulation.",language:"fr",hasMedia:!1,isOriginal:!0,metadata:{emojis_count:6,caps_percentage:.45,exclamation_count:8,hashtags:["#5GDanger","#ContrôleMental","#Réveil"]}},{id:"raw5",subjectId:"subj8",source:bn[7],timestamp:"2024-01-14T09:30:00Z",rawContent:`Mes chers compatriotes 🇨🇩

Il est temps de dire NON à la corruption qui ronge notre beau pays!

Ensemble, lançons #TransparenceRDC - un mouvement citoyen pour:

✅ Dénoncer les pratiques corrompues
✅ Exiger la transparence dans la gestion publique
✅ Sensibiliser nos communautés
✅ Construire un Congo plus juste

Chaque voix compte! Chaque action compte!

Rejoignez le mouvement! 💪

#TransparenceRDC #AntiCorruption #CongoDemain`,processedContent:"Lancement d'une campagne citoyenne anti-corruption appelant à la transparence et à l'action collective.",language:"fr",hasMedia:!0,mediaUrls:["https://example.com/transparency-campaign.jpg"],isOriginal:!0,metadata:{emojis_count:6,hashtags:["#TransparenceRDC","#AntiCorruption","#CongoDemain"],checkmarks_count:4}},{id:"raw6",subjectId:"subj10",source:bn[1],timestamp:"2024-01-21T07:30:00Z",rawContent:`🏛️ DÉCOUVERTE HISTORIQUE AU KASAÏ! 🏛️

Nos équipes ont mis au jour des artefacts datant de plus de 1000 ans, témoignant de la richesse de nos civilisations ancestrales.

Cette découverte exceptionnelle comprend:
- Céramiques finement décorées
- Outils en métal sophistiqués
- Sculptures rituelles uniques
- Restes d'habitat organisé

Une fenêtre fascinante sur notre héritage culturel qui repositionne l'histoire de la région.

Prochainement: exposition au Musée National.

#PatrimoineRDC #Kasaï #HistoireCongolaise #Archéologie`,processedContent:"Annonce officielle d'une découverte archéologique majeure au Kasaï révélant l'ancienneté des civilisations locales.",language:"fr",hasMedia:!0,mediaUrls:["https://example.com/archaeological-discovery.jpg","https://example.com/artifacts-kasai.jpg"],isOriginal:!0,metadata:{emojis_count:4,hashtags:["#PatrimoineRDC","#Kasaï","#HistoireCongolaise","#Archéologie"],bullet_points:4}},{id:"raw7",subjectId:"subj3",source:bn[1],timestamp:"2024-01-18T13:00:00Z",rawContent:`🩺 CAMPAGNE NATIONALE DE VACCINATION 🩺

Lancement officiel de la campagne contre la rougeole dans toutes les provinces.

Objectifs:
- Vacciner 12 millions d'enfants de 6 mois à 15 ans
- Renforcer l'immunité collective
- Prévenir les épidémies

Centres de vaccination ouverts dans:
✅ Hôpitaux publics
✅ Centres de santé communautaires
✅ Écoles
✅ Unités mobiles

La vaccination est GRATUITE et SÛRE.

Protégeons ensemble nos enfants! 👶👧👦

#VaccinationRDC #SantéPublique #ProtégeonNosEnfants`,processedContent:"Annonce officielle du lancement de la campagne nationale de vaccination contre la rougeole.",language:"fr",hasMedia:!0,mediaUrls:["https://example.com/vaccination-campaign.jpg"],isOriginal:!0,metadata:{emojis_count:7,hashtags:["#VaccinationRDC","#SantéPublique","#ProtégeonNosEnfants"],checkmarks_count:4}}],Pw=(t,e)=>{const r=[],n=new Date("2024-01-21T15:00:00Z");for(let i=t;i>=0;i--){const o=new Date(n.getTime()-i*36e5),u=Math.random()*.4-.2,a=1+(t-i)/t*.5;r.push({timestamp:o.toISOString(),value:Math.round(e*a*(1+u))})}return r},ILe={subjectId:"subj1",period:"hourly",metrics:{reach:Pw(48,5e3),engagement:Pw(48,500),sentiment:Pw(48,-.5).map(t=>({...t,value:Math.max(-1,Math.min(1,t.value))})),velocity:Pw(48,30),platforms:[{platform:"social_media",percentage:45,count:202500},{platform:"messaging_app",percentage:30,count:135e3},{platform:"news",percentage:15,count:67500},{platform:"forum",percentage:10,count:45e3}]},topInfluencers:[bn[0],bn[1],bn[2]],viralMoments:[{id:"viral1",timestamp:"2024-01-20T10:00:00Z",triggerEventId:"evt3",peakReach:125e3,duration:4,amplificationFactor:12.5}]},MLe=t=>({subjectId:t,events:dX.filter(e=>e.subjectId===t),milestones:jLe,phases:ALe}),DLe=t=>PLe.filter(e=>e.subjectId===t),OLe=t=>NLe.filter(e=>e.subjectId===t);class RLe extends LT{constructor(){super(...arguments);Vl(this,"subjects",[...SLe]);Vl(this,"events",[...dX]);Vl(this,"accounts",[...bn]);Vl(this,"relationships",[...ELe])}async getSubjects(r){await this.simulateDelay();let n=[...this.subjects];if(r&&(r.category&&(n=n.filter(i=>i.category===r.category)),r.status&&(n=n.filter(i=>i.status===r.status)),r.sentiment&&(n=n.filter(i=>i.sentiment===r.sentiment)),r.search)){const i=r.search.toLowerCase();n=n.filter(o=>o.title.toLowerCase().includes(i)||o.description.toLowerCase().includes(i)||o.tags.some(u=>u.toLowerCase().includes(i)))}return n.sort((i,o)=>new Date(o.lastActivityAt).getTime()-new Date(i.lastActivityAt).getTime())}async getSubjectById(r){return await this.simulateDelay(),this.subjects.find(n=>n.id===r)||null}async getSubjectTimeline(r){return await this.simulateDelay(),MLe(r)}async getSpreadEvents(r){return await this.simulateDelay(),this.events.filter(n=>n.subjectId===r).sort((n,i)=>new Date(n.timestamp).getTime()-new Date(i.timestamp).getTime())}async getEventRelationships(r){await this.simulateDelay();const n=this.events.filter(i=>i.subjectId===r).map(i=>i.id);return this.relationships.filter(i=>n.includes(i.fromEventId)||n.includes(i.toEventId))}async getCauseEffectAnalysis(r){return await this.simulateDelay(),{...CLe,subjectId:r}}async getPredictions(r){return await this.simulateDelay(),OLe(r)}async getRawData(r,n=50){return await this.simulateDelay(),DLe(r).slice(0,n)}async getSubjectAnalytics(r){return await this.simulateDelay(),{...ILe,subjectId:r}}async getSourceAccounts(r){await this.simulateDelay();const n=this.events.filter(o=>o.subjectId===r).map(o=>o.source);return Array.from(new Map(n.map(o=>[o.id,o])).values())}async getCategories(){return await this.simulateDelay(),[...new Set(this.subjects.map(n=>n.category))].sort()}simulateNewEvent(r){const n=this.subjects.find(p=>p.id===r);if(!n)return null;const i=this.accounts[Math.floor(Math.random()*this.accounts.length)],o=["amplification","mutation","debunk"],u=o[Math.floor(Math.random()*o.length)],a={id:`evt_${Date.now()}`,subjectId:r,timestamp:new Date().toISOString(),source:i,content:`Nouvelle information concernant: ${n.title}`,type:u,reach:Math.floor(Math.random()*5e4)+1e3,engagement:{likes:Math.floor(Math.random()*5e3),shares:Math.floor(Math.random()*3e3),comments:Math.floor(Math.random()*1e3)},sentiment:["positive","negative","neutral"][Math.floor(Math.random()*3)],location:{country:"RDC",city:["Kinshasa","Lubumbashi","Goma","Kisangani"][Math.floor(Math.random()*4)]}};return this.events.push(a),n.lastActivityAt=new Date().toISOString(),n.totalReach+=a.reach,n.spreadVelocity=Math.min(100,n.spreadVelocity+Math.random()*5),a}updateSubjectStatus(r){const n=this.subjects.find(i=>i.id===r);n&&(n.spreadVelocity>80&&n.status!=="viral"?n.status="viral":n.spreadVelocity<20&&n.status!=="declining"&&(n.status="declining"))}}const Lc=new RLe,LLe=({onViewSubject:t})=>{const[e,r]=Y.useState([]),[n,i]=Y.useState(!0),[o,u]=Y.useState("all"),[a,p]=Y.useState("all"),[g,v]=Y.useState("all"),[w,T]=Y.useState(""),[A,I]=Y.useState([]);Y.useEffect(()=>{P()},[o,a,g,w]);const P=async()=>{i(!0);try{const[B,J]=await Promise.all([Lc.getSubjects({category:o!=="all"?o:void 0,status:a!=="all"?a:void 0,sentiment:g!=="all"?g:void 0,search:w||void 0}),Lc.getCategories()]);r(B),I(J)}catch(B){console.error("Error loading information spread data:",B)}finally{i(!1)}},D=B=>{switch(B){case"viral":return l.jsx(ii,{className:"w-5 h-5 text-red-500"});case"spreading":return l.jsx(ii,{className:"w-5 h-5 text-orange-500"});case"emerging":return l.jsx(oi,{className:"w-5 h-5 text-yellow-500"});case"declining":return l.jsx(Qv,{className:"w-5 h-5 text-blue-500"});default:return l.jsx(ga,{className:"w-5 h-5 text-gray-500"})}},L=B=>{switch(B){case"positive":return"text-green-600 bg-green-100 dark:bg-green-900/30";case"negative":return"text-red-600 bg-red-100 dark:bg-red-900/30";case"mixed":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/30";default:return"text-gray-600 bg-gray-100 dark:bg-gray-800"}},O=B=>({viral:"Viral",spreading:"En propagation",emerging:"Émergent",declining:"En déclin",dormant:"Dormant"})[B]||B,$=B=>B>=1e6?`${(B/1e6).toFixed(1)}M`:B>=1e3?`${(B/1e3).toFixed(1)}K`:B.toString(),G=B=>{const J=new Date(B),H=new Date().getTime()-J.getTime(),V=Math.floor(H/(1e3*60*60));if(V<1)return"Il y a moins d'une heure";if(V<24)return`Il y a ${V}h`;const se=Math.floor(V/24);return se===1?"Hier":`Il y a ${se} jours`};return l.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"px-6 py-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Analyse de Propagation d'Information"}),l.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(ro,{className:"w-4 h-4"}),"Actualiser"]})]}),l.jsxs("div",{className:"flex flex-wrap gap-4",children:[l.jsx("div",{className:"flex-1 min-w-[300px]",children:l.jsxs("div",{className:"relative",children:[l.jsx(iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Rechercher un sujet...",value:w,onChange:B=>T(B.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]})}),l.jsxs("select",{value:o,onChange:B=>u(B.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[l.jsx("option",{value:"all",children:"Toutes les catégories"}),A.map(B=>l.jsx("option",{value:B,children:B},B))]}),l.jsxs("select",{value:a,onChange:B=>p(B.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[l.jsx("option",{value:"all",children:"Tous les statuts"}),l.jsx("option",{value:"viral",children:"Viral"}),l.jsx("option",{value:"spreading",children:"En propagation"}),l.jsx("option",{value:"emerging",children:"Émergent"}),l.jsx("option",{value:"declining",children:"En déclin"}),l.jsx("option",{value:"dormant",children:"Dormant"})]}),l.jsxs("select",{value:g,onChange:B=>v(B.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[l.jsx("option",{value:"all",children:"Tous les sentiments"}),l.jsx("option",{value:"positive",children:"Positif"}),l.jsx("option",{value:"negative",children:"Négatif"}),l.jsx("option",{value:"neutral",children:"Neutre"}),l.jsx("option",{value:"mixed",children:"Mixte"})]})]})]})}),l.jsx("div",{className:"flex-1 overflow-auto p-6",children:n?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.length===0?l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucun sujet trouvé"})}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:e.map(B=>l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>t==null?void 0:t(B.id),children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[D(B.status),l.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:O(B.status)})]}),l.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${L(B.sentiment)}`,children:B.sentiment==="positive"?"Positif":B.sentiment==="negative"?"Négatif":B.sentiment==="mixed"?"Mixte":"Neutre"})]}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2 line-clamp-2",children:B.title}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 line-clamp-3",children:B.description}),l.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[B.tags.slice(0,3).map((J,W)=>l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-md text-xs",children:[l.jsx(qp,{className:"w-3 h-3"}),J]},W)),B.tags.length>3&&l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",B.tags.length-3]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"flex items-center justify-center gap-1 text-gray-500 dark:text-gray-400 mb-1",children:l.jsx(ea,{className:"w-4 h-4"})}),l.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:$(B.totalReach)}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Portée"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"flex items-center justify-center gap-1 text-gray-500 dark:text-gray-400 mb-1",children:l.jsx(ii,{className:"w-4 h-4"})}),l.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:B.spreadVelocity.toFixed(1)}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Vélocité"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"flex items-center justify-center gap-1 text-gray-500 dark:text-gray-400 mb-1",children:l.jsx(No,{className:"w-4 h-4"})}),l.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[(B.engagementRate*100).toFixed(1),"%"]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Engagement"})]})]}),l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[l.jsx(ga,{className:"w-3 h-3"}),G(B.lastActivityAt)]}),l.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400",children:[l.jsx("span",{className:"text-sm font-medium",children:"Voir détails"}),l.jsx(Jw,{className:"w-4 h-4"})]})]})]})},B.id))})})]})},zLe=({events:t,milestones:e,phases:r,height:n=400})=>{const i=Y.useRef(null),o=Y.useRef(null),[u,a]=Y.useState(null),[p,g]=Y.useState(1);Y.useEffect(()=>{if(!i.current||!o.current)return;const I=o.current.clientWidth,P={top:40,right:40,bottom:60,left:60},D=I-P.left-P.right,L=n-P.top-P.bottom;ni(i.current).selectAll("*").remove();const O=ni(i.current).attr("width",I).attr("height",n),$=O.append("g").attr("transform",`translate(${P.left},${P.top})`),G=cG([...t,...e],re=>new Date(re.timestamp)),B=LG().domain(G).range([0,D]),J=e0().domain([0,UC(t,re=>re.reach)||1]).range([L,0]),W=Ep().scaleExtent([.5,5]).translateExtent([[-100,-100],[I+100,n+100]]).on("zoom",re=>{$.attr("transform",re.transform),g(re.transform.k)});O.call(W);const H=O.append("defs");r.forEach((re,oe)=>{const ae=H.append("linearGradient").attr("id",`phase-gradient-${oe}`).attr("x1","0%").attr("x2","0%").attr("y1","0%").attr("y2","100%"),xe=re.characteristics.sentiment==="positive"?"#10b981":re.characteristics.sentiment==="negative"?"#ef4444":"#6b7280";ae.append("stop").attr("offset","0%").attr("stop-color",xe).attr("stop-opacity",.2),ae.append("stop").attr("offset","100%").attr("stop-color",xe).attr("stop-opacity",.05)}),r.forEach((re,oe)=>{const ae=B(new Date(re.startTime)),xe=re.endTime?B(new Date(re.endTime)):D;$.append("rect").attr("x",ae).attr("y",0).attr("width",xe-ae).attr("height",L).attr("fill",`url(#phase-gradient-${oe})`).attr("stroke","none"),$.append("text").attr("x",ae+(xe-ae)/2).attr("y",-10).attr("text-anchor","middle").attr("font-size","12px").attr("font-weight","bold").attr("fill","#6b7280").text(re.name)});const V=jDe(B).tickFormat(HM("%d/%m %H:%M"));$.append("g").attr("transform",`translate(0,${L})`).call(V).append("text").attr("x",D/2).attr("y",40).attr("text-anchor","middle").attr("fill","currentColor").text("Temps");const se=ADe(J).tickFormat(re=>{const oe=re;return oe>=1e6?`${(oe/1e6).toFixed(1)}M`:oe>=1e3?`${(oe/1e3).toFixed(1)}K`:oe.toString()});$.append("g").call(se).append("text").attr("transform","rotate(-90)").attr("y",-40).attr("x",-L/2).attr("text-anchor","middle").attr("fill","currentColor").text("Portée");const K=yM().x(re=>B(new Date(re.timestamp))).y(re=>J(re.reach)).curve(wq);$.append("path").datum(t.sort((re,oe)=>new Date(re.timestamp).getTime()-new Date(oe.timestamp).getTime())).attr("fill","none").attr("stroke","#3b82f6").attr("stroke-width",2).attr("d",K),e.forEach(re=>{const oe=B(new Date(re.timestamp));$.append("line").attr("x1",oe).attr("x2",oe).attr("y1",0).attr("y2",L).attr("stroke",re.significance==="critical"?"#ef4444":"#f59e0b").attr("stroke-width",2).attr("stroke-dasharray","5,5"),$.append("circle").attr("cx",oe).attr("cy",L/2).attr("r",8).attr("fill",re.significance==="critical"?"#ef4444":"#f59e0b").attr("stroke","white").attr("stroke-width",2),$.append("text").attr("x",oe).attr("y",L/2-15).attr("text-anchor","middle").attr("font-size","11px").attr("font-weight","bold").attr("fill","#374151").text(re.title).call(v,100)});const ce=$.selectAll(".event").data(t).enter().append("g").attr("class","event").attr("transform",re=>`translate(${B(new Date(re.timestamp))},${J(re.reach)})`);ce.append("circle").attr("r",re=>Math.sqrt(re.engagement.shares)/10+5).attr("fill",re=>{switch(re.type){case"origin":return"#f59e0b";case"amplification":return"#ef4444";case"debunk":return"#10b981";case"fact_check":return"#3b82f6";case"mutation":return"#8b5cf6";default:return"#6b7280"}}).attr("stroke","white").attr("stroke-width",2).attr("opacity",.8).on("mouseover",function(re,oe){ni(this).transition().duration(200).attr("r",(Math.sqrt(oe.engagement.shares)/10+5)*1.2),a(oe)}).on("mouseout",function(re,oe){ni(this).transition().duration(200).attr("r",Math.sqrt(oe.engagement.shares)/10+5)}),ce.each(function(re){const oe=ni(this),ae=12;oe.append("rect").attr("x",-ae/2).attr("y",-ae/2).attr("width",ae).attr("height",ae).attr("fill","white").attr("rx",2);const xe=w(re.type);xe&&oe.append("path").attr("d",xe).attr("fill","#374151").attr("transform",`translate(${-ae/2}, ${-ae/2}) scale(0.5)`)});const ne=()=>{O.transition().duration(750).call(W.transform,oE)};window.resetTimelineZoom=ne},[t,e,r,n]);function v(A,I){A.each(function(){var H;const P=ni(this),D=P.text().split(/\s+/).reverse();let L,O=[],$=0;const G=1.1,B=P.attr("y"),J=parseFloat(P.attr("dy")||"0");let W=P.text(null).append("tspan").attr("x",P.attr("x")).attr("y",B).attr("dy",J+"em");for(;L=D.pop();)O.push(L),W.text(O.join(" ")),(((H=W.node())==null?void 0:H.getComputedTextLength())||0)>I&&(O.pop(),W.text(O.join(" ")),O=[L],W=P.append("tspan").attr("x",P.attr("x")).attr("y",B).attr("dy",++$*G+J+"em").text(L))})}function w(A){switch(A){case"origin":return"M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z";case"amplification":return"M7 17l9-5-9-5v10z";case"debunk":return"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z";case"fact_check":return"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z";case"mutation":return"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z";default:return null}}const T=A=>A>=1e6?`${(A/1e6).toFixed(1)}M`:A>=1e3?`${(A/1e3).toFixed(1)}K`:A.toString();return l.jsxs("div",{className:"relative",ref:o,children:[l.jsxs("div",{className:"absolute top-2 right-2 flex gap-2 z-10",children:[l.jsx("button",{onClick:()=>{const A=ni(i.current),I=Ep().scaleExtent([.5,5]);A.transition().duration(300).call(I.scaleBy,1.2)},className:"p-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",title:"Zoom avant",children:l.jsx(QI,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),l.jsx("button",{onClick:()=>{const A=ni(i.current),I=Ep().scaleExtent([.5,5]);A.transition().duration(300).call(I.scaleBy,.8)},className:"p-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",title:"Zoom arrière",children:l.jsx(eM,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),l.jsx("button",{onClick:()=>{window.resetTimelineZoom&&window.resetTimelineZoom()},className:"p-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",title:"Réinitialiser",children:l.jsx(JI,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})})]}),l.jsx("svg",{ref:i,className:"w-full"}),u&&l.jsxs("div",{className:"absolute bottom-20 left-1/2 transform -translate-x-1/2 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 max-w-sm z-20",children:[l.jsxs("div",{className:"flex items-start justify-between mb-2",children:[l.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:u.source.displayName}),l.jsx("button",{onClick:()=>a(null),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:l.jsx(ab,{className:"w-4 h-4 text-gray-500"})})]}),l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["@",u.source.username]}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:u.content}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:T(u.reach)}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Portée"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:T(u.engagement.shares)}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Partages"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:T(u.engagement.likes)}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"J'aime"})]})]})]}),l.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded-full"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Origine"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Amplification"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Démenti"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Vérification"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-purple-500 rounded-full"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Mutation"})]})]})]})},$Le=({events:t,accounts:e,relationships:r,height:n=600})=>{const i=Y.useRef(null),o=Y.useRef(null),[u,a]=Y.useState(null),[p,g]=Y.useState(!1),v=Y.useRef(null);Y.useEffect(()=>{if(!(!i.current||!o.current||t.length===0||e.length===0))try{let P=function(be){be.active||xe.alphaTarget(.3).restart(),be.subject.fx=be.subject.x,be.subject.fy=be.subject.y},D=function(be){be.subject.fx=be.x,be.subject.fy=be.y},L=function(be){be.active||xe.alphaTarget(0),be.subject.fx=null,be.subject.fy=null};const $=o.current.clientWidth,G=e.map(be=>({id:`account-${be.id}`,type:"account",data:be})),B=t.map(be=>({id:`event-${be.id}`,type:"event",data:be})),J=[...G,...B],W=new Set(t.map(be=>be.id)),H=new Set(e.map(be=>be.id)),V=t.filter(be=>H.has(be.source.id)).map(be=>({source:`account-${be.source.id}`,target:`event-${be.id}`,type:"amplifies",strength:.5})),se=r.filter(be=>W.has(be.fromEventId)&&W.has(be.toEventId)).map(be=>({source:`event-${be.fromEventId}`,target:`event-${be.toEventId}`,type:be.type,strength:be.strength})),K=[...V,...se];ni(i.current).selectAll("*").remove();const ce=ni(i.current).attr("width",$).attr("height",n),ne=ce.append("defs");["causes","influences","contradicts","supports","debunks","amplifies"].forEach(be=>{ne.append("marker").attr("id",`arrow-${be}`).attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill",w(be))});const oe=ce.append("g"),ae=Ep().scaleExtent([.1,4]).on("zoom",be=>{oe.attr("transform",be.transform)});ce.call(ae);const xe=tv(J).force("link",ev(K).id(be=>be.id).distance(be=>100/be.strength)).force("charge",rv().strength(be=>be.type==="account"?-800:-400)).force("center",oX($/2,n/2)).force("collision",Qx().radius(be=>be.type==="account"?40:30));v.current=xe;const ye=oe.append("g").selectAll("line").data(K).enter().append("line").attr("stroke",be=>w(be.type)).attr("stroke-opacity",be=>.3+be.strength*.4).attr("stroke-width",be=>1+be.strength*3).attr("marker-end",be=>`url(#arrow-${be.type})`),Se=oe.append("g").selectAll("g").data(J).enter().append("g").call(eX().on("start",P).on("drag",D).on("end",L));return Se.append("circle").attr("r",be=>{if(be.type==="account"){const Ce=be.data;return Math.sqrt(Ce.followerCount)/100+20}else{const Ce=be.data;return Math.sqrt(Ce.reach)/200+15}}).attr("fill",be=>{if(be.type==="account")return be.data.verified?"#3b82f6":"#6b7280";{const Ce=be.data;return T(Ce.type)}}).attr("stroke","#fff").attr("stroke-width",2).on("mouseover",function(be,Ce){ni(this).transition().duration(200).attr("stroke-width",4),a(Ce),ye.attr("stroke-opacity",$e=>{const Ye=typeof $e.source=="string"?$e.source:$e.source.id,jt=typeof $e.target=="string"?$e.target:$e.target.id;return Ye===Ce.id||jt===Ce.id?.8:.1}).attr("stroke-width",$e=>{const Ye=typeof $e.source=="string"?$e.source:$e.source.id,jt=typeof $e.target=="string"?$e.target:$e.target.id;return Ye===Ce.id||jt===Ce.id?3:1})}).on("mouseout",function(){ni(this).transition().duration(200).attr("stroke-width",2),ye.attr("stroke-opacity",be=>.3+be.strength*.4).attr("stroke-width",be=>1+be.strength*3)}),Se.each(function(be){const Ce=ni(this);if(be.type==="account"){const $e=be.data;$e.profileImageUrl?(Ce.append("clipPath").attr("id",`clip-${be.id}`).append("circle").attr("r",30/2),Ce.append("image").attr("xlink:href",$e.profileImageUrl).attr("x",-30/2).attr("y",-30/2).attr("width",30).attr("height",30).attr("clip-path",`url(#clip-${be.id})`)):Ce.append("text").attr("text-anchor","middle").attr("dy",".35em").attr("font-size","14px").attr("font-weight","bold").attr("fill","white").text($e.username.substring(0,2).toUpperCase())}else{const $e=be.data,Ye=A($e.type);Ye&&Ce.append("path").attr("d",Ye).attr("fill","white").attr("transform","translate(-12, -12) scale(0.05)")}}),Se.append("text").attr("dy",be=>{if(be.type==="account"){const Ce=be.data;return Math.sqrt(Ce.followerCount)/100+30}else return 30}).attr("text-anchor","middle").attr("font-size","11px").attr("font-weight",be=>be.type==="account"?"bold":"normal").text(be=>{if(be.type==="account")return`@${be.data.username}`;{const Ce=be.data;return new Date(Ce.timestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}}),xe.on("tick",()=>{ye.attr("x1",be=>be.source.x).attr("y1",be=>be.source.y).attr("x2",be=>be.target.x).attr("y2",be=>be.target.y),Se.attr("transform",be=>`translate(${be.x},${be.y})`)}),window.resetNetworkZoom=()=>{ce.transition().duration(750).call(ae.transform,oE)},()=>{xe.stop()}}catch(P){console.error("Error in NetworkSpreadVisualization:",P)}},[t,e,r,n]);function w(P){switch(P){case"causes":return"#ef4444";case"influences":return"#f59e0b";case"contradicts":return"#dc2626";case"supports":return"#10b981";case"debunks":return"#06b6d4";case"amplifies":return"#8b5cf6";default:return"#6b7280"}}function T(P){switch(P){case"origin":return"#f59e0b";case"amplification":return"#ef4444";case"debunk":return"#10b981";case"fact_check":return"#3b82f6";case"mutation":return"#8b5cf6";default:return"#6b7280"}}function A(P){return{origin:"M480 80C480 35.82 515.8 0 560 0C604.2 0 640 35.82 640 80C640 124.2 604.2 160 560 160C515.8 160 480 124.2 480 80zM0 456.1C0 445.6 2.964 435.3 8.551 426.4L225.3 81.01C231.9 70.42 243.5 64 256 64C268.5 64 280.1 70.42 286.8 81.01L412.7 281.7L460.9 202.7C464.1 196.1 472.2 192 480 192C487.8 192 495 196.1 499.1 202.7L631.1 419.1C636.9 428.6 640 439.7 640 450.9C640 484.6 612.6 512 578.9 512H55.91C25.03 512 .0006 486.1 .0006 456.1L0 456.1z",amplification:"M512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM176 168V344C176 352.7 180.7 360.7 188.3 364.9C195.8 369.2 205.1 369 212.5 364.5L356.5 276.5C363.6 272.1 368 264.4 368 256C368 247.6 363.6 239.9 356.5 235.5L212.5 147.5C205.1 142.1 195.8 142.8 188.3 147.1C180.7 151.3 176 159.3 176 168z",debunk:"M0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256zM175 208.1L222.1 255.1L175 303C165.7 312.4 165.7 327.6 175 336.1C184.4 346.3 199.6 346.3 208.1 337L255.1 289.9L303 336.1C312.4 346.3 327.6 346.3 336.1 336.1C346.3 327.6 346.3 312.4 336.1 303L289.9 255.1L336.1 208.1C346.3 199.6 346.3 184.4 336.1 175C327.6 165.7 312.4 165.7 303 175L255.1 222.1L208.1 175C199.6 165.7 184.4 165.7 175 175C165.7 184.4 165.7 199.6 175 208.1z",fact_check:"M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM371.8 211.8l-128 128C238.3 345.3 231.2 348 224 348s-14.34-2.719-19.81-8.188l-64-64c-10.91-10.94-10.91-28.69 0-39.63c10.94-10.94 28.69-10.94 39.63 0L224 280.4l108.2-108.2c10.94-10.94 28.69-10.94 39.63 0C382.7 183.1 382.7 200.9 371.8 211.8z",mutation:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"}[P]||""}const I=P=>P>=1e6?`${(P/1e6).toFixed(1)}M`:P>=1e3?`${(P/1e3).toFixed(1)}K`:P.toString();return t.length===0||e.length===0?l.jsx("div",{className:"relative flex items-center justify-center h-96 bg-gray-50 dark:bg-gray-700 rounded-lg",ref:o,children:l.jsxs("div",{className:"text-center",children:[l.jsx(Wc,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucune donnée de réseau disponible"}),l.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Les données d'événements et de comptes sont nécessaires pour générer le réseau."})]})}):l.jsxs("div",{className:"relative",ref:o,children:[l.jsxs("div",{className:"absolute top-2 right-2 flex gap-2 z-10",children:[l.jsx("button",{onClick:()=>{v.current&&(p?v.current.restart():v.current.stop(),g(!p))},className:"p-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",title:p?"Reprendre":"Pause",children:p?l.jsx(qg,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}):l.jsx(Ug,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),l.jsx("button",{onClick:()=>{const P=ni(i.current),D=Ep().scaleExtent([.1,4]);P.transition().duration(300).call(D.scaleBy,1.2)},className:"p-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",title:"Zoom avant",children:l.jsx(QI,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),l.jsx("button",{onClick:()=>{const P=ni(i.current),D=Ep().scaleExtent([.1,4]);P.transition().duration(300).call(D.scaleBy,.8)},className:"p-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",title:"Zoom arrière",children:l.jsx(eM,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),l.jsx("button",{onClick:()=>{window.resetNetworkZoom&&window.resetNetworkZoom()},className:"p-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-shadow",title:"Réinitialiser",children:l.jsx(JI,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})})]}),l.jsx("svg",{ref:i,className:"w-full"}),u&&l.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 max-w-md z-20",children:[u.type==="account"?l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.data.profileImageUrl?l.jsx("img",{src:u.data.profileImageUrl,alt:u.data.displayName,className:"w-12 h-12 rounded-full"}):l.jsx("div",{className:"w-12 h-12 bg-gray-300 rounded-full flex items-center justify-center",children:l.jsx(RU,{className:"w-6 h-6 text-gray-600"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:u.data.displayName}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["@",u.data.username]})]}),u.data.verified&&l.jsx(hi,{className:"w-5 h-5 text-blue-500"})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Abonnés"}),l.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:I(u.data.followerCount)})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Crédibilité"}),l.jsxs("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:[(u.data.credibilityScore*100).toFixed(0),"%"]})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Bot prob."}),l.jsxs("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:[(u.data.botProbability*100).toFixed(0),"%"]})]})]})]}):l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-start justify-between mb-2",children:[l.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:u.data.source.displayName}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${u.data.type==="origin"?"bg-yellow-100 text-yellow-700":u.data.type==="amplification"?"bg-red-100 text-red-700":u.data.type==="debunk"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:u.data.type})]}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:u.data.content}),l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:I(u.data.reach)}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Portée"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:I(u.data.engagement.likes)}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"J'aime"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:I(u.data.engagement.shares)}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Partages"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100",children:I(u.data.engagement.comments)}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Comm."})]})]})]}),l.jsx("button",{onClick:()=>a(null),className:"absolute top-2 right-2 p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:l.jsx(ab,{className:"w-4 h-4 text-gray-500"})})]}),l.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[l.jsx("div",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Légende:"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Compte vérifié"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 bg-gray-500 rounded-full"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Compte non-vérifié"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-8 h-0.5 bg-red-500"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Cause"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-8 h-0.5 bg-yellow-500"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Influence"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-8 h-0.5 bg-purple-500"}),l.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Amplifie"})]})]})]})},FLe=({subjectId:t,onBack:e})=>{const[r,n]=Y.useState("overview"),[i,o]=Y.useState(null),[u,a]=Y.useState(null),[p,g]=Y.useState(null),[v,w]=Y.useState([]),[T,A]=Y.useState([]),[I,P]=Y.useState(null),[D,L]=Y.useState([]),[O,$]=Y.useState([]),[G,B]=Y.useState(!0);Y.useEffect(()=>{J()},[t]);const J=async()=>{B(!0);try{const[K,ce,ne,re,oe,ae,xe,ye]=await Promise.all([Lc.getSubjectById(t),Lc.getSubjectTimeline(t),Lc.getCauseEffectAnalysis(t),Lc.getPredictions(t),Lc.getRawData(t),Lc.getSubjectAnalytics(t),Lc.getSourceAccounts(t),Lc.getEventRelationships(t)]);o(K),a(ce),g(ne),w(re),A(oe),P(ae),L(xe),$(ye)}catch(K){console.error("Error loading subject data:",K)}finally{B(!1)}},W=K=>K>=1e6?`${(K/1e6).toFixed(1)}M`:K>=1e3?`${(K/1e3).toFixed(1)}K`:K.toString(),H=K=>new Date(K).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),V=K=>{switch(K){case"positive":return"text-green-600 bg-green-100 dark:bg-green-900/30";case"negative":return"text-red-600 bg-red-100 dark:bg-red-900/30";case"mixed":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/30";default:return"text-gray-600 bg-gray-100 dark:bg-gray-800"}};if(G)return l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!i)return l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Sujet non trouvé"})});const se=[{id:"overview",label:"Vue d'ensemble",icon:No},{id:"timeline",label:"Chronologie",icon:ga},{id:"cause-effect",label:"Cause & Effet",icon:Wc},{id:"network",label:"Réseau",icon:dC},{id:"raw-data",label:"Données brutes",icon:XI},{id:"predictions",label:"Prédictions",icon:cc}];return l.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"px-6 py-4",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(Iie,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:i.title}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:i.description})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(ro,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),l.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(Co,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})]}),l.jsxs("div",{className:"grid grid-cols-6 gap-4 mb-4",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-1",children:[l.jsx(ea,{className:"w-4 h-4"}),l.jsx("span",{className:"text-xs",children:"Portée totale"})]}),l.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:W(i.totalReach)})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-1",children:[l.jsx(ii,{className:"w-4 h-4"}),l.jsx("span",{className:"text-xs",children:"Vélocité"})]}),l.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:i.spreadVelocity.toFixed(1)})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-1",children:[l.jsx(ow,{className:"w-4 h-4"}),l.jsx("span",{className:"text-xs",children:"Engagement"})]}),l.jsxs("p",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:[(i.engagementRate*100).toFixed(1),"%"]})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-1",children:[l.jsx(ds,{className:"w-4 h-4"}),l.jsx("span",{className:"text-xs",children:"Statut"})]}),l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:i.status==="viral"?"Viral":i.status==="spreading"?"En propagation":i.status==="emerging"?"Émergent":i.status==="declining"?"En déclin":"Dormant"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-1",children:[l.jsx(Qie,{className:"w-4 h-4"}),l.jsx("span",{className:"text-xs",children:"Sentiment"})]}),l.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${V(i.sentiment)}`,children:i.sentiment==="positive"?"Positif":i.sentiment==="negative"?"Négatif":i.sentiment==="mixed"?"Mixte":"Neutre"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-1",children:[l.jsx(ga,{className:"w-4 h-4"}),l.jsx("span",{className:"text-xs",children:"Dernière activité"})]}),l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:H(i.lastActivityAt)})]})]}),l.jsx("div",{className:"flex space-x-1 border-b border-gray-200 dark:border-gray-700",children:se.map(K=>{const ce=K.icon;return l.jsxs("button",{onClick:()=>n(K.id),className:`flex items-center gap-2 px-4 py-2 font-medium text-sm border-b-2 transition-colors ${r===K.id?"text-blue-600 dark:text-blue-400 border-blue-600 dark:border-blue-400":"text-gray-500 dark:text-gray-400 border-transparent hover:text-gray-700 dark:hover:text-gray-300"}`,children:[l.jsx(ce,{className:"w-4 h-4"}),K.label]},K.id)})})]})}),l.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[r==="overview"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Comptes influents"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.slice(0,6).map(K=>l.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[l.jsx("img",{src:K.profileImageUrl||`https://api.dicebear.com/7.x/initials/svg?seed=${K.username}`,alt:K.displayName,className:"w-10 h-10 rounded-full"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:K.displayName}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["@",K.username," • ",W(K.followerCount)," abonnés"]})]}),K.verified&&l.jsx(hi,{className:"w-5 h-5 text-blue-500"})]},K.id))})]}),I&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Distribution par plateforme"}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:I.metrics.platforms.map(K=>l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"h-24 bg-blue-600 rounded-lg flex items-end justify-center mb-2",children:l.jsx("div",{className:"bg-blue-500 rounded-t-lg w-full",style:{height:`${K.percentage}%`}})}),l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:K.platform==="social_media"?"Réseaux sociaux":K.platform==="news"?"Actualités":K.platform==="messaging_app"?"Messagerie":K.platform==="forum"?"Forums":K.platform}),l.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[K.percentage,"% • ",W(K.count)]})]},K.platform))})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Mots-clés associés"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:i.tags.map((K,ce)=>l.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-sm",children:[l.jsx(qp,{className:"w-3 h-3"}),K]},ce))})]})]}),r==="timeline"&&u&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Chronologie interactive"}),l.jsx(zLe,{events:u.events,milestones:u.milestones,phases:u.phases,height:500})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Événements chronologiques"}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-700"}),u.events.map((K,ce)=>l.jsxs("div",{className:"relative flex items-start gap-4 mb-6",children:[l.jsxs("div",{className:"relative z-10 flex items-center justify-center w-16 h-16 bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-full",children:[K.type==="origin"&&l.jsx(oi,{className:"w-6 h-6 text-yellow-500"}),K.type==="amplification"&&l.jsx(ii,{className:"w-6 h-6 text-orange-500"}),K.type==="debunk"&&l.jsx(ab,{className:"w-6 h-6 text-green-500"}),K.type==="fact_check"&&l.jsx(hi,{className:"w-6 h-6 text-blue-500"}),K.type==="mutation"&&l.jsx(ro,{className:"w-6 h-6 text-purple-500"})]}),l.jsxs("div",{className:"flex-1 bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-start justify-between mb-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:K.source.displayName}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["@",K.source.username," • ",H(K.timestamp)]})]}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V(K.sentiment)}`,children:K.sentiment})]}),l.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:K.content}),l.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(ea,{className:"w-4 h-4"}),W(K.reach)," portée"]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(ow,{className:"w-4 h-4"}),W(K.engagement.likes)]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(dC,{className:"w-4 h-4"}),W(K.engagement.shares)]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(lf,{className:"w-4 h-4"}),W(K.engagement.comments)]})]})]})]},K.id))]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Phases de propagation"}),l.jsx("div",{className:"space-y-4",children:u.phases.map(K=>l.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:K.name}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:[H(K.startTime)," ",K.endTime&&`- ${H(K.endTime)}`]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Vélocité:"}),l.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100 ml-1",children:K.characteristics.velocity.toFixed(1)})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Sentiment:"}),l.jsx("span",{className:`ml-1 px-2 py-0.5 rounded-full text-xs font-medium ${V(K.characteristics.sentiment)}`,children:K.characteristics.sentiment})]})]})]},K.id))})]})]}),r==="cause-effect"&&p&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Causes identifiées"}),l.jsx("div",{className:"space-y-4",children:p.rootCauses.map(K=>l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsx(oi,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:K.description}),l.jsx("div",{className:"mt-2 space-y-1",children:K.evidence.map((ce,ne)=>l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-start gap-2",children:[l.jsx("span",{className:"text-gray-400",children:"•"}),ce]},ne))}),l.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[l.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Confiance:"}),l.jsx("div",{className:"flex-1 max-w-xs bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${K.confidence*100}%`}})}),l.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:[(K.confidence*100).toFixed(0),"%"]})]})]})]},K.id))})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Effets observés"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.effects.map(K=>l.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[K.type==="behavioral"&&l.jsx(ea,{className:"w-5 h-5 text-blue-500"}),K.type==="economic"&&l.jsx(ii,{className:"w-5 h-5 text-green-500"}),K.type==="sentiment"&&l.jsx(ow,{className:"w-5 h-5 text-purple-500"}),l.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 capitalize",children:K.type})]}),l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:K.description}),K.measuredImpact&&l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded p-2 text-sm",children:[l.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[K.measuredImpact.metric,":"]}),l.jsxs("span",{className:"font-medium text-gray-900 dark:text-gray-100 ml-1",children:[K.measuredImpact.value," (",K.measuredImpact.change>0?"+":"",K.measuredImpact.change,"%)"]})]}),K.affectedGroups&&l.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:K.affectedGroups.map((ce,ne)=>l.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-600 px-2 py-1 rounded",children:ce},ne))})]},K.id))})]})]}),r==="network"&&u&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Réseau de propagation"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Visualisation interactive des connexions entre comptes et événements. Glissez les nœuds pour explorer, survolez pour voir les détails."}),l.jsx($Le,{events:u.events,accounts:D,relationships:O,height:600})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Analyse des relations"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:O.map(K=>{const ce=u.events.find(re=>re.id===K.fromEventId),ne=u.events.find(re=>re.id===K.toEventId);return!ce||!ne?null:l.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${K.type==="causes"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":K.type==="influences"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":K.type==="supports"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":K.type==="contradicts"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":K.type==="debunks"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"}`,children:K.type==="causes"?"Cause":K.type==="influences"?"Influence":K.type==="supports"?"Soutient":K.type==="contradicts"?"Contredit":K.type==="debunks"?"Démystifie":"Amplifie"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Force:"}),l.jsx("div",{className:"w-16 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${K.strength*100}%`}})}),l.jsxs("span",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:[(K.strength*100).toFixed(0),"%"]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"De:"}),l.jsxs("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:[ce.source.displayName," • ",H(ce.timestamp)]})]}),l.jsxs("div",{className:"text-sm",children:[l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Vers:"}),l.jsxs("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:[ne.source.displayName," • ",H(ne.timestamp)]})]})]}),K.evidence&&K.evidence.length>0&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Preuves:"}),l.jsx("ul",{className:"space-y-1",children:K.evidence.map((re,oe)=>l.jsxs("li",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-start gap-1",children:[l.jsx("span",{className:"text-gray-400",children:"•"}),re]},oe))})]}),l.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Confiance:"}),l.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:l.jsx("div",{className:"bg-green-600 h-1.5 rounded-full",style:{width:`${K.confidence*100}%`}})}),l.jsxs("span",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:[(K.confidence*100).toFixed(0),"%"]})]})]},K.id)})})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Statistiques du réseau"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-blue-600",children:D.length}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Comptes impliqués"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-green-600",children:u.events.length}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Événements"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-purple-600",children:O.length}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Relations"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-orange-600",children:D.filter(K=>K.verified).length}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Comptes vérifiés"})]})]})]})]}),r==="raw-data"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:["Données brutes collectées pour: ",i.title]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-blue-600",children:T.length}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Éléments collectés"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-green-600",children:T.filter(K=>K.isOriginal).length}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Posts originaux"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-purple-600",children:T.filter(K=>K.hasMedia).length}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Avec médias"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-orange-600",children:new Set(T.map(K=>K.source.platform)).size}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Plateformes"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Exemples de contenu brut"}),T.slice(0,3).map(K=>l.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:K.source.profileImageUrl||`https://api.dicebear.com/7.x/initials/svg?seed=${K.source.username}`,alt:K.source.displayName,className:"w-10 h-10 rounded-full"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:K.source.displayName}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["@",K.source.username," • ",H(K.timestamp)]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[K.isOriginal&&l.jsx("span",{className:"px-2 py-1 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 rounded text-xs font-medium",children:"Original"}),K.hasMedia&&l.jsx("span",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 rounded text-xs font-medium",children:"Média"})]})]}),l.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded p-3 mb-3",children:l.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-700 dark:text-gray-300 font-mono",children:K.rawContent})}),K.metadata&&Object.keys(K.metadata).length>0&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"Métadonnées d'analyse:"}),l.jsx("div",{className:"flex flex-wrap gap-2 text-xs",children:Object.entries(K.metadata).map(([ce,ne])=>l.jsxs("span",{className:"bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:[ce,": ",Array.isArray(ne)?ne.join(", "):ne]},ce))})]})]},K.id))]})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-xl p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Explorateur de données avancé"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Explorez toutes les données collectées avec des outils de filtrage et d'analyse avancés."}),l.jsx(Wg,{})]})]}),r==="predictions"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6",children:["Tableau de bord prédictif - ",i.title]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-2 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:l.jsx(ii,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:i.spreadVelocity.toFixed(1)}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Vélocité actuelle"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-2 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center",children:l.jsx(ea,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:W(i.totalReach)}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Portée actuelle"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-2 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center",children:l.jsx(ow,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})}),l.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[(i.engagementRate*100).toFixed(1),"%"]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Taux d'engagement"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-2 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center",children:l.jsx(ds,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 capitalize",children:i.status}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Statut de propagation"})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-3",children:"Évolution prédite de la portée"}),l.jsx("div",{className:"h-64 bg-gray-50 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:l.jsx("div",{className:"w-full h-full p-4",children:l.jsxs("svg",{viewBox:"0 0 400 200",className:"w-full h-full",children:[l.jsx("defs",{children:l.jsx("pattern",{id:"grid",width:"40",height:"20",patternUnits:"userSpaceOnUse",children:l.jsx("path",{d:"M 40 0 L 0 0 0 20",fill:"none",stroke:"#e5e7eb",strokeWidth:"1"})})}),l.jsx("rect",{width:"400",height:"200",fill:"url(#grid)"}),l.jsx("path",{d:"M 0,180 Q 100,160 150,140 T 200,120",stroke:"#3b82f6",strokeWidth:"3",fill:"none"}),l.jsx("path",{d:"M 200,120 Q 250,100 300,80 T 400,60",stroke:"#10b981",strokeWidth:"3",fill:"none",strokeDasharray:"5,5"}),l.jsx("path",{d:"M 200,140 Q 250,120 300,100 T 400,80 L 400,40 Q 300,60 250,80 T 200,100 Z",fill:"#10b981",fillOpacity:"0.1"}),l.jsx("circle",{cx:"200",cy:"120",r:"6",fill:"#3b82f6"}),l.jsx("text",{x:"10",y:"20",className:"text-xs fill-current text-gray-600 dark:text-gray-400",children:"Données historiques"}),l.jsx("line",{x1:"10",y1:"30",x2:"40",y2:"30",stroke:"#3b82f6",strokeWidth:"2"}),l.jsx("text",{x:"10",y:"50",className:"text-xs fill-current text-gray-600 dark:text-gray-400",children:"Prédiction"}),l.jsx("line",{x1:"10",y1:"60",x2:"40",y2:"60",stroke:"#10b981",strokeWidth:"2",strokeDasharray:"5,5"})]})})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(oi,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),l.jsx("h5",{className:"font-medium text-red-900 dark:text-red-100",children:"Risques identifiés"})]}),l.jsxs("ul",{className:"text-sm text-red-700 dark:text-red-300 space-y-1",children:[l.jsx("li",{children:"• Amplification par des bots"}),l.jsx("li",{children:"• Mutation narrative possible"}),l.jsx("li",{children:"• Propagation transfrontalière"})]})]}),l.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(ga,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400"}),l.jsx("h5",{className:"font-medium text-yellow-900 dark:text-yellow-100",children:"Fenêtre critique"})]}),l.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"Les prochaines 6-12 heures sont cruciales pour l'évolution du sujet."})]}),l.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(gl,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),l.jsx("h5",{className:"font-medium text-green-900 dark:text-green-100",children:"Opportunités"})]}),l.jsxs("ul",{className:"text-sm text-green-700 dark:text-green-300 space-y-1",children:[l.jsx("li",{children:"• Correction proactive possible"}),l.jsx("li",{children:"• Engagement des influenceurs"}),l.jsx("li",{children:"• Communication officielle"})]})]})]})]}),v.map(K=>l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["Prédiction à ",K.timeHorizon==="24h"?"24 heures":K.timeHorizon==="7d"?"7 jours":"30 jours"]}),l.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${K.confidence==="high"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":K.confidence==="medium"?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400"}`,children:["Confiance ",K.confidence==="high"?"élevée":K.confidence==="medium"?"moyenne":"faible"]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Portée estimée"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:W(K.predictions.reachEstimate.expected)}),l.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[W(K.predictions.reachEstimate.min)," - ",W(K.predictions.reachEstimate.max)]}),l.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${K.predictions.reachEstimate.expected/K.predictions.reachEstimate.max*100}%`}})})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Probabilité virale"}),l.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[(K.predictions.viralProbability*100).toFixed(0),"%"]}),l.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:l.jsx("div",{className:`h-2 rounded-full ${K.predictions.viralProbability>.7?"bg-red-600":K.predictions.viralProbability>.4?"bg-yellow-600":"bg-green-600"}`,style:{width:`${K.predictions.viralProbability*100}%`}})})]}),K.predictions.sentimentShift&&l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Changement sentiment"}),l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[K.predictions.sentimentShift.direction==="improving"?l.jsx(ii,{className:"w-5 h-5 text-green-500"}):K.predictions.sentimentShift.direction==="worsening"?l.jsx(Qv,{className:"w-5 h-5 text-red-500"}):l.jsx(ds,{className:"w-5 h-5 text-gray-500"}),l.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:K.predictions.sentimentShift.direction==="improving"?"Amélioration":K.predictions.sentimentShift.direction==="worsening"?"Dégradation":"Stable"})]}),l.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:l.jsx("div",{className:`h-2 rounded-full ${K.predictions.sentimentShift.direction==="improving"?"bg-green-600":K.predictions.sentimentShift.direction==="worsening"?"bg-red-600":"bg-gray-600"}`,style:{width:`${K.predictions.sentimentShift.magnitude*100}%`}})})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsxs("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[l.jsx(il,{className:"w-4 h-4"}),"Facteurs clés"]}),l.jsx("ul",{className:"space-y-2",children:K.factors.map((ce,ne)=>l.jsxs("li",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-start gap-2 p-2 bg-gray-50 dark:bg-gray-700 rounded",children:[l.jsx(nu,{className:"w-4 h-4 text-blue-500 flex-shrink-0 mt-0.5"}),ce]},ne))})]}),K.recommendations&&l.jsxs("div",{children:[l.jsxs("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[l.jsx(hi,{className:"w-4 h-4"}),"Recommandations"]}),l.jsx("ul",{className:"space-y-2",children:K.recommendations.map((ce,ne)=>l.jsxs("li",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-start gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded",children:[l.jsx(hi,{className:"w-4 h-4 text-green-500 flex-shrink-0 mt-0.5"}),ce]},ne))})]})]}),(K.predictions.peakTime||K.predictions.declineTime)&&l.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-3",children:"Chronologie prédite"}),l.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[K.predictions.peakTime&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ii,{className:"w-4 h-4 text-orange-500"}),l.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Pic attendu: ",H(K.predictions.peakTime)]})]}),K.predictions.declineTime&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Qv,{className:"w-4 h-4 text-blue-500"}),l.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Déclin prévu: ",H(K.predictions.declineTime)]})]})]})]})]},K.id)),l.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-xl p-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center",children:l.jsx(cc,{className:"w-6 h-6 text-white"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Analyse IA - Résumé prédictif"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Probabilité de contrôle"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-600 rounded-full h-3",children:l.jsx("div",{className:"bg-green-600 h-3 rounded-full",style:{width:"75%"}})}),l.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"75%"})]}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Contrôle possible avec intervention rapide"})]}),l.jsxs("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Impact potentiel"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-600 rounded-full h-3",children:l.jsx("div",{className:"bg-yellow-600 h-3 rounded-full",style:{width:"60%"}})}),l.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Modéré"})]}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Impact limité avec mesures préventives"})]}),l.jsxs("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Urgence d'action"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex-1 bg-gray-200 dark:bg-gray-600 rounded-full h-3",children:l.jsx("div",{className:"bg-orange-600 h-3 rounded-full",style:{width:"80%"}})}),l.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Élevée"})]}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Action recommandée dans les 4-6 heures"})]})]})]})]})]})]})},Gl=[{id:"camp1",title:"Fact-Check Élections 2024",description:"Campagne de vérification des faits pour contrer la désinformation électorale",type:"fact_check",status:"active",targetSubjectId:"subj1",platforms:["twitter","facebook","whatsapp"],createdAt:"2024-12-20T09:00:00Z",startDate:"2024-12-21T06:00:00Z",endDate:"2025-01-15T23:59:59Z",creator:{id:"user1",name:"Sarah Mukendi",role:"Communications Manager"},approval:{required:!0,approvedBy:"manager1",approvedAt:"2024-12-20T14:30:00Z",comments:"Approuvé avec budget augmenté"},metrics:{reach:125e3,impressions:45e4,engagement:{likes:3200,shares:1800,comments:950,clicks:8500},effectiveness:{misinformationReduced:35,factChecksDelivered:128,narrativeShift:.45,communityEngagement:.68},costs:{budget:15e3,spent:8500,costPerReach:.068}},content:{messages:[{id:"msg1",platform:"twitter",content:`🔍 FACT-CHECK: Les rumeurs sur les machines de vote ont été vérifiées. Voici les faits:

✅ Source officielle: CENI
✅ Vérification indépendante

#FactCheck #Elections2024 #VeriteDRC`,language:"fr",tone:"educational",variables:{source:"CENI",topic:"machines de vote"}},{id:"msg2",platform:"facebook",content:"Nous avons vérifié les informations circulant sur les élections. Consultez notre rapport complet avec sources et preuves.",language:"fr",tone:"formal",variables:{}}],media:[{id:"media1",type:"infographic",url:"/assets/fact-check-infographic.png",title:"Infographie Fact-Check Élections",description:"Visualisation des faits vérifiés sur les élections",verified:!0}],hashtags:["#FactCheck","#Elections2024","#VeriteDRC","#TransparenceDRC"],mentions:["@CENI_RDC","@RadioOkapi"],factCheckSources:[{id:"fc1",organization:"Africa Check",url:"https://africacheck.org/fact-checks/elections-drc-2024",title:"Vérification des allégations sur les machines de vote",summary:"Analyse détaillée des fonctionnalités et sécurité des machines de vote",credibilityScore:.95,publishedAt:"2024-12-19T15:00:00Z"}]},targeting:{demographics:{ageGroups:["18-25","26-35","36-50"],locations:["Kinshasa","Lubumbashi","Goma","Kisangani"],languages:["fr","ln","sw"]},behavioral:{engagedWithMisinformation:!0,followsInfluencers:["@political_analyst_rdc","@civic_education"],interests:["politics","elections","democracy","civic_education"]},reach:{estimated:2e5,maxBudget:15e3}},schedule:{type:"triggered",frequency:"on_detection",triggers:[{id:"trigger1",type:"misinformation_detected",conditions:{confidence:.8,reach:1e4},priority:"high"}]}},{id:"camp2",title:"Éducation Numérique Anti-Désinformation",description:"Programme éducatif pour former les citoyens à identifier la désinformation",type:"educational",status:"active",platforms:["all"],createdAt:"2024-12-15T10:00:00Z",startDate:"2024-12-16T00:00:00Z",creator:{id:"user2",name:"Dr. Jean Kabamba",role:"Education Specialist"},approval:{required:!1},metrics:{reach:85e3,impressions:32e4,engagement:{likes:2100,shares:1200,comments:680,clicks:5800},effectiveness:{misinformationReduced:28,factChecksDelivered:95,narrativeShift:.38,communityEngagement:.72},costs:{budget:8e3,spent:4200,costPerReach:.049}},content:{messages:[{id:"msg3",platform:"all",content:`📚 FORMATION GRATUITE: Comment identifier les fausses informations?

🎯 Techniques simples
🔍 Outils de vérification
📱 Guide pratique

Inscrivez-vous: bit.ly/formation-factcheck`,language:"fr",tone:"friendly",variables:{}}],media:[{id:"media2",type:"video",url:"/assets/education-video.mp4",title:"Guide de vérification des informations",description:"Tutoriel de 5 minutes sur les techniques de fact-checking",verified:!0}],hashtags:["#EducationNumerique","#FactCheck","#FormationDRC"],mentions:[],factCheckSources:[]},targeting:{demographics:{ageGroups:["18-25","26-35","36-50","51-65"],locations:["Kinshasa","Lubumbashi","Goma","Kananga"],languages:["fr","ln","sw","kg"]},behavioral:{engagedWithMisinformation:!1,followsInfluencers:[],interests:["education","technology","media_literacy"]},reach:{estimated:15e4,maxBudget:8e3}},schedule:{type:"scheduled",startTime:"2024-12-16T06:00:00Z",frequency:"weekly"}},{id:"camp3",title:"Contre-Narrative COVID-19",description:"Campagne pour contrer les théories conspirationnistes sur les vaccins",type:"counter_narrative",status:"paused",platforms:["facebook","whatsapp","telegram"],createdAt:"2024-11-20T08:00:00Z",startDate:"2024-11-25T00:00:00Z",endDate:"2024-12-31T23:59:59Z",creator:{id:"user3",name:"Dr. Marie Tshimanga",role:"Health Communications"},approval:{required:!0,approvedBy:"health_minister",approvedAt:"2024-11-22T16:00:00Z"},metrics:{reach:65e3,impressions:18e4,engagement:{likes:1200,shares:800,comments:450,clicks:3200},effectiveness:{misinformationReduced:22,factChecksDelivered:68,narrativeShift:.28,communityEngagement:.45},costs:{budget:12e3,spent:5800,costPerReach:.089}},content:{messages:[{id:"msg4",platform:"facebook",content:`🏥 INFORMATION MÉDICALE OFFICIELLE

Nos experts médicaux répondent à vos questions sur la vaccination.

📞 Ligne directe: 0800-xxx-xxx
🌐 Site officiel: sante.gouv.cd`,language:"fr",tone:"professional",variables:{}}],media:[{id:"media3",type:"infographic",url:"/assets/covid-facts.png",title:"Faits sur les vaccins COVID-19",description:"Informations vérifiées par les autorités sanitaires",verified:!0}],hashtags:["#COVID19RDC","#VaccinationDRC","#SantePublique"],mentions:["@MinSanteRDC","@OMSCongo"],factCheckSources:[{id:"fc2",organization:"OMS",url:"https://who.int/fr/emergencies/diseases/novel-coronavirus-2019",title:"Informations officielles COVID-19",summary:"Données scientifiques sur la vaccination et la prévention",credibilityScore:.98,publishedAt:"2024-11-15T12:00:00Z"}]},targeting:{demographics:{ageGroups:["26-35","36-50","51-65"],locations:["Kinshasa","Lubumbashi","Goma"],languages:["fr","ln"]},behavioral:{engagedWithMisinformation:!0,followsInfluencers:["@health_skeptic","@alternative_medicine"],interests:["health","family","community"]},reach:{estimated:1e5,maxBudget:12e3}},schedule:{type:"scheduled",startTime:"2024-11-25T08:00:00Z",frequency:"daily"}}],ah=[{id:"auto1",name:"Réponse Élections Automatique",active:!0,platforms:["twitter","facebook"],triggers:[{id:"trigger1",type:"keyword",patterns:["fraude électorale","votes truqués","machines hackées"],conditions:{confidence:.8,reach:5e3},cooldown:60},{id:"trigger2",type:"hashtag",patterns:["#FraudeElections","#VotesTruques"],conditions:{confidence:.7,engagement:100},cooldown:30}],responses:[{id:"resp1",platform:"twitter",content:"🔍 Information vérifiée disponible: Les allégations de fraude électorale ont été examinées par des observateurs indépendants. Consultez le rapport officiel: bit.ly/rapport-elections-2024 #FactCheck",language:"fr",includeFactCheck:!0,includeSources:!0,personalized:!1,tone:"professional"},{id:"resp2",platform:"facebook",content:"Nous avons détecté des informations potentiellement incorrectes. Voici les faits vérifiés par nos partenaires de confiance. [Lien vers fact-check complet]",language:"fr",includeFactCheck:!0,includeSources:!0,personalized:!1,tone:"educational"}],approval:{required:!1},metrics:{triggered:45,sent:42,effectiveness:.73},createdAt:"2024-12-10T14:00:00Z",lastTriggered:"2024-12-28T16:30:00Z"},{id:"auto2",name:"Détection Désinformation Santé",active:!0,platforms:["whatsapp","telegram"],triggers:[{id:"trigger3",type:"misinformation_detected",patterns:["vaccin dangereux","remède miracle","coronavirus fake"],conditions:{confidence:.85,reach:1e3},cooldown:120}],responses:[{id:"resp3",platform:"whatsapp",content:"⚕️ Information de santé détectée. Pour des informations médicales fiables, consultez: sante.gouv.cd ou contactez la ligne d'information gratuite: 0800-xxx-xxx",language:"fr",includeFactCheck:!0,includeSources:!0,personalized:!1,tone:"empathetic"}],approval:{required:!0,approver:"health_coordinator"},metrics:{triggered:28,sent:25,effectiveness:.68},createdAt:"2024-11-15T09:00:00Z",lastTriggered:"2024-12-27T11:15:00Z"},{id:"auto3",name:"Surveillance Réseaux Sociaux",active:!1,platforms:["all"],triggers:[{id:"trigger4",type:"sentiment",patterns:["gouvernement corruption","opposition manipulation"],conditions:{confidence:.6,engagement:500},cooldown:180}],responses:[{id:"resp4",platform:"all",content:"Pour des informations vérifiées sur les institutions publiques, consultez les sources officielles. Évitez de partager des informations non vérifiées.",language:"fr",includeFactCheck:!1,includeSources:!0,personalized:!1,tone:"corrective"}],approval:{required:!0,approver:"senior_analyst"},metrics:{triggered:12,sent:8,effectiveness:.42},createdAt:"2024-10-20T11:00:00Z"}],sh=[{id:"rapid1",title:"Réponse Urgente: Rumeurs Violence Post-Électorale",urgency:"critical",status:"active",triggerEvent:{type:"viral_misinformation",description:"Propagation rapide de rumeurs sur des violences post-électorales dans plusieurs provinces",detectedAt:"2024-12-28T14:30:00Z"},actions:[{id:"action1",type:"press_release",content:"Communiqué de presse démenti les rumeurs de violence. Confirmation de la situation calme par les autorités locales.",status:"completed",assignedTo:"press_team",scheduledFor:"2024-12-28T15:00:00Z",completedAt:"2024-12-28T15:15:00Z"},{id:"action2",type:"social_media_post",platform:"twitter",content:"🔴 DÉMENTI OFFICIEL: Les rumeurs de violence sont FAUSSES. Situation confirmée calme par la Police Nationale. Sources vérifiées: bit.ly/situation-securite #DementiOfficiel",status:"completed",assignedTo:"social_media_team",scheduledFor:"2024-12-28T15:30:00Z",completedAt:"2024-12-28T15:35:00Z"},{id:"action3",type:"influencer_outreach",content:"Coordination avec influenceurs locaux pour diffuser le démenti et calmer les tensions",status:"in_progress",assignedTo:"outreach_coordinator",scheduledFor:"2024-12-28T16:00:00Z"},{id:"action4",type:"community_alert",content:"Alerte communautaire via leaders locaux et réseaux de confiance",status:"pending",assignedTo:"community_liaison",scheduledFor:"2024-12-28T17:00:00Z"}],timeline:[{id:"timeline1",timestamp:"2024-12-28T14:30:00Z",action:"Détection automatique de désinformation virale",actor:"Système de surveillance",result:"Alerte déclenchée - Urgence critique",impact:0},{id:"timeline2",timestamp:"2024-12-28T14:35:00Z",action:"Équipe de réponse rapide mobilisée",actor:"Coordinateur de crise",result:"Équipe activée en 5 minutes",impact:0},{id:"timeline3",timestamp:"2024-12-28T15:15:00Z",action:"Communiqué de presse publié",actor:"Équipe de presse",result:"Diffusion sur 12 médias locaux",impact:25e3},{id:"timeline4",timestamp:"2024-12-28T15:35:00Z",action:"Démenti sur réseaux sociaux",actor:"Équipe réseaux sociaux",result:"Publication sur Twitter, Facebook, WhatsApp",impact:45e3}],team:[{id:"team1",name:"Alphonse Mukala",role:"coordinator",contact:"a.mukala@sentinel.cd",available:!0},{id:"team2",name:"Jeanne Kasongo",role:"content_creator",contact:"j.kasongo@sentinel.cd",available:!0},{id:"team3",name:"Patrick Mbuyi",role:"fact_checker",contact:"p.mbuyi@sentinel.cd",available:!0},{id:"team4",name:"Christine Ilunga",role:"community_manager",contact:"c.ilunga@sentinel.cd",available:!1}],metrics:{responseTime:5,reach:7e4,effectiveness:.82}},{id:"rapid2",title:"Attaque Coordonnée Contre Institution",urgency:"high",status:"completed",triggerEvent:{type:"coordinated_attack",description:"Campagne de désinformation coordonnée visant à discréditer la Commission Électorale",detectedAt:"2024-12-25T09:15:00Z"},actions:[{id:"action5",type:"fact_check",content:"Fact-check détaillé des allégations avec sources et preuves",status:"completed",assignedTo:"fact_check_team",scheduledFor:"2024-12-25T10:00:00Z",completedAt:"2024-12-25T12:30:00Z"},{id:"action6",type:"social_media_post",platform:"facebook",content:"Réfutation point par point des accusations avec données vérifiables et sources officielles",status:"completed",assignedTo:"content_team",scheduledFor:"2024-12-25T13:00:00Z",completedAt:"2024-12-25T13:10:00Z"}],timeline:[{id:"timeline5",timestamp:"2024-12-25T09:15:00Z",action:"Détection d'attaque coordonnée",actor:"Analyseur automatique",result:"Pattern d'attaque identifié",impact:0},{id:"timeline6",timestamp:"2024-12-25T12:30:00Z",action:"Fact-check publié",actor:"Équipe de vérification",result:"Réfutation complète avec preuves",impact:35e3}],team:[{id:"team5",name:"Dr. Joseph Mwamba",role:"analyst",contact:"j.mwamba@sentinel.cd",available:!0}],metrics:{responseTime:195,reach:35e3,effectiveness:.74}}],zB=[{id:"comm1",title:"Programme Ambassadeurs Anti-Désinformation",type:"ambassador_program",status:"active",participants:[{id:"part1",name:"Marie Kalombo",role:"ambassador",location:"Kinshasa",platforms:["facebook","whatsapp"],reach:15e3,credibilityScore:.88,contributionLevel:"gold"},{id:"part2",name:"Jean-Claude Mputu",role:"ambassador",location:"Lubumbashi",platforms:["twitter","telegram"],reach:8500,credibilityScore:.82,contributionLevel:"silver"},{id:"part3",name:"Grace Ndaya",role:"fact_checker",location:"Goma",platforms:["facebook","instagram"],reach:12e3,credibilityScore:.91,contributionLevel:"gold"}],activities:[{id:"act1",type:"training",title:"Formation Fact-Checking Avancé",description:"Session de formation sur les techniques avancées de vérification des faits",participants:["part1","part2","part3"],scheduledFor:"2024-12-30T14:00:00Z",impact:{reach:0,engagement:25,factChecks:0}},{id:"act2",type:"fact_check",title:"Vérification Rumeurs Marché Central",description:"Investigation sur les rumeurs concernant le marché central de Kinshasa",participants:["part1"],scheduledFor:"2024-12-29T10:00:00Z",completedAt:"2024-12-29T16:30:00Z",impact:{reach:8500,engagement:1200,factChecks:1}}],impact:{peopleReached:156e3,misinformationCorrected:28,trustedSourcesShared:145,communityGrowth:.23},createdAt:"2024-11-01T00:00:00Z"},{id:"comm2",title:"Réseau de Vérificateurs Communautaires",type:"fact_checker_network",status:"recruiting",participants:[{id:"part4",name:"David Mukendi",role:"fact_checker",location:"Kananga",platforms:["whatsapp","telegram"],reach:4200,credibilityScore:.75,contributionLevel:"bronze"},{id:"part5",name:"Sylvie Tshiaba",role:"educator",location:"Kisangani",platforms:["facebook"],reach:6800,credibilityScore:.83,contributionLevel:"silver"}],activities:[{id:"act3",type:"outreach",title:"Recrutement Nouveaux Vérificateurs",description:"Campagne de recrutement pour élargir le réseau",participants:["part4","part5"],scheduledFor:"2025-01-05T09:00:00Z",impact:{reach:15e3,engagement:850,factChecks:0}}],impact:{peopleReached:45e3,misinformationCorrected:12,trustedSourcesShared:58,communityGrowth:.15},createdAt:"2024-12-01T00:00:00Z"},{id:"comm3",title:"Ateliers Éducation Numérique",type:"educational_workshop",status:"planning",participants:[{id:"part6",name:"Prof. Emmanuel Lumumba",role:"educator",location:"Kinshasa",platforms:["all"],reach:25e3,credibilityScore:.95,contributionLevel:"platinum"}],activities:[{id:"act4",type:"training",title:"Atelier Littératie Numérique",description:"Formation sur la littératie numérique et la détection de fausses informations",participants:["part6"],scheduledFor:"2025-01-15T13:00:00Z",impact:{reach:0,engagement:0,factChecks:0}}],impact:{peopleReached:0,misinformationCorrected:0,trustedSourcesShared:0,communityGrowth:0},createdAt:"2024-12-20T00:00:00Z"}];class BLe extends LT{constructor(){super("counter-action-data")}async getCounterCampaigns(e){await this.simulateDelay(300);let r=[...Gl];if(e&&(e.type&&(r=r.filter(n=>n.type===e.type)),e.status&&(r=r.filter(n=>n.status===e.status)),e.platform&&(r=r.filter(n=>n.platforms.includes(e.platform)||n.platforms.includes("all"))),e.search)){const n=e.search.toLowerCase();r=r.filter(i=>i.title.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return r}async getCampaignById(e){return await this.simulateDelay(200),Gl.find(r=>r.id===e)||null}async createCampaign(e){var n,i;await this.simulateDelay(500);const r={...e,id:`campaign-${Date.now()}`,createdAt:new Date().toISOString(),metrics:{reach:0,impressions:0,engagement:{likes:0,shares:0,comments:0,clicks:0},effectiveness:{misinformationReduced:0,factChecksDelivered:0,narrativeShift:0,communityEngagement:0},costs:{budget:((i=(n=e.targeting)==null?void 0:n.reach)==null?void 0:i.maxBudget)||0,spent:0,costPerReach:0}}};return Gl.unshift(r),r}async updateCampaign(e,r){await this.simulateDelay(400);const n=Gl.findIndex(i=>i.id===e);if(n===-1)throw new Error("Campaign not found");return Gl[n]={...Gl[n],...r},Gl[n]}async deleteCampaign(e){await this.simulateDelay(300);const r=Gl.findIndex(n=>n.id===e);if(r===-1)throw new Error("Campaign not found");Gl.splice(r,1)}async getAutoResponses(e){await this.simulateDelay(250);let r=[...ah];return e&&(e.platform&&(r=r.filter(n=>n.platforms.includes(e.platform)||n.platforms.includes("all"))),e.active!==void 0&&(r=r.filter(n=>n.active===e.active))),r}async getAutoResponseById(e){return await this.simulateDelay(200),ah.find(r=>r.id===e)||null}async createAutoResponse(e){await this.simulateDelay(400);const r={...e,id:`response-${Date.now()}`,createdAt:new Date().toISOString(),metrics:{triggered:0,sent:0,effectiveness:0}};return ah.unshift(r),r}async updateAutoResponse(e,r){await this.simulateDelay(350);const n=ah.findIndex(i=>i.id===e);if(n===-1)throw new Error("Auto response not found");return ah[n]={...ah[n],...r},ah[n]}async toggleAutoResponse(e){const r=await this.getAutoResponseById(e);if(!r)throw new Error("Auto response not found");return this.updateAutoResponse(e,{active:!r.active})}async getRapidResponses(e){await this.simulateDelay(300);let r=[...sh];return e&&(e.urgency&&(r=r.filter(n=>n.urgency===e.urgency)),e.status&&(r=r.filter(n=>n.status===e.status))),r}async getRapidResponseById(e){return await this.simulateDelay(200),sh.find(r=>r.id===e)||null}async createRapidResponse(e){await this.simulateDelay(500);const r={...e,id:`rapid-${Date.now()}`,metrics:{responseTime:0,reach:0,effectiveness:0}};return sh.unshift(r),r}async deployRapidResponse(e){var r;return this.updateRapidResponse(e,{status:"deploying",timeline:[...((r=sh.find(n=>n.id===e))==null?void 0:r.timeline)||[],{id:`timeline-${Date.now()}`,timestamp:new Date().toISOString(),action:"Déploiement initié",actor:"Système",result:"En cours"}]})}async updateRapidResponse(e,r){await this.simulateDelay(400);const n=sh.findIndex(i=>i.id===e);if(n===-1)throw new Error("Rapid response not found");return sh[n]={...sh[n],...r},sh[n]}async getCommunityEngagements(e){await this.simulateDelay(250);let r=[...zB];return e&&(e.type&&(r=r.filter(n=>n.type===e.type)),e.status&&(r=r.filter(n=>n.status===e.status))),r}async getCommunityEngagementById(e){return await this.simulateDelay(200),zB.find(r=>r.id===e)||null}async getCounterActionMetrics(){await this.simulateDelay(400);const e=Gl,r=e.filter(o=>o.status==="active"),n=e.reduce((o,u)=>o+u.metrics.reach,0),i=e.reduce((o,u)=>o+u.metrics.effectiveness.misinformationReduced,0);return{totalCampaigns:e.length,activeCampaigns:r.length,totalReach:n,misinformationCountered:i,responseTime:15,effectiveness:.78,topPerformingCampaigns:e.sort((o,u)=>u.metrics.effectiveness.misinformationReduced-o.metrics.effectiveness.misinformationReduced).slice(0,5),recentActivity:[{id:"1",type:"campaign",action:'Campagne "Fact-check Elections" lancée',timestamp:new Date(Date.now()-2*60*60*1e3).toISOString(),impact:15e3},{id:"2",type:"auto_response",action:"Réponse automatique déclenchée sur Twitter",timestamp:new Date(Date.now()-4*60*60*1e3).toISOString(),impact:3200},{id:"3",type:"rapid_response",action:"Réponse rapide activée pour désinformation virale",timestamp:new Date(Date.now()-6*60*60*1e3).toISOString(),impact:25e3}]}}async simulateRealTimeUpdate(){await this.simulateDelay(200);const e=Gl.map(n=>n.status==="active"?{...n,metrics:{...n.metrics,reach:n.metrics.reach+Math.floor(Math.random()*1e3),impressions:n.metrics.impressions+Math.floor(Math.random()*5e3),engagement:{...n.metrics.engagement,likes:n.metrics.engagement.likes+Math.floor(Math.random()*100),shares:n.metrics.engagement.shares+Math.floor(Math.random()*50),comments:n.metrics.engagement.comments+Math.floor(Math.random()*30)}}}:n),r=ah.map(n=>n.active&&Math.random()>.7?{...n,metrics:{...n.metrics,triggered:n.metrics.triggered+1,sent:n.metrics.sent+Math.floor(Math.random()*3)},lastTriggered:new Date().toISOString()}:n);return{campaigns:e,autoResponses:r}}}const Wl=new BLe,VLe=({isOpen:t,onClose:e,onSubmit:r})=>{const[n,i]=Y.useState({title:"",description:"",type:"fact_check",platforms:[],startDate:"",endDate:"",budget:0,targetLocations:[],targetAgeGroups:[],keywords:[],newKeyword:""}),[o,u]=Y.useState(1),a=4;if(!t)return null;const p=O=>{i($=>({...$,platforms:$.platforms.includes(O)?$.platforms.filter(G=>G!==O):[...$.platforms,O]}))},g=O=>{i($=>({...$,targetLocations:$.targetLocations.includes(O)?$.targetLocations.filter(G=>G!==O):[...$.targetLocations,O]}))},v=O=>{i($=>({...$,targetAgeGroups:$.targetAgeGroups.includes(O)?$.targetAgeGroups.filter(G=>G!==O):[...$.targetAgeGroups,O]}))},w=()=>{n.newKeyword.trim()&&!n.keywords.includes(n.newKeyword.trim())&&i(O=>({...O,keywords:[...O.keywords,O.newKeyword.trim()],newKeyword:""}))},T=O=>{i($=>({...$,keywords:$.keywords.filter(G=>G!==O)}))},A=()=>{const O={title:n.title,description:n.description,type:n.type,platforms:n.platforms,startDate:n.startDate,endDate:n.endDate,status:"draft",creator:{id:"current-user",name:"Current User",role:"Campaign Manager"},approval:{required:n.budget>1e4},targeting:{demographics:{ageGroups:n.targetAgeGroups,locations:n.targetLocations,languages:["fr"]},behavioral:{engagedWithMisinformation:n.type==="fact_check",followsInfluencers:[],interests:["politics","news"]},reach:{estimated:Math.floor(n.budget*10),maxBudget:n.budget}},content:{messages:[],media:[],hashtags:n.keywords,mentions:[],factCheckSources:[]},schedule:{type:"scheduled",startTime:n.startDate,endTime:n.endDate,frequency:"daily"}};r(O),e(),i({title:"",description:"",type:"fact_check",platforms:[],startDate:"",endDate:"",budget:0,targetLocations:[],targetAgeGroups:[],keywords:[],newKeyword:""}),u(1)},I=()=>{switch(o){case 1:return n.title.trim()&&n.description.trim();case 2:return n.platforms.length>0;case 3:return n.targetLocations.length>0;case 4:return n.startDate&&n.budget>0;default:return!1}},P=[{id:"twitter",label:"Twitter",icon:"🐦"},{id:"facebook",label:"Facebook",icon:"📘"},{id:"whatsapp",label:"WhatsApp",icon:"💬"},{id:"telegram",label:"Telegram",icon:"✈️"},{id:"instagram",label:"Instagram",icon:"📷"},{id:"tiktok",label:"TikTok",icon:"🎵"}],D=["Kinshasa","Lubumbashi","Goma","Kisangani","Kananga","Bukavu","Mbuji-Mayi"],L=["18-25","26-35","36-50","51-65","65+"];return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-800 rounded-lg",children:l.jsx(qh,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Nouvelle Campagne"}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Étape ",o," sur ",a]})]})]}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(no,{className:"w-5 h-5 text-gray-500"})})]}),l.jsx("div",{className:"px-6 py-4",children:l.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${o/a*100}%`}})})}),l.jsxs("div",{className:"p-6",children:[o===1&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Informations de base"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Titre de la campagne"}),l.jsx("input",{type:"text",value:n.title,onChange:O=>i($=>({...$,title:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",placeholder:"Ex: Fact-check élections 2024"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),l.jsx("textarea",{value:n.description,onChange:O=>i($=>({...$,description:O.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",placeholder:"Décrivez l'objectif de la campagne..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type de campagne"}),l.jsxs("select",{value:n.type,onChange:O=>i($=>({...$,type:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",children:[l.jsx("option",{value:"fact_check",children:"Fact-check"}),l.jsx("option",{value:"educational",children:"Éducation"}),l.jsx("option",{value:"counter_narrative",children:"Contre-narratif"}),l.jsx("option",{value:"awareness",children:"Sensibilisation"}),l.jsx("option",{value:"community_engagement",children:"Engagement communautaire"})]})]})]}),o===2&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Plateformes cibles"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Sélectionnez les plateformes où vous voulez diffuser votre campagne."}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:P.map(O=>l.jsx("button",{onClick:()=>p(O.id),className:`p-4 border-2 rounded-lg transition-all ${n.platforms.includes(O.id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-300"}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-2xl",children:O.icon}),l.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:O.label})]})},O.id))})]}),o===3&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Ciblage démographique"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Zones géographiques"}),l.jsx("div",{className:"grid grid-cols-2 gap-2",children:D.map(O=>l.jsx("button",{onClick:()=>g(O),className:`p-3 text-sm border rounded-lg transition-all ${n.targetLocations.includes(O)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-blue-300"}`,children:O},O))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Groupes d'âge"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(O=>l.jsxs("button",{onClick:()=>v(O),className:`px-3 py-2 text-sm border rounded-lg transition-all ${n.targetAgeGroups.includes(O)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-blue-300"}`,children:[O," ans"]},O))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Mots-clés de ciblage"}),l.jsxs("div",{className:"flex gap-2 mb-2",children:[l.jsx("input",{type:"text",value:n.newKeyword,onChange:O=>i($=>({...$,newKeyword:O.target.value})),onKeyPress:O=>O.key==="Enter"&&w(),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",placeholder:"Ajouter un mot-clé..."}),l.jsx("button",{onClick:w,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:l.jsx(qh,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"flex flex-wrap gap-2",children:n.keywords.map(O=>l.jsxs("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-full text-sm flex items-center gap-2",children:["#",O,l.jsx("button",{onClick:()=>T(O),className:"text-gray-500 hover:text-red-500",children:l.jsx(no,{className:"w-3 h-3"})})]},O))})]})]}),o===4&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4",children:"Planning et budget"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date de début"}),l.jsx("input",{type:"datetime-local",value:n.startDate,onChange:O=>i($=>({...$,startDate:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date de fin"}),l.jsx("input",{type:"datetime-local",value:n.endDate,onChange:O=>i($=>({...$,endDate:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Budget maximum (USD)"}),l.jsx("input",{type:"number",value:n.budget,onChange:O=>i($=>({...$,budget:parseInt(O.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",placeholder:"1000"}),n.budget>0&&l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Portée estimée: ",(n.budget*10).toLocaleString()," personnes"]})]}),n.budget>1e4&&l.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(hi,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400"}),l.jsx("span",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Approbation requise"})]}),l.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"Cette campagne nécessitera une approbation managériale en raison du budget élevé."})]})]})]}),l.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-700",children:[l.jsx("button",{onClick:()=>u(Math.max(1,o-1)),disabled:o===1,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Précédent"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Annuler"}),o<a?l.jsx("button",{onClick:()=>u(o+1),disabled:!I(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Suivant"}):l.jsx("button",{onClick:A,disabled:!I(),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Créer la campagne"})]})]})]})})},ULe=({isOpen:t,onClose:e,onSubmit:r})=>{const[n,i]=Y.useState({name:"",platforms:[],triggers:[],responses:[],approvalRequired:!1,active:!0,newTriggerType:"keyword",newTriggerPattern:"",newTriggerConfidence:.8,newTriggerCooldown:60,newResponsePlatform:"twitter",newResponseContent:"",newResponseTone:"professional"});if(!t)return null;const o=[{id:"twitter",label:"Twitter",icon:"🐦"},{id:"facebook",label:"Facebook",icon:"📘"},{id:"whatsapp",label:"WhatsApp",icon:"💬"},{id:"telegram",label:"Telegram",icon:"✈️"},{id:"instagram",label:"Instagram",icon:"📷"},{id:"all",label:"Toutes les plateformes",icon:"🌐"}],u=[{id:"keyword",label:"Mot-clé",icon:Uie},{id:"hashtag",label:"Hashtag",icon:qp},{id:"sentiment",label:"Sentiment",icon:lf},{id:"misinformation_detected",label:"Désinformation détectée",icon:oi}],a=[{id:"professional",label:"Professionnel"},{id:"educational",label:"Éducatif"},{id:"empathetic",label:"Empathique"},{id:"corrective",label:"Correctif"}],p=P=>{i(D=>({...D,platforms:D.platforms.includes(P)?D.platforms.filter(L=>L!==P):[...D.platforms,P]}))},g=()=>{if(!n.newTriggerPattern.trim())return;const P={id:`trigger-${Date.now()}`,type:n.newTriggerType,patterns:[n.newTriggerPattern.trim()],conditions:{confidence:n.newTriggerConfidence,reach:1e3},cooldown:n.newTriggerCooldown};i(D=>({...D,triggers:[...D.triggers,P],newTriggerPattern:""}))},v=P=>{i(D=>({...D,triggers:D.triggers.filter(L=>L.id!==P)}))},w=()=>{if(!n.newResponseContent.trim())return;const P={id:`response-${Date.now()}`,platform:n.newResponsePlatform,content:n.newResponseContent.trim(),language:"fr",includeFactCheck:!0,includeSources:!0,personalized:!1,tone:n.newResponseTone};i(D=>({...D,responses:[...D.responses,P],newResponseContent:""}))},T=P=>{i(D=>({...D,responses:D.responses.filter(L=>L.id!==P)}))},A=()=>{const P={name:n.name,active:n.active,platforms:n.platforms,triggers:n.triggers,responses:n.responses,approval:{required:n.approvalRequired,approver:n.approvalRequired?"supervisor":void 0}};r(P),e(),i({name:"",platforms:[],triggers:[],responses:[],approvalRequired:!1,active:!0,newTriggerType:"keyword",newTriggerPattern:"",newTriggerConfidence:.8,newTriggerCooldown:60,newResponsePlatform:"twitter",newResponseContent:"",newResponseTone:"professional"})},I=n.name.trim()&&n.platforms.length>0&&n.triggers.length>0&&n.responses.length>0;return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-800 rounded-lg",children:l.jsx(fv,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Nouvelle Réponse Automatique"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Configurez une réponse automatisée aux contenus détectés"})]})]}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(no,{className:"w-5 h-5 text-gray-500"})})]}),l.jsxs("div",{className:"p-6 space-y-8",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Informations de base"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nom de la réponse automatique"}),l.jsx("input",{type:"text",value:n.name,onChange:P=>i(D=>({...D,name:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",placeholder:"Ex: Détection rumeurs électorales"})]}),l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsxs("label",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:n.active,onChange:P=>i(D=>({...D,active:P.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Activer immédiatement"})]}),l.jsxs("label",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:n.approvalRequired,onChange:P=>i(D=>({...D,approvalRequired:P.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Approbation requise"})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Plateformes surveillées"}),l.jsx("div",{className:"grid grid-cols-3 gap-3",children:o.map(P=>l.jsx("button",{onClick:()=>p(P.id),className:`p-3 border-2 rounded-lg transition-all ${n.platforms.includes(P.id)?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-300 dark:border-gray-600 hover:border-green-300"}`,children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-lg",children:P.icon}),l.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:P.label})]})},P.id))})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Déclencheurs"}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type de déclencheur"}),l.jsx("select",{value:n.newTriggerType,onChange:P=>i(D=>({...D,newTriggerType:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",children:u.map(P=>l.jsx("option",{value:P.id,children:P.label},P.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pattern de détection"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:n.newTriggerPattern,onChange:P=>i(D=>({...D,newTriggerPattern:P.target.value})),onKeyPress:P=>P.key==="Enter"&&g(),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",placeholder:n.newTriggerType==="hashtag"?"#FraudeElections":"fraude électorale"}),l.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:l.jsx(qh,{className:"w-4 h-4"})})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Seuil de confiance: ",(n.newTriggerConfidence*100).toFixed(0),"%"]}),l.jsx("input",{type:"range",min:"0.5",max:"1",step:"0.1",value:n.newTriggerConfidence,onChange:P=>i(D=>({...D,newTriggerConfidence:parseFloat(P.target.value)})),className:"w-full"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Délai entre réponses (minutes)"}),l.jsx("input",{type:"number",value:n.newTriggerCooldown,onChange:P=>i(D=>({...D,newTriggerCooldown:parseInt(P.target.value)||60})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",min:"1"})]})]}),n.triggers.length>0&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Déclencheurs configurés:"}),n.triggers.map(P=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-800 text-blue-700 dark:text-blue-300 rounded text-xs font-medium",children:P.type}),l.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:P.patterns.join(", ")}),l.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["(",(P.conditions.confidence*100).toFixed(0),"% confidence, ",P.cooldown,"min cooldown)"]})]}),l.jsx("button",{onClick:()=>v(P.id),className:"text-red-500 hover:text-red-700",children:l.jsx(no,{className:"w-4 h-4"})})]},P.id))]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Modèles de réponse"}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Plateforme"}),l.jsx("select",{value:n.newResponsePlatform,onChange:P=>i(D=>({...D,newResponsePlatform:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",children:o.filter(P=>P.id!=="all").map(P=>l.jsx("option",{value:P.id,children:P.label},P.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ton de la réponse"}),l.jsx("select",{value:n.newResponseTone,onChange:P=>i(D=>({...D,newResponseTone:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",children:a.map(P=>l.jsx("option",{value:P.id,children:P.label},P.id))})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contenu de la réponse"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("textarea",{value:n.newResponseContent,onChange:P=>i(D=>({...D,newResponseContent:P.target.value})),rows:3,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",placeholder:"Rédigez le message de réponse automatique..."}),l.jsx("button",{onClick:w,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors self-start",children:l.jsx(qh,{className:"w-4 h-4"})})]})]}),n.responses.length>0&&l.jsxs("div",{className:"space-y-2",children:[l.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Réponses configurées:"}),n.responses.map(P=>l.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-800 text-green-700 dark:text-green-300 rounded text-xs font-medium",children:P.platform}),l.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded text-xs",children:P.tone})]}),l.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-100",children:P.content})]}),l.jsx("button",{onClick:()=>T(P.id),className:"text-red-500 hover:text-red-700 ml-2",children:l.jsx(no,{className:"w-4 h-4"})})]})},P.id))]})]})]}),l.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[n.triggers.length," déclencheur(s), ",n.responses.length," réponse(s)"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Annuler"}),l.jsx("button",{onClick:A,disabled:!I,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Créer la réponse automatique"})]})]})]})})},qLe=()=>{const[t,e]=Y.useState("overview"),[r,n]=Y.useState([]),[i,o]=Y.useState([]),[u,a]=Y.useState([]),[p,g]=Y.useState([]),[v,w]=Y.useState(null),[T,A]=Y.useState(!0),[I,P]=Y.useState(!1),[D,L]=Y.useState({status:"all",type:"all",platform:"all",search:""}),[O,$]=Y.useState(!1),[G,B]=Y.useState(!1);Y.useEffect(()=>{J()},[]),Y.useEffect(()=>{let re;return I&&(re=setInterval(async()=>{try{const oe=await Wl.simulateRealTimeUpdate();n(oe.campaigns),o(oe.autoResponses)}catch(oe){console.error("Real-time update failed:",oe)}},1e4)),()=>{re&&clearInterval(re)}},[I]);const J=async()=>{A(!0);try{const[re,oe,ae,xe,ye]=await Promise.all([Wl.getCounterCampaigns(),Wl.getAutoResponses(),Wl.getRapidResponses(),Wl.getCommunityEngagements(),Wl.getCounterActionMetrics()]);n(re),o(oe),a(ae),g(xe),w(ye)}catch(re){console.error("Error loading counter-action data:",re)}finally{A(!1)}},W=async re=>{try{const oe=await Wl.toggleAutoResponse(re);o(ae=>ae.map(xe=>xe.id===re?oe:xe))}catch(oe){console.error("Error toggling auto response:",oe)}},H=async re=>{try{const oe=await Wl.createCampaign(re);n(xe=>[oe,...xe]);const ae=await Wl.getCounterActionMetrics();w(ae)}catch(oe){console.error("Error creating campaign:",oe)}},V=async re=>{try{const oe=await Wl.createAutoResponse(re);o(xe=>[oe,...xe]);const ae=await Wl.getCounterActionMetrics();w(ae)}catch(oe){console.error("Error creating auto response:",oe)}},se=re=>re>=1e6?`${(re/1e6).toFixed(1)}M`:re>=1e3?`${(re/1e3).toFixed(1)}K`:re.toString(),K=re=>{switch(re){case"active":return"bg-green-100 text-green-700 dark:bg-green-800 dark:text-green-100";case"paused":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-800 dark:text-yellow-100";case"completed":return"bg-blue-100 text-blue-700 dark:bg-blue-800 dark:text-blue-100";case"draft":return"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-100";case"deploying":return"bg-purple-100 text-purple-700 dark:bg-purple-800 dark:text-purple-100";case"critical":return"bg-red-100 text-red-700 dark:bg-red-800 dark:text-red-100";case"high":return"bg-orange-100 text-orange-700 dark:bg-orange-800 dark:text-orange-100";case"medium":return"bg-yellow-100 text-yellow-700 dark:bg-yellow-800 dark:text-yellow-100";case"low":return"bg-green-100 text-green-700 dark:bg-green-800 dark:text-green-100";default:return"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-100"}},ce=re=>{switch(re){case"twitter":return"🐦";case"facebook":return"📘";case"whatsapp":return"📱";case"telegram":return"✈️";case"instagram":return"📷";case"tiktok":return"🎵";case"all":return"🌐";default:return"📡"}};if(T)return l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx(ro,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-gray-400"}),l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Chargement des données de contre-attaque..."})]})});const ne=[{id:"overview",label:"Vue d'ensemble",icon:No},{id:"campaigns",label:"Campagnes",icon:il,badge:r.filter(re=>re.status==="active").length},{id:"auto-responses",label:"Réponses Auto",icon:fv,badge:i.filter(re=>re.active).length},{id:"rapid-response",label:"Réponse Rapide",icon:Mh,badge:u.filter(re=>re.status==="active").length},{id:"community",label:"Communauté",icon:ea,badge:p.filter(re=>re.status==="active").length}];return l.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-800 rounded-lg",children:l.jsx(gl,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Actions de Contre-Attaque"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gestion des campagnes défensives et réponses automatisées"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("button",{onClick:()=>P(!I),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${I?"bg-green-100 text-green-700 dark:bg-green-800 dark:text-green-100":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}`,children:[l.jsx(ds,{className:`w-4 h-4 ${I?"animate-pulse":""}`}),"Temps réel"]}),l.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(ro,{className:"w-4 h-4"}),"Actualiser"]})]})]}),v&&l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Campagnes Actives"}),l.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[v.activeCampaigns,"/",v.totalCampaigns]})]}),l.jsx(il,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})]}),l.jsxs("div",{className:"mt-4 flex items-center",children:[l.jsx(ii,{className:"w-4 h-4 text-green-500 mr-1"}),l.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:"+12% ce mois"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Portée Totale"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:se(v.totalReach)})]}),l.jsx(ea,{className:"w-8 h-8 text-green-600 dark:text-green-400"})]}),l.jsxs("div",{className:"mt-4 flex items-center",children:[l.jsx(ii,{className:"w-4 h-4 text-green-500 mr-1"}),l.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:"+8% cette semaine"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Désinformation Contrée"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:v.misinformationCountered})]}),l.jsx(hi,{className:"w-8 h-8 text-red-600 dark:text-red-400"})]}),l.jsxs("div",{className:"mt-4 flex items-center",children:[l.jsx(ii,{className:"w-4 h-4 text-green-500 mr-1"}),l.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:"+25% ce mois"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Temps de Réponse"}),l.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[v.responseTime,"min"]})]}),l.jsx(ga,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})]}),l.jsx("div",{className:"mt-4 flex items-center",children:l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Efficacité: ",(v.effectiveness*100).toFixed(0),"%"]})})]})]}),l.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:l.jsx("nav",{className:"flex space-x-8",children:ne.map(re=>{const oe=re.icon;return l.jsxs("button",{onClick:()=>e(re.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm transition-colors ${t===re.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[l.jsx(oe,{className:"w-4 h-4"}),re.label,re.badge&&re.badge>0&&l.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-800 dark:text-blue-100 rounded-full",children:re.badge})]},re.id)})})}),t==="overview"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Actions Rapides"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("button",{onClick:()=>$(!0),className:"flex items-center gap-3 p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors group",children:[l.jsx(qh,{className:"w-6 h-6 text-gray-400 group-hover:text-blue-500"}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Nouvelle Campagne"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Créer une campagne de contre-attaque"})]})]}),l.jsxs("button",{onClick:()=>B(!0),className:"flex items-center gap-3 p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover:border-green-500 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors group",children:[l.jsx(fv,{className:"w-6 h-6 text-gray-400 group-hover:text-green-500"}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Réponse Automatique"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Configurer des réponses auto"})]})]}),l.jsxs("button",{onClick:()=>alert("Fonctionnalité de réponse rapide en développement"),className:"flex items-center gap-3 p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover:border-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors group",children:[l.jsx(Mh,{className:"w-6 h-6 text-gray-400 group-hover:text-red-500"}),l.jsxs("div",{className:"text-left",children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Réponse d'Urgence"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Activer une réponse rapide"})]})]})]})]}),v&&v.recentActivity&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Activité Récente"}),l.jsx("div",{className:"space-y-3",children:v.recentActivity.map(re=>l.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 dark:border-gray-700 last:border-0",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${re.type==="campaign"?"bg-blue-100 dark:bg-blue-800":re.type==="auto_response"?"bg-green-100 dark:bg-green-800":re.type==="rapid_response"?"bg-red-100 dark:bg-red-800":"bg-purple-100 dark:bg-purple-800"}`,children:[re.type==="campaign"&&l.jsx(il,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),re.type==="auto_response"&&l.jsx(fv,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),re.type==="rapid_response"&&l.jsx(Mh,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),re.type==="community"&&l.jsx(ea,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:re.action}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(re.timestamp).toLocaleString("fr-FR")})]})]}),re.impact&&l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:["+",se(re.impact)]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"portée"})]})]},re.id))})]})]}),t==="campaigns"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"relative",children:[l.jsx(iu,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Rechercher des campagnes...",value:D.search,onChange:re=>L(oe=>({...oe,search:re.target.value})),className:"pl-10 pr-4 py-2 w-full border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-gray-100"})]})}),l.jsxs("select",{value:D.status,onChange:re=>L(oe=>({...oe,status:re.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",children:[l.jsx("option",{value:"all",children:"Tous les statuts"}),l.jsx("option",{value:"active",children:"Actif"}),l.jsx("option",{value:"paused",children:"En pause"}),l.jsx("option",{value:"completed",children:"Terminé"}),l.jsx("option",{value:"draft",children:"Brouillon"})]}),l.jsxs("select",{value:D.type,onChange:re=>L(oe=>({...oe,type:re.target.value})),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-gray-100",children:[l.jsx("option",{value:"all",children:"Tous les types"}),l.jsx("option",{value:"fact_check",children:"Fact-check"}),l.jsx("option",{value:"educational",children:"Éducation"}),l.jsx("option",{value:"counter_narrative",children:"Contre-narratif"}),l.jsx("option",{value:"awareness",children:"Sensibilisation"})]})]})}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:(()=>{if(r.length===0)return l.jsx("div",{className:"col-span-2 text-center py-12",children:l.jsxs("div",{className:"text-gray-400 dark:text-gray-500 mb-4",children:[l.jsx(il,{className:"w-12 h-12 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium mb-2",children:"Aucune campagne disponible"}),l.jsx("p",{className:"text-sm",children:"Les données de campagne sont en cours de chargement..."})]})});const re=r.filter(oe=>!(D.status!=="all"&&oe.status!==D.status||D.type!=="all"&&oe.type!==D.type||D.search&&!oe.title.toLowerCase().includes(D.search.toLowerCase())&&!oe.description.toLowerCase().includes(D.search.toLowerCase())));return re.length===0?l.jsx("div",{className:"col-span-2 text-center py-12",children:l.jsxs("div",{className:"text-gray-400 dark:text-gray-500 mb-4",children:[l.jsx(sb,{className:"w-12 h-12 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium mb-2",children:"Aucun résultat"}),l.jsx("p",{className:"text-sm",children:"Aucune campagne ne correspond aux filtres sélectionnés."})]})}):re.map(oe=>l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:oe.title}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${K(oe.status)}`,children:oe.status})]}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:oe.description}),l.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(il,{className:"w-4 h-4"}),l.jsx("span",{children:oe.type.replace("_","-")})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ea,{className:"w-4 h-4"}),l.jsxs("span",{children:[se(oe.metrics.reach)," portée"]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(hi,{className:"w-4 h-4"}),l.jsxs("span",{children:[oe.metrics.effectiveness.misinformationReduced," contrées"]})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:l.jsx(ul,{className:"w-4 h-4"})}),l.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:l.jsx(aae,{className:"w-4 h-4"})}),oe.status==="active"?l.jsx("button",{className:"p-2 text-orange-500 hover:text-orange-600",children:l.jsx(Ug,{className:"w-4 h-4"})}):l.jsx("button",{className:"p-2 text-green-500 hover:text-green-600",children:l.jsx(qg,{className:"w-4 h-4"})})]})]}),l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Plateformes:"}),l.jsx("div",{className:"flex gap-1",children:oe.platforms.map(ae=>l.jsx("span",{className:"text-sm",children:ce(ae)},ae))})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-100 dark:border-gray-700",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:se(oe.metrics.engagement.likes+oe.metrics.engagement.shares)}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Engagement"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[(oe.metrics.effectiveness.narrativeShift*100).toFixed(0),"%"]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Impact"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["$",oe.metrics.costs.spent.toLocaleString()]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Dépensé"})]})]})]},oe.id))})()})]}),t==="auto-responses"&&l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Réponses Automatiques"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Gestion des réponses automatisées aux contenus détectés"})]}),l.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:i.map(re=>l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:re.name}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${re.active?"bg-green-100 text-green-700 dark:bg-green-800 dark:text-green-100":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-100"}`,children:re.active?"Actif":"Inactif"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Plateformes"}),l.jsx("div",{className:"flex gap-1 mt-1",children:re.platforms.map(oe=>l.jsx("span",{children:ce(oe)},oe))})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Déclenchements"}),l.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:re.metrics.triggered})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Efficacité"}),l.jsxs("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:[(re.metrics.effectiveness*100).toFixed(0),"%"]})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:()=>W(re.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${re.active?"bg-orange-100 text-orange-700 hover:bg-orange-200 dark:bg-orange-800 dark:text-orange-100":"bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-800 dark:text-green-100"}`,children:[re.active?l.jsx(Ug,{className:"w-4 h-4"}):l.jsx(qg,{className:"w-4 h-4"}),re.active?"Pause":"Activer"]}),l.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:l.jsx(V0,{className:"w-4 h-4"})})]})]}),re.lastTriggered&&l.jsxs("div",{className:"mt-3 text-sm text-gray-500 dark:text-gray-400",children:["Dernier déclenchement: ",new Date(re.lastTriggered).toLocaleString("fr-FR")]})]},re.id))})]})}),t==="rapid-response"&&l.jsx("div",{className:"space-y-6",children:l.jsx("div",{className:"grid grid-cols-1 gap-6",children:u.map(re=>l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[l.jsx("div",{className:"flex items-start justify-between mb-4",children:l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:re.title}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${K(re.urgency)}`,children:re.urgency}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${K(re.status)}`,children:re.status})]}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:re.triggerEvent.description}),l.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ga,{className:"w-4 h-4"}),l.jsxs("span",{children:["Temps de réponse: ",re.metrics.responseTime,"min"]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ea,{className:"w-4 h-4"}),l.jsxs("span",{children:["Portée: ",se(re.metrics.reach)]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(il,{className:"w-4 h-4"}),l.jsxs("span",{children:["Efficacité: ",(re.metrics.effectiveness*100).toFixed(0),"%"]})]})]})]})}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:["Actions (",re.actions.filter(oe=>oe.status==="completed").length,"/",re.actions.length,")"]}),re.actions.map(oe=>l.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[l.jsxs("div",{className:`w-4 h-4 rounded-full flex items-center justify-center ${oe.status==="completed"?"bg-green-500":oe.status==="in_progress"?"bg-blue-500":oe.status==="failed"?"bg-red-500":"bg-gray-400"}`,children:[oe.status==="completed"&&l.jsx(hi,{className:"w-3 h-3 text-white"}),oe.status==="failed"&&l.jsx(ab,{className:"w-3 h-3 text-white"})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:oe.type.replace("_"," ")}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:oe.content})]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:oe.completedAt?new Date(oe.completedAt).toLocaleTimeString("fr-FR"):new Date(oe.scheduledFor).toLocaleTimeString("fr-FR")})]},oe.id))]})]},re.id))})}),t==="community"&&l.jsx("div",{className:"space-y-6",children:l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:p.map(re=>l.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-1",children:re.title}),l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${K(re.status)}`,children:re.status})]}),l.jsx(ea,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Participants"}),l.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:re.participants.length})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Portée"}),l.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:se(re.impact.peopleReached)})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3 pt-4 border-t border-gray-100 dark:border-gray-700",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:re.impact.misinformationCorrected}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Corrigées"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:re.impact.trustedSourcesShared}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Sources partagées"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:[(re.impact.communityGrowth*100).toFixed(0),"%"]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Croissance"})]})]})]},re.id))})}),l.jsx(VLe,{isOpen:O,onClose:()=>$(!1),onSubmit:H}),l.jsx(ULe,{isOpen:G,onClose:()=>B(!1),onSubmit:V})]})},u5=Y.createContext({});function d5(t){const e=Y.useRef(null);return e.current===null&&(e.current=t()),e.current}const h5=typeof window<"u",hX=h5?Y.useLayoutEffect:Y.useEffect,lE=Y.createContext(null);function f5(t,e){t.indexOf(e)===-1&&t.push(e)}function p5(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const xd=(t,e,r)=>r>e?e:r<t?t:r;let m5=()=>{};const vd={},fX=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function pX(t){return typeof t=="object"&&t!==null}const mX=t=>/^0[^.\s]+$/u.test(t);function g5(t){let e;return()=>(e===void 0&&(e=t()),e)}const fl=t=>t,GLe=(t,e)=>r=>e(t(r)),Eb=(...t)=>t.reduce(GLe),G_=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class y5{constructor(){this.subscriptions=[]}add(e){return f5(this.subscriptions,e),()=>p5(this.subscriptions,e)}notify(e,r,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,r,n);else for(let o=0;o<i;o++){const u=this.subscriptions[o];u&&u(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const eu=t=>t*1e3,tu=t=>t/1e3;function gX(t,e){return e?t*(1e3/e):0}const yX=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,WLe=1e-7,HLe=12;function KLe(t,e,r,n,i){let o,u,a=0;do u=e+(r-e)/2,o=yX(u,n,i)-t,o>0?r=u:e=u;while(Math.abs(o)>WLe&&++a<HLe);return u}function jb(t,e,r,n){if(t===e&&r===n)return fl;const i=o=>KLe(o,0,1,t,r);return o=>o===0||o===1?o:yX(i(o),e,n)}const xX=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,vX=t=>e=>1-t(1-e),_X=jb(.33,1.53,.69,.99),x5=vX(_X),bX=xX(x5),wX=t=>(t*=2)<1?.5*x5(t):.5*(2-Math.pow(2,-10*(t-1))),v5=t=>1-Math.sin(Math.acos(t)),kX=vX(v5),TX=xX(v5),ZLe=jb(.42,0,1,1),XLe=jb(0,0,.58,1),SX=jb(.42,0,.58,1),YLe=t=>Array.isArray(t)&&typeof t[0]!="number",EX=t=>Array.isArray(t)&&typeof t[0]=="number",JLe={linear:fl,easeIn:ZLe,easeInOut:SX,easeOut:XLe,circIn:v5,circInOut:TX,circOut:kX,backIn:x5,backInOut:bX,backOut:_X,anticipate:wX},QLe=t=>typeof t=="string",$B=t=>{if(EX(t)){m5(t.length===4);const[e,r,n,i]=t;return jb(e,r,n,i)}else if(QLe(t))return JLe[t];return t},Iw=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],FB={value:null,addProjectionMetrics:null};function eze(t,e){let r=new Set,n=new Set,i=!1,o=!1;const u=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},p=0;function g(w){u.has(w)&&(v.schedule(w),t()),p++,w(a)}const v={schedule:(w,T=!1,A=!1)=>{const P=A&&i?r:n;return T&&u.add(w),P.has(w)||P.add(w),w},cancel:w=>{n.delete(w),u.delete(w)},process:w=>{if(a=w,i){o=!0;return}i=!0,[r,n]=[n,r],r.forEach(g),e&&FB.value&&FB.value.frameloop[e].push(p),p=0,r.clear(),i=!1,o&&(o=!1,v.process(w))}};return v}const tze=40;function jX(t,e){let r=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>r=!0,u=Iw.reduce(($,G)=>($[G]=eze(o,e?G:void 0),$),{}),{setup:a,read:p,resolveKeyframes:g,preUpdate:v,update:w,preRender:T,render:A,postRender:I}=u,P=()=>{const $=vd.useManualTiming?i.timestamp:performance.now();r=!1,vd.useManualTiming||(i.delta=n?1e3/60:Math.max(Math.min($-i.timestamp,tze),1)),i.timestamp=$,i.isProcessing=!0,a.process(i),p.process(i),g.process(i),v.process(i),w.process(i),T.process(i),A.process(i),I.process(i),i.isProcessing=!1,r&&e&&(n=!1,t(P))},D=()=>{r=!0,n=!0,i.isProcessing||t(P)};return{schedule:Iw.reduce(($,G)=>{const B=u[G];return $[G]=(J,W=!1,H=!1)=>(r||D(),B.schedule(J,W,H)),$},{}),cancel:$=>{for(let G=0;G<Iw.length;G++)u[Iw[G]].cancel($)},state:i,steps:u}}const{schedule:pi,cancel:tf,state:za,steps:eN}=jX(typeof requestAnimationFrame<"u"?requestAnimationFrame:fl,!0);let u2;function rze(){u2=void 0}const Js={now:()=>(u2===void 0&&Js.set(za.isProcessing||vd.useManualTiming?za.timestamp:performance.now()),u2),set:t=>{u2=t,queueMicrotask(rze)}},AX=t=>e=>typeof e=="string"&&e.startsWith(t),_5=AX("--"),nze=AX("var(--"),b5=t=>nze(t)?ize.test(t.split("/*")[0].trim()):!1,ize=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,ly={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},W_={...ly,transform:t=>xd(0,1,t)},Mw={...ly,default:1},Nv=t=>Math.round(t*1e5)/1e5,w5=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function aze(t){return t==null}const sze=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,k5=(t,e)=>r=>!!(typeof r=="string"&&sze.test(r)&&r.startsWith(t)||e&&!aze(r)&&Object.prototype.hasOwnProperty.call(r,e)),NX=(t,e,r)=>n=>{if(typeof n!="string")return n;const[i,o,u,a]=n.match(w5);return{[t]:parseFloat(i),[e]:parseFloat(o),[r]:parseFloat(u),alpha:a!==void 0?parseFloat(a):1}},oze=t=>xd(0,255,t),tN={...ly,transform:t=>Math.round(oze(t))},xp={test:k5("rgb","red"),parse:NX("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+tN.transform(t)+", "+tN.transform(e)+", "+tN.transform(r)+", "+Nv(W_.transform(n))+")"};function lze(t){let e="",r="",n="",i="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),i=t.substring(4,5),e+=e,r+=r,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const E4={test:k5("#"),parse:lze,transform:xp.transform},Ab=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),lh=Ab("deg"),ru=Ab("%"),Ir=Ab("px"),cze=Ab("vh"),uze=Ab("vw"),BB=(()=>({...ru,parse:t=>ru.parse(t)/100,transform:t=>ru.transform(t*100)}))(),xg={test:k5("hsl","hue"),parse:NX("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+ru.transform(Nv(e))+", "+ru.transform(Nv(r))+", "+Nv(W_.transform(n))+")"},Qi={test:t=>xp.test(t)||E4.test(t)||xg.test(t),parse:t=>xp.test(t)?xp.parse(t):xg.test(t)?xg.parse(t):E4.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?xp.transform(t):xg.transform(t),getAnimatableNone:t=>{const e=Qi.parse(t);return e.alpha=0,Qi.transform(e)}},dze=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function hze(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(w5))==null?void 0:e.length)||0)+(((r=t.match(dze))==null?void 0:r.length)||0)>0}const CX="number",PX="color",fze="var",pze="var(",VB="${}",mze=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function H_(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},i=[];let o=0;const a=e.replace(mze,p=>(Qi.test(p)?(n.color.push(o),i.push(PX),r.push(Qi.parse(p))):p.startsWith(pze)?(n.var.push(o),i.push(fze),r.push(p)):(n.number.push(o),i.push(CX),r.push(parseFloat(p))),++o,VB)).split(VB);return{values:r,split:a,indexes:n,types:i}}function IX(t){return H_(t).values}function MX(t){const{split:e,types:r}=H_(t),n=e.length;return i=>{let o="";for(let u=0;u<n;u++)if(o+=e[u],i[u]!==void 0){const a=r[u];a===CX?o+=Nv(i[u]):a===PX?o+=Qi.transform(i[u]):o+=i[u]}return o}}const gze=t=>typeof t=="number"?0:Qi.test(t)?Qi.getAnimatableNone(t):t;function yze(t){const e=IX(t);return MX(t)(e.map(gze))}const rf={test:hze,parse:IX,createTransformer:MX,getAnimatableNone:yze};function rN(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function xze({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let i=0,o=0,u=0;if(!e)i=o=u=r;else{const a=r<.5?r*(1+e):r+e-r*e,p=2*r-a;i=rN(p,a,t+1/3),o=rN(p,a,t),u=rN(p,a,t-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(u*255),alpha:n}}function dT(t,e){return r=>r>0?e:t}const ji=(t,e,r)=>t+(e-t)*r,nN=(t,e,r)=>{const n=t*t,i=r*(e*e-n)+n;return i<0?0:Math.sqrt(i)},vze=[E4,xp,xg],_ze=t=>vze.find(e=>e.test(t));function UB(t){const e=_ze(t);if(!e)return!1;let r=e.parse(t);return e===xg&&(r=xze(r)),r}const qB=(t,e)=>{const r=UB(t),n=UB(e);if(!r||!n)return dT(t,e);const i={...r};return o=>(i.red=nN(r.red,n.red,o),i.green=nN(r.green,n.green,o),i.blue=nN(r.blue,n.blue,o),i.alpha=ji(r.alpha,n.alpha,o),xp.transform(i))},j4=new Set(["none","hidden"]);function bze(t,e){return j4.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function wze(t,e){return r=>ji(t,e,r)}function T5(t){return typeof t=="number"?wze:typeof t=="string"?b5(t)?dT:Qi.test(t)?qB:Sze:Array.isArray(t)?DX:typeof t=="object"?Qi.test(t)?qB:kze:dT}function DX(t,e){const r=[...t],n=r.length,i=t.map((o,u)=>T5(o)(o,e[u]));return o=>{for(let u=0;u<n;u++)r[u]=i[u](o);return r}}function kze(t,e){const r={...t,...e},n={};for(const i in r)t[i]!==void 0&&e[i]!==void 0&&(n[i]=T5(t[i])(t[i],e[i]));return i=>{for(const o in n)r[o]=n[o](i);return r}}function Tze(t,e){const r=[],n={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const o=e.types[i],u=t.indexes[o][n[o]],a=t.values[u]??0;r[i]=a,n[o]++}return r}const Sze=(t,e)=>{const r=rf.createTransformer(e),n=H_(t),i=H_(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?j4.has(t)&&!i.values.length||j4.has(e)&&!n.values.length?bze(t,e):Eb(DX(Tze(n,i),i.values),r):dT(t,e)};function OX(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?ji(t,e,r):T5(t)(t,e)}const Eze=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>pi.update(e,r),stop:()=>tf(e),now:()=>za.isProcessing?za.timestamp:Js.now()}},RX=(t,e,r=10)=>{let n="";const i=Math.max(Math.round(e/r),2);for(let o=0;o<i;o++)n+=Math.round(t(o/(i-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},hT=2e4;function S5(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<hT;)e+=r,n=t.next(e);return e>=hT?1/0:e}function jze(t,e=100,r){const n=r({...t,keyframes:[0,e]}),i=Math.min(S5(n),hT);return{type:"keyframes",ease:o=>n.next(i*o).value/e,duration:tu(i)}}const Aze=5;function LX(t,e,r){const n=Math.max(e-Aze,0);return gX(r-t(n),e-n)}const Di={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},iN=.001;function Nze({duration:t=Di.duration,bounce:e=Di.bounce,velocity:r=Di.velocity,mass:n=Di.mass}){let i,o,u=1-e;u=xd(Di.minDamping,Di.maxDamping,u),t=xd(Di.minDuration,Di.maxDuration,tu(t)),u<1?(i=g=>{const v=g*u,w=v*t,T=v-r,A=A4(g,u),I=Math.exp(-w);return iN-T/A*I},o=g=>{const w=g*u*t,T=w*r+r,A=Math.pow(u,2)*Math.pow(g,2)*t,I=Math.exp(-w),P=A4(Math.pow(g,2),u);return(-i(g)+iN>0?-1:1)*((T-A)*I)/P}):(i=g=>{const v=Math.exp(-g*t),w=(g-r)*t+1;return-iN+v*w},o=g=>{const v=Math.exp(-g*t),w=(r-g)*(t*t);return v*w});const a=5/t,p=Pze(i,o,a);if(t=eu(t),isNaN(p))return{stiffness:Di.stiffness,damping:Di.damping,duration:t};{const g=Math.pow(p,2)*n;return{stiffness:g,damping:u*2*Math.sqrt(n*g),duration:t}}}const Cze=12;function Pze(t,e,r){let n=r;for(let i=1;i<Cze;i++)n=n-t(n)/e(n);return n}function A4(t,e){return t*Math.sqrt(1-e*e)}const Ize=["duration","bounce"],Mze=["stiffness","damping","mass"];function GB(t,e){return e.some(r=>t[r]!==void 0)}function Dze(t){let e={velocity:Di.velocity,stiffness:Di.stiffness,damping:Di.damping,mass:Di.mass,isResolvedFromDuration:!1,...t};if(!GB(t,Mze)&&GB(t,Ize))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),i=n*n,o=2*xd(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:Di.mass,stiffness:i,damping:o}}else{const r=Nze(t);e={...e,...r,mass:Di.mass},e.isResolvedFromDuration=!0}return e}function fT(t=Di.visualDuration,e=Di.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:i}=r;const o=r.keyframes[0],u=r.keyframes[r.keyframes.length-1],a={done:!1,value:o},{stiffness:p,damping:g,mass:v,duration:w,velocity:T,isResolvedFromDuration:A}=Dze({...r,velocity:-tu(r.velocity||0)}),I=T||0,P=g/(2*Math.sqrt(p*v)),D=u-o,L=tu(Math.sqrt(p/v)),O=Math.abs(D)<5;n||(n=O?Di.restSpeed.granular:Di.restSpeed.default),i||(i=O?Di.restDelta.granular:Di.restDelta.default);let $;if(P<1){const B=A4(L,P);$=J=>{const W=Math.exp(-P*L*J);return u-W*((I+P*L*D)/B*Math.sin(B*J)+D*Math.cos(B*J))}}else if(P===1)$=B=>u-Math.exp(-L*B)*(D+(I+L*D)*B);else{const B=L*Math.sqrt(P*P-1);$=J=>{const W=Math.exp(-P*L*J),H=Math.min(B*J,300);return u-W*((I+P*L*D)*Math.sinh(H)+B*D*Math.cosh(H))/B}}const G={calculatedDuration:A&&w||null,next:B=>{const J=$(B);if(A)a.done=B>=w;else{let W=B===0?I:0;P<1&&(W=B===0?eu(I):LX($,B,J));const H=Math.abs(W)<=n,V=Math.abs(u-J)<=i;a.done=H&&V}return a.value=a.done?u:J,a},toString:()=>{const B=Math.min(S5(G),hT),J=RX(W=>G.next(B*W).value,B,30);return B+"ms "+J},toTransition:()=>{}};return G}fT.applyToOptions=t=>{const e=jze(t,100,fT);return t.ease=e.ease,t.duration=eu(e.duration),t.type="keyframes",t};function N4({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:u,min:a,max:p,restDelta:g=.5,restSpeed:v}){const w=t[0],T={done:!1,value:w},A=H=>a!==void 0&&H<a||p!==void 0&&H>p,I=H=>a===void 0?p:p===void 0||Math.abs(a-H)<Math.abs(p-H)?a:p;let P=r*e;const D=w+P,L=u===void 0?D:u(D);L!==D&&(P=L-w);const O=H=>-P*Math.exp(-H/n),$=H=>L+O(H),G=H=>{const V=O(H),se=$(H);T.done=Math.abs(V)<=g,T.value=T.done?L:se};let B,J;const W=H=>{A(T.value)&&(B=H,J=fT({keyframes:[T.value,I(T.value)],velocity:LX($,H,T.value),damping:i,stiffness:o,restDelta:g,restSpeed:v}))};return W(0),{calculatedDuration:null,next:H=>{let V=!1;return!J&&B===void 0&&(V=!0,G(H),W(H)),B!==void 0&&H>=B?J.next(H-B):(!V&&G(H),T)}}}function Oze(t,e,r){const n=[],i=r||vd.mix||OX,o=t.length-1;for(let u=0;u<o;u++){let a=i(t[u],t[u+1]);if(e){const p=Array.isArray(e)?e[u]||fl:e;a=Eb(p,a)}n.push(a)}return n}function Rze(t,e,{clamp:r=!0,ease:n,mixer:i}={}){const o=t.length;if(m5(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const u=t[0]===t[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=Oze(e,n,i),p=a.length,g=v=>{if(u&&v<t[0])return e[0];let w=0;if(p>1)for(;w<t.length-2&&!(v<t[w+1]);w++);const T=G_(t[w],t[w+1],v);return a[w](T)};return r?v=>g(xd(t[0],t[o-1],v)):g}function Lze(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const i=G_(0,e,n);t.push(ji(r,1,i))}}function zze(t){const e=[0];return Lze(e,t.length-1),e}function $ze(t,e){return t.map(r=>r*e)}function Fze(t,e){return t.map(()=>e||SX).splice(0,t.length-1)}function Cv({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const i=YLe(n)?n.map($B):$B(n),o={done:!1,value:e[0]},u=$ze(r&&r.length===e.length?r:zze(e),t),a=Rze(u,e,{ease:Array.isArray(i)?i:Fze(e,i)});return{calculatedDuration:t,next:p=>(o.value=a(p),o.done=p>=t,o)}}const Bze=t=>t!==null;function E5(t,{repeat:e,repeatType:r="loop"},n,i=1){const o=t.filter(Bze),a=i<0||e&&r!=="loop"&&e%2===1?0:o.length-1;return!a||n===void 0?o[a]:n}const Vze={decay:N4,inertia:N4,tween:Cv,keyframes:Cv,spring:fT};function zX(t){typeof t.type=="string"&&(t.type=Vze[t.type])}class j5{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const Uze=t=>t/100;class A5 extends j5{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,i;const{motionValue:r}=this.options;r&&r.updatedAt!==Js.now()&&this.tick(Js.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(i=(n=this.options).onStop)==null||i.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;zX(e);const{type:r=Cv,repeat:n=0,repeatDelay:i=0,repeatType:o,velocity:u=0}=e;let{keyframes:a}=e;const p=r||Cv;p!==Cv&&typeof a[0]!="number"&&(this.mixKeyframes=Eb(Uze,OX(a[0],a[1])),a=[0,100]);const g=p({...e,keyframes:a});o==="mirror"&&(this.mirroredGenerator=p({...e,keyframes:[...a].reverse(),velocity:-u})),g.calculatedDuration===null&&(g.calculatedDuration=S5(g));const{calculatedDuration:v}=g;this.calculatedDuration=v,this.resolvedDuration=v+i,this.totalDuration=this.resolvedDuration*(n+1)-i,this.generator=g}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:i,mixKeyframes:o,mirroredGenerator:u,resolvedDuration:a,calculatedDuration:p}=this;if(this.startTime===null)return n.next(0);const{delay:g=0,keyframes:v,repeat:w,repeatType:T,repeatDelay:A,type:I,onUpdate:P,finalKeyframe:D}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const L=this.currentTime-g*(this.playbackSpeed>=0?1:-1),O=this.playbackSpeed>=0?L<0:L>i;this.currentTime=Math.max(L,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let $=this.currentTime,G=n;if(w){const H=Math.min(this.currentTime,i)/a;let V=Math.floor(H),se=H%1;!se&&H>=1&&(se=1),se===1&&V--,V=Math.min(V,w+1),!!(V%2)&&(T==="reverse"?(se=1-se,A&&(se-=A/a)):T==="mirror"&&(G=u)),$=xd(0,1,se)*a}const B=O?{done:!1,value:v[0]}:G.next($);o&&(B.value=o(B.value));let{done:J}=B;!O&&p!==null&&(J=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const W=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&J);return W&&I!==N4&&(B.value=E5(v,this.options,D,this.speed)),P&&P(B.value),W&&this.finish(),B}then(e,r){return this.finished.then(e,r)}get duration(){return tu(this.calculatedDuration)}get time(){return tu(this.currentTime)}set time(e){var r;e=eu(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Js.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=tu(this.currentTime))}play(){var i,o;if(this.isStopped)return;const{driver:e=Eze,startTime:r}=this.options;this.driver||(this.driver=e(u=>this.tick(u))),(o=(i=this.options).onPlay)==null||o.call(i);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Js.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function qze(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const vp=t=>t*180/Math.PI,C4=t=>{const e=vp(Math.atan2(t[1],t[0]));return P4(e)},Gze={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:C4,rotateZ:C4,skewX:t=>vp(Math.atan(t[1])),skewY:t=>vp(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},P4=t=>(t=t%360,t<0&&(t+=360),t),WB=C4,HB=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),KB=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Wze={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:HB,scaleY:KB,scale:t=>(HB(t)+KB(t))/2,rotateX:t=>P4(vp(Math.atan2(t[6],t[5]))),rotateY:t=>P4(vp(Math.atan2(-t[2],t[0]))),rotateZ:WB,rotate:WB,skewX:t=>vp(Math.atan(t[4])),skewY:t=>vp(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function I4(t){return t.includes("scale")?1:0}function M4(t,e){if(!t||t==="none")return I4(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,i;if(r)n=Wze,i=r;else{const a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Gze,i=a}if(!i)return I4(e);const o=n[e],u=i[1].split(",").map(Kze);return typeof o=="function"?o(u):u[o]}const Hze=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return M4(r,e)};function Kze(t){return parseFloat(t.trim())}const cy=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],uy=(()=>new Set(cy))(),ZB=t=>t===ly||t===Ir,Zze=new Set(["x","y","z"]),Xze=cy.filter(t=>!Zze.has(t));function Yze(t){const e=[];return Xze.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const jp={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>M4(e,"x"),y:(t,{transform:e})=>M4(e,"y")};jp.translateX=jp.x;jp.translateY=jp.y;const Ap=new Set;let D4=!1,O4=!1,R4=!1;function $X(){if(O4){const t=Array.from(Ap).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const i=Yze(n);i.length&&(r.set(n,i),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=r.get(n);i&&i.forEach(([o,u])=>{var a;(a=n.getValue(o))==null||a.set(u)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}O4=!1,D4=!1,Ap.forEach(t=>t.complete(R4)),Ap.clear()}function FX(){Ap.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(O4=!0)})}function Jze(){R4=!0,FX(),$X(),R4=!1}class N5{constructor(e,r,n,i,o,u=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=i,this.element=o,this.isAsync=u}scheduleResolve(){this.state="scheduled",this.isAsync?(Ap.add(this),D4||(D4=!0,pi.read(FX),pi.resolveKeyframes($X))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:i}=this;if(e[0]===null){const o=i==null?void 0:i.get(),u=e[e.length-1];if(o!==void 0)e[0]=o;else if(n&&r){const a=n.readValue(r,u);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=u),i&&o===void 0&&i.set(e[0])}qze(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Ap.delete(this)}cancel(){this.state==="scheduled"&&(Ap.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Qze=t=>t.startsWith("--");function e8e(t,e,r){Qze(e)?t.style.setProperty(e,r):t.style[e]=r}const t8e=g5(()=>window.ScrollTimeline!==void 0),r8e={};function n8e(t,e){const r=g5(t);return()=>r8e[e]??r()}const BX=n8e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),nv=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,XB={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nv([0,.65,.55,1]),circOut:nv([.55,0,1,.45]),backIn:nv([.31,.01,.66,-.59]),backOut:nv([.33,1.53,.69,.99])};function VX(t,e){if(t)return typeof t=="function"?BX()?RX(t,e):"ease-out":EX(t)?nv(t):Array.isArray(t)?t.map(r=>VX(r,e)||XB.easeOut):XB[t]}function i8e(t,e,r,{delay:n=0,duration:i=300,repeat:o=0,repeatType:u="loop",ease:a="easeOut",times:p}={},g=void 0){const v={[e]:r};p&&(v.offset=p);const w=VX(a,i);Array.isArray(w)&&(v.easing=w);const T={delay:n,duration:i,easing:Array.isArray(w)?"linear":w,fill:"both",iterations:o+1,direction:u==="reverse"?"alternate":"normal"};return g&&(T.pseudoElement=g),t.animate(v,T)}function UX(t){return typeof t=="function"&&"applyToOptions"in t}function a8e({type:t,...e}){return UX(t)&&BX()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class s8e extends j5{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:i,pseudoElement:o,allowFlatten:u=!1,finalKeyframe:a,onComplete:p}=e;this.isPseudoElement=!!o,this.allowFlatten=u,this.options=e,m5(typeof e.type!="string");const g=a8e(e);this.animation=i8e(r,n,i,g,o),g.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){const v=E5(i,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(v):e8e(r,n,v),this.animation.cancel()}p==null||p(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return tu(Number(e))}get time(){return tu(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=eu(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&t8e()?(this.animation.timeline=e,fl):r(this)}}const qX={anticipate:wX,backInOut:bX,circInOut:TX};function o8e(t){return t in qX}function l8e(t){typeof t.ease=="string"&&o8e(t.ease)&&(t.ease=qX[t.ease])}const YB=10;class c8e extends s8e{constructor(e){l8e(e),zX(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:i,element:o,...u}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const a=new A5({...u,autoplay:!1}),p=eu(this.finishedTime??this.time);r.setWithVelocity(a.sample(p-YB).value,a.sample(p).value,YB),a.stop()}}const JB=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(rf.test(t)||t==="0")&&!t.startsWith("url("));function u8e(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function d8e(t,e,r,n){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const o=t[t.length-1],u=JB(i,e),a=JB(o,e);return!u||!a?!1:u8e(t)||(r==="spring"||UX(r))&&n}function C5(t){return pX(t)&&"offsetHeight"in t}const h8e=new Set(["opacity","clipPath","filter","transform"]),f8e=g5(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function p8e(t){var g;const{motionValue:e,name:r,repeatDelay:n,repeatType:i,damping:o,type:u}=t;if(!C5((g=e==null?void 0:e.owner)==null?void 0:g.current))return!1;const{onUpdate:a,transformTemplate:p}=e.owner.getProps();return f8e()&&r&&h8e.has(r)&&(r!=="transform"||!p)&&!a&&!n&&i!=="mirror"&&o!==0&&u!=="inertia"}const m8e=40;class g8e extends j5{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:u="loop",keyframes:a,name:p,motionValue:g,element:v,...w}){var I;super(),this.stop=()=>{var P,D;this._animation&&(this._animation.stop(),(P=this.stopTimeline)==null||P.call(this)),(D=this.keyframeResolver)==null||D.cancel()},this.createdAt=Js.now();const T={autoplay:e,delay:r,type:n,repeat:i,repeatDelay:o,repeatType:u,name:p,motionValue:g,element:v,...w},A=(v==null?void 0:v.KeyframeResolver)||N5;this.keyframeResolver=new A(a,(P,D,L)=>this.onKeyframesResolved(P,D,T,!L),p,g,v),(I=this.keyframeResolver)==null||I.scheduleResolve()}onKeyframesResolved(e,r,n,i){this.keyframeResolver=void 0;const{name:o,type:u,velocity:a,delay:p,isHandoff:g,onUpdate:v}=n;this.resolvedAt=Js.now(),d8e(e,o,u,a)||((vd.instantAnimations||!p)&&(v==null||v(E5(e,n,r))),e[0]=e[e.length-1],n.duration=0,n.repeat=0);const T={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>m8e?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},A=!g&&p8e(T)?new c8e({...T,element:T.motionValue.owner.current}):new A5(T);A.finished.then(()=>this.notifyFinished()).catch(fl),this.pendingTimeline&&(this.stopTimeline=A.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=A}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),Jze()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const y8e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function x8e(t){const e=y8e.exec(t);if(!e)return[,];const[,r,n,i]=e;return[`--${r??n}`,i]}function GX(t,e,r=1){const[n,i]=x8e(t);if(!n)return;const o=window.getComputedStyle(e).getPropertyValue(n);if(o){const u=o.trim();return fX(u)?parseFloat(u):u}return b5(i)?GX(i,e,r+1):i}function P5(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const WX=new Set(["width","height","top","left","right","bottom",...cy]),v8e={test:t=>t==="auto",parse:t=>t},HX=t=>e=>e.test(t),KX=[ly,Ir,ru,lh,uze,cze,v8e],QB=t=>KX.find(HX(t));function _8e(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||mX(t):!0}const b8e=new Set(["brightness","contrast","saturate","opacity"]);function w8e(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(w5)||[];if(!n)return t;const i=r.replace(n,"");let o=b8e.has(e)?1:0;return n!==r&&(o*=100),e+"("+o+i+")"}const k8e=/\b([a-z-]*)\(.*?\)/gu,L4={...rf,getAnimatableNone:t=>{const e=t.match(k8e);return e?e.map(w8e).join(" "):t}},e9={...ly,transform:Math.round},T8e={rotate:lh,rotateX:lh,rotateY:lh,rotateZ:lh,scale:Mw,scaleX:Mw,scaleY:Mw,scaleZ:Mw,skew:lh,skewX:lh,skewY:lh,distance:Ir,translateX:Ir,translateY:Ir,translateZ:Ir,x:Ir,y:Ir,z:Ir,perspective:Ir,transformPerspective:Ir,opacity:W_,originX:BB,originY:BB,originZ:Ir},I5={borderWidth:Ir,borderTopWidth:Ir,borderRightWidth:Ir,borderBottomWidth:Ir,borderLeftWidth:Ir,borderRadius:Ir,radius:Ir,borderTopLeftRadius:Ir,borderTopRightRadius:Ir,borderBottomRightRadius:Ir,borderBottomLeftRadius:Ir,width:Ir,maxWidth:Ir,height:Ir,maxHeight:Ir,top:Ir,right:Ir,bottom:Ir,left:Ir,padding:Ir,paddingTop:Ir,paddingRight:Ir,paddingBottom:Ir,paddingLeft:Ir,margin:Ir,marginTop:Ir,marginRight:Ir,marginBottom:Ir,marginLeft:Ir,backgroundPositionX:Ir,backgroundPositionY:Ir,...T8e,zIndex:e9,fillOpacity:W_,strokeOpacity:W_,numOctaves:e9},S8e={...I5,color:Qi,backgroundColor:Qi,outlineColor:Qi,fill:Qi,stroke:Qi,borderColor:Qi,borderTopColor:Qi,borderRightColor:Qi,borderBottomColor:Qi,borderLeftColor:Qi,filter:L4,WebkitFilter:L4},ZX=t=>S8e[t];function XX(t,e){let r=ZX(t);return r!==L4&&(r=rf),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const E8e=new Set(["auto","none","0"]);function j8e(t,e,r){let n=0,i;for(;n<t.length&&!i;){const o=t[n];typeof o=="string"&&!E8e.has(o)&&H_(o).values.length&&(i=t[n]),n++}if(i&&r)for(const o of e)t[o]=XX(r,i)}class A8e extends N5{constructor(e,r,n,i,o){super(e,r,n,i,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let p=0;p<e.length;p++){let g=e[p];if(typeof g=="string"&&(g=g.trim(),b5(g))){const v=GX(g,r.current);v!==void 0&&(e[p]=v),p===e.length-1&&(this.finalKeyframe=g)}}if(this.resolveNoneKeyframes(),!WX.has(n)||e.length!==2)return;const[i,o]=e,u=QB(i),a=QB(o);if(u!==a)if(ZB(u)&&ZB(a))for(let p=0;p<e.length;p++){const g=e[p];typeof g=="string"&&(e[p]=parseFloat(g))}else jp[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let i=0;i<e.length;i++)(e[i]===null||_8e(e[i]))&&n.push(i);n.length&&j8e(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=jp[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const i=r[r.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var a;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const i=e.getValue(r);i&&i.jump(this.measuredOrigin,!1);const o=n.length-1,u=n[o];n[o]=jp[r](e.measureViewportBox(),window.getComputedStyle(e.current)),u!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=u),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([p,g])=>{e.getValue(p).set(g)}),this.resolveNoneKeyframes()}}function N8e(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;e&&(n=e.current);const i=(r==null?void 0:r[t])??n.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const YX=(t,e)=>e&&typeof t=="number"?e.transform(t):t,t9=30,C8e=t=>!isNaN(parseFloat(t));class P8e{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{var u,a;const o=Js.now();if(this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((u=this.events.change)==null||u.notify(this.current),this.dependents))for(const p of this.dependents)p.dirty();i&&((a=this.events.renderRequest)==null||a.notify(this.current))},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=Js.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=C8e(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new y5);const n=this.events[e].add(r);return e==="change"?()=>{n(),pi.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){!r||!this.passiveEffect?this.updateAndNotify(e,r):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Js.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>t9)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,t9);return gX(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function D0(t,e){return new P8e(t,e)}const{schedule:M5,cancel:IBe}=jX(queueMicrotask,!1),Hl={x:!1,y:!1};function JX(){return Hl.x||Hl.y}function I8e(t){return t==="x"||t==="y"?Hl[t]?null:(Hl[t]=!0,()=>{Hl[t]=!1}):Hl.x||Hl.y?null:(Hl.x=Hl.y=!0,()=>{Hl.x=Hl.y=!1})}function QX(t,e){const r=N8e(t),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[r,i,()=>n.abort()]}function r9(t){return!(t.pointerType==="touch"||JX())}function M8e(t,e,r={}){const[n,i,o]=QX(t,r),u=a=>{if(!r9(a))return;const{target:p}=a,g=e(p,a);if(typeof g!="function"||!p)return;const v=w=>{r9(w)&&(g(w),p.removeEventListener("pointerleave",v))};p.addEventListener("pointerleave",v,i)};return n.forEach(a=>{a.addEventListener("pointerenter",u,i)}),o}const eY=(t,e)=>e?t===e?!0:eY(t,e.parentElement):!1,D5=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,D8e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function O8e(t){return D8e.has(t.tagName)||t.tabIndex!==-1}const d2=new WeakSet;function n9(t){return e=>{e.key==="Enter"&&t(e)}}function aN(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const R8e=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=n9(()=>{if(d2.has(r))return;aN(r,"down");const i=n9(()=>{aN(r,"up")}),o=()=>aN(r,"cancel");r.addEventListener("keyup",i,e),r.addEventListener("blur",o,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function i9(t){return D5(t)&&!JX()}function L8e(t,e,r={}){const[n,i,o]=QX(t,r),u=a=>{const p=a.currentTarget;if(!i9(a))return;d2.add(p);const g=e(p,a),v=(A,I)=>{window.removeEventListener("pointerup",w),window.removeEventListener("pointercancel",T),d2.has(p)&&d2.delete(p),i9(A)&&typeof g=="function"&&g(A,{success:I})},w=A=>{v(A,p===window||p===document||r.useGlobalTarget||eY(p,A.target))},T=A=>{v(A,!1)};window.addEventListener("pointerup",w,i),window.addEventListener("pointercancel",T,i)};return n.forEach(a=>{(r.useGlobalTarget?window:a).addEventListener("pointerdown",u,i),C5(a)&&(a.addEventListener("focus",g=>R8e(g,i)),!O8e(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),o}function tY(t){return pX(t)&&"ownerSVGElement"in t}function z8e(t){return tY(t)&&t.tagName==="svg"}const us=t=>!!(t&&t.getVelocity),$8e=[...KX,Qi,rf],F8e=t=>$8e.find(HX(t)),O5=Y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class B8e extends Y.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,i=C5(n)&&n.offsetWidth||0,o=this.props.sizeRef.current;o.height=r.offsetHeight||0,o.width=r.offsetWidth||0,o.top=r.offsetTop,o.left=r.offsetLeft,o.right=i-o.width-o.left}return null}componentDidUpdate(){}render(){return this.props.children}}function V8e({children:t,isPresent:e,anchorX:r,root:n}){const i=Y.useId(),o=Y.useRef(null),u=Y.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=Y.useContext(O5);return Y.useInsertionEffect(()=>{const{width:p,height:g,top:v,left:w,right:T}=u.current;if(e||!o.current||!p||!g)return;const A=r==="left"?`left: ${w}`:`right: ${T}`;o.current.dataset.motionPopId=i;const I=document.createElement("style");a&&(I.nonce=a);const P=n??document.head;return P.appendChild(I),I.sheet&&I.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${p}px !important;
            height: ${g}px !important;
            ${A}px !important;
            top: ${v}px !important;
          }
        `),()=>{P.removeChild(I),P.contains(I)&&P.removeChild(I)}},[e]),l.jsx(B8e,{isPresent:e,childRef:o,sizeRef:u,children:Y.cloneElement(t,{ref:o})})}const U8e=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:i,presenceAffectsLayout:o,mode:u,anchorX:a,root:p})=>{const g=d5(q8e),v=Y.useId();let w=!0,T=Y.useMemo(()=>(w=!1,{id:v,initial:e,isPresent:r,custom:i,onExitComplete:A=>{g.set(A,!0);for(const I of g.values())if(!I)return;n&&n()},register:A=>(g.set(A,!1),()=>g.delete(A))}),[r,g,n]);return o&&w&&(T={...T}),Y.useMemo(()=>{g.forEach((A,I)=>g.set(I,!1))},[r]),Y.useEffect(()=>{!r&&!g.size&&n&&n()},[r]),u==="popLayout"&&(t=l.jsx(V8e,{isPresent:r,anchorX:a,root:p,children:t})),l.jsx(lE.Provider,{value:T,children:t})};function q8e(){return new Map}function rY(t=!0){const e=Y.useContext(lE);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:i}=e,o=Y.useId();Y.useEffect(()=>{if(t)return i(o)},[t]);const u=Y.useCallback(()=>t&&n&&n(o),[o,n,t]);return!r&&n?[!1,u]:[!0]}const Dw=t=>t.key||"";function a9(t){const e=[];return Y.Children.forEach(t,r=>{Y.isValidElement(r)&&e.push(r)}),e}const G8e=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:o="sync",propagate:u=!1,anchorX:a="left",root:p})=>{const[g,v]=rY(u),w=Y.useMemo(()=>a9(t),[t]),T=u&&!g?[]:w.map(Dw),A=Y.useRef(!0),I=Y.useRef(w),P=d5(()=>new Map),[D,L]=Y.useState(w),[O,$]=Y.useState(w);hX(()=>{A.current=!1,I.current=w;for(let J=0;J<O.length;J++){const W=Dw(O[J]);T.includes(W)?P.delete(W):P.get(W)!==!0&&P.set(W,!1)}},[O,T.length,T.join("-")]);const G=[];if(w!==D){let J=[...w];for(let W=0;W<O.length;W++){const H=O[W],V=Dw(H);T.includes(V)||(J.splice(W,0,H),G.push(H))}return o==="wait"&&G.length&&(J=G),$(a9(J)),L(w),null}const{forceRender:B}=Y.useContext(u5);return l.jsx(l.Fragment,{children:O.map(J=>{const W=Dw(J),H=u&&!g?!1:w===O||T.includes(W),V=()=>{if(P.has(W))P.set(W,!0);else return;let se=!0;P.forEach(K=>{K||(se=!1)}),se&&(B==null||B(),$(I.current),u&&(v==null||v()),n&&n())};return l.jsx(U8e,{isPresent:H,initial:!A.current||r?void 0:!1,custom:e,presenceAffectsLayout:i,mode:o,root:p,onExitComplete:H?void 0:V,anchorX:a,children:J},W)})})},nY=Y.createContext({strict:!1}),s9={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},O0={};for(const t in s9)O0[t]={isEnabled:e=>s9[t].some(r=>!!e[r])};function W8e(t){for(const e in t)O0[e]={...O0[e],...t[e]}}const H8e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function pT(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||H8e.has(t)}let iY=t=>!pT(t);function K8e(t){typeof t=="function"&&(iY=e=>e.startsWith("on")?!pT(e):t(e))}try{K8e(require("@emotion/is-prop-valid").default)}catch{}function Z8e(t,e,r){const n={};for(const i in t)i==="values"&&typeof t.values=="object"||(iY(i)||r===!0&&pT(i)||!e&&!pT(i)||t.draggable&&i.startsWith("onDrag"))&&(n[i]=t[i]);return n}function X8e(t){if(typeof Proxy>"u")return t;const e=new Map,r=(...n)=>t(...n);return new Proxy(r,{get:(n,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const cE=Y.createContext({});function uE(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function K_(t){return typeof t=="string"||Array.isArray(t)}const R5=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],L5=["initial",...R5];function dE(t){return uE(t.animate)||L5.some(e=>K_(t[e]))}function aY(t){return!!(dE(t)||t.variants)}function Y8e(t,e){if(dE(t)){const{initial:r,animate:n}=t;return{initial:r===!1||K_(r)?r:void 0,animate:K_(n)?n:void 0}}return t.inherit!==!1?e:{}}function J8e(t){const{initial:e,animate:r}=Y8e(t,Y.useContext(cE));return Y.useMemo(()=>({initial:e,animate:r}),[o9(e),o9(r)])}function o9(t){return Array.isArray(t)?t.join(" "):t}const Q8e=Symbol.for("motionComponentSymbol");function vg(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function e$e(t,e,r){return Y.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):vg(r)&&(r.current=n))},[e])}const z5=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),t$e="framerAppearId",sY="data-"+z5(t$e),oY=Y.createContext({});function r$e(t,e,r,n,i){var P,D;const{visualElement:o}=Y.useContext(cE),u=Y.useContext(nY),a=Y.useContext(lE),p=Y.useContext(O5).reducedMotion,g=Y.useRef(null);n=n||u.renderer,!g.current&&n&&(g.current=n(t,{visualState:e,parent:o,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:p}));const v=g.current,w=Y.useContext(oY);v&&!v.projection&&i&&(v.type==="html"||v.type==="svg")&&n$e(g.current,r,i,w);const T=Y.useRef(!1);Y.useInsertionEffect(()=>{v&&T.current&&v.update(r,a)});const A=r[sY],I=Y.useRef(!!A&&!((P=window.MotionHandoffIsComplete)!=null&&P.call(window,A))&&((D=window.MotionHasOptimisedAnimation)==null?void 0:D.call(window,A)));return hX(()=>{v&&(T.current=!0,window.MotionIsMounted=!0,v.updateFeatures(),M5.render(v.render),I.current&&v.animationState&&v.animationState.animateChanges())}),Y.useEffect(()=>{v&&(!I.current&&v.animationState&&v.animationState.animateChanges(),I.current&&(queueMicrotask(()=>{var L;(L=window.MotionHandoffMarkAsComplete)==null||L.call(window,A)}),I.current=!1))}),v}function n$e(t,e,r,n){const{layoutId:i,layout:o,drag:u,dragConstraints:a,layoutScroll:p,layoutRoot:g,layoutCrossfade:v}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:lY(t.parent)),t.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!u||a&&vg(a),visualElement:t,animationType:typeof o=="string"?o:"both",initialPromotionConfig:n,crossfade:v,layoutScroll:p,layoutRoot:g})}function lY(t){if(t)return t.options.allowProjection!==!1?t.projection:lY(t.parent)}function i$e({preloadedFeatures:t,createVisualElement:e,useRender:r,useVisualState:n,Component:i}){t&&W8e(t);function o(a,p){let g;const v={...Y.useContext(O5),...a,layoutId:a$e(a)},{isStatic:w}=v,T=J8e(a),A=n(a,w);if(!w&&h5){s$e();const I=o$e(v);g=I.MeasureLayout,T.visualElement=r$e(i,A,v,e,I.ProjectionNode)}return l.jsxs(cE.Provider,{value:T,children:[g&&T.visualElement?l.jsx(g,{visualElement:T.visualElement,...v}):null,r(i,a,e$e(A,T.visualElement,p),A,w,T.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${i.displayName??i.name??""})`}`;const u=Y.forwardRef(o);return u[Q8e]=i,u}function a$e({layoutId:t}){const e=Y.useContext(u5).id;return e&&t!==void 0?e+"-"+t:t}function s$e(t,e){Y.useContext(nY).strict}function o$e(t){const{drag:e,layout:r}=O0;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const Z_={};function l$e(t){for(const e in t)Z_[e]=t[e],_5(e)&&(Z_[e].isCSSVariable=!0)}function cY(t,{layout:e,layoutId:r}){return uy.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!Z_[t]||t==="opacity")}const c$e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},u$e=cy.length;function d$e(t,e,r){let n="",i=!0;for(let o=0;o<u$e;o++){const u=cy[o],a=t[u];if(a===void 0)continue;let p=!0;if(typeof a=="number"?p=a===(u.startsWith("scale")?1:0):p=parseFloat(a)===0,!p||r){const g=YX(a,I5[u]);if(!p){i=!1;const v=c$e[u]||u;n+=`${v}(${g}) `}r&&(e[u]=g)}}return n=n.trim(),r?n=r(e,i?"":n):i&&(n="none"),n}function $5(t,e,r){const{style:n,vars:i,transformOrigin:o}=t;let u=!1,a=!1;for(const p in e){const g=e[p];if(uy.has(p)){u=!0;continue}else if(_5(p)){i[p]=g;continue}else{const v=YX(g,I5[p]);p.startsWith("origin")?(a=!0,o[p]=v):n[p]=v}}if(e.transform||(u||r?n.transform=d$e(e,t.transform,r):n.transform&&(n.transform="none")),a){const{originX:p="50%",originY:g="50%",originZ:v=0}=o;n.transformOrigin=`${p} ${g} ${v}`}}const F5=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function uY(t,e,r){for(const n in e)!us(e[n])&&!cY(n,r)&&(t[n]=e[n])}function h$e({transformTemplate:t},e){return Y.useMemo(()=>{const r=F5();return $5(r,e,t),Object.assign({},r.vars,r.style)},[e])}function f$e(t,e){const r=t.style||{},n={};return uY(n,r,t),Object.assign(n,h$e(t,e)),n}function p$e(t,e){const r={},n=f$e(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const m$e={offset:"stroke-dashoffset",array:"stroke-dasharray"},g$e={offset:"strokeDashoffset",array:"strokeDasharray"};function y$e(t,e,r=1,n=0,i=!0){t.pathLength=1;const o=i?m$e:g$e;t[o.offset]=Ir.transform(-n);const u=Ir.transform(e),a=Ir.transform(r);t[o.array]=`${u} ${a}`}function dY(t,{attrX:e,attrY:r,attrScale:n,pathLength:i,pathSpacing:o=1,pathOffset:u=0,...a},p,g,v){if($5(t,a,g),p){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:w,style:T}=t;w.transform&&(T.transform=w.transform,delete w.transform),(T.transform||w.transformOrigin)&&(T.transformOrigin=w.transformOrigin??"50% 50%",delete w.transformOrigin),T.transform&&(T.transformBox=(v==null?void 0:v.transformBox)??"fill-box",delete w.transformBox),e!==void 0&&(w.x=e),r!==void 0&&(w.y=r),n!==void 0&&(w.scale=n),i!==void 0&&y$e(w,i,o,u,!1)}const hY=()=>({...F5(),attrs:{}}),fY=t=>typeof t=="string"&&t.toLowerCase()==="svg";function x$e(t,e,r,n){const i=Y.useMemo(()=>{const o=hY();return dY(o,e,fY(n),t.transformTemplate,t.style),{...o.attrs,style:{...o.style}}},[e]);if(t.style){const o={};uY(o,t.style,t),i.style={...o,...i.style}}return i}const v$e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function B5(t){return typeof t!="string"||t.includes("-")?!1:!!(v$e.indexOf(t)>-1||/[A-Z]/u.test(t))}function _$e(t=!1){return(r,n,i,{latestValues:o},u)=>{const p=(B5(r)?x$e:p$e)(n,o,u,r),g=Z8e(n,typeof r=="string",t),v=r!==Y.Fragment?{...g,...p,ref:i}:{},{children:w}=n,T=Y.useMemo(()=>us(w)?w.get():w,[w]);return Y.createElement(r,{...v,children:T})}}function l9(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function V5(t,e,r,n){if(typeof e=="function"){const[i,o]=l9(n);e=e(r!==void 0?r:t.custom,i,o)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,o]=l9(n);e=e(r!==void 0?r:t.custom,i,o)}return e}function h2(t){return us(t)?t.get():t}function b$e({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,i){return{latestValues:w$e(r,n,i,t),renderState:e()}}const pY=t=>(e,r)=>{const n=Y.useContext(cE),i=Y.useContext(lE),o=()=>b$e(t,e,n,i);return r?o():d5(o)};function w$e(t,e,r,n){const i={},o=n(t,{});for(const T in o)i[T]=h2(o[T]);let{initial:u,animate:a}=t;const p=dE(t),g=aY(t);e&&g&&!p&&t.inherit!==!1&&(u===void 0&&(u=e.initial),a===void 0&&(a=e.animate));let v=r?r.initial===!1:!1;v=v||u===!1;const w=v?a:u;if(w&&typeof w!="boolean"&&!uE(w)){const T=Array.isArray(w)?w:[w];for(let A=0;A<T.length;A++){const I=V5(t,T[A]);if(I){const{transitionEnd:P,transition:D,...L}=I;for(const O in L){let $=L[O];if(Array.isArray($)){const G=v?$.length-1:0;$=$[G]}$!==null&&(i[O]=$)}for(const O in P)i[O]=P[O]}}}return i}function U5(t,e,r){var o;const{style:n}=t,i={};for(const u in n)(us(n[u])||e.style&&us(e.style[u])||cY(u,t)||((o=r==null?void 0:r.getValue(u))==null?void 0:o.liveStyle)!==void 0)&&(i[u]=n[u]);return i}const k$e={useVisualState:pY({scrapeMotionValuesFromProps:U5,createRenderState:F5})};function mY(t,e,r){const n=U5(t,e,r);for(const i in t)if(us(t[i])||us(e[i])){const o=cy.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[o]=t[i]}return n}const T$e={useVisualState:pY({scrapeMotionValuesFromProps:mY,createRenderState:hY})};function S$e(t,e){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const u={...B5(n)?T$e:k$e,preloadedFeatures:t,useRender:_$e(i),createVisualElement:e,Component:n};return i$e(u)}}function X_(t,e,r){const n=t.getProps();return V5(n,e,r!==void 0?r:n.custom,t)}const z4=t=>Array.isArray(t);function E$e(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,D0(r))}function j$e(t){return z4(t)?t[t.length-1]||0:t}function A$e(t,e){const r=X_(t,e);let{transitionEnd:n={},transition:i={},...o}=r||{};o={...o,...n};for(const u in o){const a=j$e(o[u]);E$e(t,u,a)}}function N$e(t){return!!(us(t)&&t.add)}function $4(t,e){const r=t.getValue("willChange");if(N$e(r))return r.add(e);if(!r&&vd.WillChange){const n=new vd.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function gY(t){return t.props[sY]}const C$e=t=>t!==null;function P$e(t,{repeat:e,repeatType:r="loop"},n){const i=t.filter(C$e),o=e&&r!=="loop"&&e%2===1?0:i.length-1;return!o||n===void 0?i[o]:n}const I$e={type:"spring",stiffness:500,damping:25,restSpeed:10},M$e=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),D$e={type:"keyframes",duration:.8},O$e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},R$e=(t,{keyframes:e})=>e.length>2?D$e:uy.has(t)?t.startsWith("scale")?M$e(e[1]):I$e:O$e;function L$e({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:i,repeat:o,repeatType:u,repeatDelay:a,from:p,elapsed:g,...v}){return!!Object.keys(v).length}const q5=(t,e,r,n={},i,o)=>u=>{const a=P5(n,t)||{},p=a.delay||n.delay||0;let{elapsed:g=0}=n;g=g-eu(p);const v={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-g,onUpdate:T=>{e.set(T),a.onUpdate&&a.onUpdate(T)},onComplete:()=>{u(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:o?void 0:i};L$e(a)||Object.assign(v,R$e(t,v)),v.duration&&(v.duration=eu(v.duration)),v.repeatDelay&&(v.repeatDelay=eu(v.repeatDelay)),v.from!==void 0&&(v.keyframes[0]=v.from);let w=!1;if((v.type===!1||v.duration===0&&!v.repeatDelay)&&(v.duration=0,v.delay===0&&(w=!0)),(vd.instantAnimations||vd.skipAnimations)&&(w=!0,v.duration=0,v.delay=0),v.allowFlatten=!a.type&&!a.ease,w&&!o&&e.get()!==void 0){const T=P$e(v.keyframes,a);if(T!==void 0){pi.update(()=>{v.onUpdate(T),v.onComplete()});return}}return a.isSync?new A5(v):new g8e(v)};function z$e({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function yY(t,e,{delay:r=0,transitionOverride:n,type:i}={}){let{transition:o=t.getDefaultTransition(),transitionEnd:u,...a}=e;n&&(o=n);const p=[],g=i&&t.animationState&&t.animationState.getState()[i];for(const v in a){const w=t.getValue(v,t.latestValues[v]??null),T=a[v];if(T===void 0||g&&z$e(g,v))continue;const A={delay:r,...P5(o||{},v)},I=w.get();if(I!==void 0&&!w.isAnimating&&!Array.isArray(T)&&T===I&&!A.velocity)continue;let P=!1;if(window.MotionHandoffAnimation){const L=gY(t);if(L){const O=window.MotionHandoffAnimation(L,v,pi);O!==null&&(A.startTime=O,P=!0)}}$4(t,v),w.start(q5(v,w,T,t.shouldReduceMotion&&WX.has(v)?{type:!1}:A,t,P));const D=w.animation;D&&p.push(D)}return u&&Promise.all(p).then(()=>{pi.update(()=>{u&&A$e(t,u)})}),p}function F4(t,e,r={}){var p;const n=X_(t,e,r.type==="exit"?(p=t.presenceContext)==null?void 0:p.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(i=r.transitionOverride);const o=n?()=>Promise.all(yY(t,n,r)):()=>Promise.resolve(),u=t.variantChildren&&t.variantChildren.size?(g=0)=>{const{delayChildren:v=0,staggerChildren:w,staggerDirection:T}=i;return $$e(t,e,g,v,w,T,r)}:()=>Promise.resolve(),{when:a}=i;if(a){const[g,v]=a==="beforeChildren"?[o,u]:[u,o];return g().then(()=>v())}else return Promise.all([o(),u(r.delay)])}function $$e(t,e,r=0,n=0,i=0,o=1,u){const a=[],p=t.variantChildren.size,g=(p-1)*i,v=typeof n=="function",w=v?T=>n(T,p):o===1?(T=0)=>T*i:(T=0)=>g-T*i;return Array.from(t.variantChildren).sort(F$e).forEach((T,A)=>{T.notify("AnimationStart",e),a.push(F4(T,e,{...u,delay:r+(v?0:n)+w(A)}).then(()=>T.notify("AnimationComplete",e)))}),Promise.all(a)}function F$e(t,e){return t.sortNodePosition(e)}function B$e(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(o=>F4(t,o,r));n=Promise.all(i)}else if(typeof e=="string")n=F4(t,e,r);else{const i=typeof e=="function"?X_(t,e,r.custom):e;n=Promise.all(yY(t,i,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function xY(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const V$e=L5.length;function vY(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?vY(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<V$e;r++){const n=L5[r],i=t.props[n];(K_(i)||i===!1)&&(e[n]=i)}return e}const U$e=[...R5].reverse(),q$e=R5.length;function G$e(t){return e=>Promise.all(e.map(({animation:r,options:n})=>B$e(t,r,n)))}function W$e(t){let e=G$e(t),r=c9(),n=!0;const i=p=>(g,v)=>{var T;const w=X_(t,v,p==="exit"?(T=t.presenceContext)==null?void 0:T.custom:void 0);if(w){const{transition:A,transitionEnd:I,...P}=w;g={...g,...P,...I}}return g};function o(p){e=p(t)}function u(p){const{props:g}=t,v=vY(t.parent)||{},w=[],T=new Set;let A={},I=1/0;for(let D=0;D<q$e;D++){const L=U$e[D],O=r[L],$=g[L]!==void 0?g[L]:v[L],G=K_($),B=L===p?O.isActive:null;B===!1&&(I=D);let J=$===v[L]&&$!==g[L]&&G;if(J&&n&&t.manuallyAnimateOnMount&&(J=!1),O.protectedKeys={...A},!O.isActive&&B===null||!$&&!O.prevProp||uE($)||typeof $=="boolean")continue;const W=H$e(O.prevProp,$);let H=W||L===p&&O.isActive&&!J&&G||D>I&&G,V=!1;const se=Array.isArray($)?$:[$];let K=se.reduce(i(L),{});B===!1&&(K={});const{prevResolvedValues:ce={}}=O,ne={...ce,...K},re=xe=>{H=!0,T.has(xe)&&(V=!0,T.delete(xe)),O.needsAnimating[xe]=!0;const ye=t.getValue(xe);ye&&(ye.liveStyle=!1)};for(const xe in ne){const ye=K[xe],Se=ce[xe];if(A.hasOwnProperty(xe))continue;let be=!1;z4(ye)&&z4(Se)?be=!xY(ye,Se):be=ye!==Se,be?ye!=null?re(xe):T.add(xe):ye!==void 0&&T.has(xe)?re(xe):O.protectedKeys[xe]=!0}O.prevProp=$,O.prevResolvedValues=K,O.isActive&&(A={...A,...K}),n&&t.blockInitialAnimation&&(H=!1),H&&(!(J&&W)||V)&&w.push(...se.map(xe=>({animation:xe,options:{type:L}})))}if(T.size){const D={};if(typeof g.initial!="boolean"){const L=X_(t,Array.isArray(g.initial)?g.initial[0]:g.initial);L&&L.transition&&(D.transition=L.transition)}T.forEach(L=>{const O=t.getBaseTarget(L),$=t.getValue(L);$&&($.liveStyle=!0),D[L]=O??null}),w.push({animation:D})}let P=!!w.length;return n&&(g.initial===!1||g.initial===g.animate)&&!t.manuallyAnimateOnMount&&(P=!1),n=!1,P?e(w):Promise.resolve()}function a(p,g){var w;if(r[p].isActive===g)return Promise.resolve();(w=t.variantChildren)==null||w.forEach(T=>{var A;return(A=T.animationState)==null?void 0:A.setActive(p,g)}),r[p].isActive=g;const v=u(p);for(const T in r)r[T].protectedKeys={};return v}return{animateChanges:u,setActive:a,setAnimateFunction:o,getState:()=>r,reset:()=>{r=c9(),n=!0}}}function H$e(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!xY(e,t):!1}function ep(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function c9(){return{animate:ep(!0),whileInView:ep(),whileHover:ep(),whileTap:ep(),whileDrag:ep(),whileFocus:ep(),exit:ep()}}class gf{constructor(e){this.isMounted=!1,this.node=e}update(){}}class K$e extends gf{constructor(e){super(e),e.animationState||(e.animationState=W$e(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();uE(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let Z$e=0;class X$e extends gf{constructor(){super(...arguments),this.id=Z$e++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);r&&!e&&i.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const Y$e={animation:{Feature:K$e},exit:{Feature:X$e}};function Y_(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function Nb(t){return{point:{x:t.pageX,y:t.pageY}}}const J$e=t=>e=>D5(e)&&t(e,Nb(e));function Pv(t,e,r,n){return Y_(t,e,J$e(r),n)}function _Y({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function Q$e({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function eFe(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const bY=1e-4,tFe=1-bY,rFe=1+bY,wY=.01,nFe=0-wY,iFe=0+wY;function Ns(t){return t.max-t.min}function aFe(t,e,r){return Math.abs(t-e)<=r}function u9(t,e,r,n=.5){t.origin=n,t.originPoint=ji(e.min,e.max,t.origin),t.scale=Ns(r)/Ns(e),t.translate=ji(r.min,r.max,t.origin)-t.originPoint,(t.scale>=tFe&&t.scale<=rFe||isNaN(t.scale))&&(t.scale=1),(t.translate>=nFe&&t.translate<=iFe||isNaN(t.translate))&&(t.translate=0)}function Iv(t,e,r,n){u9(t.x,e.x,r.x,n?n.originX:void 0),u9(t.y,e.y,r.y,n?n.originY:void 0)}function d9(t,e,r){t.min=r.min+e.min,t.max=t.min+Ns(e)}function sFe(t,e,r){d9(t.x,e.x,r.x),d9(t.y,e.y,r.y)}function h9(t,e,r){t.min=e.min-r.min,t.max=t.min+Ns(e)}function Mv(t,e,r){h9(t.x,e.x,r.x),h9(t.y,e.y,r.y)}const f9=()=>({translate:0,scale:1,origin:0,originPoint:0}),_g=()=>({x:f9(),y:f9()}),p9=()=>({min:0,max:0}),Fi=()=>({x:p9(),y:p9()});function el(t){return[t("x"),t("y")]}function sN(t){return t===void 0||t===1}function B4({scale:t,scaleX:e,scaleY:r}){return!sN(t)||!sN(e)||!sN(r)}function op(t){return B4(t)||kY(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function kY(t){return m9(t.x)||m9(t.y)}function m9(t){return t&&t!=="0%"}function mT(t,e,r){const n=t-r,i=e*n;return r+i}function g9(t,e,r,n,i){return i!==void 0&&(t=mT(t,i,n)),mT(t,r,n)+e}function V4(t,e=0,r=1,n,i){t.min=g9(t.min,e,r,n,i),t.max=g9(t.max,e,r,n,i)}function TY(t,{x:e,y:r}){V4(t.x,e.translate,e.scale,e.originPoint),V4(t.y,r.translate,r.scale,r.originPoint)}const y9=.999999999999,x9=1.0000000000001;function oFe(t,e,r,n=!1){const i=r.length;if(!i)return;e.x=e.y=1;let o,u;for(let a=0;a<i;a++){o=r[a],u=o.projectionDelta;const{visualElement:p}=o.options;p&&p.props.style&&p.props.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&wg(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),u&&(e.x*=u.x.scale,e.y*=u.y.scale,TY(t,u)),n&&op(o.latestValues)&&wg(t,o.latestValues))}e.x<x9&&e.x>y9&&(e.x=1),e.y<x9&&e.y>y9&&(e.y=1)}function bg(t,e){t.min=t.min+e,t.max=t.max+e}function v9(t,e,r,n,i=.5){const o=ji(t.min,t.max,i);V4(t,e,r,o,n)}function wg(t,e){v9(t.x,e.x,e.scaleX,e.scale,e.originX),v9(t.y,e.y,e.scaleY,e.scale,e.originY)}function SY(t,e){return _Y(eFe(t.getBoundingClientRect(),e))}function lFe(t,e,r){const n=SY(t,r),{scroll:i}=e;return i&&(bg(n.x,i.offset.x),bg(n.y,i.offset.y)),n}const EY=({current:t})=>t?t.ownerDocument.defaultView:null,_9=(t,e)=>Math.abs(t-e);function cFe(t,e){const r=_9(t.x,e.x),n=_9(t.y,e.y);return Math.sqrt(r**2+n**2)}class jY{constructor(e,r,{transformPagePoint:n,contextWindow:i=window,dragSnapToOrigin:o=!1,distanceThreshold:u=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=lN(this.lastMoveEventInfo,this.history),A=this.startEvent!==null,I=cFe(T.offset,{x:0,y:0})>=this.distanceThreshold;if(!A&&!I)return;const{point:P}=T,{timestamp:D}=za;this.history.push({...P,timestamp:D});const{onStart:L,onMove:O}=this.handlers;A||(L&&L(this.lastMoveEvent,T),this.startEvent=this.lastMoveEvent),O&&O(this.lastMoveEvent,T)},this.handlePointerMove=(T,A)=>{this.lastMoveEvent=T,this.lastMoveEventInfo=oN(A,this.transformPagePoint),pi.update(this.updatePoint,!0)},this.handlePointerUp=(T,A)=>{this.end();const{onEnd:I,onSessionEnd:P,resumeAnimation:D}=this.handlers;if(this.dragSnapToOrigin&&D&&D(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const L=lN(T.type==="pointercancel"?this.lastMoveEventInfo:oN(A,this.transformPagePoint),this.history);this.startEvent&&I&&I(T,L),P&&P(T,L)},!D5(e))return;this.dragSnapToOrigin=o,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=u,this.contextWindow=i||window;const a=Nb(e),p=oN(a,this.transformPagePoint),{point:g}=p,{timestamp:v}=za;this.history=[{...g,timestamp:v}];const{onSessionStart:w}=r;w&&w(e,lN(p,this.history)),this.removeListeners=Eb(Pv(this.contextWindow,"pointermove",this.handlePointerMove),Pv(this.contextWindow,"pointerup",this.handlePointerUp),Pv(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),tf(this.updatePoint)}}function oN(t,e){return e?{point:e(t.point)}:t}function b9(t,e){return{x:t.x-e.x,y:t.y-e.y}}function lN({point:t},e){return{point:t,delta:b9(t,AY(e)),offset:b9(t,uFe(e)),velocity:dFe(e,.1)}}function uFe(t){return t[0]}function AY(t){return t[t.length-1]}function dFe(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const i=AY(t);for(;r>=0&&(n=t[r],!(i.timestamp-n.timestamp>eu(e)));)r--;if(!n)return{x:0,y:0};const o=tu(i.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const u={x:(i.x-n.x)/o,y:(i.y-n.y)/o};return u.x===1/0&&(u.x=0),u.y===1/0&&(u.y=0),u}function hFe(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?ji(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?ji(r,t,n.max):Math.min(t,r)),t}function w9(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function fFe(t,{top:e,left:r,bottom:n,right:i}){return{x:w9(t.x,r,i),y:w9(t.y,e,n)}}function k9(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function pFe(t,e){return{x:k9(t.x,e.x),y:k9(t.y,e.y)}}function mFe(t,e){let r=.5;const n=Ns(t),i=Ns(e);return i>n?r=G_(e.min,e.max-n,t.min):n>i&&(r=G_(t.min,t.max-i,e.min)),xd(0,1,r)}function gFe(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const U4=.35;function yFe(t=U4){return t===!1?t=0:t===!0&&(t=U4),{x:T9(t,"left","right"),y:T9(t,"top","bottom")}}function T9(t,e,r){return{min:S9(t,e),max:S9(t,r)}}function S9(t,e){return typeof t=="number"?t:t[e]||0}const xFe=new WeakMap;class vFe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Fi(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const o=w=>{const{dragSnapToOrigin:T}=this.getProps();T?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Nb(w).point)},u=(w,T)=>{const{drag:A,dragPropagation:I,onDragStart:P}=this.getProps();if(A&&!I&&(this.openDragLock&&this.openDragLock(),this.openDragLock=I8e(A),!this.openDragLock))return;this.latestPointerEvent=w,this.latestPanInfo=T,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),el(L=>{let O=this.getAxisMotionValue(L).get()||0;if(ru.test(O)){const{projection:$}=this.visualElement;if($&&$.layout){const G=$.layout.layoutBox[L];G&&(O=Ns(G)*(parseFloat(O)/100))}}this.originPoint[L]=O}),P&&pi.postRender(()=>P(w,T)),$4(this.visualElement,"transform");const{animationState:D}=this.visualElement;D&&D.setActive("whileDrag",!0)},a=(w,T)=>{this.latestPointerEvent=w,this.latestPanInfo=T;const{dragPropagation:A,dragDirectionLock:I,onDirectionLock:P,onDrag:D}=this.getProps();if(!A&&!this.openDragLock)return;const{offset:L}=T;if(I&&this.currentDirection===null){this.currentDirection=_Fe(L),this.currentDirection!==null&&P&&P(this.currentDirection);return}this.updateAxis("x",T.point,L),this.updateAxis("y",T.point,L),this.visualElement.render(),D&&D(w,T)},p=(w,T)=>{this.latestPointerEvent=w,this.latestPanInfo=T,this.stop(w,T),this.latestPointerEvent=null,this.latestPanInfo=null},g=()=>el(w=>{var T;return this.getAnimationState(w)==="paused"&&((T=this.getAxisMotionValue(w).animation)==null?void 0:T.play())}),{dragSnapToOrigin:v}=this.getProps();this.panSession=new jY(e,{onSessionStart:o,onStart:u,onMove:a,onSessionEnd:p,resumeAnimation:g},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:v,distanceThreshold:n,contextWindow:EY(this.visualElement)})}stop(e,r){const n=e||this.latestPointerEvent,i=r||this.latestPanInfo,o=this.isDragging;if(this.cancel(),!o||!i||!n)return;const{velocity:u}=i;this.startAnimation(u);const{onDragEnd:a}=this.getProps();a&&pi.postRender(()=>a(n,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:i}=this.getProps();if(!n||!Ow(e,i,this.currentDirection))return;const o=this.getAxisMotionValue(e);let u=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(u=hFe(u,this.constraints[e],this.elastic[e])),o.set(u)}resolveConstraints(){var o;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(o=this.visualElement.projection)==null?void 0:o.layout,i=this.constraints;e&&vg(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=fFe(n.layoutBox,e):this.constraints=!1,this.elastic=yFe(r),i!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&el(u=>{this.constraints!==!1&&this.getAxisMotionValue(u)&&(this.constraints[u]=gFe(n.layoutBox[u],this.constraints[u]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!vg(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=lFe(n,i.root,this.visualElement.getTransformPagePoint());let u=pFe(i.layout.layoutBox,o);if(r){const a=r(Q$e(u));this.hasMutatedConstraints=!!a,a&&(u=_Y(a))}return u}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:i,dragTransition:o,dragSnapToOrigin:u,onDragTransitionEnd:a}=this.getProps(),p=this.constraints||{},g=el(v=>{if(!Ow(v,r,this.currentDirection))return;let w=p&&p[v]||{};u&&(w={min:0,max:0});const T=i?200:1e6,A=i?40:1e7,I={type:"inertia",velocity:n?e[v]:0,bounceStiffness:T,bounceDamping:A,timeConstant:750,restDelta:1,restSpeed:10,...o,...w};return this.startAxisValueAnimation(v,I)});return Promise.all(g).then(a)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return $4(this.visualElement,e),n.start(q5(e,n,0,r,this.visualElement,!1))}stopAnimation(){el(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){el(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[r];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){el(r=>{const{drag:n}=this.getProps();if(!Ow(r,n,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(r);if(i&&i.layout){const{min:u,max:a}=i.layout.layoutBox[r];o.set(e[r]-ji(u,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!vg(r)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};el(u=>{const a=this.getAxisMotionValue(u);if(a&&this.constraints!==!1){const p=a.get();i[u]=mFe({min:p,max:p},this.constraints[u])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),el(u=>{if(!Ow(u,e,null))return;const a=this.getAxisMotionValue(u),{min:p,max:g}=this.constraints[u];a.set(ji(p,g,i[u]))})}addListeners(){if(!this.visualElement.current)return;xFe.set(this.visualElement,this);const e=this.visualElement.current,r=Pv(e,"pointerdown",p=>{const{drag:g,dragListener:v=!0}=this.getProps();g&&v&&this.start(p)}),n=()=>{const{dragConstraints:p}=this.getProps();vg(p)&&p.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),pi.read(n);const u=Y_(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:p,hasLayoutChanged:g})=>{this.isDragging&&g&&(el(v=>{const w=this.getAxisMotionValue(v);w&&(this.originPoint[v]+=p[v].translate,w.set(w.get()+p[v].translate))}),this.visualElement.render())});return()=>{u(),r(),o(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:u=U4,dragMomentum:a=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:i,dragConstraints:o,dragElastic:u,dragMomentum:a}}}function Ow(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function _Fe(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class bFe extends gf{constructor(e){super(e),this.removeGroupControls=fl,this.removeListeners=fl,this.controls=new vFe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||fl}unmount(){this.removeGroupControls(),this.removeListeners()}}const E9=t=>(e,r)=>{t&&pi.postRender(()=>t(e,r))};class wFe extends gf{constructor(){super(...arguments),this.removePointerDownListener=fl}onPointerDown(e){this.session=new jY(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:EY(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:E9(e),onStart:E9(r),onMove:n,onEnd:(o,u)=>{delete this.session,i&&pi.postRender(()=>i(o,u))}}}mount(){this.removePointerDownListener=Pv(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const f2={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function j9(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const $x={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ir.test(t))t=parseFloat(t);else return t;const r=j9(t,e.target.x),n=j9(t,e.target.y);return`${r}% ${n}%`}},kFe={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,i=rf.parse(t);if(i.length>5)return n;const o=rf.createTransformer(t),u=typeof i[0]!="number"?1:0,a=r.x.scale*e.x,p=r.y.scale*e.y;i[0+u]/=a,i[1+u]/=p;const g=ji(a,p,.5);return typeof i[2+u]=="number"&&(i[2+u]/=g),typeof i[3+u]=="number"&&(i[3+u]/=g),o(i)}};let A9=!1;class TFe extends Y.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:i}=this.props,{projection:o}=e;l$e(SFe),o&&(r.group&&r.group.add(o),n&&n.register&&i&&n.register(o),A9&&o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),f2.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:i,isPresent:o}=this.props,{projection:u}=n;return u&&(u.isPresent=o,A9=!0,i||e.layoutDependency!==r||r===void 0||e.isPresent!==o?u.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?u.promote():u.relegate()||pi.postRender(()=>{const a=u.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),M5.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function NY(t){const[e,r]=rY(),n=Y.useContext(u5);return l.jsx(TFe,{...t,layoutGroup:n,switchLayoutGroup:Y.useContext(oY),isPresent:e,safeToRemove:r})}const SFe={borderRadius:{...$x,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:$x,borderTopRightRadius:$x,borderBottomLeftRadius:$x,borderBottomRightRadius:$x,boxShadow:kFe};function EFe(t,e,r){const n=us(t)?t:D0(t);return n.start(q5("",n,e,r)),n.animation}const jFe=(t,e)=>t.depth-e.depth;class AFe{constructor(){this.children=[],this.isDirty=!1}add(e){f5(this.children,e),this.isDirty=!0}remove(e){p5(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(jFe),this.isDirty=!1,this.children.forEach(e)}}function NFe(t,e){const r=Js.now(),n=({timestamp:i})=>{const o=i-r;o>=e&&(tf(n),t(o-e))};return pi.setup(n,!0),()=>tf(n)}const CY=["TopLeft","TopRight","BottomLeft","BottomRight"],CFe=CY.length,N9=t=>typeof t=="string"?parseFloat(t):t,C9=t=>typeof t=="number"||Ir.test(t);function PFe(t,e,r,n,i,o){i?(t.opacity=ji(0,r.opacity??1,IFe(n)),t.opacityExit=ji(e.opacity??1,0,MFe(n))):o&&(t.opacity=ji(e.opacity??1,r.opacity??1,n));for(let u=0;u<CFe;u++){const a=`border${CY[u]}Radius`;let p=P9(e,a),g=P9(r,a);if(p===void 0&&g===void 0)continue;p||(p=0),g||(g=0),p===0||g===0||C9(p)===C9(g)?(t[a]=Math.max(ji(N9(p),N9(g),n),0),(ru.test(g)||ru.test(p))&&(t[a]+="%")):t[a]=g}(e.rotate||r.rotate)&&(t.rotate=ji(e.rotate||0,r.rotate||0,n))}function P9(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const IFe=PY(0,.5,kX),MFe=PY(.5,.95,fl);function PY(t,e,r){return n=>n<t?0:n>e?1:r(G_(t,e,n))}function I9(t,e){t.min=e.min,t.max=e.max}function Qo(t,e){I9(t.x,e.x),I9(t.y,e.y)}function M9(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function D9(t,e,r,n,i){return t-=e,t=mT(t,1/r,n),i!==void 0&&(t=mT(t,1/i,n)),t}function DFe(t,e=0,r=1,n=.5,i,o=t,u=t){if(ru.test(e)&&(e=parseFloat(e),e=ji(u.min,u.max,e/100)-u.min),typeof e!="number")return;let a=ji(o.min,o.max,n);t===o&&(a-=e),t.min=D9(t.min,e,r,a,i),t.max=D9(t.max,e,r,a,i)}function O9(t,e,[r,n,i],o,u){DFe(t,e[r],e[n],e[i],e.scale,o,u)}const OFe=["x","scaleX","originX"],RFe=["y","scaleY","originY"];function R9(t,e,r,n){O9(t.x,e,OFe,r?r.x:void 0,n?n.x:void 0),O9(t.y,e,RFe,r?r.y:void 0,n?n.y:void 0)}function L9(t){return t.translate===0&&t.scale===1}function IY(t){return L9(t.x)&&L9(t.y)}function z9(t,e){return t.min===e.min&&t.max===e.max}function LFe(t,e){return z9(t.x,e.x)&&z9(t.y,e.y)}function $9(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function MY(t,e){return $9(t.x,e.x)&&$9(t.y,e.y)}function F9(t){return Ns(t.x)/Ns(t.y)}function B9(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class zFe{constructor(){this.members=[]}add(e){f5(this.members,e),e.scheduleRender()}remove(e){if(p5(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(i=>e===i);if(r===0)return!1;let n;for(let i=r;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function $Fe(t,e,r){let n="";const i=t.x.translate/e.x,o=t.y.translate/e.y,u=(r==null?void 0:r.z)||0;if((i||o||u)&&(n=`translate3d(${i}px, ${o}px, ${u}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:g,rotate:v,rotateX:w,rotateY:T,skewX:A,skewY:I}=r;g&&(n=`perspective(${g}px) ${n}`),v&&(n+=`rotate(${v}deg) `),w&&(n+=`rotateX(${w}deg) `),T&&(n+=`rotateY(${T}deg) `),A&&(n+=`skewX(${A}deg) `),I&&(n+=`skewY(${I}deg) `)}const a=t.x.scale*e.x,p=t.y.scale*e.y;return(a!==1||p!==1)&&(n+=`scale(${a}, ${p})`),n||"none"}const cN=["","X","Y","Z"],FFe=1e3;let BFe=0;function uN(t,e,r,n){const{latestValues:i}=e;i[t]&&(r[t]=i[t],e.setStaticValue(t,0),n&&(n[t]=0))}function DY(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=gY(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:i,layoutId:o}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",pi,!(i||o))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&DY(n)}function OY({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(u={},a=e==null?void 0:e()){this.id=BFe++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(qFe),this.nodes.forEach(KFe),this.nodes.forEach(ZFe),this.nodes.forEach(GFe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=u,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let p=0;p<this.path.length;p++)this.path[p].shouldResetTransform=!0;this.root===this&&(this.nodes=new AFe)}addEventListener(u,a){return this.eventHandlers.has(u)||this.eventHandlers.set(u,new y5),this.eventHandlers.get(u).add(a)}notifyListeners(u,...a){const p=this.eventHandlers.get(u);p&&p.notify(...a)}hasListeners(u){return this.eventHandlers.has(u)}mount(u){if(this.instance)return;this.isSVG=tY(u)&&!z8e(u),this.instance=u;const{layoutId:a,layout:p,visualElement:g}=this.options;if(g&&!g.current&&g.mount(u),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(p||a)&&(this.isLayoutDirty=!0),t){let v,w=0;const T=()=>this.root.updateBlockedByResize=!1;pi.read(()=>{w=window.innerWidth}),t(u,()=>{const A=window.innerWidth;A!==w&&(w=A,this.root.updateBlockedByResize=!0,v&&v(),v=NFe(T,250),f2.hasAnimatedSinceResize&&(f2.hasAnimatedSinceResize=!1,this.nodes.forEach(q9)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&g&&(a||p)&&this.addEventListener("didUpdate",({delta:v,hasLayoutChanged:w,hasRelativeLayoutChanged:T,layout:A})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const I=this.options.transition||g.getDefaultTransition()||eBe,{onLayoutAnimationStart:P,onLayoutAnimationComplete:D}=g.getProps(),L=!this.targetLayout||!MY(this.targetLayout,A),O=!w&&T;if(this.options.layoutRoot||this.resumeFrom||O||w&&(L||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const $={...P5(I,"layout"),onPlay:P,onComplete:D};(g.shouldReduceMotion||this.options.layoutRoot)&&($.delay=0,$.type=!1),this.startAnimation($),this.setAnimationOrigin(v,O)}else w||q9(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=A})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const u=this.getStack();u&&u.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),tf(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(XFe),this.animationId++)}getTransformTemplate(){const{visualElement:u}=this.options;return u&&u.getProps().transformTemplate}willUpdate(u=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&DY(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let v=0;v<this.path.length;v++){const w=this.path[v];w.shouldResetTransform=!0,w.updateScroll("snapshot"),w.options.layoutRoot&&w.willUpdate(!1)}const{layoutId:a,layout:p}=this.options;if(a===void 0&&!p)return;const g=this.getTransformTemplate();this.prevTransformTemplateValue=g?g(this.latestValues,""):void 0,this.updateSnapshot(),u&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(V9);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(U9);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(HFe),this.nodes.forEach(VFe),this.nodes.forEach(UFe)):this.nodes.forEach(U9),this.clearAllSnapshots();const a=Js.now();za.delta=xd(0,1e3/60,a-za.timestamp),za.timestamp=a,za.isProcessing=!0,eN.update.process(za),eN.preRender.process(za),eN.render.process(za),za.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,M5.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(WFe),this.sharedNodes.forEach(YFe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,pi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){pi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ns(this.snapshot.measuredBox.x)&&!Ns(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let p=0;p<this.path.length;p++)this.path[p].updateScroll();const u=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Fi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,u?u.layoutBox:void 0)}updateScroll(u="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===u&&(a=!1),a&&this.instance){const p=n(this.instance);this.scroll={animationId:this.root.animationId,phase:u,isRoot:p,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:p}}}resetTransform(){if(!i)return;const u=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!IY(this.projectionDelta),p=this.getTransformTemplate(),g=p?p(this.latestValues,""):void 0,v=g!==this.prevTransformTemplateValue;u&&this.instance&&(a||op(this.latestValues)||v)&&(i(this.instance,g),this.shouldResetTransform=!1,this.scheduleRender())}measure(u=!0){const a=this.measurePageBox();let p=this.removeElementScroll(a);return u&&(p=this.removeTransform(p)),tBe(p),{animationId:this.root.animationId,measuredBox:a,layoutBox:p,latestValues:{},source:this.id}}measurePageBox(){var g;const{visualElement:u}=this.options;if(!u)return Fi();const a=u.measureViewportBox();if(!(((g=this.scroll)==null?void 0:g.wasRoot)||this.path.some(rBe))){const{scroll:v}=this.root;v&&(bg(a.x,v.offset.x),bg(a.y,v.offset.y))}return a}removeElementScroll(u){var p;const a=Fi();if(Qo(a,u),(p=this.scroll)!=null&&p.wasRoot)return a;for(let g=0;g<this.path.length;g++){const v=this.path[g],{scroll:w,options:T}=v;v!==this.root&&w&&T.layoutScroll&&(w.wasRoot&&Qo(a,u),bg(a.x,w.offset.x),bg(a.y,w.offset.y))}return a}applyTransform(u,a=!1){const p=Fi();Qo(p,u);for(let g=0;g<this.path.length;g++){const v=this.path[g];!a&&v.options.layoutScroll&&v.scroll&&v!==v.root&&wg(p,{x:-v.scroll.offset.x,y:-v.scroll.offset.y}),op(v.latestValues)&&wg(p,v.latestValues)}return op(this.latestValues)&&wg(p,this.latestValues),p}removeTransform(u){const a=Fi();Qo(a,u);for(let p=0;p<this.path.length;p++){const g=this.path[p];if(!g.instance||!op(g.latestValues))continue;B4(g.latestValues)&&g.updateSnapshot();const v=Fi(),w=g.measurePageBox();Qo(v,w),R9(a,g.latestValues,g.snapshot?g.snapshot.layoutBox:void 0,v)}return op(this.latestValues)&&R9(a,this.latestValues),a}setTargetDelta(u){this.targetDelta=u,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(u){this.options={...this.options,...u,crossfade:u.crossfade!==void 0?u.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==za.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(u=!1){var T;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const p=!!this.resumingFrom||this!==a;if(!(u||p&&this.isSharedProjectionDirty||this.isProjectionDirty||(T=this.parent)!=null&&T.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:v,layoutId:w}=this.options;if(!(!this.layout||!(v||w))){if(this.resolvedRelativeTargetAt=za.timestamp,!this.targetDelta&&!this.relativeTarget){const A=this.getClosestProjectingParent();A&&A.layout&&this.animationProgress!==1?(this.relativeParent=A,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Fi(),this.relativeTargetOrigin=Fi(),Mv(this.relativeTargetOrigin,this.layout.layoutBox,A.layout.layoutBox),Qo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Fi(),this.targetWithTransforms=Fi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),sFe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Qo(this.target,this.layout.layoutBox),TY(this.target,this.targetDelta)):Qo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const A=this.getClosestProjectingParent();A&&!!A.resumingFrom==!!this.resumingFrom&&!A.options.layoutScroll&&A.target&&this.animationProgress!==1?(this.relativeParent=A,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Fi(),this.relativeTargetOrigin=Fi(),Mv(this.relativeTargetOrigin,this.target,A.target),Qo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||B4(this.parent.latestValues)||kY(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var I;const u=this.getLead(),a=!!this.resumingFrom||this!==u;let p=!0;if((this.isProjectionDirty||(I=this.parent)!=null&&I.isProjectionDirty)&&(p=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(p=!1),this.resolvedRelativeTargetAt===za.timestamp&&(p=!1),p)return;const{layout:g,layoutId:v}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(g||v))return;Qo(this.layoutCorrected,this.layout.layoutBox);const w=this.treeScale.x,T=this.treeScale.y;oFe(this.layoutCorrected,this.treeScale,this.path,a),u.layout&&!u.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(u.target=u.layout.layoutBox,u.targetWithTransforms=Fi());const{target:A}=u;if(!A){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(M9(this.prevProjectionDelta.x,this.projectionDelta.x),M9(this.prevProjectionDelta.y,this.projectionDelta.y)),Iv(this.projectionDelta,this.layoutCorrected,A,this.latestValues),(this.treeScale.x!==w||this.treeScale.y!==T||!B9(this.projectionDelta.x,this.prevProjectionDelta.x)||!B9(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",A))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(u=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),u){const p=this.getStack();p&&p.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=_g(),this.projectionDelta=_g(),this.projectionDeltaWithTransform=_g()}setAnimationOrigin(u,a=!1){const p=this.snapshot,g=p?p.latestValues:{},v={...this.latestValues},w=_g();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const T=Fi(),A=p?p.source:void 0,I=this.layout?this.layout.source:void 0,P=A!==I,D=this.getStack(),L=!D||D.members.length<=1,O=!!(P&&!L&&this.options.crossfade===!0&&!this.path.some(QFe));this.animationProgress=0;let $;this.mixTargetDelta=G=>{const B=G/1e3;G9(w.x,u.x,B),G9(w.y,u.y,B),this.setTargetDelta(w),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Mv(T,this.layout.layoutBox,this.relativeParent.layout.layoutBox),JFe(this.relativeTarget,this.relativeTargetOrigin,T,B),$&&LFe(this.relativeTarget,$)&&(this.isProjectionDirty=!1),$||($=Fi()),Qo($,this.relativeTarget)),P&&(this.animationValues=v,PFe(v,g,this.latestValues,B,O,L)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=B},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(u){var a,p,g;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(g=(p=this.resumingFrom)==null?void 0:p.currentAnimation)==null||g.stop(),this.pendingAnimation&&(tf(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=pi.update(()=>{f2.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=D0(0)),this.currentAnimation=EFe(this.motionValue,[0,1e3],{...u,velocity:0,isSync:!0,onUpdate:v=>{this.mixTargetDelta(v),u.onUpdate&&u.onUpdate(v)},onStop:()=>{},onComplete:()=>{u.onComplete&&u.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const u=this.getStack();u&&u.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(FFe),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const u=this.getLead();let{targetWithTransforms:a,target:p,layout:g,latestValues:v}=u;if(!(!a||!p||!g)){if(this!==u&&this.layout&&g&&RY(this.options.animationType,this.layout.layoutBox,g.layoutBox)){p=this.target||Fi();const w=Ns(this.layout.layoutBox.x);p.x.min=u.target.x.min,p.x.max=p.x.min+w;const T=Ns(this.layout.layoutBox.y);p.y.min=u.target.y.min,p.y.max=p.y.min+T}Qo(a,p),wg(a,v),Iv(this.projectionDeltaWithTransform,this.layoutCorrected,a,v)}}registerSharedNode(u,a){this.sharedNodes.has(u)||this.sharedNodes.set(u,new zFe),this.sharedNodes.get(u).add(a);const g=a.options.initialPromotionConfig;a.promote({transition:g?g.transition:void 0,preserveFollowOpacity:g&&g.shouldPreserveFollowOpacity?g.shouldPreserveFollowOpacity(a):void 0})}isLead(){const u=this.getStack();return u?u.lead===this:!0}getLead(){var a;const{layoutId:u}=this.options;return u?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:u}=this.options;return u?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:u}=this.options;if(u)return this.root.sharedNodes.get(u)}promote({needsReset:u,transition:a,preserveFollowOpacity:p}={}){const g=this.getStack();g&&g.promote(this,p),u&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const u=this.getStack();return u?u.relegate(this):!1}resetSkewAndRotation(){const{visualElement:u}=this.options;if(!u)return;let a=!1;const{latestValues:p}=u;if((p.z||p.rotate||p.rotateX||p.rotateY||p.rotateZ||p.skewX||p.skewY)&&(a=!0),!a)return;const g={};p.z&&uN("z",u,g,this.animationValues);for(let v=0;v<cN.length;v++)uN(`rotate${cN[v]}`,u,g,this.animationValues),uN(`skew${cN[v]}`,u,g,this.animationValues);u.render();for(const v in g)u.setStaticValue(v,g[v]),this.animationValues&&(this.animationValues[v]=g[v]);u.scheduleRender()}applyProjectionStyles(u,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){u.visibility="hidden";return}const p=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,u.visibility="",u.opacity="",u.pointerEvents=h2(a==null?void 0:a.pointerEvents)||"",u.transform=p?p(this.latestValues,""):"none";return}const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){this.options.layoutId&&(u.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,u.pointerEvents=h2(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!op(this.latestValues)&&(u.transform=p?p({},""):"none",this.hasProjected=!1);return}u.visibility="";const v=g.animationValues||g.latestValues;this.applyTransformsToTarget();let w=$Fe(this.projectionDeltaWithTransform,this.treeScale,v);p&&(w=p(v,w)),u.transform=w;const{x:T,y:A}=this.projectionDelta;u.transformOrigin=`${T.origin*100}% ${A.origin*100}% 0`,g.animationValues?u.opacity=g===this?v.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:v.opacityExit:u.opacity=g===this?v.opacity!==void 0?v.opacity:"":v.opacityExit!==void 0?v.opacityExit:0;for(const I in Z_){if(v[I]===void 0)continue;const{correct:P,applyTo:D,isCSSVariable:L}=Z_[I],O=w==="none"?v[I]:P(v[I],g);if(D){const $=D.length;for(let G=0;G<$;G++)u[D[G]]=O}else L?this.options.visualElement.renderState.vars[I]=O:u[I]=O}this.options.layoutId&&(u.pointerEvents=g===this?h2(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(u=>{var a;return(a=u.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(V9),this.root.sharedNodes.clear()}}}function VFe(t){t.updateLayout()}function UFe(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=t.layout,{animationType:o}=t.options,u=e.source!==t.layout.source;o==="size"?el(w=>{const T=u?e.measuredBox[w]:e.layoutBox[w],A=Ns(T);T.min=n[w].min,T.max=T.min+A}):RY(o,e.layoutBox,n)&&el(w=>{const T=u?e.measuredBox[w]:e.layoutBox[w],A=Ns(n[w]);T.max=T.min+A,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[w].max=t.relativeTarget[w].min+A)});const a=_g();Iv(a,n,e.layoutBox);const p=_g();u?Iv(p,t.applyTransform(i,!0),e.measuredBox):Iv(p,n,e.layoutBox);const g=!IY(a);let v=!1;if(!t.resumeFrom){const w=t.getClosestProjectingParent();if(w&&!w.resumeFrom){const{snapshot:T,layout:A}=w;if(T&&A){const I=Fi();Mv(I,e.layoutBox,T.layoutBox);const P=Fi();Mv(P,n,A.layoutBox),MY(I,P)||(v=!0),w.options.layoutRoot&&(t.relativeTarget=P,t.relativeTargetOrigin=I,t.relativeParent=w)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:p,layoutDelta:a,hasLayoutChanged:g,hasRelativeLayoutChanged:v})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function qFe(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function GFe(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function WFe(t){t.clearSnapshot()}function V9(t){t.clearMeasurements()}function U9(t){t.isLayoutDirty=!1}function HFe(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function q9(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function KFe(t){t.resolveTargetDelta()}function ZFe(t){t.calcProjection()}function XFe(t){t.resetSkewAndRotation()}function YFe(t){t.removeLeadSnapshot()}function G9(t,e,r){t.translate=ji(e.translate,0,r),t.scale=ji(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function W9(t,e,r,n){t.min=ji(e.min,r.min,n),t.max=ji(e.max,r.max,n)}function JFe(t,e,r,n){W9(t.x,e.x,r.x,n),W9(t.y,e.y,r.y,n)}function QFe(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const eBe={duration:.45,ease:[.4,0,.1,1]},H9=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),K9=H9("applewebkit/")&&!H9("chrome/")?Math.round:fl;function Z9(t){t.min=K9(t.min),t.max=K9(t.max)}function tBe(t){Z9(t.x),Z9(t.y)}function RY(t,e,r){return t==="position"||t==="preserve-aspect"&&!aFe(F9(e),F9(r),.2)}function rBe(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const nBe=OY({attachResizeListener:(t,e)=>Y_(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),dN={current:void 0},LY=OY({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!dN.current){const t=new nBe({});t.mount(window),t.setOptions({layoutScroll:!0}),dN.current=t}return dN.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),iBe={pan:{Feature:wFe},drag:{Feature:bFe,ProjectionNode:LY,MeasureLayout:NY}};function X9(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const i="onHover"+r,o=n[i];o&&pi.postRender(()=>o(e,Nb(e)))}class aBe extends gf{mount(){const{current:e}=this.node;e&&(this.unmount=M8e(e,(r,n)=>(X9(this.node,n,"Start"),i=>X9(this.node,i,"End"))))}unmount(){}}class sBe extends gf{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Eb(Y_(this.node.current,"focus",()=>this.onFocus()),Y_(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Y9(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const i="onTap"+(r==="End"?"":r),o=n[i];o&&pi.postRender(()=>o(e,Nb(e)))}class oBe extends gf{mount(){const{current:e}=this.node;e&&(this.unmount=L8e(e,(r,n)=>(Y9(this.node,n,"Start"),(i,{success:o})=>Y9(this.node,i,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const q4=new WeakMap,hN=new WeakMap,lBe=t=>{const e=q4.get(t.target);e&&e(t)},cBe=t=>{t.forEach(lBe)};function uBe({root:t,...e}){const r=t||document;hN.has(r)||hN.set(r,{});const n=hN.get(r),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(cBe,{root:t,...e})),n[i]}function dBe(t,e,r){const n=uBe(e);return q4.set(t,r),n.observe(t),()=>{q4.delete(t),n.unobserve(t)}}const hBe={some:0,all:1};class fBe extends gf{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:i="some",once:o}=e,u={root:r?r.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:hBe[i]},a=p=>{const{isIntersecting:g}=p;if(this.isInView===g||(this.isInView=g,o&&!g&&this.hasEnteredView))return;g&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",g);const{onViewportEnter:v,onViewportLeave:w}=this.node.getProps(),T=g?v:w;T&&T(p)};return dBe(this.node.current,u,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(pBe(e,r))&&this.startObserver()}unmount(){}}function pBe({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const mBe={inView:{Feature:fBe},tap:{Feature:oBe},focus:{Feature:sBe},hover:{Feature:aBe}},gBe={layout:{ProjectionNode:LY,MeasureLayout:NY}},G4={current:null},zY={current:!1};function yBe(){if(zY.current=!0,!!h5)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>G4.current=t.matches;t.addEventListener("change",e),e()}else G4.current=!1}const xBe=new WeakMap;function vBe(t,e,r){for(const n in e){const i=e[n],o=r[n];if(us(i))t.addValue(n,i);else if(us(o))t.addValue(n,D0(i,{owner:t}));else if(o!==i)if(t.hasValue(n)){const u=t.getValue(n);u.liveStyle===!0?u.jump(i):u.hasAnimated||u.set(i)}else{const u=t.getStaticValue(n);t.addValue(n,D0(u!==void 0?u:i,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const J9=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class _Be{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:o,visualState:u},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=N5,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const T=Js.now();this.renderScheduledAt<T&&(this.renderScheduledAt=T,pi.render(this.render,!1,!0))};const{latestValues:p,renderState:g}=u;this.latestValues=p,this.baseTarget={...p},this.initialValues=r.initial?{...p}:{},this.renderState=g,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=dE(r),this.isVariantNode=aY(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:v,...w}=this.scrapeMotionValuesFromProps(r,{},this);for(const T in w){const A=w[T];p[T]!==void 0&&us(A)&&A.set(p[T],!1)}}mount(e){this.current=e,xBe.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),zY.current||yBe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:G4.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),tf(this.notifyUpdate),tf(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=uy.has(e);n&&this.onBindTransform&&this.onBindTransform();const i=r.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&pi.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),o=r.on("renderRequest",this.scheduleRender);let u;window.MotionCheckAppearSync&&(u=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{i(),o(),u&&u(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in O0){const r=O0[e];if(!r)continue;const{isEnabled:n,Feature:i}=r;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Fi()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<J9.length;n++){const i=J9[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o="on"+i,u=e[o];u&&(this.propEventSubscriptions[i]=this.on(i,u))}this.prevMotionValues=vBe(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=D0(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(fX(n)||mX(n))?n=parseFloat(n):!F8e(n)&&rf.test(r)&&(n=XX(e,r)),this.setBaseTarget(e,us(n)?n.get():n)),us(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var o;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const u=V5(this.props,r,(o=this.presenceContext)==null?void 0:o.custom);u&&(n=u[e])}if(r&&n!==void 0)return n;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!us(i)?i:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new y5),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class $Y extends _Be{constructor(){super(...arguments),this.KeyframeResolver=A8e}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;us(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function FY(t,{style:e,vars:r},n,i){const o=t.style;let u;for(u in e)o[u]=e[u];i==null||i.applyProjectionStyles(o,n);for(u in r)o.setProperty(u,r[u])}function bBe(t){return window.getComputedStyle(t)}class wBe extends $Y{constructor(){super(...arguments),this.type="html",this.renderInstance=FY}readValueFromInstance(e,r){var n;if(uy.has(r))return(n=this.projection)!=null&&n.isProjecting?I4(r):Hze(e,r);{const i=bBe(e),o=(_5(r)?i.getPropertyValue(r):i[r])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(e,{transformPagePoint:r}){return SY(e,r)}build(e,r,n){$5(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return U5(e,r,n)}}const BY=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function kBe(t,e,r,n){FY(t,e,void 0,n);for(const i in e.attrs)t.setAttribute(BY.has(i)?i:z5(i),e.attrs[i])}class TBe extends $Y{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Fi}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(uy.has(r)){const n=ZX(r);return n&&n.default||0}return r=BY.has(r)?r:z5(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return mY(e,r,n)}build(e,r,n){dY(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,i){kBe(e,r,n,i)}mount(e){this.isSVGTag=fY(e.tagName),super.mount(e)}}const SBe=(t,e)=>B5(t)?new TBe(e):new wBe(e,{allowProjection:t!==Y.Fragment}),EBe=S$e({...Y$e,...mBe,...iBe,...gBe},SBe),Wn=X8e(EBe);function Rw(){return l.jsx("div",{className:"absolute inset-0 opacity-50 dark:opacity-40 pointer-events-none",children:l.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' stroke='%234b5563' stroke-width='1.5' opacity='0.7'%3E%3Crect x='0' y='0' width='60' height='60'/%3E%3C/g%3E%3C/svg%3E")`,backgroundSize:"60px 60px",backgroundPosition:"center"}})})}function fN(){return l.jsx("div",{className:"absolute inset-0 opacity-50 dark:opacity-40 pointer-events-none",children:l.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' stroke='%234b5563' stroke-width='1.5' opacity='0.7'%3E%3Cline x1='30' y1='0' x2='30' y2='60'/%3E%3C/g%3E%3C/svg%3E")`,backgroundSize:"60px 60px",backgroundPosition:"center"}})})}function jBe(){const[t,e]=Y.useState("hero"),[r,n]=Y.useState(!1),[i,o]=Y.useState("overview");Y.useEffect(()=>{const w=()=>{const T=["hero","threat","solution","features","demo","cases","benefits","contact"],A=window.scrollY+100;for(const I of T){const P=document.getElementById(I);if(P){const{offsetTop:D,offsetHeight:L}=P;if(A>=D&&A<D+L){e(I);break}}}};return window.addEventListener("scroll",w),()=>window.removeEventListener("scroll",w)},[]);const u=w=>{const T=document.getElementById(w);T&&T.scrollIntoView({behavior:"smooth"}),n(!1)},a=[{id:"hero",label:"Accueil"},{id:"threat",label:"Menaces"},{id:"solution",label:"Solution"},{id:"features",label:"Capacités"},{id:"demo",label:"Démonstration"},{id:"cases",label:"Cas d'usage"},{id:"benefits",label:"Avantages"},{id:"contact",label:"Contact"}],p=[{icon:Uh,title:"Surveillance Multi-Sources",description:"Twitter, Facebook, WhatsApp, Telegram, Sites d'actualités, YouTube, TikTok",details:["Collecte en temps réel","Analyse cross-platform","Détection de patterns"]},{icon:cc,title:"Intelligence Artificielle",description:"Analyse sémantique avancée, détection de bots, prédiction de viralité",details:["Machine Learning","NLP multilingue","Apprentissage continu"]},{icon:Die,title:"Analyse Visuelle",description:"Lecture de screenshots, analyse d'images, détection de memes",details:["OCR avancé","Classification d'images","Détection de manipulation"]},{icon:fv,title:"Automatisation Complète",description:"Création de posts, réponses automatiques, gestion de campagnes",details:["Génération de contenu","Engagement automatique","Workflows personnalisés"]},{icon:OT,title:"Intelligence Géographique",description:"Cartographie en temps réel de la propagation d'information par province",details:["Cartes de chaleur","Analyse régionale","Détection de foyers"]},{icon:oi,title:"Système d'Alertes",description:"Notifications prioritaires, détection d'anomalies, réponse rapide",details:["Alertes temps réel","Escalade automatique","Protocoles de crise"]}],g=[{title:"Crise Sanitaire",threat:"Fausse rumeur sur un vaccin",without:["Découverte tardive","Panique massive","Efforts inefficaces"],with:["Détection en 15 min","Source identifiée","Crise évitée"],impact:"95% de réduction des dommages"},{title:"Tensions Électorales",threat:"Désinformation ethnique",without:["Escalade non détectée","Violence potentielle","Dommages sociaux"],with:["Patterns détectés","Acteurs identifiés","Paix maintenue"],impact:"Prévention totale des conflits"},{title:"Attaque Économique",threat:"Fausses infos sur le secteur minier",without:["Perte d'investisseurs","Impact économique","Réputation ternie"],with:["Correction rapide","Communication proactive","Économie protégée"],impact:"Protection de millions USD"}],v={overview:{component:hC,title:"Tableau de Bord Exécutif",description:"Vue d'ensemble en temps réel de l'espace informationnel congolais"},keywords:{component:g4,title:"Suivi des Mots-Clés",description:"Surveillance automatisée 24/7 des termes critiques"},analytics:{component:y4,title:"Analyses Approfondies",description:"Intelligence actionnable avec ML et prédictions"},network:{component:T4,title:"Analyse de Réseaux",description:"Cartographie des influenceurs et communautés"},geographic:{component:S4,title:"Intelligence Géographique",description:"Visualisation par province et région"},alerts:{component:$2,title:"Centre d'Alertes",description:"Notifications prioritaires et gestion de crise"},data:{component:Wg,title:"Explorateur de Données",description:"Accès complet aux données collectées"}};return v[i].component,l.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[l.jsxs("nav",{className:"fixed top-0 left-0 right-0 bg-white/90 dark:bg-gray-900/90 backdrop-blur-md z-50 border-b border-gray-200 dark:border-gray-800",children:[l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(gl,{className:"w-8 h-8 text-blue-600"}),l.jsx("span",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"SENTINEL RDC"})]}),l.jsx("div",{className:"hidden md:flex items-center space-x-8",children:a.map(w=>l.jsx("button",{onClick:()=>u(w.id),className:`text-sm font-medium transition-colors ${t===w.id?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:w.label},w.id))}),l.jsx("button",{onClick:()=>n(!r),className:"md:hidden p-2 text-gray-600 dark:text-gray-400",children:r?l.jsx(no,{className:"w-6 h-6"}):l.jsx(Hie,{className:"w-6 h-6"})})]})}),l.jsx(G8e,{children:r&&l.jsx(Wn.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"md:hidden bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:l.jsx("div",{className:"px-4 py-2 space-y-1",children:a.map(w=>l.jsx("button",{onClick:()=>u(w.id),className:"block w-full text-left px-3 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 rounded",children:w.label},w.id))})})})]}),l.jsxs("section",{id:"hero",className:"relative pt-16 min-h-screen flex items-center",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800"}),l.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[l.jsxs(Wn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center",children:[l.jsx("h1",{className:"text-5xl md:text-7xl font-bold text-gray-900 dark:text-white mb-6",children:"SENTINEL"}),l.jsx("p",{className:"text-2xl md:text-3xl text-gray-700 dark:text-gray-300 mb-8",children:"Système d'Intelligence Numérique pour la République Démocratique du Congo"}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto mb-12",children:"Protection 24/7 contre la désinformation. Intelligence artificielle au service de la souveraineté numérique congolaise."}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto mb-12",children:[l.jsxs(Wn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsx(ga,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Surveillance 24/7"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Robots intelligents travaillant sans interruption"})]}),l.jsxs(Wn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsx(il,{className:"w-12 h-12 text-green-600 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Détection Précoce"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Arrêtez la désinformation avant qu'elle ne devienne virale"})]}),l.jsxs(Wn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[l.jsx(Mh,{className:"w-12 h-12 text-orange-600 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Réponse Rapide"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Contre-narratifs automatiques en temps réel"})]})]}),l.jsxs("button",{onClick:()=>u("demo"),className:"bg-blue-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-blue-700 transition-colors inline-flex items-center space-x-2",children:[l.jsx("span",{children:"Voir la Démonstration"}),l.jsx($6,{className:"w-5 h-5"})]})]}),l.jsx(Wn.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"absolute bottom-8 left-1/2 transform -translate-x-1/2",children:l.jsx(pv,{className:"w-8 h-8 text-gray-400 animate-bounce"})})]})]}),l.jsxs("section",{id:"threat",className:"py-20 bg-white dark:bg-gray-800 relative overflow-hidden",children:[l.jsx(Rw,{}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-12",children:[l.jsx("h2",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"La Menace : Guerre de l'Information"}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto",children:"La RDC fait face à des défis sans précédent dans l'espace numérique"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[l.jsxs(Wn.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:.1},className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-6",children:[l.jsx(oi,{className:"w-12 h-12 text-red-600 mb-4"}),l.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Désinformation Orchestrée"}),l.jsxs("ul",{className:"space-y-2 text-gray-700 dark:text-gray-300",children:[l.jsx("li",{children:"• Acteurs étrangers malveillants"}),l.jsx("li",{children:"• Manipulation de l'opinion publique"}),l.jsx("li",{children:"• Campagnes de déstabilisation"}),l.jsx("li",{children:"• Fake news virales"})]})]}),l.jsxs(Wn.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:.2},className:"bg-orange-50 dark:bg-orange-900/20 rounded-xl p-6",children:[l.jsx(ea,{className:"w-12 h-12 text-orange-600 mb-4"}),l.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Division Communautaire"}),l.jsxs("ul",{className:"space-y-2 text-gray-700 dark:text-gray-300",children:[l.jsx("li",{children:"• Exploitation des tensions ethniques"}),l.jsx("li",{children:"• Amplification des conflits"}),l.jsx("li",{children:"• Érosion de la confiance"}),l.jsx("li",{children:"• Polarisation sociale"})]})]}),l.jsxs(Wn.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:.3},className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-xl p-6",children:[l.jsx(ul,{className:"w-12 h-12 text-yellow-600 mb-4"}),l.jsx("h3",{className:"text-xl font-semibold mb-3",children:"Manque de Visibilité"}),l.jsxs("ul",{className:"space-y-2 text-gray-700 dark:text-gray-300",children:[l.jsx("li",{children:"• Information trop rapide"}),l.jsx("li",{children:"• Réaction toujours tardive"}),l.jsx("li",{children:"• Outils inadéquats"}),l.jsx("li",{children:"• Angle mort numérique"})]})]})]})]})]}),l.jsxs("section",{id:"solution",className:"py-20 bg-gray-50 dark:bg-gray-900 relative overflow-hidden",children:[l.jsx(fN,{}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-12",children:[l.jsx("h2",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"La Solution : SENTINEL"}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto",children:"Intelligence artificielle et machine learning au service de la protection informationnelle"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[l.jsxs(Wn.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},children:[l.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Technologies de Pointe"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(hi,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-1"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold",children:"Intelligence Artificielle Avancée"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Modèles ML spécialisés pour l'analyse contextuelle congolaise"})]})]}),l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(hi,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-1"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold",children:"Traitement Temps Réel"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Analyse de millions de messages avec latence moins d'1 minute"})]})]}),l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(hi,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-1"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold",children:"Multi-Modal Analysis"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Texte, images, vidéos, audio - tout est analysé"})]})]}),l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(hi,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-1"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold",children:"Automatisation Complète"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Création de contenu, réponses automatiques, workflows"})]})]})]})]}),l.jsxs(Wn.div,{initial:{opacity:0,x:20},whileInView:{opacity:1,x:0},viewport:{once:!0},className:"bg-white dark:bg-gray-800 rounded-xl p-8 shadow-xl",children:[l.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Architecture Robuste"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"font-medium",children:"Collecte Multi-Sources"}),l.jsx("span",{className:"text-sm text-gray-500",children:"8+ plateformes"})]}),l.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"100%"}})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"font-medium",children:"Analyse IA/ML"}),l.jsx("span",{className:"text-sm text-gray-500",children:"99.9% précision"})]}),l.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:l.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"99.9%"}})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"font-medium",children:"Temps de Réponse"}),l.jsx("span",{className:"text-sm text-gray-500",children:"moins de 60 secondes"})]}),l.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:l.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:"95%"}})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"font-medium",children:"Disponibilité"}),l.jsx("span",{className:"text-sm text-gray-500",children:"99.9% uptime"})]}),l.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:l.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:"99.9%"}})})]})]})]})]})]})]}),l.jsxs("section",{id:"features",className:"py-20 bg-white dark:bg-gray-800 relative overflow-hidden",children:[l.jsx(Rw,{}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-12",children:[l.jsx("h2",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Capacités Principales"}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto",children:"Un arsenal complet pour la protection de l'espace informationnel"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:p.map((w,T)=>l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:T*.1},className:"bg-gray-50 dark:bg-gray-900 rounded-xl p-6 hover:shadow-lg transition-shadow",children:[l.jsx(w.icon,{className:"w-12 h-12 text-blue-600 mb-4"}),l.jsx("h3",{className:"text-xl font-semibold mb-2",children:w.title}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:w.description}),l.jsx("ul",{className:"space-y-1",children:w.details.map((A,I)=>l.jsxs("li",{className:"text-sm text-gray-500 dark:text-gray-500 flex items-center space-x-2",children:[l.jsx(hi,{className:"w-4 h-4 text-green-500"}),l.jsx("span",{children:A})]},I))})]},T))})]})]}),l.jsxs("section",{id:"demo",className:"py-20 bg-gray-50 dark:bg-gray-900 relative overflow-hidden",children:[l.jsx(fN,{}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-12",children:[l.jsx("h2",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Démonstration en Direct"}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto",children:"Explorez les interfaces réelles du système Sentinel"})]}),l.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-8",children:Object.entries(v).map(([w,T])=>l.jsx("button",{onClick:()=>o(w),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${i===w?"bg-blue-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:T.title},w))}),l.jsxs(Wn.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl overflow-hidden",children:[l.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 px-6 py-4 border-b border-gray-200 dark:border-gray-600",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:v[i].title}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:v[i].description})]}),l.jsxs("div",{className:"p-6 max-h-[600px] overflow-y-auto",children:[i==="overview"&&l.jsx(hC,{keywords:[]}),i==="keywords"&&l.jsx(g4,{keywords:[],setKeywords:()=>{}}),i==="analytics"&&l.jsx(y4,{}),i==="network"&&l.jsx(T4,{}),i==="geographic"&&l.jsx(S4,{}),i==="alerts"&&l.jsx($2,{}),i==="data"&&l.jsx(Wg,{})]})]},i)]})]}),l.jsxs("section",{id:"cases",className:"py-20 bg-white dark:bg-gray-800 relative overflow-hidden",children:[l.jsx(Rw,{}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-12",children:[l.jsx("h2",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Cas d'Usage Critiques"}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto",children:"Impact concret sur la protection nationale"})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:g.map((w,T)=>l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:T*.1},className:"bg-gray-50 dark:bg-gray-900 rounded-xl p-6",children:[l.jsx("h3",{className:"text-xl font-bold mb-2",children:w.title}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-4 font-medium",children:["Menace : ",w.threat]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[l.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3",children:[l.jsx("h4",{className:"font-semibold text-red-700 dark:text-red-400 mb-2",children:"Sans Sentinel"}),l.jsx("ul",{className:"space-y-1",children:w.without.map((A,I)=>l.jsxs("li",{className:"text-sm text-red-600 dark:text-red-300 flex items-start",children:[l.jsx(no,{className:"w-4 h-4 mr-1 flex-shrink-0 mt-0.5"}),A]},I))})]}),l.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[l.jsx("h4",{className:"font-semibold text-green-700 dark:text-green-400 mb-2",children:"Avec Sentinel"}),l.jsx("ul",{className:"space-y-1",children:w.with.map((A,I)=>l.jsxs("li",{className:"text-sm text-green-600 dark:text-green-300 flex items-start",children:[l.jsx(hi,{className:"w-4 h-4 mr-1 flex-shrink-0 mt-0.5"}),A]},I))})]})]}),l.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/20 rounded-lg p-3",children:l.jsxs("p",{className:"text-sm font-semibold text-blue-700 dark:text-blue-400",children:["Impact : ",w.impact]})})]},T))})]})]}),l.jsxs("section",{id:"benefits",className:"py-20 bg-gray-50 dark:bg-gray-900 relative overflow-hidden",children:[l.jsx(fN,{}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-12",children:[l.jsx("h2",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Avantages Stratégiques"}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto",children:"Un investissement dans l'avenir numérique de la RDC"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.1},className:"bg-white dark:bg-gray-800 rounded-xl p-6 text-center",children:[l.jsx(gl,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Souveraineté Numérique"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Protection contre les ingérences étrangères"})]}),l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2},className:"bg-white dark:bg-gray-800 rounded-xl p-6 text-center",children:[l.jsx(ii,{className:"w-12 h-12 text-green-600 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"ROI Exceptionnel"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Prévention de crises = économies massives"})]}),l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.3},className:"bg-white dark:bg-gray-800 rounded-xl p-6 text-center",children:[l.jsx(ds,{className:"w-12 h-12 text-orange-600 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Efficacité 24/7"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Automatisation complète sans repos"})]}),l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.4},className:"bg-white dark:bg-gray-800 rounded-xl p-6 text-center",children:[l.jsx(Gie,{className:"w-12 h-12 text-purple-600 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Sécurité Maximale"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Infrastructure cloud sécurisée"})]})]}),l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"mt-16 bg-blue-600 rounded-2xl p-8 text-white text-center",children:[l.jsx("h3",{className:"text-3xl font-bold mb-4",children:"Le coût de l'inaction est infiniment supérieur à l'investissement"}),l.jsx("p",{className:"text-xl mb-8 opacity-90",children:"Chaque jour sans Sentinel est un jour de vulnérabilité"}),l.jsxs("button",{onClick:()=>u("contact"),className:"bg-white text-blue-600 px-8 py-4 rounded-lg text-lg font-semibold hover:bg-gray-100 transition-colors inline-flex items-center space-x-2",children:[l.jsx("span",{children:"Demander une Démonstration"}),l.jsx($6,{className:"w-5 h-5"})]})]})]})]}),l.jsxs("section",{id:"contact",className:"py-20 bg-white dark:bg-gray-800 relative overflow-hidden",children:[l.jsx(Rw,{}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:l.jsxs(Wn.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center",children:[l.jsx("h2",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Prochaines Étapes"}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto mb-12",children:"Agissons ensemble pour protéger l'avenir numérique de la République Démocratique du Congo"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 max-w-5xl mx-auto",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-xl p-6",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx("span",{className:"text-xl font-bold text-blue-600",children:"1"})}),l.jsx("h3",{className:"font-semibold mb-2",children:"Démonstration"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Présentation live personnalisée"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-xl p-6",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx("span",{className:"text-xl font-bold text-blue-600",children:"2"})}),l.jsx("h3",{className:"font-semibold mb-2",children:"Étude"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Analyse des besoins spécifiques"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-xl p-6",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx("span",{className:"text-xl font-bold text-blue-600",children:"3"})}),l.jsx("h3",{className:"font-semibold mb-2",children:"Pilote"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Test sur périmètre limité"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-xl p-6",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx("span",{className:"text-xl font-bold text-blue-600",children:"4"})}),l.jsx("h3",{className:"font-semibold mb-2",children:"Déploiement"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Protection complète activée"})]})]}),l.jsxs("div",{className:"mt-12 p-8 bg-gray-100 dark:bg-gray-900 rounded-xl",children:[l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Ce document est confidentiel et destiné exclusivement aux autorités de la République Démocratique du Congo"}),l.jsx("button",{className:"bg-blue-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-blue-700 transition-colors",children:"Contactez l'Équipe Dédiée RDC"})]})]})})]})]})}function ABe(){var D;const[t,e]=Y.useState("overview"),[r,n]=Y.useState(null),[i,o]=Y.useState(!1),[u,a]=Y.useState(3),[p,g]=Y.useState(new Date),{settings:v,updateSettings:w}=FI(),T=v.theme==="dark"||v.theme==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches,[A,I]=Y.useState([{id:1,term:"sécurité",mentions:234,trend:[12,15,23,31,28,35,47],status:"active",createdAt:new Date,sentiment:{positive:65,negative:15,neutral:20}},{id:2,term:"gouvernement",mentions:189,trend:[45,42,38,41,44,48,52],status:"active",createdAt:new Date,sentiment:{positive:40,negative:35,neutral:25}},{id:3,term:"élections",mentions:567,trend:[89,92,98,112,134,156,178],status:"critical",createdAt:new Date,sentiment:{positive:30,negative:50,neutral:20}},{id:4,term:"manifestation",mentions:89,trend:[23,25,24,28,31,29,32],status:"warning",createdAt:new Date,sentiment:{positive:25,negative:45,neutral:30}}]);Y.useEffect(()=>{const L=setInterval(()=>{g(new Date)},3e4);return()=>clearInterval(L)},[]);const P=[{id:"overview",label:"Vue d'ensemble",icon:Vie,badge:null},{id:"search",label:"Recherche",icon:iu,badge:null},{id:"keywords",label:"Mots-clés",icon:qp,badge:A.length},{id:"analytics",label:"Analytique",icon:No,badge:null},{id:"network",label:"Réseau",icon:Wc,badge:null},{id:"geographic",label:"Géographie",icon:OT,badge:null},{id:"intelligence",label:"Intelligence IA",icon:cc,badge:"AI"},{id:"spread",label:"Propagation",icon:dC,badge:null},{id:"counter-action",label:"Contre-Attaque",icon:gl,badge:null},{id:"sources",label:"Sources",icon:Gc,badge:null},{id:"alerts",label:"Alertes",icon:Jv,badge:u}];return l.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900 overflow-hidden",children:[l.jsxs("aside",{className:`${i?"w-20":"w-64"} bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 flex flex-col`,children:[l.jsxs("div",{className:"h-20 flex items-center justify-between px-4 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:`flex items-center space-x-3 ${i?"justify-center":""}`,children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(gl,{className:"w-6 h-6 text-white"})}),!i&&l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"SENTINEL"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"RDC Intelligence"})]})]}),l.jsx("button",{onClick:()=>o(!i),className:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(Rie,{className:`w-5 h-5 text-gray-500 transition-transform ${i?"rotate-180":""}`})})]}),!i&&l.jsxs("div",{className:"px-4 py-4 space-y-2 border-b border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Mentions/h"}),l.jsx("span",{className:"font-semibold text-gray-800 dark:text-white",children:"1,247"})]}),l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Sentiment"}),l.jsx("span",{className:"font-semibold text-green-600",children:"72%"})]}),l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Alertes"}),l.jsx("span",{className:"font-semibold text-red-600",children:u})]})]}),l.jsx("nav",{className:"flex-1 px-3 py-4 space-y-1 overflow-y-auto",children:P.map(L=>{const O=L.icon,$=t===L.id;return l.jsxs("button",{onClick:()=>e(L.id),className:`w-full flex items-center justify-between px-3 py-2.5 rounded-lg transition-all duration-200 group ${$?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(O,{className:`w-5 h-5 ${$?"text-blue-600 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`}),!i&&l.jsx("span",{className:"font-medium",children:L.label})]}),!i&&L.badge!==null&&l.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${L.badge==="AI"?"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400":L.id==="alerts"&&typeof L.badge=="number"&&L.badge>0?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:L.badge})]},L.id)})}),l.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:`flex items-center ${i?"justify-center":"space-x-3"}`,children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-white font-semibold",children:"AD"})}),!i&&l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"Admin User"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Niveau 5"})]})]}),!i&&l.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[l.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(V0,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),l.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(Wie,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})]})]}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[l.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:(D=P.find(L=>L.id===t))==null?void 0:D.label}),l.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Dernière mise à jour: ",p.toLocaleTimeString("fr-FR")]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>w("theme",T?"light":"dark"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:T?"Switch to Light Mode":"Switch to Dark Mode",children:T?l.jsx(sae,{className:"w-5 h-5 text-yellow-500"}):l.jsx(Xie,{className:"w-5 h-5 text-gray-500"})}),l.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(Co,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),l.jsx("button",{onClick:()=>g(new Date),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(ro,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})}),l.jsx("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:l.jsx(RT,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})]})}),l.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-50 dark:bg-gray-900",children:l.jsxs("div",{className:"p-6",children:[t==="overview"&&l.jsx(hC,{keywords:A}),t==="search"&&l.jsx(_De,{}),t==="keywords"&&l.jsx(g4,{keywords:A,setKeywords:I}),t==="analytics"&&l.jsx(y4,{}),t==="network"&&l.jsx(T4,{}),t==="geographic"&&l.jsx(S4,{}),t==="intelligence"&&l.jsx(kLe,{}),t==="spread"&&!r&&l.jsx(LLe,{onViewSubject:L=>n(L)}),t==="spread"&&r&&l.jsx(FLe,{subjectId:r,onBack:()=>n(null)}),t==="counter-action"&&l.jsx(qLe,{}),t==="sources"&&l.jsx(TLe,{}),t==="alerts"&&l.jsx($2,{})]})})]})]})}function NBe(){return l.jsx(xie,{children:l.jsxs(Hne,{children:[l.jsx(Zw,{path:"/presentation",element:l.jsx(jBe,{})}),l.jsx(Zw,{path:"/dashboard",element:l.jsx(ABe,{})}),l.jsx(Zw,{path:"/",element:l.jsx(Gne,{to:"/dashboard",replace:!0})})]})})}pN.createRoot(document.getElementById("root")).render(l.jsx(Le.StrictMode,{children:l.jsx(qre,{children:l.jsx(pae,{children:l.jsx(NBe,{})})})}));export{IT as _,$c as c,Pn as g};
//# sourceMappingURL=index-80e181b8.js.map
